!function(root,factory){"object"==typeof exports&&"object"==typeof module?module.exports=factory(require("jQuery"),require("console.log"),require("THREE")):"function"==typeof define&&define.amd?define(["jQuery","console.log","THREE"],factory):"object"==typeof exports?exports.bioimagesuiteweb=factory(require("jQuery"),require("console.log"),require("THREE")):root.bioimagesuiteweb=factory(root.jQuery,root["console.log"],root.THREE)}(window,function(__WEBPACK_EXTERNAL_MODULE_jquery__,__WEBPACK_EXTERNAL_MODULE_request__,__WEBPACK_EXTERNAL_MODULE_three__){return function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.l=!0,module.exports}return __webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.d=function(exports,name,getter){__webpack_require__.o(exports,name)||Object.defineProperty(exports,name,{configurable:!1,enumerable:!0,get:getter})},__webpack_require__.r=function(exports){Object.defineProperty(exports,"__esModule",{value:!0})},__webpack_require__.n=function(module){var getter=module&&module.__esModule?function(){return module.default}:function(){return module};return __webpack_require__.d(getter,"a",getter),getter},__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s="./js/webcomponents/bislib.js")}({"../../AppData/Roaming/npm/node_modules/webpack/buildin/amd-define.js":function(module,exports){module.exports=function(){throw new Error("define cannot be used indirect")}},"../../AppData/Roaming/npm/node_modules/webpack/buildin/amd-options.js":function(module,exports){(function(__webpack_amd_options__){module.exports=__webpack_amd_options__}).call(this,{})},"../../AppData/Roaming/npm/node_modules/webpack/buildin/global.js?8fce":function(module,exports){var g;g=function(){return this}();try{g=g||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(g=window)}module.exports=g},"../../AppData/Roaming/npm/node_modules/webpack/buildin/global.js?cd00":function(module,exports){var g;g=function(){return this}();try{g=g||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(g=window)}module.exports=g},"../../AppData/Roaming/npm/node_modules/webpack/buildin/module.js":function(module,exports){module.exports=function(module){return module.webpackPolyfill||(module.deprecate=function(){},module.paths=[],module.children||(module.children=[]),Object.defineProperty(module,"loaded",{enumerable:!0,get:function(){return module.l}}),Object.defineProperty(module,"id",{enumerable:!0,get:function(){return module.i}}),module.webpackPolyfill=1),module}},"../../AppData/Roaming/npm/node_modules/webpack/node_modules/assert/assert.js":function(module,exports,__webpack_require__){"use strict";(function(global){function compare(a,b){if(a===b)return 0;for(var x=a.length,y=b.length,i=0,len=Math.min(x,y);i<len;++i)if(a[i]!==b[i]){x=a[i],y=b[i];break}return x<y?-1:y<x?1:0}function isBuffer(b){return global.Buffer&&"function"==typeof global.Buffer.isBuffer?global.Buffer.isBuffer(b):!(null==b||!b._isBuffer)}var util=__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/node_modules/util/util.js"),hasOwn=Object.prototype.hasOwnProperty,pSlice=Array.prototype.slice,functionsHaveNames="foo"===function(){}.name;function pToString(obj){return Object.prototype.toString.call(obj)}function isView(arrbuf){return!isBuffer(arrbuf)&&("function"==typeof global.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(arrbuf):!!arrbuf&&(arrbuf instanceof DataView||!!(arrbuf.buffer&&arrbuf.buffer instanceof ArrayBuffer))))}var assert=module.exports=ok,regex=/\s*function\s+([^\(\s]*)\s*/;function getName(func){if(util.isFunction(func)){if(functionsHaveNames)return func.name;var match=func.toString().match(regex);return match&&match[1]}}function truncate(s,n){return"string"==typeof s?s.length<n?s:s.slice(0,n):s}function inspect(something){if(functionsHaveNames||!util.isFunction(something))return util.inspect(something);var rawname=getName(something);return"[Function"+(rawname?": "+rawname:"")+"]"}function fail(actual,expected,message,operator,stackStartFunction){throw new assert.AssertionError({message:message,actual:actual,expected:expected,operator:operator,stackStartFunction:stackStartFunction})}function ok(value,message){value||fail(value,!0,message,"==",assert.ok)}function _deepEqual(actual,expected,strict,memos){if(actual===expected)return!0;if(isBuffer(actual)&&isBuffer(expected))return 0===compare(actual,expected);if(util.isDate(actual)&&util.isDate(expected))return actual.getTime()===expected.getTime();if(util.isRegExp(actual)&&util.isRegExp(expected))return actual.source===expected.source&&actual.global===expected.global&&actual.multiline===expected.multiline&&actual.lastIndex===expected.lastIndex&&actual.ignoreCase===expected.ignoreCase;if(null!==actual&&"object"==typeof actual||null!==expected&&"object"==typeof expected){if(isView(actual)&&isView(expected)&&pToString(actual)===pToString(expected)&&!(actual instanceof Float32Array||actual instanceof Float64Array))return 0===compare(new Uint8Array(actual.buffer),new Uint8Array(expected.buffer));if(isBuffer(actual)!==isBuffer(expected))return!1;var actualIndex=(memos=memos||{actual:[],expected:[]}).actual.indexOf(actual);return-1!==actualIndex&&actualIndex===memos.expected.indexOf(expected)||(memos.actual.push(actual),memos.expected.push(expected),function(a,b,strict,actualVisitedObjects){if(null===a||void 0===a||null===b||void 0===b)return!1;if(util.isPrimitive(a)||util.isPrimitive(b))return a===b;if(strict&&Object.getPrototypeOf(a)!==Object.getPrototypeOf(b))return!1;var aIsArgs=isArguments(a),bIsArgs=isArguments(b);if(aIsArgs&&!bIsArgs||!aIsArgs&&bIsArgs)return!1;if(aIsArgs)return a=pSlice.call(a),b=pSlice.call(b),_deepEqual(a,b,strict);var key,i,ka=objectKeys(a),kb=objectKeys(b);if(ka.length!==kb.length)return!1;for(ka.sort(),kb.sort(),i=ka.length-1;i>=0;i--)if(ka[i]!==kb[i])return!1;for(i=ka.length-1;i>=0;i--)if(key=ka[i],!_deepEqual(a[key],b[key],strict,actualVisitedObjects))return!1;return!0}(actual,expected,strict,memos))}return strict?actual===expected:actual==expected}function isArguments(object){return"[object Arguments]"==Object.prototype.toString.call(object)}function expectedException(actual,expected){if(!actual||!expected)return!1;if("[object RegExp]"==Object.prototype.toString.call(expected))return expected.test(actual);try{if(actual instanceof expected)return!0}catch(e){}return!Error.isPrototypeOf(expected)&&!0===expected.call({},actual)}function _throws(shouldThrow,block,expected,message){var actual;if("function"!=typeof block)throw new TypeError('"block" argument must be a function');"string"==typeof expected&&(message=expected,expected=null),actual=function(block){var error;try{block()}catch(e){error=e}return error}(block),message=(expected&&expected.name?" ("+expected.name+").":".")+(message?" "+message:"."),shouldThrow&&!actual&&fail(actual,expected,"Missing expected exception"+message);var userProvidedMessage="string"==typeof message,isUnwantedException=!shouldThrow&&util.isError(actual),isUnexpectedException=!shouldThrow&&actual&&!expected;if((isUnwantedException&&userProvidedMessage&&expectedException(actual,expected)||isUnexpectedException)&&fail(actual,expected,"Got unwanted exception"+message),shouldThrow&&actual&&expected&&!expectedException(actual,expected)||!shouldThrow&&actual)throw actual}assert.AssertionError=function(options){var self;this.name="AssertionError",this.actual=options.actual,this.expected=options.expected,this.operator=options.operator,options.message?(this.message=options.message,this.generatedMessage=!1):(this.message=truncate(inspect((self=this).actual),128)+" "+self.operator+" "+truncate(inspect(self.expected),128),this.generatedMessage=!0);var stackStartFunction=options.stackStartFunction||fail;if(Error.captureStackTrace)Error.captureStackTrace(this,stackStartFunction);else{var err=new Error;if(err.stack){var out=err.stack,fn_name=getName(stackStartFunction),idx=out.indexOf("\n"+fn_name);if(idx>=0){var next_line=out.indexOf("\n",idx+1);out=out.substring(next_line+1)}this.stack=out}}},util.inherits(assert.AssertionError,Error),assert.fail=fail,assert.ok=ok,assert.equal=function(actual,expected,message){actual!=expected&&fail(actual,expected,message,"==",assert.equal)},assert.notEqual=function(actual,expected,message){actual==expected&&fail(actual,expected,message,"!=",assert.notEqual)},assert.deepEqual=function(actual,expected,message){_deepEqual(actual,expected,!1)||fail(actual,expected,message,"deepEqual",assert.deepEqual)},assert.deepStrictEqual=function(actual,expected,message){_deepEqual(actual,expected,!0)||fail(actual,expected,message,"deepStrictEqual",assert.deepStrictEqual)},assert.notDeepEqual=function(actual,expected,message){_deepEqual(actual,expected,!1)&&fail(actual,expected,message,"notDeepEqual",assert.notDeepEqual)},assert.notDeepStrictEqual=function notDeepStrictEqual(actual,expected,message){_deepEqual(actual,expected,!0)&&fail(actual,expected,message,"notDeepStrictEqual",notDeepStrictEqual)},assert.strictEqual=function(actual,expected,message){actual!==expected&&fail(actual,expected,message,"===",assert.strictEqual)},assert.notStrictEqual=function(actual,expected,message){actual===expected&&fail(actual,expected,message,"!==",assert.notStrictEqual)},assert.throws=function(block,error,message){_throws(!0,block,error,message)},assert.doesNotThrow=function(block,error,message){_throws(!1,block,error,message)},assert.ifError=function(err){if(err)throw err};var objectKeys=Object.keys||function(obj){var keys=[];for(var key in obj)hasOwn.call(obj,key)&&keys.push(key);return keys}}).call(this,__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/buildin/global.js?cd00"))},"../../AppData/Roaming/npm/node_modules/webpack/node_modules/browserify-zlib/lib/binding.js":function(module,exports,__webpack_require__){"use strict";(function(Buffer,process){var assert=__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/node_modules/assert/assert.js"),Zstream=__webpack_require__("./node_modules/pako/lib/zlib/zstream.js"),zlib_deflate=__webpack_require__("./node_modules/pako/lib/zlib/deflate.js"),zlib_inflate=__webpack_require__("./node_modules/pako/lib/zlib/inflate.js"),constants=__webpack_require__("./node_modules/pako/lib/zlib/constants.js");for(var key in constants)exports[key]=constants[key];exports.NONE=0,exports.DEFLATE=1,exports.INFLATE=2,exports.GZIP=3,exports.GUNZIP=4,exports.DEFLATERAW=5,exports.INFLATERAW=6,exports.UNZIP=7;function Zlib(mode){if("number"!=typeof mode||mode<exports.DEFLATE||mode>exports.UNZIP)throw new TypeError("Bad argument");this.dictionary=null,this.err=0,this.flush=0,this.init_done=!1,this.level=0,this.memLevel=0,this.mode=mode,this.strategy=0,this.windowBits=0,this.write_in_progress=!1,this.pending_close=!1,this.gzip_id_bytes_read=0}Zlib.prototype.close=function(){this.write_in_progress?this.pending_close=!0:(this.pending_close=!1,assert(this.init_done,"close before init"),assert(this.mode<=exports.UNZIP),this.mode===exports.DEFLATE||this.mode===exports.GZIP||this.mode===exports.DEFLATERAW?zlib_deflate.deflateEnd(this.strm):this.mode!==exports.INFLATE&&this.mode!==exports.GUNZIP&&this.mode!==exports.INFLATERAW&&this.mode!==exports.UNZIP||zlib_inflate.inflateEnd(this.strm),this.mode=exports.NONE,this.dictionary=null)},Zlib.prototype.write=function(flush,input,in_off,in_len,out,out_off,out_len){return this._write(!0,flush,input,in_off,in_len,out,out_off,out_len)},Zlib.prototype.writeSync=function(flush,input,in_off,in_len,out,out_off,out_len){return this._write(!1,flush,input,in_off,in_len,out,out_off,out_len)},Zlib.prototype._write=function(async,flush,input,in_off,in_len,out,out_off,out_len){if(assert.equal(arguments.length,8),assert(this.init_done,"write before init"),assert(this.mode!==exports.NONE,"already finalized"),assert.equal(!1,this.write_in_progress,"write already in progress"),assert.equal(!1,this.pending_close,"close is pending"),this.write_in_progress=!0,assert.equal(!1,void 0===flush,"must provide flush value"),this.write_in_progress=!0,flush!==exports.Z_NO_FLUSH&&flush!==exports.Z_PARTIAL_FLUSH&&flush!==exports.Z_SYNC_FLUSH&&flush!==exports.Z_FULL_FLUSH&&flush!==exports.Z_FINISH&&flush!==exports.Z_BLOCK)throw new Error("Invalid flush value");if(null==input&&(input=Buffer.alloc(0),in_len=0,in_off=0),this.strm.avail_in=in_len,this.strm.input=input,this.strm.next_in=in_off,this.strm.avail_out=out_len,this.strm.output=out,this.strm.next_out=out_off,this.flush=flush,!async)return this._process(),this._checkError()?this._afterSync():void 0;var self=this;return process.nextTick(function(){self._process(),self._after()}),this},Zlib.prototype._afterSync=function(){var avail_out=this.strm.avail_out,avail_in=this.strm.avail_in;return this.write_in_progress=!1,[avail_in,avail_out]},Zlib.prototype._process=function(){var next_expected_header_byte=null;switch(this.mode){case exports.DEFLATE:case exports.GZIP:case exports.DEFLATERAW:this.err=zlib_deflate.deflate(this.strm,this.flush);break;case exports.UNZIP:switch(this.strm.avail_in>0&&(next_expected_header_byte=this.strm.next_in),this.gzip_id_bytes_read){case 0:if(null===next_expected_header_byte)break;if(31!==this.strm.input[next_expected_header_byte]){this.mode=exports.INFLATE;break}if(this.gzip_id_bytes_read=1,next_expected_header_byte++,1===this.strm.avail_in)break;case 1:if(null===next_expected_header_byte)break;139===this.strm.input[next_expected_header_byte]?(this.gzip_id_bytes_read=2,this.mode=exports.GUNZIP):this.mode=exports.INFLATE;break;default:throw new Error("invalid number of gzip magic number bytes read")}case exports.INFLATE:case exports.GUNZIP:case exports.INFLATERAW:for(this.err=zlib_inflate.inflate(this.strm,this.flush),this.err===exports.Z_NEED_DICT&&this.dictionary&&(this.err=zlib_inflate.inflateSetDictionary(this.strm,this.dictionary),this.err===exports.Z_OK?this.err=zlib_inflate.inflate(this.strm,this.flush):this.err===exports.Z_DATA_ERROR&&(this.err=exports.Z_NEED_DICT));this.strm.avail_in>0&&this.mode===exports.GUNZIP&&this.err===exports.Z_STREAM_END&&0!==this.strm.next_in[0];)this.reset(),this.err=zlib_inflate.inflate(this.strm,this.flush);break;default:throw new Error("Unknown mode "+this.mode)}},Zlib.prototype._checkError=function(){switch(this.err){case exports.Z_OK:case exports.Z_BUF_ERROR:if(0!==this.strm.avail_out&&this.flush===exports.Z_FINISH)return this._error("unexpected end of file"),!1;break;case exports.Z_STREAM_END:break;case exports.Z_NEED_DICT:return null==this.dictionary?this._error("Missing dictionary"):this._error("Bad dictionary"),!1;default:return this._error("Zlib error"),!1}return!0},Zlib.prototype._after=function(){if(this._checkError()){var avail_out=this.strm.avail_out,avail_in=this.strm.avail_in;this.write_in_progress=!1,this.callback(avail_in,avail_out),this.pending_close&&this.close()}},Zlib.prototype._error=function(message){this.strm.msg&&(message=this.strm.msg),this.onerror(message,this.err),this.write_in_progress=!1,this.pending_close&&this.close()},Zlib.prototype.init=function(windowBits,level,memLevel,strategy,dictionary){assert(4===arguments.length||5===arguments.length,"init(windowBits, level, memLevel, strategy, [dictionary])"),assert(windowBits>=8&&windowBits<=15,"invalid windowBits"),assert(level>=-1&&level<=9,"invalid compression level"),assert(memLevel>=1&&memLevel<=9,"invalid memlevel"),assert(strategy===exports.Z_FILTERED||strategy===exports.Z_HUFFMAN_ONLY||strategy===exports.Z_RLE||strategy===exports.Z_FIXED||strategy===exports.Z_DEFAULT_STRATEGY,"invalid strategy"),this._init(level,windowBits,memLevel,strategy,dictionary),this._setDictionary()},Zlib.prototype.params=function(){throw new Error("deflateParams Not supported")},Zlib.prototype.reset=function(){this._reset(),this._setDictionary()},Zlib.prototype._init=function(level,windowBits,memLevel,strategy,dictionary){switch(this.level=level,this.windowBits=windowBits,this.memLevel=memLevel,this.strategy=strategy,this.flush=exports.Z_NO_FLUSH,this.err=exports.Z_OK,this.mode!==exports.GZIP&&this.mode!==exports.GUNZIP||(this.windowBits+=16),this.mode===exports.UNZIP&&(this.windowBits+=32),this.mode!==exports.DEFLATERAW&&this.mode!==exports.INFLATERAW||(this.windowBits=-1*this.windowBits),this.strm=new Zstream,this.mode){case exports.DEFLATE:case exports.GZIP:case exports.DEFLATERAW:this.err=zlib_deflate.deflateInit2(this.strm,this.level,exports.Z_DEFLATED,this.windowBits,this.memLevel,this.strategy);break;case exports.INFLATE:case exports.GUNZIP:case exports.INFLATERAW:case exports.UNZIP:this.err=zlib_inflate.inflateInit2(this.strm,this.windowBits);break;default:throw new Error("Unknown mode "+this.mode)}this.err!==exports.Z_OK&&this._error("Init error"),this.dictionary=dictionary,this.write_in_progress=!1,this.init_done=!0},Zlib.prototype._setDictionary=function(){if(null!=this.dictionary){switch(this.err=exports.Z_OK,this.mode){case exports.DEFLATE:case exports.DEFLATERAW:this.err=zlib_deflate.deflateSetDictionary(this.strm,this.dictionary)}this.err!==exports.Z_OK&&this._error("Failed to set dictionary")}},Zlib.prototype._reset=function(){switch(this.err=exports.Z_OK,this.mode){case exports.DEFLATE:case exports.DEFLATERAW:case exports.GZIP:this.err=zlib_deflate.deflateReset(this.strm);break;case exports.INFLATE:case exports.INFLATERAW:case exports.GUNZIP:this.err=zlib_inflate.inflateReset(this.strm)}this.err!==exports.Z_OK&&this._error("Failed to reset stream")},exports.Zlib=Zlib}).call(this,__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/node_modules/buffer/index.js?5702").Buffer,__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/node_modules/process/browser.js?262b"))},"../../AppData/Roaming/npm/node_modules/webpack/node_modules/browserify-zlib/lib/index.js":function(module,exports,__webpack_require__){"use strict";(function(process){var Buffer=__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/node_modules/buffer/index.js?5702").Buffer,Transform=__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/node_modules/stream-browserify/index.js").Transform,binding=__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/node_modules/browserify-zlib/lib/binding.js"),util=__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/node_modules/util/util.js"),assert=__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/node_modules/assert/assert.js").ok,kMaxLength=__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/node_modules/buffer/index.js?5702").kMaxLength,kRangeErrorMessage="Cannot create final Buffer. It would be larger than 0x"+kMaxLength.toString(16)+" bytes";binding.Z_MIN_WINDOWBITS=8,binding.Z_MAX_WINDOWBITS=15,binding.Z_DEFAULT_WINDOWBITS=15,binding.Z_MIN_CHUNK=64,binding.Z_MAX_CHUNK=1/0,binding.Z_DEFAULT_CHUNK=16384,binding.Z_MIN_MEMLEVEL=1,binding.Z_MAX_MEMLEVEL=9,binding.Z_DEFAULT_MEMLEVEL=8,binding.Z_MIN_LEVEL=-1,binding.Z_MAX_LEVEL=9,binding.Z_DEFAULT_LEVEL=binding.Z_DEFAULT_COMPRESSION;for(var bkeys=Object.keys(binding),bk=0;bk<bkeys.length;bk++){var bkey=bkeys[bk];bkey.match(/^Z/)&&Object.defineProperty(exports,bkey,{enumerable:!0,value:binding[bkey],writable:!1})}for(var codes={Z_OK:binding.Z_OK,Z_STREAM_END:binding.Z_STREAM_END,Z_NEED_DICT:binding.Z_NEED_DICT,Z_ERRNO:binding.Z_ERRNO,Z_STREAM_ERROR:binding.Z_STREAM_ERROR,Z_DATA_ERROR:binding.Z_DATA_ERROR,Z_MEM_ERROR:binding.Z_MEM_ERROR,Z_BUF_ERROR:binding.Z_BUF_ERROR,Z_VERSION_ERROR:binding.Z_VERSION_ERROR},ckeys=Object.keys(codes),ck=0;ck<ckeys.length;ck++){var ckey=ckeys[ck];codes[codes[ckey]]=ckey}function zlibBuffer(engine,buffer,callback){var buffers=[],nread=0;function flow(){for(var chunk;null!==(chunk=engine.read());)buffers.push(chunk),nread+=chunk.length;engine.once("readable",flow)}function onEnd(){var buf,err=null;nread>=kMaxLength?err=new RangeError(kRangeErrorMessage):buf=Buffer.concat(buffers,nread),buffers=[],engine.close(),callback(err,buf)}engine.on("error",function(err){engine.removeListener("end",onEnd),engine.removeListener("readable",flow),callback(err)}),engine.on("end",onEnd),engine.end(buffer),flow()}function zlibBufferSync(engine,buffer){if("string"==typeof buffer&&(buffer=Buffer.from(buffer)),!Buffer.isBuffer(buffer))throw new TypeError("Not a string or buffer");var flushFlag=engine._finishFlushFlag;return engine._processChunk(buffer,flushFlag)}function Deflate(opts){if(!(this instanceof Deflate))return new Deflate(opts);Zlib.call(this,opts,binding.DEFLATE)}function Inflate(opts){if(!(this instanceof Inflate))return new Inflate(opts);Zlib.call(this,opts,binding.INFLATE)}function Gzip(opts){if(!(this instanceof Gzip))return new Gzip(opts);Zlib.call(this,opts,binding.GZIP)}function Gunzip(opts){if(!(this instanceof Gunzip))return new Gunzip(opts);Zlib.call(this,opts,binding.GUNZIP)}function DeflateRaw(opts){if(!(this instanceof DeflateRaw))return new DeflateRaw(opts);Zlib.call(this,opts,binding.DEFLATERAW)}function InflateRaw(opts){if(!(this instanceof InflateRaw))return new InflateRaw(opts);Zlib.call(this,opts,binding.INFLATERAW)}function Unzip(opts){if(!(this instanceof Unzip))return new Unzip(opts);Zlib.call(this,opts,binding.UNZIP)}function isValidFlushFlag(flag){return flag===binding.Z_NO_FLUSH||flag===binding.Z_PARTIAL_FLUSH||flag===binding.Z_SYNC_FLUSH||flag===binding.Z_FULL_FLUSH||flag===binding.Z_FINISH||flag===binding.Z_BLOCK}function Zlib(opts,mode){var _this=this;if(this._opts=opts=opts||{},this._chunkSize=opts.chunkSize||exports.Z_DEFAULT_CHUNK,Transform.call(this,opts),opts.flush&&!isValidFlushFlag(opts.flush))throw new Error("Invalid flush flag: "+opts.flush);if(opts.finishFlush&&!isValidFlushFlag(opts.finishFlush))throw new Error("Invalid flush flag: "+opts.finishFlush);if(this._flushFlag=opts.flush||binding.Z_NO_FLUSH,this._finishFlushFlag=void 0!==opts.finishFlush?opts.finishFlush:binding.Z_FINISH,opts.chunkSize&&(opts.chunkSize<exports.Z_MIN_CHUNK||opts.chunkSize>exports.Z_MAX_CHUNK))throw new Error("Invalid chunk size: "+opts.chunkSize);if(opts.windowBits&&(opts.windowBits<exports.Z_MIN_WINDOWBITS||opts.windowBits>exports.Z_MAX_WINDOWBITS))throw new Error("Invalid windowBits: "+opts.windowBits);if(opts.level&&(opts.level<exports.Z_MIN_LEVEL||opts.level>exports.Z_MAX_LEVEL))throw new Error("Invalid compression level: "+opts.level);if(opts.memLevel&&(opts.memLevel<exports.Z_MIN_MEMLEVEL||opts.memLevel>exports.Z_MAX_MEMLEVEL))throw new Error("Invalid memLevel: "+opts.memLevel);if(opts.strategy&&opts.strategy!=exports.Z_FILTERED&&opts.strategy!=exports.Z_HUFFMAN_ONLY&&opts.strategy!=exports.Z_RLE&&opts.strategy!=exports.Z_FIXED&&opts.strategy!=exports.Z_DEFAULT_STRATEGY)throw new Error("Invalid strategy: "+opts.strategy);if(opts.dictionary&&!Buffer.isBuffer(opts.dictionary))throw new Error("Invalid dictionary: it should be a Buffer instance");this._handle=new binding.Zlib(mode);var self=this;this._hadError=!1,this._handle.onerror=function(message,errno){_close(self),self._hadError=!0;var error=new Error(message);error.errno=errno,error.code=exports.codes[errno],self.emit("error",error)};var level=exports.Z_DEFAULT_COMPRESSION;"number"==typeof opts.level&&(level=opts.level);var strategy=exports.Z_DEFAULT_STRATEGY;"number"==typeof opts.strategy&&(strategy=opts.strategy),this._handle.init(opts.windowBits||exports.Z_DEFAULT_WINDOWBITS,level,opts.memLevel||exports.Z_DEFAULT_MEMLEVEL,strategy,opts.dictionary),this._buffer=Buffer.allocUnsafe(this._chunkSize),this._offset=0,this._level=level,this._strategy=strategy,this.once("end",this.close),Object.defineProperty(this,"_closed",{get:function(){return!_this._handle},configurable:!0,enumerable:!0})}function _close(engine,callback){callback&&process.nextTick(callback),engine._handle&&(engine._handle.close(),engine._handle=null)}function emitCloseNT(self){self.emit("close")}Object.defineProperty(exports,"codes",{enumerable:!0,value:Object.freeze(codes),writable:!1}),exports.Deflate=Deflate,exports.Inflate=Inflate,exports.Gzip=Gzip,exports.Gunzip=Gunzip,exports.DeflateRaw=DeflateRaw,exports.InflateRaw=InflateRaw,exports.Unzip=Unzip,exports.createDeflate=function(o){return new Deflate(o)},exports.createInflate=function(o){return new Inflate(o)},exports.createDeflateRaw=function(o){return new DeflateRaw(o)},exports.createInflateRaw=function(o){return new InflateRaw(o)},exports.createGzip=function(o){return new Gzip(o)},exports.createGunzip=function(o){return new Gunzip(o)},exports.createUnzip=function(o){return new Unzip(o)},exports.deflate=function(buffer,opts,callback){return"function"==typeof opts&&(callback=opts,opts={}),zlibBuffer(new Deflate(opts),buffer,callback)},exports.deflateSync=function(buffer,opts){return zlibBufferSync(new Deflate(opts),buffer)},exports.gzip=function(buffer,opts,callback){return"function"==typeof opts&&(callback=opts,opts={}),zlibBuffer(new Gzip(opts),buffer,callback)},exports.gzipSync=function(buffer,opts){return zlibBufferSync(new Gzip(opts),buffer)},exports.deflateRaw=function(buffer,opts,callback){return"function"==typeof opts&&(callback=opts,opts={}),zlibBuffer(new DeflateRaw(opts),buffer,callback)},exports.deflateRawSync=function(buffer,opts){return zlibBufferSync(new DeflateRaw(opts),buffer)},exports.unzip=function(buffer,opts,callback){return"function"==typeof opts&&(callback=opts,opts={}),zlibBuffer(new Unzip(opts),buffer,callback)},exports.unzipSync=function(buffer,opts){return zlibBufferSync(new Unzip(opts),buffer)},exports.inflate=function(buffer,opts,callback){return"function"==typeof opts&&(callback=opts,opts={}),zlibBuffer(new Inflate(opts),buffer,callback)},exports.inflateSync=function(buffer,opts){return zlibBufferSync(new Inflate(opts),buffer)},exports.gunzip=function(buffer,opts,callback){return"function"==typeof opts&&(callback=opts,opts={}),zlibBuffer(new Gunzip(opts),buffer,callback)},exports.gunzipSync=function(buffer,opts){return zlibBufferSync(new Gunzip(opts),buffer)},exports.inflateRaw=function(buffer,opts,callback){return"function"==typeof opts&&(callback=opts,opts={}),zlibBuffer(new InflateRaw(opts),buffer,callback)},exports.inflateRawSync=function(buffer,opts){return zlibBufferSync(new InflateRaw(opts),buffer)},util.inherits(Zlib,Transform),Zlib.prototype.params=function(level,strategy,callback){if(level<exports.Z_MIN_LEVEL||level>exports.Z_MAX_LEVEL)throw new RangeError("Invalid compression level: "+level);if(strategy!=exports.Z_FILTERED&&strategy!=exports.Z_HUFFMAN_ONLY&&strategy!=exports.Z_RLE&&strategy!=exports.Z_FIXED&&strategy!=exports.Z_DEFAULT_STRATEGY)throw new TypeError("Invalid strategy: "+strategy);if(this._level!==level||this._strategy!==strategy){var self=this;this.flush(binding.Z_SYNC_FLUSH,function(){assert(self._handle,"zlib binding closed"),self._handle.params(level,strategy),self._hadError||(self._level=level,self._strategy=strategy,callback&&callback())})}else process.nextTick(callback)},Zlib.prototype.reset=function(){return assert(this._handle,"zlib binding closed"),this._handle.reset()},Zlib.prototype._flush=function(callback){this._transform(Buffer.alloc(0),"",callback)},Zlib.prototype.flush=function(kind,callback){var _this2=this,ws=this._writableState;("function"==typeof kind||void 0===kind&&!callback)&&(callback=kind,kind=binding.Z_FULL_FLUSH),ws.ended?callback&&process.nextTick(callback):ws.ending?callback&&this.once("end",callback):ws.needDrain?callback&&this.once("drain",function(){return _this2.flush(kind,callback)}):(this._flushFlag=kind,this.write(Buffer.alloc(0),"",callback))},Zlib.prototype.close=function(callback){_close(this,callback),process.nextTick(emitCloseNT,this)},Zlib.prototype._transform=function(chunk,encoding,cb){var flushFlag,ws=this._writableState,last=(ws.ending||ws.ended)&&(!chunk||ws.length===chunk.length);return null===chunk||Buffer.isBuffer(chunk)?this._handle?(last?flushFlag=this._finishFlushFlag:(flushFlag=this._flushFlag,chunk.length>=ws.length&&(this._flushFlag=this._opts.flush||binding.Z_NO_FLUSH)),void this._processChunk(chunk,flushFlag,cb)):cb(new Error("zlib binding closed")):cb(new Error("invalid input"))},Zlib.prototype._processChunk=function(chunk,flushFlag,cb){var availInBefore=chunk&&chunk.length,availOutBefore=this._chunkSize-this._offset,inOff=0,self=this,async="function"==typeof cb;if(!async){var error,buffers=[],nread=0;this.on("error",function(er){error=er}),assert(this._handle,"zlib binding closed");do{var res=this._handle.writeSync(flushFlag,chunk,inOff,availInBefore,this._buffer,this._offset,availOutBefore)}while(!this._hadError&&callback(res[0],res[1]));if(this._hadError)throw error;if(nread>=kMaxLength)throw _close(this),new RangeError(kRangeErrorMessage);var buf=Buffer.concat(buffers,nread);return _close(this),buf}assert(this._handle,"zlib binding closed");var req=this._handle.write(flushFlag,chunk,inOff,availInBefore,this._buffer,this._offset,availOutBefore);function callback(availInAfter,availOutAfter){if(this&&(this.buffer=null,this.callback=null),!self._hadError){var have=availOutBefore-availOutAfter;if(assert(have>=0,"have should not go down"),have>0){var out=self._buffer.slice(self._offset,self._offset+have);self._offset+=have,async?self.push(out):(buffers.push(out),nread+=out.length)}if((0===availOutAfter||self._offset>=self._chunkSize)&&(availOutBefore=self._chunkSize,self._offset=0,self._buffer=Buffer.allocUnsafe(self._chunkSize)),0===availOutAfter){if(inOff+=availInBefore-availInAfter,availInBefore=availInAfter,!async)return!0;var newReq=self._handle.write(flushFlag,chunk,inOff,availInBefore,self._buffer,self._offset,self._chunkSize);return newReq.callback=callback,void(newReq.buffer=chunk)}if(!async)return!1;cb()}}req.buffer=chunk,req.callback=callback},util.inherits(Deflate,Zlib),util.inherits(Inflate,Zlib),util.inherits(Gzip,Zlib),util.inherits(Gunzip,Zlib),util.inherits(DeflateRaw,Zlib),util.inherits(InflateRaw,Zlib),util.inherits(Unzip,Zlib)}).call(this,__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/node_modules/process/browser.js?262b"))},"../../AppData/Roaming/npm/node_modules/webpack/node_modules/buffer/index.js?5702":function(module,exports,__webpack_require__){"use strict";(function(global){var base64=__webpack_require__("./node_modules/base64-js/index.js"),ieee754=__webpack_require__("./node_modules/ieee754/index.js"),isArray=__webpack_require__("./node_modules/isarray/index.js");function kMaxLength(){return Buffer.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function createBuffer(that,length){if(kMaxLength()<length)throw new RangeError("Invalid typed array length");return Buffer.TYPED_ARRAY_SUPPORT?(that=new Uint8Array(length)).__proto__=Buffer.prototype:(null===that&&(that=new Buffer(length)),that.length=length),that}function Buffer(arg,encodingOrOffset,length){if(!(Buffer.TYPED_ARRAY_SUPPORT||this instanceof Buffer))return new Buffer(arg,encodingOrOffset,length);if("number"==typeof arg){if("string"==typeof encodingOrOffset)throw new Error("If encoding is specified then the first argument must be a string");return allocUnsafe(this,arg)}return from(this,arg,encodingOrOffset,length)}function from(that,value,encodingOrOffset,length){if("number"==typeof value)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&value instanceof ArrayBuffer?function(that,array,byteOffset,length){if(array.byteLength,byteOffset<0||array.byteLength<byteOffset)throw new RangeError("'offset' is out of bounds");if(array.byteLength<byteOffset+(length||0))throw new RangeError("'length' is out of bounds");array=void 0===byteOffset&&void 0===length?new Uint8Array(array):void 0===length?new Uint8Array(array,byteOffset):new Uint8Array(array,byteOffset,length);Buffer.TYPED_ARRAY_SUPPORT?(that=array).__proto__=Buffer.prototype:that=fromArrayLike(that,array);return that}(that,value,encodingOrOffset,length):"string"==typeof value?function(that,string,encoding){"string"==typeof encoding&&""!==encoding||(encoding="utf8");if(!Buffer.isEncoding(encoding))throw new TypeError('"encoding" must be a valid string encoding');var length=0|byteLength(string,encoding),actual=(that=createBuffer(that,length)).write(string,encoding);actual!==length&&(that=that.slice(0,actual));return that}(that,value,encodingOrOffset):function(that,obj){if(Buffer.isBuffer(obj)){var len=0|checked(obj.length);return 0===(that=createBuffer(that,len)).length?that:(obj.copy(that,0,0,len),that)}if(obj){if("undefined"!=typeof ArrayBuffer&&obj.buffer instanceof ArrayBuffer||"length"in obj)return"number"!=typeof obj.length||(val=obj.length)!=val?createBuffer(that,0):fromArrayLike(that,obj);if("Buffer"===obj.type&&isArray(obj.data))return fromArrayLike(that,obj.data)}var val;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(that,value)}function assertSize(size){if("number"!=typeof size)throw new TypeError('"size" argument must be a number');if(size<0)throw new RangeError('"size" argument must not be negative')}function allocUnsafe(that,size){if(assertSize(size),that=createBuffer(that,size<0?0:0|checked(size)),!Buffer.TYPED_ARRAY_SUPPORT)for(var i=0;i<size;++i)that[i]=0;return that}function fromArrayLike(that,array){var length=array.length<0?0:0|checked(array.length);that=createBuffer(that,length);for(var i=0;i<length;i+=1)that[i]=255&array[i];return that}function checked(length){if(length>=kMaxLength())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+kMaxLength().toString(16)+" bytes");return 0|length}function byteLength(string,encoding){if(Buffer.isBuffer(string))return string.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(string)||string instanceof ArrayBuffer))return string.byteLength;"string"!=typeof string&&(string=""+string);var len=string.length;if(0===len)return 0;for(var loweredCase=!1;;)switch(encoding){case"ascii":case"latin1":case"binary":return len;case"utf8":case"utf-8":case void 0:return utf8ToBytes(string).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*len;case"hex":return len>>>1;case"base64":return base64ToBytes(string).length;default:if(loweredCase)return utf8ToBytes(string).length;encoding=(""+encoding).toLowerCase(),loweredCase=!0}}function swap(b,n,m){var i=b[n];b[n]=b[m],b[m]=i}function bidirectionalIndexOf(buffer,val,byteOffset,encoding,dir){if(0===buffer.length)return-1;if("string"==typeof byteOffset?(encoding=byteOffset,byteOffset=0):byteOffset>2147483647?byteOffset=2147483647:byteOffset<-2147483648&&(byteOffset=-2147483648),byteOffset=+byteOffset,isNaN(byteOffset)&&(byteOffset=dir?0:buffer.length-1),byteOffset<0&&(byteOffset=buffer.length+byteOffset),byteOffset>=buffer.length){if(dir)return-1;byteOffset=buffer.length-1}else if(byteOffset<0){if(!dir)return-1;byteOffset=0}if("string"==typeof val&&(val=Buffer.from(val,encoding)),Buffer.isBuffer(val))return 0===val.length?-1:arrayIndexOf(buffer,val,byteOffset,encoding,dir);if("number"==typeof val)return val&=255,Buffer.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?dir?Uint8Array.prototype.indexOf.call(buffer,val,byteOffset):Uint8Array.prototype.lastIndexOf.call(buffer,val,byteOffset):arrayIndexOf(buffer,[val],byteOffset,encoding,dir);throw new TypeError("val must be string, number or Buffer")}function arrayIndexOf(arr,val,byteOffset,encoding,dir){var i,indexSize=1,arrLength=arr.length,valLength=val.length;if(void 0!==encoding&&("ucs2"===(encoding=String(encoding).toLowerCase())||"ucs-2"===encoding||"utf16le"===encoding||"utf-16le"===encoding)){if(arr.length<2||val.length<2)return-1;indexSize=2,arrLength/=2,valLength/=2,byteOffset/=2}function read(buf,i){return 1===indexSize?buf[i]:buf.readUInt16BE(i*indexSize)}if(dir){var foundIndex=-1;for(i=byteOffset;i<arrLength;i++)if(read(arr,i)===read(val,-1===foundIndex?0:i-foundIndex)){if(-1===foundIndex&&(foundIndex=i),i-foundIndex+1===valLength)return foundIndex*indexSize}else-1!==foundIndex&&(i-=i-foundIndex),foundIndex=-1}else for(byteOffset+valLength>arrLength&&(byteOffset=arrLength-valLength),i=byteOffset;i>=0;i--){for(var found=!0,j=0;j<valLength;j++)if(read(arr,i+j)!==read(val,j)){found=!1;break}if(found)return i}return-1}function hexWrite(buf,string,offset,length){offset=Number(offset)||0;var remaining=buf.length-offset;length?(length=Number(length))>remaining&&(length=remaining):length=remaining;var strLen=string.length;if(strLen%2!=0)throw new TypeError("Invalid hex string");length>strLen/2&&(length=strLen/2);for(var i=0;i<length;++i){var parsed=parseInt(string.substr(2*i,2),16);if(isNaN(parsed))return i;buf[offset+i]=parsed}return i}function utf8Write(buf,string,offset,length){return blitBuffer(utf8ToBytes(string,buf.length-offset),buf,offset,length)}function asciiWrite(buf,string,offset,length){return blitBuffer(function(str){for(var byteArray=[],i=0;i<str.length;++i)byteArray.push(255&str.charCodeAt(i));return byteArray}(string),buf,offset,length)}function latin1Write(buf,string,offset,length){return asciiWrite(buf,string,offset,length)}function base64Write(buf,string,offset,length){return blitBuffer(base64ToBytes(string),buf,offset,length)}function ucs2Write(buf,string,offset,length){return blitBuffer(function(str,units){for(var c,hi,lo,byteArray=[],i=0;i<str.length&&!((units-=2)<0);++i)c=str.charCodeAt(i),hi=c>>8,lo=c%256,byteArray.push(lo),byteArray.push(hi);return byteArray}(string,buf.length-offset),buf,offset,length)}function base64Slice(buf,start,end){return 0===start&&end===buf.length?base64.fromByteArray(buf):base64.fromByteArray(buf.slice(start,end))}function utf8Slice(buf,start,end){end=Math.min(buf.length,end);for(var res=[],i=start;i<end;){var secondByte,thirdByte,fourthByte,tempCodePoint,firstByte=buf[i],codePoint=null,bytesPerSequence=firstByte>239?4:firstByte>223?3:firstByte>191?2:1;if(i+bytesPerSequence<=end)switch(bytesPerSequence){case 1:firstByte<128&&(codePoint=firstByte);break;case 2:128==(192&(secondByte=buf[i+1]))&&(tempCodePoint=(31&firstByte)<<6|63&secondByte)>127&&(codePoint=tempCodePoint);break;case 3:secondByte=buf[i+1],thirdByte=buf[i+2],128==(192&secondByte)&&128==(192&thirdByte)&&(tempCodePoint=(15&firstByte)<<12|(63&secondByte)<<6|63&thirdByte)>2047&&(tempCodePoint<55296||tempCodePoint>57343)&&(codePoint=tempCodePoint);break;case 4:secondByte=buf[i+1],thirdByte=buf[i+2],fourthByte=buf[i+3],128==(192&secondByte)&&128==(192&thirdByte)&&128==(192&fourthByte)&&(tempCodePoint=(15&firstByte)<<18|(63&secondByte)<<12|(63&thirdByte)<<6|63&fourthByte)>65535&&tempCodePoint<1114112&&(codePoint=tempCodePoint)}null===codePoint?(codePoint=65533,bytesPerSequence=1):codePoint>65535&&(codePoint-=65536,res.push(codePoint>>>10&1023|55296),codePoint=56320|1023&codePoint),res.push(codePoint),i+=bytesPerSequence}return function(codePoints){var len=codePoints.length;if(len<=MAX_ARGUMENTS_LENGTH)return String.fromCharCode.apply(String,codePoints);var res="",i=0;for(;i<len;)res+=String.fromCharCode.apply(String,codePoints.slice(i,i+=MAX_ARGUMENTS_LENGTH));return res}(res)}exports.Buffer=Buffer,exports.SlowBuffer=function(length){+length!=length&&(length=0);return Buffer.alloc(+length)},exports.INSPECT_MAX_BYTES=50,Buffer.TYPED_ARRAY_SUPPORT=void 0!==global.TYPED_ARRAY_SUPPORT?global.TYPED_ARRAY_SUPPORT:function(){try{var arr=new Uint8Array(1);return arr.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===arr.foo()&&"function"==typeof arr.subarray&&0===arr.subarray(1,1).byteLength}catch(e){return!1}}(),exports.kMaxLength=kMaxLength(),Buffer.poolSize=8192,Buffer._augment=function(arr){return arr.__proto__=Buffer.prototype,arr},Buffer.from=function(value,encodingOrOffset,length){return from(null,value,encodingOrOffset,length)},Buffer.TYPED_ARRAY_SUPPORT&&(Buffer.prototype.__proto__=Uint8Array.prototype,Buffer.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&Buffer[Symbol.species]===Buffer&&Object.defineProperty(Buffer,Symbol.species,{value:null,configurable:!0})),Buffer.alloc=function(size,fill,encoding){return function(that,size,fill,encoding){return assertSize(size),size<=0?createBuffer(that,size):void 0!==fill?"string"==typeof encoding?createBuffer(that,size).fill(fill,encoding):createBuffer(that,size).fill(fill):createBuffer(that,size)}(null,size,fill,encoding)},Buffer.allocUnsafe=function(size){return allocUnsafe(null,size)},Buffer.allocUnsafeSlow=function(size){return allocUnsafe(null,size)},Buffer.isBuffer=function(b){return!(null==b||!b._isBuffer)},Buffer.compare=function(a,b){if(!Buffer.isBuffer(a)||!Buffer.isBuffer(b))throw new TypeError("Arguments must be Buffers");if(a===b)return 0;for(var x=a.length,y=b.length,i=0,len=Math.min(x,y);i<len;++i)if(a[i]!==b[i]){x=a[i],y=b[i];break}return x<y?-1:y<x?1:0},Buffer.isEncoding=function(encoding){switch(String(encoding).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Buffer.concat=function(list,length){if(!isArray(list))throw new TypeError('"list" argument must be an Array of Buffers');if(0===list.length)return Buffer.alloc(0);var i;if(void 0===length)for(length=0,i=0;i<list.length;++i)length+=list[i].length;var buffer=Buffer.allocUnsafe(length),pos=0;for(i=0;i<list.length;++i){var buf=list[i];if(!Buffer.isBuffer(buf))throw new TypeError('"list" argument must be an Array of Buffers');buf.copy(buffer,pos),pos+=buf.length}return buffer},Buffer.byteLength=byteLength,Buffer.prototype._isBuffer=!0,Buffer.prototype.swap16=function(){var len=this.length;if(len%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var i=0;i<len;i+=2)swap(this,i,i+1);return this},Buffer.prototype.swap32=function(){var len=this.length;if(len%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var i=0;i<len;i+=4)swap(this,i,i+3),swap(this,i+1,i+2);return this},Buffer.prototype.swap64=function(){var len=this.length;if(len%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var i=0;i<len;i+=8)swap(this,i,i+7),swap(this,i+1,i+6),swap(this,i+2,i+5),swap(this,i+3,i+4);return this},Buffer.prototype.toString=function(){var length=0|this.length;return 0===length?"":0===arguments.length?utf8Slice(this,0,length):function(encoding,start,end){var loweredCase=!1;if((void 0===start||start<0)&&(start=0),start>this.length)return"";if((void 0===end||end>this.length)&&(end=this.length),end<=0)return"";if((end>>>=0)<=(start>>>=0))return"";for(encoding||(encoding="utf8");;)switch(encoding){case"hex":return hexSlice(this,start,end);case"utf8":case"utf-8":return utf8Slice(this,start,end);case"ascii":return asciiSlice(this,start,end);case"latin1":case"binary":return latin1Slice(this,start,end);case"base64":return base64Slice(this,start,end);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this,start,end);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(encoding+"").toLowerCase(),loweredCase=!0}}.apply(this,arguments)},Buffer.prototype.equals=function(b){if(!Buffer.isBuffer(b))throw new TypeError("Argument must be a Buffer");return this===b||0===Buffer.compare(this,b)},Buffer.prototype.inspect=function(){var str="",max=exports.INSPECT_MAX_BYTES;return this.length>0&&(str=this.toString("hex",0,max).match(/.{2}/g).join(" "),this.length>max&&(str+=" ... ")),"<Buffer "+str+">"},Buffer.prototype.compare=function(target,start,end,thisStart,thisEnd){if(!Buffer.isBuffer(target))throw new TypeError("Argument must be a Buffer");if(void 0===start&&(start=0),void 0===end&&(end=target?target.length:0),void 0===thisStart&&(thisStart=0),void 0===thisEnd&&(thisEnd=this.length),start<0||end>target.length||thisStart<0||thisEnd>this.length)throw new RangeError("out of range index");if(thisStart>=thisEnd&&start>=end)return 0;if(thisStart>=thisEnd)return-1;if(start>=end)return 1;if(start>>>=0,end>>>=0,thisStart>>>=0,thisEnd>>>=0,this===target)return 0;for(var x=thisEnd-thisStart,y=end-start,len=Math.min(x,y),thisCopy=this.slice(thisStart,thisEnd),targetCopy=target.slice(start,end),i=0;i<len;++i)if(thisCopy[i]!==targetCopy[i]){x=thisCopy[i],y=targetCopy[i];break}return x<y?-1:y<x?1:0},Buffer.prototype.includes=function(val,byteOffset,encoding){return-1!==this.indexOf(val,byteOffset,encoding)},Buffer.prototype.indexOf=function(val,byteOffset,encoding){return bidirectionalIndexOf(this,val,byteOffset,encoding,!0)},Buffer.prototype.lastIndexOf=function(val,byteOffset,encoding){return bidirectionalIndexOf(this,val,byteOffset,encoding,!1)},Buffer.prototype.write=function(string,offset,length,encoding){if(void 0===offset)encoding="utf8",length=this.length,offset=0;else if(void 0===length&&"string"==typeof offset)encoding=offset,length=this.length,offset=0;else{if(!isFinite(offset))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");offset|=0,isFinite(length)?(length|=0,void 0===encoding&&(encoding="utf8")):(encoding=length,length=void 0)}var remaining=this.length-offset;if((void 0===length||length>remaining)&&(length=remaining),string.length>0&&(length<0||offset<0)||offset>this.length)throw new RangeError("Attempt to write outside buffer bounds");encoding||(encoding="utf8");for(var loweredCase=!1;;)switch(encoding){case"hex":return hexWrite(this,string,offset,length);case"utf8":case"utf-8":return utf8Write(this,string,offset,length);case"ascii":return asciiWrite(this,string,offset,length);case"latin1":case"binary":return latin1Write(this,string,offset,length);case"base64":return base64Write(this,string,offset,length);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ucs2Write(this,string,offset,length);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(""+encoding).toLowerCase(),loweredCase=!0}},Buffer.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var MAX_ARGUMENTS_LENGTH=4096;function asciiSlice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;i<end;++i)ret+=String.fromCharCode(127&buf[i]);return ret}function latin1Slice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;i<end;++i)ret+=String.fromCharCode(buf[i]);return ret}function hexSlice(buf,start,end){var len=buf.length;(!start||start<0)&&(start=0),(!end||end<0||end>len)&&(end=len);for(var out="",i=start;i<end;++i)out+=toHex(buf[i]);return out}function utf16leSlice(buf,start,end){for(var bytes=buf.slice(start,end),res="",i=0;i<bytes.length;i+=2)res+=String.fromCharCode(bytes[i]+256*bytes[i+1]);return res}function checkOffset(offset,ext,length){if(offset%1!=0||offset<0)throw new RangeError("offset is not uint");if(offset+ext>length)throw new RangeError("Trying to access beyond buffer length")}function checkInt(buf,value,offset,ext,max,min){if(!Buffer.isBuffer(buf))throw new TypeError('"buffer" argument must be a Buffer instance');if(value>max||value<min)throw new RangeError('"value" argument is out of bounds');if(offset+ext>buf.length)throw new RangeError("Index out of range")}function objectWriteUInt16(buf,value,offset,littleEndian){value<0&&(value=65535+value+1);for(var i=0,j=Math.min(buf.length-offset,2);i<j;++i)buf[offset+i]=(value&255<<8*(littleEndian?i:1-i))>>>8*(littleEndian?i:1-i)}function objectWriteUInt32(buf,value,offset,littleEndian){value<0&&(value=4294967295+value+1);for(var i=0,j=Math.min(buf.length-offset,4);i<j;++i)buf[offset+i]=value>>>8*(littleEndian?i:3-i)&255}function checkIEEE754(buf,value,offset,ext,max,min){if(offset+ext>buf.length)throw new RangeError("Index out of range");if(offset<0)throw new RangeError("Index out of range")}function writeFloat(buf,value,offset,littleEndian,noAssert){return noAssert||checkIEEE754(buf,0,offset,4),ieee754.write(buf,value,offset,littleEndian,23,4),offset+4}function writeDouble(buf,value,offset,littleEndian,noAssert){return noAssert||checkIEEE754(buf,0,offset,8),ieee754.write(buf,value,offset,littleEndian,52,8),offset+8}Buffer.prototype.slice=function(start,end){var newBuf,len=this.length;if(start=~~start,end=void 0===end?len:~~end,start<0?(start+=len)<0&&(start=0):start>len&&(start=len),end<0?(end+=len)<0&&(end=0):end>len&&(end=len),end<start&&(end=start),Buffer.TYPED_ARRAY_SUPPORT)(newBuf=this.subarray(start,end)).__proto__=Buffer.prototype;else{var sliceLen=end-start;newBuf=new Buffer(sliceLen,void 0);for(var i=0;i<sliceLen;++i)newBuf[i]=this[i+start]}return newBuf},Buffer.prototype.readUIntLE=function(offset,byteLength,noAssert){offset|=0,byteLength|=0,noAssert||checkOffset(offset,byteLength,this.length);for(var val=this[offset],mul=1,i=0;++i<byteLength&&(mul*=256);)val+=this[offset+i]*mul;return val},Buffer.prototype.readUIntBE=function(offset,byteLength,noAssert){offset|=0,byteLength|=0,noAssert||checkOffset(offset,byteLength,this.length);for(var val=this[offset+--byteLength],mul=1;byteLength>0&&(mul*=256);)val+=this[offset+--byteLength]*mul;return val},Buffer.prototype.readUInt8=function(offset,noAssert){return noAssert||checkOffset(offset,1,this.length),this[offset]},Buffer.prototype.readUInt16LE=function(offset,noAssert){return noAssert||checkOffset(offset,2,this.length),this[offset]|this[offset+1]<<8},Buffer.prototype.readUInt16BE=function(offset,noAssert){return noAssert||checkOffset(offset,2,this.length),this[offset]<<8|this[offset+1]},Buffer.prototype.readUInt32LE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),(this[offset]|this[offset+1]<<8|this[offset+2]<<16)+16777216*this[offset+3]},Buffer.prototype.readUInt32BE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),16777216*this[offset]+(this[offset+1]<<16|this[offset+2]<<8|this[offset+3])},Buffer.prototype.readIntLE=function(offset,byteLength,noAssert){offset|=0,byteLength|=0,noAssert||checkOffset(offset,byteLength,this.length);for(var val=this[offset],mul=1,i=0;++i<byteLength&&(mul*=256);)val+=this[offset+i]*mul;return val>=(mul*=128)&&(val-=Math.pow(2,8*byteLength)),val},Buffer.prototype.readIntBE=function(offset,byteLength,noAssert){offset|=0,byteLength|=0,noAssert||checkOffset(offset,byteLength,this.length);for(var i=byteLength,mul=1,val=this[offset+--i];i>0&&(mul*=256);)val+=this[offset+--i]*mul;return val>=(mul*=128)&&(val-=Math.pow(2,8*byteLength)),val},Buffer.prototype.readInt8=function(offset,noAssert){return noAssert||checkOffset(offset,1,this.length),128&this[offset]?-1*(255-this[offset]+1):this[offset]},Buffer.prototype.readInt16LE=function(offset,noAssert){noAssert||checkOffset(offset,2,this.length);var val=this[offset]|this[offset+1]<<8;return 32768&val?4294901760|val:val},Buffer.prototype.readInt16BE=function(offset,noAssert){noAssert||checkOffset(offset,2,this.length);var val=this[offset+1]|this[offset]<<8;return 32768&val?4294901760|val:val},Buffer.prototype.readInt32LE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),this[offset]|this[offset+1]<<8|this[offset+2]<<16|this[offset+3]<<24},Buffer.prototype.readInt32BE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),this[offset]<<24|this[offset+1]<<16|this[offset+2]<<8|this[offset+3]},Buffer.prototype.readFloatLE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),ieee754.read(this,offset,!0,23,4)},Buffer.prototype.readFloatBE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),ieee754.read(this,offset,!1,23,4)},Buffer.prototype.readDoubleLE=function(offset,noAssert){return noAssert||checkOffset(offset,8,this.length),ieee754.read(this,offset,!0,52,8)},Buffer.prototype.readDoubleBE=function(offset,noAssert){return noAssert||checkOffset(offset,8,this.length),ieee754.read(this,offset,!1,52,8)},Buffer.prototype.writeUIntLE=function(value,offset,byteLength,noAssert){(value=+value,offset|=0,byteLength|=0,noAssert)||checkInt(this,value,offset,byteLength,Math.pow(2,8*byteLength)-1,0);var mul=1,i=0;for(this[offset]=255&value;++i<byteLength&&(mul*=256);)this[offset+i]=value/mul&255;return offset+byteLength},Buffer.prototype.writeUIntBE=function(value,offset,byteLength,noAssert){(value=+value,offset|=0,byteLength|=0,noAssert)||checkInt(this,value,offset,byteLength,Math.pow(2,8*byteLength)-1,0);var i=byteLength-1,mul=1;for(this[offset+i]=255&value;--i>=0&&(mul*=256);)this[offset+i]=value/mul&255;return offset+byteLength},Buffer.prototype.writeUInt8=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,1,255,0),Buffer.TYPED_ARRAY_SUPPORT||(value=Math.floor(value)),this[offset]=255&value,offset+1},Buffer.prototype.writeUInt16LE=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,2,65535,0),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=255&value,this[offset+1]=value>>>8):objectWriteUInt16(this,value,offset,!0),offset+2},Buffer.prototype.writeUInt16BE=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,2,65535,0),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value>>>8,this[offset+1]=255&value):objectWriteUInt16(this,value,offset,!1),offset+2},Buffer.prototype.writeUInt32LE=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,4,4294967295,0),Buffer.TYPED_ARRAY_SUPPORT?(this[offset+3]=value>>>24,this[offset+2]=value>>>16,this[offset+1]=value>>>8,this[offset]=255&value):objectWriteUInt32(this,value,offset,!0),offset+4},Buffer.prototype.writeUInt32BE=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,4,4294967295,0),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value>>>24,this[offset+1]=value>>>16,this[offset+2]=value>>>8,this[offset+3]=255&value):objectWriteUInt32(this,value,offset,!1),offset+4},Buffer.prototype.writeIntLE=function(value,offset,byteLength,noAssert){if(value=+value,offset|=0,!noAssert){var limit=Math.pow(2,8*byteLength-1);checkInt(this,value,offset,byteLength,limit-1,-limit)}var i=0,mul=1,sub=0;for(this[offset]=255&value;++i<byteLength&&(mul*=256);)value<0&&0===sub&&0!==this[offset+i-1]&&(sub=1),this[offset+i]=(value/mul>>0)-sub&255;return offset+byteLength},Buffer.prototype.writeIntBE=function(value,offset,byteLength,noAssert){if(value=+value,offset|=0,!noAssert){var limit=Math.pow(2,8*byteLength-1);checkInt(this,value,offset,byteLength,limit-1,-limit)}var i=byteLength-1,mul=1,sub=0;for(this[offset+i]=255&value;--i>=0&&(mul*=256);)value<0&&0===sub&&0!==this[offset+i+1]&&(sub=1),this[offset+i]=(value/mul>>0)-sub&255;return offset+byteLength},Buffer.prototype.writeInt8=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,1,127,-128),Buffer.TYPED_ARRAY_SUPPORT||(value=Math.floor(value)),value<0&&(value=255+value+1),this[offset]=255&value,offset+1},Buffer.prototype.writeInt16LE=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,2,32767,-32768),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=255&value,this[offset+1]=value>>>8):objectWriteUInt16(this,value,offset,!0),offset+2},Buffer.prototype.writeInt16BE=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,2,32767,-32768),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value>>>8,this[offset+1]=255&value):objectWriteUInt16(this,value,offset,!1),offset+2},Buffer.prototype.writeInt32LE=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,4,2147483647,-2147483648),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=255&value,this[offset+1]=value>>>8,this[offset+2]=value>>>16,this[offset+3]=value>>>24):objectWriteUInt32(this,value,offset,!0),offset+4},Buffer.prototype.writeInt32BE=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,4,2147483647,-2147483648),value<0&&(value=4294967295+value+1),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value>>>24,this[offset+1]=value>>>16,this[offset+2]=value>>>8,this[offset+3]=255&value):objectWriteUInt32(this,value,offset,!1),offset+4},Buffer.prototype.writeFloatLE=function(value,offset,noAssert){return writeFloat(this,value,offset,!0,noAssert)},Buffer.prototype.writeFloatBE=function(value,offset,noAssert){return writeFloat(this,value,offset,!1,noAssert)},Buffer.prototype.writeDoubleLE=function(value,offset,noAssert){return writeDouble(this,value,offset,!0,noAssert)},Buffer.prototype.writeDoubleBE=function(value,offset,noAssert){return writeDouble(this,value,offset,!1,noAssert)},Buffer.prototype.copy=function(target,targetStart,start,end){if(start||(start=0),end||0===end||(end=this.length),targetStart>=target.length&&(targetStart=target.length),targetStart||(targetStart=0),end>0&&end<start&&(end=start),end===start)return 0;if(0===target.length||0===this.length)return 0;if(targetStart<0)throw new RangeError("targetStart out of bounds");if(start<0||start>=this.length)throw new RangeError("sourceStart out of bounds");if(end<0)throw new RangeError("sourceEnd out of bounds");end>this.length&&(end=this.length),target.length-targetStart<end-start&&(end=target.length-targetStart+start);var i,len=end-start;if(this===target&&start<targetStart&&targetStart<end)for(i=len-1;i>=0;--i)target[i+targetStart]=this[i+start];else if(len<1e3||!Buffer.TYPED_ARRAY_SUPPORT)for(i=0;i<len;++i)target[i+targetStart]=this[i+start];else Uint8Array.prototype.set.call(target,this.subarray(start,start+len),targetStart);return len},Buffer.prototype.fill=function(val,start,end,encoding){if("string"==typeof val){if("string"==typeof start?(encoding=start,start=0,end=this.length):"string"==typeof end&&(encoding=end,end=this.length),1===val.length){var code=val.charCodeAt(0);code<256&&(val=code)}if(void 0!==encoding&&"string"!=typeof encoding)throw new TypeError("encoding must be a string");if("string"==typeof encoding&&!Buffer.isEncoding(encoding))throw new TypeError("Unknown encoding: "+encoding)}else"number"==typeof val&&(val&=255);if(start<0||this.length<start||this.length<end)throw new RangeError("Out of range index");if(end<=start)return this;var i;if(start>>>=0,end=void 0===end?this.length:end>>>0,val||(val=0),"number"==typeof val)for(i=start;i<end;++i)this[i]=val;else{var bytes=Buffer.isBuffer(val)?val:utf8ToBytes(new Buffer(val,encoding).toString()),len=bytes.length;for(i=0;i<end-start;++i)this[i+start]=bytes[i%len]}return this};var INVALID_BASE64_RE=/[^+\/0-9A-Za-z-_]/g;function toHex(n){return n<16?"0"+n.toString(16):n.toString(16)}function utf8ToBytes(string,units){var codePoint;units=units||1/0;for(var length=string.length,leadSurrogate=null,bytes=[],i=0;i<length;++i){if((codePoint=string.charCodeAt(i))>55295&&codePoint<57344){if(!leadSurrogate){if(codePoint>56319){(units-=3)>-1&&bytes.push(239,191,189);continue}if(i+1===length){(units-=3)>-1&&bytes.push(239,191,189);continue}leadSurrogate=codePoint;continue}if(codePoint<56320){(units-=3)>-1&&bytes.push(239,191,189),leadSurrogate=codePoint;continue}codePoint=65536+(leadSurrogate-55296<<10|codePoint-56320)}else leadSurrogate&&(units-=3)>-1&&bytes.push(239,191,189);if(leadSurrogate=null,codePoint<128){if((units-=1)<0)break;bytes.push(codePoint)}else if(codePoint<2048){if((units-=2)<0)break;bytes.push(codePoint>>6|192,63&codePoint|128)}else if(codePoint<65536){if((units-=3)<0)break;bytes.push(codePoint>>12|224,codePoint>>6&63|128,63&codePoint|128)}else{if(!(codePoint<1114112))throw new Error("Invalid code point");if((units-=4)<0)break;bytes.push(codePoint>>18|240,codePoint>>12&63|128,codePoint>>6&63|128,63&codePoint|128)}}return bytes}function base64ToBytes(str){return base64.toByteArray(function(str){if((str=function(str){return str.trim?str.trim():str.replace(/^\s+|\s+$/g,"")}(str).replace(INVALID_BASE64_RE,"")).length<2)return"";for(;str.length%4!=0;)str+="=";return str}(str))}function blitBuffer(src,dst,offset,length){for(var i=0;i<length&&!(i+offset>=dst.length||i>=src.length);++i)dst[i+offset]=src[i];return i}}).call(this,__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/buildin/global.js?cd00"))},"../../AppData/Roaming/npm/node_modules/webpack/node_modules/buffer/index.js?c412":function(module,exports,__webpack_require__){"use strict";(function(global){var base64=__webpack_require__("./node_modules/base64-js/index.js"),ieee754=__webpack_require__("./node_modules/ieee754/index.js"),isArray=__webpack_require__("./node_modules/isarray/index.js");function kMaxLength(){return Buffer.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function createBuffer(that,length){if(kMaxLength()<length)throw new RangeError("Invalid typed array length");return Buffer.TYPED_ARRAY_SUPPORT?(that=new Uint8Array(length)).__proto__=Buffer.prototype:(null===that&&(that=new Buffer(length)),that.length=length),that}function Buffer(arg,encodingOrOffset,length){if(!(Buffer.TYPED_ARRAY_SUPPORT||this instanceof Buffer))return new Buffer(arg,encodingOrOffset,length);if("number"==typeof arg){if("string"==typeof encodingOrOffset)throw new Error("If encoding is specified then the first argument must be a string");return allocUnsafe(this,arg)}return from(this,arg,encodingOrOffset,length)}function from(that,value,encodingOrOffset,length){if("number"==typeof value)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&value instanceof ArrayBuffer?function(that,array,byteOffset,length){if(array.byteLength,byteOffset<0||array.byteLength<byteOffset)throw new RangeError("'offset' is out of bounds");if(array.byteLength<byteOffset+(length||0))throw new RangeError("'length' is out of bounds");array=void 0===byteOffset&&void 0===length?new Uint8Array(array):void 0===length?new Uint8Array(array,byteOffset):new Uint8Array(array,byteOffset,length);Buffer.TYPED_ARRAY_SUPPORT?(that=array).__proto__=Buffer.prototype:that=fromArrayLike(that,array);return that}(that,value,encodingOrOffset,length):"string"==typeof value?function(that,string,encoding){"string"==typeof encoding&&""!==encoding||(encoding="utf8");if(!Buffer.isEncoding(encoding))throw new TypeError('"encoding" must be a valid string encoding');var length=0|byteLength(string,encoding),actual=(that=createBuffer(that,length)).write(string,encoding);actual!==length&&(that=that.slice(0,actual));return that}(that,value,encodingOrOffset):function(that,obj){if(Buffer.isBuffer(obj)){var len=0|checked(obj.length);return 0===(that=createBuffer(that,len)).length?that:(obj.copy(that,0,0,len),that)}if(obj){if("undefined"!=typeof ArrayBuffer&&obj.buffer instanceof ArrayBuffer||"length"in obj)return"number"!=typeof obj.length||(val=obj.length)!=val?createBuffer(that,0):fromArrayLike(that,obj);if("Buffer"===obj.type&&isArray(obj.data))return fromArrayLike(that,obj.data)}var val;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(that,value)}function assertSize(size){if("number"!=typeof size)throw new TypeError('"size" argument must be a number');if(size<0)throw new RangeError('"size" argument must not be negative')}function allocUnsafe(that,size){if(assertSize(size),that=createBuffer(that,size<0?0:0|checked(size)),!Buffer.TYPED_ARRAY_SUPPORT)for(var i=0;i<size;++i)that[i]=0;return that}function fromArrayLike(that,array){var length=array.length<0?0:0|checked(array.length);that=createBuffer(that,length);for(var i=0;i<length;i+=1)that[i]=255&array[i];return that}function checked(length){if(length>=kMaxLength())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+kMaxLength().toString(16)+" bytes");return 0|length}function byteLength(string,encoding){if(Buffer.isBuffer(string))return string.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(string)||string instanceof ArrayBuffer))return string.byteLength;"string"!=typeof string&&(string=""+string);var len=string.length;if(0===len)return 0;for(var loweredCase=!1;;)switch(encoding){case"ascii":case"latin1":case"binary":return len;case"utf8":case"utf-8":case void 0:return utf8ToBytes(string).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*len;case"hex":return len>>>1;case"base64":return base64ToBytes(string).length;default:if(loweredCase)return utf8ToBytes(string).length;encoding=(""+encoding).toLowerCase(),loweredCase=!0}}function swap(b,n,m){var i=b[n];b[n]=b[m],b[m]=i}function bidirectionalIndexOf(buffer,val,byteOffset,encoding,dir){if(0===buffer.length)return-1;if("string"==typeof byteOffset?(encoding=byteOffset,byteOffset=0):byteOffset>2147483647?byteOffset=2147483647:byteOffset<-2147483648&&(byteOffset=-2147483648),byteOffset=+byteOffset,isNaN(byteOffset)&&(byteOffset=dir?0:buffer.length-1),byteOffset<0&&(byteOffset=buffer.length+byteOffset),byteOffset>=buffer.length){if(dir)return-1;byteOffset=buffer.length-1}else if(byteOffset<0){if(!dir)return-1;byteOffset=0}if("string"==typeof val&&(val=Buffer.from(val,encoding)),Buffer.isBuffer(val))return 0===val.length?-1:arrayIndexOf(buffer,val,byteOffset,encoding,dir);if("number"==typeof val)return val&=255,Buffer.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?dir?Uint8Array.prototype.indexOf.call(buffer,val,byteOffset):Uint8Array.prototype.lastIndexOf.call(buffer,val,byteOffset):arrayIndexOf(buffer,[val],byteOffset,encoding,dir);throw new TypeError("val must be string, number or Buffer")}function arrayIndexOf(arr,val,byteOffset,encoding,dir){var i,indexSize=1,arrLength=arr.length,valLength=val.length;if(void 0!==encoding&&("ucs2"===(encoding=String(encoding).toLowerCase())||"ucs-2"===encoding||"utf16le"===encoding||"utf-16le"===encoding)){if(arr.length<2||val.length<2)return-1;indexSize=2,arrLength/=2,valLength/=2,byteOffset/=2}function read(buf,i){return 1===indexSize?buf[i]:buf.readUInt16BE(i*indexSize)}if(dir){var foundIndex=-1;for(i=byteOffset;i<arrLength;i++)if(read(arr,i)===read(val,-1===foundIndex?0:i-foundIndex)){if(-1===foundIndex&&(foundIndex=i),i-foundIndex+1===valLength)return foundIndex*indexSize}else-1!==foundIndex&&(i-=i-foundIndex),foundIndex=-1}else for(byteOffset+valLength>arrLength&&(byteOffset=arrLength-valLength),i=byteOffset;i>=0;i--){for(var found=!0,j=0;j<valLength;j++)if(read(arr,i+j)!==read(val,j)){found=!1;break}if(found)return i}return-1}function hexWrite(buf,string,offset,length){offset=Number(offset)||0;var remaining=buf.length-offset;length?(length=Number(length))>remaining&&(length=remaining):length=remaining;var strLen=string.length;if(strLen%2!=0)throw new TypeError("Invalid hex string");length>strLen/2&&(length=strLen/2);for(var i=0;i<length;++i){var parsed=parseInt(string.substr(2*i,2),16);if(isNaN(parsed))return i;buf[offset+i]=parsed}return i}function utf8Write(buf,string,offset,length){return blitBuffer(utf8ToBytes(string,buf.length-offset),buf,offset,length)}function asciiWrite(buf,string,offset,length){return blitBuffer(function(str){for(var byteArray=[],i=0;i<str.length;++i)byteArray.push(255&str.charCodeAt(i));return byteArray}(string),buf,offset,length)}function latin1Write(buf,string,offset,length){return asciiWrite(buf,string,offset,length)}function base64Write(buf,string,offset,length){return blitBuffer(base64ToBytes(string),buf,offset,length)}function ucs2Write(buf,string,offset,length){return blitBuffer(function(str,units){for(var c,hi,lo,byteArray=[],i=0;i<str.length&&!((units-=2)<0);++i)c=str.charCodeAt(i),hi=c>>8,lo=c%256,byteArray.push(lo),byteArray.push(hi);return byteArray}(string,buf.length-offset),buf,offset,length)}function base64Slice(buf,start,end){return 0===start&&end===buf.length?base64.fromByteArray(buf):base64.fromByteArray(buf.slice(start,end))}function utf8Slice(buf,start,end){end=Math.min(buf.length,end);for(var res=[],i=start;i<end;){var secondByte,thirdByte,fourthByte,tempCodePoint,firstByte=buf[i],codePoint=null,bytesPerSequence=firstByte>239?4:firstByte>223?3:firstByte>191?2:1;if(i+bytesPerSequence<=end)switch(bytesPerSequence){case 1:firstByte<128&&(codePoint=firstByte);break;case 2:128==(192&(secondByte=buf[i+1]))&&(tempCodePoint=(31&firstByte)<<6|63&secondByte)>127&&(codePoint=tempCodePoint);break;case 3:secondByte=buf[i+1],thirdByte=buf[i+2],128==(192&secondByte)&&128==(192&thirdByte)&&(tempCodePoint=(15&firstByte)<<12|(63&secondByte)<<6|63&thirdByte)>2047&&(tempCodePoint<55296||tempCodePoint>57343)&&(codePoint=tempCodePoint);break;case 4:secondByte=buf[i+1],thirdByte=buf[i+2],fourthByte=buf[i+3],128==(192&secondByte)&&128==(192&thirdByte)&&128==(192&fourthByte)&&(tempCodePoint=(15&firstByte)<<18|(63&secondByte)<<12|(63&thirdByte)<<6|63&fourthByte)>65535&&tempCodePoint<1114112&&(codePoint=tempCodePoint)}null===codePoint?(codePoint=65533,bytesPerSequence=1):codePoint>65535&&(codePoint-=65536,res.push(codePoint>>>10&1023|55296),codePoint=56320|1023&codePoint),res.push(codePoint),i+=bytesPerSequence}return function(codePoints){var len=codePoints.length;if(len<=MAX_ARGUMENTS_LENGTH)return String.fromCharCode.apply(String,codePoints);var res="",i=0;for(;i<len;)res+=String.fromCharCode.apply(String,codePoints.slice(i,i+=MAX_ARGUMENTS_LENGTH));return res}(res)}exports.Buffer=Buffer,exports.SlowBuffer=function(length){+length!=length&&(length=0);return Buffer.alloc(+length)},exports.INSPECT_MAX_BYTES=50,Buffer.TYPED_ARRAY_SUPPORT=void 0!==global.TYPED_ARRAY_SUPPORT?global.TYPED_ARRAY_SUPPORT:function(){try{var arr=new Uint8Array(1);return arr.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===arr.foo()&&"function"==typeof arr.subarray&&0===arr.subarray(1,1).byteLength}catch(e){return!1}}(),exports.kMaxLength=kMaxLength(),Buffer.poolSize=8192,Buffer._augment=function(arr){return arr.__proto__=Buffer.prototype,arr},Buffer.from=function(value,encodingOrOffset,length){return from(null,value,encodingOrOffset,length)},Buffer.TYPED_ARRAY_SUPPORT&&(Buffer.prototype.__proto__=Uint8Array.prototype,Buffer.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&Buffer[Symbol.species]===Buffer&&Object.defineProperty(Buffer,Symbol.species,{value:null,configurable:!0})),Buffer.alloc=function(size,fill,encoding){return function(that,size,fill,encoding){return assertSize(size),size<=0?createBuffer(that,size):void 0!==fill?"string"==typeof encoding?createBuffer(that,size).fill(fill,encoding):createBuffer(that,size).fill(fill):createBuffer(that,size)}(null,size,fill,encoding)},Buffer.allocUnsafe=function(size){return allocUnsafe(null,size)},Buffer.allocUnsafeSlow=function(size){return allocUnsafe(null,size)},Buffer.isBuffer=function(b){return!(null==b||!b._isBuffer)},Buffer.compare=function(a,b){if(!Buffer.isBuffer(a)||!Buffer.isBuffer(b))throw new TypeError("Arguments must be Buffers");if(a===b)return 0;for(var x=a.length,y=b.length,i=0,len=Math.min(x,y);i<len;++i)if(a[i]!==b[i]){x=a[i],y=b[i];break}return x<y?-1:y<x?1:0},Buffer.isEncoding=function(encoding){switch(String(encoding).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Buffer.concat=function(list,length){if(!isArray(list))throw new TypeError('"list" argument must be an Array of Buffers');if(0===list.length)return Buffer.alloc(0);var i;if(void 0===length)for(length=0,i=0;i<list.length;++i)length+=list[i].length;var buffer=Buffer.allocUnsafe(length),pos=0;for(i=0;i<list.length;++i){var buf=list[i];if(!Buffer.isBuffer(buf))throw new TypeError('"list" argument must be an Array of Buffers');buf.copy(buffer,pos),pos+=buf.length}return buffer},Buffer.byteLength=byteLength,Buffer.prototype._isBuffer=!0,Buffer.prototype.swap16=function(){var len=this.length;if(len%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var i=0;i<len;i+=2)swap(this,i,i+1);return this},Buffer.prototype.swap32=function(){var len=this.length;if(len%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var i=0;i<len;i+=4)swap(this,i,i+3),swap(this,i+1,i+2);return this},Buffer.prototype.swap64=function(){var len=this.length;if(len%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var i=0;i<len;i+=8)swap(this,i,i+7),swap(this,i+1,i+6),swap(this,i+2,i+5),swap(this,i+3,i+4);return this},Buffer.prototype.toString=function(){var length=0|this.length;return 0===length?"":0===arguments.length?utf8Slice(this,0,length):function(encoding,start,end){var loweredCase=!1;if((void 0===start||start<0)&&(start=0),start>this.length)return"";if((void 0===end||end>this.length)&&(end=this.length),end<=0)return"";if((end>>>=0)<=(start>>>=0))return"";for(encoding||(encoding="utf8");;)switch(encoding){case"hex":return hexSlice(this,start,end);case"utf8":case"utf-8":return utf8Slice(this,start,end);case"ascii":return asciiSlice(this,start,end);case"latin1":case"binary":return latin1Slice(this,start,end);case"base64":return base64Slice(this,start,end);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this,start,end);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(encoding+"").toLowerCase(),loweredCase=!0}}.apply(this,arguments)},Buffer.prototype.equals=function(b){if(!Buffer.isBuffer(b))throw new TypeError("Argument must be a Buffer");return this===b||0===Buffer.compare(this,b)},Buffer.prototype.inspect=function(){var str="",max=exports.INSPECT_MAX_BYTES;return this.length>0&&(str=this.toString("hex",0,max).match(/.{2}/g).join(" "),this.length>max&&(str+=" ... ")),"<Buffer "+str+">"},Buffer.prototype.compare=function(target,start,end,thisStart,thisEnd){if(!Buffer.isBuffer(target))throw new TypeError("Argument must be a Buffer");if(void 0===start&&(start=0),void 0===end&&(end=target?target.length:0),void 0===thisStart&&(thisStart=0),void 0===thisEnd&&(thisEnd=this.length),start<0||end>target.length||thisStart<0||thisEnd>this.length)throw new RangeError("out of range index");if(thisStart>=thisEnd&&start>=end)return 0;if(thisStart>=thisEnd)return-1;if(start>=end)return 1;if(start>>>=0,end>>>=0,thisStart>>>=0,thisEnd>>>=0,this===target)return 0;for(var x=thisEnd-thisStart,y=end-start,len=Math.min(x,y),thisCopy=this.slice(thisStart,thisEnd),targetCopy=target.slice(start,end),i=0;i<len;++i)if(thisCopy[i]!==targetCopy[i]){x=thisCopy[i],y=targetCopy[i];break}return x<y?-1:y<x?1:0},Buffer.prototype.includes=function(val,byteOffset,encoding){return-1!==this.indexOf(val,byteOffset,encoding)},Buffer.prototype.indexOf=function(val,byteOffset,encoding){return bidirectionalIndexOf(this,val,byteOffset,encoding,!0)},Buffer.prototype.lastIndexOf=function(val,byteOffset,encoding){return bidirectionalIndexOf(this,val,byteOffset,encoding,!1)},Buffer.prototype.write=function(string,offset,length,encoding){if(void 0===offset)encoding="utf8",length=this.length,offset=0;else if(void 0===length&&"string"==typeof offset)encoding=offset,length=this.length,offset=0;else{if(!isFinite(offset))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");offset|=0,isFinite(length)?(length|=0,void 0===encoding&&(encoding="utf8")):(encoding=length,length=void 0)}var remaining=this.length-offset;if((void 0===length||length>remaining)&&(length=remaining),string.length>0&&(length<0||offset<0)||offset>this.length)throw new RangeError("Attempt to write outside buffer bounds");encoding||(encoding="utf8");for(var loweredCase=!1;;)switch(encoding){case"hex":return hexWrite(this,string,offset,length);case"utf8":case"utf-8":return utf8Write(this,string,offset,length);case"ascii":return asciiWrite(this,string,offset,length);case"latin1":case"binary":return latin1Write(this,string,offset,length);case"base64":return base64Write(this,string,offset,length);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ucs2Write(this,string,offset,length);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(""+encoding).toLowerCase(),loweredCase=!0}},Buffer.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var MAX_ARGUMENTS_LENGTH=4096;function asciiSlice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;i<end;++i)ret+=String.fromCharCode(127&buf[i]);return ret}function latin1Slice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;i<end;++i)ret+=String.fromCharCode(buf[i]);return ret}function hexSlice(buf,start,end){var len=buf.length;(!start||start<0)&&(start=0),(!end||end<0||end>len)&&(end=len);for(var out="",i=start;i<end;++i)out+=toHex(buf[i]);return out}function utf16leSlice(buf,start,end){for(var bytes=buf.slice(start,end),res="",i=0;i<bytes.length;i+=2)res+=String.fromCharCode(bytes[i]+256*bytes[i+1]);return res}function checkOffset(offset,ext,length){if(offset%1!=0||offset<0)throw new RangeError("offset is not uint");if(offset+ext>length)throw new RangeError("Trying to access beyond buffer length")}function checkInt(buf,value,offset,ext,max,min){if(!Buffer.isBuffer(buf))throw new TypeError('"buffer" argument must be a Buffer instance');if(value>max||value<min)throw new RangeError('"value" argument is out of bounds');if(offset+ext>buf.length)throw new RangeError("Index out of range")}function objectWriteUInt16(buf,value,offset,littleEndian){value<0&&(value=65535+value+1);for(var i=0,j=Math.min(buf.length-offset,2);i<j;++i)buf[offset+i]=(value&255<<8*(littleEndian?i:1-i))>>>8*(littleEndian?i:1-i)}function objectWriteUInt32(buf,value,offset,littleEndian){value<0&&(value=4294967295+value+1);for(var i=0,j=Math.min(buf.length-offset,4);i<j;++i)buf[offset+i]=value>>>8*(littleEndian?i:3-i)&255}function checkIEEE754(buf,value,offset,ext,max,min){if(offset+ext>buf.length)throw new RangeError("Index out of range");if(offset<0)throw new RangeError("Index out of range")}function writeFloat(buf,value,offset,littleEndian,noAssert){return noAssert||checkIEEE754(buf,0,offset,4),ieee754.write(buf,value,offset,littleEndian,23,4),offset+4}function writeDouble(buf,value,offset,littleEndian,noAssert){return noAssert||checkIEEE754(buf,0,offset,8),ieee754.write(buf,value,offset,littleEndian,52,8),offset+8}Buffer.prototype.slice=function(start,end){var newBuf,len=this.length;if(start=~~start,end=void 0===end?len:~~end,start<0?(start+=len)<0&&(start=0):start>len&&(start=len),end<0?(end+=len)<0&&(end=0):end>len&&(end=len),end<start&&(end=start),Buffer.TYPED_ARRAY_SUPPORT)(newBuf=this.subarray(start,end)).__proto__=Buffer.prototype;else{var sliceLen=end-start;newBuf=new Buffer(sliceLen,void 0);for(var i=0;i<sliceLen;++i)newBuf[i]=this[i+start]}return newBuf},Buffer.prototype.readUIntLE=function(offset,byteLength,noAssert){offset|=0,byteLength|=0,noAssert||checkOffset(offset,byteLength,this.length);for(var val=this[offset],mul=1,i=0;++i<byteLength&&(mul*=256);)val+=this[offset+i]*mul;return val},Buffer.prototype.readUIntBE=function(offset,byteLength,noAssert){offset|=0,byteLength|=0,noAssert||checkOffset(offset,byteLength,this.length);for(var val=this[offset+--byteLength],mul=1;byteLength>0&&(mul*=256);)val+=this[offset+--byteLength]*mul;return val},Buffer.prototype.readUInt8=function(offset,noAssert){return noAssert||checkOffset(offset,1,this.length),this[offset]},Buffer.prototype.readUInt16LE=function(offset,noAssert){return noAssert||checkOffset(offset,2,this.length),this[offset]|this[offset+1]<<8},Buffer.prototype.readUInt16BE=function(offset,noAssert){return noAssert||checkOffset(offset,2,this.length),this[offset]<<8|this[offset+1]},Buffer.prototype.readUInt32LE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),(this[offset]|this[offset+1]<<8|this[offset+2]<<16)+16777216*this[offset+3]},Buffer.prototype.readUInt32BE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),16777216*this[offset]+(this[offset+1]<<16|this[offset+2]<<8|this[offset+3])},Buffer.prototype.readIntLE=function(offset,byteLength,noAssert){offset|=0,byteLength|=0,noAssert||checkOffset(offset,byteLength,this.length);for(var val=this[offset],mul=1,i=0;++i<byteLength&&(mul*=256);)val+=this[offset+i]*mul;return val>=(mul*=128)&&(val-=Math.pow(2,8*byteLength)),val},Buffer.prototype.readIntBE=function(offset,byteLength,noAssert){offset|=0,byteLength|=0,noAssert||checkOffset(offset,byteLength,this.length);for(var i=byteLength,mul=1,val=this[offset+--i];i>0&&(mul*=256);)val+=this[offset+--i]*mul;return val>=(mul*=128)&&(val-=Math.pow(2,8*byteLength)),val},Buffer.prototype.readInt8=function(offset,noAssert){return noAssert||checkOffset(offset,1,this.length),128&this[offset]?-1*(255-this[offset]+1):this[offset]},Buffer.prototype.readInt16LE=function(offset,noAssert){noAssert||checkOffset(offset,2,this.length);var val=this[offset]|this[offset+1]<<8;return 32768&val?4294901760|val:val},Buffer.prototype.readInt16BE=function(offset,noAssert){noAssert||checkOffset(offset,2,this.length);var val=this[offset+1]|this[offset]<<8;return 32768&val?4294901760|val:val},Buffer.prototype.readInt32LE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),this[offset]|this[offset+1]<<8|this[offset+2]<<16|this[offset+3]<<24},Buffer.prototype.readInt32BE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),this[offset]<<24|this[offset+1]<<16|this[offset+2]<<8|this[offset+3]},Buffer.prototype.readFloatLE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),ieee754.read(this,offset,!0,23,4)},Buffer.prototype.readFloatBE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),ieee754.read(this,offset,!1,23,4)},Buffer.prototype.readDoubleLE=function(offset,noAssert){return noAssert||checkOffset(offset,8,this.length),ieee754.read(this,offset,!0,52,8)},Buffer.prototype.readDoubleBE=function(offset,noAssert){return noAssert||checkOffset(offset,8,this.length),ieee754.read(this,offset,!1,52,8)},Buffer.prototype.writeUIntLE=function(value,offset,byteLength,noAssert){(value=+value,offset|=0,byteLength|=0,noAssert)||checkInt(this,value,offset,byteLength,Math.pow(2,8*byteLength)-1,0);var mul=1,i=0;for(this[offset]=255&value;++i<byteLength&&(mul*=256);)this[offset+i]=value/mul&255;return offset+byteLength},Buffer.prototype.writeUIntBE=function(value,offset,byteLength,noAssert){(value=+value,offset|=0,byteLength|=0,noAssert)||checkInt(this,value,offset,byteLength,Math.pow(2,8*byteLength)-1,0);var i=byteLength-1,mul=1;for(this[offset+i]=255&value;--i>=0&&(mul*=256);)this[offset+i]=value/mul&255;return offset+byteLength},Buffer.prototype.writeUInt8=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,1,255,0),Buffer.TYPED_ARRAY_SUPPORT||(value=Math.floor(value)),this[offset]=255&value,offset+1},Buffer.prototype.writeUInt16LE=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,2,65535,0),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=255&value,this[offset+1]=value>>>8):objectWriteUInt16(this,value,offset,!0),offset+2},Buffer.prototype.writeUInt16BE=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,2,65535,0),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value>>>8,this[offset+1]=255&value):objectWriteUInt16(this,value,offset,!1),offset+2},Buffer.prototype.writeUInt32LE=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,4,4294967295,0),Buffer.TYPED_ARRAY_SUPPORT?(this[offset+3]=value>>>24,this[offset+2]=value>>>16,this[offset+1]=value>>>8,this[offset]=255&value):objectWriteUInt32(this,value,offset,!0),offset+4},Buffer.prototype.writeUInt32BE=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,4,4294967295,0),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value>>>24,this[offset+1]=value>>>16,this[offset+2]=value>>>8,this[offset+3]=255&value):objectWriteUInt32(this,value,offset,!1),offset+4},Buffer.prototype.writeIntLE=function(value,offset,byteLength,noAssert){if(value=+value,offset|=0,!noAssert){var limit=Math.pow(2,8*byteLength-1);checkInt(this,value,offset,byteLength,limit-1,-limit)}var i=0,mul=1,sub=0;for(this[offset]=255&value;++i<byteLength&&(mul*=256);)value<0&&0===sub&&0!==this[offset+i-1]&&(sub=1),this[offset+i]=(value/mul>>0)-sub&255;return offset+byteLength},Buffer.prototype.writeIntBE=function(value,offset,byteLength,noAssert){if(value=+value,offset|=0,!noAssert){var limit=Math.pow(2,8*byteLength-1);checkInt(this,value,offset,byteLength,limit-1,-limit)}var i=byteLength-1,mul=1,sub=0;for(this[offset+i]=255&value;--i>=0&&(mul*=256);)value<0&&0===sub&&0!==this[offset+i+1]&&(sub=1),this[offset+i]=(value/mul>>0)-sub&255;return offset+byteLength},Buffer.prototype.writeInt8=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,1,127,-128),Buffer.TYPED_ARRAY_SUPPORT||(value=Math.floor(value)),value<0&&(value=255+value+1),this[offset]=255&value,offset+1},Buffer.prototype.writeInt16LE=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,2,32767,-32768),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=255&value,this[offset+1]=value>>>8):objectWriteUInt16(this,value,offset,!0),offset+2},Buffer.prototype.writeInt16BE=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,2,32767,-32768),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value>>>8,this[offset+1]=255&value):objectWriteUInt16(this,value,offset,!1),offset+2},Buffer.prototype.writeInt32LE=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,4,2147483647,-2147483648),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=255&value,this[offset+1]=value>>>8,this[offset+2]=value>>>16,this[offset+3]=value>>>24):objectWriteUInt32(this,value,offset,!0),offset+4},Buffer.prototype.writeInt32BE=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,4,2147483647,-2147483648),value<0&&(value=4294967295+value+1),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value>>>24,this[offset+1]=value>>>16,this[offset+2]=value>>>8,this[offset+3]=255&value):objectWriteUInt32(this,value,offset,!1),offset+4},Buffer.prototype.writeFloatLE=function(value,offset,noAssert){return writeFloat(this,value,offset,!0,noAssert)},Buffer.prototype.writeFloatBE=function(value,offset,noAssert){return writeFloat(this,value,offset,!1,noAssert)},Buffer.prototype.writeDoubleLE=function(value,offset,noAssert){return writeDouble(this,value,offset,!0,noAssert)},Buffer.prototype.writeDoubleBE=function(value,offset,noAssert){return writeDouble(this,value,offset,!1,noAssert)},Buffer.prototype.copy=function(target,targetStart,start,end){if(start||(start=0),end||0===end||(end=this.length),targetStart>=target.length&&(targetStart=target.length),targetStart||(targetStart=0),end>0&&end<start&&(end=start),end===start)return 0;if(0===target.length||0===this.length)return 0;if(targetStart<0)throw new RangeError("targetStart out of bounds");if(start<0||start>=this.length)throw new RangeError("sourceStart out of bounds");if(end<0)throw new RangeError("sourceEnd out of bounds");end>this.length&&(end=this.length),target.length-targetStart<end-start&&(end=target.length-targetStart+start);var i,len=end-start;if(this===target&&start<targetStart&&targetStart<end)for(i=len-1;i>=0;--i)target[i+targetStart]=this[i+start];else if(len<1e3||!Buffer.TYPED_ARRAY_SUPPORT)for(i=0;i<len;++i)target[i+targetStart]=this[i+start];else Uint8Array.prototype.set.call(target,this.subarray(start,start+len),targetStart);return len},Buffer.prototype.fill=function(val,start,end,encoding){if("string"==typeof val){if("string"==typeof start?(encoding=start,start=0,end=this.length):"string"==typeof end&&(encoding=end,end=this.length),1===val.length){var code=val.charCodeAt(0);code<256&&(val=code)}if(void 0!==encoding&&"string"!=typeof encoding)throw new TypeError("encoding must be a string");if("string"==typeof encoding&&!Buffer.isEncoding(encoding))throw new TypeError("Unknown encoding: "+encoding)}else"number"==typeof val&&(val&=255);if(start<0||this.length<start||this.length<end)throw new RangeError("Out of range index");if(end<=start)return this;var i;if(start>>>=0,end=void 0===end?this.length:end>>>0,val||(val=0),"number"==typeof val)for(i=start;i<end;++i)this[i]=val;else{var bytes=Buffer.isBuffer(val)?val:utf8ToBytes(new Buffer(val,encoding).toString()),len=bytes.length;for(i=0;i<end-start;++i)this[i+start]=bytes[i%len]}return this};var INVALID_BASE64_RE=/[^+\/0-9A-Za-z-_]/g;function toHex(n){return n<16?"0"+n.toString(16):n.toString(16)}function utf8ToBytes(string,units){var codePoint;units=units||1/0;for(var length=string.length,leadSurrogate=null,bytes=[],i=0;i<length;++i){if((codePoint=string.charCodeAt(i))>55295&&codePoint<57344){if(!leadSurrogate){if(codePoint>56319){(units-=3)>-1&&bytes.push(239,191,189);continue}if(i+1===length){(units-=3)>-1&&bytes.push(239,191,189);continue}leadSurrogate=codePoint;continue}if(codePoint<56320){(units-=3)>-1&&bytes.push(239,191,189),leadSurrogate=codePoint;continue}codePoint=65536+(leadSurrogate-55296<<10|codePoint-56320)}else leadSurrogate&&(units-=3)>-1&&bytes.push(239,191,189);if(leadSurrogate=null,codePoint<128){if((units-=1)<0)break;bytes.push(codePoint)}else if(codePoint<2048){if((units-=2)<0)break;bytes.push(codePoint>>6|192,63&codePoint|128)}else if(codePoint<65536){if((units-=3)<0)break;bytes.push(codePoint>>12|224,codePoint>>6&63|128,63&codePoint|128)}else{if(!(codePoint<1114112))throw new Error("Invalid code point");if((units-=4)<0)break;bytes.push(codePoint>>18|240,codePoint>>12&63|128,codePoint>>6&63|128,63&codePoint|128)}}return bytes}function base64ToBytes(str){return base64.toByteArray(function(str){if((str=function(str){return str.trim?str.trim():str.replace(/^\s+|\s+$/g,"")}(str).replace(INVALID_BASE64_RE,"")).length<2)return"";for(;str.length%4!=0;)str+="=";return str}(str))}function blitBuffer(src,dst,offset,length){for(var i=0;i<length&&!(i+offset>=dst.length||i>=src.length);++i)dst[i+offset]=src[i];return i}}).call(this,__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/buildin/global.js?8fce"))},"../../AppData/Roaming/npm/node_modules/webpack/node_modules/events/events.js":function(module,exports){function EventEmitter(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function isFunction(arg){return"function"==typeof arg}function isObject(arg){return"object"==typeof arg&&null!==arg}function isUndefined(arg){return void 0===arg}module.exports=EventEmitter,EventEmitter.EventEmitter=EventEmitter,EventEmitter.prototype._events=void 0,EventEmitter.prototype._maxListeners=void 0,EventEmitter.defaultMaxListeners=10,EventEmitter.prototype.setMaxListeners=function(n){if("number"!=typeof n||n<0||isNaN(n))throw TypeError("n must be a positive number");return this._maxListeners=n,this},EventEmitter.prototype.emit=function(type){var er,handler,len,args,i,listeners;if(this._events||(this._events={}),"error"===type&&(!this._events.error||isObject(this._events.error)&&!this._events.error.length)){if((er=arguments[1])instanceof Error)throw er;var err=new Error('Uncaught, unspecified "error" event. ('+er+")");throw err.context=er,err}if(isUndefined(handler=this._events[type]))return!1;if(isFunction(handler))switch(arguments.length){case 1:handler.call(this);break;case 2:handler.call(this,arguments[1]);break;case 3:handler.call(this,arguments[1],arguments[2]);break;default:args=Array.prototype.slice.call(arguments,1),handler.apply(this,args)}else if(isObject(handler))for(args=Array.prototype.slice.call(arguments,1),len=(listeners=handler.slice()).length,i=0;i<len;i++)listeners[i].apply(this,args);return!0},EventEmitter.prototype.addListener=function(type,listener){var m;if(!isFunction(listener))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",type,isFunction(listener.listener)?listener.listener:listener),this._events[type]?isObject(this._events[type])?this._events[type].push(listener):this._events[type]=[this._events[type],listener]:this._events[type]=listener,isObject(this._events[type])&&!this._events[type].warned&&(m=isUndefined(this._maxListeners)?EventEmitter.defaultMaxListeners:this._maxListeners)&&m>0&&this._events[type].length>m&&(this._events[type].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[type].length),"function"==typeof console.trace&&console.trace()),this},EventEmitter.prototype.on=EventEmitter.prototype.addListener,EventEmitter.prototype.once=function(type,listener){if(!isFunction(listener))throw TypeError("listener must be a function");var fired=!1;function g(){this.removeListener(type,g),fired||(fired=!0,listener.apply(this,arguments))}return g.listener=listener,this.on(type,g),this},EventEmitter.prototype.removeListener=function(type,listener){var list,position,length,i;if(!isFunction(listener))throw TypeError("listener must be a function");if(!this._events||!this._events[type])return this;if(length=(list=this._events[type]).length,position=-1,list===listener||isFunction(list.listener)&&list.listener===listener)delete this._events[type],this._events.removeListener&&this.emit("removeListener",type,listener);else if(isObject(list)){for(i=length;i-- >0;)if(list[i]===listener||list[i].listener&&list[i].listener===listener){position=i;break}if(position<0)return this;1===list.length?(list.length=0,delete this._events[type]):list.splice(position,1),this._events.removeListener&&this.emit("removeListener",type,listener)}return this},EventEmitter.prototype.removeAllListeners=function(type){var key,listeners;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[type]&&delete this._events[type],this;if(0===arguments.length){for(key in this._events)"removeListener"!==key&&this.removeAllListeners(key);return this.removeAllListeners("removeListener"),this._events={},this}if(isFunction(listeners=this._events[type]))this.removeListener(type,listeners);else if(listeners)for(;listeners.length;)this.removeListener(type,listeners[listeners.length-1]);return delete this._events[type],this},EventEmitter.prototype.listeners=function(type){return this._events&&this._events[type]?isFunction(this._events[type])?[this._events[type]]:this._events[type].slice():[]},EventEmitter.prototype.listenerCount=function(type){if(this._events){var evlistener=this._events[type];if(isFunction(evlistener))return 1;if(evlistener)return evlistener.length}return 0},EventEmitter.listenerCount=function(emitter,type){return emitter.listenerCount(type)}},"../../AppData/Roaming/npm/node_modules/webpack/node_modules/os-browserify/browser.js":function(module,exports){exports.endianness=function(){return"LE"},exports.hostname=function(){return"undefined"!=typeof location?location.hostname:""},exports.loadavg=function(){return[]},exports.uptime=function(){return 0},exports.freemem=function(){return Number.MAX_VALUE},exports.totalmem=function(){return Number.MAX_VALUE},exports.cpus=function(){return[]},exports.type=function(){return"Browser"},exports.release=function(){return"undefined"!=typeof navigator?navigator.appVersion:""},exports.networkInterfaces=exports.getNetworkInterfaces=function(){return{}},exports.arch=function(){return"javascript"},exports.platform=function(){return"browser"},exports.tmpdir=exports.tmpDir=function(){return"/tmp"},exports.EOL="\n",exports.homedir=function(){return"/"}},"../../AppData/Roaming/npm/node_modules/webpack/node_modules/path-browserify/index.js":function(module,exports,__webpack_require__){(function(process){function normalizeArray(parts,allowAboveRoot){for(var up=0,i=parts.length-1;i>=0;i--){var last=parts[i];"."===last?parts.splice(i,1):".."===last?(parts.splice(i,1),up++):up&&(parts.splice(i,1),up--)}if(allowAboveRoot)for(;up--;up)parts.unshift("..");return parts}var splitPathRe=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,splitPath=function(filename){return splitPathRe.exec(filename).slice(1)};function filter(xs,f){if(xs.filter)return xs.filter(f);for(var res=[],i=0;i<xs.length;i++)f(xs[i],i,xs)&&res.push(xs[i]);return res}exports.resolve=function(){for(var resolvedPath="",resolvedAbsolute=!1,i=arguments.length-1;i>=-1&&!resolvedAbsolute;i--){var path=i>=0?arguments[i]:process.cwd();if("string"!=typeof path)throw new TypeError("Arguments to path.resolve must be strings");path&&(resolvedPath=path+"/"+resolvedPath,resolvedAbsolute="/"===path.charAt(0))}return resolvedPath=normalizeArray(filter(resolvedPath.split("/"),function(p){return!!p}),!resolvedAbsolute).join("/"),(resolvedAbsolute?"/":"")+resolvedPath||"."},exports.normalize=function(path){var isAbsolute=exports.isAbsolute(path),trailingSlash="/"===substr(path,-1);return(path=normalizeArray(filter(path.split("/"),function(p){return!!p}),!isAbsolute).join("/"))||isAbsolute||(path="."),path&&trailingSlash&&(path+="/"),(isAbsolute?"/":"")+path},exports.isAbsolute=function(path){return"/"===path.charAt(0)},exports.join=function(){var paths=Array.prototype.slice.call(arguments,0);return exports.normalize(filter(paths,function(p,index){if("string"!=typeof p)throw new TypeError("Arguments to path.join must be strings");return p}).join("/"))},exports.relative=function(from,to){function trim(arr){for(var start=0;start<arr.length&&""===arr[start];start++);for(var end=arr.length-1;end>=0&&""===arr[end];end--);return start>end?[]:arr.slice(start,end-start+1)}from=exports.resolve(from).substr(1),to=exports.resolve(to).substr(1);for(var fromParts=trim(from.split("/")),toParts=trim(to.split("/")),length=Math.min(fromParts.length,toParts.length),samePartsLength=length,i=0;i<length;i++)if(fromParts[i]!==toParts[i]){samePartsLength=i;break}var outputParts=[];for(i=samePartsLength;i<fromParts.length;i++)outputParts.push("..");return(outputParts=outputParts.concat(toParts.slice(samePartsLength))).join("/")},exports.sep="/",exports.delimiter=":",exports.dirname=function(path){var result=splitPath(path),root=result[0],dir=result[1];return root||dir?(dir&&(dir=dir.substr(0,dir.length-1)),root+dir):"."},exports.basename=function(path,ext){var f=splitPath(path)[2];return ext&&f.substr(-1*ext.length)===ext&&(f=f.substr(0,f.length-ext.length)),f},exports.extname=function(path){return splitPath(path)[3]};var substr="b"==="ab".substr(-1)?function(str,start,len){return str.substr(start,len)}:function(str,start,len){return start<0&&(start=str.length+start),str.substr(start,len)}}).call(this,__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/node_modules/process/browser.js?262b"))},"../../AppData/Roaming/npm/node_modules/webpack/node_modules/process/browser.js?262b":function(module,exports){var cachedSetTimeout,cachedClearTimeout,process=module.exports={};function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}function runTimeout(fun){if(cachedSetTimeout===setTimeout)return setTimeout(fun,0);if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout)return cachedSetTimeout=setTimeout,setTimeout(fun,0);try{return cachedSetTimeout(fun,0)}catch(e){try{return cachedSetTimeout.call(null,fun,0)}catch(e){return cachedSetTimeout.call(this,fun,0)}}}!function(){try{cachedSetTimeout="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(e){cachedSetTimeout=defaultSetTimout}try{cachedClearTimeout="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(e){cachedClearTimeout=defaultClearTimeout}}();var currentQueue,queue=[],draining=!1,queueIndex=-1;function cleanUpNextTick(){draining&&currentQueue&&(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue())}function drainQueue(){if(!draining){var timeout=runTimeout(cleanUpNextTick);draining=!0;for(var len=queue.length;len;){for(currentQueue=queue,queue=[];++queueIndex<len;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,len=queue.length}currentQueue=null,draining=!1,function(marker){if(cachedClearTimeout===clearTimeout)return clearTimeout(marker);if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout)return cachedClearTimeout=clearTimeout,clearTimeout(marker);try{cachedClearTimeout(marker)}catch(e){try{return cachedClearTimeout.call(null,marker)}catch(e){return cachedClearTimeout.call(this,marker)}}}(timeout)}}function Item(fun,array){this.fun=fun,this.array=array}function noop(){}process.nextTick=function(fun){var args=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)args[i-1]=arguments[i];queue.push(new Item(fun,args)),1!==queue.length||draining||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},process.title="browser",process.browser=!0,process.env={},process.argv=[],process.version="",process.versions={},process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.prependListener=noop,process.prependOnceListener=noop,process.listeners=function(name){return[]},process.binding=function(name){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(dir){throw new Error("process.chdir is not supported")},process.umask=function(){return 0}},"../../AppData/Roaming/npm/node_modules/webpack/node_modules/process/browser.js?55cf":function(module,exports){var cachedSetTimeout,cachedClearTimeout,process=module.exports={};function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}function runTimeout(fun){if(cachedSetTimeout===setTimeout)return setTimeout(fun,0);if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout)return cachedSetTimeout=setTimeout,setTimeout(fun,0);try{return cachedSetTimeout(fun,0)}catch(e){try{return cachedSetTimeout.call(null,fun,0)}catch(e){return cachedSetTimeout.call(this,fun,0)}}}!function(){try{cachedSetTimeout="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(e){cachedSetTimeout=defaultSetTimout}try{cachedClearTimeout="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(e){cachedClearTimeout=defaultClearTimeout}}();var currentQueue,queue=[],draining=!1,queueIndex=-1;function cleanUpNextTick(){draining&&currentQueue&&(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue())}function drainQueue(){if(!draining){var timeout=runTimeout(cleanUpNextTick);draining=!0;for(var len=queue.length;len;){for(currentQueue=queue,queue=[];++queueIndex<len;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,len=queue.length}currentQueue=null,draining=!1,function(marker){if(cachedClearTimeout===clearTimeout)return clearTimeout(marker);if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout)return cachedClearTimeout=clearTimeout,clearTimeout(marker);try{cachedClearTimeout(marker)}catch(e){try{return cachedClearTimeout.call(null,marker)}catch(e){return cachedClearTimeout.call(this,marker)}}}(timeout)}}function Item(fun,array){this.fun=fun,this.array=array}function noop(){}process.nextTick=function(fun){var args=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)args[i-1]=arguments[i];queue.push(new Item(fun,args)),1!==queue.length||draining||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},process.title="browser",process.browser=!0,process.env={},process.argv=[],process.version="",process.versions={},process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.prependListener=noop,process.prependOnceListener=noop,process.listeners=function(name){return[]},process.binding=function(name){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(dir){throw new Error("process.chdir is not supported")},process.umask=function(){return 0}},"../../AppData/Roaming/npm/node_modules/webpack/node_modules/stream-browserify/index.js":function(module,exports,__webpack_require__){module.exports=Stream;var EE=__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/node_modules/events/events.js").EventEmitter;function Stream(){EE.call(this)}__webpack_require__("./node_modules/inherits/inherits_browser.js")(Stream,EE),Stream.Readable=__webpack_require__("./node_modules/readable-stream/readable-browser.js"),Stream.Writable=__webpack_require__("./node_modules/readable-stream/writable-browser.js"),Stream.Duplex=__webpack_require__("./node_modules/readable-stream/duplex-browser.js"),Stream.Transform=__webpack_require__("./node_modules/readable-stream/transform.js"),Stream.PassThrough=__webpack_require__("./node_modules/readable-stream/passthrough.js"),Stream.Stream=Stream,Stream.prototype.pipe=function(dest,options){var source=this;function ondata(chunk){dest.writable&&!1===dest.write(chunk)&&source.pause&&source.pause()}function ondrain(){source.readable&&source.resume&&source.resume()}source.on("data",ondata),dest.on("drain",ondrain),dest._isStdio||options&&!1===options.end||(source.on("end",onend),source.on("close",onclose));var didOnEnd=!1;function onend(){didOnEnd||(didOnEnd=!0,dest.end())}function onclose(){didOnEnd||(didOnEnd=!0,"function"==typeof dest.destroy&&dest.destroy())}function onerror(er){if(cleanup(),0===EE.listenerCount(this,"error"))throw er}function cleanup(){source.removeListener("data",ondata),dest.removeListener("drain",ondrain),source.removeListener("end",onend),source.removeListener("close",onclose),source.removeListener("error",onerror),dest.removeListener("error",onerror),source.removeListener("end",cleanup),source.removeListener("close",cleanup),dest.removeListener("close",cleanup)}return source.on("error",onerror),dest.on("error",onerror),source.on("end",cleanup),source.on("close",cleanup),dest.on("close",cleanup),dest.emit("pipe",source),dest}},"../../AppData/Roaming/npm/node_modules/webpack/node_modules/string_decoder/lib/string_decoder.js":function(module,exports,__webpack_require__){"use strict";var Buffer=__webpack_require__("./node_modules/safe-buffer/index.js").Buffer,isEncoding=Buffer.isEncoding||function(encoding){switch((encoding=""+encoding)&&encoding.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function StringDecoder(encoding){var nb;switch(this.encoding=function(enc){var nenc=function(enc){if(!enc)return"utf8";for(var retried;;)switch(enc){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return enc;default:if(retried)return;enc=(""+enc).toLowerCase(),retried=!0}}(enc);if("string"!=typeof nenc&&(Buffer.isEncoding===isEncoding||!isEncoding(enc)))throw new Error("Unknown encoding: "+enc);return nenc||enc}(encoding),this.encoding){case"utf16le":this.text=utf16Text,this.end=utf16End,nb=4;break;case"utf8":this.fillLast=utf8FillLast,nb=4;break;case"base64":this.text=base64Text,this.end=base64End,nb=3;break;default:return this.write=simpleWrite,void(this.end=simpleEnd)}this.lastNeed=0,this.lastTotal=0,this.lastChar=Buffer.allocUnsafe(nb)}function utf8CheckByte(byte){return byte<=127?0:byte>>5==6?2:byte>>4==14?3:byte>>3==30?4:byte>>6==2?-1:-2}function utf8FillLast(buf){var p=this.lastTotal-this.lastNeed,r=function(self,buf,p){if(128!=(192&buf[0]))return self.lastNeed=0,"";if(self.lastNeed>1&&buf.length>1){if(128!=(192&buf[1]))return self.lastNeed=1,"";if(self.lastNeed>2&&buf.length>2&&128!=(192&buf[2]))return self.lastNeed=2,""}}(this,buf);return void 0!==r?r:this.lastNeed<=buf.length?(buf.copy(this.lastChar,p,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(buf.copy(this.lastChar,p,0,buf.length),void(this.lastNeed-=buf.length))}function utf16Text(buf,i){if((buf.length-i)%2==0){var r=buf.toString("utf16le",i);if(r){var c=r.charCodeAt(r.length-1);if(c>=55296&&c<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=buf[buf.length-2],this.lastChar[1]=buf[buf.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=buf[buf.length-1],buf.toString("utf16le",i,buf.length-1)}function utf16End(buf){var r=buf&&buf.length?this.write(buf):"";if(this.lastNeed){var end=this.lastTotal-this.lastNeed;return r+this.lastChar.toString("utf16le",0,end)}return r}function base64Text(buf,i){var n=(buf.length-i)%3;return 0===n?buf.toString("base64",i):(this.lastNeed=3-n,this.lastTotal=3,1===n?this.lastChar[0]=buf[buf.length-1]:(this.lastChar[0]=buf[buf.length-2],this.lastChar[1]=buf[buf.length-1]),buf.toString("base64",i,buf.length-n))}function base64End(buf){var r=buf&&buf.length?this.write(buf):"";return this.lastNeed?r+this.lastChar.toString("base64",0,3-this.lastNeed):r}function simpleWrite(buf){return buf.toString(this.encoding)}function simpleEnd(buf){return buf&&buf.length?this.write(buf):""}exports.StringDecoder=StringDecoder,StringDecoder.prototype.write=function(buf){if(0===buf.length)return"";var r,i;if(this.lastNeed){if(void 0===(r=this.fillLast(buf)))return"";i=this.lastNeed,this.lastNeed=0}else i=0;return i<buf.length?r?r+this.text(buf,i):this.text(buf,i):r||""},StringDecoder.prototype.end=function(buf){var r=buf&&buf.length?this.write(buf):"";return this.lastNeed?r+"":r},StringDecoder.prototype.text=function(buf,i){var total=function(self,buf,i){var j=buf.length-1;if(j<i)return 0;var nb=utf8CheckByte(buf[j]);if(nb>=0)return nb>0&&(self.lastNeed=nb-1),nb;if(--j<i||-2===nb)return 0;if((nb=utf8CheckByte(buf[j]))>=0)return nb>0&&(self.lastNeed=nb-2),nb;if(--j<i||-2===nb)return 0;if((nb=utf8CheckByte(buf[j]))>=0)return nb>0&&(2===nb?nb=0:self.lastNeed=nb-3),nb;return 0}(this,buf,i);if(!this.lastNeed)return buf.toString("utf8",i);this.lastTotal=total;var end=buf.length-(total-this.lastNeed);return buf.copy(this.lastChar,0,end),buf.toString("utf8",i,end)},StringDecoder.prototype.fillLast=function(buf){if(this.lastNeed<=buf.length)return buf.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);buf.copy(this.lastChar,this.lastTotal-this.lastNeed,0,buf.length),this.lastNeed-=buf.length}},"../../AppData/Roaming/npm/node_modules/webpack/node_modules/timers-browserify/main.js":function(module,exports,__webpack_require__){(function(global){var scope=void 0!==global&&global||"undefined"!=typeof self&&self||window,apply=Function.prototype.apply;function Timeout(id,clearFn){this._id=id,this._clearFn=clearFn}exports.setTimeout=function(){return new Timeout(apply.call(setTimeout,scope,arguments),clearTimeout)},exports.setInterval=function(){return new Timeout(apply.call(setInterval,scope,arguments),clearInterval)},exports.clearTimeout=exports.clearInterval=function(timeout){timeout&&timeout.close()},Timeout.prototype.unref=Timeout.prototype.ref=function(){},Timeout.prototype.close=function(){this._clearFn.call(scope,this._id)},exports.enroll=function(item,msecs){clearTimeout(item._idleTimeoutId),item._idleTimeout=msecs},exports.unenroll=function(item){clearTimeout(item._idleTimeoutId),item._idleTimeout=-1},exports._unrefActive=exports.active=function(item){clearTimeout(item._idleTimeoutId);var msecs=item._idleTimeout;msecs>=0&&(item._idleTimeoutId=setTimeout(function(){item._onTimeout&&item._onTimeout()},msecs))},__webpack_require__("./node_modules/setimmediate/setImmediate.js"),exports.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==global&&global.setImmediate||this&&this.setImmediate,exports.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==global&&global.clearImmediate||this&&this.clearImmediate}).call(this,__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/buildin/global.js?8fce"))},"../../AppData/Roaming/npm/node_modules/webpack/node_modules/util/support/isBufferBrowser.js":function(module,exports){module.exports=function(arg){return arg&&"object"==typeof arg&&"function"==typeof arg.copy&&"function"==typeof arg.fill&&"function"==typeof arg.readUInt8}},"../../AppData/Roaming/npm/node_modules/webpack/node_modules/util/util.js":function(module,exports,__webpack_require__){(function(global,process){var formatRegExp=/%[sdj%]/g;exports.format=function(f){if(!isString(f)){for(var objects=[],i=0;i<arguments.length;i++)objects.push(inspect(arguments[i]));return objects.join(" ")}i=1;for(var args=arguments,len=args.length,str=String(f).replace(formatRegExp,function(x){if("%%"===x)return"%";if(i>=len)return x;switch(x){case"%s":return String(args[i++]);case"%d":return Number(args[i++]);case"%j":try{return JSON.stringify(args[i++])}catch(_){return"[Circular]"}default:return x}}),x=args[i];i<len;x=args[++i])isNull(x)||!isObject(x)?str+=" "+x:str+=" "+inspect(x);return str},exports.deprecate=function(fn,msg){if(isUndefined(global.process))return function(){return exports.deprecate(fn,msg).apply(this,arguments)};if(!0===process.noDeprecation)return fn;var warned=!1;return function(){if(!warned){if(process.throwDeprecation)throw new Error(msg);process.traceDeprecation?console.trace(msg):console.error(msg),warned=!0}return fn.apply(this,arguments)}};var debugEnviron,debugs={};function inspect(obj,opts){var ctx={seen:[],stylize:stylizeNoColor};return arguments.length>=3&&(ctx.depth=arguments[2]),arguments.length>=4&&(ctx.colors=arguments[3]),isBoolean(opts)?ctx.showHidden=opts:opts&&exports._extend(ctx,opts),isUndefined(ctx.showHidden)&&(ctx.showHidden=!1),isUndefined(ctx.depth)&&(ctx.depth=2),isUndefined(ctx.colors)&&(ctx.colors=!1),isUndefined(ctx.customInspect)&&(ctx.customInspect=!0),ctx.colors&&(ctx.stylize=stylizeWithColor),formatValue(ctx,obj,ctx.depth)}function stylizeWithColor(str,styleType){var style=inspect.styles[styleType];return style?"["+inspect.colors[style][0]+"m"+str+"["+inspect.colors[style][1]+"m":str}function stylizeNoColor(str,styleType){return str}function formatValue(ctx,value,recurseTimes){if(ctx.customInspect&&value&&isFunction(value.inspect)&&value.inspect!==exports.inspect&&(!value.constructor||value.constructor.prototype!==value)){var ret=value.inspect(recurseTimes,ctx);return isString(ret)||(ret=formatValue(ctx,ret,recurseTimes)),ret}var primitive=function(ctx,value){if(isUndefined(value))return ctx.stylize("undefined","undefined");if(isString(value)){var simple="'"+JSON.stringify(value).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return ctx.stylize(simple,"string")}if(isNumber(value))return ctx.stylize(""+value,"number");if(isBoolean(value))return ctx.stylize(""+value,"boolean");if(isNull(value))return ctx.stylize("null","null")}(ctx,value);if(primitive)return primitive;var keys=Object.keys(value),visibleKeys=function(array){var hash={};return array.forEach(function(val,idx){hash[val]=!0}),hash}(keys);if(ctx.showHidden&&(keys=Object.getOwnPropertyNames(value)),isError(value)&&(keys.indexOf("message")>=0||keys.indexOf("description")>=0))return formatError(value);if(0===keys.length){if(isFunction(value)){var name=value.name?": "+value.name:"";return ctx.stylize("[Function"+name+"]","special")}if(isRegExp(value))return ctx.stylize(RegExp.prototype.toString.call(value),"regexp");if(isDate(value))return ctx.stylize(Date.prototype.toString.call(value),"date");if(isError(value))return formatError(value)}var output,base="",array=!1,braces=["{","}"];(isArray(value)&&(array=!0,braces=["[","]"]),isFunction(value))&&(base=" [Function"+(value.name?": "+value.name:"")+"]");return isRegExp(value)&&(base=" "+RegExp.prototype.toString.call(value)),isDate(value)&&(base=" "+Date.prototype.toUTCString.call(value)),isError(value)&&(base=" "+formatError(value)),0!==keys.length||array&&0!=value.length?recurseTimes<0?isRegExp(value)?ctx.stylize(RegExp.prototype.toString.call(value),"regexp"):ctx.stylize("[Object]","special"):(ctx.seen.push(value),output=array?function(ctx,value,recurseTimes,visibleKeys,keys){for(var output=[],i=0,l=value.length;i<l;++i)hasOwnProperty(value,String(i))?output.push(formatProperty(ctx,value,recurseTimes,visibleKeys,String(i),!0)):output.push("");return keys.forEach(function(key){key.match(/^\d+$/)||output.push(formatProperty(ctx,value,recurseTimes,visibleKeys,key,!0))}),output}(ctx,value,recurseTimes,visibleKeys,keys):keys.map(function(key){return formatProperty(ctx,value,recurseTimes,visibleKeys,key,array)}),ctx.seen.pop(),function(output,base,braces){if(output.reduce(function(prev,cur){return 0,cur.indexOf("\n")>=0&&0,prev+cur.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60)return braces[0]+(""===base?"":base+"\n ")+" "+output.join(",\n  ")+" "+braces[1];return braces[0]+base+" "+output.join(", ")+" "+braces[1]}(output,base,braces)):braces[0]+base+braces[1]}function formatError(value){return"["+Error.prototype.toString.call(value)+"]"}function formatProperty(ctx,value,recurseTimes,visibleKeys,key,array){var name,str,desc;if((desc=Object.getOwnPropertyDescriptor(value,key)||{value:value[key]}).get?str=desc.set?ctx.stylize("[Getter/Setter]","special"):ctx.stylize("[Getter]","special"):desc.set&&(str=ctx.stylize("[Setter]","special")),hasOwnProperty(visibleKeys,key)||(name="["+key+"]"),str||(ctx.seen.indexOf(desc.value)<0?(str=isNull(recurseTimes)?formatValue(ctx,desc.value,null):formatValue(ctx,desc.value,recurseTimes-1)).indexOf("\n")>-1&&(str=array?str.split("\n").map(function(line){return"  "+line}).join("\n").substr(2):"\n"+str.split("\n").map(function(line){return"   "+line}).join("\n")):str=ctx.stylize("[Circular]","special")),isUndefined(name)){if(array&&key.match(/^\d+$/))return str;(name=JSON.stringify(""+key)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(name=name.substr(1,name.length-2),name=ctx.stylize(name,"name")):(name=name.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),name=ctx.stylize(name,"string"))}return name+": "+str}function isArray(ar){return Array.isArray(ar)}function isBoolean(arg){return"boolean"==typeof arg}function isNull(arg){return null===arg}function isNumber(arg){return"number"==typeof arg}function isString(arg){return"string"==typeof arg}function isUndefined(arg){return void 0===arg}function isRegExp(re){return isObject(re)&&"[object RegExp]"===objectToString(re)}function isObject(arg){return"object"==typeof arg&&null!==arg}function isDate(d){return isObject(d)&&"[object Date]"===objectToString(d)}function isError(e){return isObject(e)&&("[object Error]"===objectToString(e)||e instanceof Error)}function isFunction(arg){return"function"==typeof arg}function objectToString(o){return Object.prototype.toString.call(o)}function pad(n){return n<10?"0"+n.toString(10):n.toString(10)}exports.debuglog=function(set){if(isUndefined(debugEnviron)&&(debugEnviron=process.env.NODE_DEBUG||""),set=set.toUpperCase(),!debugs[set])if(new RegExp("\\b"+set+"\\b","i").test(debugEnviron)){var pid=process.pid;debugs[set]=function(){var msg=exports.format.apply(exports,arguments);console.error("%s %d: %s",set,pid,msg)}}else debugs[set]=function(){};return debugs[set]},exports.inspect=inspect,inspect.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},inspect.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},exports.isArray=isArray,exports.isBoolean=isBoolean,exports.isNull=isNull,exports.isNullOrUndefined=function(arg){return null==arg},exports.isNumber=isNumber,exports.isString=isString,exports.isSymbol=function(arg){return"symbol"==typeof arg},exports.isUndefined=isUndefined,exports.isRegExp=isRegExp,exports.isObject=isObject,exports.isDate=isDate,exports.isError=isError,exports.isFunction=isFunction,exports.isPrimitive=function(arg){return null===arg||"boolean"==typeof arg||"number"==typeof arg||"string"==typeof arg||"symbol"==typeof arg||void 0===arg},exports.isBuffer=__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/node_modules/util/support/isBufferBrowser.js");var months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function hasOwnProperty(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)}exports.log=function(){var d,time;console.log("%s - %s",(d=new Date,time=[pad(d.getHours()),pad(d.getMinutes()),pad(d.getSeconds())].join(":"),[d.getDate(),months[d.getMonth()],time].join(" ")),exports.format.apply(exports,arguments))},exports.inherits=__webpack_require__("./node_modules/inherits/inherits_browser.js"),exports._extend=function(origin,add){if(!add||!isObject(add))return origin;for(var keys=Object.keys(add),i=keys.length;i--;)origin[keys[i]]=add[keys[i]];return origin}}).call(this,__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/buildin/global.js?cd00"),__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/node_modules/process/browser.js?262b"))},"../internal/js/bis_keystore.js":function(module,exports,__webpack_require__){"use strict";const CryptoJS=__webpack_require__("./node_modules/crypto-js/index.js"),keyobj=__webpack_require__("../internal/js/keys.json");module.exports={GoogleDriveClientID:"403645657014-g1oeb3ncv461u6vcqlcjm821br70gr00.apps.googleusercontent.com",DropboxAccessToken:""};let keys=Object.keys(keyobj);for(let i=0;i<keys.length;i++){let k=keys[i],s=keyobj[k],data=CryptoJS.AES.decrypt(s,"XP1701").toString(CryptoJS.enc.Utf8);module.exports[k]=data}},"../internal/js/keys.json":function(module){module.exports={GoogleDriveKey:"U2FsdGVkX1+4keq6VAiU95ETnEserVBYN3Aya23g8N4tzZ/KR1axCihoN9P8FAVottcbWMS5e5OGFTfY4/b3vg==",DropboxAppKey:"U2FsdGVkX19wG+LRx+SnMi9QaYEgSwwje05STsa7YtQ=",OneDriveKey:"U2FsdGVkX1/Th502LR9JJOeMg5GhAwh/V8B/W3uJhaaCvskq8EcxvbypdAX1+hLoosZLd5aCWHfxD0XB7YZ/7Q=="}},"./build/wasm/bisdate.js":function(module,exports){module.exports={date:"2019/01/11",time:"15:40:18",absolutetime:1547239218445,hash:"919deadb9df85fd13d68a1dee81981a7aa170e99",version:"1.1.0a1"}},"./build/wasm/libbiswasm_wrapper.js":function(module,exports,__webpack_require__){"use strict";const wasmutil=__webpack_require__("./js/core/bis_wasmutils.js"),wrapperutil=__webpack_require__("./js/core/bis_wrapperutils.js");let Module=0,ModulePromise=0;var initialize=function(binary=null){return 0===ModulePromise&&(ModulePromise=wrapperutil.initialize_wasm(binary)).then(mod=>{Module=mod;let d="";mod.bisdate&&(d="("+mod.bisdate+")"),d=d+" (memory size="+Module.wasmMemory.buffer.byteLength/1048576+" MB)",Module._uses_gpl()?console.log("++++ Web Assembly code loaded "+d+", (has GPL plugin. See https://github.com/bioimagesuiteweb/gplcppcode)"):console.log("++++ Web Assembly code "+d)}),ModulePromise};const outputobj={initialize:initialize,reinitialize:function(){return 0!==Module&&(Module._delete_all_memory(),Module=0,ModulePromise=0),initialize()},get_module:function(){return Module},get_date:function(){return"01/02/2019"},parseMatlabV6WASM:function(vector1,paramobj,debug){!0!==debug&&"true"!==debug&&1!==debug&&2!==debug?debug=0:2!==debug&&(debug=1);const jsonstring=JSON.stringify(paramobj||{});let vector1_ptr=wrapperutil.serializeObject(Module,vector1,"Vector");(debug||"true"===debug)&&console.log("++++\n++++ Calling WASM Function:parseMatlabV6WASM with "+jsonstring+"\n++++");const wasm_output=Module.ccall("parseMatlabV6WASM","number",["number","string","number"],[vector1_ptr,jsonstring,debug]),output=wrapperutil.deserializeAndDeleteObject(Module,wasm_output,"Matrix");return vector1_ptr!==vector1&&wasmutil.release_memory(Module,vector1_ptr),output},parseMatrixTextFileWASM:function(string1,debug){!0!==debug&&"true"!==debug&&1!==debug&&2!==debug?debug=0:2!==debug&&(debug=1),(debug||"true"===debug)&&console.log("++++\n++++ Calling WASM Function:parseMatrixTextFileWASM\n++++");const wasm_output=Module.ccall("parseMatrixTextFileWASM","number",["string","number"],[string1,debug]);return wrapperutil.deserializeAndDeleteObject(Module,wasm_output,"Matrix")},createMatrixTextFileWASM:function(matrix1,string2,intval3,debug){!0!==debug&&"true"!==debug&&1!==debug&&2!==debug?debug=0:2!==debug&&(debug=1);let matrix1_ptr=wrapperutil.serializeObject(Module,matrix1,"Matrix");(debug||"true"===debug)&&console.log("++++\n++++ Calling WASM Function:createMatrixTextFileWASM\n++++");const wasm_output=Module.ccall("createMatrixTextFileWASM","number",["number","string","number","number"],[matrix1_ptr,string2,intval3,debug]),output=wrapperutil.deserializeAndDeleteObject(Module,wasm_output,"String");return matrix1_ptr!==matrix1&&wasmutil.release_memory(Module,matrix1_ptr),output},parseComboTransformTextFileWASM:function(string1,debug){!0!==debug&&"true"!==debug&&1!==debug&&2!==debug?debug=0:2!==debug&&(debug=1),(debug||"true"===debug)&&console.log("++++\n++++ Calling WASM Function:parseComboTransformTextFileWASM\n++++");const wasm_output=Module.ccall("parseComboTransformTextFileWASM","number",["string","number"],[string1,debug]);return wrapperutil.deserializeAndDeleteObject(Module,wasm_output,"bisComboTransformation")},createComboTransformationTextFileWASM:function(comboxform1,debug){!0!==debug&&"true"!==debug&&1!==debug&&2!==debug?debug=0:2!==debug&&(debug=1);let comboxform1_ptr=wrapperutil.serializeObject(Module,comboxform1,"bisComboTransformation");(debug||"true"===debug)&&console.log("++++\n++++ Calling WASM Function:createComboTransformationTextFileWASM\n++++");const wasm_output=Module.ccall("createComboTransformationTextFileWASM","number",["number","number"],[comboxform1_ptr,debug]),output=wrapperutil.deserializeAndDeleteObject(Module,wasm_output,"String");return comboxform1_ptr!==comboxform1&&wasmutil.release_memory(Module,comboxform1_ptr),output},niftiMat44ToQuaternionWASM:function(matrix1,debug){!0!==debug&&"true"!==debug&&1!==debug&&2!==debug?debug=0:2!==debug&&(debug=1);let matrix1_ptr=wrapperutil.serializeObject(Module,matrix1,"Matrix");(debug||"true"===debug)&&console.log("++++\n++++ Calling WASM Function:niftiMat44ToQuaternionWASM\n++++");const wasm_output=Module.ccall("niftiMat44ToQuaternionWASM","number",["number","number"],[matrix1_ptr,debug]),output=wrapperutil.deserializeAndDeleteObject(Module,wasm_output,"Matrix");return matrix1_ptr!==matrix1&&wasmutil.release_memory(Module,matrix1_ptr),output},extractImageFrameWASM:function(image1,paramobj,debug){!0!==debug&&"true"!==debug&&1!==debug&&2!==debug?debug=0:2!==debug&&(debug=1);const jsonstring=JSON.stringify(paramobj||{});let image1_ptr=wrapperutil.serializeObject(Module,image1,"bisImage");(debug||"true"===debug)&&console.log("++++\n++++ Calling WASM Function:extractImageFrameWASM with "+jsonstring+"\n++++");const wasm_output=Module.ccall("extractImageFrameWASM","number",["number","string","number"],[image1_ptr,jsonstring,debug]),output=wrapperutil.deserializeAndDeleteObject(Module,wasm_output,"bisImage",image1);return image1_ptr!==image1&&wasmutil.release_memory(Module,image1_ptr),output},extractImageSliceWASM:function(image1,paramobj,debug){!0!==debug&&"true"!==debug&&1!==debug&&2!==debug?debug=0:2!==debug&&(debug=1);const jsonstring=JSON.stringify(paramobj||{});let image1_ptr=wrapperutil.serializeObject(Module,image1,"bisImage");(debug||"true"===debug)&&console.log("++++\n++++ Calling WASM Function:extractImageSliceWASM with "+jsonstring+"\n++++");const wasm_output=Module.ccall("extractImageSliceWASM","number",["number","string","number"],[image1_ptr,jsonstring,debug]),output=wrapperutil.deserializeAndDeleteObject(Module,wasm_output,"bisImage",image1);return image1_ptr!==image1&&wasmutil.release_memory(Module,image1_ptr),output},normalizeImageWASM:function(image1,paramobj,debug){!0!==debug&&"true"!==debug&&1!==debug&&2!==debug?debug=0:2!==debug&&(debug=1);const jsonstring=JSON.stringify(paramobj||{});let image1_ptr=wrapperutil.serializeObject(Module,image1,"bisImage");(debug||"true"===debug)&&console.log("++++\n++++ Calling WASM Function:normalizeImageWASM with "+jsonstring+"\n++++");const wasm_output=Module.ccall("normalizeImageWASM","number",["number","string","number"],[image1_ptr,jsonstring,debug]),output=wrapperutil.deserializeAndDeleteObject(Module,wasm_output,"bisImage",image1);return image1_ptr!==image1&&wasmutil.release_memory(Module,image1_ptr),output},thresholdImageWASM:function(image1,paramobj,debug){!0!==debug&&"true"!==debug&&1!==debug&&2!==debug?debug=0:2!==debug&&(debug=1);const jsonstring=JSON.stringify(paramobj||{});let image1_ptr=wrapperutil.serializeObject(Module,image1,"bisImage");(debug||"true"===debug)&&console.log("++++\n++++ Calling WASM Function:thresholdImageWASM with "+jsonstring+"\n++++");const wasm_output=Module.ccall("thresholdImageWASM","number",["number","string","number"],[image1_ptr,jsonstring,debug]),output=wrapperutil.deserializeAndDeleteObject(Module,wasm_output,"bisImage",image1);return image1_ptr!==image1&&wasmutil.release_memory(Module,image1_ptr),output},shiftScaleImageWASM:function(image1,paramobj,debug){!0!==debug&&"true"!==debug&&1!==debug&&2!==debug?debug=0:2!==debug&&(debug=1);const jsonstring=JSON.stringify(paramobj||{});let image1_ptr=wrapperutil.serializeObject(Module,image1,"bisImage");(debug||"true"===debug)&&console.log("++++\n++++ Calling WASM Function:shiftScaleImageWASM with "+jsonstring+"\n++++");const wasm_output=Module.ccall("shiftScaleImageWASM","number",["number","string","number"],[image1_ptr,jsonstring,debug]),output=wrapperutil.deserializeAndDeleteObject(Module,wasm_output,"bisImage",image1);return image1_ptr!==image1&&wasmutil.release_memory(Module,image1_ptr),output},clusterThresholdImageWASM:function(image1,paramobj,debug){!0!==debug&&"true"!==debug&&1!==debug&&2!==debug?debug=0:2!==debug&&(debug=1);const jsonstring=JSON.stringify(paramobj||{});let image1_ptr=wrapperutil.serializeObject(Module,image1,"bisImage");(debug||"true"===debug)&&console.log("++++\n++++ Calling WASM Function:clusterThresholdImageWASM with "+jsonstring+"\n++++");const wasm_output=Module.ccall("clusterThresholdImageWASM","number",["number","string","number"],[image1_ptr,jsonstring,debug]),output=wrapperutil.deserializeAndDeleteObject(Module,wasm_output,"bisImage",image1);return image1_ptr!==image1&&wasmutil.release_memory(Module,image1_ptr),output},gaussianSmoothImageWASM:function(image1,paramobj,debug){!0!==debug&&"true"!==debug&&1!==debug&&2!==debug?debug=0:2!==debug&&(debug=1);const jsonstring=JSON.stringify(paramobj||{});let image1_ptr=wrapperutil.serializeObject(Module,image1,"bisImage");(debug||"true"===debug)&&console.log("++++\n++++ Calling WASM Function:gaussianSmoothImageWASM with "+jsonstring+"\n++++");const wasm_output=Module.ccall("gaussianSmoothImageWASM","number",["number","string","number"],[image1_ptr,jsonstring,debug]),output=wrapperutil.deserializeAndDeleteObject(Module,wasm_output,"bisImage",image1);return image1_ptr!==image1&&wasmutil.release_memory(Module,image1_ptr),output},gradientImageWASM:function(image1,paramobj,debug){!0!==debug&&"true"!==debug&&1!==debug&&2!==debug?debug=0:2!==debug&&(debug=1);const jsonstring=JSON.stringify(paramobj||{});let image1_ptr=wrapperutil.serializeObject(Module,image1,"bisImage");(debug||"true"===debug)&&console.log("++++\n++++ Calling WASM Function:gradientImageWASM with "+jsonstring+"\n++++");const wasm_output=Module.ccall("gradientImageWASM","number",["number","string","number"],[image1_ptr,jsonstring,debug]),output=wrapperutil.deserializeAndDeleteObject(Module,wasm_output,"bisImage",image1);return image1_ptr!==image1&&wasmutil.release_memory(Module,image1_ptr),output},resliceImageWASM:function(image1,transformation2,paramobj,debug){!0!==debug&&"true"!==debug&&1!==debug&&2!==debug?debug=0:2!==debug&&(debug=1);const jsonstring=JSON.stringify(paramobj||{});let image1_ptr=wrapperutil.serializeObject(Module,image1,"bisImage"),transformation2_ptr=wrapperutil.serializeObject(Module,transformation2,"bisTransformation");(debug||"true"===debug)&&console.log("++++\n++++ Calling WASM Function:resliceImageWASM with "+jsonstring+"\n++++");const wasm_output=Module.ccall("resliceImageWASM","number",["number","number","string","number"],[image1_ptr,transformation2_ptr,jsonstring,debug]),output=wrapperutil.deserializeAndDeleteObject(Module,wasm_output,"bisImage",image1);return image1_ptr!==image1&&wasmutil.release_memory(Module,image1_ptr),transformation2_ptr!==transformation2&&wasmutil.release_memory(Module,transformation2_ptr),output},cropImageWASM:function(image1,paramobj,debug){!0!==debug&&"true"!==debug&&1!==debug&&2!==debug?debug=0:2!==debug&&(debug=1);const jsonstring=JSON.stringify(paramobj||{});let image1_ptr=wrapperutil.serializeObject(Module,image1,"bisImage");(debug||"true"===debug)&&console.log("++++\n++++ Calling WASM Function:cropImageWASM with "+jsonstring+"\n++++");const wasm_output=Module.ccall("cropImageWASM","number",["number","string","number"],[image1_ptr,jsonstring,debug]),output=wrapperutil.deserializeAndDeleteObject(Module,wasm_output,"bisImage",image1);return image1_ptr!==image1&&wasmutil.release_memory(Module,image1_ptr),output},flipImageWASM:function(image1,paramobj,debug){!0!==debug&&"true"!==debug&&1!==debug&&2!==debug?debug=0:2!==debug&&(debug=1);const jsonstring=JSON.stringify(paramobj||{});let image1_ptr=wrapperutil.serializeObject(Module,image1,"bisImage");(debug||"true"===debug)&&console.log("++++\n++++ Calling WASM Function:flipImageWASM with "+jsonstring+"\n++++");const wasm_output=Module.ccall("flipImageWASM","number",["number","string","number"],[image1_ptr,jsonstring,debug]),output=wrapperutil.deserializeAndDeleteObject(Module,wasm_output,"bisImage",image1);return image1_ptr!==image1&&wasmutil.release_memory(Module,image1_ptr),output},blankImageWASM:function(image1,paramobj,debug){!0!==debug&&"true"!==debug&&1!==debug&&2!==debug?debug=0:2!==debug&&(debug=1);const jsonstring=JSON.stringify(paramobj||{});let image1_ptr=wrapperutil.serializeObject(Module,image1,"bisImage");(debug||"true"===debug)&&console.log("++++\n++++ Calling WASM Function:blankImageWASM with "+jsonstring+"\n++++");const wasm_output=Module.ccall("blankImageWASM","number",["number","string","number"],[image1_ptr,jsonstring,debug]),output=wrapperutil.deserializeAndDeleteObject(Module,wasm_output,"bisImage",image1);return image1_ptr!==image1&&wasmutil.release_memory(Module,image1_ptr),output},resampleImageWASM:function(image1,paramobj,debug){!0!==debug&&"true"!==debug&&1!==debug&&2!==debug?debug=0:2!==debug&&(debug=1);const jsonstring=JSON.stringify(paramobj||{});let image1_ptr=wrapperutil.serializeObject(Module,image1,"bisImage");(debug||"true"===debug)&&console.log("++++\n++++ Calling WASM Function:resampleImageWASM with "+jsonstring+"\n++++");const wasm_output=Module.ccall("resampleImageWASM","number",["number","string","number"],[image1_ptr,jsonstring,debug]),output=wrapperutil.deserializeAndDeleteObject(Module,wasm_output,"bisImage",image1);return image1_ptr!==image1&&wasmutil.release_memory(Module,image1_ptr),output},prepareImageForRegistrationWASM:function(image1,paramobj,debug){!0!==debug&&"true"!==debug&&1!==debug&&2!==debug?debug=0:2!==debug&&(debug=1);const jsonstring=JSON.stringify(paramobj||{});let image1_ptr=wrapperutil.serializeObject(Module,image1,"bisImage");(debug||"true"===debug)&&console.log("++++\n++++ Calling WASM Function:prepareImageForRegistrationWASM with "+jsonstring+"\n++++");const wasm_output=Module.ccall("prepareImageForRegistrationWASM","number",["number","string","number"],[image1_ptr,jsonstring,debug]),output=wrapperutil.deserializeAndDeleteObject(Module,wasm_output,"bisImage",image1);return image1_ptr!==image1&&wasmutil.release_memory(Module,image1_ptr),output},computeDisplacementFieldWASM:function(transformation1,paramobj,debug){!0!==debug&&"true"!==debug&&1!==debug&&2!==debug?debug=0:2!==debug&&(debug=1);const jsonstring=JSON.stringify(paramobj||{});let transformation1_ptr=wrapperutil.serializeObject(Module,transformation1,"bisTransformation");(debug||"true"===debug)&&console.log("++++\n++++ Calling WASM Function:computeDisplacementFieldWASM with "+jsonstring+"\n++++");const wasm_output=Module.ccall("computeDisplacementFieldWASM","number",["number","string","number"],[transformation1_ptr,jsonstring,debug]),output=wrapperutil.deserializeAndDeleteObject(Module,wasm_output,"bisImage");return transformation1_ptr!==transformation1&&wasmutil.release_memory(Module,transformation1_ptr),output},sliceBiasFieldCorrectImageWASM:function(image1,paramobj,debug){!0!==debug&&"true"!==debug&&1!==debug&&2!==debug?debug=0:2!==debug&&(debug=1);const jsonstring=JSON.stringify(paramobj||{});let image1_ptr=wrapperutil.serializeObject(Module,image1,"bisImage");(debug||"true"===debug)&&console.log("++++\n++++ Calling WASM Function:sliceBiasFieldCorrectImageWASM with "+jsonstring+"\n++++");const wasm_output=Module.ccall("sliceBiasFieldCorrectImageWASM","number",["number","string","number"],[image1_ptr,jsonstring,debug]),output=wrapperutil.deserializeAndDeleteObject(Module,wasm_output,"bisImage",image1);return image1_ptr!==image1&&wasmutil.release_memory(Module,image1_ptr),output},morphologyOperationWASM:function(image1,paramobj,debug){!0!==debug&&"true"!==debug&&1!==debug&&2!==debug?debug=0:2!==debug&&(debug=1);const jsonstring=JSON.stringify(paramobj||{});let image1_ptr=wrapperutil.serializeObject(Module,image1,"bisImage");(debug||"true"===debug)&&console.log("++++\n++++ Calling WASM Function:morphologyOperationWASM with "+jsonstring+"\n++++");const wasm_output=Module.ccall("morphologyOperationWASM","number",["number","string","number"],[image1_ptr,jsonstring,debug]),output=wrapperutil.deserializeAndDeleteObject(Module,wasm_output,"bisImage",image1);return image1_ptr!==image1&&wasmutil.release_memory(Module,image1_ptr),output},seedConnectivityWASM:function(image1,paramobj,debug){!0!==debug&&"true"!==debug&&1!==debug&&2!==debug?debug=0:2!==debug&&(debug=1);const jsonstring=JSON.stringify(paramobj||{});let image1_ptr=wrapperutil.serializeObject(Module,image1,"bisImage");(debug||"true"===debug)&&console.log("++++\n++++ Calling WASM Function:seedConnectivityWASM with "+jsonstring+"\n++++");const wasm_output=Module.ccall("seedConnectivityWASM","number",["number","string","number"],[image1_ptr,jsonstring,debug]),output=wrapperutil.deserializeAndDeleteObject(Module,wasm_output,"bisImage",image1);return image1_ptr!==image1&&wasmutil.release_memory(Module,image1_ptr),output},computeGLMWASM:function(image1,image2,matrix3,paramobj,debug){!0!==debug&&"true"!==debug&&1!==debug&&2!==debug?debug=0:2!==debug&&(debug=1);const jsonstring=JSON.stringify(paramobj||{});let image1_ptr=wrapperutil.serializeObject(Module,image1,"bisImage"),image2_ptr=0;0!==image2&&(image2_ptr=wrapperutil.serializeObject(Module,image2,"bisImage"));let matrix3_ptr=wrapperutil.serializeObject(Module,matrix3,"Matrix");(debug||"true"===debug)&&console.log("++++\n++++ Calling WASM Function:computeGLMWASM with "+jsonstring+"\n++++");const wasm_output=Module.ccall("computeGLMWASM","number",["number","number","number","string","number"],[image1_ptr,image2_ptr,matrix3_ptr,jsonstring,debug]),output=wrapperutil.deserializeAndDeleteObject(Module,wasm_output,"bisImage",image1);return image1_ptr!==image1&&wasmutil.release_memory(Module,image1_ptr),0!==image2_ptr&&image2_ptr!==image2&&wasmutil.release_memory(Module,image2_ptr),matrix3_ptr!==matrix3&&wasmutil.release_memory(Module,matrix3_ptr),output},computeROIWASM:function(image1,image2,debug){!0!==debug&&"true"!==debug&&1!==debug&&2!==debug?debug=0:2!==debug&&(debug=1);let image1_ptr=wrapperutil.serializeObject(Module,image1,"bisImage"),image2_ptr=wrapperutil.serializeObject(Module,image2,"bisImage");(debug||"true"===debug)&&console.log("++++\n++++ Calling WASM Function:computeROIWASM\n++++");const wasm_output=Module.ccall("computeROIWASM","number",["number","number","number"],[image1_ptr,image2_ptr,debug]),output=wrapperutil.deserializeAndDeleteObject(Module,wasm_output,"Matrix");return image1_ptr!==image1&&wasmutil.release_memory(Module,image1_ptr),image2_ptr!==image2&&wasmutil.release_memory(Module,image2_ptr),output},butterworthFilterWASM:function(matrix1,paramobj,debug){!0!==debug&&"true"!==debug&&1!==debug&&2!==debug?debug=0:2!==debug&&(debug=1);const jsonstring=JSON.stringify(paramobj||{});let matrix1_ptr=wrapperutil.serializeObject(Module,matrix1,"Matrix");(debug||"true"===debug)&&console.log("++++\n++++ Calling WASM Function:butterworthFilterWASM with "+jsonstring+"\n++++");const wasm_output=Module.ccall("butterworthFilterWASM","number",["number","string","number"],[matrix1_ptr,jsonstring,debug]),output=wrapperutil.deserializeAndDeleteObject(Module,wasm_output,"Matrix");return matrix1_ptr!==matrix1&&wasmutil.release_memory(Module,matrix1_ptr),output},butterworthFilterImageWASM:function(image1,paramobj,debug){!0!==debug&&"true"!==debug&&1!==debug&&2!==debug?debug=0:2!==debug&&(debug=1);const jsonstring=JSON.stringify(paramobj||{});let image1_ptr=wrapperutil.serializeObject(Module,image1,"bisImage");(debug||"true"===debug)&&console.log("++++\n++++ Calling WASM Function:butterworthFilterImageWASM with "+jsonstring+"\n++++");const wasm_output=Module.ccall("butterworthFilterImageWASM","number",["number","string","number"],[image1_ptr,jsonstring,debug]),output=wrapperutil.deserializeAndDeleteObject(Module,wasm_output,"bisImage",image1);return image1_ptr!==image1&&wasmutil.release_memory(Module,image1_ptr),output},computeCorrelationMatrixWASM:function(matrix1,vector2,paramobj,debug){!0!==debug&&"true"!==debug&&1!==debug&&2!==debug?debug=0:2!==debug&&(debug=1);const jsonstring=JSON.stringify(paramobj||{});let matrix1_ptr=wrapperutil.serializeObject(Module,matrix1,"Matrix"),vector2_ptr=0;0!==vector2&&(vector2_ptr=wrapperutil.serializeObject(Module,vector2,"Vector")),(debug||"true"===debug)&&console.log("++++\n++++ Calling WASM Function:computeCorrelationMatrixWASM with "+jsonstring+"\n++++");const wasm_output=Module.ccall("computeCorrelationMatrixWASM","number",["number","number","string","number"],[matrix1_ptr,vector2_ptr,jsonstring,debug]),output=wrapperutil.deserializeAndDeleteObject(Module,wasm_output,"Matrix");return matrix1_ptr!==matrix1&&wasmutil.release_memory(Module,matrix1_ptr),0!==vector2_ptr&&vector2_ptr!==vector2&&wasmutil.release_memory(Module,vector2_ptr),output},weightedRegressOutWASM:function(matrix1,matrix2,vector3,debug){!0!==debug&&"true"!==debug&&1!==debug&&2!==debug?debug=0:2!==debug&&(debug=1);let matrix1_ptr=wrapperutil.serializeObject(Module,matrix1,"Matrix"),matrix2_ptr=wrapperutil.serializeObject(Module,matrix2,"Matrix"),vector3_ptr=0;0!==vector3&&(vector3_ptr=wrapperutil.serializeObject(Module,vector3,"Vector")),(debug||"true"===debug)&&console.log("++++\n++++ Calling WASM Function:weightedRegressOutWASM\n++++");const wasm_output=Module.ccall("weightedRegressOutWASM","number",["number","number","number","number"],[matrix1_ptr,matrix2_ptr,vector3_ptr,debug]),output=wrapperutil.deserializeAndDeleteObject(Module,wasm_output,"Matrix");return matrix1_ptr!==matrix1&&wasmutil.release_memory(Module,matrix1_ptr),matrix2_ptr!==matrix2&&wasmutil.release_memory(Module,matrix2_ptr),0!==vector3_ptr&&vector3_ptr!==vector3&&wasmutil.release_memory(Module,vector3_ptr),output},weightedRegressGlobalSignalWASM:function(matrix1,vector2,debug){!0!==debug&&"true"!==debug&&1!==debug&&2!==debug?debug=0:2!==debug&&(debug=1);let matrix1_ptr=wrapperutil.serializeObject(Module,matrix1,"Matrix"),vector2_ptr=0;0!==vector2&&(vector2_ptr=wrapperutil.serializeObject(Module,vector2,"Vector")),(debug||"true"===debug)&&console.log("++++\n++++ Calling WASM Function:weightedRegressGlobalSignalWASM\n++++");const wasm_output=Module.ccall("weightedRegressGlobalSignalWASM","number",["number","number","number"],[matrix1_ptr,vector2_ptr,debug]),output=wrapperutil.deserializeAndDeleteObject(Module,wasm_output,"Matrix");return matrix1_ptr!==matrix1&&wasmutil.release_memory(Module,matrix1_ptr),0!==vector2_ptr&&vector2_ptr!==vector2&&wasmutil.release_memory(Module,vector2_ptr),output},addGridToImageWASM:function(image1,paramobj,debug){!0!==debug&&"true"!==debug&&1!==debug&&2!==debug?debug=0:2!==debug&&(debug=1);const jsonstring=JSON.stringify(paramobj||{});let image1_ptr=wrapperutil.serializeObject(Module,image1,"bisImage");(debug||"true"===debug)&&console.log("++++\n++++ Calling WASM Function:addGridToImageWASM with "+jsonstring+"\n++++");const wasm_output=Module.ccall("addGridToImageWASM","number",["number","string","number"],[image1_ptr,jsonstring,debug]),output=wrapperutil.deserializeAndDeleteObject(Module,wasm_output,"bisImage",image1);return image1_ptr!==image1&&wasmutil.release_memory(Module,image1_ptr),output},projectImageWASM:function(image1,image2,paramobj,debug){!0!==debug&&"true"!==debug&&1!==debug&&2!==debug?debug=0:2!==debug&&(debug=1);const jsonstring=JSON.stringify(paramobj||{});let image1_ptr=wrapperutil.serializeObject(Module,image1,"bisImage"),image2_ptr=0;0!==image2&&(image2_ptr=wrapperutil.serializeObject(Module,image2,"bisImage")),(debug||"true"===debug)&&console.log("++++\n++++ Calling WASM Function:projectImageWASM with "+jsonstring+"\n++++");const wasm_output=Module.ccall("projectImageWASM","number",["number","number","string","number"],[image1_ptr,image2_ptr,jsonstring,debug]),output=wrapperutil.deserializeAndDeleteObject(Module,wasm_output,"bisImage",image1);return image1_ptr!==image1&&wasmutil.release_memory(Module,image1_ptr),0!==image2_ptr&&image2_ptr!==image2&&wasmutil.release_memory(Module,image2_ptr),output},backProjectImageWASM:function(image1,image2,paramobj,debug){!0!==debug&&"true"!==debug&&1!==debug&&2!==debug?debug=0:2!==debug&&(debug=1);const jsonstring=JSON.stringify(paramobj||{});let image1_ptr=wrapperutil.serializeObject(Module,image1,"bisImage"),image2_ptr=wrapperutil.serializeObject(Module,image2,"bisImage");(debug||"true"===debug)&&console.log("++++\n++++ Calling WASM Function:backProjectImageWASM with "+jsonstring+"\n++++");const wasm_output=Module.ccall("backProjectImageWASM","number",["number","number","string","number"],[image1_ptr,image2_ptr,jsonstring,debug]),output=wrapperutil.deserializeAndDeleteObject(Module,wasm_output,"bisImage",image1);return image1_ptr!==image1&&wasmutil.release_memory(Module,image1_ptr),image2_ptr!==image2&&wasmutil.release_memory(Module,image2_ptr),output},test_wasm:function(debug=!1){return!0!==debug&&"true"!==debug&&1!==debug&&2!==debug?debug=0:2!==debug&&(debug=1),(debug||"true"===debug)&&console.log("++++\n++++ Calling WASM Function:test_wasm\n++++"),Module.ccall("test_wasm","number",[],[])},redirect_stdout:function(string1,debug=!1){return!0!==debug&&"true"!==debug&&1!==debug&&2!==debug?debug=0:2!==debug&&(debug=1),(debug||"true"===debug)&&console.log("++++\n++++ Calling WASM Function:redirect_stdout\n++++"),Module.ccall("redirect_stdout","number",["string"],[string1])},test_matrix4x4:function(linearxform1,debug){!0!==debug&&"true"!==debug&&1!==debug&&2!==debug?debug=0:2!==debug&&(debug=1);let linearxform1_ptr=wrapperutil.serializeObject(Module,linearxform1,"bisLinearTransformation");(debug||"true"===debug)&&console.log("++++\n++++ Calling WASM Function:test_matrix4x4\n++++");const output=Module.ccall("test_matrix4x4","number",["number","number"],[linearxform1_ptr,debug]);return linearxform1_ptr!==linearxform1&&wasmutil.release_memory(Module,linearxform1_ptr),output},test_create_4x4matrix:function(image1,image2,vector3,paramobj,debug){!0!==debug&&"true"!==debug&&1!==debug&&2!==debug?debug=0:2!==debug&&(debug=1);const jsonstring=JSON.stringify(paramobj||{});let image1_ptr=wrapperutil.serializeObject(Module,image1,"bisImage"),image2_ptr=wrapperutil.serializeObject(Module,image2,"bisImage"),vector3_ptr=wrapperutil.serializeObject(Module,vector3,"Vector");(debug||"true"===debug)&&console.log("++++\n++++ Calling WASM Function:test_create_4x4matrix with "+jsonstring+"\n++++");const wasm_output=Module.ccall("test_create_4x4matrix","number",["number","number","number","string","number"],[image1_ptr,image2_ptr,vector3_ptr,jsonstring,debug]),output=wrapperutil.deserializeAndDeleteObject(Module,wasm_output,"bisLinearTransformation");return image1_ptr!==image1&&wasmutil.release_memory(Module,image1_ptr),image2_ptr!==image2&&wasmutil.release_memory(Module,image2_ptr),vector3_ptr!==vector3&&wasmutil.release_memory(Module,vector3_ptr),output},test_eigenUtils:function(linearxform1,vector2,debug){!0!==debug&&"true"!==debug&&1!==debug&&2!==debug?debug=0:2!==debug&&(debug=1);let linearxform1_ptr=wrapperutil.serializeObject(Module,linearxform1,"bisLinearTransformation"),vector2_ptr=wrapperutil.serializeObject(Module,vector2,"Vector");(debug||"true"===debug)&&console.log("++++\n++++ Calling WASM Function:test_eigenUtils\n++++");const output=Module.ccall("test_eigenUtils","number",["number","number","number"],[linearxform1_ptr,vector2_ptr,debug]);return linearxform1_ptr!==linearxform1&&wasmutil.release_memory(Module,linearxform1_ptr),vector2_ptr!==vector2&&wasmutil.release_memory(Module,vector2_ptr),output},test_matlabParse:function(vector1,matrix2,string3,debug){!0!==debug&&"true"!==debug&&1!==debug&&2!==debug?debug=0:2!==debug&&(debug=1);let vector1_ptr=wrapperutil.serializeObject(Module,vector1,"Vector"),matrix2_ptr=wrapperutil.serializeObject(Module,matrix2,"Matrix");(debug||"true"===debug)&&console.log("++++\n++++ Calling WASM Function:test_matlabParse\n++++");const output=Module.ccall("test_matlabParse","number",["number","number","string","number"],[vector1_ptr,matrix2_ptr,string3,debug]);return vector1_ptr!==vector1&&wasmutil.release_memory(Module,vector1_ptr),matrix2_ptr!==matrix2&&wasmutil.release_memory(Module,matrix2_ptr),output},test_bendingEnergy:function(comboxform1,debug){!0!==debug&&"true"!==debug&&1!==debug&&2!==debug?debug=0:2!==debug&&(debug=1);let comboxform1_ptr=wrapperutil.serializeObject(Module,comboxform1,"bisComboTransformation");(debug||"true"===debug)&&console.log("++++\n++++ Calling WASM Function:test_bendingEnergy\n++++");const output=Module.ccall("test_bendingEnergy","number",["number","number"],[comboxform1_ptr,debug]);return comboxform1_ptr!==comboxform1&&wasmutil.release_memory(Module,comboxform1_ptr),output},test_PTZConversions:function(debug){return!0!==debug&&"true"!==debug&&1!==debug&&2!==debug?debug=0:2!==debug&&(debug=1),(debug||"true"===debug)&&console.log("++++\n++++ Calling WASM Function:test_PTZConversions\n++++"),Module.ccall("test_PTZConversions","number",["number"],[debug])},test_eigenUtilOperations:function(debug){return!0!==debug&&"true"!==debug&&1!==debug&&2!==debug?debug=0:2!==debug&&(debug=1),(debug||"true"===debug)&&console.log("++++\n++++ Calling WASM Function:test_eigenUtilOperations\n++++"),Module.ccall("test_eigenUtilOperations","number",["number"],[debug])},test_mirrorComboTransformTextFileWASM:function(string1,debug){!0!==debug&&"true"!==debug&&1!==debug&&2!==debug?debug=0:2!==debug&&(debug=1),(debug||"true"===debug)&&console.log("++++\n++++ Calling WASM Function:test_mirrorComboTransformTextFileWASM\n++++");const wasm_output=Module.ccall("test_mirrorComboTransformTextFileWASM","number",["string","number"],[string1,debug]);return wrapperutil.deserializeAndDeleteObject(Module,wasm_output,"String")},test_compute_histo_metric:function(image1,image2,image3,image4,intval5,paramobj,intval7,debug){!0!==debug&&"true"!==debug&&1!==debug&&2!==debug?debug=0:2!==debug&&(debug=1);const jsonstring=JSON.stringify(paramobj||{});let image1_ptr=wrapperutil.serializeObject(Module,image1,"bisImage"),image2_ptr=wrapperutil.serializeObject(Module,image2,"bisImage"),image3_ptr=0;0!==image3&&(image3_ptr=wrapperutil.serializeObject(Module,image3,"bisImage"));let image4_ptr=0;0!==image4&&(image4_ptr=wrapperutil.serializeObject(Module,image4,"bisImage")),(debug||"true"===debug)&&console.log("++++\n++++ Calling WASM Function:test_compute_histo_metric with "+jsonstring+"\n++++");const wasm_output=Module.ccall("test_compute_histo_metric","number",["number","number","number","number","number","string","number","number"],[image1_ptr,image2_ptr,image3_ptr,image4_ptr,intval5,jsonstring,intval7,debug]),output=wrapperutil.deserializeAndDeleteObject(Module,wasm_output,"Matrix");return image1_ptr!==image1&&wasmutil.release_memory(Module,image1_ptr),image2_ptr!==image2&&wasmutil.release_memory(Module,image2_ptr),0!==image3_ptr&&image3_ptr!==image3&&wasmutil.release_memory(Module,image3_ptr),0!==image4_ptr&&image4_ptr!==image4&&wasmutil.release_memory(Module,image4_ptr),output},uses_gpl:function(debug=!1){return!0!==debug&&"true"!==debug&&1!==debug&&2!==debug?debug=0:2!==debug&&(debug=1),(debug||"true"===debug)&&console.log("++++\n++++ Calling WASM Function:uses_gpl\n++++"),Module.ccall("uses_gpl","number",[],[])},runLinearRegistrationWASM:function(image1,image2,linearxform3,paramobj,debug){!0!==debug&&"true"!==debug&&1!==debug&&2!==debug?debug=0:2!==debug&&(debug=1);const jsonstring=JSON.stringify(paramobj||{});let image1_ptr=wrapperutil.serializeObject(Module,image1,"bisImage"),image2_ptr=wrapperutil.serializeObject(Module,image2,"bisImage"),linearxform3_ptr=0;0!==linearxform3&&(linearxform3_ptr=wrapperutil.serializeObject(Module,linearxform3,"bisLinearTransformation")),(debug||"true"===debug)&&console.log("++++\n++++ Calling WASM Function:runLinearRegistrationWASM with "+jsonstring+"\n++++");const wasm_output=Module.ccall("runLinearRegistrationWASM","number",["number","number","number","string","number"],[image1_ptr,image2_ptr,linearxform3_ptr,jsonstring,debug]),output=wrapperutil.deserializeAndDeleteObject(Module,wasm_output,"bisLinearTransformation");return image1_ptr!==image1&&wasmutil.release_memory(Module,image1_ptr),image2_ptr!==image2&&wasmutil.release_memory(Module,image2_ptr),0!==linearxform3_ptr&&linearxform3_ptr!==linearxform3&&wasmutil.release_memory(Module,linearxform3_ptr),output},runNonLinearRegistrationWASM:function(image1,image2,linearxform3,paramobj,debug){!0!==debug&&"true"!==debug&&1!==debug&&2!==debug?debug=0:2!==debug&&(debug=1);const jsonstring=JSON.stringify(paramobj||{});let image1_ptr=wrapperutil.serializeObject(Module,image1,"bisImage"),image2_ptr=wrapperutil.serializeObject(Module,image2,"bisImage"),linearxform3_ptr=0;0!==linearxform3&&(linearxform3_ptr=wrapperutil.serializeObject(Module,linearxform3,"bisLinearTransformation")),(debug||"true"===debug)&&console.log("++++\n++++ Calling WASM Function:runNonLinearRegistrationWASM with "+jsonstring+"\n++++");const wasm_output=Module.ccall("runNonLinearRegistrationWASM","number",["number","number","number","string","number"],[image1_ptr,image2_ptr,linearxform3_ptr,jsonstring,debug]),output=wrapperutil.deserializeAndDeleteObject(Module,wasm_output,"bisComboTransformation");return image1_ptr!==image1&&wasmutil.release_memory(Module,image1_ptr),image2_ptr!==image2&&wasmutil.release_memory(Module,image2_ptr),0!==linearxform3_ptr&&linearxform3_ptr!==linearxform3&&wasmutil.release_memory(Module,linearxform3_ptr),output},approximateDisplacementFieldWASM:function(image1,gridxform2,paramobj,debug){!0!==debug&&"true"!==debug&&1!==debug&&2!==debug?debug=0:2!==debug&&(debug=1);const jsonstring=JSON.stringify(paramobj||{});let image1_ptr=wrapperutil.serializeObject(Module,image1,"bisImage"),gridxform2_ptr=wrapperutil.serializeObject(Module,gridxform2,"bisGridTransformation");(debug||"true"===debug)&&console.log("++++\n++++ Calling WASM Function:approximateDisplacementFieldWASM with "+jsonstring+"\n++++");const wasm_output=Module.ccall("approximateDisplacementFieldWASM","number",["number","number","string","number"],[image1_ptr,gridxform2_ptr,jsonstring,debug]),output=wrapperutil.deserializeAndDeleteObject(Module,wasm_output,"bisGridTransformation");return image1_ptr!==image1&&wasmutil.release_memory(Module,image1_ptr),gridxform2_ptr!==gridxform2&&wasmutil.release_memory(Module,gridxform2_ptr),output},approximateDisplacementFieldWASM2:function(image1,paramobj,debug){!0!==debug&&"true"!==debug&&1!==debug&&2!==debug?debug=0:2!==debug&&(debug=1);const jsonstring=JSON.stringify(paramobj||{});let image1_ptr=wrapperutil.serializeObject(Module,image1,"bisImage");(debug||"true"===debug)&&console.log("++++\n++++ Calling WASM Function:approximateDisplacementFieldWASM2 with "+jsonstring+"\n++++");const wasm_output=Module.ccall("approximateDisplacementFieldWASM2","number",["number","string","number"],[image1_ptr,jsonstring,debug]),output=wrapperutil.deserializeAndDeleteObject(Module,wasm_output,"bisGridTransformation");return image1_ptr!==image1&&wasmutil.release_memory(Module,image1_ptr),output},segmentImageWASM:function(image1,paramobj,debug){!0!==debug&&"true"!==debug&&1!==debug&&2!==debug?debug=0:2!==debug&&(debug=1);const jsonstring=JSON.stringify(paramobj||{});let image1_ptr=wrapperutil.serializeObject(Module,image1,"bisImage");(debug||"true"===debug)&&console.log("++++\n++++ Calling WASM Function:segmentImageWASM with "+jsonstring+"\n++++");const wasm_output=Module.ccall("segmentImageWASM","number",["number","string","number"],[image1_ptr,jsonstring,debug]),output=wrapperutil.deserializeAndDeleteObject(Module,wasm_output,"bisImage",image1);return image1_ptr!==image1&&wasmutil.release_memory(Module,image1_ptr),output},regularizeObjectmapWASM:function(image1,paramobj,debug){!0!==debug&&"true"!==debug&&1!==debug&&2!==debug?debug=0:2!==debug&&(debug=1);const jsonstring=JSON.stringify(paramobj||{});let image1_ptr=wrapperutil.serializeObject(Module,image1,"bisImage");(debug||"true"===debug)&&console.log("++++\n++++ Calling WASM Function:regularizeObjectmapWASM with "+jsonstring+"\n++++");const wasm_output=Module.ccall("regularizeObjectmapWASM","number",["number","string","number"],[image1_ptr,jsonstring,debug]),output=wrapperutil.deserializeAndDeleteObject(Module,wasm_output,"bisImage",image1);return image1_ptr!==image1&&wasmutil.release_memory(Module,image1_ptr),output},test_optimizer:function(intval1,debug=!1){return!0!==debug&&"true"!==debug&&1!==debug&&2!==debug?debug=0:2!==debug&&(debug=1),(debug||"true"===debug)&&console.log("++++\n++++ Calling WASM Function:test_optimizer\n++++"),Module.ccall("test_optimizer","number",["number"],[intval1])},computeDTITensorFitWASM:function(image1,image2,image3,matrix4,paramobj,debug){!0!==debug&&"true"!==debug&&1!==debug&&2!==debug?debug=0:2!==debug&&(debug=1);const jsonstring=JSON.stringify(paramobj||{});let image1_ptr=wrapperutil.serializeObject(Module,image1,"bisImage"),image2_ptr=wrapperutil.serializeObject(Module,image2,"bisImage"),image3_ptr=0;0!==image3&&(image3_ptr=wrapperutil.serializeObject(Module,image3,"bisImage"));let matrix4_ptr=wrapperutil.serializeObject(Module,matrix4,"Matrix");(debug||"true"===debug)&&console.log("++++\n++++ Calling WASM Function:computeDTITensorFitWASM with "+jsonstring+"\n++++");const wasm_output=Module.ccall("computeDTITensorFitWASM","number",["number","number","number","number","string","number"],[image1_ptr,image2_ptr,image3_ptr,matrix4_ptr,jsonstring,debug]),output=wrapperutil.deserializeAndDeleteObject(Module,wasm_output,"bisImage",image1);return image1_ptr!==image1&&wasmutil.release_memory(Module,image1_ptr),image2_ptr!==image2&&wasmutil.release_memory(Module,image2_ptr),0!==image3_ptr&&image3_ptr!==image3&&wasmutil.release_memory(Module,image3_ptr),matrix4_ptr!==matrix4&&wasmutil.release_memory(Module,matrix4_ptr),output},computeTensorEigenSystemWASM:function(image1,image2,debug){!0!==debug&&"true"!==debug&&1!==debug&&2!==debug?debug=0:2!==debug&&(debug=1);let image1_ptr=wrapperutil.serializeObject(Module,image1,"bisImage"),image2_ptr=0;0!==image2&&(image2_ptr=wrapperutil.serializeObject(Module,image2,"bisImage")),(debug||"true"===debug)&&console.log("++++\n++++ Calling WASM Function:computeTensorEigenSystemWASM\n++++");const wasm_output=Module.ccall("computeTensorEigenSystemWASM","number",["number","number","number"],[image1_ptr,image2_ptr,debug]),output=wrapperutil.deserializeAndDeleteObject(Module,wasm_output,"bisImage",image1);return image1_ptr!==image1&&wasmutil.release_memory(Module,image1_ptr),0!==image2_ptr&&image2_ptr!==image2&&wasmutil.release_memory(Module,image2_ptr),output},computeDTITensorInvariantsWASM:function(image1,image2,paramobj,debug){!0!==debug&&"true"!==debug&&1!==debug&&2!==debug?debug=0:2!==debug&&(debug=1);const jsonstring=JSON.stringify(paramobj||{});let image1_ptr=wrapperutil.serializeObject(Module,image1,"bisImage"),image2_ptr=0;0!==image2&&(image2_ptr=wrapperutil.serializeObject(Module,image2,"bisImage")),(debug||"true"===debug)&&console.log("++++\n++++ Calling WASM Function:computeDTITensorInvariantsWASM with "+jsonstring+"\n++++");const wasm_output=Module.ccall("computeDTITensorInvariantsWASM","number",["number","number","string","number"],[image1_ptr,image2_ptr,jsonstring,debug]),output=wrapperutil.deserializeAndDeleteObject(Module,wasm_output,"bisImage",image1);return image1_ptr!==image1&&wasmutil.release_memory(Module,image1_ptr),0!==image2_ptr&&image2_ptr!==image2&&wasmutil.release_memory(Module,image2_ptr),output},computeDTIColorMapImageWASM:function(image1,image2,image3,paramobj,debug){!0!==debug&&"true"!==debug&&1!==debug&&2!==debug?debug=0:2!==debug&&(debug=1);const jsonstring=JSON.stringify(paramobj||{});let image1_ptr=wrapperutil.serializeObject(Module,image1,"bisImage"),image2_ptr=0;0!==image2&&(image2_ptr=wrapperutil.serializeObject(Module,image2,"bisImage"));let image3_ptr=0;0!==image3&&(image3_ptr=wrapperutil.serializeObject(Module,image3,"bisImage")),(debug||"true"===debug)&&console.log("++++\n++++ Calling WASM Function:computeDTIColorMapImageWASM with "+jsonstring+"\n++++");const wasm_output=Module.ccall("computeDTIColorMapImageWASM","number",["number","number","number","string","number"],[image1_ptr,image2_ptr,image3_ptr,jsonstring,debug]),output=wrapperutil.deserializeAndDeleteObject(Module,wasm_output,"bisImage",image1);return image1_ptr!==image1&&wasmutil.release_memory(Module,image1_ptr),0!==image2_ptr&&image2_ptr!==image2&&wasmutil.release_memory(Module,image2_ptr),0!==image3_ptr&&image3_ptr!==image3&&wasmutil.release_memory(Module,image3_ptr),output}};module.exports=outputobj},"./js/cloud/bisweb_awsmodule.js":function(module,exports,__webpack_require__){"use strict";const AWSParameters=__webpack_require__("./web/aws/awsparameters.js"),bis_webutil=__webpack_require__("./js/coreweb/bis_webutil.js"),bisweb_simplefiledialog=__webpack_require__("./js/coreweb/bisweb_simplefiledialog.js"),BaseServerClient=__webpack_require__("./js/core/bis_baseserverclient.js"),bis_genericio=__webpack_require__("./js/core/bis_genericio.js"),pako=__webpack_require__("./node_modules/pako/index.js"),localforage=__webpack_require__("./node_modules/localforage/dist/localforage.js");let AWS=null;const $=__webpack_require__("jquery");module.exports=class extends BaseServerClient{constructor(){super(),this.hasGUI=!0,this.saveModal=null,this.createUserModal=null,this.authUserModal=null,this.refreshCredentials=!0,this.awsstoredbuckets=null,this.bucketMenuModal=null,this.awsbucketstorage=localforage.createInstance({driver:localforage.INDEXEDDB,name:"bis_webfileutil",version:1,size:1e4,storeName:"AWSBuckets",description:"A database of AWS buckets that the user has attempted to connect to"}),this.awsbucketstorage.getItem("currentAWS",(err,value)=>{try{let parsedAWS=JSON.parse(value);parsedAWS.bucketName&&parsedAWS.identityPoolId?this.currentAWS=JSON.parse(value):this.currentAWS=null}catch(e){this.currentAWS=null}}).catch(()=>{}),bis_webutil.runAfterAllLoaded(()=>{this.fileDisplayModal=new bisweb_simplefiledialog("Bucket Contents"),this.fileDisplayModal.fileListFn=this.changeDirectory.bind(this),bis_webutil.loadJavaScriptModule("https://sdk.amazonaws.com/js/aws-sdk-2.283.1.min.js").then(m=>{console.log("--- "+m),AWS=window.AWS})})}createS3(bucketName,credentials=null,session_token=null){return new AWS.S3({apiVersion:"2006-03-01",credentials:credentials,sessionToken:session_token,params:{Bucket:bucketName}})}createLoadModal(opts){console.log("loadmodal",opts),opts.server="amazonaws",this.s3.listObjectsV2({Delimiter:"/"},(err,data)=>{if(err)return void console.log("an error occured",err);let formattedFiles=this.formatRawS3Files(data.Contents,data.CommonPrefixes,null);this.fileDisplayModal.openDialog(formattedFiles,opts)})}downloadFile(filename,isbinary){return new Promise((resolve,reject)=>{let splitName=filename.split("/");for(let i=0;i<splitName.length&&""===splitName[i];i++)splitName.splice(i,1),i--;let getParams={Key:filename=splitName.join("/"),Bucket:AWSParameters.BucketName()};this.s3.getObject(getParams,(err,data)=>{if(err)reject(err);else if(isbinary)if(bis_genericio.iscompressed(filename)){let unzippedData=pako.ungzip(data.Body);resolve({data:unzippedData,filename:filename})}else resolve({data:data.Body,filename:filename});else resolve({data:data.Body,filename:filename})})})}uploadFile(filename,data,isbinary=!1){let sendData=data;return isbinary&&bis_genericio.iscompressed(filename)&&(sendData=pako.gzip(data)),new Promise((resolve,reject)=>{"/"===filename[0]&&(filename=filename.substring(1,filename.length)),console.log("filename",filename);let uploadParams={Key:filename,Bucket:AWSParameters.BucketName(),Body:sendData};this.s3.upload(uploadParams,err=>{err?(bis_webutil.createAlert("Failed to upload "+filename+" to S3 bucket",!0,0,3e3),console.log("S3 error",err),reject(err)):(bis_webutil.createAlert("Uploaded "+filename+" to S3 bucket successfully",!1,0,3e3),resolve(filename))})})}createSaveModal(opts){opts.server="amazonaws",this.s3.listObjectsV2({Delimiter:"/"},(err,data)=>{if(err)return void console.log("an error occured",err);console.log(JSON.stringify(opts,null,2));let formattedFiles=this.formatRawS3Files(data.Contents,data.CommonPrefixes);this.fileDisplayModal.openDialog(formattedFiles,opts)})}changeDirectory(pathname){return"[Root]"===(pathname=pathname||"")?pathname="":(0===pathname.indexOf("/")&&(pathname=pathname.substr(1,pathname.length)),pathname.lastIndexOf("/")!==pathname.length-1&&(pathname+="/")),new Promise((resolve,reject)=>{this.s3.listObjectsV2({Prefix:pathname,Delimiter:"/"},(err,data)=>{if(err)return console.log("an error occured",err),void reject(err);let formattedFiles=this.formatRawS3Files(data.Contents,data.CommonPrefixes);resolve({data:formattedFiles,path:pathname,root:""})})})}getFileSize(filename){return new Promise((resolve,reject)=>{let splitName=filename.split("/"),folderName=splitName.slice(0,splitName.length-1).join("/");this.s3.listObjectsV2({Prefix:folderName+"/",Delimiter:"/"},(err,data)=>{if(err)reject(err);else{for(let item of data.Contents)item.Key===filename&&resolve(item.Size);reject("No file found")}})})}isDirectory(url){return new Promise((resolve,reject)=>{"/"!==url[url.length-1]&&(url+="/"),this.s3.listObjectsV2({Prefix:url,Delimiter:"/"},(err,data)=>{err?reject(err):data.Contents.length>0?resolve(!0):reject("No file found")})})}makeDirectory(filename){return new Promise((resolve,reject)=>{"/"===filename[0]&&(filename=filename.substring(1,filename.length)),"/"!==filename[filename.length]&&(filename+="/"),console.log("filename",filename);let uploadParams={Key:filename,Bucket:AWSParameters.BucketName(),Body:""};this.s3.upload(uploadParams,err=>{err?(bis_webutil.createAlert("Failed to upload "+filename+" to S3 bucket",!0,0,3e3),console.log("S3 error",err),reject(err)):(bis_webutil.createAlert("Uploaded "+filename+" to S3 bucket successfully",!1,0,3e3),resolve(filename))})})}deleteDirectory(directory){return new Promise((resolve,reject)=>{0===directory.indexOf("/")&&(directory=directory.substr(1,directory.length)),directory.lastIndexOf("/")!==directory.length-1&&(directory+="/"),this.s3.listObjectsV2({Prefix:directory,Delimiter:"/"},(err,data)=>{if(err)return console.log("Error trying to delete directory",directory,err),void reject(err);let deleteParams={Delete:{Objects:[],Quiet:!1}};for(let entry of data.Contents)deleteParams.Delete.Objects.push({Key:entry.Key});this.s3.deleteObjects(deleteParams,(err,data)=>{if(err)return console.log("err",err),void reject(err);console.log("deleted items",data),resolve()})})})}getMatchingFiles(queryString="*"){let s3=this.s3,currentDirectoryIndex=0,currentPrefixList=[""];return new Promise((resolve,reject)=>{let splitString=queryString.split("/");console.log("query string",queryString,"split string",splitString);let handlePrefixExpansion=(values=null)=>{if(currentDirectoryIndex+1>splitString.length){console.log("values on finish",values);let formattedValues=[];for(let value of values.files)formattedValues.push(value.Key);resolve(formattedValues)}else(function(directory,prefixList={}){return new Promise((resolve,reject)=>{console.log("prefix list",prefixList);let promiseList=[];if(""===directory)resolve([]);else if(directory.includes("*"))for(let prefixEntry of prefixList){let listFn=new Promise((resolve,reject)=>{s3.listObjectsV2({Prefix:prefixEntry.Prefix,Delimiter:"/"},(err,data)=>{err&&reject(err),resolve(data)})});promiseList.push(listFn)}Promise.all(promiseList).then(values=>{let filterString=directory.split(".");if(filterString.length>1){filterString=filterString.slice(1).join("."),console.log("filter string",filterString);let filteredFiles={files:[],commonPrefixes:[]};for(let value of values){for(let file of value.Contents){let filename=file.Key.split("/"),fileExtension=(filename=filename[filename.length-1]).split(".");(fileExtension=fileExtension.slice(1).join("."))===filterString&&filteredFiles.files.push(file)}filteredFiles.commonPrefixes=filteredFiles.commonPrefixes.concat(value.CommonPrefixes)}resolve(filteredFiles)}else{let compiledFiles={files:[],commonPrefixes:[]};for(let value of values)compiledFiles.files=compiledFiles.files.concat(value.Contents),compiledFiles.commonPrefixes=compiledFiles.commonPrefixes.concat(value.CommonPrefixes);resolve(compiledFiles)}}).catch(e=>{reject(e)})})})(splitString[currentDirectoryIndex],currentPrefixList).then(values=>{currentPrefixList=values.commonPrefixes,currentDirectoryIndex+=1,handlePrefixExpansion(values)}).catch(e=>{reject(e)})};handlePrefixExpansion()})}wrapInAuth(command,opts){console.log("opts",opts);let expireTime,parseCommand=()=>{switch(command){case"showfiles":this.fileDisplayModal.fileRequestFn=opts.callback,this.createLoadModal(opts);break;case"uploadfile":this.fileDisplayModal.fileRequestFn=opts.callback.bind(this),this.createSaveModal(opts);break;default:console.log("Unrecognized aws command",command,"cannot complete request.")}};return expireTime=AWS.config.credentials&&AWS.config.credentials.expireTime?Date.parse(AWS.config.credentials.expireTime):-1,this.currentAWS?expireTime<Date.now()||this.refreshCredentials?(this.refreshCredentials=!1,void this.awsAuthUser(parseCommand,opts.AWSParameters)):void parseCommand():(this.bucketMenuModal||this.createAWSBucketMenu(),void console.log("Items=",this.awsbucketstorage))}awsAuthUser(cb){AWS.config.update({region:AWSParameters.RegionName,credentials:new AWS.CognitoIdentityCredentials({IdentityPoolId:AWSParameters.IdentityPoolId()})}),this.s3=this.createS3(AWSParameters.BucketName);let returnf="./biswebaws.html";void 0!==window.BIS&&(returnf="../build/web/biswebaws.html");let authParams={regionName:AWSParameters.RegionName,identityPoolId:AWSParameters.IdentityPoolId(),cognitoParams:AWSParameters.getCurrentCognitoParams()};window.addEventListener("awsready",()=>{console.log("received awsready"),authWindow.authParams=authParams,authWindow.dispatchEvent(new CustomEvent("handleIncoming"))});let authWindow=window.open(returnf,"_blank","width=400, height=400"),timeoutEvent=setTimeout(()=>{bis_webutil.createAlert("Timed out waiting for AWS to respond",!0),window.removeEventListener("storage",idTokenEvent)},2e4),idTokenEvent=data=>{if("aws_id_token"===data.key){window.removeEventListener("storage",idTokenEvent),clearTimeout(timeoutEvent);let login={};login[`cognito-idp.${AWSParameters.RegionName}.amazonaws.com/${AWSParameters.authParams.UserPoolId}`]=data.newValue,AWS.config.credentials=new AWS.CognitoIdentityCredentials({IdentityPoolId:AWSParameters.IdentityPoolId(),Logins:login,RoleSessionName:"web"}),AWS.config.credentials.get(err=>{err?(console.log(err),authWindow.postMessage({failure:"auth failed",error:err.toString()},"*")):(console.log("Exchanged access token for access key"),authWindow.postMessage({success:"auth complete"},"*"),AWS.config.credentials.refresh(err=>{err?console.log("an error occured refreshing",err):(console.log("refresh successful."),this.s3=this.createS3(AWSParameters.BucketName(),AWS.config.credentials),authWindow.close(),cb())}))})}};window.addEventListener("storage",idTokenEvent)}changeBuckets(newBucketInfo){this.s3=this.createS3(newBucketInfo.bucketName),this.currentAWS={bucketName:newBucketInfo.bucketName,identityPoolId:newBucketInfo.identityPoolId,userPoolId:newBucketInfo.userPoolId,appClientId:newBucketInfo.appClientId,appWebDomain:newBucketInfo.appWebDomain},AWSParameters.updateBucketInfo(newBucketInfo),this.refreshCredentials=!0}formatRawS3Files(files,directories,suffixes=null){let filtersArray=suffixes?suffixes.split(","):null;if(suffixes)for(let i=0;i<filtersArray.length;i++)filtersArray[i]=filtersArray[i].substring(1);let paths=[];for(let file of files){let splitFile=file.Key.split("/"),fileExtension=splitFile[splitFile.length-1].split(".");if(suffixes)for(let filter of filtersArray)fileExtension[fileExtension.length-1]===filter&&paths.push({filepath:splitFile,size:file.Size});else paths.push({filepath:splitFile,size:file.Size})}let formattedFiles=[];for(let path of paths){let fullpath=path.filepath.join("/"),name=path.filepath[path.filepath.length-1],fileType=name.split(".");if(fileType=fileType[fileType.length-1],name.length>0){let newEntry={text:name,path:fullpath,size:path.size};switch(fileType[fileType.length-1]){case"gz":newEntry.type="nii"===fileType[fileType.length-2]?"picture":"file";break;case"md":newEntry.type="text";break;case"mkv":case"avi":case"mp4":newEntry.type="video";break;case"mp3":case"flac":case"FLAC":case"wav":case"WAV":newEntry.type="audio";break;default:newEntry.type="file"}formattedFiles.push(newEntry)}}formattedFiles.sort((a,b)=>{let pathA=a.text.toLowerCase(),pathB=b.text.toLowerCase();return pathA>pathB?1:pathA<pathB?-1:0});for(let directory of directories){let name=directory.Prefix.split("/"),newEntry={text:name=name[name.length-2],path:directory.Prefix,type:"directory",children:[]};formattedFiles.unshift(newEntry)}return formattedFiles}createAWSBucketMenu(){if(!this.bucketMenuModal){let awsmodal=bis_webutil.createmodal("AWS Buckets","modal-lg");awsmodal.dialog.find(".modal-content").addClass("resizing-frame show-selector");let tabView=this.createAWSTabView(awsmodal),selectPane=this.createAWSBucketSelector(awsmodal,tabView);tabView.find("#aws-bucket-selector-pane").append(selectPane);let entryPane=this.createAWSBucketEntry(awsmodal);tabView.find("#aws-bucket-entry-pane").append(entryPane),awsmodal.dialog.find(".modal-footer").remove(),awsmodal.dialog.on("hidden.bs.modal",()=>{awsmodal.body.find("#bucket-selector-dropdown").empty(),awsmodal.body.find("#aws-bucket-entry-pane").find("input").each((index,element)=>{$(element).val("")})}),this.bucketMenuModal=awsmodal}return this.bucketMenuModal.dialog.modal("show"),this.bucketMenuModal}createAWSTabView(awsmodal){let tabView=$('\n                <ul class="nav nav-tabs" id="aws-tab-menu" role="tablist">\n                    <li class="nav-item active">\n                        <a class="nav-link" id="selector-tab" data-toggle="tab" href="#aws-selector-tab-panel" role="tab" aria-controls="home" aria-selected="true">Select AWS Bucket</a>\n                    </li>\n                    <li class="nav-item">\n                        <a class="nav-link" id="entry-tab" data-toggle="tab" href="#aws-entry-tab-panel" role="tab" aria-controls="entry" aria-selected="false">Enter New Bucket</a>\n                    </li>\n                </ul>\n                <div class="tab-content" id="aws-tab-content">\n                    <div class="tab-pane fade active in" id="aws-selector-tab-panel" role="tabpanel" aria-labelledby="selector-tab">\n                        <br>\n                        <div id="aws-bucket-selector-pane"></div>\n                    </div>\n                    <div class="tab-pane fade" id="aws-entry-tab-panel" role="tabpanel" aria-labelledby="profile-tab">\n                        <br>\n                        <div id="aws-bucket-entry-pane"></div>\n                    </div>\n                </div>\n                ');awsmodal.body.append(tabView);let navTabs=awsmodal.body.find(".nav-tabs a");return navTabs.on("show.bs.tab",e=>{"entry-tab"===e.target.id?(awsmodal.dialog.find(".modal-content").removeClass("show-selector"),awsmodal.dialog.find(".modal-content").addClass("show-entry")):"selector-tab"===e.target.id&&(awsmodal.dialog.find(".modal-content").removeClass("show-entry"),awsmodal.dialog.find(".modal-content").addClass("show-selector"))}),console.log("nav tabs",navTabs),tabView}createAWSBucketSelector(awsmodal,tabView){let selectContainer=$("\n            <div class='container-fluid form-group' style=\"margin-top: 10px\">\n                <label for='bucket-selector'>Select a Bucket:</label>\n                <select class='form-control' id='bucket-selector-dropdown' css=\"margin-top:10px; margin-left:10px; margin-right:10px\">\n                </select>\n                <div id='bucket-selector-table-container'></div>\n                <div class='btn-group' role=group' aria-label='Viewer Buttons' style='float: left; margin-top:10px'></div>\n            </div>\n        "),confirmButton=bis_webutil.createbutton({name:"Confirm",type:"success"}),cancelButton=bis_webutil.createbutton({name:"Cancel",type:"danger"}),entryButton=bis_webutil.createbutton({name:"Enter New Bucket",type:"info"});$(confirmButton).prop("disabled","disabled");let buttonGroup=selectContainer.find(".btn-group");buttonGroup.append(confirmButton),buttonGroup.append(cancelButton),buttonGroup.append(entryButton);let refreshDropdown=()=>new Promise((resolve,reject)=>{let bucketSelectorDropdown=selectContainer.find("#bucket-selector-dropdown");bucketSelectorDropdown.empty(),this.awsstoredbuckets={},bucketSelectorDropdown.append("<option id='aws-empty-entry'></option>"),this.awsbucketstorage.iterate((value,key)=>{try{if("currentAWS"!==key){let bucketObj=JSON.parse(value),entry=$(`<option id=${key} value=${bucketObj.bucketName}>${bucketObj.bucketName}</option>`);bucketSelectorDropdown.append(entry),this.awsstoredbuckets[key]=bucketObj}}catch(e){console.log("an error occured while parsing the AWS bucket data",e),reject(e)}}).then(()=>{resolve(bucketSelectorDropdown)}).catch(err=>{console.log("an error occured while fetching values from localstorage",err),reject(err)})}),dropdown=selectContainer.find("#bucket-selector-dropdown");return dropdown.on("change",()=>{let tableContainer=awsmodal.body.find("#bucket-selector-table-container");tableContainer.empty();let selectedItemId=dropdown[0][dropdown[0].selectedIndex].id;if("aws-empty-entry"!==selectedItemId){let selectedItemInfo=this.awsstoredbuckets[selectedItemId],tableHead=$('\n                    <table class=\'table table-sm table-dark\'>\n                        <thead> \n                            <tr>\n                                <th scope="col">Bucket Name</th>\n                                <th scope="col">Identity Pool ID</th>\n                                <th scope="col">User Pool ID</th>\n                                <th scope="col">App Client ID</th>\n                                <th scope="col">App Web Domain</th>\n                                <th scope="col"></th>\n                            </tr>\n                        </thead>\n                        <tbody id=\'aws-selector-table-body\' align=\'justify\'>   \n                        </tbody>               \n                    </table> \n                '),tableRow=$(`\n                    <td class='bootstrap-table-entry bucket-name'>${selectedItemInfo.bucketName}</td>\n                    <td class='bootstrap-table-entry identity-pool-id'>${selectedItemInfo.identityPoolId}</td>\n                    <td class='bootstrap-table-entry user-pool-id'>${selectedItemInfo.userPoolId}</td>\n                    <td class='bootstrap-table-entry client-id'>${selectedItemInfo.appClientId}</td>\n                    <td class='bootstrap-table-entry web-domain'>${selectedItemInfo.appWebDomain}</td>\n                    <td class='bootstrap-table-entry'>\n                        <span class='input-group-btn'>\n                            <button class='btn btn-default btn-sm'>\n                                <i class='glyphicon glyphicon-pencil'></i>\n                            </button>\n                        </span>\n                    </td>\n                `);tableRow.find(".btn").on("click",()=>{this.awsbucketstorage.getItem(selectedItemId).then(val=>{let parsedVal;try{parsedVal=JSON.parse(val)}catch(e){console.log("could not parsed val",val)}this.createAWSEditModal(selectedItemId,parsedVal).then(params=>{console.log("params",params),tableContainer.find("table .bucket-name")[0].innerHTML=params.bucketName,tableContainer.find("table .identity-pool-id")[0].innerHTML=params.identityPoolId,tableContainer.find("table .user-pool-id")[0].innerHTML=params.userPoolId,tableContainer.find("table .client-id")[0].innerHTML=params.appClientId,tableContainer.find("table .web-domain")[0].innerHTML=params.appWebDomain,refreshDropdown().then(dropdown=>{console.log("refresh dropdown",dropdown,"bucket name",params.bucketName),dropdown.val(params.bucketName)})}).catch(e=>{"Edit Canceled"!==e?console.log("error",e):bis_webutil.createAlert("Edit canceled",!1,null,2500)})})}),tableHead.find("#aws-selector-table-body").append(tableRow),tableContainer.append(tableHead),confirmButton.prop("disabled","")}else confirmButton.prop("disabled","disabled")}),awsmodal.dialog.on("hidden.bs.modal",()=>{$("#bucket-selector-table-container").empty(),$(confirmButton).prop("disabled","disabled")}),confirmButton.on("click",e=>{e.preventDefault();let selectedItem=dropdown[0][dropdown[0].selectedIndex];if(!selectedItem.id)return void bis_webutil.showErrorModal("An error occured","Please select an item from the list");let selectedItemInfo=this.awsstoredbuckets[selectedItem.id];selectedItemInfo.id=selectedItem.id,console.log("selectedItemInfo",selectedItemInfo),this.awsbucketstorage.setItem("currentAWS",JSON.stringify(selectedItemInfo)),this.changeBuckets(selectedItemInfo),awsmodal.dialog.modal("hide"),bis_webutil.createAlert("Changed to bucket "+selectedItemInfo.bucketName,!1,null,2500)}),cancelButton.on("click",e=>{e.preventDefault(),awsmodal.dialog.modal("hide")}),entryButton.on("click",e=>{e.preventDefault();let newBucketTab=awsmodal.body.find("#entry-tab");console.log("new bucket tab"),newBucketTab.click()}),tabView.find("#selector-tab").on("show.bs.tab",refreshDropdown),awsmodal.dialog.on("show.bs.modal",refreshDropdown),selectContainer}createAWSEditModal(id,oldParams){return new Promise((resolve,reject)=>{let editModal=bis_webutil.createmodal("Edit Entry","modal-sm"),editContainer=$("\n                <div class='container-fluid'>\n                    <div class='form-group'>\n                        <label for='bucket'>Bucket Name:</label><br>\n                        <input name='bucket' class='edit-bucket-input' type='text' class='form-control'><br>\n                        <label for='access-key'>Identity Pool ID:</label><br>\n                        <input name='access-key' class='edit-identity-pool-input' type='text' class='form-control'>\n                        <label for='pool-id'>User Pool ID:</label><br>\n                        <input name='pool-id' class='edit-user-pool-input' type='text' class='form-control'>\n                        <label for='client-id'>App Client ID:</label><br>\n                        <input name='client-id' class='edit-client-input' type='text' class='form-control'>\n                        <label for='web-domain'>App Web Domain:</label><br>\n                        <input name='web-domain' class='edit-web-domain-input' type='text' class='form-control'>\n                    </div>\n                    <div class='btn-group' role=group' aria-label='Viewer Buttons' style='float: left'></div>\n                </div>\n            "),confirmButton=bis_webutil.createbutton({name:"Confirm",type:"success"}),cancelButton=bis_webutil.createbutton({name:"Cancel",type:"danger"});console.log("old params",oldParams),editContainer.find(".edit-bucket-input").val(oldParams.bucketName),editContainer.find(".edit-identity-pool-input").val(oldParams.identityPoolId),editContainer.find(".edit-user-pool-input").val(oldParams.userPoolId),editContainer.find(".edit-client-input").val(oldParams.appClientId),editContainer.find(".edit-web-domain-input").val(oldParams.appWebDomain);let newBucketName,newIdentityPoolId,newUserPoolId,newClientId,newWebDomain,buttonGroup=editContainer.find(".btn-group"),resolvePromise=!1;confirmButton.on("click",e=>{e.preventDefault(),newBucketName=editContainer.find(".edit-bucket-input").val(),newIdentityPoolId=editContainer.find(".edit-identity-pool-input").val(),newUserPoolId=editContainer.find(".edit-user-pool-input").val(),newClientId=editContainer.find(".edit-client-input").val(),newWebDomain=editContainer.find(".edit-web-domain-input").val();let paramsObj=this.createNewBucketInfo(newBucketName,newIdentityPoolId,newUserPoolId,newClientId,newWebDomain);paramsObj.id=id,this.awsbucketstorage.setItem(id,JSON.stringify(paramsObj)),this.awsbucketstorage.setItem("currentAWS",JSON.stringify(paramsObj)),bis_webutil.createAlert("Settings changed.",!1,null,2500),resolvePromise=!0,editModal.dialog.modal("hide")}),cancelButton.on("click",e=>{e.preventDefault(),editModal.dialog.modal("hide")}),editModal.dialog.on("hidden.bs.modal",()=>{if(resolvePromise){let paramsObj=this.createNewBucketInfo(newBucketName,newIdentityPoolId,newUserPoolId,newClientId,newWebDomain);paramsObj.id=id,resolve(paramsObj)}else reject("Edit canceled")}),editModal.body.append(editContainer),buttonGroup.append(confirmButton),buttonGroup.append(cancelButton),editModal.footer.remove(),editModal.dialog.modal("show")})}createAWSBucketEntry(awsmodal){let entryContainer=$("\n            <div class='container-fluid'>\n                <div class='form-group'>\n                    <label for='bucket'>Bucket Name:</label><br>\n                    <input name='bucket' class='bucket-input' type='text' class='form-control'>\n                    <span class='glyphicon glyphicon-question-sign bucket-input-info' style='color: rgb(12, 227, 172);' data-toggle='tooltip' title='The full name of your bucket, e.g. \"bisweb-test-bucket\"'></span><br>\n                    <label for='access-key'>Identity Pool ID:</label><br>\n                    <input name='access-key' class='identity-pool-input' type='text' class='form-control'>\n                    <span class='glyphicon glyphicon-question-sign idpool-input-info' style='color: rgb(12, 227, 172);' data-toggle='tooltip' title='The Identity Pool ID will take the form region:identifier. For more info on how to find the ID, consult AWSBuckets.md in the docs section of the repository.'></span><br>\n                    <label for='pool-id'>User Pool ID:</label><br>\n                    <input name='pool-id' class='user-pool-input' type='text' class='form-control'>\n                    <span class='glyphicon glyphicon-question-sign idpool-input-info' style='color: rgb(12, 227, 172);' data-toggle='tooltip' title='The User Pool ID should take the form region:identifier, e.g. \"us-east-1\" followed by a series of letters and characters.'></span><br>\n                    <label for='client-id'>App Client ID:</label><br>\n                    <input name='client-id' class='client-input' type='text' class='form-control'>\n                    <span class='glyphicon glyphicon-question-sign client-input-info' style='color: rgb(12, 227, 172);' data-toggle='tooltip' title='The App Client ID is the identifier for the App Client associated with your User Pool. It should be a 25 character string that you can find on the \"App client settings\" section of your User Pool settings.'></span><br>\n                    <label for='web-domain'>App Web Domain:</label><br>\n                    <input name='web-domain' class='web-domain-input' type='text' class='form-control'>\n                    <span class='glyphicon glyphicon-question-sign web-domain-input-info' style='color: rgb(12, 227, 172);' data-toggle='tooltip' title='The App Web Domain is the URL at which you should authenticate with your User Pool, i.e. a web address ending in \".amazoncognito.com\". Consult the User Pool section of AWSBuckets.md for more detail.'></span><br>\n                </div>\n                <div class='btn-group' role=group' aria-label='Viewer Buttons' style='float: left'></div>\n            </div>\n        "),confirmButton=bis_webutil.createbutton({name:"Confirm",type:"success"}),cancelButton=bis_webutil.createbutton({name:"Cancel",type:"danger"}),selectBucketButton=bis_webutil.createbutton({name:"Select an Existing Bucket",type:"info"}),importButton=bis_webutil.createbutton({name:"Import",type:"primary"}),importCallbackAttached=!1;confirmButton.on("click",e=>{e.preventDefault();let bucketName=entryContainer.find(".bucket-input")[0].value.replace(/\s*/g,""),identityPoolId=entryContainer.find(".identity-pool-input")[0].value.replace(/\s*/g,""),userPoolId=entryContainer.find(".user-pool-input")[0].value.replace(/\s*/g,""),appClientId=entryContainer.find(".client-input")[0].value.replace(/\s*/g,""),appWebDomain=entryContainer.find(".web-domain-input")[0].value.replace(/\s*/g,"").replace(/^https:\/\//,"");if(""===bucketName||""===identityPoolId||""===userPoolId||""===appClientId||""===appWebDomain)return void bis_webutil.showErrorModal("An error occured","Please fill out all the required fileds");let key="awsbucket"+bis_webutil.getuniqueid(),paramsObj=this.createNewBucketInfo(bucketName,identityPoolId,userPoolId,appClientId,appWebDomain);paramsObj.id=key,this.awsbucketstorage.setItem(key,JSON.stringify(paramsObj)),this.awsbucketstorage.setItem("currentAWS",JSON.stringify(paramsObj)),this.changeBuckets(paramsObj),awsmodal.dialog.modal("hide"),bis_webutil.createAlert("Created bucket "+bucketName+" and switched to it.",!1,null,2500)}),cancelButton.on("click",e=>{e.preventDefault(),awsmodal.dialog.modal("hide")}),importButton.on("click",e=>{if(e.preventDefault(),!importCallbackAttached){let webfileutil=__webpack_require__("./js/coreweb/bis_webfileutil.js");return this.attachImportFileCallback(importButton,webfileutil,awsmodal),importCallbackAttached=!0,void importButton.click()}awsmodal.dialog.modal("hide")}),selectBucketButton.on("click",e=>{e.preventDefault(),awsmodal.body.find("#selector-tab").click()});let bucketInfoSpan=entryContainer.find(".bucket-input-info");bucketInfoSpan.on("click hover",()=>{bucketInfoSpan.tooltip("show")});let idpoolInfoSpan=entryContainer.find(".idpool-input-info");idpoolInfoSpan.on("click",()=>{idpoolInfoSpan.tooltip("show")});let buttonBar=entryContainer.find(".btn-group");return buttonBar.append(confirmButton),buttonBar.append(cancelButton),buttonBar.append(importButton),buttonBar.append(selectBucketButton),entryContainer}attachImportFileCallback(importButton,webfileutil,awsmodal){function fillOutModalFields(entryContainer,parsedJSON){parsedJSON.bucketName&&entryContainer.find(".bucket-input").val(parsedJSON.bucketName.trim()),parsedJSON.identityPoolId&&entryContainer.find(".identity-pool-input").val(parsedJSON.identityPoolId.trim()),parsedJSON.userPoolId&&entryContainer.find(".user-pool-input").val(parsedJSON.userPoolId.trim()),parsedJSON.appClientId&&entryContainer.find(".client-input").val(parsedJSON.appClientId.trim()),parsedJSON.appWebDomain&&entryContainer.find(".web-domain-input").val(parsedJSON.appWebDomain.trim())}webfileutil.attachFileCallback(importButton,file=>{if(console.log("file",file),file=file.data?file.data.result?file.data.result:file.data:file,console.log("typeof file",file instanceof File),file instanceof File){let fileReader=new FileReader(file);fileReader.addEventListener("loadend",e=>{try{let parsedJSON=JSON.parse(e.target.result);awsmodal.dialog.modal("show"),console.log("parsedJSON",parsedJSON),fillOutModalFields(awsmodal.dialog,parsedJSON)}catch(e){console.log("An error occured while parsing",file.name,e),awsmodal.dialog.modal("show")}}),fileReader.addEventListener("error",e=>{console.log("An error occured while trying to read",file.name,e),awsmodal.dialog.modal("show")}),fileReader.readAsText(file)}else awsmodal.dialog.modal("show"),fillOutModalFields(awsmodal.dialog,file)})}createNewBucketInfo(bucketName,identityPoolId,userPoolId,appClientId,appWebDomain){return{bucketName:bucketName,identityPoolId:identityPoolId,userPoolId:userPoolId,appClientId:appClientId,appWebDomain:appWebDomain}}}},"./js/cloud/bisweb_drivemodule.js":function(module,exports,__webpack_require__){"use strict";const genericio=__webpack_require__("./js/core/bis_genericio.js"),keys=__webpack_require__("../internal/js/bis_keystore.js");function getContentLength(content,contentType){if("text/plain"===contentType)return content.length;if(content instanceof Uint8Array)return content.length;if("application/octet-stream"===contentType||"image/png"===contentType)return content.byteLength;{let c,b=0,i=0;for(;c=content.charCodeAt(i++);b+=c>>11?3:c>>7?2:1);return b}}let internal={drivemodule:null},downloadFileInterface=function(fileobject,isbinary=!1){isbinary=isbinary||!1;let reqArgs={};return reqArgs.path="https://www.googleapis.com/drive/v2/files/"+fileobject.id,reqArgs.method="GET",reqArgs.encoding=null,new Promise(function(resolve,reject){gapi.client.request(reqArgs).then(response=>{let url=response.result.downloadUrl,requestheader=gapi.auth2.getAuthInstance().currentUser.get().getAuthResponse().access_token,success=function(data,fname){resolve({data:data,filename:fname})},failure=function(e){reject(e)};isbinary?genericio.readbinarydatafromurl(url,success,failure,requestheader,fileobject.name):genericio.readtextdatafromurl(url,success,failure,requestheader,fileobject.name)}).catch(e=>{reject(e)})})},uploadFileInterface=function(fileobject,data,isbinary=!1){return new Promise(function(resolve,reject){isbinary=isbinary||!1;let params={destination:{path:fileobject.url,id:fileobject.id,name:fileobject.name,mimeType:fileobject.mimeType},upload:{data:data,mimeType:isbinary?"application/octet-stream":"image/png"}};internal.drivemodule.uploadFile(params,function(msg){resolve(msg)},function(e){reject(e)})})},pickFile=function(filter,responseFunction){return new Promise(function(resolve,reject){let callback=function(listoffiles){let output=[],retrieveFilesPromiseArray=[],l=listoffiles.files.length;l<1&&reject("Empty File List");for(let i=0;i<l;i++){let fobj=listoffiles.files[i];output.push({url:fobj.path,id:fobj.id,name:fobj.name,mimeType:fobj.mimeType,sourcetype:"Google",responseFunction:responseFunction}),"text/plain"!==fobj.mimeType&&"application/json"!==fobj.mimeType||retrieveFilesPromiseArray.push(internal.drivemodule.retrieveFile(fobj).then(data=>{output[i].data=data}).catch(e=>{console.log("Google Drive retrieveFile returned an error",e)}))}filter.includes("single")?resolve(output[0]):Promise.all(retrieveFilesPromiseArray).then(()=>{resolve(output)})};try{internal.drivemodule.wrapInAuth(internal.drivemodule,internal.drivemodule.createPicker,callback,!!filter.includes("folder"),{},filter)}catch(e){reject("Google Drive pickFile encountered an error",e)}})};module.exports={create:function(){return null===internal.drivemodule&&(internal.drivemodule=new class{constructor(){this.clientid=keys.GoogleDriveClientID,this.apikey=keys.GoogleDriveKey,this.discoverydoc=["https://www.googleapis.com/discovery/v1/apis/drive/v3/rest"],this.scopes="https://www.googleapis.com/auth/drive";const self=this;self.promise=new Promise((resolve,reject)=>{let apiTag=document.createElement("script");apiTag.src="https://apis.google.com/js/api.js",apiTag.onload=(()=>{console.log("base api load complete"),gapi.load("client:auth2:picker",{callback:()=>{console.log("drive auth module loaded"),gapi.client.init({apiKey:this.apikey,clientId:this.clientid,discoveryDocs:this.discoverydoc,scope:this.scopes}).then(function(){console.log("drive initialized successfully"),resolve(self)},function(e){console.log("an error occured",e),reject("drive client failed to initialize "+e)})},onerror:()=>{console.log("error: could not initialize Google API")}})}),document.head.appendChild(apiTag)})}isReady(){return this.promise}wrapInAuth(context,driveFunction,...args){let df=driveFunction.apply.bind(driveFunction,context,args);gapi?gapi.auth2.getAuthInstance().isSignedIn.get()?df():gapi.auth2.getAuthInstance().signIn().then(()=>{df()}):console.log("Google Drive API did not load successfully, cannot do auth")}createPicker(callback,showFolders=!1,callbackargs={}){let pickerCallback=function(data){if(data[google.picker.Response.ACTION]==google.picker.Action.PICKED){let selected=[];data.docs.forEach(doc=>{let args={};args.path="https://www.googleapis.com/drive/v3/files/"+doc.id+"?alt=media",args.method="GET";let fobj={path:args.path,id:doc.id,name:doc.name,mimeType:doc.mimeType};selected.push(fobj)}),callbackargs.files?callbackargs.files.push(selected):callbackargs.files=selected,callback(callbackargs)}},docsView=new google.picker.DocsView(google.picker.ViewId.FOLDER).setIncludeFolders(!0).setSelectFolderEnabled(!0),folderPicker=(new google.picker.PickerBuilder).addView(docsView).setOAuthToken(gapi.auth2.getAuthInstance().currentUser.get().getAuthResponse().access_token).setDeveloperKey(this.apikey).setCallback(pickerCallback).setOrigin(window.location.protocol+"//"+window.location.host).build(),filePicker=(new google.picker.PickerBuilder).addView(google.picker.ViewId.DOCS).setOAuthToken(gapi.auth2.getAuthInstance().currentUser.get().getAuthResponse().access_token).setDeveloperKey(this.apikey).setCallback(pickerCallback).setOrigin(window.document.URL).build();showFolders?folderPicker.setVisible(!0):filePicker.setVisible(!0)}downloadFile(args){let reqArgs={},file=args.file?args.file:args.files[0];reqArgs.path="https://www.googleapis.com/drive/v3/files/"+file.id+"?alt=media",reqArgs.method="GET",gapi.client.request(reqArgs).then(response=>{console.log("request successful, downloading"),console.log(response),genericio.write(file.name,response.body,!0).then(()=>{console.log("download complete")}).catch(e=>{console.log("download encountered an error ",e)})})}downloadFilesFromFolder(folder){let folderId;folderId=typeof folder!==String?folder.files[0].id:folder;let args={};args.path="https://www.googleapis.com/drive/v2/files/"+folderId+"/children",args.method="GET",args.params={maxResults:1e3},gapi.client.request(args).then(response=>{let drive=document.getElementById("drive_element");window.confirm("Import filenames? Files will be given a default name otherwise.")?response.result.items.forEach(file=>{let nameArgs={path:"https://www.googleapis.com/drive/v3/files/"+file.id};gapi.client.request(nameArgs).then(res=>{file.name=res.result.name,drive.downloadFile({file:file})})}):response.result.items.forEach(file=>{file.name=file.id.substring(0,5)+".nii.gz",drive.downloadFile({file:file})})})}retrieveFile(args){return new Promise((resolve,reject)=>{console.log("args",args);let reqArgs={};reqArgs.path="https://www.googleapis.com/drive/v3/files/"+args.id+"?alt=media",reqArgs.method="GET",gapi.client.request(reqArgs).then(response=>{console.log("response",response),resolve(response)}).catch(e=>{reject("Google Drive retrieveFile encountered an error",e)})})}uploadFile(params,finishedcallback=null,errorcallback=null){finishedcallback=finishedcallback||console.log,errorcallback=errorcallback||console.log;let args={},uploadArgs={},dst=params.destination,upload=params.upload,date=new Date,dateString=date.getMonth()+1+"/"+date.getDate()+" "+date.getHours()%12+":"+date.getMinutes();if(console.log(dateString),args.params=args.headers={},args.body={name:"Upload "+dateString+".png",description:dst.description?dst.description:"no description",mimeType:upload.mimeType},console.log(dst),args.headers["Content-Type"]="application/json; charset=UTF-8",args.headers["X-Upload-Content-Type"]="image/png",args.headers["X-Upload-Content-Length"]=getContentLength(upload.data,upload.mimeType),"application/vnd.google-apps.folder"===dst.mimeType){if(!window.confirm("Upload file to selected folder?"))return;args.path="https://www.googleapis.com/upload/drive/v3/files?uploadType=resumable&X-Upload-Content-Length="+getContentLength(upload.data,upload.mimeType),args.method="POST",args.body.parents=[dst.id]}else if(dst.id){if(!window.confirm("Replace contents of selected file with viewer?"))return;args.path="https://www.googleapis.com/upload/drive/v3/files/"+dst.id+"?uploadType=resumable",args.method="PUT"}else dst.path?(args.path=dst.path,args.method="POST"):(args.path="https://www.googleapis.com/upload/drive/v3/files?uploadType=resumable",args.method="POST");gapi.client.request(args).then(response=>{if(200==response.status){uploadArgs.headers={},uploadArgs.path=response.headers.location,uploadArgs.method="PUT";let contentLength=uploadArgs.headers["Content-Length"]=getContentLength(upload.data,upload.mimeType);uploadArgs.headers["X-Upload-Content-Type"]=upload.mimeType,uploadArgs.body=upload.data,console.log("upload",uploadArgs),gapi.client.request(uploadArgs).then(()=>{console.log("upload complete")}).catch(function(response){var args;console.log(response),console.log("transmission encountered an error, attempting to recover..."),args={path:uploadArgs.path,headers:{"Content-Length":0,"Content-Range":"*/*"}},gapi.client.request(args).then(rangeResponse=>{switch(rangeResponse.headers.status){case 200:case 201:finishedcallback("transmission complete");break;case 308:{let bounds=rangeResponse.headers.Range.slice(6,-1).split("-"),reuploadArgs={headers:{}};reuploadArgs.headers["Content-Length"]=contentLength-bounds[1]-1,reuploadArgs.headers["Content-Range"]="bytes "+(bounds[1]+1)+"-"+contentLength-1+"/"+contentLength,alert("attempting retry without an implemented retry body. write this!");break}case 404:errorcallback("transmission unrecoverable, please initiate transfer again");break;default:errorcallback.log("could not interpret range response, aborting transmission")}})})}else errorcallback("an error occured, see response"+response)}).catch(response=>{errorcallback(response)})}parseAndFetch(files,outputobj=null){let unidentifiedFiles=[],identifiedFiles=[];files.forEach(file=>{file.id?identifiedFiles.push(file):file.name?unidentifiedFiles.push(file):console.log("no name or id specified, cannot fetch file")}),this.createUserFileList().then(response=>{let allFiles=response.list;unidentifiedFiles.sort(function(a,b){return a.name.localeCompare(b.name)}),allFiles.sort(function(a,b){return a.name.localeCompare(b.name)}),console.log(unidentifiedFiles),console.log(response);let uidIndex=0,cmp=0;for(let file of allFiles){if(0===(cmp=unidentifiedFiles[uidIndex].name.localeCompare(file.name)))console.log("located "+file.name),identifiedFiles.push({id:file.id,name:file.name}),unidentifiedFiles.splice(uidIndex,1);else if(cmp<0)do{uidIndex++,console.log("uidIndex = "+uidIndex+" allFiles at comparison location = "+file.name)}while(uidIndex<unidentifiedFiles.length&&unidentifiedFiles[uidIndex].name.localeCompare(file.name)<0);if(uidIndex>=unidentifiedFiles.length)break}console.log(identifiedFiles),null!==outputobj?outputobj.identifiedFiles=identifiedFiles:identifiedFiles.forEach(file=>{console.log(file),this.requestFileDownload(file)})}).catch(response=>{console.log(response.message)})}createUserFileList(){let accumulatedPages=[];function pageLoop(pageToken,loopResolve,loopReject){(function(pageToken){return new Promise((resolve,reject)=>{let args={path:"https://www.googleapis.com/drive/v3/files",method:"GET"};args.params={corpora:"user",pageSize:1e3,pageToken:pageToken},pageToken?gapi.client.request(args).then(response=>{resolve({list:response.result.files,token:response.result.nextPageToken})}).catch(error=>{reject(error)}):resolve({message:"no token provided",token:void 0})})})(pageToken).then(reply=>{accumulatedPages=accumulatedPages.concat(reply.list),reply.token?pageLoop(reply.token,loopResolve,lgapioopReject):loopResolve({message:"file list complete",count:accumulatedPages.length})}).catch(error=>{console.log("error fetching pages, stopping loop",error),loopReject({message:"error fetching page"})})}let args={path:"https://www.googleapis.com/drive/v3/files",method:"GET",params:{corpora:"user",pageSize:1e3}};return new Promise((outerResolve,outerReject)=>{gapi.client.request(args).then(response=>{accumulatedPages=accumulatedPages.concat(response.result.files);let token=response.result.nextPageToken;new Promise((innerResolve,innerReject)=>{pageLoop(token,innerResolve,innerReject)}).then(()=>{outerResolve({list:accumulatedPages})}).catch(()=>{outerReject({message:"error fetching pages"})})})})}}),internal.drivemodule.isReady()},downloadFile:downloadFileInterface,uploadFile:uploadFileInterface,pickReadFile:function(filter){return pickFile(filter,downloadFileInterface)},pickWriteFile:function(filter){return pickFile(filter,uploadFileInterface)}}},"./js/cloud/bisweb_simpledropbox.js":function(module,exports,__webpack_require__){"use strict";const keys=__webpack_require__("../internal/js/bis_keystore.js");let initialized=!1,init=function(){return initialized?Promise.resolve():new Promise((resolve,reject)=>{let apiTag=document.createElement("script");apiTag.src="https://www.dropbox.com/static/api/2/dropins.js",apiTag.setAttribute("id","dropboxjs"),apiTag.setAttribute("data-app-key",keys.DropboxAppKey),document.head.appendChild(apiTag),apiTag.onload=(()=>{console.log("loaded dropbox dropins"),initialized=!0,resolve()}),apiTag.onerror=(()=>{reject("Failed to load dropbox")})})};module.exports={pickReadFile:function(fileopts,callback){(fileopts=fileopts||{}).save=!1,fileopts.title=fileopts.title||"Specify filename",fileopts.defaultpath=fileopts.defaultpath||"";let s=[],s2=(fileopts.suffix||"").split(",");for(let i=0;i<s2.length;i++)0!==s2[i].indexOf(".")?s.push("."+s2[i]):s.push(s2[i]);init().then(()=>{var doptions={success:function(files){callback(files[0].link)},cancel:function(){},linkType:"direct",multiselect:!1,extensions:s};Dropbox.choose(doptions)})},pickWriteFile:function(url,filename,callback){console.log("url=",url,filename);let options={files:[{url:url,filename:filename}],success:function(){callback("Success! Files saved to your Dropbox.")},progress:function(progress){console.log(progress)},cancel:function(){},error:function(errorMessage){console.log(errorMessage)}};init().then(()=>{Dropbox.save(options)})}}},"./js/cloud/bisweb_simpleonedrive.js":function(module,exports,__webpack_require__){"use strict";const keys=__webpack_require__("../internal/js/bis_keystore.js");let initialized=!1,init=function(){return initialized?Promise.resolve():new Promise((resolve,reject)=>{let apiTag=document.createElement("script");apiTag.src="https://js.live.net/v7.2/OneDrive.js",document.head.appendChild(apiTag),apiTag.onload=(()=>{console.log("loaded onedrive js"),initialized=!0,resolve()}),apiTag.onerror=(()=>{reject("Failed to load dropbox")})})};module.exports={pickReadFile:function(fileopts,callback){(fileopts=fileopts||{}).save=!1,fileopts.title=fileopts.title||"Specify filename",fileopts.defaultpath=fileopts.defaultpath||"";let s=[],s2=(fileopts.suffix||"").split(",");for(let i=0;i<s2.length;i++)0!==s2[i].indexOf(".")?s.push("."+s2[i]):s.push(s2[i]);init().then(()=>{var odOptions={clientId:keys.OneDriveKey,action:"download",multiSelect:!1,success:function(fobj){let obj=fobj.value[0],fname=obj["@microsoft.graph.downloadUrl"]+"?=realname="+obj.name;callback(fname)},cancel:function(){},error:function(e){console.log(e)},linkType:"direct",multiselect:!1,filter:s};OneDrive.open(odOptions)})},pickWriteFile:function(url,filename,callback){init().then(()=>{console.log("url=",url,"a.nii.gz");let options={clientId:keys.OneDriveKey,action:"save",file:url,fileName:"a.nii.gz",openInNewWindow:!1,advanced:{},success:function(files){callback("done",files)},progress:function(p){console.log(p)},cancel:function(){},error:function(e){console.log("error",e)}};OneDrive.save(options)})}}},"./js/core/bis_asyncutils.js":function(module,exports,__webpack_require__){"use strict";const util=__webpack_require__("./js/core/bis_util.js"),serverEventList={},binaryDataList={};let serverEventId=1,verbose=!1;var printEvent=function(id){return serverEventList[id]?JSON.stringify({id:id,name:serverEventList[id].name,checksum:serverEventList[id].checksum}):`[No event ${id} ]`},removeServerEvent=function(id){serverEventList&&(serverEventList[id].timeout&&(clearTimeout(serverEventList[id].timeout),verbose&&console.log("Removing timeout event",serverEventList[id].id," done")),delete serverEventList[id])},resolveServerEvent=function(id,obj={}){let s=serverEventList[id];s&&(obj.checksum?binaryDataList[obj.checksum]?(verbose&&console.log("__async__Resolving checksum server event",printEvent(id),obj.checksum),resolveServerEvent(id,binaryDataList[obj.checksum]),delete binaryDataList[obj.checksum],removeServerEvent(id)):(verbose&&console.log("__async__Registering checksum in server event",printEvent(id),obj.checksum),serverEventList[id].checksum=obj.checksum):(verbose&&console.log("__async__Resolving server event",printEvent(id)),s.resolve(obj),removeServerEvent(id)))},rejectServerEvent=function(id,e=""){let s=serverEventList[id];s&&(verbose&&console.log("__async__Rejecting server event",printEvent(id)),s.reject(e),removeServerEvent(id))};module.exports={addServerEvent:function(resolve,reject,name=""){return serverEventList[serverEventId+=1]={resolve:resolve,reject:reject,id:serverEventId,checksum:0,name:name,timeout:null},verbose&&console.log("__async__Create server event",printEvent(serverEventId)),serverEventList[serverEventId]},printEvent:printEvent,rejectServerEvent:rejectServerEvent,resolveBinaryData:function(data){let checksum=util.SHA256(data);verbose&&console.log("__async__\t Checking Binary Data",checksum),function(checksum,data){let i=0,found=!1,keys=Object.keys(serverEventList);for(;i<keys.length&&!1===found;){let id=keys[i];if(checksum===serverEventList[id].checksum)return found=!0,verbose&&console.log("__async__\t Not adding binary data as check sum is here",checksum,id),void resolveServerEvent(id,data);i+=1}binaryDataList[checksum]=data,verbose&&console.log("__async__\t Adding binaryData Event",checksum)}(checksum,data)},resolveServerEvent:resolveServerEvent,setVerbose:f=>{verbose=f||!1},addEventTimeout:function(id,timeout=1e4){if(!serverEventList[id])return 0;serverEventList[id].timeout=setTimeout(()=>{serverEventList[id].timeout=null,console.log("____ Processing timeout",id),rejectServerEvent(id,"timeout")},timeout)}}},"./js/core/bis_baseserverclient.js":function(module,exports,__webpack_require__){"use strict";module.exports=class{constructor(){this.authenticated=!1,this.hasGUI=!1,this.serverinfo=""}alertEvent(name,error=!1){error?console.log("---- File Client Error:",name):console.log("____ File Client:",name)}retryAuthenticationDialog(){}showAuthenticationDialog(){}hideAuthenticationDialog(){}showFileDialog(){}getServerType(){return null}getServerInfo(){return this.serverinfo}downloadFile(url,isbinary){return Promise.rejected("downloadFile not implemented "+url+" "+isbinary)}uploadFile(url,data,isbinary=!1){return Promise.rejected("uploadFile not implemented "+url+" "+isbinary+" "+typeof data)}getFileSize(url){return this.fileSystemOperation("getFileSize",url)}getFileStats(url){return this.fileSystemOperation("getFileStats",url)}isDirectory(url){return this.fileSystemOperation("isDirectory",url)}makeDirectory(url){return this.fileSystemOperation("makeDirectory",url)}deleteDirectory(url){return this.fileSystemOperation("deleteDirectory",url)}moveDirectory(url){return this.fileSystemOperation("moveDirectory",url)}copyFile(url){return this.fileSystemOperation("copyFile",url)}getMatchingFiles(querystring){return this.fileSystemOperation("getMatchingFiles",querystring)}}},"./js/core/bis_bidsutils.js":function(module,exports,__webpack_require__){"use strict";const genericio=__webpack_require__("./js/core/bis_genericio.js");module.exports={dicom2BIDS:async function(opts){let errorfn=msg=>(console.log("Error=",msg),msg),makeDir=async function(f){try{await genericio.makeDirectory(f)}catch(e){if("EEXIST"!==e.code)return errorfn("Error"+e),!1;console.log("Directory Exists Ignoring")}return!0},indir=opts.indir||"",outdir=opts.outdir||"";console.log("opts=",opts,indir,outdir);let match=genericio.joinFilenames(indir,"2*.nii.gz"),matchuncompressed=genericio.joinFilenames(indir,"2*.nii"),matchdti=genericio.joinFilenames(indir,"*.bv*");console.log("Match=",match,matchdti);let flist=await genericio.getMatchingFiles(match),flist2=await genericio.getMatchingFiles(matchdti),flist3=await genericio.getMatchingFiles(matchuncompressed);if(flist=(flist=flist.concat(flist2)).concat(flist3),console.log("Flist=",flist.join("\n\t")),flist.length<1)return errorfn("No data to convert in "+indir);let b=genericio.getBaseName(flist[0]).toLowerCase(),regex=/[a-z]/g,ind=b.search(regex);if(ind<1)return errorfn("Bad data to convert in "+indir);let subjname=b.substr(0,ind-1),outputdirectory=genericio.joinFilenames(outdir,subjname);try{await makeDir(outputdirectory)}catch(e){return errorfn("Failed to make directory "+e)}console.log("+++++","Created directory",outputdirectory);let funcdir=genericio.joinFilenames(outputdirectory,"functional"),anatdir=genericio.joinFilenames(outputdirectory,"anatomical"),locdir=genericio.joinFilenames(outputdirectory,"localizer"),diffdir=genericio.joinFilenames(outputdirectory,"diffusion");try{makeDir(funcdir),makeDir(anatdir),makeDir(diffdir),makeDir(locdir)}catch(e){return errorfn("failed to make directory"+e)}let maxindex=flist.length,tlist=[];for(let i=0;i<maxindex;i++){let name=flist[i],dirname=anatdir,tname=name.toLowerCase();if(tname.indexOf("bold")>0||tname.indexOf("asl")>0)dirname=funcdir;else if(tname.indexOf("localizer")>0)dirname=locdir;else if(tname.indexOf(".bval")>0||tname.indexOf(".bvec")>0)dirname=diffdir;else if(tname.indexOf(".nii.gz")>0){let f2=name.substr(0,name.length-7),f3=f2+".bval";console.log(name,",",f2,"->",f3),flist.indexOf(f3)>=0&&(dirname=diffdir)}let origname=name,index=name.lastIndexOf(".");(index=name.substr(0,index-1).lastIndexOf("a"))>0&&(name=name.substr(0,index)+"_"+name.substr(index,name.length)),(index=name.lastIndexOf("s"))>0&&(name=name.substr(0,index)+"_"+name.substr(index,name.length));let basename=genericio.getBaseName(name).toLowerCase();index=basename.search(regex),console.log(index),index>0&&(index+=name.length-basename.length,name=name.substr(0,index)+"_"+name.substr(index,name.length));let target=genericio.joinFilenames(dirname,genericio.getBaseName(name));console.log("+++++",index+", name=",origname,"--\x3e",target);try{await genericio.copyFile(origname+"&&"+target)}catch(e){return errorfn(e)}tlist.push(target)}let outfilename=genericio.joinFilenames(outputdirectory,"dicom_job.json"),outobj={bisformat:"DICOMImport",job:[]};for(let i=0;i<tlist.length;i++){let fname=tlist[i],name=genericio.getBaseName(tlist[i]),infoname="";if(name.indexOf(".nii.gz")>0){let tagname=genericio.getBaseName(genericio.getDirectoryName(fname));name=name.substr(0,name.length-7);let f2=fname.substr(0,fname.length-7)+".bvec",ind2=tlist.indexOf(f2);console.log("Looking for ",f2,ind2),ind2>=0?(infoname=tlist[ind2],tagname="DTI"):tagname="functional"===tagname?"Functional":"diffusion"===tagname?"DTI":"anatomical"===tagname?fname.indexOf("3D")>=0||fname.indexOf("3d")>0?"3DAnatomical":"Anatomical":"None",outobj.job.push({name:name,filename:fname.substr(outputdirectory.length+1,fname.length),tag:tagname,details:infoname})}}try{await genericio.write(outfilename,JSON.stringify(outobj,null,2),!1)}catch(e){return errorfn(e)}return outfilename}}},"./js/core/bis_coregenericio.js":function(module,exports,__webpack_require__){"use strict";(function(process,Buffer,__dirname){let filesaver,zlib,webWorkerScope,fs=null,nodewin={},path=null,os=null,glob=null,rimraf=null,noderequest=null,environment="",inelectron=!1;"undefined"!=typeof window&&void 0!==window.BISELECTRON&&(inelectron=!0);let pako=__webpack_require__("./node_modules/pako/index.js");if(process.browser||!1){try{filesaver=__webpack_require__("./lib/js/FileSaver.js"),console.log("++++ In Browser")}catch(e){}environment="browser"}else fs=__webpack_require__("./lib/js/fs.js"),zlib=__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/node_modules/browserify-zlib/lib/index.js"),path=__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/node_modules/path-browserify/index.js"),os=__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/node_modules/os-browserify/browser.js"),noderequest=__webpack_require__("request"),glob=__webpack_require__("./node_modules/glob/glob.js"),rimraf=__webpack_require__("./node_modules/rimraf/rimraf.js"),environment="node",nodewin.atob=__webpack_require__("./node_modules/atob/browser-atob.js"),nodewin.btoa=__webpack_require__("./node_modules/btoa/index.js");var createBuffer=function(cdata){return null===cdata?null:Buffer.from&&Buffer.from!==Uint8Array.from?Buffer.from(cdata):new Buffer(cdata)};inelectron&&(fs=window.BISELECTRON.fs,rimraf=window.BISELECTRON.rimraf,zlib=window.BISELECTRON.zlib,path=window.BISELECTRON.path,os=window.BISELECTRON.os,glob=window.BISELECTRON.glob,environment="electron",createBuffer=function(cdata){return new window.BISELECTRON.Buffer(cdata)});var iscompressed=function(fname){fname=fname||"";try{return"gz"===(fname.name?fname.name.split(".").pop():fname.split(".").pop())}catch(e){return!0}};var removeSpacesFromFilenameWin32Electron=function(s){if("electron"!==environment)return s;if("win32"!==getosmodule().platform())return s;return s.trim().replace(/%20/g," ")},readtextdatanode=function(filename,loadedcallback,errorcallback){filename=removeSpacesFromFilenameWin32Electron(filename);try{fs.readFile(filename,"utf-8",(err,d1)=>{err?errorcallback(err):loadedcallback(d1,filename)})}catch(e){errorcallback("failed to load from "+filename)}},readbinarydatanode=function(filename,loadedcallback,errorcallback){filename=removeSpacesFromFilenameWin32Electron(filename);try{fs.readFile(filename,(err,d1)=>{if(err&&(console.log(" failed to read binary data error="+err),errorcallback(" failed to read binary data error="+err)),iscompressed(filename))zlib.gunzip(d1,function(err,data){if(err)try{let dt=pako.ungzip(new Uint8Array(d1));loadedcallback(dt,filename),dt=null}catch(e){console.log(" failed to read binary data error="+err+" "+err.toString),errorcallback(" failed to read binary data error="+err.toString)}else{var dt=new Uint8Array(data);loadedcallback(dt,filename),dt=null}});else{let dt=new Uint8Array(d1);loadedcallback(dt,filename),dt=null}})}catch(e){errorcallback(e)}},readdatafromurl_node=function(url,binary,loadedcallback,errorcallback){let settings={url:url,method:"GET"};binary&&(settings.encoding=null),noderequest(settings,function(error,response,body){if(null!==error&&errorcallback(error),!binary)return void loadedcallback(body,url);let dt=new Uint8Array(body);iscompressed(url)&&(dt=pako.ungzip(dt)),loadedcallback(dt,url)})},readtextdatafromurl=function(url,loadedcallback,errorcallback,requestheader=null,realname=null){if("node"===environment)return readdatafromurl_node(url,!1,loadedcallback,errorcallback);var xhr=new XMLHttpRequest;xhr.open("GET",url,!0),xhr.responseType="text",null!==requestheader&&xhr.setRequestHeader("Authorization","Bearer "+requestheader);let actualname=realname||url;return xhr.onload=function(){return 200==this.status?loadedcallback(xhr.response,actualname):errorcallback("failed to read "+url),!1},xhr.onerror=function(){errorcallback("Failed to get url="+url)},xhr.send(),!1},readbinarydatafromurl=function(url,loadedcallback,errorcallback,requestheader=null,realname=null){if("node"===environment)return readdatafromurl_node(url,!0,loadedcallback,errorcallback);var xhr=new XMLHttpRequest;xhr.open("GET",url,!0),xhr.responseType="arraybuffer",null!==requestheader&&xhr.setRequestHeader("Authorization","Bearer "+requestheader);let actualname=realname||url,comp=iscompressed(actualname);return xhr.onload=function(){if(200==this.status){var arr=new Uint8Array(xhr.response);if(comp){var a=pako.ungzip(arr);loadedcallback(a,actualname),a=null}else loadedcallback(arr,actualname);arr=null}else errorcallback(url);return!1},xhr.onerror=function(){errorcallback("Failed to get url="+url)},xhr.send(),!1},writetextdatanode=function(filename,data,donecallback,errorcallback){donecallback=donecallback||null,errorcallback=errorcallback||console.log;try{fs.writeFile(filename,data,err=>{err&&errorcallback("Failed to save in "+filename+" "+err),null!==donecallback&&donecallback(filename)})}catch(e){errorcallback("Failed to save in "+filename)}},writebinarydatanode=function(filename,data,donecallback,errorcallback,nocompress=!1){let donecompressing=function(cdata,mode){try{let fd=fs.openSync(filename,"w"),buf=createBuffer(cdata);fs.write(fd,buf,0,buf.length,err=>{err?errorcallback("failed to save : "+err):fs.close(fd,err=>{err?errorcallback("failed to save : "+err):donecallback("saved in "+filename+" (file size="+fs.statSync(filename).size+" "+mode+")")})})}catch(e){errorcallback("failed to save : "+e)}};if(iscompressed(filename)&&!1===nocompress){let buf=createBuffer(data);zlib.gzip(buf,function(err,data){if(err)return console.log("---- Compression failed"),errorcallback(" failed to save in "+filename+" err="+err),void(buf=null);donecompressing(data,!0)}),buf=null}else donecompressing(data,!1)},writedataelectron=function(url,data,isbinary,donecallback,errorcallback){var writecommand=writetextdatanode;if(isbinary&&(writecommand=writebinarydatanode),void 0===url.filename)return writecommand(url,data,donecallback,errorcallback);window.BISELECTRON.dialog.showSaveDialog(null,{title:url.title,defaultPath:url.filename,filters:url.filters},function(filename){if(filename)return writecommand(filename+"",data,donecallback,errorcallback)})},readdataelectron=function(url,isbinary,donecallback,errorcallback){var readcommand=readtextdatanode;if(isbinary&&(readcommand=readbinarydatanode),void 0!==url.path)return readcommand(url.path,donecallback,errorcallback);if(void 0===url.filename){var path=window.BISELECTRON.path,newurl=url+"";return path.resolve(url)!==path.normalize(url)&&(newurl=path.resolve(window.BISELECTRON.bispath,url)),readcommand(newurl,donecallback,errorcallback)}window.BISELECTRON.dialog.showOpenDialog(null,{title:url.title,defaultPath:url.filename,filters:url.filters},function(filename){if(filename)return readcommand(filename+"",donecallback,errorcallback)})},getpathmodule=function(){return path},getosmodule=function(){return os};const biscoregenericio={getmode:function(){return environment},getenvironment:function(){return environment},createBuffer:createBuffer,getfsmodule:function(){return fs},getpathmodule:getpathmodule,getosmodule:getosmodule,getglobmodule:function(){return glob},getrimrafmodule:function(){return rimraf},tozbase64:function(arr,dogzip=!0){let z_arr=arr;dogzip&&(z_arr=pako.gzip(arr));let binary="",bytes=z_arr,len=bytes.byteLength;for(let i=0;i<len;i++)binary+=String.fromCharCode(bytes[i]);return"undefined"!=typeof WorkerGlobalScope?webWorkerScope.btoa(binary):"node"===environment?nodewin.btoa(binary):window.btoa(binary)},fromzbase64:function(str,dogzip=!0){let arr=null;return arr="undefined"!=typeof WorkerGlobalScope?webWorkerScope.atob(str):"node"===environment?nodewin.atob(str):window.atob(str),dogzip?pako.ungzip(arr):arr},string2binary:function(str,donifti=!1){let l=(str+=" ").length+1;if(donifti){let diff=16-(l-16*Math.floor(l/16));if(diff>0){let s2="";for(let i=0;i<diff;i++)s2+=" ";str+=s2}}let offset=0,extra=0;donifti&&(offset=8,extra=8);let arr=new Uint8Array(str.length+offset+extra+1);for(let i=0;i<str.length;i++)arr[i+offset]=str.charCodeAt(i);if(arr[str.length+offset]=0,donifti){let arr2=new Uint32Array(arr.buffer);arr2[0]=arr.length,arr2[1]=4}return arr},binary2string:function(arr,donifti){let str="",len=arr.length-1,offset=0;donifti&&(offset=8);for(let i=offset;i<len;i++)arr[i]>0&&(str+=String.fromCharCode(arr[i]));return str},dataURLToBlob:function(dataURL){var parts,contentType,raw;if(-1==dataURL.indexOf(";base64,"))return contentType=(parts=dataURL.split(","))[0].split(":")[1],raw=decodeURIComponent(parts[1]),new Blob([raw],{type:contentType});contentType=(parts=dataURL.split(";base64,"))[0].split(":")[1];for(var rawLength=(raw=window.atob(parts[1])).length,uInt8Array=new Uint8Array(rawLength),i=0;i<rawLength;++i)uInt8Array[i]=raw.charCodeAt(i);return new Blob([uInt8Array],{type:contentType})},iscompressed:iscompressed,inIOS:function(){try{if(/iP(hone|od|ad)/.test(navigator.platform))return!0}catch(e){return!1}return!1},setWebWorkerScope:function(w){webWorkerScope=w},readtextdatafromurl:readtextdatafromurl,readbinarydatafromurl:readbinarydatafromurl,readtextdata:function(url,loadedcallback,errorcallback){if(null!==(url=url||null))return 0===url.indexOf("http")?readtextdatafromurl(url,loadedcallback,errorcallback):"node"===environment?readtextdatanode(url,loadedcallback,errorcallback):"electron"===environment?readdataelectron(url,!1,loadedcallback,errorcallback):void 0!==url.name?function(file,loadedcallback,errorcallback){var reader=new FileReader,url=file.name;return reader.onerror=function(e){errorcallback("failed to read "+file.name+" e="+e)},reader.onload=function(e){loadedcallback(e.target.result,url)},reader.readAsText(file),!1}(url,loadedcallback,errorcallback):readtextdatafromurl(url,loadedcallback,errorcallback);errorcallback("no filename/url specified")},readbinarydata:function(url,loadedcallback,errorcallback){if(null!==(url=url||null))return 0===url.indexOf("http")?readbinarydatafromurl(url,loadedcallback,errorcallback):"node"===environment?readbinarydatanode(url,loadedcallback,errorcallback):"electron"===environment?readdataelectron(url,!0,loadedcallback,errorcallback):void 0!==url.name?function(file,loadedcallback,errorcallback){var reader=new FileReader,url=file.name,comp=iscompressed(url);return reader.onerror=function(e){errorcallback("failed to read "+file.name+" e="+e)},reader.onload=function(e){var dat=new Uint8Array(e.target.result);if(!comp)return loadedcallback(dat,url),void(dat=null);var a=pako.ungzip(dat);loadedcallback(a,url),a=null,dat=null},reader.readAsArrayBuffer(file),!1}(url,loadedcallback,errorcallback):readbinarydatafromurl(url,loadedcallback,errorcallback);errorcallback("no filename/url specified")},writetextdata:function(url,data,donecallback,errorcallback){if(null!==(url=url||null)){if("node"===environment)return writetextdatanode(url,data,donecallback,errorcallback);if("electron"===environment)return writedataelectron(url,data,!1,donecallback,errorcallback);var filename=url;return void 0!==url.filename&&(filename=url.filename),function(filename,data,donecallback){donecallback=donecallback||console.log;var blob=new Blob([data],{type:"application/octet-stream"});filesaver(blob,filename),donecallback("")}(filename,data,donecallback)}errorcallback("no filename/url specified")},writebinarydata:function(url,data,donecallback,errorcallback){if(null!==(url=url||null)){if("node"===environment)return writebinarydatanode(url,data,donecallback,errorcallback);if("electron"===environment)return writedataelectron(url,data,!0,donecallback,errorcallback);var filename=url;return void 0!==url.filename&&(filename=url.filename),function(filename,data,donecallback){donecallback=donecallback||console.log;var blob=null;if(iscompressed(filename)){var compressed=pako.gzip(data);blob=new Blob([compressed],{type:"application/gzip"})}else blob=new Blob([data],{type:"application/octet-stream"});filesaver(blob,filename),donecallback("")}(filename,data,donecallback)}errorcallback("no filename/url specified")},writetextdatanode:writetextdatanode,writebinarydatanode:writebinarydatanode,getimagepath:function(){let imagepath="";if("undefined"==typeof window||inelectron)if(inelectron){let scope=window.document.URL.split("?")[0],index=scope.lastIndexOf("/");scope="win32"===getosmodule().platform()?scope.substr(8,index-8)+"/images":scope.substr(7,index-7)+"/images",imagepath=getpathmodule().resolve(scope)}else if(webWorkerScope)console.log("In Web Worker ..."),console.log("Web Worker can not get path, or perform fetch");else{const path=getpathmodule();console.log("Dirname=",__dirname),imagepath=path.resolve(__dirname,"../../web/images"),fs.existsSync(imagepath)||(imagepath=path.resolve(__dirname,"../images"))}else{let scope=window.document.URL.split("?")[0],index=scope.lastIndexOf("/");scope.indexOf("external")>0?(scope=scope.substr(0,index)+"/../src/web/images",console.log("external=",scope)):scope=scope.substr(0,index)+"/images",imagepath=scope}return imagepath}};module.exports=biscoregenericio}).call(this,__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/node_modules/process/browser.js?55cf"),__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/node_modules/buffer/index.js?c412").Buffer,"/")},"./js/core/bis_fileserverclient.js":function(module,exports,__webpack_require__){"use strict";(function(Buffer){const wsUtilInitialPort=__webpack_require__("./js/core/bis_wsutil.js").initialPort,wsUtilPayloadSize=__webpack_require__("./js/core/bis_wsutil.js").maxPayloadSize,bisgenericio=__webpack_require__("./js/core/bis_genericio.js"),pako=__webpack_require__("./node_modules/pako/index.js"),bisasyncutil=__webpack_require__("./js/core/bis_asyncutils.js"),util=__webpack_require__("./js/core/bis_util.js"),BisBaseServerClient=__webpack_require__("./js/core/bis_baseserverclient.js");let uploadcount=0;module.exports=class extends BisBaseServerClient{constructor(nodesocket=null){super(),this.portNumber=wsUtilInitialPort,this.socket=null,this.dataSocket=null,this.authenticatingEvent=-1,this.hostname=null,this.password=null,this.lastCommand="",this.NodeWebSocket=nodesocket,this.terminating=!1,this.verbose=0,this.updateCallback=console.log}getServerType(){return"bisfileserver"}sendCommand(command){let js=JSON.stringify(command)+" ";this.verbose>0&&console.log("____ \t\t Sending ",js," length=",js.length),this.socket.send(js),this.lastCommand=command,"terminate"===command.command&&(this.terminating=!0);let id=command.id,timeout=command.timeout||1e4;bisasyncutil.addEventTimeout(id,timeout)}sendPassword(text){this.socket.send(text);let id=this.authenticatingEvent.id;bisasyncutil.addEventTimeout(id)}closeConnection(){this.socket&&(console.log("---- closing connection"),this.socket.close(1e3," Restarting connection "),this.hostname=null)}connectToServer(address="ws://localhost:"+wsUtilInitialPort){this.socket&&console.log("closing connection connect to server"),0!==address.indexOf("ws://")&&(address="ws://"+address);let arr=address.split(":"),prt=arr[arr.length-1];this.portNumber=parseInt(prt);try{if(this.NodeWebSocket?this.socket=new this.NodeWebSocket(address):this.socket=new WebSocket(address),!this.socket)return this.socket=null,void console.log("Bad Socket")}catch(e){console.log("Failed to connect to server"+e)}let closeEvent=this.socket.addEventListener("close",()=>{if(console.log("---- Socket closing"),!this.terminating&&(this.authenticated&&this.alertEvent("Connection to fileserver at "+this.hostname+" closed",!0),this.authenticated=!1,this.authenticatingEvent)){let id=this.authenticatingEvent.id;bisasyncutil.rejectServerEvent(id,"failure to authenticate"),this.hideAuthenticationDialog()}}),messageEvent=this.socket.addEventListener("message",event=>{this.handleServerResponse(event),this.hostname=address}),errorEvent=this.socket.addEventListener("error",()=>{this.alertEvent("Failed to connect to server: "+address+". It may not exist.",!0),this.socket.removeEventListener("close",closeEvent),this.socket.removeEventListener("message",messageEvent),this.socket.removeEventListener("error",errorEvent),this.socket=null})}handleServerResponse(event){if("string"!=typeof event.data)return void this.handleDataReceivedFromServer(event.data,!0,-1);let data=null;try{data=JSON.parse(event.data)}catch(e){data={id:-1,type:"error",payload:"bad frame received:"+event.data}}let id=data.payload.id||-1;if("text"===data.type)return void this.handleDataReceivedFromServer(data.payload.data,!1,id);let success=!0,ignore=!1;switch(this.verbose>0&&console.log("____\n____ Received message: ",data.type,id,bisasyncutil.printEvent(id)),data.type){case"checksum":case"filelist":case"serverbasedirectory":case"gettempfilename":case"servertempdirectory":break;case"error":this.alertEvent(data.payload.text,!0),success=!1;break;case"uploadmessage":case"initiatefilestream":break;case"authenticate":this.sendPassword(this.password||""),ignore=!0;break;case"badauth":id=-1,this.hasGUI?this.retryAuthenticationDialog():this.authenticatingEvent&&(id=this.authenticatingEvent.id,success=!1);break;case"goodauth":id=-1,this.alertEvent("Login to BisWeb FileServer Successful"),this.authenticated=!0,this.hideAuthenticationDialog(),this.authenticatingEvent&&(id=this.authenticatingEvent.id);break;case"filesystemoperations":break;case"filesystemoperationserror":console.log("File system operation failed"),success=!1;break;case"dicomConversionProgress":this.updateCallback(data.payload),ignore=!0;break;case"dicomConversionError":console.log("Dicom Conversion/Tidying up Failed"),success=!1;break;case"dicomConversionDone":break;case"bisModuleProgress":this.updateCallback(data.payload),ignore=!0;break;case"bisModuleFailed":console.log("bisModule Failed"),success=!1;break;case"bisModuleDone":break;case"tryagain":id=-1,console.log("\n___________\n---------------------- \t\t Failed retrying",this.lastCommand,"\n__________________"),this.lastCommand.taketwo="              ",this.sendCommand(this.lastCommand);break;case"nogood":{id=-1;let a=this.lastCommand;this.sendCommand({command:"restart"}),this.lastCommand=a;break}default:console.log("received a transmission with unknown type",data.type,"cannot interpret"),success=!1}id>=0?success?bisasyncutil.resolveServerEvent(id,data.payload):bisasyncutil.rejectServerEvent(id,data.payload):ignore||console.log("Id Error=",id)}authenticate(password="",hostname=null){return this.password=password||"",hostname=hostname||"ws://localhost:"+wsUtilInitialPort,this.authenticated?Promise.resolve():new Promise((resolve,reject)=>{this.authenticatingEvent=bisasyncutil.addServerEvent(()=>{this.authenticatingEvent=null,this.serverinfo=this.hostname,resolve()},()=>{this.authenticatingEvent=null,this.serverinfo="",reject()},"authenticate"),password.length>0||!1===this.hasGUI?this.connectToServer(hostname):this.showAuthenticationDialog()})}requestFileList(directory=null,showdialog=!0,opts=null){let requestOpts=opts||null;return new Promise((resolve,reject)=>{let cb=payload=>{showdialog&&this.showFileDialog(payload,requestOpts),resolve(payload)};this.authenticate().then(()=>{let serverEvent=bisasyncutil.addServerEvent(cb,reject,"requestFileList");this.sendCommand({command:"getfilelist",directory:directory,id:serverEvent.id})})})}getServerBaseDirectory(){return new Promise((resolve,reject)=>{let serverEvent=bisasyncutil.addServerEvent(obj=>{resolve(obj.path)},reject,"getServerBaseDir");this.sendCommand({command:"getserverbasedirectory",id:serverEvent.id})})}getServerTempDirectory(){return new Promise((resolve,reject)=>{let serverEvent=bisasyncutil.addServerEvent(obj=>{resolve(obj.path)},reject,"getServerTempDir");this.sendCommand({command:"getservertempdirectory",id:serverEvent.id})})}getServerTempFilename(suffix=".txt"){return new Promise((resolve,reject)=>{let serverEvent=bisasyncutil.addServerEvent(obj=>{resolve(obj.path)},reject,"getServerTempFilename");this.sendCommand({command:"gettempfilename",suffix:suffix,id:serverEvent.id})})}initiateDataUploadHandshakeAndGetPort(command){return new Promise((resolve,reject)=>{let serverEvent=bisasyncutil.addServerEvent(msg=>{let m=msg.name;return"datasocketready"===m?void resolve(msg.port):"serverreadonly"===m?(this.alertEvent("The server is set to read-only mode and will not save files.",!0),void reject("Failed")):"badfilename"===m?(this.alertEvent(msg.payload),void reject(msg.payload)):(console.log("heard unexpected message",m,"not opening data socket"),void reject("Failed"))},reject,"initiateTransfer");command.id=serverEvent.id,this.sendCommand(command)})}uploadFile(url,data,isbinary=!1){url.indexOf("\\")>=0&&(url=util.filenameWindowsToUnix(url));let body=null;isbinary?(body=new Uint8Array(data.buffer),bisgenericio.iscompressed(url)&&(body=new Uint8Array(pako.gzip(data.buffer)))):body=bisgenericio.string2binary(data);let checksum=util.SHA256(body),packetSize=wsUtilPayloadSize;return new Promise((resolve,reject)=>{let success=m=>{resolve(m.filename)},tryagain=(m,firsttime=!1)=>{"tryagain"!==m||packetSize<1e3?reject(m):(firsttime?console.log("+++++\n++++ \t\t First attempt",packetSize):(packetSize=Math.round(packetSize/2))<wsUtilPayloadSize&&console.log("+++++\n++++ \t\t Trying again",packetSize),this.uploadFileHelper(url,body,isbinary,checksum,success,tryagain,packetSize))};tryagain("tryagain",!0)})}uploadFileHelper(url,body,isbinary,checksum,successCB,failureCB,packetSize=4e5){let fileTransferSocket=null;uploadcount+=1;const self=this;let metadata={command:"uploadfile",totalSize:body.length,storageSize:body.length,packetSize:packetSize,filename:url,isbinary:isbinary,checksum:checksum,timeout:999999,uploadCount:uploadcount};console.log("\n\t \n\t \nBeginnning uploadFileHelper",metadata.command,"size=",metadata.totalSize," packetSize=",metadata.packetSize," count=",metadata.uploadCount),this.verbose>0&&console.log(metadata),this.initiateDataUploadHandshakeAndGetPort(metadata).then(port=>{this.verbose>0&&console.log("looking to connect to port",port,this.hostname);let server=this.hostname||null;if(server){let ind=server.lastIndexOf(":");server=server.substr(0,ind)+`:${port}`}else server=`ws://localhost:${port}`;this.verbose>0&&console.log("Connecting to data server ",server),(fileTransferSocket=this.NodeWebSocket?new this.NodeWebSocket(server):new WebSocket(server)).addEventListener("open",()=>{this.verbose&&console.log("Data Connection established"),function(data){let currentIndex=0,done=!1,sendDataSlice=()=>{if(!1===done){let begin=currentIndex,end=currentIndex+packetSize;end>data.length&&(end=data.length,done=!0);let slice=new Uint8Array(data.buffer,begin,end-begin);self.verbose>1&&console.log("\t\t Sending ",begin,end-1," Total=",data.length," slice=",slice.length);try{fileTransferSocket.send(slice)}catch(e){console.log("error",e)}self.verbose&&console.log("Waiting"),currentIndex+=end-begin}else this.verbose>1&&console.log("We are done ignoring")};fileTransferSocket.addEventListener("message",event=>{let data;try{data=JSON.parse(event.data)}catch(e){return failureCB("error -- an error occured while parsing event.data",e),null}switch(self.verbose>1&&console.log("____ In Transfer ",data.type),data.type){case"nextpacket":sendDataSlice();break;case"uploadcomplete":self.verbose>0&&console.log("+++++ Received uploadcomplete, closing"),fileTransferSocket.addEventListener("close",()=>{console.log("++++ Closing transfer socket success"),successCB(metadata)}),fileTransferSocket.close(1e3,"Transfer completed successfully ");break;case"uploadfailed":console.log("Update failed"),failureCB("tryagain");break;default:console.log("received unexpected message",event,"while listening for server responses"),failureCB("Error-"+data.payload)}}),sendDataSlice()}(body)})}).catch(e=>{failureCB("error "+e,!1)})}fileSystemOperation(name,url){return console.log("file system operation",name,url),url.indexOf("\\")>=0&&(url=util.filenameWindowsToUnix(url)),new Promise((resolve,reject)=>{let serverEvent=bisasyncutil.addServerEvent(obj=>{resolve(obj.result)},reject,"fileSystemOperation");this.sendCommand({command:"filesystemoperation",operation:name,url:url,id:serverEvent.id})})}dicomConversion(indir,upd,debug=!1){indir.indexOf("\\")>=0&&(indir=util.filenameWindowsToUnix(indir));let outstring="";return this.updateCallback=(msg=>{outstring+=msg,upd&&upd(msg)}),new Promise((resolve,reject)=>{let serverEvent=bisasyncutil.addServerEvent(obj=>{this.updateCallback=console.log,resolve({output:obj.output,log:outstring})},()=>{this.updateCallback=console.log,reject()},"dicomConversion");this.sendCommand({command:"dicomConversion",operation:"dicomConversion",indir:indir,debug:debug,id:serverEvent.id,timeout:3e5})})}dicom2BIDS(indir,outdir){return indir.indexOf("\\")>=0&&(indir=util.filenameWindowsToUnix(indir)),outdir.indexOf("\\")>=0&&(outdir=util.filenameWindowsToUnix(outdir)),new Promise((resolve,reject)=>{let serverEvent=bisasyncutil.addServerEvent(obj=>{resolve(obj.output)},reject,"dicom2BIDS");this.sendCommand({command:"dicom2BIDS",operation:"dicom2BIDS",indir:indir,outdir:outdir,id:serverEvent.id})})}sendCommandPromise(command){return new Promise((resolve,reject)=>{let serverEvent=bisasyncutil.addServerEvent(resolve,reject,"direct");command.id=serverEvent.id,this.sendCommand(command)})}runModule(modulename,params,upd=console.log,debug=!1){let outstring="";return this.updateCallback=(msg=>{outstring+=msg,upd&&upd(msg)}),new Promise((resolve,reject)=>{let serverEvent=bisasyncutil.addServerEvent(obj=>{this.updateCallback=console.log,resolve({output:obj.output,log:outstring})},()=>{this.updateCallback=console.log,reject()},"bisModule");this.sendCommand({command:"runModule",operation:"runModule",modulename:modulename,params:params,debug:debug,id:serverEvent.id,timeout:3e5})})}handleDownloadedFile(url,isbinary,raw_data,resolvefn){if(isbinary){let dat=new Uint8Array(raw_data);if(bisgenericio.iscompressed(url)){let a=pako.ungzip(dat);resolvefn({data:a,filename:url}),a=null}else resolvefn({data:dat,filename:url});dat=null}else resolvefn({data:raw_data,filename:url})}handleDataReceivedFromServer(data,isbinary=!0,id=-1){if(isbinary)if("node"!==bisgenericio.getenvironment()){let reader=new FileReader;reader.addEventListener("loadend",()=>{bisasyncutil.resolveBinaryData(reader.result)}),reader.readAsArrayBuffer(data)}else bisasyncutil.resolveBinaryData(data);else bisasyncutil.resolveServerEvent(id,data)}downloadFileSimple(url,isbinary){return new Promise((resolve,reject)=>{url.indexOf("\\")>=0&&(url=util.filenameWindowsToUnix(url));let serverEvent=bisasyncutil.addServerEvent(raw_data=>{this.handleDownloadedFile(url,isbinary,raw_data,resolve)},reject,"downloadFile");this.sendCommand({command:"readfile",filename:url,timeout:999999,id:serverEvent.id,isbinary:isbinary})})}downloadFile(url,isbinary){return isbinary?new Promise((resolve,reject)=>{url.indexOf("\\")>=0&&(url=util.filenameWindowsToUnix(url));let connectToFileStreamAndReceiveData=(in_hostname,port)=>new Promise((resolve,reject)=>{let hostname="ws://"+in_hostname+":"+port,blobArray=[],ssocket=null;(ssocket=this.NodeWebSocket?new this.NodeWebSocket(hostname):new WebSocket(hostname)).addEventListener("message",e=>{let l=e.data.size;if(void 0===l&&(l=e.data.length),0===l){if("node"!==bisgenericio.getmode()){let combinedData=new Blob(blobArray),reader=new FileReader;reader.addEventListener("loadend",()=>{resolve(reader.result)}),reader.readAsArrayBuffer(combinedData)}else{let combinedData=Buffer.concat(blobArray);resolve(combinedData)}ssocket.close()}else blobArray.push(e.data)}),ssocket.addEventListener("error",e=>{console.log("Error on filestream",e),reject(e)})}),serverEvent=bisasyncutil.addServerEvent(msg=>{msg.host?connectToFileStreamAndReceiveData(msg.host,msg.port).then(data=>{this.handleDownloadedFile(url,isbinary,data,resolve)}).catch(e=>{console.log("Error",e,e.stack),reject(e)}):this.handleDownloadedFile(url,isbinary,msg,resolve)},reject,"downloadFile");this.sendCommand({command:"readfilestream",filename:url,timeout:999999,id:serverEvent.id,isbinary:isbinary})}):this.downloadFileSimple(url,isbinary)}}}).call(this,__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/node_modules/buffer/index.js?c412").Buffer)},"./js/core/bis_genericio.js":function(module,exports,__webpack_require__){"use strict";const biscoreio=__webpack_require__("./js/core/bis_coregenericio.js"),util=__webpack_require__("./js/core/bis_util.js"),glob=biscoreio.getglobmodule(),fs=biscoreio.getfsmodule(),path=biscoreio.getpathmodule(),rimraf=biscoreio.getrimrafmodule();let fileServerClient=null;const inBrowser="browser"===biscoreio.getmode();let read=function(url,isbinary=!1){return fileServerClient&&"string"==typeof url&&0!==url.indexOf("http")?fileServerClient.downloadFile(url,isbinary):url&&void 0!==url.responseFunction?url.responseFunction(url,isbinary):new Promise(function(resolve,reject){let success=function(data,fname){resolve({data:data,filename:fname})},failure=function(e){reject(e)};isbinary?biscoreio.readbinarydata(url,success,failure):biscoreio.readtextdata(url,success,failure)})},splitFilenames=url=>url.split("&&");const bisgenericio={getmode:biscoreio.getmode,getenvironment:biscoreio.getenvironment,createBuffer:biscoreio.createBuffer,getfsmodule:biscoreio.getfsmodule,getpathmodule:biscoreio.getpathmodule,getosmodule:biscoreio.getosmodule,getglobmodule:biscoreio.getglobmodule,tozbase64:biscoreio.tozbase64,fromzbase64:biscoreio.fromzbase64,string2binary:biscoreio.string2binary,binary2string:biscoreio.binary2string,dataURLToBlob:biscoreio.dataURLToBlob,iscompressed:biscoreio.iscompressed,inIOS:biscoreio.inIOS,setWebWorkerScope:biscoreio.setWebWorkerScope,readtextdatafromurl:biscoreio.readtextdatafromurl,readbinarydatafromurl:biscoreio.readbinarydatafromurl,getimagepath:biscoreio.getimagepath,setFileServerObject:function(obj){fileServerClient=obj},getFileServerObject:function(){return fileServerClient},readJSON:function(url,bisformat){return new Promise((resolve,reject)=>{read(url).then(obj=>{let b,jsonstring=obj.data;try{b=JSON.parse(jsonstring)}catch(e){reject(url+" is not a valid JSON File --pick something with a .json extension")}b.bisformat!==bisformat&&reject("Bad JSON File "+url+" element bisformat does not equal "+bisformat),resolve({data:b,filename:url})}).catch(e=>{reject(e.trace)})})},read:read,write:function(url,data,isbinary=!1){return fileServerClient&&"string"==typeof url&&0!==url.indexOf("http")?fileServerClient.uploadFile(url,data,isbinary):url&&void 0!==url.responseFunction?url.responseFunction(url,data,isbinary):new Promise(function(resolve,reject){let success=function(msg){resolve(msg)},failure=function(e){reject(e)};isbinary?biscoreio.writebinarydata(url,data,success,failure):biscoreio.writetextdata(url,data,success,failure)})},getFixedSaveFileName:function(fobj,replacement){return void 0===fobj||null===fobj||fobj=={}?replacement:("object"==typeof fobj&&(fobj.name||fobj.filename||(fobj=replacement)),fobj)},getFixedLoadFileName:function(fobj){if("object"==typeof(fobj=fobj||"")){if(fobj.filename)return fobj.filename;if(fobj.name)return fobj.name}if(fobj.indexOf("?=realname=")>0){let a=fobj.indexOf("?=realname="),n=fobj.length;return fobj.substr(a+11,n-a)}if(0===fobj.indexOf("http")){let s=fobj.split("/");if(fobj.indexOf("dl.dropbox")>0){let f="dropbox/";for(let i=6;i<s.length;i++)f=f+"/"+s[i];return f}return s[s.length-1]}return fobj},copyFile:function(url){if(fileServerClient)try{return fileServerClient.copyFile(url)}catch(e){return Promise.reject("No copy file functionality")}if(inBrowser)return Promise.rejected("copyFile can not be  done in a  Browser");let splitNames=splitFilenames(url),src=splitNames[0],dest=splitNames[1],rd=fs.createReadStream(src),wr=fs.createWriteStream(dest);return new Promise(function(resolve,reject){rd.on("error",reject),wr.on("error",reject),wr.on("finish",resolve);try{rd.pipe(wr)}catch(e){rd.destroy(),wr.end(),reject(e)}})},getFileSize:function(url){if(fileServerClient)return fileServerClient.getFileSize(url);if(inBrowser)return Promise.rejected("getFileSize can not be  done in a  Browser");let fileSizeInBytes=-1;try{return fileSizeInBytes=fs.statSync(url).size,Promise.resolve(fileSizeInBytes)}catch(e){return Promise.reject(e)}},getFileStats:function(url){if(console.log("get file stats"),fileServerClient)return fileServerClient.getFileStats(url);if(inBrowser)return Promise.reject("getFileStats cannot be done in a Browser");let m=fs.lstatSync(url);return Promise.resolve(m)},isDirectory:function(url){if(fileServerClient)return fileServerClient.isDirectory(url);if(inBrowser)return Promise.reject("getFileSize can not be  done in a  Browser");let m=!0;return fs.lstatSync(url).isDirectory()||(m=!1),Promise.resolve(m)},getMatchingFiles:function(matchstring){if(fileServerClient)return fileServerClient.getMatchingFiles(matchstring);if(inBrowser)return Promise.reject("getMatchingFiles can not be  done in a  Browser");let m=glob.sync(matchstring);return Promise.resolve(m)},makeDirectory:function(url){if(fileServerClient)return fileServerClient.makeDirectory(url);if(inBrowser)return Promise.reject("getFileSize can not be  done in a  Browser");let m=!1;return fs.existsSync(url)||(fs.mkdirSync(url),m=!0),Promise.resolve(m)},deleteDirectory:function(url){return fileServerClient?fileServerClient.deleteDirectory(url):inBrowser?Promise.reject("getFileSize can not be  done in a  Browser"):fs.lstatSync(url).isDirectory()?new Promise((resolve,reject)=>{try{rimraf(url,function(){resolve("removed "+url)})}catch(e){reject(e)}}):Promise.reject(url+" is not a directory")},moveDirectory:function(url){if(console.log("moveDirectory",url),fileServerClient)return fileServerClient.moveDirectory(url);if(inBrowser)return Promise.reject("moveDirectory can not be  done in a  Browser");let splitNames=splitFilenames(url),src=splitNames[0],dest=splitNames[1];return fs.lstatSync(src).isFile()?new Promise((resolve,reject)=>{fs.copyFile(src,dest,err=>{if(err)return console.log("Encountered an error trying to move file",src,err),void reject(!1);fs.unlink(src,err=>{if(err)return console.log("Encountered an error trying to delete",src,err),void reject(!1);console.log("Move file operation successful"),resolve(!0)})})}):Promise.reject(src+" does not describe a file, cannot move it.")},getBaseName:function(fname,forceinternal=!1){if(!inBrowser&&!forceinternal)return path.basename(fname);let q=(fname=util.filenameWindowsToUnix(fname)).split("/");return q[q.length-1]},getDirectoryName:function(fname,forceinternal=!1){if(!inBrowser&&!forceinternal)return path.dirname(fname);let i=(fname=util.filenameWindowsToUnix(fname)).lastIndexOf("/");return i<0?fname:fname.substr(0,i)},getNormalizedFilename:function(fname,root="",forceinternal=!1){if(!inBrowser&&!forceinternal)return""===root?path.resolve(path.normalize(fname)):path.normalize(fname);let ind1=(fname=(fname=util.filenameWindowsToUnix(fname)).trim().replace(/\/\.\//g,"/")).indexOf(root+"/"),ind2=fname.indexOf("..");if(0===ind1&&ind2<0)return fname;let parts=(fname=root+fname).split("/"),j=parts.length-1;for(;j>=0;)if(parts[j].length<1)parts.splice(j,1),j=parts.length-1;else if(".."==parts[j])if(j>0){let k=j-1,done=!1;for(;k>=0&&!1===done;)".."!==parts[k]?done=!0:k-=1;if(done){let diff=j-k;parts.splice(j-2*diff+1,2*diff),j-=2*diff}}else parts.splice(j,1),j-=1;else j-=1;return"/"+parts.join("/")},joinFilenames:function(path1,path2,forceinternal=!1){return inBrowser||forceinternal?util.filenameWindowsToUnix(path1+"/"+path2):path.join(path1,path2)},getPathSeparator:function(){return inBrowser?"/":path.sep},isSaveDownload:function(){return!(!inBrowser||null!==fileServerClient)},runFileConversion:params=>{let updateFn=obj=>{console.log("update fn",obj)};return new Promise((resolve,reject)=>{fileServerClient&&"dicom"===params.fileType&&fileServerClient.dicomConversion(params.inputDirectory,updateFn).then(obj=>{console.log("Conversion done"),resolve(obj)}).catch(e=>{reject(e)})})}};module.exports=bisgenericio},"./js/core/bis_header.js":function(module,exports,__webpack_require__){"use strict";const bisgenericio=__webpack_require__("./js/core/bis_genericio.js"),typesizes={uchar:[1,Uint8Array],schar:[1,Int8Array],cchar:[1,Int8Array],ushort:[2,Uint16Array],sshort:[2,Int16Array],short:[2,Int16Array],uint:[4,Uint32Array],sint:[4,Int32Array],int:[4,Int32Array],float:[4,Float32Array],double:[8,Float64Array]},niftitypes={2:["uchar",Uint8Array,2],4:["sshort",Int16Array,4],8:["sint",Int32Array,8],16:["float",Float32Array,16],64:["double",Float64Array,64],256:["schar",Int8Array,256],512:["ushort",Uint16Array,512],768:["uint",Uint32Array,768]},name2nifticode={char:256,schar:256,uchar:2,short:4,sshort:4,ushort:512,int:8,sint:8,uint:768,float:16,double:64},niftiheaderspec=[["sizeof_hdr","uint",1],["data_type","uchar",10],["db_name","uchar",18],["extents","uint",1],["session_error","ushort",1],["regular","uchar",1],["dim_info","uchar",1],["dim","ushort",8],["intent_p1","float",1],["intent_p2","float",1],["intent_p3","float",1],["intent_code","ushort",1],["datatype","ushort",1],["bitpix","ushort",1],["slice_start","ushort",1],["pixdim","float",8],["vox_offset","float",1],["scl_slope","float",1],["scl_inter","float",1],["slice_end","ushort",1],["slice_code","uchar",1],["xyzt_units","uchar",1],["cal_max","float",1],["cal_min","float",1],["slice_duration","float",1],["toffset","float",1],["glmax","uint",1],["glmin","uint",1],["descrip","uchar",80],["aux_file","uchar",24],["qform_code","ushort",1],["sform_code","ushort",1],["quatern_b","float",1],["quatern_c","float",1],["quatern_d","float",1],["qoffset_x","float",1],["qoffset_y","float",1],["qoffset_z","float",1],["srow_x","float",4],["srow_y","float",4],["srow_z","float",4],["intent_name","uchar",16],["magic","uchar",4],["blank","uchar",4]];module.exports=class{constructor(){this.internal={typedefs:null},this.struct={},this.extensions=null}getniftitype(dt){var a=parseInt(dt);return isNaN(a)&&(a=name2nifticode[dt]),niftitypes[a]||-1}gettypesize(dt){return typesizes[dt]}initializenifti(){this.initialize(niftiheaderspec)}initialize(typedefs){this.struct={};for(var l=typedefs.length,total=0,i=0;i<l;i++){var key=typedefs[i][0],tp=typedefs[i][1],sz=typedefs[i][2];total+=sz*typesizes[tp][0],this.struct[key]=1==sz?0:null}return this.internal.typedefs=typedefs,total}parse(buffer,totallength,swap=!1){let offset=0,l=this.internal.typedefs.length;for(let i=0;i<l;i++){let key=this.internal.typedefs[i][0],tp=this.internal.typedefs[i][1],sz=this.internal.typedefs[i][2],sizeoftype=typesizes[tp][0],Arraytype=typesizes[tp][1];if(swap&&sizeoftype>1){let _tmp=new Uint8Array(buffer,offset,sz*sizeoftype);for(let i=0;i<sz;i++){let offset=i*sizeoftype;for(let j=0;j<sizeoftype/2;j++){let j1=j+offset,tmp1=_tmp[j1],j2=offset+(sizeoftype-1-j);_tmp[j1]=_tmp[j2],_tmp[j2]=tmp1}}}let _bytes=new Arraytype(buffer,offset,sz);if(offset+=sz*sizeoftype,1===sz)this.struct[key]=_bytes[0];else{let newbytes=new Array(sz);for(let j=0;j<sz;j++)newbytes[j]=_bytes[j];this.struct[key]=newbytes}}if(this.extensions=null,offset<totallength){let diff=totallength-offset;this.extensions=new Uint8Array(diff);let _inbytes=new Uint8Array(buffer,offset,diff);for(let kk=0;kk<diff;kk++)this.extensions[kk]=_inbytes[kk]}let dt=this.struct.datatype,name=niftitypes[dt][0],bitpix=8*typesizes[name][0];bitpix!==this.struct.bitpix&&(this.struct.bitpix=bitpix)}createHeaderRawData(keepextensions=!1){let totallength=352;!0===keepextensions&&null!==this.extensions?this.extensions.length>0&&(totallength+=this.extensions.length,this.struct.blank=[1,0,0,0]):this.struct.blank=[0,0,0,0],this.struct.vox_offset=totallength;let kk,outputbuffer=new ArrayBuffer(totallength),offset=0,l=this.internal.typedefs.length;for(let i=0;i<l;i++){let key=this.internal.typedefs[i][0],tp=this.internal.typedefs[i][1],sz=this.internal.typedefs[i][2],sizeoftype=typesizes[tp][0],_dataarray=new(0,typesizes[tp][1])(outputbuffer,offset,sz);if(1===sz)_dataarray[0]=this.struct[key];else for(kk=0;kk<sz;kk++)_dataarray[kk]=this.struct[key][kk];offset+=sz*sizeoftype}let bdata=new Uint8Array(outputbuffer);if(totallength!==offset){let diff=totallength-offset;for(kk=0;kk<diff;kk++)bdata[kk+offset]=this.extensions[kk]}return{length:totallength,data:bdata}}serialize(dataonly=!1){let obj={bisformat:"BisHeader",data:this.struct,defs:null};return dataonly||(obj.defs=this.internal.typedefs),JSON.stringify(obj)}deserialize(jsonstring,doerror){let b;try{b=JSON.parse(jsonstring)}catch(e){return doerror("image header does not come from a valid JSON string"),!1}return"BisHeader"!==b.bisformat?(doerror('Bad JSON File element bisformat does not equal "BisHeader"'),!1):(this.internal.typedefs=b.defs,this.struct=b.data,!0)}createNIFTIHeader(){this.struct={sizeof_hdr:348,data_type:[0,0,0,0,0,0,0,0,0,0],db_name:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],extents:0,session_error:0,regular:0,dim_info:0,dim:[3,64,64,64,1,0,0,0],intent_p1:0,intent_p2:0,intent_p3:0,intent_code:0,datatype:2,bitpix:8,slice_start:0,pixdim:[1,1,1,1,1,1,1,1],vox_offset:352,scl_slope:1,scl_inter:0,slice_end:0,slice_code:0,xyzt_units:2,cal_max:255,cal_min:0,slice_duration:1,toffset:0,glmax:208,glmin:0,descrip:[100,101,102,97,117,108,116,32,98,105,115,73,109,97,103,101,72,101,97,100,101,114,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],aux_file:[110,111,110,101,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],qform_code:0,sform_code:1,quatern_b:0,quatern_c:0,quatern_d:1,qoffset_x:0,qoffset_y:0,qoffset_z:0,srow_x:[1,0,0,0],srow_y:[0,1,0,0],srow_z:[0,0,1,0],intent_name:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],magic:[110,43,49,0],blank:[0,0,0,0]},this.internal.typedefs=niftiheaderspec}setExtensions(ext){null!==ext&&(this.extensions=ext)}getExtensions(){return this.extensions}parseExtensionsToArray(){let binstr=this.extensions;if(null===binstr)return[];let left=binstr.length,offset=0,commentlist=[];for(;left>0;){let strlen=new Uint32Array(binstr.buffer,offset,2)[0];if(strlen>0){let ostr=new Uint8Array(binstr.buffer,offset,strlen-1);offset+=strlen,left-=strlen;let newtxt=bisgenericio.binary2string(ostr,!0).trim();try{let b=JSON.parse(newtxt);"Array"===b.extensions.constructor.name?commentlist=commentlist.concat(b.extensions):commentlist.push(b.extensions||[])}catch(e){commentlist.push({Legacy:newtxt})}}}return commentlist}setExtensionsFromArray(commentlist){if(commentlist.length<1)return null;let txt=JSON.stringify({extensions:commentlist},null,2);this.extensions=bisgenericio.string2binary(txt,!0)}copyOrientationInfo(other,spacing=null){let otherstruct=other.struct,names=["quatern_b","quatern_c","quatern_d","qoffset_x","qoffset_y","qoffset_z","srow_x","srow_y","srow_z","qform_code","sform_code"];for(let i=0;i<names.length;i++){let item=names[i];if(otherstruct[item].length)for(let j=0;j<otherstruct[item].length;j++)this.struct[item][j]=otherstruct[item][j];else this.struct[item]=otherstruct[item]}if(this.struct.pixdim[0]=other.struct.pixdim[0],null!==spacing&&(this.struct.pixdim[1]=spacing[0],this.struct.pixdim[2]=spacing[1],this.struct.pixdim[3]=spacing[2],this.struct.sform_code>0)){let sx=this.struct.srow_x,sy=this.struct.srow_y,sz=this.struct.srow_z,magn=[Math.sqrt(sx[0]*sx[0]+sx[1]*sx[1]+sx[2]*sx[2]),Math.sqrt(sy[0]*sy[0]+sy[1]*sy[1]+sy[2]*sy[2]),Math.sqrt(sz[0]*sz[0]+sz[1]*sz[1]+sz[2]*sz[2])];for(let ia=0;ia<=2;ia++)sx[ia]*=spacing[0]/magn[0],sy[ia]*=spacing[1]/magn[1],sz[ia]*=spacing[2]/magn[2]}}getDescription(){let dt=this.struct.datatype,typename=this.getniftitype(dt),len=0;this.extensions&&(len=this.extensions.length||0);let s=[];if(s.push([`\tData Type = ${typename[0]}(${dt}) (Bits per pixel=${this.struct.bitpix}), Vox_Offset=${this.struct.vox_offset}, Extension Size=${len}`]),s.push(`\tScale=${this.struct.scl_slope}, Shift=${this.struct.scl_inter}`),s.push(`\tOrientation Matrix (qform_code=${this.struct.qform_code}, sform_code=${this.struct.sform_code})`),this.struct.qform_code>0){let names=["quatern_b","quatern_c","quatern_d","qoffset_x","qoffset_y","qoffset_z"],s2="\t";for(let i=0;i<names.length;i++)s2=s2+this.struct[names[i]].toFixed(2)+" ";s.push(`    Quaternion = [ ${s2} ]`)}if(this.struct.sform_code>0){let names=["srow_x","srow_y","srow_z"],s2="";for(let i=0;i<names.length;i++){s2+=" [ ";let v=this.struct[names[i]];for(let j=0;j<=3;j++)s2+=v[j].toFixed(3)+" ";s2+="] \n\t\t"}s.push(`\tMatrix= ${s2}`)}let cmt=this.parseExtensionsToArray();if(cmt.length>0){s.push("\tExtensions:\n\t-----------");let s2=[];for(let i=0;i<cmt.length;i++){let obj=cmt[i];Object.keys(obj).forEach(key=>{if("object"==typeof obj[key]){s2.push("\t  "+key+":");let obj2=obj[key];Object.keys(obj2).forEach(key2=>{s2.push("\t      "+key2+": "+JSON.stringify(obj2[key2]))})}else s2.push("\t  "+key+":\n\t      "+JSON.stringify(obj[key])+"\n")})}s.push(s2.join("\n"))}return s.join("\n")+"\n"}}},"./js/core/bis_simplemat.js":function(module,exports,__webpack_require__){"use strict";const simpleMat={GMVec4:{createFloat32:function(){return new Float32Array(4)},createFloat32FromValues:function(v0,v1,v2,v3){var vec=this.createFloat32();return this.setFromValues(vec,v0,v1,v2,v3),vec},setFromValues:function(vec,v0,v1,v2,v3){return vec[0]=v0,vec[1]=v1,vec[2]=v2,vec[3]=v3,vec}},GMMat4:{createFloat32:function(){return new Float32Array(16)},print:function(mat){for(var matline="\n",j=0;j<=3;j++){matline+="\t [ ";for(var i=0;i<=3;i++)matline+="\t"+mat[4*i+j];matline+="\t]\n"}return matline},setRowValues:function(mat,row,v0,v1,v2,v3){return mat[row]=v0,mat[row+4]=v1,mat[row+8]=v2,mat[row+12]=v3,mat},invert:function(mat,resultMat){var m00=mat[0],m10=mat[1],m20=mat[2],m30=mat[3],m01=mat[4],m11=mat[5],m21=mat[6],m31=mat[7],m02=mat[8],m12=mat[9],m22=mat[10],m32=mat[11],m03=mat[12],m13=mat[13],m23=mat[14],m33=mat[15],a0=m00*m11-m10*m01,a1=m00*m21-m20*m01,a2=m00*m31-m30*m01,a3=m10*m21-m20*m11,a4=m10*m31-m30*m11,a5=m20*m31-m30*m21,b0=m02*m13-m12*m03,b1=m02*m23-m22*m03,b2=m02*m33-m32*m03,b3=m12*m23-m22*m13,b4=m12*m33-m32*m13,b5=m22*m33-m32*m23,det=a0*b5-a1*b4+a2*b3+a3*b2-a4*b1+a5*b0;if(0===det)return!1;var idet=1/det;return resultMat[0]=(m11*b5-m21*b4+m31*b3)*idet,resultMat[1]=(-m10*b5+m20*b4-m30*b3)*idet,resultMat[2]=(m13*a5-m23*a4+m33*a3)*idet,resultMat[3]=(-m12*a5+m22*a4-m32*a3)*idet,resultMat[4]=(-m01*b5+m21*b2-m31*b1)*idet,resultMat[5]=(m00*b5-m20*b2+m30*b1)*idet,resultMat[6]=(-m03*a5+m23*a2-m33*a1)*idet,resultMat[7]=(m02*a5-m22*a2+m32*a1)*idet,resultMat[8]=(m01*b4-m11*b2+m31*b0)*idet,resultMat[9]=(-m00*b4+m10*b2-m30*b0)*idet,resultMat[10]=(m03*a4-m13*a2+m33*a0)*idet,resultMat[11]=(-m02*a4+m12*a2-m32*a0)*idet,resultMat[12]=(-m01*b3+m11*b1-m21*b0)*idet,resultMat[13]=(m00*b3-m10*b1+m20*b0)*idet,resultMat[14]=(-m03*a3+m13*a1-m23*a0)*idet,resultMat[15]=(m02*a3-m12*a1+m22*a0)*idet,!0},multVec4:function(mat,vec,resultVec){var x=vec[0],y=vec[1],z=vec[2],w=vec[3];return resultVec[0]=x*mat[0]+y*mat[4]+z*mat[8]+w*mat[12],resultVec[1]=x*mat[1]+y*mat[5]+z*mat[9]+w*mat[13],resultVec[2]=x*mat[2]+y*mat[6]+z*mat[10]+w*mat[14],resultVec[3]=x*mat[3]+y*mat[7]+z*mat[11]+w*mat[15],resultVec}}};module.exports=simpleMat},"./js/core/bis_util.js":function(module,exports,__webpack_require__){"use strict";const numeric=__webpack_require__("./node_modules/numeric/numeric-1.2.6.js"),CryptoJS=__webpack_require__("./node_modules/crypto-js/index.js");numeric.largeArray=50,numeric.precision=3;const objectmapcolormap=[[0,0,0,0],[255,0,0,255],[255,158,0,255],[255,255,0,255],[0,255,0,255],[0,107,255,255],[210,159,202,255],[44,246,255,255],[134,110,0,255],[253,144,0,255],[102,1,102,255],[255,0,255,255],[255,164,255,255],[255,135,132,255],[131,19,49,255],[33,24,198,255],[163,130,255,255],[132,0,255,255],[4,64,232,255],[115,148,0,255],[131,3,0,255],[0,97,3,255],[0,0,118,255],[235,214,169,255],[255,70,0,255],[130,157,254,255],[164,22,110,255],[38,164,121,255],[163,116,4,255],[153,51,51,255],[235,27,206,255],[153,255,51,255],[51,153,51,255],[84,179,97,255],[254,192,254,255],[95,255,153,255],[63,193,51,255],[153,255,255,255],[0,153,153,255],[153,51,255,255],[192,147,68,255],[254,140,251,255],[153,221,191,255],[84,75,96,255],[145,180,216,255],[183,51,153,255],[246,151,242,255],[148,200,112,255],[187,24,92,255],[51,0,54,255],[156,100,100,255],[133,255,220,255],[213,217,123,255],[115,79,22,255],[62,73,161,255],[251,214,200,255],[61,167,55,255],[51,102,102,255],[204,107,102,255],[204,153,102,255],[102,51,102,255],[135,77,148,255],[252,156,0,252],[252,252,0,252],[0,252,0,252],[33,127,197,252],[154,152,154,252],[44,244,252,252],[163,141,0,252],[252,252,252,252],[101,101,101,252],[252,0,252,252],[252,162,252,252],[0,135,139,252],[252,168,139,252],[33,24,196,252],[161,129,252,252],[131,0,252,252],[147,252,130,252],[114,147,0,252],[130,3,0,252],[0,96,3,252],[0,0,117,252],[233,212,167,252],[252,69,0,252],[63,28,123,252],[162,22,109,252],[38,162,120,252],[161,115,4,252],[151,50,50,252],[151,207,50,252],[151,252,50,252],[50,151,50,252],[83,177,96,252],[53,203,205,252],[94,252,151,252],[62,191,50,252],[151,252,252,252],[0,151,151,252],[151,50,252,252],[151,213,252,252],[50,185,38,252],[151,219,189,252],[83,74,95,252],[212,179,151,252],[181,50,151,252],[197,151,180,252],[164,46,50,252],[29,53,50,252],[50,0,53,252],[50,50,16,252],[132,252,218,252],[151,120,50,252],[114,78,22,252],[61,72,159,252],[88,61,170,252],[60,165,54,252],[50,101,101,252],[202,106,101,252],[202,151,101,252]],f2map=[[255,0,255],[247,0,255],[239,0,255],[230,0,255],[222,0,255],[214,0,255],[206,0,255],[197,0,255],[189,0,255],[181,0,255],[173,0,255],[165,0,255],[156,0,255],[148,0,255],[140,0,255],[132,0,255],[123,0,255],[115,0,255],[107,0,255],[99,0,255],[90,0,255],[82,0,255],[74,0,255],[66,0,255],[58,0,255],[49,0,255],[41,0,255],[33,0,255],[25,0,255],[16,0,255],[8,0,255],[0,0,255],[255,0,0],[255,32,0],[255,64,0],[255,96,0],[255,128,0],[255,159,0],[255,191,0],[255,223,0],[255,255,0],[255,255,7],[255,255,14],[255,255,21],[255,255,28],[255,255,35],[255,255,43],[255,255,50],[255,255,57],[255,255,64],[255,255,71],[255,255,78],[255,255,85],[255,255,92],[255,255,99],[255,255,106],[255,255,113],[255,255,120],[255,255,128],[255,255,135],[255,255,142],[255,255,149],[255,255,156],[255,255,163]],f4map=[[51,204,255],[68,187,255],[85,170,255],[102,153,255],[119,136,255],[136,119,255],[153,102,255],[170,85,255],[187,68,255],[175,0,0],[204,0,0],[255,0,0],[255,51,0],[255,102,0],[255,158,0],[255,204,0],[255,255,0],[255,255,68]],util={objectmapcolormap:objectmapcolormap,f2map:f2map,f4map:f4map,scaledround:function(t,scale){return t=t||0,scale=scale||1,Math.round(t*scale)/scale},range:function(t,minv,maxv){return t<minv?minv:t>maxv?maxv:t},cyclicrange:function(t,maxv){if(t>=0&&t<maxv)return t;for(;t<0;)t+=maxv;for(;t>=maxv;)t-=maxv;return t},zero:function(sx,sy){return numeric.rep([sx,sy],0)},value:function(i,t){return 0===i?(1-t)*(1-t)*(1-t)/6:1===i?(3*t*t*t-6*t*t+4)/6:2===i?(-3*t*t*t+3*t*t+3*t+1)/6:3===i?t*t*t/6:0},der:function(i,t){return 0===i?-(1-t)*(1-t)/2:1===i?(9*t*t-12*t)/6:2===i?(-9*t*t+6*t+3)/6:3===i?t*t/2:0},rgbToHex:function(r,g,b){function componentToHex(c){var hex=c.toString(16);return 1==hex.length?"0"+hex:hex}return"#"+componentToHex(r)+componentToHex(g)+componentToHex(b)},hexToRgb:function(hex){var result=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);return result?{r:parseInt(result[1],16),g:parseInt(result[2],16),b:parseInt(result[3],16)}:null},arrayToString:function(arr,decimal){0!==decimal&&(decimal=parseInt(decimal||2)),decimal<0?decimal=0:decimal>4&&(decimal=4);for(var s="[ ",i=0;i<arr.length;i++)s+=parseFloat(arr[i].toFixed(decimal)),i!==arr.length-1&&(s+=", ");return s+" ]"},mapobjectmapfactory:function(opacity){0!==opacity&&(opacity=opacity||255);return function(data,index,map){var v=Math.round(data[index]);for(v<0&&(v=0);v>118;)v-=117;for(var cindex=v,i=0;i<=2;i++)map[i]=objectmapcolormap[cindex][i];map[3]=cindex>0?opacity:0}},mapstepcolormapfactory:function(minint,maxint,opacity,mode){if(0!==opacity&&(opacity=opacity||255),opacity=util.range(opacity,0,255),mode=util.range(mode||7,1,7),maxint==minint)maxint+=1;else if(maxint<minint){var a=maxint;maxint=minint,maxint=a}var params={shift:minint,scale:255/(maxint-minint),opacity:opacity,mode:mode};return 7===params.mode?function(data,index,map){var v=data[index],c=util.range(Math.round(params.scale*(v-params.shift)),0,255);map[0]=c,map[1]=c,map[2]=c,map[3]=params.opacity,v<params.shift&&(map[3]=0)}:function(data,index,map){var v=data[index],c=util.range(Math.round(params.scale*(v-params.shift)),0,255);map[0]=1===params.mode||3===params.mode||5===params.mode?c:0,map[1]=2===params.mode?c:3===params.mode||6===params.mode?.5*c:0,map[2]=params.mode>3?c:0,map[3]=params.opacity,v<params.shift&&(map[3]=0)}},mapoverlayfactory:function(minthreshold,maxthreshold,opacity,mode,usef4,internalarray){0!==opacity&&(opacity=opacity||255),usef4=usef4||!1,(mode=mode||3)<1?mode=1:mode>3&&(mode=3);var cmap=f2map;usef4&&(cmap=f4map);var params={cmap:cmap,numcolors:cmap.length/2,minth:Math.abs(minthreshold),maxth:Math.abs(maxthreshold),opacity:opacity,internalarray:internalarray||null};if(params.minth>params.maxth){var a=params.maxth;params.maxth=params.minth,params.minth=a}params.range=params.maxth-params.minth,params.range<1e-4&&(params.range=1);return function(data,index,map){var val,donothing=!1;if((val=null!==params.internalarray?params.internalarray[index]:data[index])>-params.minth&&val<params.minth?donothing=!0:1==mode&&val<0?donothing=!0:2==mode&&val>0&&(donothing=!0),donothing)return map[0]=0,map[1]=0,map[2]=0,void(map[3]=0);map[3]=opacity;var color=(Math.abs(val)-params.minth)/params.range;color>1&&(color=1),color=val>0?Math.floor(params.numcolors+(params.numcolors-1)*color):Math.floor((params.numcolors-1)*(1-color));try{map[0]=params.cmap[color][0],map[1]=params.cmap[color][1],map[2]=params.cmap[color][2]}catch(e){map[0]=0,map[1]=0,map[2]=0,map[3]=0}}},parseMatrix:function(textstring,filename,square,numcolumns){square=square||!1,numcolumns=numcolumns||-1;var cleanstring=function(s){return s.trim().replace(/ /g,",").replace(/\t/g,",").replace(/,+/g,",")},in_lines=textstring.split("\n"),numrows=in_lines.length,i=0,out_lines=[],goodfound=!1,badfound=!1;for(i=0;i<numrows;i++)if(0!==in_lines[i].indexOf("#")){var s=cleanstring(in_lines[i]).split(",");!1===goodfound?(-1===numcolumns&&s.length>1||s.length===numcolumns)&&(goodfound=!0,out_lines.push(s),numcolumns=s.length):!1===badfound?s.length===numcolumns?out_lines.push(s):(badfound=!0,console.log("----- First non matrix line in line "+i+", numcols="+s.length)):i=numrows}else console.log("----- Skipping line "+in_lines[i]+" (starts with #)");if(0===out_lines.length)throw new Error("Cannot parse matrix from "+filename+" no rows of appropriate width present");if(square&&out_lines.length!==numcolumns)throw new Error("Cannot parse matrix from "+filename+" as it is not square "+out_lines.length+"*"+numcolumns);return out_lines},SHA256:function(array){if(array instanceof Uint8Array)return CryptoJS.SHA256(CryptoJS.lib.WordArray.create(array)).toString();let newarray=null;return newarray=!1!==(array.buffer||!1)?new Uint8Array(array.buffer):new Uint8Array(array),CryptoJS.SHA256(CryptoJS.lib.WordArray.create(newarray)).toString()},computeCC:function(input1,input2){if(input1.length<2||input1.length!==input2.length)throw new Error("Bad arrays for CC"+input1.length+","+input2.length);for(var length=input1.length,sum=[0,0],sum2=[0,0],sumprod=0,mean=[0,0],variance=[0,0],i=0;i<length;i++){var v0=input1[i];sum[0]+=v0,sum2[0]+=v0*v0;var v1=input2[i];sum[1]+=v1,sum2[1]+=v1*v1,sumprod+=v0*v1}for(var j=0;j<=1;j++)mean[j]=sum[j]/length,variance[j]=sum2[j]/length-mean[j]*mean[j],variance[j]<1e-5&&(variance[j]=1e-5);return Math.pow(sumprod/length-mean[0]*mean[1],2)/(variance[0]*variance[1])},filenameWindowsToUnix:function(fname){let a=fname.trim().replace(/\\/g,"/");return 0!==fname.indexOf("/")&&1==fname.indexOf(":")&&(a="/"+a),a},filenameUnixToWindows:function(fname){let a=fname.trim().replace(/\//g,"\\");return 0==fname.indexOf("/")&&(a=a.substr(1,a.length)),a},getTime:function(nobracket=0){const date=new Date;let hour=date.getHours();hour=(hour<10?"0":"")+hour;let min=date.getMinutes();min=(min<10?"0":"")+min;let sec=date.getSeconds();return sec=(sec<10?"0":"")+sec,0===nobracket?"["+hour+":"+min+":"+sec+"]":hour+":"+min+":"+sec}};module.exports=util},"./js/core/bis_wasmutils.js":function(module,exports,__webpack_require__){"use strict";const numeric=__webpack_require__("./node_modules/numeric/numeric-1.2.6.js"),niftitypes={2:["uchar",Uint8Array,1],4:["sshort",Int16Array,2],8:["sint",Int32Array,4],16:["float",Float32Array,4],64:["double",Float64Array,8],256:["schar",Int8Array,1],512:["ushort",Uint16Array,2],768:["uint",Uint32Array,4]},name2type={Uint8Array:2,Int16Array:4,Int32Array:8,Float32Array:16,Float64Array:64,Int8Array:256,Uint16Array:512,Uint32Array:768};var allocate_memory=function(Module,nDataBytes){return Module._allocate_js_array(nDataBytes)},release_memory=function(Module,ptr){0!==ptr&&Module._jsdel_array(ptr)},get_array_view=function(Module,arraytypename,dataPtr,sz){return new arraytypename(Module.HEAPU8.buffer,dataPtr,sz)},get_vector_magic_code=function(Module){return Module._getVectorMagicCode()},get_matrix_magic_code=function(Module){return Module._getMatrixMagicCode()},get_image_magic_code=function(Module){return Module._getImageMagicCode()},packRawStructureInPlace=function(Module,dataPtr,header_array,data_array,magic_type){let headersize=0;0!==header_array&&(headersize=header_array.byteLength);const datatype=name2type[data_array.constructor.name];let nDataBytes=data_array.byteLength+headersize+16,intheader=get_array_view(Module,Int32Array,dataPtr,4);if(intheader[0]=magic_type,intheader[1]=datatype,intheader[2]=headersize,intheader[3]=data_array.byteLength,headersize>0){let headerView=get_array_view(Module,Uint8Array,dataPtr+16,header_array.byteLength),inputView=new Uint8Array(header_array.buffer);headerView.set(inputView)}let dataView=get_array_view(Module,Uint8Array,dataPtr+headersize+16,data_array.byteLength),bisoffset=data_array.bisbyteoffset||0,inp=new Uint8Array(data_array.buffer,bisoffset,dataView.length);return dataView.set(inp),nDataBytes},packRawStructure=function(Module,header_array,data_array,magic_type){let headersize=0;0!==header_array&&(headersize=header_array.byteLength);let nDataBytes=data_array.byteLength+headersize+16,dataPtr=allocate_memory(Module,nDataBytes);return packRawStructureInPlace(Module,dataPtr,header_array,data_array,magic_type),dataPtr},packStructure=function(Module,data_array,dimensions=[],spacing=[]){let vect_magic_code=get_vector_magic_code(Module),matr_magic_code=get_matrix_magic_code(Module),image_magic_code=get_image_magic_code(Module),magic_type=vect_magic_code,headersize=0;2===dimensions.length?(magic_type=matr_magic_code,headersize=8):dimensions.length>2&&(magic_type=image_magic_code,headersize=40);let header_array=0;if(headersize>0)if(header_array=new Uint8Array(headersize),magic_type===matr_magic_code){let dim=new Int32Array(header_array.buffer,0,2);dim[0]=dimensions[0],dim[1]=dimensions[1]}else if(magic_type==image_magic_code){let dim=new Int32Array(header_array.buffer,0,5),spa=new Float32Array(header_array.buffer,20,5);for(let k=0;k<5;k++)k<dimensions.length?(dim[k]=dimensions[k],k<spacing.length?spa[k]=spacing[k]:spa[k]=1):(dim[k]=1,spa[k]=1)}return packRawStructure(Module,header_array,data_array,magic_type)},unpackStructure=function(Module,dataptr,image_mode=!1,force_data_type=-1){let vect_magic_code=get_vector_magic_code(Module),matr_magic_code=get_matrix_magic_code(Module),image_magic_code=get_image_magic_code(Module);var out_obj={magic_type:0,data_array:0,header_array:0};let in_dataptr=dataptr,intheader=get_array_view(Module,Int32Array,in_dataptr,4);const magic_type=intheader[0];if(image_mode&&magic_type!=image_magic_code)return out_obj;if(magic_type<vect_magic_code||magic_type>vect_magic_code+100)return out_obj;const datatype=intheader[1];if(force_data_type>0&&force_data_type!=datatype)return console.log("bad data type=",datatype),out_obj;out_obj.magic_type=magic_type;const headersize=intheader[2],data_size=intheader[3];if(magic_type==matr_magic_code){let dim=get_array_view(Module,Int32Array,in_dataptr+16,2);out_obj.dimensions=[dim[0],dim[1]]}else if(magic_type==image_magic_code){let dim=get_array_view(Module,Int32Array,in_dataptr+16,5),spa=get_array_view(Module,Float32Array,in_dataptr+36,5);out_obj.dimensions=[dim[0],dim[1],dim[2],dim[3],dim[4]],out_obj.spacing=[spa[0],spa[1],spa[2],spa[3],spa[4]]}else if(headersize>0){out_obj.header_array=new Uint8Array(headersize);let inheader=get_array_view(Module,Uint8Array,in_dataptr+16,headersize);for(let k=0;k<headersize;k++)out_obj.header_array[k]=inheader[k]}out_obj.datatype=datatype;var elem=niftitypes[datatype],sz=elem[2],arr_name=elem[1],numvox=Math.floor(data_size/sz);if(image_mode)out_obj.dataptr=in_dataptr+headersize+16,out_obj.numvox=numvox,out_obj.dataptr=in_dataptr;else{out_obj.data_array=new arr_name(numvox);let indata=get_array_view(Module,arr_name,in_dataptr+headersize+16,numvox);for(let k=0;k<numvox;k++)out_obj.data_array[k]=indata[k]}return out_obj},unpackStructureAndDelete=function(Module,dataptr,image_mode=!1){let ret_obj=unpackStructure(Module,dataptr,image_mode);return release_memory(Module,dataptr),ret_obj};let outputobject={allocate_memory:allocate_memory,release_memory:release_memory,release_memory_cpp:release_memory,map_array_to_string:function(arr){return String.fromCharCode.apply(null,arr)},get_array_view:get_array_view,get_vector_magic_code:get_vector_magic_code,get_matrix_magic_code:get_matrix_magic_code,get_image_magic_code:get_image_magic_code,get_grid_magic_code:function(Module){return Module._getGridTransformMagicCode()},get_combo_magic_code:function(Module){return Module._getComboTransformMagicCode()},get_collection_magic_code:function(Module){return Module._getCollectionMagicCode()},createPointer:function(Module,header_array,data_bytes_size,data_type,magic_type){let headersize=0;0!==header_array&&(headersize=header_array.byteLength);let dataPtr=allocate_memory(Module,data_bytes_size+headersize+16),intheader=get_array_view(Module,Int32Array,dataPtr,4);if(intheader[0]=magic_type,intheader[1]=data_type,intheader[2]=headersize,intheader[3]=data_bytes_size,headersize>0){let headerView=get_array_view(Module,Uint8Array,dataPtr+16,header_array.byteLength),inputView=new Uint8Array(header_array.buffer);headerView.set(inputView)}return dataPtr},packStructure:packStructure,packRawStructureInPlace:packRawStructureInPlace,packRawStructure:packRawStructure,unpackStructure:unpackStructure,unpackStructureAndDelete:unpackStructureAndDelete,serializeMatrix:function(Module,input){let sz_inp=[];try{sz_inp=numeric.dim(input)}catch(e){throw new Error("Bad Input to serializeMatrix")}if(sz_inp.length<2)throw new Error("Bad weight size for global Signal Regression. Mush be a 2D Matrix of dimenion ",sz_inp[0],"*",1);let len=sz_inp[0]*sz_inp[1],arr=new Float32Array(len),index=0;for(let row=0;row<sz_inp[0];row++)for(let col=0;col<sz_inp[1];col++)arr[index]=input[row][col],index+=1;return packStructure(Module,arr,sz_inp)},unpackMatrixAndDelete:function(Module,wasmarr){const wasmobj=unpackStructureAndDelete(Module,wasmarr);if(wasmobj.magic_type!==get_matrix_magic_code(Module))return console.log("failed to unpack Matrix"),0;var out=numeric.rep([wasmobj.dimensions[0],wasmobj.dimensions[1]],0);for(let i=0;i<wasmobj.dimensions[0];i++)for(let j=0;j<wasmobj.dimensions[1];j++)out[i][j]=wasmobj.data_array[i*wasmobj.dimensions[1]+j];return out}};module.exports=outputobject},"./js/core/bis_wrapperutils.js":function(module,exports,__webpack_require__){"use strict";(function(__dirname){const libbiswasm_raw=__webpack_require__("request"),BisWebImage=__webpack_require__("./js/dataobjects/bisweb_image.js"),BisWebMatrix=__webpack_require__("./js/dataobjects/bisweb_matrix.js"),bistransforms=__webpack_require__("./js/legacy/bis_transformationutil.js"),wasmutil=__webpack_require__("./js/core/bis_wasmutils.js"),genericio=__webpack_require__("./js/core/bis_genericio.js");var initialize_wasm_node=function(){const fs=genericio.getfsmodule(),path=genericio.getpathmodule();return new Promise((resolve,reject)=>{let dname=path.normalize(path.resolve(__dirname,"libbiswasm.wasm"));fs.existsSync(dname)||(dname=path.normalize(path.resolve(__dirname,"../lib/libbiswasm.wasm"))),fs.existsSync(dname)||(dname=path.normalize(path.resolve(__dirname,"../libbiswasm.wasm"))),fs.existsSync(dname)||(dname=path.normalize(path.resolve(__dirname,"../../build/wasm/libbiswasm.wasm"))),fs.existsSync(dname)||reject("Can not find libbiswasm.wasm in "+dname);let binary=null;try{console.log(".... Reading wasm binary from dname=",dname);let d1=fs.readFileSync(dname);binary=new Uint8Array(d1)}catch(e){reject(e)}null===binary&&reject("no wasm library specified"),libbiswasm_raw(resolve,dname,binary)})};module.exports={serializeObject:function(Module,obj,datatype){if("Number"===obj.constructor.name)return obj;if("Matrix"!==datatype&&"Vector"!==datatype)return obj.serializeWasm(Module);if("BisWebMatrix"===obj.constructor.name)return obj.serializeWasm(Module);if("Vector"===datatype&&"Array"===obj.constructor.name){let v=new Float32Array(obj.length);for(let i=0;i<obj.length;i++)v[i]=obj[i];return wasmutil.packStructure(Module,v,[v.length])}return wasmutil.packStructure(Module,obj,[obj.length])},deserializeAndDeleteObject:function(Module,ptr,datatype,first_input=0){if(0===ptr)throw new Error("<p>Bad output from calling WebAssembly function. Perhaps this function is not available.</p><HR>");if(first_input=first_input||0,"Matrix"===datatype||"Vector"===datatype){let output=new BisWebMatrix;return output.deserializeWasmAndDelete(Module,ptr),output}if("bisImage"===datatype||"image"===datatype||"Image"===datatype){let output=new BisWebImage;return 0!==first_input&&"Number"!==first_input.constructor.name?output.deserializeWasmAndDelete(Module,ptr,first_input):output.deserializeWasmAndDelete(Module,ptr),output}if("bisComboTransformation"===datatype){const output=bistransforms.createComboTransformation();return output.deserializeWasmAndDelete(Module,ptr),output}if("bisGridTransformation"===datatype){const output=bistransforms.createGridTransformation();return output.deserializeWasmAndDelete(Module,ptr),output}if("bisLinearTransformation"===datatype){const output=bistransforms.createLinearTransformation(2);return output.deserializeWasmAndDelete(Module,ptr),output}if("String"==datatype){const wasmobj=wasmutil.unpackStructure(Module,ptr);return wasmutil.release_memory(Module,ptr),wasmutil.map_array_to_string(wasmobj.data_array)}return 0},initialize_wasm:function(obj=null){return"node"===genericio.getmode()?initialize_wasm_node():new Promise((resolve,reject)=>{if(null!==obj){obj.binary||reject("No binary in obj");let done=function(m){m.bisdate=obj.date,resolve(m)};return void obj.initialize(done,obj.filename,obj.binary)}let done=function(m){m.bisdate=window.biswebpack.date,resolve(m)},clb=function(){let dname=window.biswebpack.filename,binary=genericio.fromzbase64(window.biswebpack.binary);window.biswebpack.initialize(done,dname,binary)};if("complete"==document.readyState)clb();else if(window.attachEvent)window.attachEvent("onload",clb);else if(window.onload){let currentOnLoad=window.onload,newOnload=event=>{currentOnLoad(event),clb()};window.onload=newOnload}else window.onload=clb})}}}).call(this,"/")},"./js/core/bis_wsutil.js":function(module,exports){module.exports={initialPort:24e3,finalPort:24999,maxPayloadSize:33554432}},"./js/core/bisweb_userpreferences.js":function(module,exports,__webpack_require__){"use strict";const genericio=__webpack_require__("./js/core/bis_genericio.js");let dbasepointer=null,count=1;const userPreferences={orientationOnLoad:"None",snapshotscale:2,snapshotdowhite:!0,filesource:"local",showwelcome:!0,favoriteFolders:[],internal:!1,enables3:!1},expobj={resolve:null,reject:null,initialized:!1};expobj.loadedPromise=new Promise((resolve,reject)=>{expobj.resolve=resolve,expobj.reject=reject});let getDefaultFileName=function(){if("browser"===genericio.getmode())return null;const os=genericio.getosmodule(),path=genericio.getpathmodule();let homedir=os.homedir();return path.join(homedir,".bisweb")},parseUserPreferences=function(obj){return Object.keys(obj).forEach(key=>{void 0!==obj[key]&&null!==obj[key]&&(userPreferences[key]=obj[key])}),userPreferences.orientationOnLoad?expobj.setImageOrientationOnLoad(userPreferences.orientationOnLoad,"None"):userPreferences.orientationOnLoad="None",!1!==userPreferences.showwelcome&&(userPreferences.showwelcome=!0),"browser"===genericio.getmode()&&console.log("---- Loaded userPreferences:",JSON.stringify(userPreferences)),!0};expobj.sanitizeOrientationOnLoad=function(name){return"Auto"===name?userPreferences.orientationOnLoad:["RAS","LPS","LAS","None"].indexOf(name)>=0?name:void 0===name||null===name?userPreferences.orientationOnLoad:!0===name?"RAS":"None"},expobj.setImageOrientationOnLoad=function(name="",comment=""){userPreferences.orientationOnLoad=expobj.sanitizeOrientationOnLoad(name),count+=1,null!==comment&&1===count&&console.log("+++++ Setting forcing orientationOnLoad to: "+userPreferences.orientationOnLoad+" (from "+name+"), "+comment)},expobj.getImageOrientationOnLoad=function(){return userPreferences.orientationOnLoad},expobj.safeGetImageOrientationOnLoad=function(){return new Promise((resolve,reject)=>{expobj.loadedPromise.then(()=>{let or=expobj.getImageOrientationOnLoad();resolve(or)}).catch(e=>{reject(e)})})},expobj.saveUserPreferences=function(fname=null){null===fname&&(fname=getDefaultFileName()),userPreferences.bisformat="BisWebUserPreferences";let opt=JSON.stringify(userPreferences,null,2);delete userPreferences.bisformat;const fs=genericio.getfsmodule();try{console.log("Saving user preferences in ",fname),fs.writeFileSync(fname,opt)}catch(e){return void console.log("Error=",e)}return!0},expobj.printUserPreferences=function(){console.log(JSON.stringify(userPreferences,null,2))},expobj.storeUserPreferences=function(dbase){return"browser"!==genericio.getenvironment()?expobj.saveUserPreferences()?Promise.resolve():Promise.reject():(dbase=dbase||dbasepointer,new Promise((resolve,reject)=>{try{dbase.setItems(userPreferences).then(()=>{resolve()}).catch(e=>{reject(e)})}catch(e){reject(e)}}))},expobj.getItem=function(item){let a=userPreferences[item];return void 0===a?null:a},expobj.safeGetItem=function(item){return new Promise(resolve=>{expobj.loadedPromise.then(()=>{resolve(expobj.getItem(item))}).catch(e=>{console.log("Failed to load",e,e.stack),console.log("Resolving with standard ",userPreferences[item]),resolve(userPreferences[item])})})},expobj.setItem=function(key,value,save=!1){"orientationOnLoad"===key?this.setImageOrientationOnLoad(value):userPreferences[key]=value,save&&("browser"===genericio.getmode()?expobj.storeUserPreferences().then(()=>{console.log("--- User prefs saved")}).catch(()=>{}):expobj.saveUserPreferences())};let initializeCommandLine=function(silent=!1){if(expobj.initialized)return;silent||console.log(",,,,");let fname=function(fname=null){if("browser"===genericio.getmode())return null;null===fname&&(fname=getDefaultFileName());const fs=genericio.getfsmodule();let d1="";try{d1=fs.readFileSync(fname,"utf-8")}catch(e){return null}let p=null;try{p=JSON.parse(d1)}catch(e){return null}return"BisWebUserPreferences"!==p.bisformat?(console.log("---- Bad JSON Magic Code (bisformat) in ",fname),null):(delete p.bisformat,parseUserPreferences(p)?fname:null)}();null!==fname?silent||(console.log(",,,, BioImage Suite Web user preferences loaded from "+fname),console.log(",,,, ",JSON.stringify(userPreferences)),console.log(",,,,")):(console.log(",,,, Failed to read user preferences from default location"),expobj.setImageOrientationOnLoad(userPreferences.orientationOnLoad,null),fname=getDefaultFileName(),expobj.saveUserPreferences(fname)&&(silent||(console.log(",,,, \t created and saved user preferences in ",fname),console.log(",,,,")))),expobj.resolve()};expobj.initialize=function(dbase){return expobj.initialized?(console.log("+++++ \t user preferences already initialized (or in process of being initialized)"),expobj.loadedPromise):("browser"===genericio.getmode()?function(dbase=null){dbase=dbase||dbasepointer;let keys=Object.keys(userPreferences);return new Promise((resolve,reject)=>{try{dbase.getItems(keys).then(obj=>{parseUserPreferences(obj)&&(dbasepointer=dbase,resolve())}).catch(e=>{console.log("Error=",e),reject(e)})}catch(e){console.log("Error=",e),reject(e)}})}(dbase).then(()=>{expobj.storeUserPreferences(dbase).catch(e=>{console.log("Error =",e)}),expobj.resolve()}).catch(()=>{expobj.reject("Bad Pref Database")}):(initializeCommandLine(),expobj.resolve()),expobj.loadedPromise)},module.exports=expobj},"./js/coreweb/bis_3dcrosshairgeometry.js":function(module,exports,__webpack_require__){"use strict";const THREE=__webpack_require__("three");var bis3dcreatecrosshairgeometry={createcrosshair:function(length,thickness,showsphere,radius){showsphere=showsphere||!1,radius=radius||.5*length;var h1=new THREE.BoxGeometry(length,thickness,thickness),h2=new THREE.BoxGeometry(thickness,length,thickness),h3=new THREE.BoxGeometry(thickness,thickness,length);if(h1.merge(h2),h1.merge(h3),showsphere){var sph=new THREE.SphereGeometry(radius,16,16);h1.merge(sph)}return h1},createcore:function(length,thickness,showsphere,radius){showsphere=showsphere||!1,radius=radius||.5*length;var arr=[new THREE.BoxGeometry(length,thickness,thickness),new THREE.BoxGeometry(thickness,length,thickness),new THREE.BoxGeometry(thickness,thickness,length)];if(showsphere){var sph=new THREE.SphereGeometry(radius,16,16);arr.push(sph)}return this.createpregeometry(arr)},createpregeometry:function(bufarray){var j,numelements=bufarray.length,numpoints=0,numfaces=0,i=0;for(i=0;i<numelements;i++){var ind=bufarray[i].faces;numpoints+=bufarray[i].vertices.length,numfaces+=ind.length}var vertices=new Float32Array(3*numpoints),indices=new Uint16Array(3*numfaces),index=0;for(i=0;i<numelements;i++){var points=bufarray[i].vertices;for(j=0;j<points.length;j++)vertices[index]=points[j].x,vertices[index+1]=points[j].y,vertices[index+2]=points[j].z,index+=3}var offset=0,findex=0;for(i=0;i<numelements;i++){var faces=bufarray[i].faces;for(j=0;j<faces.length;j++)indices[findex]=faces[j].a+offset,indices[findex+1]=faces[j].b+offset,indices[findex+2]=faces[j].c+offset,findex+=3;offset+=bufarray[i].vertices.length}return{vertices:vertices,indices:indices}},createcopies:function(core,positions,scales){scales=scales||null;var j,i,numelements=positions.length,combovertices=new Float32Array(core.vertices.length*numelements),comboindices=new Uint16Array(core.indices.length*numelements),points=core.vertices,faces=core.indices,numpoints=points.length/3,index=0;for(i=0;i<numelements;i++){var p=positions[i],sc=1;for(null!==scales&&(sc=scales[i]),j=0;j<numpoints;j++)combovertices[index]=points[3*j]*sc+p[0],combovertices[index+1]=points[3*j+1]*sc+p[1],combovertices[index+2]=points[3*j+2]*sc+p[2],index+=3}var offset=0,findex=0;for(i=0;i<numelements;i++){for(j=0;j<faces.length;j++)comboindices[findex]=faces[j]+offset,++findex;offset+=numpoints}var buf=new THREE.BufferGeometry;return buf.setIndex(new THREE.BufferAttribute(comboindices,1)),buf.addAttribute("position",new THREE.BufferAttribute(combovertices,3)),buf}};module.exports=bis3dcreatecrosshairgeometry},"./js/coreweb/bis_3dimageslicegeometry.js":function(module,exports,__webpack_require__){"use strict";const THREE=__webpack_require__("three"),bis3dimageslicegeometry=function(p0,p1,p2,wireframe,flip){flip=flip||[!1,!1],wireframe=wireframe||!1,THREE.BufferGeometry.call(this),this.type="PlaneBufferGeometry",this.parameters={p0:p0,p1:p1,p2:p2};var numpass=1;wireframe||(numpass=2);for(var nv=12*numpass,nt=8*numpass,vertices=new Float32Array(nv),normals=new Float32Array(nv),uvs=new Float32Array(nt),offset=0,offset2=0,d1=[0,0,0],d2=[0,0,0],p3=[0,0,0],i=0;i<=2;i++)d1[i]=p1[i]-p0[i],d2[i]=p2[i]-p0[i],p3[i]=p2[i]-d1[i];var n=[d2[2]*d1[1]-d2[1]*d1[2],d2[0]*d1[2]-d2[2]*d1[0],d2[1]*d1[0]-d2[0]*d1[1]],magn=Math.sqrt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);for(i=0;i<=2;i++)n[i]=n[i]/magn;var indices,pt=[p0,p1,p2,p3],textcoord=[[0,1],[0,0],[1,0],[1,1]];!0===flip[1]?textcoord=[[0,0],[0,1],[1,1],[1,0]]:!0===flip[0]&&(textcoord=[[1,1],[1,0],[0,0],[0,1]]);for(var pass=0;pass<numpass;pass++){for(var tcount=0,iy=0;iy<=1;iy++)for(var ix=0;ix<=1;ix++)vertices[offset]=pt[ix+2*iy][0],vertices[offset+1]=pt[ix+2*iy][1],vertices[offset+2]=pt[ix+2*iy][2],normals[offset]=n[0],normals[offset+1]=n[1],normals[offset+2]=n[2],uvs[offset2]=textcoord[tcount][0],uvs[offset2+1]=1-textcoord[tcount][1],offset+=3,offset2+=2,tcount++;n[0]=-n[0],n[1]=-n[1],n[2]=-n[2]}wireframe?((indices=new Uint16Array(12))[0]=0,indices[1]=1,indices[2]=0,indices[3]=0,indices[4]=3,indices[5]=0,indices[6]=3,indices[7]=2,indices[8]=3,indices[9]=2,indices[10]=1,indices[11]=2):((indices=new Uint16Array(12))[0]=0,indices[1]=1,indices[2]=2,indices[3]=2,indices[4]=3,indices[5]=0,indices[6]=4,indices[7]=6,indices[8]=5,indices[9]=6,indices[10]=4,indices[11]=7),this.setIndex(new THREE.BufferAttribute(indices,1)),this.addAttribute("position",new THREE.BufferAttribute(vertices,3)),this.addAttribute("normal",new THREE.BufferAttribute(normals,3)),this.addAttribute("uv",new THREE.BufferAttribute(uvs,2))};(bis3dimageslicegeometry.prototype=Object.create(THREE.BufferGeometry.prototype)).constructor=bis3dimageslicegeometry,module.exports=bis3dimageslicegeometry},"./js/coreweb/bis_3dorthogonalslice.js":function(module,exports,__webpack_require__){"use strict";const THREE=__webpack_require__("three"),util=__webpack_require__("./js/core/bis_util.js"),BisImageSlicer=__webpack_require__("./js/legacy/bis_imageslicer.js"),BIS3dImageSliceGeometry=__webpack_require__("./js/coreweb/bis_3dimageslicegeometry.js"),AXIS_COLORS=[[[0,.99,0],[0,0,.99]],[[.99,0,0],[0,0,.99]],[[.99,0,0],[0,.99,0]]],bis3dOrthogonalSlice={create2dslice:function(volume,in_plane,decorationmode,objectmap,transparent){var internal={decorationmode:decorationmode||0,isobjectmap:objectmap||!1,istransparent:transparent||!1,plane:util.range(in_plane||0,0,2),imageplane:null,outline:null,axis1:null,axis2:null,canvas:null,texture:null,lastinterpolate:null,imageslicer:null,slicecoord:0,frame:0,imagespa:null,imagedim:null,imagesize:[1,1,1],imagerange:null},vert_text="void main() {\n     vec3 transformed = vec3( position );\n     vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\n     gl_Position = projectionMatrix * mvPosition;\n     gl_Position.z=-0.85+0.001*gl_Position.z;\n}\n",shader_text="uniform float opacity;\nuniform vec3  diffuse;\nvoid main() {\n   gl_FragColor = vec4( diffuse.x,diffuse.y,diffuse.z, opacity );\n}",output={initialize:function(){!0===internal.decorations&&(internal.decorations=1),internal.istransparent=!0,internal.imagedim=volume.getDimensions(),internal.imagerange=volume.getIntensityRange(),internal.imagespa=volume.getSpacing(),internal.imagesize=volume.getImageSize(),internal.canvas=document.createElement("canvas"),internal.imageslicer=new BisImageSlicer(volume,{plane:internal.plane,objectmapmode:internal.isobjectmap,padded:!1}),internal.slicecoord=Math.floor(internal.imagedim[internal.plane]/2),internal.imageslicer.setcanvas(internal.canvas),internal.imageslicer.getslice(internal.slicecoord,0,null,!0),internal.texture=new THREE.Texture(internal.canvas),internal.texture.flipY=!1,internal.texture.needsUpdate=!0,this.interpolate(!internal.isobjectmap);var points=internal.imageslicer.getplanepoints(),geometry=new BIS3dImageSliceGeometry(points[0],points[1],points[2],!1),material=new THREE.MeshLambertMaterial({map:internal.texture,transparent:internal.istransparent});internal.imageplane=new THREE.Mesh(geometry,material);var offset=internal.imageslicer.getsliceoffset();if(internal.imageplane.position.set(offset[0],offset[1],offset[2]),internal.decorationmode>0){var opoints=internal.imageslicer.getoutlineplanepoints(),geometry2=new BIS3dImageSliceGeometry(opoints[0],opoints[1],opoints[2],!0),outline_material2=new THREE.ShaderMaterial({uniforms:{diffuse:{type:"c",value:{r:1,g:.5,b:0}},opacity:{type:"f",value:1}},transparent:!1,wireframe:!0,vertexShader:vert_text,fragmentShader:shader_text});if(internal.outline=new THREE.Mesh(geometry2,outline_material2),internal.outline.position.set(offset[0],offset[1],offset[2]),internal.decorationmode>1){var pts=internal.imageslicer.getaxispoints(),cl1=AXIS_COLORS[internal.plane][0],cl2=AXIS_COLORS[internal.plane][1],axis_material=new THREE.ShaderMaterial({uniforms:{diffuse:{type:"c",value:{r:cl1[0],g:cl1[1],b:cl1[2]}},opacity:{type:"f",value:1}},transparent:!0,wireframe:!0,vertexShader:vert_text,fragmentShader:shader_text}),axis_material2=new THREE.ShaderMaterial({uniforms:{diffuse:{type:"c",value:{r:cl2[0],g:cl2[1],b:cl2[2]}},opacity:{type:"f",value:1}},transparent:!1,wireframe:!0,vertexShader:vert_text,fragmentShader:shader_text});internal.axis1=new THREE.Mesh(new BIS3dImageSliceGeometry(pts[0][0],pts[0][1],pts[0][2],!0),axis_material),internal.axis2=new THREE.Mesh(new BIS3dImageSliceGeometry(pts[1][0],pts[1][1],pts[1][2],!0),axis_material2)}}},cleanup:function(){internal.imageplane=null,internal.outline=null,internal.axis1=null,internal.axis2=null,internal.canvas=null,internal.texture=null,internal.imageslicer=null},getplane:function(){return internal.plane},getsliceno:function(){return internal.slicecoord},getframeno:function(){return internal.frame},getimagesize:function(){return internal.imagesize},setsliceno:function(sl,fr,mapfunction,force){if(fr=fr||0,force=force||!1,internal.imageslicer.doineedtoupdate(sl,fr)||!0===force){internal.imageslicer.getslice(sl,fr,mapfunction);var offset=internal.imageslicer.getsliceoffset(),f=internal.imageslicer.getsliceframecoords();internal.slicecoord=f[0],internal.frame=f[1],internal.imageplane.position.set(offset[0],offset[1],offset[2]),null!==internal.outline&&internal.outline.position.set(offset[0],offset[1],offset[2]),internal.texture.needsUpdate=!0}return internal.slicecoord},updatecameraclip:function(camera,thickness){thickness=thickness||.1*internal.imagespa[internal.plane];var offset=internal.imageslicer.getsliceoffset(),campos=camera.position,p=0;p=2===internal.plane?campos.z:1===internal.plane?campos.y:campos.x;var d=Math.abs(p-offset[internal.plane]);camera.near=d-thickness,camera.far=d+thickness},setsliceinmm:function(masterslice,slmm,fr,mapfunction,force){fr=fr||0,force=force||!1;var sl=Math.floor(slmm/internal.imagespa[internal.plane]);(internal.imageslicer.doineedtoupdate(sl,fr)||!0===force)&&internal.imageslicer.getslice(sl,fr,mapfunction);var f=internal.imageslicer.getsliceframecoords();internal.slicecoord=f[0],internal.frame=f[1];var offset=masterslice.getsliceoffset(),shift=.05;return internal.imageslicer.getcamerabelow()&&(shift=-.05),offset[internal.plane]+=shift*internal.imagespa[internal.plane],internal.imageplane.position.set(offset[0],offset[1],offset[2]),null!==internal.outline&&internal.outline.position.set(offset[0],offset[1],offset[2]),internal.texture.needsUpdate=!0,internal.slicecoord[0]},drawcrosshairs:function(coords){if(null!==internal.axis1){var x0=coords[0]*internal.imagespa[0],y0=coords[1]*internal.imagespa[1],z0=coords[2]*internal.imagespa[2];2==internal.plane?(internal.axis1.position.set(0,y0,z0),internal.axis2.position.set(x0,0,z0)):1==internal.plane?(internal.axis1.position.set(0,y0,z0),internal.axis2.position.set(x0,y0,0)):(internal.axis1.position.set(x0,0,z0),internal.axis2.position.set(x0,y0,0))}},addtoscene:function(scene){scene.add(internal.imageplane),null!==internal.outline&&scene.add(internal.outline),null!==internal.axis1&&(scene.add(internal.axis1),scene.add(internal.axis2))},removefromscene:function(scene){scene.remove(internal.imageplane),null!==internal.outline&&scene.remove(internal.outline),null!==internal.axis1&&(scene.remove(internal.axis1),scene.remove(internal.axis2))},getcamerapos:function(){return internal.imageslicer.getcamerapos()},getscenecenter:function(){return internal.imageslicer.getslicecenter()},getupvector:function(){return internal.imageslicer.getcameraup()},positioncamera:function(camera,fromback){fromback=fromback||!1;var campos=this.getcamerapos(),meanpos=this.getscenecenter(),upv=this.getupvector();if(fromback)for(var ia=0;ia<=2;ia++){var d=meanpos[ia]-campos[ia];campos[ia]+=2*d}camera.position.set(campos[0],campos[1],campos[2]),camera.up.set(upv[0],upv[1],upv[2]);var lkv=new THREE.Vector3(meanpos[0],meanpos[1],meanpos[2]);return camera.lookAt(lkv),lkv},getplanepoints:function(){return internal.imageslicer.getplanepoints()},gettexture:function(){return internal.texture},getcanvas:function(){return internal.canvas},getsliceoffset:function(){return internal.imageslicer.getsliceoffset()},setnexttimeforce:function(){internal.imageslicer.setnexttimeforce()},showdecorations:function(show){show=show||!1,internal.imageslicer.getoutofrange()&&(show=!1),null!==internal.outline&&(internal.outline.visible=show),null!==internal.axis1&&(internal.axis1.visible=show,internal.axis2.visible=show)},interpolate:function(dointerpolate){null!==internal.texture&&(dointerpolate=dointerpolate||!1)!==internal.lastinterpolate&&(internal.lastinterpolate=dointerpolate,dointerpolate?(internal.texture.minFilter=THREE.LinearFilter,internal.texture.magFilter=THREE.LinearFilter):(internal.texture.minFilter=THREE.NearestFilter,internal.texture.magFilter=THREE.NearestFilter))}};return output.initialize(),output},create3cardslice:function(vol,in_slices,decorations,transparent,imageplane){!1!==imageplane&&(imageplane=!0);let dim=vol.getDimensions(),spa=vol.getSpacing(),internal={slices:in_slices,imageplane:[null,null,null],outlineplane:[null,null,null],box:[null,null,null,null,null,null],hasdecorations:decorations||!1,hasimageplane:imageplane,istransparent:transparent||!1,sizex:(dim[0]-1)*spa[0]},output={initialize:function(){let offset,wire=[null,null,null],flipx=[[!1,!1],[!1,!1],[!1,!1]];for(let i=0;i<=2;i++){let points=internal.slices[i].getplanepoints().slice(0);internal.hasimageplane?(internal.imageplane[i]=new THREE.Mesh(new BIS3dImageSliceGeometry(points[0],points[1],points[2],!1,flipx[i]),new THREE.MeshLambertMaterial({map:internal.slices[i].gettexture(),transparent:internal.istransparent})),internal.hasdecorations&&(wire[i]=new BIS3dImageSliceGeometry(points[0],points[1],points[2],!0,flipx[i]),internal.outlineplane[i]=new THREE.Mesh(wire[i],new THREE.MeshBasicMaterial({color:11167266,wireframe:!0})),offset=internal.slices[i].getsliceoffset(),null!==internal.imageplane[i]&&internal.imageplane[i].position.set(offset[0],offset[1],offset[2]),internal.outlineplane[i].position.set(offset[0],offset[1],offset[2]))):(internal.imageplane[i]=null,internal.hasdecorations=!1)}if(internal.hasdecorations){let sz=internal.slices[0].getimagesize(),boxmat=[new THREE.MeshBasicMaterial({color:4473924,wireframe:!0}),new THREE.MeshBasicMaterial({color:16746496,wireframe:!0})];for(let pl=0;pl<=2;pl++){offset=internal.slices[pl].getsliceoffset();for(let fr=0;fr<=1;fr++){offset[pl]=sz[pl]*fr;let index=2*pl+fr;internal.box[index]=new THREE.Mesh(wire[pl],boxmat[fr]),internal.box[index].position.set(offset[0],offset[1],offset[2])}}}},cleanup:function(){for(let i=0;i<=2;i++)internal.imageplane[i]=null,internal.outlineplane[i]=null,internal.box[2*i]=null,internal.box[2*i+1]=null},addtoscene:function(scene){for(let i=0;i<=2;i++)null!==internal.imageplane[i]&&scene.add(internal.imageplane[i]),internal.hasdecorations&&(scene.add(internal.outlineplane[i]),scene.add(internal.box[2*i]),scene.add(internal.box[2*i+1]))},removefromscene:function(scene){for(let i=0;i<=2;i++)null!==internal.imageplane[i]&&scene.remove(internal.imageplane[i]),internal.hasdecorations&&(scene.remove(internal.outlineplane[i]),scene.remove(internal.box[2*i]),scene.remove(internal.box[2*i+1]))},updatecoordinates:function(pl){let offset=internal.slices[pl].getsliceoffset().slice(0);null!==internal.imageplane[pl]&&internal.imageplane[pl].position.set(offset[0],offset[1],offset[2]),internal.hasdecorations&&internal.outlineplane[pl].position.set(offset[0],offset[1],offset[2])},updatecoordinatesinmm:function(masterslice,pl){let offset=masterslice.getsliceoffset().slice(0);null!==internal.imageplane[pl]&&internal.imageplane[pl].position.set(offset[0],offset[1],offset[2]),internal.hasdecorations&&internal.outlineplane[pl].position.set(offset[0],offset[1],offset[2])},positioncamera:function(camera,i,fromback){return!1!==fromback&&(fromback=!0),0!==i&&(i=i||1),internal.slices[i].positioncamera(camera,fromback)},setnexttimeforce:function(){},interpolate:function(dointerpolate=!1){}};return output.initialize(),output}};module.exports=bis3dOrthogonalSlice},"./js/coreweb/bis_3dorthographiccameracontrols.js":function(module,exports,__webpack_require__){"use strict";const THREE=__webpack_require__("three"),$=__webpack_require__("jquery"),inobounce=__webpack_require__("./lib/js/inobounce.js"),THREEJSREVISION=parseInt(THREE.REVISION);var bisOrthographicCameraControls=function(camera,plane,target,domElement){var _this=this,STATE={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM_PAN:4};this.camera=camera,this.plane=plane,this.domElement=void 0!==domElement?domElement:document,this.enabled=!0,this.normViewport={x0:0,y0:0,x1:1,y1:1},this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.noRoll=!1,this.plane>=0&&this.plane<=2&&(_this.noRotate=!0,_this.noRoll=!0),this.keys=[65,83,68,72],this.coordinateChangeCallback=null,this.target=target.clone();var lastPosition=new THREE.Vector3;this.lastNormalizedCoordinates=[0,0],this.lastCoordinates=[0,0,0];var _state=STATE.NONE,_prevState=STATE.NONE,_eye=new THREE.Vector3,_rotateStart=new THREE.Vector3,_rotateEnd=new THREE.Vector3,_zoomStart=new THREE.Vector2,_zoomEnd=new THREE.Vector2,_zoomFactor=1,_touchZoomDistanceStart=0,_touchZoomDistanceEnd=0,_panStart=new THREE.Vector2,_panEnd=new THREE.Vector2;this.target0=this.target.clone(),this.position0=this.camera.position.clone(),this.up0=this.camera.up.clone(),this.left0=this.camera.left,this.right0=this.camera.right,this.top0=this.camera.top,this.bottom0=this.camera.bottom,this.center0=new THREE.Vector2((this.left0+this.right0)/2,(this.top0+this.bottom0)/2);var changeEvent={type:"change"},startEvent={type:"start"},endEvent={type:"end"};this.getZoomFactor=function(){return _zoomFactor},this.serializeCamera=function(){let p={};p.position=this.camera.position.clone(),p.up=this.camera.up.clone(),p.target=this.target.clone(),p.zoomFactor=this.getZoomFactor();let keys=["bottom","top","left","right"];for(let i=0;i<keys.length;i++){let k=keys[i];p[k]=this.camera[k]}return p},this.parseCamera=function(obj,debug=0){debug&&console.log("Input=",JSON.stringify(obj,null,2)),_this.target.copy(obj.target),_this.camera.position.copy(obj.position),_this.camera.up.copy(obj.up),_eye.subVectors(_this.camera.position,_this.target),_this.camera.left=obj.left,_this.camera.right=obj.right,_this.camera.top=obj.top,_this.camera.bottom=obj.bottom,_this.camera.lookAt(_this.target),_this.dispatchEvent(changeEvent),lastPosition.copy(_this.camera.position),_this.zoomCamera(obj.zoomFactor);let p=this.serializeCamera();debug&&console.log("Output=",JSON.stringify(p,null,2))},this.handleResize=function(){var box=this.domElement.getBoundingClientRect();this.screen.left=box.left,this.screen.top=box.top,this.screen.width=box.width,this.screen.height=box.height,this.left0=this.camera.left,this.right0=this.camera.right,this.top0=this.camera.top,this.bottom0=this.camera.bottom,this.center0.set((this.left0+this.right0)/2,(this.top0+this.bottom0)/2)},this.handleEvent=function(event){"function"==typeof this[event.type]&&this[event.type](event)};var vector,axis,quaternion,mouseChange,cameraUp,pan,getMouseOnScreen=(vector=new THREE.Vector2,function(pageX,pageY){return vector.set((pageX-_this.screen.left)/_this.screen.width,(pageY-_this.screen.top)/_this.screen.height),vector}),getMouseProjectionOnBall=function(){var vector=new THREE.Vector3,cameraUp=new THREE.Vector3,mouseOnBall=new THREE.Vector3;return function(nx,ny){mouseOnBall.set(nx,-ny,0);var length=mouseOnBall.length();return _this.noRoll?length<Math.SQRT1_2?mouseOnBall.z=Math.sqrt(1-length*length):mouseOnBall.z=.5/length:length>1?mouseOnBall.normalize():mouseOnBall.z=Math.sqrt(1-length*length),_eye.copy(_this.camera.position).sub(_this.target),vector.copy(_this.camera.up).setLength(mouseOnBall.y),vector.add(cameraUp.copy(_this.camera.up).cross(_eye).setLength(mouseOnBall.x)),vector.add(_eye.setLength(mouseOnBall.z)),vector}}();function keydown(event){!1!==_this.enabled&&(window.removeEventListener("keydown",keydown),_prevState=_state,_state===STATE.NONE&&(event.keyCode!==_this.keys[STATE.ROTATE]||_this.noRotate?event.keyCode!==_this.keys[STATE.ZOOM]||_this.noZoom?event.keyCode!==_this.keys[STATE.PAN]||_this.noPan?82===event.keyCode&&_this.reset():_state=STATE.PAN:_state=STATE.ZOOM:_state=STATE.ROTATE))}function keyup(){!1!==_this.enabled&&(_state=_prevState,window.addEventListener("keydown",keydown,!1))}function mouseinviewport(event){if(!1===_this.enabled)return!1;var offset=$(_this.domElement).offset(),ex=event.clientX-offset.left+$(window).scrollLeft(),ey=event.clientY-offset.top+$(window).scrollTop();ey=_this.screen.height-(ey+1);var vp=[_this.normViewport.x0*_this.screen.width,_this.normViewport.x1*_this.screen.width,_this.normViewport.y0*_this.screen.height,_this.normViewport.y1*_this.screen.height];if(ex<=vp[0]||ex>=vp[1]||ey<=vp[2]||ey>=vp[3])return!1;var n=new THREE.Vector3(2*(ex-vp[0])/(vp[1]-vp[0])-1,2*(ey-vp[2])/(vp[3]-vp[2])-1,1);_this.lastNormalizedCoordinates[0]=n.x,_this.lastNormalizedCoordinates[1]=n.y;var w=n.unproject(_this.camera);return _this.lastCoordinates[0]=w.x,_this.lastCoordinates[1]=w.y,_this.lastCoordinates[2]=w.z,!0}function coordinateCallback(state){_this.plane>=0&&_this.plane<=2&&"function"==typeof _this.coordinateChangeCallback&&_this.coordinateChangeCallback(_this.lastCoordinates,_this.plane,state)}function contextmenulistener(event){event.preventDefault()}function mousedown(event){mouseinviewport(event)&&(_state===STATE.NONE&&(_state=event.button),_state!==STATE.ROTATE||_this.noRotate?_state!==STATE.ZOOM||_this.noZoom?_state!==STATE.PAN||_this.noPan||(_panStart.copy(getMouseOnScreen(event.pageX,event.pageY)),_panEnd.copy(_panStart)):(_zoomStart.copy(getMouseOnScreen(event.pageX,event.pageY)),_zoomEnd.copy(_zoomStart)):(_rotateStart.copy(getMouseProjectionOnBall(_this.lastNormalizedCoordinates[0],_this.lastNormalizedCoordinates[1])),_rotateEnd.copy(_rotateStart)),document.addEventListener("mousemove",mousemove,!1),document.addEventListener("mouseup",mouseup,!1),_this.dispatchEvent(startEvent),_state===STATE.ROTATE&&_this.noRotate&&coordinateCallback(0))}function mousemove(event){if(!mouseinviewport(event))return mouseup(event);event.preventDefault(),event.stopPropagation(),_state!==STATE.ROTATE||_this.noRotate?_state!==STATE.ZOOM||_this.noZoom?_state!==STATE.PAN||_this.noPan||_panEnd.copy(getMouseOnScreen(event.pageX,event.pageY)):_zoomEnd.copy(getMouseOnScreen(event.pageX,event.pageY)):_rotateEnd.copy(getMouseProjectionOnBall(_this.lastNormalizedCoordinates[0],_this.lastNormalizedCoordinates[1])),_state===STATE.ROTATE&&_this.noRotate&&coordinateCallback(1)}function mouseup(event){!1!==_this.enabled&&(event.preventDefault(),event.stopPropagation(),_state===STATE.ROTATE&&_this.noRotate&&coordinateCallback(2),_state=STATE.NONE,document.removeEventListener("mousemove",mousemove),document.removeEventListener("mouseup",mouseup),_this.dispatchEvent(endEvent))}function mousewheel(event){if(!1!==_this.enabled){event.stopPropagation();var delta=0;event.wheelDelta?delta=event.wheelDelta/40:event.detail&&(delta=-event.detail/3),_zoomStart.y+=.01*delta,_this.dispatchEvent(startEvent),_this.dispatchEvent(endEvent)}}function touchstart(event){if(!1===_this.enabled)return!1;if(mouseinviewport(event.touches[0])&&(!(event.touches.length>1)||mouseinviewport(event.touches[1])))if(inobounce.enable(),1==event.touches.length&&_this.noRotate)coordinateCallback(0);else{switch(event.touches.length){case 1:_this.noRotate||(_state=STATE.TOUCH_ROTATE,_rotateStart.copy(getMouseProjectionOnBall(_this.lastNormalizedCoordinates[0],_this.lastNormalizedCoordinates[1])),_rotateEnd.copy(_rotateStart));break;case 2:_state=STATE.TOUCH_ZOOM_PAN;var dx=event.touches[0].pageX-event.touches[1].pageX,dy=event.touches[0].pageY-event.touches[1].pageY;_touchZoomDistanceEnd=_touchZoomDistanceStart=Math.sqrt(dx*dx+dy*dy);break;default:_state=STATE.NONE}_this.dispatchEvent(startEvent)}}function touchmove(event){if(!1!==_this.enabled){if(1==event.touches.length){if(!mouseinviewport(event.touches[0]))return;if(_this.noRotate)return void coordinateCallback(1)}if(!(event.touches.length>1)||mouseinviewport(event.touches[1]))switch(event.touches.length){case 1:_rotateEnd.copy(getMouseProjectionOnBall(_this.lastNormalizedCoordinates[0],_this.lastNormalizedCoordinates[1]));break;case 2:var dx=event.touches[0].pageX-event.touches[1].pageX,dy=event.touches[0].pageY-event.touches[1].pageY;_touchZoomDistanceEnd=Math.sqrt(dx*dx+dy*dy);break;default:_state=STATE.NONE}}}function touchend(event){if(!1!==_this.enabled){switch(event.touches.length){case 1:_rotateEnd.copy(getMouseProjectionOnBall(event.touches[0].pageX,event.touches[0].pageY)),_rotateStart.copy(_rotateEnd);break;case 2:_touchZoomDistanceStart=_touchZoomDistanceEnd=0}inobounce.disable(),_state=STATE.NONE,_this.dispatchEvent(endEvent)}}this.rotateCamera=(axis=new THREE.Vector3,quaternion=new THREE.Quaternion,function(){var angle=Math.acos(_rotateStart.dot(_rotateEnd)/_rotateStart.length()/_rotateEnd.length());angle&&(axis.crossVectors(_rotateStart,_rotateEnd).normalize(),angle*=_this.rotateSpeed,quaternion.setFromAxisAngle(axis,-angle),_eye.applyQuaternion(quaternion),_this.camera.up.applyQuaternion(quaternion),_rotateEnd.applyQuaternion(quaternion),_rotateStart.copy(_rotateEnd))}),this.zoomCamera=function(manualfactor){let manual=manualfactor||null;var factor=1;1!==(factor=null===manual?_state===STATE.TOUCH_ZOOM_PAN?1+.05*(_touchZoomDistanceStart-_touchZoomDistanceEnd)*_this.zoomSpeed:1+(_zoomEnd.y-_zoomStart.y)*_this.zoomSpeed:manual)&&factor>0&&(_zoomFactor*=factor,_this.camera.left=_zoomFactor*_this.left0+(1-_zoomFactor)*_this.center0.x,_this.camera.right=_zoomFactor*_this.right0+(1-_zoomFactor)*_this.center0.x,_this.camera.top=_zoomFactor*_this.top0+(1-_zoomFactor)*_this.center0.y,_this.camera.bottom=_zoomFactor*_this.bottom0+(1-_zoomFactor)*_this.center0.y,_zoomStart.copy(_zoomEnd),_touchZoomDistanceStart=_touchZoomDistanceEnd)},this.panCamera=(mouseChange=new THREE.Vector2,cameraUp=new THREE.Vector3,pan=new THREE.Vector3,function(){mouseChange.copy(_panEnd).sub(_panStart),mouseChange.lengthSq()&&(mouseChange.multiplyScalar(_eye.length()*_this.panSpeed),pan.copy(_eye).cross(_this.camera.up).setLength(mouseChange.x),pan.add(cameraUp.copy(_this.camera.up).setLength(-mouseChange.y)),_this.camera.position.add(pan),_this.target.add(pan),_panStart.copy(_panEnd))}),this.update=function(renderer){if(renderer=renderer||null,_eye.subVectors(_this.camera.position,_this.target),_this.noRotate||_this.rotateCamera(),_this.noZoom||(_this.zoomCamera(),_this.camera.updateProjectionMatrix()),_this.noPan||_this.panCamera(),_this.camera.position.addVectors(_this.target,_eye),_this.camera.lookAt(_this.target),lastPosition.distanceToSquared(_this.camera.position)>1e-6&&(_this.dispatchEvent(changeEvent),lastPosition.copy(_this.camera.position)),null!==renderer){var v=this.normViewport,vp=[1+v.x0*this.screen.width,1+v.y0*this.screen.height,(v.x1-v.x0)*this.screen.width,(v.y1-v.y0)*this.screen.height];if(vp[0]>0&&vp[1]>0&&vp[2]>0&&vp[3]>0){let top=vp[1];return THREEJSREVISION>86&&(top=this.screen.height-vp[1]-vp[3]),renderer.setViewport(vp[0],top,vp[2],vp[3]),!0}return!1}return!0},this.reset=function(){_state=STATE.NONE,_prevState=STATE.NONE,_this.target.copy(_this.target0),_this.camera.position.copy(_this.position0),_this.camera.up.copy(_this.up0),_eye.subVectors(_this.camera.position,_this.target),_this.camera.left=_this.left0,_this.camera.right=_this.right0,_this.camera.top=_this.top0,_this.camera.bottom=_this.bottom0,_this.camera.lookAt(_this.target),_this.dispatchEvent(changeEvent),lastPosition.copy(_this.camera.position),_this.zoomCamera(1/(_zoomFactor||1))},_this.remove=function(){_this.domElement.removeEventListener("contextmenu",contextmenulistener,!1),_this.domElement.removeEventListener("mousedown",mousedown,!1),document.removeEventListener("mousemove",mousemove),document.removeEventListener("mouseup",mouseup),_this.domElement.removeEventListener("mousewheel",mousewheel,!1),_this.domElement.removeEventListener("DOMMouseScroll",mousewheel,!1),_this.domElement.removeEventListener("touchstart",touchstart,{passive:!0}),_this.domElement.removeEventListener("touchend",touchend,{passive:!0}),_this.domElement.removeEventListener("touchmove",touchmove,{passive:!0}),window.removeEventListener("keydown",keydown,!1),window.removeEventListener("keyup",keyup,!1),_this.enabled=!1},_this.domElement.addEventListener("contextmenu",contextmenulistener,!1),_this.domElement.addEventListener("mousedown",mousedown,{capture:!1,passive:!0}),_this.domElement.addEventListener("mousewheel",mousewheel,{capture:!1,passive:!0}),_this.domElement.addEventListener("DOMMouseScroll",mousewheel,{capture:!1,passive:!0}),_this.domElement.addEventListener("touchstart",touchstart,{capture:!1,passive:!0}),_this.domElement.addEventListener("touchend",touchend,{capture:!1,passive:!0}),_this.domElement.addEventListener("touchmove",touchmove,{capture:!1,passive:!0}),window.addEventListener("keydown",keydown,{capture:!1,passive:!0}),window.addEventListener("keyup",keyup,{capture:!1,passive:!0}),_this.handleResize(),_this.update()};(bisOrthographicCameraControls.prototype=Object.create(THREE.EventDispatcher.prototype)).constructor=bisOrthographicCameraControls,module.exports=bisOrthographicCameraControls},"./js/coreweb/bis_webfileutil.js":function(module,exports,__webpack_require__){"use strict";const $=__webpack_require__("jquery"),webutil=__webpack_require__("./js/coreweb/bis_webutil.js"),bisweb_dropbox=__webpack_require__("./js/cloud/bisweb_simpledropbox.js"),bisweb_onedrive=__webpack_require__("./js/cloud/bisweb_simpleonedrive.js"),bisweb_googledrive=__webpack_require__("./js/cloud/bisweb_drivemodule.js"),amazonaws=__webpack_require__("./js/cloud/bisweb_awsmodule.js");let bisweb_awsmodule=null;const genericio=__webpack_require__("./js/core/bis_genericio.js"),userPreferences=__webpack_require__("./js/core/bisweb_userpreferences.js"),keystore=__webpack_require__("../internal/js/bis_keystore.js"),dkey=keystore.DropboxAppKey||"",gkey=keystore.GoogleDriveKey||"",mkey=keystore.OneDriveKey||"";let enableaws=!1,bisweb_fileserverclient=null;if(!webutil.inElectronApp()){const BisWebFileServerClient=__webpack_require__("./js/coreweb/bisweb_fileserverclient.js");bisweb_fileserverclient=new BisWebFileServerClient}let fileMode="local",fileInputElements=[],iosFileDialog=null;const webfileutils={needModes:function(){return dkey.length>0||gkey.length>0||mkey.length>0},getMode:function(){return fileMode},getModeList:function(){let s=[{value:"local",text:"Local File System"}];return bisweb_fileserverclient&&s.push({value:"server",text:"BioImage Suite Web File Server Helper"}),enableaws&&s.push({value:"amazonaws",text:"Amazon S3"}),dkey.length>1&&s.push({value:"dropbox",text:"Dropbox (Load Only)"}),gkey.length>1&&s.push({value:"googledrive",text:"Google Drive (Load Only)"}),s},setMode:function(m="",save=!0){switch(fileMode="local",m){case"dropbox":dkey&&(fileMode="dropbox");break;case"googledrive":gkey&&(fileMode="googledrive");break;case"onedrive":mkey&&(fileMode="onedrive");break;case"amazonaws":enableaws&&(fileMode="amazonaws");break;case"server":fileMode="server"}"server"===fileMode?genericio.setFileServerObject(bisweb_fileserverclient):"amazonaws"===fileMode?genericio.setFileServerObject(bisweb_awsmodule):genericio.setFileServerObject(null),save&&(userPreferences.setItem("filesource",fileMode),userPreferences.storeUserPreferences())},candoComplexIO:function(){return"browser"!==genericio.getmode()||("server"===fileMode||"amazonaws"===fileMode||(webutil.createAlert("You need to connect to a local fileserver on an S3 share before this operation.",!0),!1))},electronFileCallback:function(fileopts,callback){(fileopts=fileopts||{}).save=fileopts.save||!1,fileopts.title=fileopts.title||"Specify filename",fileopts.defaultpath=fileopts.defaultpath||"";let suffix=fileopts.suffix||"";if("NII"!==suffix&&"NII"!==fileopts.filters||(fileopts.filters=[{name:"NIFTI Images",extensions:["nii.gz","nii"]},{name:"All Files",extensions:["*"]}]),"DIRECTORY"===suffix&&(fileopts.filters="DIRECTORY"),""===fileopts.defaultpath)try{fileopts.initialCallback&&(fileopts.defaultpath=fileopts.initialCallback()||"")}catch(e){console.log(e)}fileopts.filters=fileopts.filters||[{name:"All Files",extensions:["*"]}],"NII"===fileopts.filters&&(fileopts.filters=[{name:"NIFTI Images",extensions:["nii.gz","nii"]},{name:"All Files",extensions:["*"]}]);var cmd=window.BISELECTRON.dialog.showSaveDialog;fileopts.save||(cmd=window.BISELECTRON.dialog.showOpenDialog),"DIRECTORY"===fileopts.filters?cmd(null,{title:fileopts.title,defaultPath:fileopts.defaultpath,properties:["openDirectory"]},function(filename){if(filename)return callback(filename+"")}):cmd(null,{title:fileopts.title,defaultPath:fileopts.defaultpath,filters:fileopts.filters},function(filename){if(filename)return callback(filename+"")})},webFileCallback:function(fileopts,callback){fileopts.suffix=fileopts.suffix||null,fileopts.filters=fileopts.filters||null,fileopts.force=fileopts.force||null;let suffix=fileopts.suffix||"",title=fileopts.title||"",defaultpath=fileopts.defaultpath||"";if(null===fileopts.suffix&&null!==fileopts.filters&&("DIRECTORY"!==fileopts.filters&&"NII"!==fileopts.filters||(suffix=fileopts.filters,fileopts.suffix=suffix)),"NII"===suffix||"NII"===fileopts.filters)suffix=".nii.gz,.nii,.gz,.tiff",fileopts.filters=[{name:"NIFTI Images",extensions:["nii.gz","nii"]}];else if("DIRECTORY"!==suffix&&""!==suffix){let s=suffix.split(",");for(let i=0;i<s.length;i++){0!==s[i].indexOf(".")&&(s[i]="."+s[i])}suffix=s.join(",")}let fmode=fileMode;null!==fileopts.force&&(fmode=fileopts.force);let cbopts={callback:callback,title:title,suffix:suffix,mode:"load",filters:fileopts.filters};if("DIRECTORY"===fileopts.suffix&&(cbopts.initialFilename="",cbopts.mode="directory",cbopts.suffix="","server"!==fmode&&"amazonaws"!==fmode))return webutil.createAlert("You need to connect to a local fileserver on an S3 share before this operation.",!0),!1;if(fileopts.save){if("server"===fmode||"amazonaws"===fmode){let initialDir=null,initialFilename=null;try{if(fileopts&&fileopts.initialCallback){let f=fileopts.initialCallback()||"";if(f.length>0){let ind=f.lastIndexOf("/");ind>0?(initialDir=f.substr(0,ind),initialFilename=f.substr(ind+1,f.length)):(initialFilename=f,initialDir=null)}}}catch(e){console.log(e)}return!initialFilename&&defaultpath.length>0&&(initialDir=defaultpath,initialFilename=null),cbopts.initialFilename=initialFilename||"",cbopts.mode="save",void("server"===fmode?bisweb_fileserverclient.requestFileList(initialDir,!0,cbopts):bisweb_awsmodule.wrapInAuth("uploadfile",cbopts))}return void callback()}if("dropbox"===fmode)return fileopts.suffix=suffix,bisweb_dropbox.pickReadFile(fileopts,callback);if("onedrive"===fmode)return fileopts.suffix=suffix,bisweb_onedrive.pickReadFile(fileopts,callback);if("googledrive"===fmode)return void bisweb_googledrive.create().then(()=>{bisweb_googledrive.pickReadFile("").then(obj=>{callback(obj[0])}).catch(e=>{console.log("Error in Google drive",e)})}).catch(e=>{console.log(e),webutil.createAlert("Failed to intitialize google drive connection",!0)});if("amazonaws"===fmode)return void bisweb_awsmodule.wrapInAuth("showfiles",cbopts);if("server"===fmode)return void bisweb_fileserverclient.requestFileList(null,!0,cbopts);let nid=webutil.getuniqueid();for(let i=0;i<fileInputElements.length;i++)fileInputElements[i].remove();if(genericio.inIOS()){iosFileDialog||(iosFileDialog=webutil.createmodal("Select Input File")),iosFileDialog.titlediv.empty(),fileopts.title.length<1&&(fileopts.title="Select File"),iosFileDialog.titlediv.append(`<H4>${fileopts.title}</H4>`);let loadelement=$(`<input type="file" id="${nid}" accept="${suffix}"/>`);fileInputElements.push(loadelement),loadelement[0].addEventListener("change",function(f){return iosFileDialog.dialog.modal("hide"),setTimeout(()=>{callback(f.target.files[0])},50),!1}),iosFileDialog.body.append(loadelement),iosFileDialog.dialog.modal("show"),iosFileDialog.body[0].click()}else{let loadelement=$(`<input type="file" style="visibility: hidden;" id="${nid}" accept="${suffix}"/>`);fileInputElements.push(loadelement),loadelement[0].addEventListener("change",function(f){callback(f.target.files[0])}),$("body").append(loadelement),loadelement[0].click()}},genericFileCallback:function(fileopts={},callback=null){(fileopts=fileopts||{}).save=fileopts.save||!1;const that=this;webutil.inElectronApp()?that.electronFileCallback(fileopts,callback):setTimeout(()=>{that.webFileCallback(fileopts,callback)},1)},attachFileCallback:function(button,callback,fileopts={}){fileopts.save=fileopts.save||!1,webutil.inElectronApp()?button.click(e=>{setTimeout(()=>{e.stopPropagation(),e.preventDefault(),this.electronFileCallback(fileopts,callback)},1)}):button.click(e=>{setTimeout(()=>{e.stopPropagation(),e.preventDefault(),this.webFileCallback(fileopts,callback)},1)})},createFileButton:function(opts,fileopts={}){let finalcallback=opts.callback||null;if(null===finalcallback||"function"!=typeof finalcallback)throw new Error("create file button needs a non-null callback");opts.callback=finalcallback,opts.callback=null;let but=webutil.createbutton(opts);return this.attachFileCallback(but,finalcallback,fileopts),but},createFileMenuItem:function(parent,name="",callback=null,fileopts={},css=""){let style="";css.length>1&&(style=` style="${css}"`);let menuitem=$(`<li><a href="#" ${style}>${name}</a></li>`);return parent.append(menuitem),webutil.disableDrag(menuitem,!0),this.attachFileCallback(menuitem,callback,fileopts),menuitem},createDropdownFileItem:function(dropdown,name,callback,fileopts){return this.createFileMenuItem(dropdown,name,callback,fileopts,"background-color: #303030; color: #ffffff; font-size:13px; margin-bottom: 2px")},createFileSourceSelector:function(bmenu,name="Set File Source",separator=!0){const self=this;let fn=function(){userPreferences.safeGetItem("filesource").then(initial=>{initial=initial||"local";let extra="";extra='\n                        <HR><p>You may download the bisweb fileserver using npm. Type <B>npm install biswebnode</B>. Once this is installed look into the <B>biswebnode/serverconfig</B> directory for instructions.\n                        Use with care. This requires <a href="https://nodejs.org/en/download/" target="_blank" rel="noopener">node.js vs 10.x</a>\n                        </p>',webutil.createRadioSelectModalPromise("<H4>Select File Source</H4><HR>","Close",initial,self.getModeList(),extra).then(m=>{self.setMode(m)}).catch(()=>{})})};!webutil.inElectronApp()&&this.needModes()&&(separator&&webutil.createMenuItem(bmenu,""),webutil.createMenuItem(bmenu,name,fn))},createAWSMenu:function(){enableaws&&(null===bisweb_awsmodule&&(bisweb_awsmodule=new amazonaws),bisweb_awsmodule.createAWSBucketMenu())},initializeFromUserPrefs:function(){webutil.inElectronApp()?this.setMode("local",!0):Promise.all([userPreferences.safeGetItem("filesource"),userPreferences.safeGetItem("enables3")]).then(lst=>{let f=lst[0];enableaws=lst[1]||!1,f=f||fileMode,console.log("+++++ Initial File Source=",f,"s3enabeled=",enableaws),enableaws&&null===bisweb_awsmodule&&(bisweb_awsmodule=new amazonaws),this.setMode(f,!1)}).catch(()=>{this.setMode("local",!1)})}};module.exports=webfileutils},"./js/coreweb/bis_webutil.js":function(module,exports,__webpack_require__){"use strict";const $=__webpack_require__("jquery"),bootbox=__webpack_require__("./node_modules/bootbox/bootbox.js"),biswrap=__webpack_require__("./build/wasm/libbiswasm_wrapper.js"),genericio=__webpack_require__("./js/core/bis_genericio.js"),names=["default","primary","success","info","warning","danger","link"],directions=["top","bottom","left","right"];let tools=__webpack_require__("./web/images/tools.json");const internal={idcounter:0,templates:null,alertcount:0,alerttimeout:8e3,alerttop:70};let deleteModal=modal=>{let modalDiv=modal.dialog[0].parentNode;modalDiv.parentNode.removeChild(modalDiv)};const webutil={setAlertTop:function(v){internal.alerttop=v},getfontsize:function(canvas,large){large=large||!1;var dw=canvas.width||600;return dw>900&&(dw=900),large?Math.round(14*dw/600):Math.round(12*dw/600)},getuniqueid:function(prefix){return prefix=prefix||"",internal.idcounter=internal.idcounter+1,""!==prefix?prefix+"_B_"+internal.idcounter:`B_${internal.idcounter}`},fixDomTree:function(root,prefix){var nid=webutil.getuniqueid(prefix);return $(root).find("*").each(function(i,e){["for","id","name","aria-controls","href","aria-labeledby"].forEach(function(attrname){var attr=$(e).attr(attrname)||"";""!==attr&&$(e).attr(attrname,attr+nid)})}),nid},createWithTemplate:function(template,parent,prefix){var clone=document.importNode(template.content,!0),div=webutil.creatediv({parent:parent});div[0].appendChild(clone);var n="";return n="none"!==prefix?webutil.fixDomTree(div,prefix):this.getuniqueid(),div.attr("id",n),n},removeallchildren:function(elem){let frame=$(elem)[0];for(;frame.firstChild;)frame.removeChild(frame.firstChild)},addtooltip:function(bt,opts){if(null===(bt||null)||null===(opts||null))return bt;var tooltip=opts.tooltip||!1,position=opts.position||"top";if(!1===tooltip)return bt;var ind=directions.indexOf(position);return ind<0&&(ind=0),bt.attr({"data-toggle":"tooltip","data-placement":directions[ind],title:tooltip}),bt},enablebutton:function(bt,doenable){(doenable=doenable||!1)?bt.removeAttr("disabled"):bt.attr("disabled","disabled")},createbutton:function(opts){if(null===(opts||null))return null;var name=opts.name||"name",type=opts.type||"info",parent=opts.parent||null,css=opts.css||null,attr=opts.attr||null,ind=names.indexOf(type),callback=opts.callback,large=opts.large||!1,classname="";classname=ind<0?"btn "+type:"btn btn-"+names[ind],large||(classname+=" btn-sm");var bt=$('<button type="button" class="'+classname+'">'+name+"</button>");if(null!==attr&&bt.attr("bis",attr),null!==css&&bt.css(css),void 0!==callback&&null!==callback){if("function"!=typeof callback)throw new Error(callback+" is not a function in creating button"+name);bt.click(function(e){e.preventDefault(),callback(e)})}return this.disableDrag(bt),null!==parent&&parent.append(bt),null===(opts.tooltip||null)?bt:this.addtooltip(bt,opts)},createlabel:function(opts){var name=(opts=opts||{}).name||"name",type=opts.type||"info",parent=opts.parent||null,css=opts.css||null,ind=names.indexOf(type),tooltip=opts.tooltip||null;ind<0&&(ind=0);var classname="label label-"+names[ind],bt=$('<span class="'+classname+'">'+name+"</span>");return null!==parent&&parent.append(bt),null!==css&&bt.css(css),null===tooltip?bt:this.addtooltip(bt,opts)},createbuttonbar:function(opts){var parent=(opts=opts||{}).parent||null,css=opts.css||null,bbar=$('<div class="btn-group" role="group" aria-label="...">');return null!==css&&bbar.css(css),null!==parent&&parent.append(bbar),bbar},creatediv:function(opts){var bbar,parent=(opts=opts||{}).parent||null,css=opts.css||null,classname=opts.classname||null;return bbar=$(null===classname?"<div></div>":'<div class="'+classname+'"></div>'),null!==css&&bbar.css(css),null!==parent&&parent.append(bbar),bbar},createpanelgroup:function(parent,offset){offset=offset||1,parent=parent||null;var cid=webutil.getuniqueid("core")+offset,panel=$('<div class="panel-group" id="'+cid+'" role="tablist" aria-multiselectable="false"></div>');return null!==parent&&parent.append(panel),panel},createcheckbox:function(opts){var name=(opts=opts||{}).name||["none"],type=opts.type||"info",parent=opts.parent||null,css=opts.css||null,checked=opts.checked||!1,callback=opts.callback||void 0;""!==type&&(type=" abc-checkbox-"+type);var nid=this.getuniqueid(),par=$('<div class="checkbox abc-checkbox'+type+'" style="display: inline-block"></div>'),checkbutton=$('<input id="'+nid+'" class="styled" type="checkbox">'),label=$('<label for="'+nid+'" style="font-size:11px">'+name+"</label>");if(par.append(checkbutton),par.append(label),checkbutton.prop("checked",checked),null!==css&&label.css(css),void 0!==callback){if("function"!=typeof callback)throw new Error(callback+" is not a function in creating select "+names);checkbutton.change(function(e){e.preventDefault();var p=checkbutton.is(":checked")||!1;callback(p)})}return null!==parent?(parent.append(par),checkbutton):par},createtogglecheckbox:function(opts){var btn,checked=(opts=opts||{}).checked||!1,callback=opts.callback||void 0;if(void 0===callback)throw new Error(callback+" is not a function in creating select "+names);if("function"!=typeof callback)throw new Error(callback+" is not a function in creating select "+names);var enablecallback=!1,mycallback=function(){var state=btn.data("state");enablecallback&&(state=!state,btn.data("state",state)),btn.blur(),state?(btn.css({"border-radius":"20px",color:"#ffffff"}),btn.addClass("btn-success"),btn.removeClass("btn-default")):(btn.css({"border-radius":"0px",color:"#bbbbbb"}),btn.removeClass("btn-success"),btn.addClass("btn-default")),enablecallback&&callback(state)};return opts.type=checked?"success":"default",opts.callback=mycallback,(btn=this.createbutton(opts)).css({outline:"0px"}),btn.data("state",checked),mycallback(),enablecallback=!0,btn},createradiobuttonset:function(opts){let values=(opts=opts||{}).values||["Yes","No"],value=opts.value||opts.values[0],callback=opts.callback||void 0,parent=opts.parent||null,multiline=opts.multiline||!1,base=$("<div></div>"),uid=this.getuniqueid(),mline='style="display: inline-block"';multiline&&(mline="");let createradio=function(i){let checked="";value===values[i]&&(checked="checked");let nid=this.getuniqueid(),par=$(`<div class="radio" ${mline}></div>`),radio=$(`<input type="radio" id="${nid}" name="${uid}" value="${values[i]}" ${checked}>`),label=$(`<label for="${nid}" style="font-size:11px; margin-right:10px"> ${opts.values[i]} </label>`);if(label.prepend(radio),par.append(label),base.append(par),void 0!==callback){if("function"!=typeof callback)throw new Error(callback+" is not a function in creating select "+names);radio.change(function(e){e.preventDefault(),(radio.is(":checked")||!1)&&callback(radio.attr("value"))})}null!==parent&&parent.append(base)};for(let i=0;i<values.length;i++)createradio(i);return base},createRadioSelectModalPromise:function(title,buttonname,value,options,extra=""){let name=this.getuniqueid(),ids=[],str=`${title}`;for(let i=0;i<options.length;i++){let newid=this.getuniqueid();ids.push(newid);let checked="";options[i].value===value&&(checked="checked"),str+=`<div class="radio">\n                <label><input type="radio"  name="${name}" id="${newid}" value="${options[i].value}" ${checked}>${options[i].text}</label>\n                </div>`}return str+=extra,new Promise((resolve,reject)=>{bootbox.dialog({message:str,closeButton:!1,buttons:{ok:{label:buttonname,className:"btn-info",callback:function(){for(let j=0;j<options.length;j++){let radio=$("#"+ids[j]);(radio.is(":checked")||!1)&&resolve(radio.attr("value"))}reject("Failed to find anything")}}}})})},createselect:function(opts){for(var names=(opts=opts||{}).values||["none"],index=opts.index||-1,parent=opts.parent||null,size=opts.size||1,css=opts.css||{"background-color":"#505050",color:"#ffffff"},cssclass=opts.class||"dg c select",callback=opts.callback||void 0,select=$('<select class="'+cssclass+'" + size="'+size+'"></select>'),np=names.length,i=0;i<np;i++){var b='<option value="'+i+'">'+names[i]+"</option>";select.append($(b))}if(null!==css&&select.css(css),index>=0&&$(select).val(index),void 0!==callback){if("function"!=typeof callback)throw new Error(callback+" is not a function in creating select "+names);select.change(function(e){e.preventDefault(),callback(e)})}return null!==parent&&parent.append(select),null===(opts.tooltip||null)?select:this.addtooltip(select,opts)},tooltip:function(parent){parent.find('[data-toggle="tooltip"]').tooltip()},createmodal:function(title,extra){extra=extra||"";var newid=webutil.createWithTemplate(internal.templates.bismodal,$("body")),div=$("#"+newid);return div.find(".modal-title").text(title),""!==extra&&div.find(".modal-dialog").addClass(extra),{dialog:div.find(".fade"),body:div.find(".modal-body"),footer:div.find(".modal-footer"),header:div.find(".modal-header"),titlediv:div.find(".modal-title"),close:div.find("btn-default")}},createCollapseElement:function(parent,title,open){open=open||!1;var parid=parent.attr("id"),newid=webutil.createWithTemplate(internal.templates.bispanel,parent),div=$("#"+newid),telem=div.find('[data-parent="#parent"]');telem.attr("data-parent","#"+parid),telem.text(title);var body=div.find(".panel-body");return body.empty(),open&&body.parent().addClass("in"),$(div).children().appendTo(parent),div.remove(),body},activateCollapseElement:function(elem){let top=elem.parent().parent();if(top.find(".in").length<1){let link=top.find(".panel-title").children()[0];$(link).trigger("click")}setTimeout(()=>{let scr=top.parent().parent(),t=Math.round(scr.height())-(Math.round(elem.height())+100);t<0&&(t=0),scr.scrollTop(t)},200)},isCollapseElementOpen(elem){try{if(elem.parent().hasClass("in"))return!0}catch(e){}return!1},createdialog:function(name,w,h,x,y,zindex,closecallback=null){let dlg=document.createElement("bisweb-dialogelement");return dlg.create(name,w,h,x,y,zindex,!0,closecallback),dlg},createDropdownItem:function(dropdown,name,callback,css=""){return""===css&&(css="background-color: #303030; color: #ffffff; font-size:13px; margin-bottom: 2px"),this.createMenuItem(dropdown,name,callback,css)},createDropdownMenu:function(name,parent){let nid=this.getuniqueid(),txt=$(`<div class="dropdown" style="display: inline-block">\n                  <button id="${nid}" type="button" class="btn btn-default btn-sm" style="margin-left: 2px" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">\n                  ${name} <span class="caret"></span></button>\n                  <ul class="dropdown-menu" class="label-info"  style="background-color : #303030" aria-labelledby="${nid}">\n                  </ul>\n                  </div>`);return parent.append(txt),txt.find(".dropdown-menu")},removedatclose:function(folder){$(folder.domElement).find(".close-button").remove()},getactivecolor:function(){return"#440000"},getpassivecolor:function(){return"#303030"},getpassivecolor2:function(){return"#383838"},inElectronApp:function(){return void 0!==window.BISELECTRON},createTopMenuBarMenu:function(name,parent){var html=$("<li class='dropdown'><a href='#' class='dropdown-toggle'  data-toggle='dropdown' role='button' aria-expanded='false'>"+name+"<span class='caret'></span></a><ul class='dropdown-menu' role='menu'></ul></li>");parent.append($(html));var t1=$(".dropdown-menu",$(html));return this.disableDrag(t1),t1},createMenuItem:function(parent,name,callback,css=""){var menuitem;if(""===(name=name||""))return menuitem=$('<li class="divider"></li>'),parent.append(menuitem),menuitem;callback=callback||null;let style="";return css.length>1&&(style=` style="${css}"`),menuitem=$(`<li><a href="#" ${style}>${name}</a></li>`),parent.append(menuitem),this.disableDrag(menuitem,!0),callback&&menuitem.click(function(e){e.preventDefault(),callback(e)}),menuitem},createAlert:function(text,error,top=0,timeout=0,options={}){$(".alert-success").remove(),$(".alert-info").remove(),timeout+=internal.alerttimeout,top+=internal.alerttop;let b="info";!0===error?b="danger":"progress"===error&&(b="success");let w=$(`\n            <div class="alert alert-${b} alert-dismissible" role="alert" style="position:absolute; top:${top}px; left:10px; z-index:${1e3+internal.alertcount}">\n                <button type="button" class="close" data-dismiss="alert" aria-label="Close">\n                    <span aria-hidden="true">&times;</span>\n                </button>\n                <span class='glyphicon glyphicon-refresh glyphicon-refresh-animate' style='display: none'></span>  ${text}\n            </div>`);options.makeLoadSpinner&&w.find(".glyphicon-refresh-animate").css("display",""),$("body").append(w),internal.alertcount+=1,w.alert(),"info"===b&&setTimeout(function(){try{w.remove()}catch(e){console.log(w,"is no more")}},timeout)},createDragAndCropController:function(callback){let dr=document.createElement("bisweb-draganddropelement");return $("body")[0].appendChild(dr),dr.setCallback(callback),dr},disableDrag:function(bt,dochildren=!1){bt.css({"user-drag":"none","user-select":"none","-moz-user-select":"none","-webkit-user-drag":"none","-webkit-user-select":"none","-ms-user-select":"none"}),dochildren&&$(bt).children().css({"user-drag":"none","user-select":"none","-moz-user-select":"none","-webkit-user-drag":"none","-webkit-user-select":"none","-ms-user-select":"none"})},createTimestamp:function(){let current=new Date;return current.getMonth()+1+"/"+current.getDate()+"/"+current.getFullYear()%100+" "+current.getHours()+":"+(current.getMinutes()<10?"0"+current.getMinutes():current.getMinutes())+":"+(current.getSeconds()<10?"0"+current.getSeconds():current.getSeconds())},showErrorModal:function(title="An error occured",errorMessage="Click close or anywhere outside the modal to continue"){let modal=webutil.createmodal(title,"modal-sm"),confirmButton=webutil.createbutton({name:"Continue",type:"success"});modal.dialog.on("hidden.bs.modal",e=>{e.preventDefault(),deleteModal(modal)}),confirmButton.on("click",e=>{e.preventDefault(),modal.dialog.modal("hide")});let messageBody=$(`<p>${errorMessage}</p>`);return modal.body.append(messageBody),modal.body.append($("<br>")),modal.body.append(confirmButton),modal.footer.remove(),modal.dialog.modal("show"),{modal:modal,confirmButton:confirmButton}},createPopupModal:(modalTitle,modalText="",confirmButtonName="Confirm",cancelButtonName="Cancel")=>{let modal=webutil.createmodal(modalTitle),confirmButton=webutil.createbutton({name:confirmButtonName,type:"success"}),cancelButton=webutil.createbutton({name:cancelButtonName,type:"warning"});modal.dialog.on("hidden.bs.modal",e=>{e.preventDefault(),deleteModal(modal)});let messageBody=$(`<p>${modalText}</p>`);modal.body.append(messageBody),modal.footer.find(".btn")[0].remove();let buttonGroup=$('<div class="btn-group" role "group">');return buttonGroup.append(confirmButton),buttonGroup.append(cancelButton),modal.footer.append(buttonGroup),{modal:modal,cancelButton:cancelButton,confirmButton:confirmButton}},createRenameInputModal(callback){new Promise(resolve=>{let modalObj=this.createPopupModal("Enter a name","","Save","Cancel"),modal=modalObj.modal;modalObj.confirmButton.on("click",e=>{e.preventDefault();let saveName=document.getElementById("saveNameBox").value;modal.dialog.modal("hide"),resolve({name:saveName})}),modalObj.cancelButton.on("click",e=>{e.preventDefault(),modal.dialog.modal("hide"),resolve("Save canceled")}),modal.body.append("<div class = 'form-group'> \n                    <label for='saveNameBox'>Enter your filename</label>\n                    <input type='text' id='saveNameBox' class='form-control'>\n                </div>"),modal.dialog.modal("show")}).then(obj=>{callback(obj)}).catch(e=>{console.log(e)})},aboutText:(extra="")=>new Promise((resolve,reject)=>{biswrap.initialize().then(()=>{let gplextra="";biswrap.uses_gpl()&&(gplextra=' (See also <a href="https://github.com/bioimagesuiteweb/gplcppcode" target="_blank">the plugin repository.</a>)'),resolve(`<p>This application is part of BioImage Suite Web ${tools.version}.</p><p>BioImage Suite Web is an <a href="https://github.com/bioimagesuiteweb/bisweb" target="_blank">open source</a> software package.${gplextra}</p><p>We gratefully acknowledge\n                          support from the <a href="https://www.braininitiative.nih.gov/" target="_blank">NIH Brain Initiative</a> under grant R24 MH114805 (Papademetris X. and Scheinost D. PIs).</p><p>${extra}</p>`)}).catch(e=>{reject(e)})}),aboutDialog(extra=""){this.aboutText(extra).then(m=>{bootbox.alert(m)})},getWebPageImagePath:()=>genericio.getimagepath(),getWebPageURL(){let scope=window.document.URL.split("?")[0];return scope=scope.split("#")[0]},getWebPageName(){let scope=this.getWebPageURL(),index=(scope=scope.split("/").pop()).indexOf(".html");return scope=scope.substr(0,index)},getScope(){let scope=window.document.URL,index=scope.indexOf(".html");if(index>0)index=scope.lastIndexOf("/"),scope=scope.substr(0,index+1);else{let index=scope.indexOf("#");index>0&&(index=scope.lastIndexOf("/"),scope=scope.substr(0,index+1))}return scope},getTemplates:function(){return internal.templates},runAfterAllLoaded:function(clb){if("complete"!=document.readyState)if(window.attachEvent)window.attachEvent("onload",clb);else if(window.onload){let currentOnLoad=window.onload,newOnload=event=>{currentOnLoad(event),clb()};window.onload=newOnload}else window.onload=clb;else clb()},defineElement:function(name,classtype){try{window.customElements.define(name,classtype)}catch(e){console.log("error defining ",name," error=",e)}},loadJavaScriptModule:function(url){return new Promise((resolve,reject)=>{let apiTag=document.createElement("script");apiTag.src=url,apiTag.onload=(()=>{console.log(" URL=",url)}),apiTag.onerror=(e=>{reject("Failed to load tfjs module"+e)}),document.head.appendChild(apiTag)})},getQueryParameter:function(name,url){url||(url=window.location.href),name=name.replace(/[[\]]/g,"\\$&");let results=new RegExp("[?&]"+name+"(=([^&#]*)|&|#|$)").exec(url);return results?results[2]?decodeURIComponent(results[2].replace(/\+/g," ")):"":null}};if("undefined"!=typeof document){let newDiv=document.createElement("div");newDiv.innerHTML='\n      \x3c!-- panel template --\x3e\n\n      <template id="bispanel">\n      \x3c!-- Begin Panel --\x3e\n      <div class="panel panel-default">\n      <div class="panel-heading" role="tab" id="heading">\n      <h4 class="panel-title">\n      <a data-toggle="collapse" data-parent="#parent" href="#contents" aria-expanded="false" aria-controls="contents">\n      Collapsible Group Item #1\n</a>\n    </h4>\n    </div>\n    <div id="contents" class="panel-collapse collapse" role="tabpanel" aria-labelledby="heading">\n    <div class="panel-body">\n    Hello\n</div>\n    </div>\n    </div>\n    \x3c!-- End Panel --\x3e\n    </template>\n\n    <template id="bismodal">\n    \x3c!-- Begin Modal --\x3e\n       <div class="modal fade">\n         <div class="modal-dialog">\n           <div class="modal-content">\n             <div class="modal-header">\n                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>\n                <h4 class="modal-title">Modal title</h4>\n             </div>\n             <div class="modal-body">\n             </div>\n             <div class="modal-footer">\n               <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>\n             </div>\n           </div>\x3c!-- /.modal-content --\x3e\n         </div>\x3c!-- /.modal-dialog --\x3e\n       </div>\x3c!-- /.modal --\x3e\n    \x3c!-- End Modal --\x3e\n    </template>\n\n\n    <template id="bisdialog">\n    \x3c!-- Begin Non Modal --\x3e\n  <div class="modal-dialog">\n    <div class="modal-content">\n       <div class="modal-header">\n\n          <button type="button" class="bistoggle"><span class="glyphicon glyphicon-remove"></span></button>\n              <h4 class="modal-title">Modal title</h4>\n       </div>\n       <div class="modal-body">\n       </div>\n       <div class="modal-footer">\n          <button type="button" class="btn btn-sm btn-default" data-dismiss="modal">Close</button>\n       </div>\n    </div>\x3c!-- /.modal-content --\x3e\n  </div>\n    \x3c!-- End Non Modal --\x3e\n    </template>\n\n    \x3c!-- Scrollable table --\x3e\n\n    <template id="bisscrolltable">\n    <div style="margin: 0px">\n    <div class="table-responsive" style="margin: 1px">\n    <table class="table table-striped table-hover table-condensed" style="margin: 0px">\n    <thead class="bisthead">\n    <td>Title 1</td>\n    <td>Title 2</td>\n    <td>Title 3</td>\n    </thead>\n    </table>\n    </div>\n    <div class="table-responsive bistscroll" style="padding: 0px; margin:0 px">\n    <table class="table table-hover table-striped table-condensed table-scrollable">\n    <tbody class="bistbody">\n    <tr>\n    <td>Help 1</td>\n    <td>Help 2</td>\n    <td>Help 3</td>\n    </tr>\n    <tr>\n    <td>Help 11</td>\n    <td>Help 12</td>\n    </tr>\n    <tr>\n    <td>Help 21</td>\n    <td>Help 22</td>\n    </tr>\n    <tr>\n    <td>Help 31</td>\n    <td>Help 32</td>\n    </tr>\n    </tbody>\n    </table>\n    </div>\n    </div>\n    </template>',internal.templates={bispanel:newDiv.querySelector("#bispanel"),bismodal:newDiv.querySelector("#bismodal"),bisdialog:newDiv.querySelector("#bisdialog"),bisscrolltable:newDiv.querySelector("#bisscrolltable")}}module.exports=webutil},"./js/coreweb/bisweb_apputilities.js":function(module,exports,__webpack_require__){"use strict";const genericio=__webpack_require__("./js/core/bis_genericio.js"),webutil=__webpack_require__("./js/coreweb/bis_webutil.js");let imagepath=webutil.getWebPageImagePath();module.exports={createMNIImageLoadMenuEntries:function(fmenu,callback,viewerno=0){webutil.createMenuItem(fmenu,"Load MNI T1 (1mm)",function(){callback(`${imagepath}/MNI_T1_1mm_stripped_ras.nii.gz`,viewerno)}),webutil.createMenuItem(fmenu,"Load MNI T1 (2mm)",function(){callback(`${imagepath}/MNI_T1_2mm_stripped_ras.nii.gz`,viewerno)})},createBroadmannAtlasLoadMenuEntries:function(fmenu,callback,viewerno=0){webutil.createMenuItem(fmenu,"Load Yale Brodmann Atlas (1mm)",function(){callback(`${imagepath}/yale_broadmann_ras.nii.gz`,viewerno)}),webutil.createMenuItem(fmenu,"Load Yale Brodmann Atlas (2mm)",function(){callback(`${imagepath}/yale_broadmann_2mm_ras.nii.gz`,viewerno)})},saveImage:function(img,fname,name){null!==img?(fname||webutil.inElectronApp()?fname?"object"==typeof fname&&!1===fname.hasOwnProperty("responseFunction")&&(fname=img.getFilename()||"outputimage.nii.gz"):fname="outputimage.nii.gz":fname=null,img.save(fname).then(f=>{genericio.isSaveDownload()||webutil.createAlert(name+" saved in "+f)}).catch(e=>{webutil.createAlert("failed to save "+name+" ("+e+")",!0)})):webutil.createAlert("No "+name+" in memory!",!0)}}},"./js/coreweb/bisweb_custommodule.js":function(module,exports,__webpack_require__){"use strict";const parser=__webpack_require__("./js/coreweb/bisweb_webparser.js"),webutil=__webpack_require__("./js/coreweb/bis_webutil.js"),webfileutil=__webpack_require__("./js/coreweb/bis_webfileutil.js"),BiswebImage=__webpack_require__("./js/dataobjects/bisweb_image.js"),$=__webpack_require__("jquery"),bootbox=__webpack_require__("./node_modules/bootbox/bootbox.js"),bisgenericio=__webpack_require__("./js/core/bis_genericio.js"),BisWebPanel=__webpack_require__("./js/coreweb/bisweb_panel.js");let ModuleList={};module.exports={createCustom:function(parent,algorithmcontroller,mod,opts={}){return new class{constructor(layoutcontroller,mod,algocontroller,opts={}){0!==opts.numViewers&&(opts.numViewers=opts.numViewers||1),!1!==opts.showfirsttime&&(opts.showfirsttime=!0),this.module=mod,this.algocontroller=algocontroller,this.moduleOptions=opts,this.dockWidget=null,this.layoutcontroller=null,this.dirtyInputs=!0,this.guiVars=void 0,this.inputVars={},this.outputVars={},this.parameterControllers=null,this.inputControllers={};let description=this.module.getDescription();this.name=opts.name||description.dialogname||description.name,this.dual=opts.dual||!1,this.panel=new BisWebPanel(layoutcontroller,{name:this.name,width:250,hasfooter:!1,dual:this.dual}),this.basewidget=webutil.creatediv({parent:this.panel.getWidget(),css:{"padding-top":"10px","padding-left":"2px"}}),this.footer=webutil.creatediv({parent:this.panel.getWidget(),css:{"padding-top":"20px","padding-left":"2px"}}),ModuleList[this.name]=this,this.threadmanager=$("bisweb-webworkercontroller")[0]||null}getPanel(){return this.panel}show(){this.panel?(this.dirtyInputs=!0,this.createOrUpdateGUI(),this.panel.show()):console.log("No panel")}getDescription(){return this.module.getDescription()}getVars(){return this.guiVars}getViewerFromName(vars,inpname){let contkey=parser.getControllerKey(inpname,"viewer"),viewer="viewer1";try{vars[contkey].indexOf("2")>=0&&(viewer="viewer2")}catch(e){}return viewer}getTypeFromName(vars,inpname){let source="image";return"overlay"===vars[parser.getControllerKey(inpname,"source")]&&(source="overlay"),source}handleUndo(){this.algocontroller.undoImage(!0)}handleRedo(){this.algocontroller.undoImage(!1)}getCurrentInputObjects(forceupdate=!0){let inputs={};return this.module.getDescription().inputs.forEach(elem=>{let varname=elem.varname,viewer=this.getViewerFromName(this.inputVars,varname),itype=this.getTypeFromName(this.inputVars,varname),ok=!1,obj=this.algocontroller.getImage(viewer,itype);if("image"===elem.type){let input_object=this.module.inputs[varname]||null;forceupdate||null===input_object?null!==obj&&null!==obj.getImageData()&&obj.getImageData().length>2&&(ok=!0):null!==input_object&&(ok=!0,obj=input_object)}else if("transformation"===elem.type||"transform"===elem.type){let name=this.inputVars[elem.varname];obj=this.algocontroller.getTransform(name),ok=!0}ok&&(inputs[varname]=obj)}),inputs}updateModuleGUIFromInputObjects(){let inputelements=this.getCurrentInputObjects(),description=this.module.updateOnChangedInput(inputelements,this.guiVars,this.parameterControllers);if(this.module.recreateGUI){let dict=parser.recreateParameterGUI(this.generatedContent,description);this.parameterControllers=dict.controllers,this.module.recreateGUI=!1}if(this.module.mouseobserver){let varname=this.module.getDescription().inputs[0].varname,viewer=this.getViewerFromName(this.inputVars,varname),coords=this.algocontroller.getViewerCrossHairs(viewer);this.updateCrossHairs(coords)}}updateCrossHairs(coords){this.module.setViewerCoordinates(this.parameterControllers,this.guiVars,coords)}resetParameters(){this.module.getDescription().params.forEach(param=>{let v=param.default;this.guiVars[param.varname]=v,this.parameterControllers[param.varname].updateDisplay()})}loadParameters(fobj){let description=this.module.getDescription();this.module.loadParameters(fobj).then(obj=>{description.params.forEach(param=>{let varname=param.varname;obj[varname]&&(this.guiVars[varname]=obj[varname],this.parameterControllers[varname].updateDisplay())}),this.updateModuleGUIFromInputObjects()}).catch(e=>{let fname=bisgenericio.getFixedLoadFileName(fobj);webutil.createAlert(`Failed to load parameters from ${fname} (${e})`,!0)})}getInitialFilename(){let date=new Date,year=date.getFullYear(),month=date.getMonth()+1;month=(month<10?"0":"")+month;let day=date.getDate(),extra=year+"_"+month+"_"+(day=(day<10?"0":"")+day);return this.module.name+"_"+extra+".param"}saveParameters(fobj=null){"None"===(fobj=bisgenericio.getFixedSaveFileName(fobj,"None"))&&(fobj=this.getInitialFilename()),this.module.saveParameters(fobj,this.guiVars)}createOrUpdateGUI(){const self=this;if(null===this.parameterControllers){let description=this.module.getDescription(),generatedContent=parser.parseDescriptionAndCreateGUI(this.basewidget,this.footer,description,this.moduleOptions.numViewers);this.generatedContent=generatedContent,this.inputVars=generatedContent.inputVars,this.outputVars=generatedContent.outputVars,this.inputControllers=generatedContent.inputControllers,this.moduleOptions.numViewers<1?(generatedContent.inputFolder.domElement.remove(),generatedContent.outputFolder.domElement.remove()):Object.keys(this.inputVars).forEach(key=>{"autoupdate"!==key&&this.inputControllers[key].onChange(()=>{self.updateModuleGUIFromInputObjects()})}),this.guiVars=generatedContent.guiVars,this.parameterControllers=generatedContent.controllers;let enableUI=(status=!1)=>{webutil.enablebutton(generatedContent.runbutton,status),webutil.enablebutton(generatedContent.undobutton,status)};generatedContent.runbutton[0].addEventListener("click",e=>{e.preventDefault(),enableUI(!1),this.panel.makeActive(!0),webutil.createAlert("Invoking Module "+self.module.name,"progress",10,1e5),setTimeout(()=>{this.executeModule().then(()=>{this.panel.makeActive(!1),$(".alert-success").remove(),enableUI(!0)}).catch(e=>{e.stack&&console.log(e.stack),enableUI(!0),bootbox.alert(e)})},100)}),generatedContent.undobutton[0].addEventListener("click",e=>{e.preventDefault(),this.handleUndo()});let dropmenu=generatedContent.dropmenu;null!==dropmenu&&(webutil.createDropdownItem(dropmenu,"Reset Parameters",function(){self.resetParameters()}),webfileutil.createDropdownFileItem(dropmenu,"Load Parameters",function(f){self.loadParameters(f)},{filters:[{name:"Parameter Files",extensions:["param"]}],title:"Load Parameters",save:!1,suffix:"param"}),webfileutil.createDropdownFileItem(dropmenu,"Save Parameters",function(f){self.saveParameters(f)},{title:"Save Parameters",save:!0,filters:[{name:"Parameter Files",extensions:["param"]}],suffix:"param",initialCallback:()=>self.getInitialFilename()}),description.url&&webutil.createDropdownItem(dropmenu,"Help",function(){document.createElement("bisweb-helpvideoelement").displayVideo(description.url)}))}this.updateModuleGUIFromInputObjects()}moduleDone(inputParams,outputs){webutil.createAlert(`Module ${this.module.getDescription().name} done`);let count=0;this.module.getDescription().outputs.forEach(opt=>{let outobj=outputs[opt.varname];if(outobj){let outputCreationInfo="Generated by "+this.module.getDescription().name+" on "+webutil.createTimestamp();if(outobj instanceof BiswebImage&&void 0!==opt.guiviewer){let viewername=this.getViewerFromName(this.outputVars,opt.varname),itype=this.getTypeFromName(this.outputVars,opt.varname),ctype=opt.colortype||"Auto";this.algocontroller.handleUpdate(outobj,{viewername:viewername,viewersource:itype,colortype:ctype,savename:outobj.getFilename(),saveinput:!1,inputinfo:{description:outputCreationInfo}})}else"transform"===outobj.getObjectType()?this.algocontroller.handleUpdate(outobj,{savename:outobj.getFilename(),saveinput:!0,inputinfo:{description:outputCreationInfo}}):"text"===outobj.getObjectType()&&1===(count+=1)&&this.showText(outobj,"Module "+this.module.getDescription().name+" done.")}}),this.module.cleanupMemory(this.inputVars.autoupdate)}executeModule(){let inputParams=this.getVars(),force=this.inputVars.autoupdate;this.dirtyInputs&&(force=!0),this.dirtyInputs=!1;let inputObjects=this.getCurrentInputObjects(force);return new Promise((resolve,reject)=>{this.module.execute(inputObjects,inputParams).then(()=>{let outputs={};this.getDescription().outputs.forEach(opt=>{let obj=this.module.getOutputObject(opt.varname);outputs[opt.varname]=obj||void 0}),this.moduleDone(inputParams,outputs),resolve()}).catch(e=>{reject(e)})})}executeModuleInWorker(){if(!1===this.module.useworker||null===this.threadmanager)return this.executeModule();console.log("wwww Running in Web Worker Module",this.threadmanager);let inputParams=this.getVars(),force=this.inputVars.autoupdate;this.dirtyInputs&&(force=!0),this.dirtyInputs=!1;let inputObjects=this.getCurrentInputObjects(force);const self=this;return new Promise((resolve,reject)=>{this.threadmanager.executeModule(self.module.name,inputObjects,inputParams).then(outputs=>{this.moduleDone(inputParams,outputs),resolve()}).catch(e=>{console.log(e,e.stack),reject(e)})})}showText(obj,title="Output Information"){let txt=obj.getText();if(txt.length<1)return;$(".alert-success").remove(),$(".alert-info").remove(),txt=(txt=(txt=txt.replace(/\n---\n/g,"<HR>")).replace(/\n/g,"<BR>").replace(/\t/g,"&nbsp;&nbsp;&nbsp;&nbsp;")).replace(/\\n/g,"<BR>").replace(/\\t/g,"&nbsp;&nbsp;&nbsp;&nbsp;"),console.log(obj.getText(),"---\x3e\n",txt);const output=`<div style="margin-left:5px; margin-right:5px; margin-top:5px; overflow-y: auto; position:relative; color:#fefefe; width:100%; background-color:#000000;">${txt}</div>`;return bootbox.dialog({title:title,message:output,buttons:{ok:{label:"Save To File",className:"btn-success",callback:function(){bisgenericio.write({filename:"log.txt",title:"Select file to save snapshot in",suffix:"txt",filters:[{name:"Text Files",extensions:["txt"]}]},output,!1)}},cancel:{label:"Close",className:"btn-danger"}}}),!1}}(parent,mod,algorithmcontroller,opts)},updateModules:function(){let panels=BisWebPanel.getActivePanels();for(let i=0;i<panels.length;i++)if(panels[i]){let mod=ModuleList[panels[i].options.name];mod&&mod.createOrUpdateGUI()}}}},"./js/coreweb/bisweb_dbase.js":function(module,exports,__webpack_require__){"use strict";const localforage=__webpack_require__("./node_modules/localforage/dist/localforage.js");localforage.config({driver:localforage.INDEXEDDB,name:"BioImageSuiteWeb",version:1,storeName:"bispreferences",description:"BioImageSuite Web preferences"});let getItem=function(key){return localforage.getItem(key)},setItem=function(key,value){return localforage.setItem(key,value)},getAllKeys=function(){return localforage.keys()};const dbase={setItem:setItem,getItem:getItem,getItems:function(arr){let p=[];for(let i=0;i<arr.length;i++)p.push(getItem(arr[i]));let obj=[];return new Promise((resolve,reject)=>{Promise.all(p).then(results=>{for(let i=0;i<arr.length;i++)obj[arr[i]]=results[i];resolve(obj)}).catch(e=>{reject(e)})})},setItems:function(obj){let keys=Object.keys(obj),p=[];for(let i=0;i<keys.length;i++)p.push(setItem(keys[i],obj[keys[i]]));return Promise.all(p)},removeItem:function(key){return localforage.removeItem(key)},clearAll:function(){return localforage.clear()},getAllKeys:getAllKeys,printAllKeys:function(){getAllKeys().then(obj=>{let k=Object.keys(obj);for(let i=0;i<k.length;i++)console.log("++++ DBase["+k[i]+"]="+obj[k[i]]);console.log("\n")}).catch(e=>{console.log(e)})}};module.exports=dbase},"./js/coreweb/bisweb_fileserverclient.js":function(module,exports,__webpack_require__){const $=__webpack_require__("jquery"),webutil=__webpack_require__("./js/coreweb/bis_webutil.js"),wsutil=__webpack_require__("./js/core/bis_wsutil.js"),bisweb_simplefiledialog=__webpack_require__("./js/coreweb/bisweb_simplefiledialog.js"),BisFileServerClient=__webpack_require__("./js/core/bis_fileserverclient.js");module.exports=class extends BisFileServerClient{constructor(){super(),this.hasGUI=!0,this.fileDialog=null,this.passwordid=null,this.authenticateModal=null}alertEvent(name,error=!1){webutil.createAlert(name,error)}retryAuthenticationDialog(){$("#"+this.passwordid).val(""),this.authenticateModal.header.find(".modal-title").text("Please try again")}showAuthenticationDialog(title="Connect To BisWeb Server"){if(!this.authenticateModal){let hid=webutil.getuniqueid(),pid=webutil.getuniqueid(),passwordEntryBox=$(`\n                <div class='form-group'>\n                    <label for='server'>Host:</label>\n                                 <input type='text' class = 'form-control' id='${hid}' value="localhost:${wsutil.initialPort}">\n                </div>\n                <div class='form-group'>\n                    <label for='filename'>Password:</label>\n                    <input type='text' class = 'form-control' id='${pid}'>\n                </div>\n            `);this.authenticateModal=webutil.createmodal("Connect To BisWeb Server","modal-sm"),this.authenticateModal.dialog.find(".modal-footer").find(".btn").remove(),this.authenticateModal.body.append(passwordEntryBox);let confirmButton=webutil.createbutton({name:"Connect",type:"btn-success"}),cancelButton=webutil.createbutton({name:"Cancel",type:"btn-danger"});this.authenticateModal.footer.append(confirmButton),this.authenticateModal.footer.append(cancelButton),$(cancelButton).on("click",()=>{this.authenticateModal.dialog.modal("hide")}),$(confirmButton).on("click",()=>{let hst=$("#"+hid).val();this.password=$("#"+pid).val(),this.hostname!==hst?(this.hostname=hst,this.connectToServer("ws://"+this.hostname)):setTimeout(()=>{this.sendPassword(this.password)},10)}),this.passwordid=pid}$("#"+this.passwordid).val(""),null!==title&&this.authenticateModal.header.find(".modal-title").text(title),this.authenticateModal.dialog.modal("show")}hideAuthenticationDialog(){this.authenticateModal&&this.authenticateModal.dialog.modal("hide")}showFileDialog(payload,opts=null){this.fileDialog||(this.fileDialog=new bisweb_simplefiledialog,this.fileDialog.fileListFn=this.requestFileList.bind(this)),this.lastdirectory=payload.path,this.fileDialog.fileRequestFn=opts.callback,opts.startDirectory=payload.path,opts.rootDirectory=payload.root,opts.server="server",this.fileDialog.openDialog(payload.data,opts)}}},"./js/coreweb/bisweb_mni2talbase.js":function(module,exports,__webpack_require__){"use strict";const genericio=__webpack_require__("./js/core/bis_genericio.js"),webfileutil=__webpack_require__("./js/coreweb/bis_webfileutil.js"),webutil=__webpack_require__("./js/coreweb/bis_webutil.js"),BisWebMatrix=__webpack_require__("./js/dataobjects/bisweb_matrix.js"),$=__webpack_require__("jquery"),imagepath=webutil.getWebPageImagePath();let bisweb_mni2tal={MNI:[90,90,72],DIMENSIONS:[181,217,181],MNIMIN:[-90,-126,-72],MNIMAX:[90,90,108],MNIFLIP:[!0,!0,!1],convertMNIToSlice:function(plane,value){let a=Math.round(value);return bisweb_mni2tal.MNIFLIP[plane]&&(a=-value),a+bisweb_mni2tal.MNI[plane]},convertSliceToMNI:function(plane,value){let mni=Math.round(value)-bisweb_mni2tal.MNI[plane];return bisweb_mni2tal.MNIFLIP[plane]&&(mni=-mni),mni},BRODMANNLABELS:{1:"PrimSensory (1)",4:"PrimMotor (4)",5:"SensoryAssoc (5)",6:"BA6",7:"BA7",8:"BA8",9:"BA9",10:"BA10",11:"BA11",13:"Insula (13)",14:"BA14",17:"PrimVisual (17)",18:"VisualAssoc (18)",19:"BA19",20:"BA20",21:"BA21",22:"BA22",23:"BA23",24:"BA24",25:"BA25",30:"BA30",31:"BA31",32:"BA32",34:"BA34",36:"Parahip (36)",37:"Fusiform (37)",38:"BA38",39:"BA39",40:"BA40",41:"PrimAuditory (41)",44:"BA44",45:"BA45",46:"BA46",47:"BA47",48:"Caudate (48)",49:"Putamen (49)",50:"Thalamus (50)",51:"GlobPal (51)",52:"NucAccumb (52)",53:"Amygdala (53)",54:"Hippocampus (54)",55:"Hypothalamus (55)"},BRODMANINDICES:[1,4,5,6,7,8,9,10,11,13,17,18,19,20,21,22,23,24,25,30,31,32,34,36,37,38,39,40,41,44,45,46,47,48,49,50,51,52,53,54,55],BRODLOCATIONS:[1,131,117,119,50,117,119,4,128,108,117,54,109,120,5,105,123,120,76,123,120,6,118,91,123,62,92,124,7,113,150,133,72,151,127,8,112,64,117,67,66,116,9,125,51,103,51,56,109,10,113,35,79,67,35,76,11,102,53,53,79,52,53,13,134,86,72,48,86,71,17,101,168,81,79,171,79,18,119,182,74,71,182,74,19,134,165,77,45,165,83,20,138,107,41,43,104,38,21,150,117,63,31,115,59,22,144,109,73,33,110,73,23,99,135,96,80,135,96,24,95,85,103,85,89,104,25,97,73,58,85,73,59,30,102,135,80,78,133,80,31,98,138,111,82,139,110,32,96,57,88,85,51,92,34,121,87,57,62,87,55,36,116,109,47,64,110,50,37,137,141,58,43,142,60,38,130,79,42,47,77,42,39,136,149,103,44,150,105,40,141,123,106,37,122,105,41,140,111,79,38,109,79,44,139,78,89,42,77,89,45,136,64,79,43,63,78,46,133,52,84,44,52,80,47,128,60,60,50,59,59,48,104,77,83,79,77,82,49,115,87,71,64,87,71,50,100,109,78,81,107,78,51,109,90,70,70,90,70,52,100,80,60,79,81,61,53,111,91,50,66,90,51,54,118,112,58,61,109,57,55,93,91,61,86,92,61],SliceViewer:class{constructor(parent,name,width,height,plane){this.parentWidget=parent,this.myCanvas=null,this.lineCanvas=null,this.myCanvasContext=null,this.lineCanvasContext=null,this.width=-1,this.height=-1,this.imgwidth=-1,this.imgheight=-1,this.imgslices=-1,this.myplane=0,this.myImage=null,this.overlayImage=null,this.linecolors=["#ee0000","#00ee00","#0000ee"],this.current_slice=-1,this.current_horizontal=-1,this.current_vertical=-1,this.drawlines=!1,this.drawoverlay=!1,this.drawimage=!1,this.overlayopacity=0,this.width=width,this.height=height,this.myplane=plane,this.myCanvas=this.parentWidget.querySelector(name),this.myCanvas.width=width,this.myCanvas.height=height,this.myCanvasContext=this.myCanvas.getContext("2d"),this.myCanvasContext.fillStyle="#777000",this.myCanvasContext.fillRect(0,0,width,height)}CreateLineCanvas(name){this.lineCanvas=this.parentWidget.querySelector(name),this.lineCanvas.width=this.width,this.lineCanvas.height=this.height,this.lineCanvasContext=this.lineCanvas.getContext("2d"),this.drawlines=!0}SetImage(image,width,height,numslices){this.myImage=image,this.imgwidth=width,this.imgheight=height,this.imgslices=numslices,this.drawimage=!0,this.SetSlice(bisweb_mni2tal.MNI[this.myplane]),2==this.myplane?this.SetCrossHairs(this.imgwidth/2,this.imgheight/2,this.numslices/2):1==this.myplane?this.SetCrossHairs(this.imgwidth/2,this.numslices/2,this.imgheight/2):this.SetCrossHairs(this.numslices/2,this.imgwidth/2,this.imgheight/2)}SetOverlayImage(image){this.overlayImage=image,this.drawoverlay=!0}SetSlice(slice,force){if("undefined"===force&&(force=!1),0==this.drawimage)return;if(force)slice=Math.floor(this.current_slice);else if(slice==this.current_slice)return;if((slice<0||slice>=this.imgslices)&&(this.slice=bisweb_mni2tal.MNI[this.myplane]),this.current_slice=slice,2==this.myplane){let sourceX=this.current_slice*this.imgwidth,sourceY=0,sourceWidth=this.imgwidth,sourceHeight=this.imgheight;this.drawoverlay&&this.overlayopacity>.1?this.myCanvasContext.drawImage(this.overlayImage,sourceX,sourceY,sourceWidth,sourceHeight,0,0,this.width,this.height):this.drawimage&&this.myCanvasContext.drawImage(this.myImage,sourceX,sourceY,sourceWidth,sourceHeight,0,0,this.width,this.height)}else if(1==this.myplane){let sourceWidth=this.imgwidth,sourceY=this.current_slice;for(let i=0;i<this.imgheight;i++){let sourceX=i*this.imgwidth;this.drawoverlay&&this.overlayopacity>.1?this.myCanvasContext.drawImage(this.overlayImage,sourceX,sourceY,sourceWidth,1,0,this.imgheight-i-1,this.width,1):this.drawimage&&this.myCanvasContext.drawImage(this.myImage,sourceX,sourceY,sourceWidth,1,0,this.imgheight-i-1,this.width,1)}}else if(0==this.myplane){let sourceHeight=this.imgslices,sourceY=0,tx=0,ty=this.imgheight,theta=-1.5707963425;this.myCanvasContext.translate(tx,ty),this.myCanvasContext.rotate(theta);for(let i=0;i<this.imgslices;i++){let sourceX=i*this.imgwidth+this.current_slice;this.drawoverlay&&this.overlayopacity>.1?this.myCanvasContext.drawImage(this.overlayImage,sourceX,sourceY,1,sourceHeight,i,0,1,sourceHeight):this.drawimage&&this.myCanvasContext.drawImage(this.myImage,sourceX,sourceY,1,sourceHeight,i,0,1,sourceHeight)}this.myCanvasContext.rotate(-theta),this.myCanvasContext.translate(-tx,-ty)}let mni=bisweb_mni2tal.convertSliceToMNI(this.myplane,this.current_slice);this.myCanvasContext.fillStyle="#eeeeee",this.myCanvasContext.font="14px Arial",0!=this.myplane&&(this.myCanvasContext.textAlign="right",this.myCanvasContext.fillText("L",this.width-1,this.height/2),this.myCanvasContext.textAlign="left",this.myCanvasContext.fillText("R",1,this.height/2)),this.myCanvasContext.fillText("MNI "+["X","Y","Z"][this.myplane]+"="+mni,5,25)}SetCrossHairs(x,y,z){if(0==this.drawlines)return;let horizontal=0,vertical=0,hcolor=0,vcolor=0,x0=(x=Math.floor(x))+.5,y0=(y=Math.floor(y))+.5,z0=(z=Math.floor(z))+.5;switch(this.myplane){case 0:horizontal=Math.round(y0),vertical=Math.round(z0),hcolor=1,vcolor=2;break;case 1:horizontal=Math.round(x0),vertical=Math.round(z0),hcolor=0,vcolor=2;break;case 2:horizontal=Math.round(x0),vertical=Math.round(y0),hcolor=0,vcolor=1}horizontal===this.current_horizontal&&vertical===this.current_vertical||(this.current_vertical>=0&&this.lineCanvasContext.clearRect(0,this.current_vertical-1,this.width,3),this.current_horizontal>=0&&this.lineCanvasContext.clearRect(this.current_horizontal-1,0,3,this.height),this.current_horizontal=horizontal,this.current_vertical=vertical,this.lineCanvasContext.fillStyle=this.linecolors[hcolor],this.lineCanvasContext.fillRect(0,vertical,this.width,1),this.lineCanvasContext.fillStyle=this.linecolors[vcolor],this.lineCanvasContext.fillRect(horizontal,0,1,this.height))}}};bisweb_mni2tal.OrthoViewer=class{constructor(parentwidget){this.parentWidget=parentwidget,this.Viewers=null,this.Sliders=null,this.SliderLabels=null,this.TalSliderLabels=null,this.BrodmanElement=null,this.TalairachLookup=null,this.brodmannLookup=null,this.MNILookup=null,this.Mosaic=null,this.Overlay=null,this.InternalCanvas=null,this.InternalContext=null,this.CrossHairLocation=[0,0,0],this.allLoaded=!1,this.previousmouseevent=-1,this.enableTalairachLabelsUpdate=!0,this.brodlist=[]}createViewers(){let v1=new bisweb_mni2tal.SliceViewer(this.parentWidget,"#zviewer",bisweb_mni2tal.DIMENSIONS[0],bisweb_mni2tal.DIMENSIONS[1],2),v2=new bisweb_mni2tal.SliceViewer(this.parentWidget,"#yviewer",bisweb_mni2tal.DIMENSIONS[0],bisweb_mni2tal.DIMENSIONS[2],1),v3=new bisweb_mni2tal.SliceViewer(this.parentWidget,"#xviewer",bisweb_mni2tal.DIMENSIONS[1],bisweb_mni2tal.DIMENSIONS[2],0);v1.CreateLineCanvas("#zlines"),v2.CreateLineCanvas("#ylines"),v3.CreateLineCanvas("#xlines"),this.Viewers=[v3,v2,v1],v1.lineCanvas.addEventListener("mousedown",fe=>this.handleMouseEvent(2,fe,0,v1.lineCanvas)),v2.lineCanvas.addEventListener("mousedown",fe=>this.handleMouseEvent(1,fe,0,v2.lineCanvas)),v3.lineCanvas.addEventListener("mousedown",fe=>this.handleMouseEvent(0,fe,0,v3.lineCanvas)),v1.lineCanvas.addEventListener("mousemove",fe=>this.handleMouseEvent(2,fe,1,v1.lineCanvas)),v2.lineCanvas.addEventListener("mousemove",fe=>this.handleMouseEvent(1,fe,1,v2.lineCanvas)),v3.lineCanvas.addEventListener("mousemove",fe=>this.handleMouseEvent(0,fe,1,v3.lineCanvas)),v1.lineCanvas.addEventListener("mouseup",fe=>this.handleMouseEvent(2,fe,2,v1.lineCanvas)),v2.lineCanvas.addEventListener("mouseup",fe=>this.handleMouseEvent(1,fe,2,v2.lineCanvas)),v3.lineCanvas.addEventListener("mouseup",fe=>this.handleMouseEvent(0,fe,2,v3.lineCanvas)),v1.lineCanvas.addEventListener("mouseleave",fe=>this.handleMouseEvent(2,fe,2,v1.lineCanvas)),v2.lineCanvas.addEventListener("mouseleave",fe=>this.handleMouseEvent(1,fe,2,v2.lineCanvas)),v3.lineCanvas.addEventListener("mouseleave",fe=>this.handleMouseEvent(0,fe,2,v3.lineCanvas)),v1.lineCanvas.addEventListener("onTouchStart",fe=>this.handleMouseEvent(2,fe,0,v1.lineCanvas)),v2.lineCanvas.addEventListener("onTouchStart",fe=>this.handleMouseEvent(1,fe,0,v2.lineCanvas)),v3.lineCanvas.addEventListener("onTouchStart",fe=>this.handleMouseEvent(0,fe,0,v3.lineCanvas)),v1.lineCanvas.addEventListener("onTouchEnd",fe=>this.handleMouseEvent(2,fe,2,v1.lineCanvas)),v2.lineCanvas.addEventListener("onTouchEnd",fe=>this.handleMouseEvent(1,fe,2,v2.lineCanvas)),v3.lineCanvas.addEventListener("onTouchEnd",fe=>this.handleMouseEvent(0,fe,2,v3.lineCanvas)),v1.lineCanvas.addEventListener("touchLeave",fe=>this.handleMouseEvent(2,fe,2,v1.lineCanvas)),v2.lineCanvas.addEventListener("touchLeave",fe=>this.handleMouseEvent(1,fe,2,v2.lineCanvas)),v3.lineCanvas.addEventListener("touchLeave",fe=>this.handleMouseEvent(0,fe,2,v3.lineCanvas))}createGUI(){this.createSliders(),this.createMNITextLabels(),this.createTalTextLabels(),this.createMiscElements(),this.createBatchCallback()}createSliders(){let axialslider=this.parentWidget.querySelector("#zcontrols"),coronalslider=this.parentWidget.querySelector("#ycontrols"),sagslider=this.parentWidget.querySelector("#xcontrols");this.Sliders=[sagslider,coronalslider,axialslider],this.Sliders[0].addEventListener("change",()=>this.setSliderCrossHairs(0)),this.Sliders[1].addEventListener("change",()=>this.setSliderCrossHairs(1)),this.Sliders[2].addEventListener("change",()=>this.setSliderCrossHairs(2))}createMNITextLabels(){let sagnumber=this.parentWidget.querySelector("#mnix"),cornumber=this.parentWidget.querySelector("#mniy"),axnumber=this.parentWidget.querySelector("#mniz");this.SliderLabels=[sagnumber,cornumber,axnumber],this.SliderLabels[0].addEventListener("change",()=>this.setTextCrossHairs(0)),this.SliderLabels[1].addEventListener("change",()=>this.setTextCrossHairs(1)),this.SliderLabels[2].addEventListener("change",()=>this.setTextCrossHairs(2)),this.parentWidget.querySelector("#mnigo").addEventListener("click",()=>this.setAllMNICoordinates())}createTalTextLabels(){let tal0=this.parentWidget.querySelector("#talx"),tal1=this.parentWidget.querySelector("#taly"),tal2=this.parentWidget.querySelector("#talz");this.TalSliderLabels=[tal0,tal1,tal2];for(let i=0;i<=2;i++)this.TalSliderLabels[i].addEventListener("change",()=>this.setTalairach());this.parentWidget.querySelector("#talgo").addEventListener("click",()=>this.setTalairach())}computeBatchConversion(fname,mni2tal=!0){const self=this;let show=async function(matrix,row,delay=1e3){let x=parseInt(matrix[row][0]),y=parseInt(matrix[row][1]),z=parseInt(matrix[row][2]);return mni2tal?self.setMNICoordinates(x,y,z):(self.TalSliderLabels[0].value=x,self.TalSliderLabels[1].value=y,self.TalSliderLabels[2].value=z,self.setTalairach()),new Promise(resolve=>{setTimeout(()=>{let v=parseInt(self.BrodmanElement.value),found=0,k=1;for(;k<self.brodlist.length&&found<1;)v===self.brodlist[k][0]&&(found=k),k+=1;let s=self.brodlist[found][1],out=null;out=mni2tal?[Math.round(self.TalSliderLabels[0].value),Math.round(self.TalSliderLabels[1].value),Math.round(self.TalSliderLabels[2].value)]:[Math.round(self.SliderLabels[0].value),Math.round(self.SliderLabels[1].value),Math.round(self.SliderLabels[2].value)];let outstr=`${x},${y},${z},${s},${out[0]},${out[1]},${out[2]}\n`;resolve(outstr)},delay)})},newmat=new BisWebMatrix;newmat.load(fname).then(()=>{let f2=genericio.getFixedLoadFileName(fname),sz=newmat.getDimensions();if(3!==sz[1]||sz[0]<1)return void webutil.createAlert("Bad Matrix Coordinates file"+f2+" number of columns is not 3 or no rows. Actual dims=("+sz.join(",")+")",!0);mni2tal?webutil.createAlert("Loaded "+sz[0]+" points. Converting MNI &rarr; TAL ..."):webutil.createAlert("Loaded "+sz[0]+" points. Converting TAL &rarr; MNI...");let m=newmat.getNumericMatrix();self.parentWidget.querySelector("#showoverlaybutton").checked=!0,self.setOverlayOpacity(!0),async function(matrix,sz){if(sz[0]<1)return;let delay=Math.round(5e3/sz[0]);delay>1e3&&(delay=1e3);let output="#MNIX,MNIY,MNIZ,BA,TALX,TALY,TALZ\n";mni2tal||(output="#TALX,TALY,TALZ,BA,MNIX,MNIY,MNIZ\n");for(let i=0;i<sz[0];i++){let out=await show(matrix,i,delay);output+=out}webutil.inElectronApp()?webfileutil.electronFileCallback({filename:"converted.csv",title:"Select file to save output to",filters:[{name:"CSV Files",extensions:["csv"]}],save:!0,suffix:".csv",force:"local"},function(f){genericio.write(f,output)}):genericio.write("converted.csv",output)}(m,sz)})}createBatchCallback(){const self=this;let b1=this.parentWidget.querySelector("#batch");webfileutil.attachFileCallback($(b1),function(f){self.computeBatchConversion(f,!0)},{filename:"",title:"Select file to load MNI coordinates from",filters:[{name:"CSV/Text File",extensions:["csv","txt"]}],save:!1,suffix:".csv,.txt",force:"local"});let b2=this.parentWidget.querySelector("#batch2");webfileutil.attachFileCallback($(b2),function(f){self.computeBatchConversion(f,!1)},{filename:"",title:"Select file to load Talairach coordinates from",filters:[{name:"CSV/Text File",extensions:["csv","txt"]}],save:!1,suffix:".csv,.txt",force:"local"})}createMiscElements(){let overlaybox=this.parentWidget.querySelector("#showoverlaybutton");overlaybox.checked=!1,overlaybox.addEventListener("change",()=>this.setOverlayOpacity(overlaybox.checked)),this.parentWidget.querySelector("#resetbutton").addEventListener("click",()=>{this.setMNICoordinates(0,0,0),overlaybox.checked=!1,this.setOverlayOpacity(!1)}),this.BrodmanElement=this.parentWidget.querySelector("#baselectbox");let n=bisweb_mni2tal.BRODMANINDICES.length,opt=document.createElement("option");opt.value="-1",opt.innerHTML="Outside defined BAs",this.BrodmanElement.appendChild(opt),this.brodlist=[],this.brodlist.push([-1,"Outside defined BAs"]);for(let i=0;i<n;i++){let opt=document.createElement("option"),opt2=document.createElement("option"),ind=bisweb_mni2tal.BRODMANINDICES[i],s=bisweb_mni2tal.BRODMANNLABELS[ind];opt.value=i,opt.innerHTML="Right-"+s,this.brodlist.push([i,"Right-"+s]),opt2.value=i+100,opt2.innerHTML="Left-"+s,this.brodlist.push([i+100,"Left-"+s]),this.BrodmanElement.appendChild(opt),this.BrodmanElement.appendChild(opt2)}this.BrodmanElement.addEventListener("change",()=>this.gotoBrodmannCentroid())}gotoBrodmannCentroid(){let a=Math.round(this.BrodmanElement.value);if(a<0)return void this.setMNICoordinates(0,0,0);let isleft=0;a>=100&&(a-=100,isleft=1);let index=7*a+(1+3*isleft);this.CrossHairLocation[0]=180-bisweb_mni2tal.BRODLOCATIONS[index],this.CrossHairLocation[1]=bisweb_mni2tal.BRODLOCATIONS[index+1],this.CrossHairLocation[2]=bisweb_mni2tal.BRODLOCATIONS[index+2],this.setSliceLocations(-1,!0)}loadImages(){const self=this;let p=[];var load_image=function(image,fname){p.push(new Promise(function(resolve,reject){image.src=fname,image.addEventListener("load",resolve),image.addEventListener("onerror",reject)}))};this.TalairachLookup=new Image,load_image(this.TalairachLookup,`${imagepath}/colin_talairach_lookup_xy.png`),this.brodmannLookup=new Image,load_image(this.brodmannLookup,`${imagepath}/yale_brod_xy.png`),this.MNILookup=new Image,load_image(this.MNILookup,`${imagepath}/tal2mni_lookup_xy.png`),this.Mosaic=new Image,load_image(this.Mosaic,`${imagepath}/MNI_T1_1mm_stripped_xy.png`),this.Overlay=new Image,load_image(this.Overlay,`${imagepath}/blend_xy.png`),Promise.all(p).then(function(){self.Viewers[2].SetImage(self.Mosaic,bisweb_mni2tal.DIMENSIONS[0],bisweb_mni2tal.DIMENSIONS[1],bisweb_mni2tal.DIMENSIONS[2]),self.Viewers[1].SetImage(self.Mosaic,bisweb_mni2tal.DIMENSIONS[0],bisweb_mni2tal.DIMENSIONS[2],bisweb_mni2tal.DIMENSIONS[1]),self.Viewers[0].SetImage(self.Mosaic,bisweb_mni2tal.DIMENSIONS[0],bisweb_mni2tal.DIMENSIONS[2],bisweb_mni2tal.DIMENSIONS[1]),self.Viewers[2].SetOverlayImage(self.Overlay),self.Viewers[1].SetOverlayImage(self.Overlay),self.Viewers[0].SetOverlayImage(self.Overlay),self.finalizeInitialization(),self.setMNICoordinates(0,0,1),self.setMNICoordinates(0,1,0),self.setMNICoordinates(1,0,0),self.setMNICoordinates(0,0,0)}).catch(e=>{console.log("Failed "+e)})}finalizeInitialization(){this.allLoaded=!0;let s=document.querySelector("#tempviewer");for(;s.firstChild;)s.removeChild(s.firstChild);this.InternalCanvas=document.createElement("canvas"),this.InternalCanvas.width=3,this.InternalCanvas.height=1,this.InternalContext=this.InternalCanvas.getContext("2d"),this.setMNICoordinates(0,0,0)}setOverlayOpacity(v){if(0==this.allLoaded)return;let value=0;v&&(value=.66);for(let i=0;i<=2;i++)this.Viewers[i].overlayopacity=value,this.Viewers[i].SetSlice(-1,!0)}setMNICoordinates(x,y,z){0!=this.allLoaded&&(this.CrossHairLocation[0]=bisweb_mni2tal.convertMNIToSlice(0,x),this.CrossHairLocation[1]=bisweb_mni2tal.convertMNIToSlice(1,y),this.CrossHairLocation[2]=bisweb_mni2tal.convertMNIToSlice(2,z),this.setSliceLocations(-1,!0))}setAllMNICoordinates(){0!=this.allLoaded&&(this.setTextCrossHairs(0,!0),this.setTextCrossHairs(1,!0),this.setTextCrossHairs(2,!0))}resetLocations(){this.setSliceLocations(0),this.setSliceLocations(1),this.setSliceLocations(2)}setTalairach(){if(0==this.allLoaded)return;let width=this.MNILookup.width,height=this.MNILookup.height;if(width<2||height<2)return;let ia=0,ja=0,ka=0;try{ia=Math.round(this.TalSliderLabels[0].value),ja=Math.round(this.TalSliderLabels[1].value),ka=Math.round(this.TalSliderLabels[2].value)}catch(err){return void this.resetLocations()}let s0=bisweb_mni2tal.convertMNIToSlice(0,ia),s1=bisweb_mni2tal.convertMNIToSlice(1,ja),s2=bisweb_mni2tal.convertMNIToSlice(2,ka);if(s0<0||s0>180||s1<0||s1>217||s2<0||s2>180)return void this.resetLocations();let voxelx=181*s2+s0,voxely=0+s1;this.InternalContext.drawImage(this.MNILookup,voxelx,voxely,1,1,2,0,1,1);let imgdata=this.InternalContext.getImageData(2,0,1,1),mni_x=imgdata.data[0]-128,mni_y=imgdata.data[1]-128,mni_z=imgdata.data[2]-128;this.enableTalairachLabelsUpdate=!1,this.setMNICoordinates(mni_x,mni_y,mni_z),this.enableTalairachLabelsUpdate=!0,this.TalSliderLabels[0].value=ia,this.TalSliderLabels[1].value=ja,this.TalSliderLabels[2].value=ka}setTextCrossHairs(plane,force){if(0==this.allLoaded)return;"undefined"===force&&(force=!1);let s=this.SliderLabels[plane].value,a=0;try{a=Math.round(s)}catch(err){return void this.resetLocations()}a<bisweb_mni2tal.MNIMIN[plane]?(a=bisweb_mni2tal.MNIMIN[plane],this.SliderLabels[plane].value=a):a>=bisweb_mni2tal.MNIMAX[plane]&&(a=bisweb_mni2tal.MNIMAX[plane],this.SliderLabels[plane].value=a),this.CrossHairLocation[plane]=bisweb_mni2tal.convertMNIToSlice(plane,a),this.setSliceLocations(plane,force)}setSliderCrossHairs(plane,force){if(0!=this.allLoaded){"undefined"===force&&(force=!1);try{for(let i=0;i<=2;i++){let s=Math.round(this.Sliders[i].value);bisweb_mni2tal.MNIFLIP[i]&&(s=bisweb_mni2tal.DIMENSIONS[i]-s-1),this.CrossHairLocation[i]=s}this.setSliceLocations(plane,force)}catch(err0){this.resetLocations()}}}setSliceLocations(plane,force){if(0==this.allLoaded)return;"undefined"===force&&(force=!1);let level0=this.CrossHairLocation[0],level1=this.CrossHairLocation[1],level2=bisweb_mni2tal.DIMENSIONS[2]-this.CrossHairLocation[2]-1,minplane=plane,maxplane=plane;-1==plane&&(minplane=0,maxplane=2);for(let pl=minplane;pl<=maxplane;pl++){let myslice=this.CrossHairLocation[pl];this.setCrossHairs(pl,level0,level1,level2,force),this.Viewers[pl].SetSlice(myslice)}for(let i=0;i<=2;i++){let a=bisweb_mni2tal.convertSliceToMNI(i,this.CrossHairLocation[i]);this.SliderLabels[i].value=0==a?"0":a;let s=this.CrossHairLocation[i];bisweb_mni2tal.MNIFLIP[i]&&(s=bisweb_mni2tal.DIMENSIONS[i]-s-1),this.Sliders[i].value=s}this.updateTextLabels(this.CrossHairLocation[0],this.CrossHairLocation[1],this.CrossHairLocation[2])}updateTextLabels(ia,ja,ka){if(0==this.allLoaded)return;let width=this.TalairachLookup.width,height=this.brodmannLookup.height;if(width<2||height<2)return;let sourceX=181*ka,voxelx2=sourceX+ia,voxelx0=sourceX+ia,voxely=0+ja;this.enableTalairachLabelsUpdate&&this.InternalContext.drawImage(this.TalairachLookup,voxelx0,voxely,1,1,0,0,1,1),this.InternalContext.drawImage(this.brodmannLookup,voxelx2,voxely,1,1,1,0,1,1);let imgdata=this.InternalContext.getImageData(0,0,2,1),brod=imgdata.data[4],origbrod=brod;if(brod>0?brod<100||brod>100&&(brod-=100):origbrod=-1,-1==origbrod)this.BrodmanElement.selectedIndex=0;else if(origbrod<100){let v=bisweb_mni2tal.BRODMANINDICES.indexOf(origbrod)+1;this.BrodmanElement.selectedIndex=2*v}else this.BrodmanElement.selectedIndex=2*bisweb_mni2tal.BRODMANINDICES.indexOf(origbrod-100)+1;if(this.enableTalairachLabelsUpdate){let tal_x=imgdata.data[0]-128,tal_y=imgdata.data[1]-128,tal_z=imgdata.data[2]-128;this.TalSliderLabels[0].value=tal_x,this.TalSliderLabels[1].value=tal_y,this.TalSliderLabels[2].value=tal_z}}setCrossHairs(plane,level1,level2,level3,force){if(0!=this.allLoaded)switch(plane){case 0:(this.Viewers[0].current_horizontal<0||force)&&this.Viewers[0].SetCrossHairs(level1,level2,level3),this.Viewers[1].SetCrossHairs(level1,level2,level3),this.Viewers[2].SetCrossHairs(level1,level2,level3);break;case 1:(this.Viewers[1].current_horizontal<0||force)&&this.Viewers[1].SetCrossHairs(level1,level2,level3),this.Viewers[2].SetCrossHairs(level1,level2,level3),this.Viewers[0].SetCrossHairs(level1,level2,level3);break;case 2:(this.Viewers[2].current_horizontal<0||force)&&this.Viewers[2].SetCrossHairs(level1,level2,level3),this.Viewers[1].SetCrossHairs(level1,level2,level3),this.Viewers[0].SetCrossHairs(level1,level2,level3)}}handleMouseEvent(plane,e,mode){if(0==this.allLoaded)return;if(2==mode)return void(this.previousmouseevent=-1);if(1==mode&&-1==this.previousmouseevent)return;0==mode&&(this.previousmouseevent=1);let w1=this.Viewers[0].width,SCALE=this.Viewers[0].myCanvas.clientWidth/w1,x=Math.round(e.offsetX/SCALE),y=Math.round(e.offsetY/SCALE);switch(plane){case 0:this.CrossHairLocation[1]=x,this.setSliceLocations(1,!0),this.CrossHairLocation[2]=bisweb_mni2tal.DIMENSIONS[2]-y-1,this.setSliceLocations(2,!0);break;case 1:this.CrossHairLocation[0]=x,this.setSliceLocations(0,!0),this.CrossHairLocation[2]=bisweb_mni2tal.DIMENSIONS[2]-y-1,this.setSliceLocations(2,!0);break;case 2:this.CrossHairLocation[0]=x,this.setSliceLocations(0,!0),this.CrossHairLocation[1]=y,this.setSliceLocations(1,!0)}}initialize(){this.createViewers(),this.createGUI(),this.loadImages()}},module.exports=bisweb_mni2tal},"./js/coreweb/bisweb_panel.js":function(module,exports,__webpack_require__){"use strict";const $=__webpack_require__("jquery"),webutil=__webpack_require__("./js/coreweb/bis_webutil.js");let globalDockedPanels=[],permanentPanels=[],maxGlobalDockedPanels=4,globalSidebarPanel=null;module.exports=class{constructor(layoutcontroller=null,options={}){this.layoutController=layoutcontroller,this.options={},this.options.name=options.name||"Tool",this.options.width=parseInt(options.width)||300,this.options.initialstate=options.mode||"docked",this.options.dual=options.dual||!1,this.options.hasfooter=options.hasfooter||!1,this.options.permanent=options.permanent||!1,this.options.permanent&&(this.options.dual=!1,this.options.initialstate="docked"),this.footer=webutil.creatediv({css:{"padding-bottom":"5px","margin-top":"20px","margin-bottom":"5px","margin-left":"2px","margin-right":"2px","border-width":"2 0 0 0","padding-top":"10px",width:"100%","background-color":webutil.getpassivecolor()}}),this.widgetbase=webutil.creatediv({css:{width:"99%","padding-top":"5px","margin-left":"2px","margin-right":"2px","margin-bottom":"5px","background-color":webutil.getpassivecolor()}}),this.widget=webutil.creatediv({parent:this.widgetbase}),this.header=null,this.minimalHeader=null,this.titleNameBar=null,this.state="empty",this.dockWidget=null,this.dockWidgetHeader=null,this.dockToggleButton=null,this.dockCloseButton=null,this.sidebarToggleButton=null,this.sidebarMinimizeButton=null,this.sidebarMaximizeButton=null,this.sidebarCloseButton=null,this.dummyWidget=$("<div></div>"),this.createHeader()}getWidget(){return this.widget}getFooter(){return this.footer}show(){"empty"===this.state?"sidebar"!==this.options.initialstate?this.addToDock():this.addToSidebar():"sidebar"!==this.state?this.addToDock():this.addToSidebar()}hide(){"sidebar"!==this.state||this.drawInSidebarWithWidth(0)}isOpen(){return!("docked"!==this.state||!webutil.isCollapseElementOpen(this.dockWidget))||"sidebar"===this.state}makeActive(flag=!0){let w=this.widgetbase;if(flag)w.css({"background-color":webutil.getactivecolor()});else{let x=w.parent().css("backgroundColor");w.css({"background-color":x})}}createHeader(){if(null!==this.sidebarCloseButton)return;const self=this;if(("sidebar"===this.options.initialstate||this.options.dual)&&(this.sidebarCloseButton=$('<button type="button" class="bistoggle"><span class="glyphicon glyphicon-remove-circle"></span></button>'),this.sidebarCloseButton.click(e=>{e.preventDefault(),e.stopPropagation(),self.hide()})),("docked"===this.options.initialstate&&!this.options.permanent||this.options.dual)&&(this.dockCloseButton=$('<button type="button" class="bistoggle"><span class="glyphicon glyphicon-remove-circle"></span></button>'),this.dockCloseButton.click(e=>{e.preventDefault(),e.stopPropagation(),self.remove()})),"docked"===this.options.initialstate&&!1===this.options.dual)return;this.dockToggleButton=$('<button type="button" class="bistoggle bisflip"><span class="glyphicon glyphicon-log-out"></span></button>'),this.dockToggleButton.click(e=>(e.preventDefault(),e.stopPropagation(),self.remove(),self.addToSidebar(),self.drawInSidebarWithWidth(this.options.width+15),!1)),this.options.dual&&(this.sidebarToggleButton=$('<button type="button" class="bistoggle"><span class="glyphicon glyphicon-log-out"></span></button>'),this.sidebarToggleButton.click(e=>(e.preventDefault(),e.stopPropagation(),self.addToDock(),!1))),this.sidebarMinimizeButton=$('<button type="button" class="bistoggle"><span class="glyphicon glyphicon-resize-small"></span></button>'),this.sidebarMinimizeButton.click(e=>(e.preventDefault(),e.stopPropagation(),self.drawInSidebarWithWidth(60),!1)),this.sidebarMaximizeButton=$('<button type="button" class="bistoggle"><span class="glyphicon glyphicon-resize-full"></span></button>'),this.sidebarMaximizeButton.click(e=>(e.preventDefault(),e.stopPropagation(),self.drawInSidebarWithWidth(self.options.width+15),!1)),this.header=$("<div></div>"),this.options.name.length>10?this.header.css({height:"80px"}):this.header.css({height:"50px"}),this.minimalHeader=$("<div></div>"),this.header.css({"background-color":webutil.getpassivecolor2()});let buttonbar=webutil.creatediv({parent:this.header,css:{"margin-bottom":"5px","padding-top":"5px","margin-left":"2px","padding-right":"2px"}});this.titleNameBar=webutil.creatediv({parent:this.header,css:{"padding-bottom":"5px","padding-top":"0px","padding-left":"5px"}}),buttonbar.append(this.sidebarCloseButton),buttonbar.append(this.sidebarMinimizeButton),this.options.dual&&buttonbar.append(this.sidebarToggleButton),this.minimalHeader.append(this.sidebarMaximizeButton),this.titleNameBar.append(`<H4 style="margin-top:0px;margin-left:5px;line-height:1.5">${this.options.name}</H4>`)}addToDock(){if("docked"===this.state)return webutil.activateCollapseElement(this.dockWidget);if("sidebar"===this.state&&this.remove(),!1===this.options.permanent)for(;globalDockedPanels.length>=maxGlobalDockedPanels;)globalDockedPanels.shift().remove();if(null===this.dockWidget){this.dockWidget=this.layoutController.createDockWidget(`${this.options.name}`);let t=this.dockWidget.parent().parent().find(".panel-heading");this.dockToggleButton&&(this.dockToggleButton.css({border:"0px","font-size":"17px"}),t.prepend(this.dockToggleButton)),this.dockCloseButton&&(this.dockCloseButton.css({border:"0px","font-size":"17px"}),t.prepend(this.dockCloseButton))}return this.widgetbase.css({opacity:"1.0"}),this.dockWidget.append(this.widgetbase),this.options.hasfooter&&(this.dockWidget.append("<HR>"),this.footer.css({opacity:"1.0"}),this.dockWidget.append(this.footer)),this.state="docked",this.options.permanent?permanentPanels.push(this):globalDockedPanels.push(this),webutil.activateCollapseElement(this.dockWidget),!0}drawInSidebarWithWidth(wd){this.layoutController.setsidebarwidth(wd);let elements=this.layoutController.getSidebarElements();if(wd<100&&"empty"!==this.state)return this.dummyWidget.append(this.header),this.dummyWidget.append(this.footer),this.dummyWidget.append(this.widgetbase),wd>10?elements.header.append(this.minimalHeader):this.dummyWidget.append(this.minimalHeader),void(this.state="empty");"sidebar"!==this.state&&(this.dummyWidget.append(this.minimalHeader),elements.header.empty(),elements.header.append(this.header),elements.widget.empty(),elements.widget.append(this.widgetbase),this.options.hasfooter&&(elements.widget.append("<HR>"),elements.widget.append(this.footer)),this.state="sidebar")}addToSidebar(){if("sidebar"!==this.state)return"docked"===this.state&&this.remove(),globalSidebarPanel&&globalSidebarPanel.remove(),globalSidebarPanel=this,this.drawInSidebarWithWidth(this.options.width+15),!0;this.drawInSidebarWithWidth(this.options.width+15)}remove(){"docked"===this.state?(this.dockToggleButton&&this.dummyWidget.append(this.dockToggleButton),this.dockCloseButton&&this.dummyWidget.append(this.dockCloseButton),this.dummyWidget.append(this.widgetbase),this.dummyWidget.append(this.footer),this.dockWidget.parent().parent().remove(),this.dockWidget=null):"sidebar"===this.state&&(this.drawInSidebarWithWidth(0),globalSidebarPanel=null);let index=globalDockedPanels.indexOf(this);return index>=0&&globalDockedPanels.splice(index,1),this.state="empty",!0}static setMaxDockedPanels(n){maxGlobalDockedPanels=n}static getActivePanels(){return globalDockedPanels.concat(permanentPanels)}}},"./js/coreweb/bisweb_simplefiledialog.js":function(module,exports,__webpack_require__){const $=__webpack_require__("jquery"),bis_genericio=__webpack_require__("./js/core/bis_genericio.js"),webutil=__webpack_require__("./js/coreweb/bis_webutil.js"),bootbox=__webpack_require__("./node_modules/bootbox/bootbox.js"),userPreferences=__webpack_require__("./js/core/bisweb_userpreferences.js");__webpack_require__("./node_modules/jstree/dist/jstree.js");module.exports=class{constructor(options={}){this.separator="/",this.mode=options.mode||"load",this.modalName=options.modalName||"File Server Dialog",this.modal=null,this.okButton=null,this.filenameEntry=null,this.fileListFn=null,this.fileRequestFn=null,this.fileList=null,this.currentPath=null,this.currentDirectory=null,this.currentFilters=[{name:"All Files",extensions:[]}],this.newFilters=!0,this.activeFilterList=this.currentFilters[0].extensions,this.currentList=null,this.previousList=null,this.favorites=[],this.lastFavorite=null}getCombinedFilename(dname,fname){return dname.lastIndexOf(this.separator)!==dname.length-1?dname+this.separator+fname:dname+fname}filenameCallback(name=null){if(null===name){name="";try{name=this.filenameEntry.val()||""}catch(e){return void console.log("error",e)}}if(this.mode.indexOf("dir")>=0){if(name.length>0)return this.createDirectoryCallback(name);this.modal.dialog.modal("hide"),setTimeout(()=>{this.fileRequestFn(this.currentDirectory)},10)}if(name.length<1)return;let outname=this.getCombinedFilename(this.currentDirectory,name),sendCallback=()=>{this.modal.dialog.modal("hide"),setTimeout(()=>{this.fileRequestFn(outname)},10)};if("save"!==this.mode)return sendCallback();bis_genericio.getFileSize(outname).then(()=>{bootbox.confirm("The file "+outname+" exists. Are you sure you want to overwrite this?",result=>{result&&sendCallback()})}).catch(()=>{outname=this.addExtensionToFilnameIfNeeded(outname,this.activeFilterList),sendCallback()})}createDirectoryCallback(name){let newdir=this.getCombinedFilename(this.currentDirectory,name);bis_genericio.makeDirectory(newdir).then(()=>{this.changeDirectory(newdir),webutil.createAlert("Created directory "+newdir,!1)}).catch(e=>{webutil.createAlert(e,!0)})}changeDirectory(dname){this.fileListFn(dname,!1).then(payload=>{this.updateDialog(payload.data,payload.path,payload.root)})}createDialogUserInterface(){this.modal=webutil.createmodal(this.modalName,"modal-lg"),$("body").append(this.modal),this.contentDisplayTemplate="<div class='col-sm-9 bisweb-file-display'>\n            <div><p>Content goes here...</p></div>\n            </div>",this.container=$("<div class='container-fluid'>\n                <div class='row justify-content-start' style='margin-bottom:10px'>\n                <div class='col-sm-12 bisweb-file-navbar'></div>\n             </div>\n\n             <div class='row justify-content-start content-box'>\n                <div class='col-sm-3 favorite-bar'></div>\n                <div class='col-sm-9 bisweb-file-display'>\n                <div class='bisweb-file-list'><p>Content goes here...</p></div>\n             </div>\n\n             <div class='row justify-content-start content-box'>\n                <div class='col-sm-3 favorite-buttons'></div>\n                <div class='col-sm-9 bisweb-file-filterbar' style='margin-top:5px'></div>\n                </div>\n            </div>"),this.createFavorites(),this.okButton=$("<button type='button' class='btn btn-success'>Load</button>"),this.okButton.css({"margin-right":"10px",width:"200px"}),this.okButton.on("click",event=>{event.preventDefault(),this.filenameCallback()}),this.modal.footer.prepend(this.okButton),this.modal.body.append(this.container)}createFilters(filters=null){this.currentFilters=filters?"DIRECTORY"===filters||"directory"===filters?[{name:"Directories",extensions:[]}]:JSON.parse(JSON.stringify(filters)):[],this.currentFilters.push({name:"All Files",extensions:[]}),this.newFilters=!0,this.activeFilterList=this.currentFilters[0].extensions}openDialog(list,opts=null){null===this.modal&&this.createDialogUserInterface(),this.newFilters=!0;let startDirectory=opts.startDirectory||"",rootDirectory=opts.rootDirectory||"";if(null!==opts){if(opts.filters=opts.filters||null,this.createFilters(opts.filters),opts.title){let newtitle=opts.title;if(newtitle){let title=this.modal.header.find(".modal-title");"amazonaws"===opts.server?title.text(newtitle+" (using Amazon S3)"):title.text(newtitle+" (using bisweb fileserver)")}}opts.mode&&(this.mode=opts.mode),"save"===this.mode?this.okButton.text("Save"):this.mode.indexOf("dir")>=0?this.okButton.text("Select Directory"):this.okButton.text("Load")}let initialfilename=null;null!==opts&&opts.initialFilename&&(initialfilename=opts.initialFilename),"directory"===opts.mode&&(this.activeFilterList=["directories"]),this.updateDialog(list,startDirectory,rootDirectory,initialfilename),this.modal.dialog.modal("show")}updateDialog(list,startDirectory,rootDirectory,initialfilename=null){this.fileList=list,this.currentDirectory=startDirectory,this.currentPath=startDirectory,this.container.find(".bisweb-file-navbar").empty();let filterbar=this.container.find(".bisweb-file-filterbar");if(this.currentFilters.length<1)filterbar.empty(),this.activeFilterList=[];else if(!0===this.newFilters){filterbar.empty(),this.newFilters=!1;let filter_label=$("<span>Filter Files: </span>");filter_label.css({padding:"10px"}),filterbar.append(filter_label);let sel=webutil.createselect({parent:filterbar,values:[],callback:e=>{e.preventDefault();let ind=parseInt(e.target.value);ind>=0&&ind<this.currentFilters.length&&("Directories"===this.currentFilters[ind].name?this.activeFilterList=["directories"]:this.activeFilterList=this.currentFilters[ind].extensions,this.updateTree(this.previousList,name,rootDirectory))}});sel.empty();let addOption=b=>{sel.append($(b))};for(let i=0;i<this.currentFilters.length;i++)this.currentFilters[i].extensions.length>0?addOption(`<option value="${i}">${this.currentFilters[i].name}, (${this.currentFilters[i].extensions.join(",")})</option>`):addOption(`<option value="${i}">${this.currentFilters[i].name}</option>`)}this.updateTree(list,initialfilename,rootDirectory)}updateTree(list,lastfilename=null,rootDirectory=null){if(this.previousList=JSON.parse(JSON.stringify(list)),this.activeFilterList.length>0)for(let i=list.length-1;i>=0;i-=1)this.checkFilenameForFilter(list[i],this.activeFilterList)||list.splice(i,1);list.sort((a,b)=>{let isadir="directory"===a.type,isbdir="directory"===b.type;if(isadir&&!isbdir)return-1;if(isbdir&&!isadir)return 1;let at=a.text.toLowerCase(),bt=b.text.toLowerCase();return at>bt?1:at<bt?-1:0});let fileList=this.container.find(".bisweb-file-list");fileList.remove(),fileList=$("<div class='bisweb-file-list'></div>");let fileDisplay=this.container.find(".bisweb-file-display");fileList.empty();let templates=webutil.getTemplates(),newid=webutil.createWithTemplate(templates.bisscrolltable,$("body")),stable=$("#"+newid),thead=stable.find(".bisthead"),tbody=stable.find(".bistbody",stable);stable.find(".bistscroll",stable).css({"max-height":"300px",height:"300px","max-width":"600px",color:"#0ce3ac","background-color":"#444444"}),thead.empty(),tbody.empty(),tbody.css({"font-size":"13px","user-select":"none"}),thead.css({"font-size":"14px","user-select":"none"});let elementlist=[],callback=(e,doubleclick=!1)=>{e.preventDefault(),e.stopPropagation();let id=e.target.id;id||(id=e.target.parentElement.id)||(id=e.target.parentElement.parentElement.id);let elem=elementlist[id],fname=elem.path;if("file"===elem.type||"picture"===elem.type){let ind=fname.lastIndexOf(this.separator),dname=fname;ind>0&&(dname=fname.substr(ind+1,fname.length)),this.filenameEntry.val(dname),doubleclick&&this.filenameCallback()}else"directory"===elem.type&&this.changeDirectory(fname)},max=list.length;for(let i=0;i<max;i++){let elem=list[i],nid=webutil.getuniqueid(),name=elem.text,sz="",c="";"directory"===elem.type?(c="<span class='glyphicon glyphicon-folder-close'></span>&nbsp;",name="<B>["+name+"]</B>"):(c="<span class='glyphicon glyphicon-file'></span>&nbsp;",sz=Number.parseFloat(list[i].size/1024).toFixed(2));let w=$(`<tr>\n                    <td width="80%"><span id="${nid}">${c} ${name}</span></td>\n                    <td width="20%" align="right">${sz}</td></tr>\n                    </tr>`);tbody.append(w),$("#"+nid).click(e=>{callback(e,!1)}),$("#"+nid).dblclick(e=>{callback(e,!0)}),elementlist[nid]=elem}fileDisplay.append(fileList),fileList.append(stable),this.updateFileNavbar(lastfilename,rootDirectory)}updateFileNavbar(lastfilename=null,rootDirectory="/"){let navbar=this.modal.body.find(".bisweb-file-navbar");if(navbar.empty(),null===this.currentPath)return;let folders=null;if((rootDirectory=rootDirectory||"").length>1&&this.currentPath.length>=rootDirectory.length){let f=this.currentPath.substr(rootDirectory.length+1,this.currentPath.length).split(this.separator);folders=[rootDirectory.substr(1,rootDirectory.length)].concat(f)}else folders=this.currentPath.split(this.separator);for(let i=folders.length-1;i>=0;i-=1)folders[i].length<1&&folders.splice(i,1);for(let i=-1;i<folders.length;i++){let newPath="",b="",name="";if(-1===i&&(b="<span class='glyphicon glyphicon-folder-close'></span>"),i>=0){for(let k=0;k<=i;k++)newPath=newPath+"/"+folders[k];name=folders[i]+"/"}else newPath="[Root]",name=" [Root]";let button=$(`<button type='button' class='btn btn-sm btn-link' style='margin:0px'>${b}${name}</button>`);button.on("click",event=>{event.preventDefault(),this.changeDirectory(newPath)}),navbar.append(button)}this.filenameEntry=$('<input type=\'text\'class="btn-link btn-sm" style="width:500px; border-style : dotted; border-color: white">'),lastfilename?this.filenameEntry.val(lastfilename):this.filenameEntry.val(""),navbar.append(this.filenameEntry),this.filenameEntry.keypress(ev=>{13==ev.which&&this.filenameCallback()})}addFavorite(pillsBar,elem){let newPill=$(`<li><a href='#' class="active" style="padding: 2px 2px 2px 2px">${elem.name}</a></li>`);this.lastFavorite=elem.path,newPill.on("click",event=>{event.preventDefault(),((pill,pills)=>{for(let otherPill of pills)$(otherPill).removeClass("active");$(pill).addClass("active")})(newPill,pillsBar.find("li")),this.changeDirectory(elem.path),this.lastFavorite=elem.path}),pillsBar.append(newPill)}addAllFavorites(pillsBar){pillsBar.empty();let l=this.favorites.length;for(let i=0;i<l;i++)this.addFavorite(pillsBar,this.favorites[i]);this.lastFavorite=null}createFavorites(){let favoriteBar=this.container.find(".favorite-bar"),favoriteButtons=this.container.find(".favorite-buttons");favoriteBar.css({"max-height":"300px",height:"300px","max-width":"250px","overflow-y":"auto","overflow-x":"auto",color:"#0ce3ac","background-color":"#444444"});let favoriteButton=$("<button type='button' class='btn btn-sm btn-link'><span class='glyphicon glyphicon-star-empty'></span>Bookmark</button>");favoriteButtons.append(favoriteButton);let favoriteButton2=$("<button type='button' class='btn btn-sm btn-link'><span class='glyphicon glyphicon-remove'></span> Remove</button>");favoriteButtons.append(favoriteButton2);let pillsHTML=$("<ul class='nav nav-pills nav-stacked btn-sm'></ul>");favoriteBar.append(pillsHTML);let pillsBar=favoriteBar.find(".nav.nav-pills");favoriteButton.on("click",event=>{if(event.preventDefault(),this.favorites.length>8)return;let name=this.currentDirectory;name.length>23&&(name="___"+name.substr(name.length-23,name.length));let elem={name:name,path:this.currentDirectory};this.favorites||(this.favorites=[]);let i=0,found=!1;for(;i<this.favorites.length&&!1===found;)elem.path===this.favorites[i].path&&(found=!0),i+=1;found||(this.favorites.push(elem),this.addFavorite(pillsBar,elem),userPreferences.setItem("favoriteFolders",this.favorites,!0))}),favoriteButton2.on("click",event=>{event.preventDefault();let i=0;for(;i<this.favorites.length;){if(this.lastFavorite===this.favorites[i].path)return this.favorites.splice(i,1),this.addAllFavorites(pillsBar),userPreferences.setItem("favoriteFolders",this.favorites,!0),void(this.lastFavorite=null);i+=1}}),userPreferences.safeGetItem("favoriteFolders").then(f=>{f&&(this.favorites=f,this.addAllFavorites(pillsBar))}).catch(e=>{console.log("Error",e)})}addExtensionToFilnameIfNeeded(name,filterList){if(!filterList)return name;if(filterList.length<1)return name;for(let i=0;i<filterList.length;i++){let filter=filterList[i],nl=name.length,fl=filter.length;if(nl>fl&&name.substr(nl-fl,fl)===filter)return name}return name+"."+filterList[0]}checkFilenameForFilter(entry,filterList){let name=entry.text;if(filterList.length<1)return!0;if("directory"===filterList)return"directory"===entry.type;if(!(name.split(".").length>1))return!0;for(let i=0;i<filterList.length;i++){let filter=filterList[i],nl=name.length,fl=filter.length;if(nl>fl&&name.substr(nl-fl,fl)===filter)return!0}return!1}}},"./js/coreweb/bisweb_webparser.js":function(module,exports,__webpack_require__){"use strict";const $=__webpack_require__("jquery"),webutil=__webpack_require__("./js/coreweb/bis_webutil.js"),dat=__webpack_require__("./node_modules/dat.gui/build/dat.gui.js");let getControllerKey=function(name,type){return`${name}_${type}`},createParametersGUIInternal=function(paramGUI,advancedParamGUI,description,guiVars,dict){description.params=description.params.sort((a,b)=>a.priority-b.priority);const controller_list={};paramGUI.open();let dopass=function(pass){description.params.forEach(param=>{let adv=!0;!1===param.advanced&&(adv=!1),0===pass&&!1===adv?controller_list[param.varname]=parseParam(paramGUI,param,guiVars):1===pass&&!0===adv&&(controller_list[param.varname]=parseParam(advancedParamGUI,param,guiVars))})};for(let pass=0;pass<=1;pass++)dopass(pass);return dict.inputVars.autoupdate=!0,controller_list},parseParam=function(gui,param,guiParams){let controller={},base=gui;switch(param.gui){case"slider":{let step=param.step,low=param.lowbound||param.low,high=param.high||param.highbound;if(void 0===low&&(low=null),void 0===high&&(high=null),void 0===step&&(step=null),null!==low&&null!==high&&null!==step)if(high<low){let tmp=low;low=high,high=tmp}else high===low&&(high=low+1);"int"===param.type&&null!==step&&(step=Math.round(step))<1&&(step=1),"int"===param.type&&null===step&&(step=1),null!==low&&null!==high&&null!==step?controller=base.add(guiParams,param.varname,low,high).name(param.name).step(step):null!==low&&null!==high?controller=base.add(guiParams,param.varname,low,high).name(param.name):(controller=null!==step?base.add(guiParams,param.varname).name(param.name).step(step):base.add(guiParams,param.varname).name(param.name),null!==low&&controller.min(low),null!==high&&controller.max(high));break}case"check":case"checkbox":controller=base.add(guiParams,param.varname).name(param.name);break;case"dropdown":controller=base.add(guiParams,param.varname,param.fields).name(param.name);break;case"text":case"entrywidget":controller=base.add(guiParams,param.varname).name(param.name);break;case"tab":case"folder":controller=base.addFolder(param.name);break;default:controller=base.add(guiParams,param.varname).name(param.name)}return controller.domElement.setAttribute("data-toggle","tooltip"),controller.domElement.setAttribute("title",param.description||""),controller},initializeDefaultParams=function(description){let vars={};return description.params.forEach(item=>{if(item.varname){let name=item.varname;if(void 0!==item.default)vars[name]=item.default;else if(item.type)switch(item.type){case"bool":case"boolean":vars[name]=!1;break;case"string":vars[name]="";break;case"float":vars[name]=1;break;case"int":case"integer":vars[name]=0;break;default:vars[name]=void 0,console.log("assigning default value to item with unrecognized type")}else if(item.gui)switch(item.gui){case"slider":vars[name]=0;break;case"check":case"checkbox":vars[name]=!1;break;case"dropdown":vars[name]="";break;case"text":case"entrywidget":vars[name]="";break;default:console.log("Not adding default to complex/ambiguous gui element")}else console.log("could not assign value to untyped item with no default specified"),vars[name]=void 0}else console.log("cannot parse item without specified varname -- have you named each component?")}),vars};module.exports={parseDescriptionAndCreateGUI:function(frame,buttonFrame,description,numViewers){let gui=new dat.GUI({autoPlace:!1});webutil.removeallchildren(frame);let dict={};!function(gui,description,numViewers,dict){let numgood=0,firstname="Inputs";description.inputs.forEach(inpt=>{void 0!==inpt.guiviewer&&(0===numgood&&(firstname=inpt.name),numgood+=1)});let inputsName="Inputs";1===numgood&&numViewers>1&&(inputsName=firstname);let inputVars={},inputControllers={},inputFolder=null;numgood>0&&(inputFolder=gui.addFolder(inputsName),numgood>1&&inputFolder.open(),description.inputs.forEach(inpt=>{if(void 0!==inpt.guiviewer){let myFolder=inputFolder;if(void 0!==inpt.guiviewer)if("image"===inpt.type){if(numgood>1&&numViewers>1&&(myFolder=inputFolder.addFolder(inpt.name)),numViewers>1){let key=getControllerKey(inpt.varname,"viewer");inputVars[key]=inpt.guiviewer||"viewer1",inputControllers[key]=myFolder.add(inputVars,key,["viewer1","viewer2"]).name("Input Viewer")}let key=getControllerKey(inpt.varname,"source");inputVars[key]=inpt.guiviewertype||"image",inputControllers[key]=numViewers>1?myFolder.add(inputVars,key,["image","overlay"]).name("Input Element"):myFolder.add(inputVars,key,["image","overlay"]).name(inpt.name)}else if("transformation"===inpt.type||"transform"===inpt.type){let key=inpt.varname;inputVars[key]=inpt.guiviewer||"identity",inputControllers[key]=myFolder.add(inputVars,key,["identity","current"]).name(inpt.name)}}})),dict.inputVars=inputVars,dict.inputControllers=inputControllers,dict.inputFolder=inputFolder}(gui,description,numViewers,dict),function(gui,description,numViewers,dict){let numgood=0;description.outputs.forEach(opt=>{void 0!==opt.guiviewer&&(numgood+=1)});let outputVars={},outputFolder=null;if(numgood>0){let tmpOutputFolder=gui;(numgood>1||numViewers<2)&&(tmpOutputFolder=gui.addFolder("Outputs"),outputFolder=tmpOutputFolder),description.outputs.forEach(opt=>{if(void 0!==opt.guiviewer){let myFolder=null;if(numViewers>1?(myFolder=tmpOutputFolder.addFolder(opt.name),null===outputFolder&&(outputFolder=myFolder)):myFolder=outputFolder,void 0!==opt.guiviewer){if(numViewers>1){let key=getControllerKey(opt.varname,"viewer");outputVars[key]=opt.guiviewer||"viewer1",myFolder.add(outputVars,key,["viewer1","viewer2"]).name("Output Viewer")}let key=getControllerKey(opt.varname,"source");outputVars[key]=opt.guiviewertype||"image",numViewers>1?myFolder.add(outputVars,key,["image","overlay"]).name("Output Element"):myFolder.add(outputVars,key,["image","overlay"]).name(opt.name)}}})}dict.outputVars=outputVars,dict.outputFolder=outputFolder}(gui,description,numViewers,dict),function(gui,description,numViewers,dict){if(description.params.length<1)return dict.guiVars={},dict.mainGUI=gui,dict.advancedParamGUI=null,void(dict.controllers={});let paramGUI=gui.addFolder("Parameters"),advancedParamGUI=gui.addFolder("Advanced"),guiVars=initializeDefaultParams(description);paramGUI.open(),dict.controllers=createParametersGUIInternal(paramGUI,advancedParamGUI,description,guiVars,dict),dict.guiVars=guiVars,dict.mainGUI=gui,dict.paramGUI=paramGUI,dict.advancedGUI=advancedParamGUI}(gui,description,0,dict),description.params.length<1&&(dict.inputFolder.open(),dict.outputFolder.open()),webutil.removedatclose(gui),$(gui.domElement).css({"margin-left":"0px","margin-top":"0px","margin-bottom":"2px"}),frame.append(gui.domElement);let runButtonName=description.buttonName||"Run";return dict.runbutton=webutil.createbutton({name:runButtonName,type:"success",parent:buttonFrame,css:{"margin-right":"5px"}}),dict.runbutton[0].setAttribute("data-toggle","tooltip"),dict.runbutton[0].setAttribute("title","Execute the algorithm"),dict.undobutton=webutil.createbutton({name:"Undo",type:"warning",parent:buttonFrame}),dict.undobutton[0].setAttribute("data-toggle","tooltip"),dict.undobutton[0].setAttribute("title","Undo last operation"),description.params.length>0?dict.dropmenu=webutil.createDropdownMenu("More",buttonFrame):dict.dropmenu=null,dict},recreateParameterGUI:function(dict,description){let guiVars=dict.guiVars,paramGUI=dict.paramGUI,advancedParamGUI=dict.advancedGUI,folders=[paramGUI,advancedParamGUI];for(let folder=0;folder<=1;folder++){let f=folders[folder];for(let c=f.__controllers.length-1;c>=0;c-=1){let elem=f.__controllers[c];if(null!==elem)try{f.remove(elem)}catch(e){}}f.__controllers=[]}return dict.controllers=createParametersGUIInternal(paramGUI,advancedParamGUI,description,guiVars,dict),dict},getControllerKey:getControllerKey}},"./js/dataobjects/bis_landmarks.js":function(module,exports,__webpack_require__){"use strict";const util=__webpack_require__("./js/core/bis_util.js"),UndoStack=__webpack_require__("./js/dataobjects/bis_undostack.js");module.exports=class{constructor(undosize=0){this.points=[],this.names=[],this.color="#ffff00",this.filename="PointSet.ljson",this.size=2,undosize>0?(this.undostack=new UndoStack(undosize),this.noundo=!1):(this.undostack=null,this.noundo=!0)}getnumpoints(){return this.points.length}resetundo(){null!==this.undostack&&this.undostack.initialize()}addpoint(mm){if(this.points.push(mm),this.names.push("Point"),!this.noundo){var index=this.points.length-1;this.undostack.addOperation(["add",index,mm.slice(0),this.names[index]])}}insertpoint(index,mm,name){name=name||"Point",index<0&&(index=this.points.length-1),index<0||(this.points.splice(index,0,mm),this.names.splice(index,0,name),this.noundo||this.undostack.addOperation(["add",index,mm.slice(0),this.names[index]]))}movepoint(index,mm){if(index<0&&(index=this.points.length-1),!(index<0)){var old=this.points[index].slice(0);this.points[index]=[mm[0],mm[1],mm[2]],this.noundo||this.undostack.addOperation(["move",index,mm.slice(0),old])}}renamepoint(index,name){if(index<0&&(index=this.points.length-1),!(index<0)){var old=this.names[index];this.names[index]=name,this.noundo||this.undostack.addOperation(["rename",index,this.names[index],old])}}deletepoint(index){index<0&&(index=this.points.length-1),index<0||(this.noundo||this.undostack.addOperation(["delete",index,this.points[index].slice(0),this.names[index].slice(0)]),this.names.splice(index,1),this.points.splice(index,1))}clear(){this.points=[],this.names=[],this.resetundo()}serialize(){return JSON.stringify({bisformat:"Landmarks",points:this.points,names:this.names,color:this.color,size:this.size})}legacyserialize(){var np=this.getnumpoints(),outstring="#Landmark Data\n";outstring+="#Number of Landmarks Mode\n"+np+" 0\n",outstring+="#Origin\n 0.0 0.0 0.0\n",outstring+="#Spacing\n 1.0 1.0 1.0\n",outstring+="#Landmarks\n";for(var i=0;i<np;i++){var p=this.points[i];outstring+=util.scaledround(p[0],100)+" "+util.scaledround(p[1],100)+" "+util.scaledround(p[2],100)+"\n"}return outstring}legacydeserialize(inpstring,filename,doerror){var lines=inpstring.split("\n");if("#Landmark Data"===lines[0].trim()){for(var np=lines[2].split(" ")[0],origin=lines[4].trim().split(" "),spacing=lines[6].trim().split(" "),k=0;k<=2;k++)origin[k]=parseFloat(origin[k]),spacing[k]=parseFloat(spacing[k]);console.log("np=",np," origin=",origin," spa=",spacing),this.resetundo(),this.points=new Array(np),this.names=new Array(np);for(var pt=0;pt<np;pt++){for(var x=lines[8+pt].trim().split(" "),newp=[0,0,0],j=0;j<=2;j++)newp[j]=parseFloat(x[j])*spacing[j]+origin[j];this.points[pt]=newp,this.names[pt]="Pt"}return!0}doerror(filename+" is not a valid legacy .land file")}deserialize(jsonstring,filename,doerror){var b;if("land"==filename.split(".").pop())return this.legacydeserialize(jsonstring,filename,doerror);try{b=JSON.parse(jsonstring)}catch(e){return doerror(filename+" is not a valid JSON File --pick something with a .json extension"),!1}return"Landmarks"!==b.bisformat?(doerror("Bad JSON File "+filename+' element bisformat does not equal "Landmarks"'),!1):(this.resetundo(),this.points=b.points.slice(0),this.names=b.names.slice(0),this.filename=filename,this.color=b.color||this.color,this.size=b.size||this.size,!0)}undo(verbose){if(verbose=verbose||!1,null===this.undostack)return verbose&&console.log("can not undo"),!1;var elem=this.undostack.getUndo();if(verbose&&console.log("undo =",elem),null===elem)return!1;this.noundo=!0;var out=!0;return"rename"===elem[0]?this.renamepoint(elem[1],elem[3]):"move"===elem[0]?this.movepoint(elem[1],elem[3]):"add"===elem[0]?this.deletepoint(elem[1]):"delete"===elem[0]?this.insertpoint(elem[1],elem[2],elem[3]):out=!1,this.noundo=!1,out}redo(verbose){if(verbose=verbose||!1,null===this.undostack)return verbose&&console.log("can not redo"),!1;var elem=this.undostack.getRedo();if(verbose&&console.log("redo =",elem),null===elem)return!1;var out=!0;return this.noundo=!0,"rename"===elem[0]?this.renamepoint(elem[1],elem[2]):"move"===elem[0]?this.movepoint(elem[1],elem[2]):"add"===elem[0]?this.insertpoint(elem[1],elem[2],elem[3]):"delete"===elem[0]?this.deletepoint(elem[1]):out=!1,this.noundo=!1,out}print(){for(var a="",i=0;i<this.getnumpoints();i++)a=a+this.names[i]+"("+this.points[i][0]+","+this.points[i][1]+","+this.points[i][2]+")\n";console.log("landmark set="+this.getnumpoints()+"\n"+a)}}},"./js/dataobjects/bis_undostack.js":function(module,exports,__webpack_require__){"use strict";const util=__webpack_require__("./js/core/bis_util.js"),MAXSIZE=100;module.exports=class{constructor(in_size=MAXSIZE,in_shift=1,offset=0){1!==offset&&(offset=0),this.internal={size:in_size,shift:in_shift,max_index:-1,undo_index:-1,redo_index:-1,doing_undo:!1,doing_redo:!1,offset:offset},this.initialize()}initialize(num,shift){this.resetundoredoflags(),this.internal.size=util.range(num||this.internal.size,10,2*MAXSIZE);var a=Math.round(this.internal.size/3);this.internal.shift=util.range(shift||this.internal.shift,1,a),this.internal.index=-1,this.internal.max_index=-1,this.internal.elements=new Array(this.internal.size);for(var i=0;i<this.internal.size;i++)this.internal.elements[i]=[]}resetundoredoflags(){this.internal.undo_index=-1,this.internal.redo_index=-1,this.internal.doing_undo=!1,this.internal.doing_redo=!1}addOperation(arr){if(null===arr)throw"bad item to stack :null";if("function"!=typeof arr.slice)throw"bad item to stack :"+arr+" not a string or an array";this.internal.index==this.internal.size-1&&this.shuffle(),this.resetundoredoflags(),this.internal.index+=1,this.internal.max_index=this.internal.index,this.internal.elements[this.internal.index]=arr.slice(0)}getUndo(){return this.internal.doing_redo=!1,!1===this.internal.doing_undo?this.internal.index>=this.internal.offset?(this.internal.undo_index=this.internal.index-this.internal.offset,this.internal.doing_undo=!0,this.internal.elements[this.internal.undo_index]):null:this.internal.undo_index>0?(this.internal.undo_index-=1,this.internal.index=this.internal.undo_index,this.internal.elements[this.internal.undo_index]):null}getRedo(){return!1===this.internal.doing_redo?!1===this.internal.doing_undo?null:(this.internal.doing_undo=!1,this.internal.index>=0&&this.internal.index<this.internal.size-this.internal.offset?(this.internal.redo_index=this.internal.index+this.internal.offset,this.internal.doing_redo=!0,this.internal.elements[this.internal.redo_index]):(this.internal.doing_redo=!1,null)):(this.internal.doing_undo=!1,this.internal.redo_index+=1,this.internal.redo_index<=this.internal.max_index?(this.internal.index=this.internal.redo_index,this.internal.elements[this.internal.redo_index]):null)}shuffle(){for(var shift=this.internal.shift,ia=shift;ia<this.internal.size;ia++)this.internal.elements[ia-shift]=this.internal.elements[ia];for(var ib=1;ib<=shift;ib++)this.internal.elements[this.internal.size-ib]=[];this.internal.index-=shift,this.internal.undo_index>=shift?this.internal.undo_index-=shift:this.internal.undo_index=-1,this.internal.redo_index=-1,this.internal.redo_index>=shift?this.internal.redo_index-=shift:this.internal.redo_index=-1,this.internal.max_index-=shift,this.internal.doing_undo=!1,this.internal.doing_redo=!1}getCopyOfElement(index){return this.internal.elements[index].slice(0)}getElementsAsString(){return this.internal.elements.join()}}},"./js/dataobjects/bisweb_basetransformation.js":function(module,exports,__webpack_require__){"use strict";const BisWebDataObject=__webpack_require__("./js/dataobjects/bisweb_dataobject.js"),genericio=__webpack_require__("./js/core/bis_genericio.js"),biswasm=__webpack_require__("./js/core/bis_wasmutils.js");module.exports=class extends BisWebDataObject{constructor(){super(),this.legacyextension="",this.extension=".bisxform"}getObjectType(){return"transform"}serializeWasm(Module){let totalbytes=this.getWASMNumberOfBytes(),inDataPtr=biswasm.allocate_memory(Module,totalbytes);return this.serializeWasmInPlace(Module,inDataPtr),biswasm.get_array_view(Module,Uint8Array,inDataPtr,totalbytes).byteOffset}serializeWasmInPlace(Module,inDataPtr){throw new Error("serializeWasmInPlace not defined"+Module+" "+inDataPtr)}identity(){throw new Error("identity not implemented for "+this.constructor.name)}transformPoint(X,TX){throw new Error("transformPoint not implemented for "+this.constructor.name+" "+X+" "+TX)}transformPointToVoxel(X,TX,spa){this.transformPoint(X,TX);for(let i=0;i<=2;i++)TX[i]=TX[i]/spa[i]}computeDisplacement(X,U){this.transformPoint(X,U),U[0]-=X[0],U[1]-=X[1],U[2]-=X[2]}load(fobj){const self=this;return new Promise((resolve,reject)=>{genericio.read(fobj,!1).then(contents=>{this.parseFromText(contents.data,contents.filename,reject),console.log("loaded transformation from "+contents.filename),self.setFilename(contents.filename),resolve()}).catch(e=>{reject(e)})})}save(filename){let output=this.serializeToText(filename);return new Promise(function(resolve,reject){genericio.write(filename,output).then(f=>{f.name&&(f=f.name),console.log("++++\t saved transformation in "+f),resolve(f)}).catch(e=>{reject(e)})})}legacySerialize(){throw new Error("legacySerialize not implemented for "+this.constructor.name)}serializeToText(filename=""){return(filename.name?filename.name.split(".").pop():filename.split(".").pop())===this.legacyextension?this.legacySerialize():this.serializeToJSON()}legacyParseFromText(inpstring,filename){throw new Error("legacyParseFromText not implemented for "+this.constructor.name+" "+inpstring.length+"filename "+filename)}parseFromText(jsonstring,filename=""){return(filename.name?filename.name.split(".").pop():filename.split(".").pop())===this.legacyextension?this.legacyParseFromText(jsonstring,filename):this.parseFromJSON(jsonstring)}}},"./js/dataobjects/bisweb_combotransformation.js":function(module,exports,__webpack_require__){"use strict";const util=__webpack_require__("./js/core/bis_util.js"),biswasm=__webpack_require__("./js/core/bis_wasmutils.js"),BisWebBaseTransformation=__webpack_require__("./js/dataobjects/bisweb_basetransformation.js"),BisWebLinearTransformation=__webpack_require__("./js/dataobjects/bisweb_lineartransformation.js"),BisWebGridTransformation=__webpack_require__("./js/dataobjects/bisweb_gridtransformation.js");module.exports=class extends BisWebBaseTransformation{constructor(ii_linear){super(),this.jsonformatname="BisComboTransformation",this.internal={linearTransformation:new BisWebLinearTransformation(0),gridTransformationList:[]},this.initialize(ii_linear),this.legacyextension="grd"}getDescription(pretty=!1){let s="Combo:\n",t="  ";pretty&&(s="",t=""),s+=t+"Linear="+this.internal.linearTransformation.getDescription()+"\n",s+=t+"Num Grids="+this.internal.gridTransformationList.length+"\n";for(let i=0;i<this.internal.gridTransformationList.length;i++)s+=t+this.internal.gridTransformationList[i].getDescription(pretty)+"\n";return s}computeHash(){let s=this.internal.linearTransformation.computeHash();for(let i=0;i<this.internal.gridTransformationList.length;i++)s+=this.internal.gridTransformationList[i].computeHash();return s}getMemorySize(){let sz=this.internal.linearTransformation.getMemorySize();for(let i=0;i<this.internal.gridTransformationList.length;i++)sz+=this.internal.gridTransformationList[i].getMemorySize();return sz}serializeToDictionary(){let obj=super.serializeToDictionary(),objlist=[];for(let i=0;i<this.internal.gridTransformationList.length;i++)objlist.push(this.internal.gridTransformationList[i].serializeToDictionary());return obj.linear=this.internal.linearTransformation.serializeToDictionary(),obj.numgrids=this.internal.gridTransformationList.length,obj.grids=objlist,obj}parseFromDictionary(b){let linear=new BisWebLinearTransformation(0);linear.parseFromDictionary(b.linear),this.internal.linearTransformation.copy(linear);let numgrids=b.numgrids,objlist=b.grids;for(let i=0;i<numgrids;i++){var ng=new BisWebGridTransformation([4,4,4],[2,2,2],[0,0,0],!0);ng.parseFromDictionary(objlist[i]),this.internal.gridTransformationList.push(ng)}return super.parseFromDictionary(b),!0}deserializeWasm(Module,dataptr,extra=0){let intheader=biswasm.get_array_view(Module,Int32Array,dataptr,5);if(intheader[0]!==biswasm.get_combo_magic_code(Module))return console.log("Bad wasmobj, can not deserialize combo Transformation",extra),0;const num_grids=intheader[4];this.identity();let offset=20;this.internal.linearTransformation.deserializeWasm(Module,dataptr+offset),offset+=this.internal.linearTransformation.getWASMNumberOfBytes();for(let grid=0;grid<num_grids;grid++){var ng=new BisWebGridTransformation([4,4,4],[2,2,2],[0,0,0],!0);ng.deserializeWasm(Module,dataptr+offset),this.internal.gridTransformationList.push(ng),offset+=ng.getWASMNumberOfBytes()}return 1}compareWithOther(other,method="maxabs",threshold=.01){let out={testresult:!1,value:null,metric:"maxabs"};if(other.constructor.name!==this.constructor.name)return out;let o=other.getNumberOfGridTransformations(),m=this.getNumberOfGridTransformations();if(o!==m)return out;console.log("....\t comparing combo transformations:",m,o);let outlin=this.internal.linearTransformation.compareWithOther(other.getLinearTransformation(),method,threshold);out.value=out.value+outlin.value;for(let i=0;i<this.internal.gridTransformationList.length;i++){let outgrid=this.internal.gridTransformationList[i].compareWithOther(other.getGridTransformation(i),method,threshold);out.value=out.value+outgrid.value,out.metric=outgrid.metric}return out.value<threshold&&(out.testresult=!0),out}identity(){this.internal.gridTransformationList=[],this.internal.linearTransformation.identity()}transformPointToVoxel(X,TX,spa){let tmp=[X[0],X[1],X[2]];for(let i=this.internal.gridTransformationList.length-1;i>=0;i-=1)this.internal.gridTransformationList.transformPoint(tmp,TX),tmp[0]=TX[0],tmp[1]=TX[1],tmp[2]=TX[2];this.internal.linearTransformation.transformPointToVoxel(tmp,TX,spa)}transformPoint(X,TX){let tmp=[X[0],X[1],X[2]];for(let i=this.internal.gridTransformationList.length-1;i>=0;i-=1)this.internal.gridTransformationList[i].transformPoint(tmp,TX),tmp[0]=TX[0],tmp[1]=TX[1],tmp[2]=TX[2];this.internal.linearTransformation.transformPoint(tmp,TX)}initialize(linear=null){null!==(linear=linear||null)&&this.internal.linearTransformation.copy(linear)}getLinearTransformation(){return this.internal.linearTransformation||null}getGridTransformation(index){return index=util.range(index||0,0,this.internal.gridTransformationList.length-1),this.internal.gridTransformationList[index]}getNumberOfGridTransformations(){return this.internal.gridTransformationList.length}setLinearTransformation(tr){this.internal.linearTransformation.copy(tr)}optimize(spa){this.internal.linearTransformation.optimize(spa)}legacySerialize(){let s="";this.internal.gridTransformationList.length>1?(s="#vtkpxMultiComboTransform File\n",s+="#Number of Non Linear Transformations\n"+this.internal.gridTransformationList.length.toFixed(0)+"\n"):s="#vtkpxNewComboTransform File\n",s+="#NonLinearFirst\n1\n#Linear Component\n",s+=this.internal.linearTransformation.legacySerialize("\n");for(let i=0;i<this.internal.gridTransformationList.length;i++)s+=this.internal.gridTransformationList[i].legacySerialize();return s}legacyParseFromText(inputstring,filename){let lines=inputstring.split("\n"),s1="#vtkpxMultiComboTransform File"===lines[0].trim(),s2="#vtkpxNewComboTransform File"===lines[0].trim(),s3="#vtkpxBaseGridTransform2 File"===lines[0].trim();if(!0!==s1&&!0!==s2&&!0!==s3)return console.log(filename+" is not a valid multi combo tensor b-spline grid file .grd"+lines[0].trim()),!1;let offset=6;if(!0===s2&&(offset=4),1==s3&&(offset=0),!1===s3){var s=lines[offset]+"\n"+lines[offset+1]+"\n"+lines[offset+2]+"\n"+lines[offset+3]+"\n";if(!1===this.internal.linearTransformation.legacyParseFromText(s,filename+"piece"))return;offset+=4}else this.internal.linearTransformation.identity();let num=1;!0===s1&&(num=parseInt(lines[2].trim())),this.internal.gridTransformationList=[];for(let grd=0;grd<num;grd++){var ng=new BisWebGridTransformation([4,4,4],[2,2,2],[0,0,0],!0);if(!ng.legacyParseFromText(inputstring,filename,offset))return!1;offset=offset+10+ng.getNumberOfControlPoints(),this.internal.gridTransformationList.push(ng)}return!0}getWASMNumberOfBytes(){let numbytes=0;for(let i=0;i<this.internal.gridTransformationList.length;i++)numbytes+=this.internal.gridTransformationList[i].getWASMNumberOfBytes();return 20+(numbytes+=this.internal.linearTransformation.getWASMNumberOfBytes())}serializeWasmInPlace(Module,inDataPtr){let totalbytes=this.getWASMNumberOfBytes(),header=biswasm.get_array_view(Module,Int32Array,inDataPtr,5);header[0]=biswasm.get_combo_magic_code(Module),header[1]=16,header[2]=4,header[3]=totalbytes,header[4]=this.internal.gridTransformationList.length;let offset=20;offset+=this.internal.linearTransformation.serializeWasmInPlace(Module,inDataPtr+offset);for(let i=0;i<this.internal.gridTransformationList.length;i++)offset+=this.internal.gridTransformationList[i].serializeWasmInPlace(Module,inDataPtr+offset);return totalbytes}}},"./js/dataobjects/bisweb_dataobject.js":function(module,exports,__webpack_require__){"use strict";const biswasm=__webpack_require__("./js/core/bis_wasmutils.js");module.exports=class{constructor(){this.jsonformatname="",this.commentlist=[],this.filename="",this.extension=".json"}getExtension(){return this.extension}getFilename(){return this.filename}setFilename(s){s="object"==typeof s?s.name||"":s||"",this.filename=s}getObjectType(){throw new Error("getObjectType not implemented for "+this.constructor.name)}getDescription(){return"Object "+this.constructor.name}computeHash(){return"0000"}getMemorySize(){return 0}load(fobj){throw new Error("load not implemented for "+this.constructor.name+" "+fobj)}save(filename){throw new Error("save not implemented for "+this.constructor.name+" "+filename)}serializeToJSON(pretty=!1){let obj=this.serializeToDictionary();return pretty?JSON.stringify(obj,null,4):JSON.stringify(obj)}serializeToDictionary(){return{bisformat:this.jsonformatname,filename:this.filename,comments:this.commentlist}}parseFromJSON(text){let b;try{b=JSON.parse(text)}catch(e){return console.log("Failed to parse text",e),!1}return b.bisformat===this.jsonformatname&&this.parseFromDictionary(b)}parseFromDictionary(obj){this.commentlist=obj.comments,this.filename=obj.filename}serializeWasm(Module){throw new Error("serializeWASM not implemented for "+this.constructor.name+" "+Module)}deserializeWasm(Module,wasmarr,extra=0){throw new Error("deserializeWASM not implemented for "+this.constructor.name+" "+Module+" "+wasmarr+" "+extra)}deserializeWasmAndDelete(Module,wasmarr,extra=0){const out=this.deserializeWasm(Module,wasmarr,extra);return biswasm.release_memory_cpp(Module,wasmarr),out}compareWithOther(other,method="maxabs",threshold=.01){throw new Error("compareWithOther not implemented for "+this.constructor.name+" "+method+" "+threshold)}addComment(txt){this.commentlist.push(txt)}getCommentList(){return this.commentlist.slice(0)}setCommentList(lst){try{this.commentlist=lst.slice(0)}catch(e){this.commentlist=[],this.commentlist.push(lst)}}getDetailedDescription(name=""){let formatObject=function(obj,mainkey=null,level=0){let keys=Object.keys(obj);if(keys.length<1)return"";let value=obj[keys[0]],s="";if(1===keys.length)return"object"==typeof value?(s=`<LI>${keys[0]}</LI>`,s+="<UL>",s+=formatObject(value,null,level+1),s+="</UL>"):`<LI><B>${keys[0]}</B>: ${value}</LI>`;mainkey&&(s=`<LI><B>${mainkey}</B></LI><UL>`);for(let i=0;i<keys.length;i++)if("object"!=typeof(value=obj[keys[i]]))s+=`<LI><I>${keys[i]}</I>: ${value}</LI>`;else if(level<1)s+=formatObject(value,keys[i],level+1);else{s+=`<LI><I>${keys[i]}</I>: `;let ikeys=Object.keys(value);for(let j=0;j<ikeys.length;j++){let ival=value[ikeys[j]];"object"==typeof ival&&(ival=JSON.stringify(ival).replace(/\{/g,"").replace(/\}/g,"").replace(/"/g,"").replace(/:/g," ").replace(/,/g," ")),j>0&&(s+=", "),s+=`<I>${ikeys[j]}</I>: ${ival}`}s+="</LI>"}return s+"</UL>"};name=name||this.getObjectType();let des=this.getDescription(!0).replace(/\\n/g,"<BR>");return this.getCommentList().length>0?`<details><summary><B>${name}</B>:  ${des}</summary>${function(lst){let s="<OL>";for(let i=0;i<lst.length;i++)s+=formatObject(lst[i]).replace(/\\n/g,"<BR>").replace(/===================================/g,"<HR>");return s+"</OL>"}(this.getCommentList())}</details>`:`<B>${name}</B>:<BR>${des}`}}},"./js/dataobjects/bisweb_dataobjectcollection.js":function(module,exports,__webpack_require__){"use strict";const BisWebDataObject=__webpack_require__("./js/dataobjects/bisweb_dataobject.js"),genericio=__webpack_require__("./js/core/bis_genericio.js"),BisWebImage=__webpack_require__("./js/dataobjects/bisweb_image.js"),BisWebMatrix=__webpack_require__("./js/dataobjects/bisweb_matrix.js"),BisWebTextObject=__webpack_require__("./js/dataobjects/bisweb_textobject.js"),bistransforms=__webpack_require__("./js/legacy/bis_transformationutil.js");class BisWebDataObjectCollection extends BisWebDataObject{constructor(){super(),this.jsonformatname="BisDataObjectCollection",this.itemlist=[],this.extensions=".jsondb"}getObjectType(){return"collection"}getDescription(){return"Collection with "+this.itemlist.length+" items."}computeHash(){let h="Collection";for(let i=0;i<this.itemlist.length;i++)h+=this.itemlist[i].computeHash();return h}getMemorySize(){let h=100;for(let i=0;i<this.itemlist.length;i++)h+=this.itemlist[i].getMemorySize();return h}load(fobj){console.log("++++ Reading collection from:",fobj);const self=this;return new Promise((resolve,reject)=>{genericio.read(fobj,!1).then(contents=>{this.parseFromJSON(contents.data)?(self.setFilename(contents.filename),resolve("loaded collection from "+contents.filename)):reject("loaded collection from "+contents.filename)}).catch(e=>{reject(e)})})}save(filename){let output=this.serializeToJSON(!0);return genericio.write(filename,output)}serializeToDictionary(){let obj=super.serializeToDictionary(),arr=[];for(let i=0;i<this.itemlist.length;i++)arr.push({type:this.itemlist[i].data.getObjectType(),data:this.itemlist[i].data.serializeToJSON(),metadata:this.itemlist[i].metadata});return obj.numitems=this.itemlist.length,obj.itemlist=arr,obj}parseFromDictionary(obj){let numitems=obj.numitems;this.itemlist=[];for(let i=0;i<numitems;i++){let item=obj.itemlist[i],objtype=item.type,data=item.data,metadata=item.metadata;this.itemlist.push({data:BisWebDataObjectCollection.parseObject(data,objtype),metadata:metadata})}return super.parseFromDictionary(obj),!0}compareWithOther(other,method="maxabs",threshold=.01){let out={testresult:!1,value:null,metric:"maxabs"};if(other.constructor.name!==this.constructor.name)return out;let lo=other.getNumberOfItems(),ln=this.getNumberOfItems();if(lo!==ln)return out;out.testresult=!0,console.log(".... Comparing data object collections:",lo,ln);for(let i=0;i<ln;i++){let outitem=this.getItemData(i).compareWithOther(other.getItemData(i),method,threshold);console.log("\t",i,outitem),out.value=out.value+outitem.value,!1===outitem.testresult&&(out.testresult=!1)}return out}getNumberOfItems(){return this.itemlist.length}addItem(dataobj,extra={}){this.itemlist.push({data:dataobj,metadata:extra})}removeItem(i){return!(i<0||i>=this.itemlist.length)&&(this.itemlist.splice(i,1),!0)}removeAllItems(){this.itemlist=[]}getItem(i){return i<0||i>=this.itemlist.length?null:this.itemlist[i]}getItemData(i){return i<0||i>=this.itemlist.length?null:this.itemlist[i].data}getItemMetaData(i){return i<0||i>=this.itemlist.length?null:this.itemlist[i].metadata}setItem(i,obj,extra={}){i<0||i>=this.itemlist.length||(this.itemlist[i]={data:obj,metadata:extra})}static parseObject(text,objecttype){if("transformation"===objecttype||"transform"===objecttype)return bistransforms.parseTransformationFromJSON(text);let obj=null;return"matrix"===objecttype||"vector"===objecttype?obj=new BisWebMatrix(objecttype):"image"===objecttype?obj=new BisWebImage:"collection"===objecttype?obj=new BisWebDataObjectCollection:"text"!==objecttype&&"textobject"!==objecttype||(obj=new BisWebTextObject),null===obj?(console.log("Error unknown ",objecttype," =null"),null):obj.parseFromJSON(text)?obj:(console.log("Error parsing",objecttype,"null"),null)}getItems(){return this.itemlist}static loadObject(filename,objecttype){if("matrix"===objecttype||"vector"===objecttype){let obj=new BisWebMatrix(objecttype);return new Promise((resolve,reject)=>{obj.load(filename).then(()=>{resolve(obj)}).catch(e=>{reject(e)})})}if("text"===objecttype||"textobject"===objecttype){let obj=new BisWebTextObject;return new Promise((resolve,reject)=>{obj.load(filename).then(()=>{resolve(obj)}).catch(e=>{reject(e)})})}if("collection"===objecttype){let obj=new BisWebDataObjectCollection;return new Promise((resolve,reject)=>{obj.load(filename).then(()=>{resolve(obj)}).catch(e=>{reject(e)})})}if(objecttype.indexOf("transform")>=0)return new Promise((resolve,reject)=>{bistransforms.loadTransformation(filename).then(obj=>{obj.data||reject("Failed to load/parse file"),resolve(obj.data)}).catch(e=>{reject(e)})});let obj=new BisWebImage;return new Promise((resolve,reject)=>{obj.load(filename).then(()=>{resolve(obj)}).catch(e=>{reject(e)})})}}module.exports=BisWebDataObjectCollection},"./js/dataobjects/bisweb_gridtransformation.js":function(module,exports,__webpack_require__){"use strict";const util=__webpack_require__("./js/core/bis_util.js"),biswasm=__webpack_require__("./js/core/bis_wasmutils.js"),BisWebBaseTransformation=__webpack_require__("./js/dataobjects/bisweb_basetransformation.js"),numeric=__webpack_require__("./node_modules/numeric/numeric-1.2.6.js"),genericio=__webpack_require__("./js/core/bis_genericio.js");module.exports=class extends BisWebBaseTransformation{constructor(ii_dims=[4,4,4],ii_spacing=[40,50,40],ii_origin=[0,0,0],ii_nonewfield=!1,ii_linearinterpmode=!1){super(),this.jsonformatname="BisGridTransformation",this.legacyextension="grd",this.internal={dispfield:null,origin:[0,0,0],spacing:[0,0,0],dimensions:[0,0,0],minusdim:[0,0,0],slicesize:0,volsize:0,linearinterpmode:0,Y:[0,0,0]},this.initialize(ii_dims,ii_spacing,ii_origin,ii_nonewfield,ii_linearinterpmode)}getDescription(){return"Dimensions:"+this.internal.dimensions[0]+" "+this.internal.dimensions[1]+" "+this.internal.dimensions[2]+", Spacing:"+this.internal.spacing[0].toFixed(4)+" "+this.internal.spacing[1].toFixed(4)+" "+this.internal.spacing[2].toFixed(4)+", Origin:"+this.internal.origin[0].toFixed(4)+" "+this.internal.origin[1].toFixed(4)+" "+this.internal.origin[2].toFixed(4)}computeHash(){return util.SHA256(this.internal.dispfield)}getMemorySize(){return 4*this.getNumberOfDOF()+128}serializeToDictionary(){let obj=super.serializeToDictionary(),bytesarr=new Uint8Array(this.internal.dispfield.buffer),b=genericio.tozbase64(bytesarr);return obj.origin=this.internal.origin,obj.spacing=this.internal.spacing,obj.dimensions=this.internal.dimensions,obj.dispfield=b,obj.linearinterpmode=this.internal.linearinterpmode,obj}parseFromDictionary(b){let bytesarr=genericio.fromzbase64(b.dispfield);return this.initialize(b.dimensions,b.spacing,b.origin,!0,b.linearinterpmode),this.internal.dispfield=new Float32Array(bytesarr.buffer),super.parseFromDictionary(b),!0}deserializeWasm(Module,wasmarr){var wasmobj=biswasm.unpackStructure(Module,wasmarr,!1,16);if(wasmobj.magic_type!==biswasm.get_grid_magic_code(Module))return console.log("Bad wasmobj, can not deserialize grid Transformation"),0;this.identity();let dim=[0,0,0],spa=[0,0,0],ori=[0,0,0],linearinterp=!1,int_header=new Int32Array(wasmobj.header_array.buffer,0,4),float_header=new Float32Array(wasmobj.header_array.buffer,16,6);0===int_header[0]&&(linearinterp=!0);for(let i=0;i<=2;i++)dim[i]=int_header[i+1],spa[i]=float_header[i],ori[i]=float_header[i+3];this.initialize(dim,spa,ori,!0,linearinterp),this.internal.dispfield=wasmobj.data_array}compareWithOther(other,method="maxabs",threshold=.01){let out={testresult:!1,value:null,metric:"maxabs"};if(other.constructor.name!==this.constructor.name)return out;let myfield=this.getDisplacementField(),otherfield=other.getDisplacementField();return console.log("....\t comparing grids:",numeric.dim(myfield),numeric.dim(otherfield)),"maxabs"===method?out.value=numeric.norminf(numeric.sub(myfield,otherfield)):(out.value=numeric.norm2(numeric.sub(myfield,otherfield)),out.method="ssd"),out.value<threshold&&(out.testresult=!0),out}identity(){var numdof=this.getNumberOfDOF(),newfield=!0;null!==this.internal.dispfield&&this.internal.dispfield.length===numdof&&(newfield=!1),newfield&&(this.internal.dispfield=new Float32Array(numdof));for(var i=0;i<numdof;i++)this.internal.dispfield[i]=0}transformPoint(X,TX){this.internal.linearinterpmode?this.linearTransformPoint(X,TX):this.bsplineTransformPoint(X,TX)}bsplineTransformPoint(X,TX){var t,coord,B00,minusdim0=this.internal.minusdim[0],minusdim1=this.internal.minusdim[1],minusdim2=this.internal.minusdim[2],data=this.internal.dispfield,X0=(X[0]-this.internal.origin[0])/this.internal.spacing[0],X1=(X[1]-this.internal.origin[1])/this.internal.spacing[1],X2=(X[2]-this.internal.origin[2])/this.internal.spacing[2],B01=0|X0;t=X0-B01,B01<0?(B01=0,B00=0):B01>minusdim0&&(B01=minusdim0),(B00=B01-1)<0&&(B00=0);var B02=B01+1,B03=B01+2;B02>minusdim0?(B02=minusdim0,B03=minusdim0):B03>minusdim0&&(B03=minusdim0);var B10,W00=Math.pow(1-t,3)/6,W01=(3*t*t*t-6*t*t+4)/6,W02=(-3*t*t*t+3*t*t+3*t+1)/6,W03=t*t*t/6,B11=0|X1;t=X1-B11,B11<0?(B11=0,B10=0):(B10=B11-1)<0&&(B10=0);var B12=B11+1,B13=B11+2;B12>minusdim1?(B12=minusdim1,B13=minusdim1):B13>minusdim1&&(B13=minusdim1);var B20,W10=Math.pow(1-t,3)/6,W11=(3*t*t*t-6*t*t+4)/6,W12=(-3*t*t*t+3*t*t+3*t+1)/6,W13=t*t*t/6,B21=0|X2;t=X2-B21,B21<0?(B21=0,B20=0):(B20=B21-1)<0&&(B20=0);var B22=B21+1,B23=B21+2;B22>minusdim2?(B22=minusdim2,B23=minusdim2):B23>minusdim2&&(B23=minusdim2);var W20=Math.pow(1-t,3)/6,W21=(3*t*t*t-6*t*t+4)/6,W22=(-3*t*t*t+3*t*t+3*t+1)/6,W23=t*t*t/6;for(B10*=this.internal.dimensions[0],B11*=this.internal.dimensions[0],B12*=this.internal.dimensions[0],B13*=this.internal.dimensions[0],B20*=this.internal.slicesize,B21*=this.internal.slicesize,B22*=this.internal.slicesize,B23*=this.internal.slicesize,coord=0;coord<=2;coord++)TX[coord]=X[coord]+(W20*W10*W00*data[B20+B10+B00]+W20*W10*W01*data[B20+B10+B01]+W20*W10*W02*data[B20+B10+B02]+W20*W10*W03*data[B20+B10+B03]+W20*W11*W00*data[B20+B11+B00]+W20*W11*W01*data[B20+B11+B01]+W20*W11*W02*data[B20+B11+B02]+W20*W11*W03*data[B20+B11+B03]+W20*W12*W00*data[B20+B12+B00]+W20*W12*W01*data[B20+B12+B01]+W20*W12*W02*data[B20+B12+B02]+W20*W12*W03*data[B20+B12+B03]+W20*W13*W00*data[B20+B13+B00]+W20*W13*W01*data[B20+B13+B01]+W20*W13*W02*data[B20+B13+B02]+W20*W13*W03*data[B20+B13+B03]+W21*W10*W00*data[B21+B10+B00]+W21*W10*W01*data[B21+B10+B01]+W21*W10*W02*data[B21+B10+B02]+W21*W10*W03*data[B21+B10+B03]+W21*W11*W00*data[B21+B11+B00]+W21*W11*W01*data[B21+B11+B01]+W21*W11*W02*data[B21+B11+B02]+W21*W11*W03*data[B21+B11+B03]+W21*W12*W00*data[B21+B12+B00]+W21*W12*W01*data[B21+B12+B01]+W21*W12*W02*data[B21+B12+B02]+W21*W12*W03*data[B21+B12+B03]+W21*W13*W00*data[B21+B13+B00]+W21*W13*W01*data[B21+B13+B01]+W21*W13*W02*data[B21+B13+B02]+W21*W13*W03*data[B21+B13+B03]+W22*W10*W00*data[B22+B10+B00]+W22*W10*W01*data[B22+B10+B01]+W22*W10*W02*data[B22+B10+B02]+W22*W10*W03*data[B22+B10+B03]+W22*W11*W00*data[B22+B11+B00]+W22*W11*W01*data[B22+B11+B01]+W22*W11*W02*data[B22+B11+B02]+W22*W11*W03*data[B22+B11+B03]+W22*W12*W00*data[B22+B12+B00]+W22*W12*W01*data[B22+B12+B01]+W22*W12*W02*data[B22+B12+B02]+W22*W12*W03*data[B22+B12+B03]+W22*W13*W00*data[B22+B13+B00]+W22*W13*W01*data[B22+B13+B01]+W22*W13*W02*data[B22+B13+B02]+W22*W13*W03*data[B22+B13+B03]+W23*W10*W00*data[B23+B10+B00]+W23*W10*W01*data[B23+B10+B01]+W23*W10*W02*data[B23+B10+B02]+W23*W10*W03*data[B23+B10+B03]+W23*W11*W00*data[B23+B11+B00]+W23*W11*W01*data[B23+B11+B01]+W23*W11*W02*data[B23+B11+B02]+W23*W11*W03*data[B23+B11+B03]+W23*W12*W00*data[B23+B12+B00]+W23*W12*W01*data[B23+B12+B01]+W23*W12*W02*data[B23+B12+B02]+W23*W12*W03*data[B23+B12+B03]+W23*W13*W00*data[B23+B13+B00]+W23*W13*W01*data[B23+B13+B01]+W23*W13*W02*data[B23+B13+B02]+W23*W13*W03*data[B23+B13+B03]),B20+=this.internal.volsize,B21+=this.internal.volsize,B22+=this.internal.volsize,B23+=this.internal.volsize}linearTransformPoint(X,TX){var ia,ja,ka,sum=0,B=[[0,0],[0,0],[0,0]],W=[[0,0],[0,0],[0,0]];for(ia=0;ia<=2;ia++){var p=(X[ia]-this.internal.origin[ia])/this.internal.spacing[ia];B[ia][0]=0|p,B[ia][1]=B[ia][1]+1;for(var ib=0;ib<=1;ib++)B[ia][ib]<0?B[ia][ib]=0:B[ia][ib]>this.internal.minusdim[ia]&&(B[ia][ib]=this.internal.minusdim[ia]);W[ia][0]=B[ia][1]-TX[ia],W[ia][1]=1-W[ia][0]}for(ia=0;ia<=1;ia++)B[1][ia]=B[1][ia]*this.internal.dimensions[0],B[2][ia]=B[2][ia]*this.internal.slicesize;for(var coord=0;coord<=2;coord++){for(sum=X[coord],ka=0;ka<=1;ka++)for(ja=0;ja<=1;ja++)for(ia=0;ia<=1;ia++)sum+=W[2][ka]*W[1][ja]*W[0][ia]*this.internal.dispfield[B[2][ka]+B[1][ja]+B[0][ia]];for(TX[coord]=sum,ia=0;ia<=1;ia++)B[2][ia]+=this.internal.volsize}}initialize(dims,spacing,origin,in_nonewfield,linearinterpmode){this.internal.dimensions=dims||this.internal.dimensions;for(var i=0;i<=2;i++)this.internal.dimensions[i]=Math.floor(util.range(this.internal.dimensions[i],4,1e3)),this.internal.minusdim[i]=this.internal.dimensions[i]-1;this.internal.slicesize=this.internal.dimensions[0]*this.internal.dimensions[1],this.internal.volsize=this.internal.dimensions[2]*this.internal.slicesize,this.internal.spacing=spacing||this.internal.spacing,this.internal.origin=origin||this.internal.origin,(in_nonewfield=in_nonewfield||!1)||this.identity(),this.internal.linearinterpmode=linearinterpmode||!1}getNumberOfDOF(){return this.internal.dimensions[0]*this.internal.dimensions[1]*this.internal.dimensions[2]*3}getNumberOfControlPoints(){return this.internal.dimensions[0]*this.internal.dimensions[1]*this.internal.dimensions[2]}optimize(){}legacySerialize(){let s="#vtkpxBaseGridTransform2 File\n";s=(s=(s=s+"#Origin\n"+this.internal.origin[0].toFixed(4)+" "+this.internal.origin[1].toFixed(4)+" "+this.internal.origin[2].toFixed(4)+"\n")+"#Spacing\n"+this.internal.spacing[0].toFixed(4)+" "+this.internal.spacing[1].toFixed(4)+" "+this.internal.spacing[2].toFixed(4)+"\n")+"#Dimensions\n"+this.internal.dimensions[0]+" "+this.internal.dimensions[1]+" "+this.internal.dimensions[2]+"\n",this.internal.linearinterpmode?s+="#Interpolation Mode\n1\n#Displacements\n":s+="#Interpolation Mode\n4\n#Displacements\n";for(var np=this.getNumberOfControlPoints(),np2=2*np,i=0;i<np;i++)s+=i.toFixed(0)+" "+this.internal.dispfield[i].toFixed(4)+" "+this.internal.dispfield[i+np].toFixed(4)+" "+this.internal.dispfield[i+np2].toFixed(4)+"\n";return s}legacyParseFromText(inpstring,filename,offset){offset=offset||0;var lines=inpstring.split("\n"),s1="#vtkpxBaseGridTransform2 File"===lines[offset+0].trim(),s2="#vtkpxBaseGridTransform2 File"===lines[8].trim();if(!1===s1&&!1===s2)return console.log(filename+" is not a valid legacy tensor b-spline grid file .grd"+lines[offset+0].trim()+","+lines[offset+8].trim()),!1;for(var origin=lines[offset+2].trim().split(" "),spacing=lines[offset+4].trim().split(" "),dims=lines[offset+6].trim().split(" "),k=0;k<=2;k++)origin[k]=parseFloat(origin[k]),spacing[k]=parseFloat(spacing[k]),dims[k]=parseInt(dims[k]);let interp=lines[offset+8].trim().split(" ");this.internal.linearinterpmode=4!==interp;var np=dims[0]*dims[1]*dims[2];this.initialize(dims,spacing,origin,null);for(var cp=0;cp<np;cp++)for(var x=lines[offset+10+cp].trim().split(" "),j=0;j<=2;j++)this.internal.dispfield[np*j+cp]=parseFloat(x[j+1]);return!0}getDisplacementField(){return this.internal.dispfield}getGridInfo(){return{origin:[this.internal.origin[0],this.internal.origin[1],this.internal.origin[2]],spacing:[this.internal.spacing[0],this.internal.spacing[1],this.internal.spacing[2]],dimensions:[this.internal.dimensions[0],this.internal.dimensions[1],this.internal.dimensions[2]]}}initializeFromDisplacementField(displacement_field,inverse){var sc=1;(inverse=inverse||!1)&&(sc=-1);var dim=displacement_field.getDimensions(),data=displacement_field.getImageData();if(3!==dim[3])throw new Error("Need a displacement field here, 3 components!");var i,j,k,coord,spa=displacement_field.getSpacing(),slicesize=dim[0]*dim[1],volsize=slicesize*dim[2],outindex=0;for(k=0;k<this.internal.dimensions[2];k++){var z=util.range(Math.round((k*this.internal.spacing[2]+this.internal.origin[2])/spa[2]),0,dim[2]-1)*slicesize;for(j=0;j<this.internal.dimensions[1];j++){var y=util.range(Math.round((j*this.internal.spacing[1]+this.internal.origin[1])/spa[1]),0,dim[1]-1)*dim[0];for(i=0;i<this.internal.dimensions[0];i++){var index=util.range(Math.round((i*this.internal.spacing[0]+this.internal.origin[0])/spa[0]),0,dim[0]-1)+y+z;for(coord=0;coord<=2;coord++)this.internal.dispfield[coord*this.internal.volsize+outindex]=sc*data[index+volsize*coord];++outindex}}}}computeGradientForOptimization(params,grad,stepsize,imgbounds,imgspa,windowsize,computeValueFunctionPiece){var radius=[windowsize*this.internal.spacing[0],windowsize*this.internal.spacing[1],windowsize*this.internal.spacing[2]],bounds=[0,0,0,0,0,0],computeBounds=(axis,value)=>{var pos=value*this.internal.spacing[axis]+this.internal.origin[axis];bounds[2*axis]=util.range(Math.round((pos-radius[axis])/imgspa[axis]),imgbounds[2*axis],imgbounds[2*axis+1]),bounds[2*axis+1]=util.range(Math.round((pos+radius[axis])/imgspa[axis]),imgbounds[2*axis],imgbounds[2*axis+1])};if(params.length!==this.internal.dispfield.length)throw new Error("Bad dimensions for computing grdient optimization in grid transform");var i,j,k,coord,nc=this.getNumberOfControlPoints(),cp=0,GradientNorm=1e-6;for(k=0;k<this.internal.dimensions[2];k++)for(computeBounds(2,k),j=0;j<this.internal.dimensions[1];j++)for(computeBounds(1,j),i=0;i<this.internal.dimensions[0];i++){for(computeBounds(0,i),coord=0;coord<=2;coord++){var index=cp+coord*nc;this.internal.dispfield[index]=params[index]+stepsize;var a=computeValueFunctionPiece(this,bounds);this.internal.dispfield[index]=params[index]-stepsize;var b=computeValueFunctionPiece(this,bounds);this.internal.dispfield[index]=params[index];var g=-.5*(b-a)/stepsize;grad[index]=g,GradientNorm+=g*g}cp++}for(GradientNorm=Math.sqrt(GradientNorm),i=0;i<grad.length;i++)grad[i]=grad[i]/GradientNorm;return GradientNorm}initializeFromOtherGrid(original_grid,displacements,cps){var i,hd=original_grid.getGridInfo(),spa=[0,0,0],origin=[0,0,0],dim=[0,0,0];for(i=0;i<=2;i++){var sz=(hd.dimensions[i]-1)*hd.spacing[i];dim[i]=Math.round(sz/cps)+1,dim[i]<4&&(dim[i]=4),spa[i]=sz/(dim[i]-1.05);var offset=(dim[i]-1)*spa[i]-sz;origin[i]=util.scaledround(-.5*offset,100)}this.initialize(dim,spa,origin),this.initializeFromDisplacementField(displacements)}getWASMNumberOfBytes(){return 56+4*this.getNumberOfDOF()}serializeWasmInPlace(Module,inDataPtr){let header_arr=new Uint8Array(40),int_header=new Int32Array(header_arr.buffer,0,4),float_header=new Float32Array(header_arr.buffer,16,6);this.internal.linearinterpmode?int_header[0]=0:int_header[0]=1;for(let i=0;i<=2;i++)int_header[i+1]=this.internal.dimensions[i],float_header[i]=this.internal.spacing[i],float_header[i+3]=this.internal.origin[i];return biswasm.packRawStructureInPlace(Module,inDataPtr,header_arr,this.internal.dispfield,biswasm.get_grid_magic_code(Module))}}},"./js/dataobjects/bisweb_image.js":function(module,exports,__webpack_require__){"use strict";const BisWebDataObject=__webpack_require__("./js/dataobjects/bisweb_dataobject.js"),BisWebMatrix=__webpack_require__("./js/dataobjects/bisweb_matrix.js"),biswasm=__webpack_require__("./js/core/bis_wasmutils.js"),util=__webpack_require__("./js/core/bis_util.js"),userPreferences=__webpack_require__("./js/core/bisweb_userpreferences.js"),bisgenericio=__webpack_require__("./js/core/bis_genericio.js"),tiff=__webpack_require__("./lib/js/tiff2.js"),bisheader=__webpack_require__("./js/core/bis_header.js"),simplemat=__webpack_require__("./js/core/bis_simplemat.js"),numeric=__webpack_require__("./node_modules/numeric/numeric-1.2.6.js");class BisWebImage extends BisWebDataObject{constructor(){super(),this.jsonformatname="BisImage",this.internal={dimensions:[0,0,0,0,0],offsets:[1,1,1,1,1],range:[0,0],spacing:[1,1,1,1,1],imgdata:null,_rawdata:null,rawsize:0,volsize:0,singlebuffer:null,forcedorientationchange:!1,orient:{IJKToRAS:null,axis:[0,1,2],invaxis:[0,1,2],flip:[0,0,0],invflip:[0,0,0],name:"RAS"},header:{},imginfo:{type:Uint8Array,size:1,name:"uchar"}},this.debug=!1,this.extensions=".nii.gz"}getObjectType(){return"image"}getExtension(){return".nii.gz"}getImageType(){return this.internal.imginfo.name}getDescription(){let sp=[0,0,0];for(let ia=0;ia<this.internal.spacing.length;ia++)sp[ia]=util.scaledround(this.internal.spacing[ia],1e3);let b=this.internal.imginfo.name;return this.filename+" dim="+this.internal.dimensions+", sp="+sp+" orient="+this.internal.orient.name+" type="+b}computeHash(){return util.SHA256(this.getRawData())}getMemorySize(){return this.getRawData().length}load(fobj,forceorient){forceorient=userPreferences.sanitizeOrientationOnLoad(forceorient||userPreferences.getImageOrientationOnLoad()),this.debug&&console.log("..... forceorient in readbinary=",forceorient);const self=this;return new Promise((resolve,reject)=>{bisgenericio.read(fobj,!0).then(function(obj){self.initialize();let ext=obj.filename.split(".").pop().toLowerCase();if("tif"===ext||"tiff"===ext)"Uint8Array"===obj.data.constructor.name?self.parseTIFF(obj.data.buffer,obj.filename,forceorient):self.parseTIFF(obj.data,obj.filename,forceorient),self.commentlist=["read from tiff "+fobj],self.internal.header.setExtensionsFromArray(self.commentlist);else try{self.parseNII(obj.data.buffer,forceorient)}catch(e){reject("Failed to load from "+fobj+"("+e+")"),reject(e)}self.setFilename(bisgenericio.getFixedLoadFileName(fobj)),console.log("++++\t loaded image from "+fobj+". Dim=",self.getDimensions(),self.getOrientationName()+" spa="+self.getSpacing()+" type="+self.getDataType()),self.internal.forcedorientationchange&&(console.log("++++ \t **** forced image orientation to ",forceorient," to match user preferences"),self.commentlist.push({Operation:"On Load from "+fobj+" reoriented to "+self.internal.orient.name+" to match user preferences."}),self.internal.header.setExtensionsFromArray(self.commentlist)),resolve()}).catch(e=>{reject(e)})})}save(fobj){let c=this.serializeToNII();return fobj=bisgenericio.getFixedSaveFileName(fobj,this.filename),bisgenericio.write(fobj,c,!0)}serializeToDictionary(){let obj=super.serializeToDictionary(),arr=this.serializeToNII();return obj.data=bisgenericio.tozbase64(arr),obj}parseFromDictionary(obj,forceorientin=""){this.initialize(),super.parseFromDictionary(obj);let forceorient=forceorientin||"",arr=bisgenericio.fromzbase64(obj.data);return this.parseNII(arr.buffer,forceorient),!0}serializeWasm(Module){let arr=this.getImageData(),dim=this.getDimensions(),spa=this.getSpacing();return biswasm.packStructure(Module,arr,dim,spa)}deserializeWasm(Module,wasmarr,baseimage=0){const internal=this.internal;baseimage=baseimage||0;let wasmobj=biswasm.unpackStructure(Module,wasmarr,!0);if(0===wasmobj.magic_type)return console.log("Bad wasmobj in deserializing Image (bis_image.js line 1089)"),0;let dataptr=wasmobj.dataptr+56;this.initialize();let nifti_info=internal.header.getniftitype(wasmobj.datatype),opts={type:nifti_info[0],numframes:wasmobj.dimensions[3],numcomponentes:wasmobj.dimensions[4],dimensions:[wasmobj.dimensions[0],wasmobj.dimensions[1],wasmobj.dimensions[2]],spacing:[wasmobj.spacing[0],wasmobj.spacing[1],wasmobj.spacing[2]]};0!==baseimage?(this.cloneImage(baseimage,opts),this.setCommentList(baseimage.getCommentList())):this.createImage(opts);let dataView=biswasm.get_array_view(Module,nifti_info[1],dataptr,internal.volsize);for(let k=0;k<internal.volsize;k++)internal.imgdata[k]=dataView[k];return 1}compareWithOther(other,method="maxabs",threshold=.01){let out={testresult:!1,value:null,metric:"maxabs"};if(other.constructor.name!==this.constructor.name)return console.log("COMPARE WITH OTHER RETURNING FALSE",other.constructor.name,"NOT EQUAL TO",this.constructor.name),out;if(console.log("....\t comparing images:",this.getDimensions(),other.getDimensions()),"cc"===method)out.value=util.computeCC(this.getImageData(),other.getImageData()),out.metric="cc",out.value>threshold&&(out.testresult=!0);else{if("ssd"===method){let odata=other.getImageData(),idata=this.getImageData(),l=idata.length,l2=odata.length;if(out.metric="ssd",l===l2&&l>1){let sum=0;for(let i=0;i<l;i++){let v=idata[i]-odata[i];sum+=v*v}out.value=Math.sqrt(sum)}else out.value=threshold+1}else out.value=this.maxabsdiff(other),out.metric="maxabs";out.value<threshold&&(out.testresult=!0)}return out}initialize(){this.internal.header=new bisheader,this.internal.header.initializenifti()}computeIntensityRange(){if(this.internal.range=[0,0],null===this.internal.imgdata)return;let l=this.internal.imgdata.length;if(0!==l){this.internal.range=[this.internal.imgdata[0],this.internal.imgdata[0]];for(let m=1;m<l;m++){let v=this.internal.imgdata[m];v>this.internal.range[1]?this.internal.range[1]=v:v<this.internal.range[0]&&(this.internal.range[0]=v)}}}getIntensityRange(){return this.internal.range[0]===this.internal.range[1]&&this.computeIntensityRange(),this.internal.range.slice(0)}getVoxel(coords){const internal=this.internal;let index=util.range(coords[0]+coords[1]*internal.offsets[1]+coords[2]*internal.offsets[2]+coords[3]*internal.offsets[3],0,internal.volsize-1);return internal.imgdata[index]}getImageData(){return this.internal.imgdata}getRawData(){return this.internal._rawdata}getDimensions(){return this.internal.dimensions.slice(0)}getBounds(margin){return[margin|=0,this.internal.dimensions[0]-(1+margin),margin,this.internal.dimensions[1]-(1+margin),margin,this.internal.dimensions[2]-(1+margin)]}getImageSize(){return[this.internal.dimensions[0]*this.internal.spacing[0],this.internal.dimensions[1]*this.internal.spacing[1],this.internal.dimensions[2]*this.internal.spacing[2]]}getSpacing(){return this.internal.spacing.slice(0)}cloneImage(inputimage,opts={}){const internal=this.internal;let newniftitype=opts.type||"same",newnumframes=opts.numframes||0,newnumcomponents=opts.numcomponents||0,newdims=opts.dimensions||"same",newspacing=opts.spacing||"same";if(null===inputimage.getRawData())return console.log("bad image, can not clone"),null;this.initialize();let headerdata=inputimage.getHeaderData(!0);this.parseNII(headerdata.data.buffer,!1,!0);let headerstruct=internal.header.struct;if("same"!==newniftitype){let ntype=internal.header.getniftitype(newniftitype);if(null!==ntype){headerstruct.datatype=ntype[2];let outmap=internal.header.gettypesize(ntype[0]);headerstruct.bitpix=8*outmap[0],internal.imginfo={type:ntype[1],size:headerstruct.bitpix/8,name:ntype[0]}}}BisWebImage.parseHeaderAndComputeOrientation(internal),"same"!==newdims&&BisWebImage.changeDimensions(internal,newdims),"same"!==newspacing&&BisWebImage.changeSpacing(internal,newspacing),0===newnumframes&&0===newnumcomponents||(0!==newnumframes&&(newnumframes=util.range(newnumframes,1,9999),internal.header.struct.dim[4]=newnumframes,internal.dimensions[3]=newnumframes),0!==newnumcomponents&&(newnumcomponents=util.range(newnumcomponents,1,9999),internal.header.struct.dim[5]=newnumcomponents,internal.dimensions[4]=newnumcomponents),internal.volsize=internal.dimensions[0]*internal.dimensions[1]*internal.dimensions[2]*internal.dimensions[3]*internal.dimensions[4]),internal.rawsize=internal.volsize*headerstruct.bitpix/8;let Imginfo=internal.imginfo.type,newbuffer=new ArrayBuffer(internal.rawsize);internal._rawdata=new Uint8Array(newbuffer),internal.imgdata=new Imginfo(newbuffer)}createImage(opts={}){const internal=this.internal;let newniftitype=opts.type||"short",newnumframes=opts.numframes||1,newnumcomponents=opts.numcomponents||1,newdims=opts.dimensions||[10,10,10],newspacing=opts.spacing||[1,1,1],orientation=opts.orientation||"RAS";this.initialize(),internal.header.createNIFTIHeader();let headerstruct=internal.header.struct,ntype=internal.header.getniftitype(newniftitype);if(null!==ntype){headerstruct.datatype=ntype[2];let outmap=internal.header.gettypesize(ntype[0]);headerstruct.bitpix=8*outmap[0],internal.imginfo={type:ntype[1],size:headerstruct.bitpix/8,name:ntype[0]}}BisWebImage.parseHeaderAndComputeOrientation(internal),"same"!==newdims&&BisWebImage.changeDimensions(internal,newdims),"same"!==newspacing&&BisWebImage.changeSpacing(internal,newspacing),0===newnumframes&&0===newnumcomponents||(0!==newnumframes&&(newnumframes=util.range(newnumframes,1,9999),internal.header.struct.dim[4]=newnumframes,internal.dimensions[3]=newnumframes),0!==newnumcomponents&&(newnumcomponents=util.range(newnumcomponents,1,9999),internal.header.struct.dim[5]=newnumcomponents,internal.dimensions[4]=newnumcomponents)),internal.volsize=internal.dimensions[0]*internal.dimensions[1]*internal.dimensions[2]*internal.dimensions[3]*internal.dimensions[4],internal.rawsize=internal.volsize*headerstruct.bitpix/8;let Imginfo=internal.imginfo.type,newbuffer=new ArrayBuffer(internal.rawsize);if(internal._rawdata=new Uint8Array(newbuffer),internal.imgdata=new Imginfo(newbuffer),"RAS"===orientation||"LPS"===orientation){let scale=1;"LPS"===orientation&&(scale=-1),internal.header.struct.srow_x[0]=scale*this.internal.spacing[0],internal.header.struct.srow_x[1]=0,internal.header.struct.srow_x[2]=0,internal.header.struct.srow_x[3]=0,internal.header.struct.srow_y[0]=0,internal.header.struct.srow_y[1]=scale*internal.spacing[1],internal.header.struct.srow_y[2]=0,internal.header.struct.srow_y[3]=0,internal.header.struct.srow_z[0]=0,internal.header.struct.srow_z[1]=0,internal.header.struct.srow_z[2]=internal.spacing[2],internal.header.struct.srow_z[3]=0,internal.header.struct.qform_code=0,internal.header.struct.sform_code=1,BisWebImage.parseHeaderAndComputeOrientation(internal)}}addoffset(input,offset,location){const internal=this.internal,debug=this.debug;let inp_data=input.getImageData(),l=internal.imgdata.length;if(l!=inp_data.length)throw new Error("Cannot add one to mis-sized image ");let dim=this.getDimensions(),index=0;location&&(index=location[0]+location[1]*dim[0]+location[2]*dim[0]*dim[1]),debug&&(console.log("..... Input Value at ",index," = ",inp_data[index]),console.log("..... in addone type = ",Object.prototype.toString.call(internal.imgdata),", length ",l,"adding "+offset));for(let i=0;i<l;i++)i%3e6==0&&debug&&console.log(".....",i,"/",l),internal.imgdata[i]=inp_data[i]+offset;debug&&console.log("..... Output Value at ",index," = ",internal.imgdata[index])}getOrientation(){return this.internal.orient}getOrientationName(){return this.internal.orient.name}getDataType(){return this.internal.imginfo.name}getHeader(){return this.internal.header}getHeaderData(keepextensions=!1){return this.internal.header.createHeaderRawData(keepextensions)}copyOrientationInfo(otherimage){this.getHeader().copyOrientationInfo(otherimage.getHeader(),this.getSpacing()),BisWebImage.parseHeaderAndComputeOrientation(this.internal),this.addComment({Operation:"Copied orientation info from "+otherimage.getFilename()})}maxabsdiff(other){const internal=this.internal;let inp_data=other.getImageData(),l=internal.imgdata.length,l2=inp_data.length;if(l!=l2||l<1)throw console.log("voxoffset=",internal.header.struct.vox_offset),console.log(this.printinfo("this")),console.log(other.printinfo("other")),console.log("Cannot run sumdiff due to mis-sized images this=l"+l+", other=l2="+l2+" d"+other.getDimensions()+" vs"+this.getDimensions()),new Error("Cannot run sumdiff due to mis-sized images this=l"+l+", other=l2="+l2+" d"+other.getDimensions()+" vs"+this.getDimensions());this.debug&&console.log("..... Input Values at ",0," = ",inp_data[0],internal.imgdata[0]);let maxd=0;for(let i=0;i<l;i++){i%3e6==0&&this.debug&&console.log(".....",i,"/",l);let d=Math.abs(internal.imgdata[i]-inp_data[i]);d>maxd&&(maxd=d)}return this.debug&&console.log("..... maxabsdiff=",maxd),maxd}hasSameSizeAndOrientation(otherimage,threshold=.01,spaceonly=!1){let d1=this.getDimensions(),d2=otherimage.getDimensions(),s1=this.getSpacing(),s2=otherimage.getSpacing(),same=!0,maxd=d1.length,maxs=s1.length;spaceonly&&(maxs=3,maxd=3);for(let i=0;i<maxd;i++)d1[i]!==d2[i]&&(same=!1);if(same){d1[3]*d1[4]<=1&&d2[3]*d2[4]<=1&&(maxs=3);for(let i=0;i<maxs;i++){Math.abs(s1[i]-s2[i])>threshold&&(same=!1)}if(same){this.getOrientationName()!==otherimage.getOrientationName()&&(same=!1)}}return same}createFromHeader(header){this.initialize();let hdata=header.createHeaderRawData(!1);this.internal.header.parse(hdata.data.buffer,hdata.length),this.debug&&console.log("+++++ dims=",this.internal.header.struct.dim[1],this.internal.header.struct.dim[2],this.internal.header.struct.dim[3],this.internal.header.struct.dim[4]);let dt=this.internal.header.struct.datatype,typename=this.internal.header.getniftitype(dt);this.internal.imginfo={type:typename[1],size:this.internal.header.struct.bitpix/8,name:typename[0]},this.debug&&console.log("+++++ imginfo",this.internal.imginfo.type," tn=",typename," dt=",dt),BisWebImage.parseHeaderAndComputeOrientation(this.internal),this.internal.rawsize=this.internal.volsize*this.internal.header.struct.bitpix/8;let Imginfo=this.internal.imginfo.type;return this.internal._rawdata=new Uint8Array(this.internal.rawsize),this.internal.imgdata=new Imginfo(this.internal._rawdata.buffer),this.debug&&console.log("+++++ created rawdata of size="+this.internal._rawdata.length),this.internal.range[0]=0,this.internal.range[1]=0,!0}serializeToNII(){const internal=this.internal;let dt=internal.header.struct.datatype,typename=internal.header.getniftitype(dt);this.debug&&console.log("+++++++ serialiazing dt=",dt," tpname=",typename),internal.header.setExtensionsFromArray(this.commentlist);let headerbin=this.getHeaderData(!0),rawdata=this.getRawData();if(null===internal.singlebuffer){let c=new Uint8Array(headerbin.length+rawdata.length);return c.set(headerbin.data),c.set(rawdata,headerbin.length),headerbin=null,rawdata=null,c}return this.debug&&console.log("this is a single buffer case ..."),new Uint8Array(internal.singlebuffer,0,headerbin.length+rawdata.length)}parseNII(_inputbuffer,forceorient_in,forcecopy=!1){let forceorient=userPreferences.sanitizeOrientationOnLoad(forceorient_in);const debug=this.debug,internal=this.internal;debug&&console.log("..... in PARSENII BUFFER forceorient=",forceorient);let tmpheaderdata,tmpfloat=new Float32Array(_inputbuffer,108,1),len=Math.floor(tmpfloat[0]),swap=!1;if(len<300){let orig=new Uint8Array(_inputbuffer,108,4),tmp=new Uint8Array(4);tmp[0]=orig[3],tmp[1]=orig[2],tmp[2]=orig[1],tmp[3]=orig[0];let tmpfloat=new Float32Array(tmp.buffer);len=Math.floor(tmpfloat),swap=!0}if(debug&&console.log("Len = ",len," swap=",swap),len<1)throw new Error("BAD BAD BAD ..... in PARSENII BUFFER len="+len);if(internal.singlebuffer=null,tmpheaderdata=_inputbuffer.slice(0,len),internal.header.parse(tmpheaderdata,len,swap),0===internal.header.struct.dim[1])throw new Error("BAD dimensions");debug&&(console.log("+++++ dims=",internal.header.struct.dim[1],internal.header.struct.dim[2],internal.header.struct.dim[3],internal.header.struct.dim[4]),console.log("+++++ Read header type = ",Object.prototype.toString.call(tmpheaderdata)," off",internal.header.struct.vox_offset)),tmpheaderdata=null;let dt=internal.header.struct.datatype,typename=internal.header.getniftitype(dt);debug&&console.log("+++++++ dt=",dt," tpname=",typename),internal.imginfo={type:typename[1],size:internal.header.struct.bitpix/8,name:typename[0]},debug&&console.log("+++++ imginfo",internal.imginfo.type," tn=",typename," dt=",dt),BisWebImage.parseHeaderAndComputeOrientation(internal,debug);let headerlength=internal.header.struct.vox_offset;internal.rawsize=internal.volsize*internal.header.struct.bitpix/8;let Imginfo=internal.imginfo.type,imgend=headerlength+internal.rawsize;if(swap){let _tmp=new Uint8Array(_inputbuffer,headerlength,internal.rawsize),sizeoftype=internal.imginfo.size,half=sizeoftype/2;console.log("Byte swapping data",headerlength,internal.rawsize,sizeoftype,half);for(let i=0;i<internal.rawsize;i++){let offset=i*sizeoftype;for(let j=0;j<half;j++){let j1=j+offset,tmp1=_tmp[j1],j2=offset+sizeoftype-(j+1);_tmp[j1]=_tmp[j2],_tmp[j2]=tmp1}}}if("None"===forceorient||forceorient===internal.orient.name)internal._rawdata=new Uint8Array(_inputbuffer.slice(headerlength,imgend)),internal.imgdata=new Imginfo(internal._rawdata.buffer),debug&&console.log("++++++ not permuting data"),internal.forcedorientationchange=!1;else{let newbuffer=new ArrayBuffer(internal.rawsize);internal._rawdata=new Uint8Array(newbuffer),internal.imgdata=new Imginfo(newbuffer);let origdata=new Imginfo(_inputbuffer);debug&&console.log("+++++ permuting data ",forceorient),BisWebImage.permuteDataToMatchDesiredOrientation(internal,origdata,headerlength/internal.imginfo.size,internal.imgdata,forceorient,debug),internal.forcedorientationchange=!0}for(let i=0;i<internal.imgdata.length;i++)internal.imgdata[i]!=internal.imgdata[i]&&(internal.imgdata[i]=0);this.commentlist=internal.header.parseExtensionsToArray(),this.computeIntensityRange()}parseSingleFrameTIFF(input_rawdata,filename,forceorient){let decoder=tiff.newobject(input_rawdata);decoder.decodeHeader();let frame=decoder.decodeIFD({ignoreImageData:!1}),xspa=frame.xResolution||.025,yspa=frame.yResolution||.025,zspa=frame.zResolution||1,data_type="ushort";"Int16Array"===frame.data.constructor.name&&(data_type="short"),console.log("Creating image",xspa,yspa,zspa);let orient="LPS";"RAS"===forceorient&&(orient="RAS"),this.createImage({dimensions:[frame.width,frame.height,1],numframes:1,spacing:[xspa,yspa,zspa],type:data_type,orientation:orient});let data=this.getImageData();if(data.set(frame.data),console.log("ForceOrient=",forceorient),"RAS"===orient){let maxi=frame.width-1,maxj=frame.height-1,half=Math.floor(.5*frame.height);for(let i=0;i<frame.width;i++)for(let j=0;j<half;j++){let index1=j*frame.width+i,index2=maxi-i+(maxj-j)*frame.width,tmp=data[index2];data[index2]=data[index1],data[index1]=tmp}}for(let i=0;i<data.length;i++)data[i]!=data[i]&&(data[i]=0);let fname=filename;fname.name&&(fname=fname.name),this.setFilename(fname),this.commentlist=["loaded from "+fname+" forceorient="+forceorient],this.computeIntensityRange()}parseTIFF(inputbuffer,filename,forceorient){this.debug=1;const internal=this.internal;let input_rawdata=new Uint8Array(inputbuffer),numframes=tiff.pageCount(input_rawdata);if(1===numframes)return void this.parseSingleFrameTIFF(input_rawdata,filename,forceorient);let orient="LPS";"RAS"===forceorient&&(orient="RAS"),numframes>500&&(this.debug=2),console.log("+++++++++++++++++++++++++++++++++++++++++\n"),console.log("+++++ Parsing tiff numpages=",numframes," filename=",filename,input_rawdata.constructor.name,input_rawdata.length,"buffername=",inputbuffer.constructor.name);let decoder=tiff.newobject(input_rawdata);decoder.decodeHeader();let numpieces=500;numpieces>numframes&&(numpieces=numframes);let temp_img=new BisWebImage,pieceframe=0,storeoffset=0,lastframe=0,data_type="ushort";for(let f=0;f<numframes;f++){let frame=decoder.decodeIFD({ignoreImageData:!1});if(0==f){"Int16Array"===frame.data.constructor.name&&(data_type="short");let xspa=frame.xResolution||.025,yspa=frame.yResolution||.025;temp_img.createImage({dimensions:[frame.width,frame.height,1],numframes:numpieces,spacing:[xspa,yspa,1],orientation:orient,type:data_type})}let data=temp_img.getImageData(),temp_offset=frame.width*frame.height*pieceframe,slicebytesize=2*frame.data.length,bisoffset=data.bisbyteoffset||0,data_part=null;if((data_part="short"===data_type?new Int16Array(data.buffer,bisoffset+2*temp_offset,frame.data.length):new Uint16Array(data.buffer,bisoffset+2*temp_offset,frame.data.length)).set(frame.data),"RAS"===orient){let maxi=frame.width-1,maxj=frame.height-1,half=Math.floor(.5*frame.height);for(let i=0;i<frame.width;i++)for(let j=0;j<half;j++){let index1=j*frame.width+i,index2=maxi-i+(maxj-j)*frame.width,tmp=data_part[index2];data_part[index2]=data_part[index1],data_part[index1]=tmp}}if((pieceframe+=1)>=numpieces||f===numframes-1){let nextstrip=frame.stripOffsets[0]+slicebytesize,nextstore=storeoffset+slicebytesize*numpieces;if(nextstore>=nextstrip)throw new Error(`Can not store this tiff image strip=${nextstrip} < ${nextstore}, slicesize=${slicebytesize}`);if(0===storeoffset){let header=temp_img.getHeader();header.struct.dim[0]=4,header.struct.dim[4]=numframes;let dat=header.createHeaderRawData(!1).data;new Uint8Array(inputbuffer,0,dat.length).set(dat),storeoffset=dat.length}let buffersize=pieceframe*slicebytesize,data=temp_img.getImageData(),numpieceframes=f-lastframe+1,newsize=frame.width*frame.height*numpieceframes,temp16=null,data16=null;"ushort"===data_type?(temp16=new Uint16Array(inputbuffer,storeoffset,newsize),data16=new Uint16Array(data.buffer,0,newsize)):(temp16=new Int16Array(inputbuffer,storeoffset,newsize),data16=new Int16Array(data.buffer,0,newsize)),(this.debug>1||numframes>2e3)&&console.log(`Beginning to store frames ${lastframe}:${f} from ${storeoffset} to ${storeoffset+buffersize} (length in bytes=${buffersize}, ${(f-lastframe+1)*slicebytesize}) newsize=${newsize} `),temp16.set(data16),storeoffset+=buffersize,pieceframe=0,lastframe=f+1}}internal.singlebuffer=inputbuffer,internal.header.parse(inputbuffer,352);let dt=internal.header.struct.datatype,typename=internal.header.getniftitype(dt);internal.imginfo={type:typename[1],size:internal.header.struct.bitpix/8,name:typename[0]},BisWebImage.parseHeaderAndComputeOrientation(internal);let headerlength=internal.header.struct.vox_offset;internal.rawsize=internal.volsize*internal.header.struct.bitpix/8;let Imginfo=internal.imginfo.type;internal._rawdata=new Uint8Array(inputbuffer,headerlength,internal.rawsize),internal.imgdata=new Imginfo(inputbuffer,headerlength,internal.volsize),internal._rawdata.bisbyteoffset=headerlength,internal.imgdata.bisbyteoffset=headerlength,this.computeIntensityRange(),this.setFilename(filename)}printinfo(comment){const internal=this.internal;let a="+++++ Printing image info:"+(comment=comment||"")+"\n";if(a+="+++++ dimensions= :"+internal.dimensions+", spacing="+internal.spacing+", orient="+internal.orient.name+" "+internal.orient.axis+" "+internal.orient.flip+"(inv="+internal.orient.invaxis+","+internal.orient.invflip+")",a+=" range "+internal.range+" data type="+internal.header.struct.datatype+"("+internal.imginfo.name+")\n",null!==internal.imgdata){a+="+++++ type of imgdata:"+Object.prototype.toString.call(internal.imgdata)+", size of imgdata:"+internal.imgdata.length+"("+internal._rawdata.length+"), bitpix="+internal.header.struct.bitpix}return a}addQuaternionCode(Module){const internal=this.internal;if(0!==internal.header.struct.qform_code||0===internal.header.struct.sform_code)return;let mat=new BisWebMatrix;mat.allocate(4,4,0),mat.setElement(3,3,1);for(let j=0;j<=3;j++)mat.setElement(0,j,internal.header.struct.srow_x[j]),mat.setElement(1,j,internal.header.struct.srow_y[j]),mat.setElement(2,j,internal.header.struct.srow_z[j]);let quat=Module.niftiMat44ToQuaternionWASM(mat).data;console.log("quat=",quat[0],quat[1],quat[2]," ",quat[3],quat[4],quat[5]),internal.header.struct.qform_code=1,internal.header.struct.qoffset_b=quat[0],internal.header.struct.qoffset_c=quat[1],internal.header.struct.qoffset_d=quat[2],internal.header.struct.qoffset_x=quat[3],internal.header.struct.qoffset_y=quat[4],internal.header.struct.qoffset_z=quat[5],internal.header.struct.pixdim[0]=quat[9],internal.header.struct.pixdim[1]=quat[6],internal.header.struct.pixdim[2]=quat[7],internal.header.struct.pixdim[3]=quat[8]}static changeSpacing(internal,newspa){if(internal.header.struct.pixdim[1]=newspa[0],internal.header.struct.pixdim[2]=newspa[1],internal.header.struct.pixdim[3]=newspa[2],internal.header.struct.sform_code>0){let sx=internal.header.struct.srow_x,sy=internal.header.struct.srow_y,sz=internal.header.struct.srow_z,magn=[Math.sqrt(sx[0]*sx[0]+sx[1]*sx[1]+sx[2]*sx[2]),Math.sqrt(sy[0]*sy[0]+sy[1]*sy[1]+sy[2]*sy[2]),Math.sqrt(sz[0]*sz[0]+sz[1]*sz[1]+sz[2]*sz[2])];for(let ia=0;ia<=2;ia++)sx[ia]*=newspa[0]/magn[0],sy[ia]*=newspa[1]/magn[1],sz[ia]*=newspa[2]/magn[2]}for(let i=0;i<=2;i++)internal.spacing[i]=newspa[i]}static changeDimensions(internal,newdim){let l=newdim.length;if(l<3||l>5)throw new Error("Cannot change dimensions to "+newdim+" bad array");for(let i=0;i<l;i++)internal.dimensions[i]=newdim[i],internal.header.struct.dim[i+1]=newdim[i];internal.volsize=internal.dimensions[0]*internal.dimensions[1]*internal.dimensions[2]*internal.dimensions[3]*internal.dimensions[4],internal.offsets=[1,internal.dimensions[0],internal.dimensions[0]*internal.dimensions[1],internal.dimensions[0]*internal.dimensions[1]*internal.dimensions[2],internal.dimensions[0]*internal.dimensions[1]*internal.dimensions[3]]}static parseHeaderAndComputeOrientation(internal,debug=0){let IJKToRAS=simplemat.GMMat4.createFloat32();simplemat.GMMat4.setRowValues(IJKToRAS,3,0,0,0,1);let i=0,pixdim=internal.header.struct.pixdim,dim=internal.header.struct.dim;if(internal.header.struct.qform_code>0){let a=0,b=internal.header.struct.quatern_b,c=internal.header.struct.quatern_c,d=internal.header.struct.quatern_d,xd=1,yd=1,zd=1,qx=internal.header.struct.qoffset_x,qy=internal.header.struct.qoffset_y,qz=internal.header.struct.qoffset_z;(a=1-(b*b+c*c+d*d))<1e-7?(b*=a=1/Math.sqrt(b*b+c*c+d*d),c*=a,d*=a,a=0):a=Math.sqrt(a),pixdim[1]>0&&(xd=pixdim[1]),pixdim[2]>0&&(yd=pixdim[2]),pixdim[2]>0&&(zd=pixdim[3]),pixdim[0]<0&&(zd=-zd),simplemat.GMMat4.setRowValues(IJKToRAS,0,(a*a+b*b-c*c-d*d)*xd,2*(b*c-a*d)*yd,2*(b*d+a*c)*zd,qx),simplemat.GMMat4.setRowValues(IJKToRAS,1,2*(b*c+a*d)*xd,(a*a+c*c-b*b-d*d)*yd,2*(c*d-a*b)*zd,qy),simplemat.GMMat4.setRowValues(IJKToRAS,2,2*(b*d-a*c)*xd,2*(c*d+a*b)*yd,(a*a+d*d-c*c-b*b)*zd,qz)}else if(internal.header.struct.sform_code>0){let sx=internal.header.struct.srow_x,sy=internal.header.struct.srow_y,sz=internal.header.struct.srow_z;simplemat.GMMat4.setRowValues(IJKToRAS,0,sx[0],sx[1],sx[2],sx[3]),simplemat.GMMat4.setRowValues(IJKToRAS,1,sy[0],sy[1],sy[2],sy[3]),simplemat.GMMat4.setRowValues(IJKToRAS,2,sz[0],sz[1],sz[2],sz[3]),pixdim[1]=Math.sqrt(sx[0]*sx[0]+sy[0]*sy[0]+sz[0]*sz[0]),pixdim[2]=Math.sqrt(sx[1]*sx[1]+sy[1]*sy[1]+sz[1]*sz[1]),pixdim[3]=Math.sqrt(sx[2]*sx[2]+sy[2]*sy[2]+sz[2]*sz[2])}else 0===internal.header.struct.qform_code?(simplemat.GMMat4.setRowValues(IJKToRAS,0,pixdim[1],0,0,0),simplemat.GMMat4.setRowValues(IJKToRAS,1,0,pixdim[2],0,0),simplemat.GMMat4.setRowValues(IJKToRAS,2,0,0,pixdim[3],0)):console.log("UNKNOWN METHOD IN PARSER NIIX");internal.orient.IJKToRAS=IJKToRAS,0===dim[5]&&(dim[5]=1),0===pixdim[5]&&(pixdim[5]=1),internal.dimensions=[dim[1],dim[2],dim[3],dim[4],dim[5]],internal.spacing=[pixdim[1],pixdim[2],pixdim[3],pixdim[4],pixdim[5]];for(let ik=0;ik<=2;ik++)internal.spacing[ik]=.001*Math.round(1e3*internal.spacing[ik]);internal.volsize=dim[1]*dim[2]*dim[3]*dim[4]*dim[5],internal.offsets=[1,dim[1],dim[1]*dim[2],dim[1]*dim[2]*dim[3],dim[1]*dim[2]*dim[3]*dim[4]];let A=numeric.identity(3),S=numeric.identity(3);for(let ia=0;ia<=2;ia++){for(let ib=0;ib<=2;ib++)A[ia][ib]=internal.orient.IJKToRAS[ia+4*ib];S[ia][ia]=1/internal.spacing[ia]}let OR=numeric.dot(A,S);debug&&(console.log("\n A=\n",numeric.prettyPrint(A)),console.log("\n OR=\n",numeric.prettyPrint(OR)));let axis=[0,1,2],flip=[0,0,0],order=[2,0,1],left=[2,0,1];for(let i=0;i<=2;i++){let ia=order[i];axis[ia]=left[0];for(let ib=1;ib<left.length;ib++){let other=left[ib];Math.abs(OR[ia][other])>Math.abs(OR[ia][axis[ia]])&&(axis[ia]=other)}OR[ia][axis[ia]]<0&&(flip[ia]=1);for(let k=0;k<=2;k++)OR[k][axis[ia]]=0,OR[ia][k]=0;for(let col=0;col<=2;col++){let sum=0;for(let row=0;row<=2;row++)sum+=OR[row][col]*OR[row][col];if(sum>0){sum=Math.sqrt(sum);for(let row=0;row<=2;row++)OR[row][col]=OR[row][col]/sum}}let ind=left.indexOf(axis[ia]);ind>=0&&left.splice(ind,1),debug&&(i<2&&console.log("\n Blanked OR=\n",numeric.prettyPrint(OR)),console.log("Left = ",left))}debug&&console.log("Final axis=",axis," flip=",flip),internal.orient.axis=axis;for(let k=0;k<=2;k++){let cj=0,truej=0;for(;cj<=2;)axis[cj]==k&&(truej=cj,cj=3),++cj;internal.orient.invaxis[k]=truej,internal.orient.invflip[k]=flip[truej]}internal.orient.flip=flip,internal.orient.name="";let names=[["L","R"],["P","A"],["I","S"]];for(i=0;i<=2;i++)internal.orient.name+=names[internal.orient.invaxis[i]][1-internal.orient.invflip[i]]}static permuteHeaderDimensionsSpacing(internal){let axis=internal.orient.axis,olddim=[internal.dimensions[0],internal.dimensions[1],internal.dimensions[2]],oldspa=[internal.spacing[0],internal.spacing[1],internal.spacing[2]],newdim=[],newspa=[];for(let i=0;i<=2;i++)newdim[i]=olddim[axis[i]],newspa[i]=oldspa[axis[i]];BisWebImage.changeDimensions(internal,newdim),BisWebImage.changeSpacing(internal,newspa)}static permuteDataToMatchDesiredOrientation(internal,inarray,inoffset,outarray,forceorient,debug=!1){let dim=[internal.dimensions[0],internal.dimensions[1],internal.dimensions[2]],framesize=dim[0]*dim[1]*dim[2];BisWebImage.permuteHeaderDimensionsSpacing(internal);let outincr=[1,internal.dimensions[0],internal.dimensions[0]*internal.dimensions[1]],ia=[0,0,0],ib=[0,0,0],j=0,outindex=0,frame=0,baseframe=0,nc=internal.dimensions[3]*internal.dimensions[4],index=inoffset,flipdim=[internal.dimensions[0]-1,internal.dimensions[1]-1,internal.dimensions[2]-1],axis=[internal.orient.axis[0],internal.orient.axis[1],internal.orient.axis[2]],flip=[internal.orient.flip[0],internal.orient.flip[1],internal.orient.flip[2]],oname="RAS",max=0;if(internal.orient.invaxis=[0,1,2],"LPS"===forceorient?(oname="LPS",max=2,internal.orient.invflip=[1,1,0]):"LAS"==forceorient?(oname="LAS",max=1,internal.orient.invflip=[1,0,0]):internal.orient.invflip=[0,0,0],max>0)for(let ia=0;ia<max;ia++)flip[ia]=1-flip[ia],internal.orient.flip[ia]=1-internal.orient.flip[ia];for(debug&&console.log("++++ orient=",oname,"flip=",flip,"max=",max),ia[2]=0;ia[2]<dim[2];ia[2]++)for(ia[1]=0;ia[1]<dim[1];ia[1]++)for(ia[0]=0;ia[0]<dim[0];ia[0]++){for(outindex=0,j=0;j<=2;j++)flip[j]?ib[j]=flipdim[j]-ia[axis[j]]:ib[j]=ia[axis[j]],outindex+=ib[j]*outincr[j];if(nc>0)for(frame=0;frame<nc;frame++)outarray[outindex+(baseframe=frame*framesize)]=inarray[index+baseframe];else outarray[outindex]=inarray[index];++index}internal.orient.name=oname;let A=numeric.identity(4);for(let i=0;i<=3;i++)for(let j=0;j<=3;j++)A[i][j]=internal.orient.IJKToRAS[i+4*j];let B=numeric.rep([4,4],0);B[3][3]=1,debug&&console.log("Axis=",axis," flip=",flip," dim=",flipdim);for(let i=0;i<=2;i++){let ax=axis[i];flip[i]?(B[ax][3]=flipdim[i],B[ax][i]=-1):B[ax][i]=1}let C=numeric.dot(A,B),fn=function(A,name){let s=name+"= [ ";for(let i=0;i<=3;i++)for(let j=0;j<=3;j++)s+=A[i][j]+" ",3==j&&3!==i&&(s+=";");s+="];",console.log(s)};debug&&(fn(A,"A"),fn(B,"B"),fn(C,"C"));for(let row=0;row<=2;row++)simplemat.GMMat4.setRowValues(internal.orient.IJKToRAS,row,C[row][0],C[row][1],C[row][2],C[row][3]);internal.header.struct.qform_code=0,internal.header.struct.sform_code=1;for(let i=0;i<=3;i++)internal.header.struct.srow_x[i]=C[0][i],internal.header.struct.srow_y[i]=C[1][i],internal.header.struct.srow_z[i]=C[2][i];internal.orient.axis=[0,1,2]}}module.exports=BisWebImage},"./js/dataobjects/bisweb_lineartransformation.js":function(module,exports,__webpack_require__){"use strict";const util=__webpack_require__("./js/core/bis_util.js"),numeric=__webpack_require__("./node_modules/numeric/numeric-1.2.6.js"),biswasm=__webpack_require__("./js/core/bis_wasmutils.js"),BisWebBaseTransformation=__webpack_require__("./js/dataobjects/bisweb_basetransformation.js"),eulerXYZRotationMatrix=function(theta,offset,out){let rad=[0,0,0];for(let i=0;i<=2;i++)rad[i]=Math.PI*theta[i+offset]/180;let cz=Math.cos(rad[2]),sz=Math.sin(rad[2]),cy=Math.cos(rad[1]),sy=Math.sin(rad[1]),cx=Math.cos(rad[0]),sx=Math.sin(rad[0]);out[0][0]=cy*cz,out[0][1]=cy*sz,out[0][2]=sy,out[1][0]=-cx*sz-cz*sx*sy,out[1][1]=cx*cz-sx*sy*sz,out[1][2]=cy*sx,out[2][0]=sx*sz-cx*cz*sy,out[2][1]=-cz*sx-cx*sy*sz,out[2][2]=cx*cy},optimizeMatrix=function(matrix,cache,spa){cache.A00=matrix[0][0],cache.A01=matrix[0][1],cache.A02=matrix[0][2],cache.A03=matrix[0][3],cache.A10=matrix[1][0],cache.A11=matrix[1][1],cache.A12=matrix[1][2],cache.A13=matrix[1][3],cache.A20=matrix[2][0],cache.A21=matrix[2][1],cache.A22=matrix[2][2],cache.A23=matrix[2][3],cache.spa0=spa[0],cache.spa1=spa[1],cache.spa2=spa[2]},inPlaceMatrixMultiply=function(a,b,result){let l=result.length;for(let row=0;row<l;row++)for(let col=0;col<l;col++){result[row][col]=0;for(let index=0;index<l;index++)result[row][col]+=a[row][index]*b[index][col]}},inPlaceIdentity=function(mat){let l=mat.length;for(let i=0;i<l;i++)for(let j=0;j<l;j++)mat[i][j]=i==j?1:0},getOutputLength=function(n1,n2,rigidOnly){return rigidOnly?6:(n2<n1&&(n1=n2),n1)};module.exports=class extends BisWebBaseTransformation{constructor(mode=0){super(),this.jsonformatname="BisLinearTransformation",this.legacyextension="matr",this.internal_cache={A00:0,A01:0,A02:0,A03:0,A10:0,A11:0,A12:0,A13:0,A20:0,A21:0,A22:0,A23:0,spa0:0,spa1:0,spa2:0},this.internal={mode:0,temp:null,mshift1:null,mshift2:null,parameters:[0,0,0,0,0,0,1,1,1,0,0,0],matrix:numeric.identity(4)},this.initialize(mode)}getDescription(pretty){if(!pretty)return this.legacySerialize("; ");let s=this.getFilename()||"";return" "!==s&&(s+="\n"),s+this.legacySerialize("\n")}computeHash(){return util.SHA256(this.matrix)}getMemorySize(){return 256}serializeToDictionary(){let obj=super.serializeToDictionary();return obj.matrix=this.internal.matrix,obj.parameters=this.getParameterVector({scale:!0}),obj}parseFromDictionary(b){this.initialize(this.internal.mode),this.setParameterVector(b.parameters,{scale:!0});for(var i=0;i<=3;i++)for(var j=0;j<=3;j++)this.internal.matrix[i][j]=b.matrix[i][j];return super.parseFromDictionary(b),!0}deserializeWasm(Module,wasmarr){const wasmobj=biswasm.unpackStructure(Module,wasmarr);let bad=!0,vector=!1;if(wasmobj.magic_type===biswasm.get_matrix_magic_code(Module)&&29===wasmobj.data_array.length?(vector=!0,bad=!1):bad=wasmobj.magic_type!==biswasm.get_matrix_magic_code(Module)||4!==wasmobj.dimensions[0]||4!==wasmobj.dimensions[1],!0===bad)return console.log("Bad wasmobj",wasmobj.magic_type,wasmobj.dimensions,wasmobj.data_array.length),0;vector&&(this.internal.mode=Math.floor(wasmobj.data_array[28])),this.initialize(this.internal.mode);for(let i=0;i<4;i++)for(let j=0;j<4;j++)this.internal.matrix[i][j]=wasmobj.data_array[4*i+j];if(vector)for(let i=0;i<12;i++)this.internal.parameters[i]=wasmobj.data_array[16+i];return 1}compareWithOther(other,method="maxabs",threshold=.01){let out={testresult:!1,value:null,metric:"maxabs"};if(other.constructor.name!==this.constructor.name)return out;let mymatrix=this.getMatrix(),othermatrix=other.getMatrix();return console.log("....\t comparing transformation matrices:",numeric.dim(mymatrix),numeric.dim(othermatrix)),"maxabs"===method?out.value=numeric.norminf(numeric.sub(mymatrix,othermatrix)):(out.value=numeric.norm2(numeric.sub(mymatrix,othermatrix)),out.metric="ssd"),out.value<threshold&&(out.testresult=!0),out}identity(){inPlaceIdentity(this.internal.matrix);for(let i=0;i<=11;i++)this.internal.parameters[i]=i<6||i>8?0:1;this.transformPointToVoxel=this.transformPointToVoxelSlow,this.setFilename("identity.matr")}transformPoint(X,TX){TX[0]=this.internal.matrix[0][0]*X[0]+this.internal.matrix[0][1]*X[1]+this.internal.matrix[0][2]*X[2]+this.internal.matrix[0][3],TX[1]=this.internal.matrix[1][0]*X[0]+this.internal.matrix[1][1]*X[1]+this.internal.matrix[1][2]*X[2]+this.internal.matrix[1][3],TX[2]=this.internal.matrix[2][0]*X[0]+this.internal.matrix[2][1]*X[1]+this.internal.matrix[2][2]*X[2]+this.internal.matrix[2][3]}seriesMultiply(arr){var i,j,l=arr.length,index=0;for(inPlaceMatrixMultiply(arr[l-2],arr[l-1],this.internal.temp[0]),i=l-3;i>=0;i-=1)inPlaceMatrixMultiply(arr[i],this.internal.temp[index],i>0?this.internal.temp[1-index]:this.internal.matrix),index=1-index;for(i=0;i<=3;i++)for(j=0;j<=3;j++)Math.abs(this.internal.matrix[i][j])<1e-5&&(this.internal.matrix[i][j]=0)}updateInternalMatrix2d(){var i,thetas=[0,0,this.internal.parameters[5]],TR=numeric.identity(4);for(eulerXYZRotationMatrix(thetas,0,TR),i=0;i<=1;i++)TR[i][3]=this.internal.parameters[i];if(0!==this.internal.mode){var sc;sc=5===this.internal.mode?[this.internal.parameters[6],this.internal.parameters[6],1]:[this.internal.parameters[6],this.internal.parameters[7],1];var S=numeric.identity(4);for(i=0;i<=2;i++)S[i][i]=sc[i];if(6===this.internal.mode){var Q=numeric.identity(4),dthetas=[0,0,this.internal.parameters[11]];eulerXYZRotationMatrix(dthetas,0,Q),this.seriesMultiply([this.internal.mshift2,TR,S,Q,this.internal.mshift1])}else this.seriesMultiply([this.internal.mshift2,TR,S,this.internal.mshift1])}else this.seriesMultiply([this.internal.mshift2,TR,this.internal.mshift1])}updateInternalMatrix(){if(this.internal.mode>3)return this.updateInternalMatrix2d();var i,TR=numeric.identity(4);for(eulerXYZRotationMatrix(this.internal.parameters,3,TR),i=0;i<=2;i++)TR[i][3]=this.internal.parameters[i];if(0!==this.internal.mode){var sc;sc=1===this.internal.mode?[this.internal.parameters[6],this.internal.parameters[6],this.internal.parameters[6]]:[this.internal.parameters[6],this.internal.parameters[7],this.internal.parameters[8]];var S=numeric.identity(4);for(i=0;i<=2;i++)S[i][i]=sc[i];if(3===this.internal.mode){var Q=numeric.identity(4);eulerXYZRotationMatrix(this.internal.parameters,9,Q),this.seriesMultiply([this.internal.mshift2,TR,S,Q,this.internal.mshift1])}else this.seriesMultiply([this.internal.mshift2,TR,S,this.internal.mshift1])}else this.seriesMultiply([this.internal.mshift2,TR,this.internal.mshift1])}initialize(mode){mode=mode||0,this.internal.mode=util.range(mode,0,6),this.internal.temp=[numeric.identity(4),numeric.identity(4)],this.internal.mshift1=numeric.identity(4),this.internal.mshift2=numeric.identity(4),this.internal.matrix=numeric.identity(4),this.identity()}getNumberOfDOF(){return 3==this.internal.mode?12:2==this.internal.mode?9:1==this.internal.mode?7:4==this.internal.mode?3:5==this.internal.mode?4:(this.internal.mode,6)}transformPointToVoxelSlow(X,TX,spa){TX[0]=(this.internal.matrix[0][0]*X[0]+this.internal.matrix[0][1]*X[1]+this.internal.matrix[0][2]*X[2]+this.internal.matrix[0][3])/spa[0],TX[1]=(this.internal.matrix[1][0]*X[0]+this.internal.matrix[1][1]*X[1]+this.internal.matrix[1][2]*X[2]+this.internal.matrix[1][3])/spa[1],TX[2]=(this.internal.matrix[2][0]*X[0]+this.internal.matrix[2][1]*X[1]+this.internal.matrix[2][2]*X[2]+this.internal.matrix[2][3])/spa[2]}transformPointToVoxelFast(X,TX){var X0=X[0],X1=X[1],X2=X[2];TX[0]=(this.internal_cache.A00*X0+this.internal_cache.A01*X1+this.internal_cache.A02*X2+this.internal_cache.A03)/this.internal_cache.spa0,TX[1]=(this.internal_cache.A10*X0+this.internal_cache.A11*X1+this.internal_cache.A12*X2+this.internal_cache.A13)/this.internal_cache.spa1,TX[2]=(this.internal_cache.A20*X0+this.internal_cache.A21*X1+this.internal_cache.A22*X2+this.internal_cache.A23)/this.internal_cache.spa2}getMatrix(){return this.internal.matrix}setMatrix(m){for(var i=0;i<=3;i++)for(var j=0;j<=3;j++)this.internal.matrix[i][j]=m[i][j];this.transformPointToVoxel=this.transformPointToVoxelSlow}optimize(spa){optimizeMatrix(this.internal.matrix,this.internal_cache,spa),this.transformPointToVoxel=this.transformPointToVoxelFast}legacySerialize(s){s=s||"\n";for(var outstring="",i=0;i<4;i++)outstring+=this.internal.matrix[i][0].toFixed(3)+" "+this.internal.matrix[i][1].toFixed(3)+" "+this.internal.matrix[i][2].toFixed(3)+" "+this.internal.matrix[i][3].toFixed(3)+s;return outstring}legacyParseFromText(inpstring,filename){this.identity();var lines=inpstring.split("\n");if(lines.length<4)return console.log("Failed to deserialize "+filename+" bad file"),!1;for(var row=0;row<4;row++){var x=lines[row].replace(/ +(?= )/g,"").trim().split(" ");if(4!=x.length)return console.log("Failed to deseriaalize "+filename+" bad file. split="+x.join(":")+", line="+lines[row]),!1;for(var j=0;j<=3;j++)this.internal.matrix[row][j]=parseFloat(x[j])}return!0}copy(other){this.parseFromDictionary(other.serializeToDictionary())}setShifts(dim_ref,spa_ref,dim_trg,spa_trg){inPlaceIdentity(this.internal.mshift1),inPlaceIdentity(this.internal.mshift2);for(var i=0;i<=2;i++)this.internal.mshift1[i][3]=-.5*(dim_ref[i]-1)*spa_ref[i],this.internal.mshift2[i][3]=.5*(dim_trg[i]-1)*spa_trg[i];this.updateInternalMatrix(),this.transformPointToVoxel=this.transformPointToVoxelSlow}setParameterVector(values,opts){(opts=opts||{}).scale=opts.scale||!1,opts.rigidOnly=opts.rigidOnly||!1;var i=0,n=getOutputLength(this.getNumberOfDOF(),values.length,opts.rigidOnly);for(this.identity(),i=0;i<n;i++)this.internal.parameters[i]=values[i];if(opts.scale&&n>6)for(i=6;i<n;i++)this.internal.parameters[i]=this.internal.parameters[i]/100;this.updateInternalMatrix(),this.transformPointToVoxel=this.transformPointToVoxelSlow}getParameterVector(opts){(opts=opts||{}).rigidOnly=opts.rigidOnly||!1,opts.scale=opts.scale||!1;var l=getOutputLength(this.getNumberOfDOF(),12,opts.rigidOnly),p=new Array(l);return this.storeParameterVector(p,opts),p}storeParameterVector(out,opts){(opts=opts||{}).scale=opts.scale||!1,opts.rigidOnly=opts.rigidOnly||!1;var i=0,l=getOutputLength(this.getNumberOfDOF(),out.length,opts.rigidOnly);for(i=0;i<l;i++)out[i]=this.internal.parameters[i];if(!0===opts.scale){var maxi=9;for(maxi>l&&(maxi=l),i=6;i<maxi;i++)out[i]=100*this.internal.parameters[i]}}getWASMNumberOfBytes(){return 88}serializeWasmInPlace(Module,inDataPtr){let data_arr=new Float32Array(16);for(let i=0;i<4;i++)for(let j=0;j<4;j++)data_arr[4*i+j]=this.internal.matrix[i][j];let header_arr=new Int32Array([4,4]);return biswasm.packRawStructureInPlace(Module,inDataPtr,header_arr,data_arr,biswasm.get_matrix_magic_code(Module))}}},"./js/dataobjects/bisweb_matrix.js":function(module,exports,__webpack_require__){"use strict";const BisWebDataObject=__webpack_require__("./js/dataobjects/bisweb_dataobject.js"),genericio=__webpack_require__("./js/core/bis_genericio.js"),util=__webpack_require__("./js/core/bis_util.js"),wasmutil=__webpack_require__("./js/core/bis_wasmutils.js"),numeric=__webpack_require__("./node_modules/numeric/numeric-1.2.6.js");class BisWebMatrix extends BisWebDataObject{constructor(dtype,inputmat=null){"vector"!==dtype&&(dtype="matrix"),super(),this.jsonformatname="BisMatrix",this.legacyextension="csv",this.extension=".bismatr",this.dimensions=[0,0],this.data=null,this.wasmtype=dtype,null!==inputmat&&("Float32Array"===inputmat.constructor.name?this.linkToTypedArray(inputmat):this.setFromNumericMatrix(inputmat))}getObjectType(){return"matrix"}getDescription(){return"Matrix: "+this.dimensions.join(" ")}computeHash(){return util.SHA256(this.data)}getMemorySize(){return this.dimensions[0]*this.dimensions[1]*4}load(fobj){const self=this;return new Promise((resolve,reject)=>{genericio.read(fobj,!1).then(contents=>{self.parseFromText(contents.data,contents.filename,reject),self.setFilename(contents.filename),console.log("++++\t loaded matrix from "+contents.filename+", "+self.dimensions.join(" ")),resolve("loaded matrix transformation from "+contents.filename)}).catch(e=>{reject(e)})})}save(filename){let output=this.serializeToText(filename);return new Promise(function(resolve,reject){genericio.write(filename,output).then(f=>{console.log("++++\t saved matrix in "+filename),resolve(f)}).catch(e=>{reject(e)})})}serializeToDictionary(){let obj=super.serializeToDictionary(),bytesarr=new Uint8Array(this.data.buffer),b=genericio.tozbase64(bytesarr);return obj.dimensions=this.dimensions,obj.matrix=b,obj}parseFromDictionary(b){let bytesarr=genericio.fromzbase64(b.matrix);return this.dimensions=b.dimensions,this.data=new Float32Array(bytesarr.buffer),super.parseFromDictionary(b),!0}serializeWasm(Module){return"vector"===this.wasmtype&&1===this.dimensions[1]?wasmutil.packStructure(Module,this.data,[this.dimensions[0]]):wasmutil.packStructure(Module,this.data,this.dimensions)}deserializeWasm(Module,wasmarr){const wasmobj=wasmutil.unpackStructure(Module,wasmarr);return wasmobj.magic_type!==wasmutil.get_matrix_magic_code(Module)&&wasmobj.magic_type!==wasmutil.get_vector_magic_code(Module)?(console.log("failed to unpack Matrix"),0):(wasmobj.magic_type===wasmutil.get_vector_magic_code(Module)?(this.wasmtype="vector",this.dimensions=[wasmobj.data_array.length,1]):(this.wasmtype="matrix",this.dimensions=[wasmobj.dimensions[0],wasmobj.dimensions[1]]),this.data=wasmobj.data_array,1)}compareWithOther(other,method="maxabs",threshold=.01){let out={testresult:!1,value:null,metric:"maxabs"};if(other.constructor.name!==this.constructor.name)return console.log("different constructors"),out;let idat=this.data,odat=other.getDataArray();if(idat.length!==odat.length)return console.log("different lengths"),out;if(console.log("....\t comparing matrices:",this.getDimensions(),other.getDimensions(),method),"ssd"===method){let sum=0;for(let i=0;i<idat.length;i++){let v=idat[i]-odat[i];sum+=v*v}out.value=Math.sqrt(sum),out.metric="ssd"}else{let maxv=0;for(let i=0;i<idat.length;i++)maxv=Math.max(Math.abs(idat[i]-odat[i]));out.value=maxv}return out.value<threshold&&(out.testresult=!0),out}allocate(numrows,numcolumns,value=0){this.dimensions=[numrows,numcolumns],this.data=new Float32Array(numrows*numcolumns);for(let i=0;i<numrows*numcolumns;i++)this.data[i]=value}zero(numrows,numcolumns){this.allocate(numrows,numcolumns,0)}getElement(row,column){return this.data[row*this.dimensions[1]+column]}setElement(row,column,value){this.data[row*this.dimensions[1]+column]=value}getDataArray(){return this.data}getDimensions(){return this.dimensions.slice(0)}getNumericMatrix(){let out=util.zero(this.dimensions[0],this.dimensions[1]);for(let row=0;row<this.dimensions[0];row++)for(let col=0;col<this.dimensions[1];col++)out[row][col]=this.data[row*this.dimensions[1]+col];return out}setFromNumericMatrix(mat){let sz=numeric.dim(mat);if(2===sz.length){let rows=0;for(let i=0;i<sz[0];i++)isNaN(mat[i][0])?i=sz[0]:rows+=1;console.log("Input rows=",sz[0],"output=",rows),sz[0]=rows,this.dimensions=[sz[0],sz[1]],this.data=new Float32Array(sz[0]*sz[1]);let index=0;for(let row=0;row<this.dimensions[0];row++)for(let col=0;col<this.dimensions[1];col++)this.data[index]=mat[row][col],index+=1}else{this.dimensions=[sz[0],1],this.data=new Float32Array(sz[0]);for(let row=0;row<this.dimensions[0];row++)this.data[row]=mat[row]}}linkToTypedArray(arr){this.data=arr,this.dimensions=[arr.length,1],this.wasmtype="vector"}parseFromText(text,filename){let ext=genericio.getFixedLoadFileName(filename).split(".").pop();if("csv"===ext||"matr"===ext||"txt"===ext){if("txt"===ext){console.log(text);let s=text.split("\n");text="";for(let i=0;i<s.length;i++)if(0!==s[i].indexOf("#")){let v=s[i].trim().replace(/ /g,",").replace(/\t/g,",").replace(/,+/g,",");v.length>0&&(text=text+v+"\n")}ext="csv"}let output=null;return output="csv"===ext?numeric.parseCSV(text):BisWebMatrix.parseMatrFile(text),this.setFromNumericMatrix(output),1}return this.parseFromJSON(text)}serializeToText(filename){let ext=filename.name?filename.name.split(".").pop():filename.split(".").pop();if("csv"===ext){let output="";for(let row=0;row<this.dimensions[0];row++){for(let col=0;col<this.dimensions[1];row++)output+=this.data[row*this.dimensions[1]+col],col!=this.dimensions[1]-1&&(output+=", ");row!=this.dimensions[0]-1&&(output+="\n")}return output}if("matr"===ext){let mat=this.getNumericMatrix(),name="matrix";return 1===this.dimensions[1]&&(name="vector"),BisWebMatrix.serializeMatrFile(mat,name)}return this.serializeToJSON(!1)}static parseMatrFile(matrstring){var lines=matrstring.split("\n");if("#vtkpxMatrix File"!==lines[0].trim())return[0];let rows=parseInt(lines[3].split(":")[1]),columns=parseInt(lines[4].split(":")[1]);var out=util.zero(rows,columns);for(let l=5;l<5+rows;l++){var lst=lines[l].trim().split(" ");if(lst.length!==columns)return console.log("Error bad file "),[0];let row=l-5;for(let col=0;col<columns;col++)out[row][col]=parseFloat(lst[col])}return out}static serializeMatrFile(matrix,name="matrix"){let sz=numeric.dim(matrix),tname="matrix";1===sz.length&&(tname="vector");let out="#vtkpxMatrix File\n# name: "+name+"\n# type: "+tname+"\n# rows: "+sz[0]+"\n# columns: "+(sz[1]||1)+"\n";if(sz.length>1)for(let row=0;row<sz[0];row++)out+=matrix[row].join(" ")+"\n";else for(let row=0;row<sz[0];row++)out+=matrix[row]+"\n";return out}static loadNumericMatrix(filename){return new Promise(function(resolve,reject){let obj=new BisWebMatrix;obj.load(filename).then(()=>{resolve({data:obj.getNumericMatrix(),filename:filename})}).catch(e=>{reject(e)})})}}module.exports=BisWebMatrix},"./js/dataobjects/bisweb_textobject.js":function(module,exports,__webpack_require__){"use strict";const BisWebDataObject=__webpack_require__("./js/dataobjects/bisweb_dataobject.js"),genericio=__webpack_require__("./js/core/bis_genericio.js"),util=__webpack_require__("./js/core/bis_util.js");module.exports=class extends BisWebDataObject{constructor(txt=""){super(),this.jsonformatname="BisText",this.legacyextension="txt",this.extension=".bistxt",this.data="",this.setText(txt)}getObjectType(){return"text"}getDescription(){return"Text: "+this.data.length}computeHash(){return util.SHA256(this.data)}getMemorySize(){return this.data.length+2}load(fobj){const self=this;return new Promise((resolve,reject)=>{genericio.read(fobj,!1).then(contents=>{let filename=contents.filename,ext=filename.name?filename.name.split(".").pop():filename.split(".").pop();"csv"===ext||"txt"===ext?this.data=contents.data:this.parseFromJSON(contents.data),self.setFilename(filename),console.log("++++\t loaded text from "+contents.filename+", "+this.data.length),resolve("loaded text from "+contents.filename)}).catch(e=>{reject(e)})})}save(filename){let ext=filename.name?filename.name.split(".").pop():filename.split(".").pop(),output="";return output="csv"===ext||"txt"===ext?this.data:this.serializeToJSON(),new Promise(function(resolve,reject){genericio.write(filename,output).then(f=>{console.log("++++\t saved text in "+filename),resolve(f)}).catch(e=>{reject(e)})})}serializeToDictionary(){let obj=super.serializeToDictionary();return obj.text=this.data,obj}parseFromDictionary(b){return this.data=b.text,super.parseFromDictionary(b),!0}serializeWasm(){return this.data.slice(0)}deserializeWasm(Module,wasmarr){this.data="";try{Module&&(this.data=wasmarr.slice(0))}catch(e){console.log("Bad String ",wasmarr)}}compareWithOther(other){let out={testresult:!1};return other.constructor.name!==this.constructor.name?(console.log("different constructors"),out):(console.log("....\t comparing strings:",this.data.length,other.data.length),this.data.trim()===other.data.trim()&&(out.testresult=!0),out)}setText(t=""){this.data=t.slice(0)}getText(){return this.data.slice(0)}}},"./js/dataobjects/bisweb_transformationcollection.js":function(module,exports,__webpack_require__){"use strict";const util=__webpack_require__("./js/core/bis_util.js"),biswasm=__webpack_require__("./js/core/bis_wasmutils.js"),BisWebBaseTransformation=__webpack_require__("./js/dataobjects/bisweb_basetransformation.js"),bistransforms=__webpack_require__("./js/legacy/bis_transformationutil.js");module.exports=class extends BisWebBaseTransformation{constructor(){super(),this.jsonformatname="BisTransformationCollection",this.transformationList=[]}getDescription(){let s="TransformationCollection\n";s+="\tNum Transformations="+this.transformationList.length+"\n";for(let i=0;i<this.transformationList.length;i++)s+="\t"+this.transformationList[i].getDescription()+"\n";return s}computeHash(){let s="TC";for(let i=0;i<this.transformationList.length;i++)s+=this.transformationList[i].computeHash();return s}getMemorySize(){let sz=20;for(let i=0;i<this.transformationList.length;i++)sz+=this.transformationList[i].getMemorySize();return sz}serializeToDictionary(){let obj=super.serializeToDictionary(),objlist=[];for(let i=0;i<this.transformationList.length;i++)objlist.push(this.transformationList[i].serializeToDictionary());return obj.numtransformations=this.transformationList.length,obj.transformations=objlist,obj}parseFromDictionary(b){let numtransformations=b.numtransformations,objlist=b.transformations;for(let i=0;i<numtransformations;i++){let ng=bistransforms.parseTransformationFromJSON(objlist[i]);this.transformationList.push(ng)}return super.parseFromDictionary(b),!0}deserializeWasm(Module,dataptr,extra=0){let intheader=biswasm.get_array_view(Module,Int32Array,dataptr,5);if(intheader[0]!==biswasm.get_collection_magic_code(Module))return console.log("Bad wasmobj, can not deserialize Collection Transformation",extra),0;const num_transformations=intheader[4];this.identity();let offset=20;for(let xform=0;xform<num_transformations;xform++){let magiccode=biswasm.get_array_view(Module,Int32Array,dataptr+offset,4)[0],newxform=null;if(magiccode===biswasm.get_matrix_magic_code(Module)||magiccode===biswasm.get_matrix_magic_code(Module))newxform=bistransforms.createLinearTransformation(3);else if(magiccode===biswasm.get_grid_magic_code(Module))newxform=bistransforms.createGridTransformation([4,4,4],[2,2,2],[0,0,0],!0);else{if(magiccode!==biswasm.get_combo_magic_code(Module))throw new Error("bad transformation magic code"+magiccode+" can not deserializeWasm");newxform=bistransforms.createComboTransformation()}newxform.deserializeWasm(Module,dataptr+offset),this.transformationList.push(newxform),offset+=newxform.getWASMNumberOfBytes()}return 1}compareWithOther(other,method="maxabs",threshold=.01){let out={testresult:!1,value:null,metric:"maxabs"};if(other.constructor.name!==this.constructor.name)return out;let o=other.getNumberOfTransformations(),m=this.getNumberOfTransformations();if(o!==m)return out;console.log("....\t comparing combo transformations:",m,o);for(let i=0;i<this.transformationList.length;i++){let outxform=this.transformationList[i].compareWithOther(other.getTransformation(i),method,threshold);out.value=out.value+outxform.value,out.metric=outxform.metric}return out.value<threshold&&(out.testresult=!0),out}identity(){this.transformationList=[]}transformPointToVoxel(X,TX,spa){this.transformPoint(X,TX);for(let i=0;i<=2;i++)TX[i]=TX[i]/spa[i]}transformPoint(X,TX){if(this.transformationList.length<1){for(let i=0;i<=2;i++)TX[i]=X[i];return}let tmp=[X[0],X[1],X[2]];for(let i=0;i<this.transformationList.length;i++)this.transformationList[i].transformPoint(tmp,TX),tmp[0]=TX[0],tmp[1]=TX[1],tmp[2]=TX[2]}getTransformation(index){return index=util.range(index||0,0,this.transformationList.length-1),this.transformationList[index]}addTransformation(tr){this.transformationList.push(tr)}setTransformation(index,tr){if(this.transformationList.length<1)return this.addTransformation(tr);index=util.range(index||0,0,this.transformationList.length-1),this.transformationList[index]=tr}getNumberOfTransformations(){return this.transformationList.length}getWASMNumberOfBytes(){let numbytes=0;for(let i=0;i<this.transformationList.length;i++)numbytes+=this.transformationList[i].getWASMNumberOfBytes();return 20+numbytes}serializeWasmInPlace(Module,inDataPtr){let totalbytes=this.getWASMNumberOfBytes(),header=biswasm.get_array_view(Module,Int32Array,inDataPtr,5);header[0]=biswasm.get_collection_magic_code(Module),header[1]=16,header[2]=4,header[3]=totalbytes,header[4]=this.transformationList.length;let offset=20;for(let i=0;i<this.transformationList.length;i++)offset+=this.transformationList[i].serializeWasmInPlace(Module,inDataPtr+offset);return totalbytes}}},"./js/export/bisweb_exportobject.js":function(module,exports,__webpack_require__){"use strict";const bisutil=__webpack_require__("./js/core/bis_util.js"),genericio=__webpack_require__("./js/core/bis_genericio.js"),moduleindex=__webpack_require__("./js/modules/moduleindex.js"),bistfutil=__webpack_require__("./js/modules/bis_tfutil.js"),BisWebImage=__webpack_require__("./js/dataobjects/bisweb_image.js"),BisWebMatrix=__webpack_require__("./js/dataobjects/bisweb_matrix.js"),BisWebTextObject=__webpack_require__("./js/dataobjects/bisweb_textobject.js"),BisWebDataObjectCollection=__webpack_require__("./js/dataobjects/bisweb_dataobjectcollection.js"),BisWebComboTransformation=__webpack_require__("./js/dataobjects/bisweb_combotransformation.js"),BisWebLinearTransformation=__webpack_require__("./js/dataobjects/bisweb_lineartransformation.js"),BisWebGridTransformation=__webpack_require__("./js/dataobjects/bisweb_gridtransformation.js"),BisWebTransformationCollection=__webpack_require__("./js/dataobjects/bisweb_transformationcollection.js"),userPreferences=__webpack_require__("./js/core/bisweb_userpreferences.js"),bisdate=__webpack_require__("./build/wasm/bisdate.js");module.exports={loadObject:(filename,objecttype="image")=>BisWebDataObjectCollection.loadObject(filename,objecttype),createModule:modulename=>moduleindex.getModule(modulename),setPref(item,name,save=!1){userPreferences.setItem(item,name,save)},printUserPrefs(){userPreferences.printUserPreferences()},getEnvironment:()=>genericio.getenvironment(),bisutil:bisutil,genericio:genericio,bisdate:bisdate,userPreferences:userPreferences,BisWebImage:BisWebImage,BisWebMatrix:BisWebMatrix,BisWebTextObject:BisWebTextObject,BisWebLinearTransformation:BisWebLinearTransformation,BisWebGridTransformation:BisWebGridTransformation,BisWebComboTransformation:BisWebComboTransformation,BisWebDataObjectCollection:BisWebDataObjectCollection,BisWebTransformationCollection:BisWebTransformationCollection,bistfutil:bistfutil}},"./js/legacy/bis_asyncreadbruker.js":function(module,exports,__webpack_require__){"use strict";const bisheader=__webpack_require__("./js/core/bis_header.js"),BisWebImage=__webpack_require__("./js/dataobjects/bisweb_image.js"),bisgenericio=__webpack_require__("./js/core/bis_genericio.js"),userPreferences=__webpack_require__("./js/core/bisweb_userpreferences.js"),inelectron="electron"===bisgenericio.getmode();let dualPrint=function(){let text="[BIS:]"+Array.from(arguments).join("");console.log(text),inelectron&&window.BISELECTRON.ipc.send("bisconsole",text)};const printFileStats=async function(fname,debug=!1){debug=debug||!1;try{let p=await bisgenericio.getFileSize(fname);debug&&dualPrint("+++++ file="+fname+",\t\t size =",p)}catch(e){return dualPrint("----- file="+bisgenericio.getBaseName(fname)+" does not exist"),0}return 1};var getmatchingfiles=function(querystring){return bisgenericio.getMatchingFiles(querystring)};let getMatchingFilenames=async function(f){var pname=bisgenericio.getNormalizedFilename(f),l=bisgenericio.getDirectoryName(pname).length+1,p2=bisgenericio.getNormalizedFilename(pname+"/*/pdata/*/2dseq"),n1=await getmatchingfiles(p2);return n1.length<1&&(p2=bisgenericio.getNormalizedFilename(pname+"/pdata/*/2dseq"),n1=await getmatchingfiles(p2)),n1.length<1&&(p2=bisgenericio.getNormalizedFilename(pname+"/*/2dseq"),n1=await getmatchingfiles(p2)),n1.length<1&&(p2=bisgenericio.getNormalizedFilename(pname+"/2dseq"),n1=await getmatchingfiles(p2)),{names:n1,len:l}},readParameterFile=async function(fname,debug=0){debug=debug||0;try{debug&&console.log("Reading fname=",fname);let obj=null;try{obj=await bisgenericio.read(fname,!1)}catch(e){console.log("Error =",e)}let lines=obj.data.split("\n");debug&&console.log("Reading fname=",fname," numlines=",lines.length);let outputlst={},i=0;for(;i<lines.length-1;){let ln=lines[i];if(0===ln.indexOf("##$")){let ind=ln.indexOf("=",ln),name=ln.substr(3,ind-3),val=ln.substr(ind+1).trim();if(0===val.indexOf("(")){let eind=val.indexOf(")"),orange=val.substr(1,eind-1).trim(),range=orange.split(",");debug>0&&(1===range.length?dualPrint("Found 1d-array in line "+i+" name="+name+" range="+range[0]):dualPrint("Found array in line "+i+" name="+name+" range=*"+orange+"* --\x3e"+range.join("")));let j=i+1,found=!1;for(;j<lines.length&&!1===found;)0===(ln=lines[j]).indexOf("##$")||0===ln.indexOf("$$")?found=1:++j;if(j-=1,debug>1&&dualPrint("+++++ range of lines="+(i+1)+":"+j+" name="+name),outputlst[name]=[],j<=i)for(let kb=0;kb<range.length;kb++)outputlst[name].push(range[kb].trim());else for(let k=i+1;k<=j;k++){let a=lines[k].trim().split(" ");for(let ka=0;ka<a.length;ka++)outputlst[name].push(a[ka].trim())}i+=j-i}else debug>1&&dualPrint("Found simple letiable in line "+ln+" ("+name+"="+val+")"),outputlst[name]=val;++i}else debug>1&&(0!==ln.indexOf("$$")&&0!==ln.indexOf("##")&&ln.size>1?dualPrint("---- bad line"+i+"="+ln):ln.size>1&&dualPrint("____ ignoring line"+i+"="+ln)),++i}return outputlst}catch(e){return-1}},createHeader=function(data,debug){(debug=debug||!1)&&console.log("In Create Header");let header=new bisheader;header.initializenifti(),header.createNIFTIHeader();let headerstruct=header.struct;16===data.bitpix?(headerstruct.datatype=4,headerstruct.bitpix=16):32===data.bitpix&&(headerstruct.bitpix=32,headerstruct.datatype=8);for(let ia=0;ia<=2;ia++)headerstruct.dim[ia+1]=parseInt(data.dims[ia]),headerstruct.pixdim[ia+1]=parseFloat(data.spa[ia]);data.repeats>1?(headerstruct.dim[0]=4,headerstruct.dim[4]=data.repeats):data.numechos>1&&(headerstruct.dim[0]=4,headerstruct.dim[4]=data.numechos),data.ndir>0&&(headerstruct.dim[0]=4,headerstruct.dim[4]=data.ndir*data.nbval+data.nb0),headerstruct.qform_code=0,headerstruct.sform_code=1;let origin=[-data.fov[0]/2,-data.fov[1]/2,-data.fov[2]/2];return"axial"===data.orient?(headerstruct.srow_x=[-data.spa[0],0,0,origin[0]],headerstruct.srow_y=[0,data.spa[1],0,origin[1]],headerstruct.srow_z=[0,0,data.spa[2],origin[2]]):"coronal"===data.orient?(headerstruct.srow_x=[-data.spa[0],0,0,origin[0]],headerstruct.srow_y=[0,0,-data.spa[2],origin[2]],headerstruct.srow_z=[0,-data.spa[1],0,origin[1]]):(headerstruct.srow_x=[0,0,data.spa[2],origin[2]],headerstruct.srow_y=[data.spa[0],0,0,origin[0]],headerstruct.srow_z=[0,-data.spa[1],0,origin[1]]),header},saveTextFiles=async function(data){let exclude=["slopes","offset","dwdir"],detailsname=data.basename+".txt",details="#Image Header Info\n",keys=Object.keys(data);for(let count=0;count<keys.length;count++){let key=keys[count];if(exclude.indexOf(key)<0){details+=Array.isArray(data[key])?key+": "+data[key].join(", ")+"\n":key+": "+data[key]+"\n"}}if(dualPrint("+++++ saving header info in "+detailsname),await bisgenericio.write(detailsname,details),data.detailsname=detailsname,data.ndir>0){let directionsname=data.basename+".dat",datatext=data.ndir+"\n",dw=data.dwdir,numdir=dw[2];for(let ka=0;ka<numdir;ka++){datatext=datatext+[dw[3*ka],dw[1+3*ka],dw[2+3*ka]].join(" ")+"\n"}dualPrint("+++++ saving directions in "+directionsname),await bisgenericio.write(directionsname,datatext),data.directionsname=directionsname}},directSaveImage=async function(part_img,part_imageoutname,forceorient){if(console.log("In Direct Save",part_img.getDescription(),part_imageoutname,forceorient),forceorient){let dat=part_img.serializeToNII(),output=new BisWebImage;output.initialize(),output.debug=0,output.parseNII(dat.buffer,forceorient),await output.save(part_imageoutname)}else await part_img.save(part_imageoutname);let fileSizeInBytes=await bisgenericio.getFileSize(part_imageoutname);return dualPrint("+++++ saved image in "+part_imageoutname+", size="+fileSizeInBytes),!0},readFile=async function(filename,outprefix,forceorient,debug=!1){console.log("\n\n\n\n Force orient input in readFile=",forceorient);let data=await async function(filename,outprefix,debug,forceorient){let data={};debug=debug||!1,data.originalfilename=filename,data.forceorient=userPreferences.sanitizeOrientationOnLoad(forceorient),debug&&console.log("Force orient=",data.forceorient);let dirname=bisgenericio.getNormalizedFilename(bisgenericio.getDirectoryName(filename)),tailname=bisgenericio.getBaseName(filename);if(dualPrint(""),dualPrint("+++++ reading "+filename),"2dseq"!==tailname)return data.error="Bad Tailname !== 2dseq ",data;let reconame=bisgenericio.getNormalizedFilename(bisgenericio.joinFilenames(dirname,"/reco")),acqpname=bisgenericio.getNormalizedFilename(bisgenericio.joinFilenames(dirname,"../../acqp")),methodname=bisgenericio.getNormalizedFilename(bisgenericio.joinFilenames(dirname,"../../method")),visuname=bisgenericio.getNormalizedFilename(bisgenericio.joinFilenames(dirname,"/visu_pars")),binname=bisgenericio.getNormalizedFilename(filename);debug&&console.log("Starting ",reconame,visuname),data.havereco=!1,1===await printFileStats(reconame)&&(data.havereco=!0),debug&&console.log("++++ I Have Reco =",data.havereco);let arr=[visuname,acqpname,methodname,binname],numgood=0;for(let i=0;i<arr.length;i++)numgood+=await printFileStats(arr[i],!0);if(numgood<arr.length)return data.error="One or more files are missing",data;debug&&console.log("Now reading actual files",numgood),debug&&console.log("Reading Parameter File",visuname);let visu=await readParameterFile(visuname);debug&&console.log("Reading Parameter File",methodname);let method=await readParameterFile(methodname),acqp=await readParameterFile(acqpname);if(data.orient=method.PVM_SPackArrSliceOrient||"axial",data.numechos=method.PVM_NEchoImages,debug&&console.log("Number of echos=",data.numechos),data.orient.length>1)return data.error="multi orientation localizer "+data.orient,data;data.orient=data.orient[0],data.method=method.Method,data.patientpos=acqp.ACQ_patient_pos,data.byteorder=visu.VisuCoreByteOrder,data.wordtype=visu.VisuCoreWordType,data.dims=visu.VisuCoreSize,data.fov=visu.VisuCoreExtent,data.names=visu.VisuFGElemId||[],data.names.length>1?data.description=visu.VisuFGElemComment:data.names=["Not set"],data.coreunits=visu.VisuCoreUnits,"<mm>"===data.coreunits[0]?data.fovscale=1:data.fovscale=10,data.spa=[],data.twod=method.PVM_SpatDimEnum,data.twod.indexOf("2D")>=0&&(data.dims[2]=parseInt(method.PVM_SPackArrNSlices),data.dims[2]=data.dims[2],data.thick=parseFloat(acqp.ACQ_slice_thick),data.gapmode=method.PVM_SPackArrSliceGapMode[0],data.gap=parseFloat(method.PVM_SPackArrSliceGap[0]),"contiguous"!==data.gapmode?data.fov[2]=(data.thick+data.gap)*data.dims[2]/data.fovscale:data.fov[2]=data.thick*data.dims[2]/data.fovscale);for(let i=0;i<=2;i++)data.spa[i]=data.fov[i]*data.fovscale/data.dims[i];data.axis=method.PVM_SPackArrReadOrient,data.repeats=method.PVM_NRepetitions||1,"_32BIT_SGN_INT"===data.wordtype?data.bitpix=32:"_16BIT_SGN_INT"===data.wordtype?data.bitpix=16:(data.bitpix=0,data.error="unknown wordtype: "+data.wordtype),debug&&dualPrint("+++++ Dimensions & FOV="+data.dims+" spa="+data.spa+" num repeats="+data.repeats),data.ndir=-1,data.nbval=0,data.nb0=1,data.havereco&&(data.diffdir=method.PVM_DwNDiffDir||!1,!1!==data.diffdir&&(data.ndir=parseInt(method.PVM_DwNDiffDir),data.nbval=parseInt(method.PVM_DwNDiffExpEach),data.nb0=parseInt(method.PVM_DwAoImages),data.dwdir=method.PVM_DwDir)),data.offset=visu.VisuCoreDataOffs,data.slopes=visu.VisuCoreDataSlope;let index=data.method.indexOf(":"),index2=data.method.indexOf(">"),mname=data.method.substr(index+1,index2-index-1);data.basename=outprefix+"_"+mname,"RAS"===forceorient?data.basename+="_ras":"LPS"===forceorient&&(data.basename+="_lps"),data.ndir>0&&data.repeats<2&&(data.basename=data.basename+"_DTI"),data.basename=data.basename.trim().replace(/ /g,"_").replace(/\t/g,"_").replace(/\(/g,"").replace(/\)/g,"");let a=bisgenericio.getBaseName(bisgenericio.getDirectoryName(bisgenericio.getNormalizedFilename(acqpname))),b=bisgenericio.getBaseName(bisgenericio.getDirectoryName(bisgenericio.getNormalizedFilename(data.originalfilename)));return data.displaynames=[(a+"_"+mname+"_"+b).replace(/ /g,"_").replace(/\t/g,"_").replace(/\(/g,"").replace(/\)/g,"")],data}(filename,outprefix,debug,forceorient);return""!==(data.error||"")?data:(dualPrint("+++++ "+data.basename),data.ndir>0&&data.repeats>1?(dualPrint("_____ Processing as multi part raw dti file."),await async function(data,debug){let filename=data.originalfilename,header=createHeader(data,debug),raw_file_data=await bisgenericio.read(filename,!0).data,dt=new Uint8Array(raw_file_data).buffer,castarray=null;castarray="_32BIT_SGN_INT"!==data.wordtype?new Int16Array(dt):new Int32Array(dt),debug&&dualPrint("+++++ Reading data from filename="+filename),dualPrint("+++++ This is MultiPart DTI Data ");let volumesize=data.dims[0]*data.dims[1]*data.dims[2];data.partnames=[],data.displaynames=[];let part_img=new BisWebImage;part_img.createFromHeader(header),debug&&dualPrint("Created image "+part_img.getDescription());let dat_arr=part_img.getImageData();for(let ia=0;ia<data.repeats;ia++){let inoffset=ia*volumesize;dualPrint("\n++++++ Working on part "+(ia+1)+"/"+data.repeats+", offset="+inoffset);for(let voxel=0;voxel<volumesize;voxel++){let value=castarray[inoffset+voxel];value!=value&&(value=0),dat_arr[voxel]=value}let extra="";data.repeats>1&&(extra="_"+(ia+1));let part_imageoutname=data.basename+"_dti"+extra+".nii.gz",c="dti"+extra+":"+bisgenericio.getBaseName(bisgenericio.getDirectoryName(bisgenericio.getDirectoryName(bisgenericio.getDirectoryName(bisgenericio.getNormalizedFilename(filename)))))+"_"+bisgenericio.getBaseName(bisgenericio.getDirectoryName(bisgenericio.getNormalizedFilename(filename)));data.partnames.push(bisgenericio.getNormalizedFilename(bisgenericio.getNormalizedFilename(part_imageoutname))),data.displaynames.push(c.replace(/ /g,"_").replace(/\t/g,"_").replace(/\(/g,"").replace(/\)/g,"")),await directSaveImage(part_img,part_imageoutname,data.forceorient)}return part_img=null,saveTextFiles(data),data}(data,debug)):"<DTI_FA>"!==data.names[0]?(dualPrint("_____ Processing as normal file."),await async function(data,debug){let headerbin=createHeader(data,debug).createHeaderRawData(!1);debug&&dualPrint("+++++ Reading data from filename="+data.originalfilename);let raw_file_data=(await bisgenericio.read(data.originalfilename,!0)).data,rawdata=new Uint8Array(raw_file_data),c=new Uint8Array(headerbin.length+rawdata.length);c.set(headerbin.data),c.set(rawdata,headerbin.length),headerbin=null,rawdata=null,raw_file_data=null;let img=new BisWebImage;if(img.initialize(),img.parseNII(c.buffer,data.forceorient),dualPrint("+++++ created image "+img.getDescription()),data.numechos>1){let newimg=new BisWebImage;newimg.cloneImage(img);let dat=img.getImageData(),odat=newimg.getImageData(),dim=img.getDimensions(),slicesize=dim[0]*dim[1],total=dim[2]*dim[3];for(let inslice=0;inslice<total;inslice++){let slice=Math.floor(inslice/data.numechos),inoffset=inslice*slicesize,outoffset=(slice+(inslice-slice*data.numechos)*dim[2])*slicesize;for(let k=0;k<slicesize;k++)odat[outoffset+k]=dat[inoffset+k]}img=newimg,newimg=null}debug=!0;let imghead=img.getHeader();dualPrint("+++++ Normal Image Dimensions = "+imghead.struct.dim+", spa="+imghead.struct.pixdim);let imageoutname=data.basename+".nii.gz";await directSaveImage(img,imageoutname,!1),data.imageDimensions=img.getDimensions(),data.partnames=[bisgenericio.getNormalizedFilename(bisgenericio.getNormalizedFilename(imageoutname))],await saveTextFiles(data),dualPrint("Text files saved"),c=null,img=null}(data,debug)):(dualPrint("_____ Processing as multi part reconstructed dti file."),await async function(data,debug){let filename=data.originalfilename,header=createHeader(data,debug),raw_file_data=await bisgenericio.read(filename,!0).data,dt=new Uint8Array(raw_file_data).buffer,castarray=null;castarray="_32BIT_SGN_INT"!==data.wordtype?new Int16Array(dt):new Int32Array(dt),debug&&dualPrint("+++++ Reading data from filename="+filename);let offset=data.offset,slopes=data.slopes;dualPrint("+++++ This is Processed DTI Data "+data.names.length+" slices="+data.dims[2]+" elements="+data.names.length+" total="+data.dims[2]*data.names.length+" repeats="+data.repeats+", offsets="+offset.length+","+slopes.length),debug&&dualPrint("+++++ fa slope ="+slopes[0]);let elements={fa:["<DTI_FA>"],trace:["<DTI_TRACE>"],baseline:["<DTI_A0>"],tensor:["<DTI_DXX>","<DTI_DXY>","<DTI_DXZ>","<DTI_DYY>","<DTI_DYZ>","<DTI_DZZ>"],eigenvalues:["<DTI_L1>","<DTI_L2>","<DTI_L3>"],eigenvectors:["<DTI_L1X>","<DTI_L1Y>","<DTI_L1Z>","<DTI_L2X>","<DTI_L2Y>","<DTI_L2Z>","<DTI_L3X>","<DTI_L3Y>","<DTI_L3Z>"]},outputs=Object.keys(elements),slicesize=data.dims[0]*data.dims[1],allslicesize=slicesize*data.names.length,volumesize=slicesize*data.dims[2],headerstruct=header.struct,repeatsize=volumesize*data.names.length;debug&&(dualPrint("+++++ Reading data from filename="+filename),dualPrint("\n+++++ Number of Elements="+castarray.length+" "+raw_file_data.length+" or "+data.dims[0]*data.dims[1]*data.dims[2]*data.names.length),dualPrint("+++++ sliceoffset = "+slicesize+" volume ="+volumesize+" allslices="+allslicesize));let debugvoxel=data.dims[0]/2-5+data.dims[0]*(data.dims[1]/2);data.partnames=[],data.displaynames=[];for(let ia=0;ia<outputs.length;ia++){let key=outputs[ia],numelements=elements[key].length,indices=[];for(let ib=0;ib<numelements;ib++){let el=elements[key][ib];indices.push(data.names.indexOf(el))}debug&&dualPrint("\n\n++++++++++++++++++++++++++++++++++++++++++++++++++++++++"),dualPrint("+++++ Working on _"+key+"_ num elements="+numelements+", indices="+indices.join(":")+" names="+elements[key].join(",")),data["part_"+key]=elements[key],headerstruct.dim[4]=indices.length,indices.length>1?headerstruct.dim[0]=4:headerstruct.dim[0]=3,headerstruct.bitpix=32,headerstruct.datatype=16;let part_img=new BisWebImage;part_img.createFromHeader(header),debug&&dualPrint("Created image "+part_img.getDescription());let dat_arr=part_img.getImageData();debug&&dualPrint("+++++ Size of dat_arr = "+dat_arr.length+" vs "+data.dims[0]*data.dims[1]*data.dims[2]*indices.length);for(let repeats=0;repeats<data.repeats;repeats++){for(let attribute=0;attribute<indices.length;attribute++){let inattr=indices[attribute],inattroffset=inattr*slicesize+repeats*repeatsize,outattroffset=attribute*volumesize;debug&&dualPrint("Working on Attribute = "+(attribute+1)+"/"+indices.length+" copying from "+inattr+" inoffset="+inattroffset+" outoffset="+outattroffset);for(let slice=0;slice<data.dims[2];slice++){let scale=parseFloat(slopes[inattr+slice*data.names.length+repeats*data.names.length*data.dims[2]]),shift=parseFloat(offset[inattr+slice*data.names.length+repeats*data.names.length*data.dims[2]]),outsliceoffset=slice*slicesize,insliceoffset=slice*allslicesize;slice%7==0&&slice>0&&debug&&dualPrint("\tSlice = "+slice+"/"+data.dims[2]+" [ shift,scale] ="+[shift,scale]);for(let voxel=0;voxel<slicesize;voxel++){let inputindex=voxel+insliceoffset+inattroffset,outputindex=voxel+outsliceoffset+outattroffset,value=castarray[inputindex];value!=value&&(value=0);let outvalue=(value+0)*scale+shift;dat_arr[outputindex]=outvalue,debugvoxel===voxel&&slice%7==0&&slice>0&&debug&&dualPrint("\t\t voxel="+voxel+" indices="+[inputindex,outputindex]+" values="+[value,outvalue])}}}let extra="";data.repeats>1&&(extra="_"+(repeats+1));let part_imageoutname=data.basename+"_"+key+extra+".nii.gz",c=key+extra+":"+bisgenericio.getBaseName(bisgenericio.getDirectoryName(bisgenericio.getDirectoryName(bisgenericio.getDirectoryName(bisgenericio.getNormalizedFilename(filename)))))+"_"+bisgenericio.getBaseName(bisgenericio.getDirectoryName(bisgenericio.getNormalizedFilename(filename)));data.partnames.push(bisgenericio.getNormalizedFilename(bisgenericio.getNormalizedFilename(part_imageoutname))),data.displaynames.push(c.replace(/ /g,"_").replace(/\t/g,"_").replace(/\(/g,"").replace(/\)/g,"")),await directSaveImage(part_img,part_imageoutname,data.forceorient)}}return saveTextFiles(data),data}(data,debug)),data)};const algo={readFile:readFile,readMultiple:async function(filename,outprefix,forceorient,addcallback,infoCallback=null,debug=!1){debug&&console.log("In Read Multiple");try{if(!await bisgenericio.isDirectory(outprefix))return[!1," cannot write to "+outprefix+". It is not a directory\n"]}catch(e){return[!1,e]}let tmp_txt=[filename,outprefix,forceorient].join(" ");try{await bisgenericio.write(bisgenericio.joinFilenames(outprefix,"log.txt"),tmp_txt)}catch(e){return[!1,"Cannot write to output directory "+outprefix]}addcallback=addcallback||null;let joblist=[];debug=debug||!1,forceorient=forceorient||"";let addElement=function(name,fname,infoname){joblist.push({name:name,filename:bisgenericio.getBaseName(fname),details:bisgenericio.getBaseName(infoname)}),null!==addcallback?addcallback(name,fname,infoname):dualPrint("+++++ adding "+name+" "+[fname,infoname].join(","))},obj=await getMatchingFilenames(filename),fnames=obj.names,len=obj.len;if(fnames.length<1)return[!1,"no files found"];let subjectname="",fnamepairs=[];for(let counter=0;counter<fnames.length;counter++){let ifile=fnames[counter].substr(len,fnames[counter].length-len);if(0===counter){let dirname=bisgenericio.getDirectoryName(bisgenericio.getDirectoryName(bisgenericio.getNormalizedFilename(bisgenericio.getDirectoryName(fnames[0])))),visuname=bisgenericio.joinFilenames(dirname,"visu_pars"),visu=await readParameterFile(visuname);visu.VisuSubjectId[0].length>2&&(subjectname=visu.VisuSubjectId[0].substr(1,visu.VisuSubjectId[0].length-2))}let d1=bisgenericio.getDirectoryName(ifile),a=bisgenericio.getNormalizedFilename(d1," ").split(bisgenericio.getPathSeparator());subjectname.length>1&&(a[0]=subjectname);let ofile="",last="",index=0,maxa=a.length;console.log("Last =",a[a.length-1]),"1"===a[a.length-1]&&(maxa-=1);for(let ia=0;ia<maxa;ia++)"pdata"!==a[ia]?(ofile+=last,last=a[ia]):(ofile+=(index=parseInt(last)||0)>0?`s${last}`:last,last=""),ia<maxa-1&&ia>0?ofile+="_":ia>0&&(ofile+=last);fnamepairs.push({inp:fnames[counter],out:ofile,index:index})}let maxcounter=(fnamepairs=fnamepairs.sort((a,b)=>a.index<b.index?-1:a.index>b.index?1:0)).length;for(let counter=0;counter<maxcounter;counter++){let ifile=fnamepairs[counter].inp,ofile=fnamepairs[counter].out;ofile=bisgenericio.joinFilenames(outprefix,ofile),infoCallback&&await infoCallback("Converting "+ifile+" ->"+ofile);let data=await readFile(ifile,ofile,forceorient),error=data.error||"";if(""!=error)dualPrint("----- ERROR: "+error);else if(Array.isArray(data.displaynames)){let fov=[];for(let i=0;i<data.fov.length;i++)fov.push(Math.round(100*data.fov[i])/100);let l=data.displaynames.length;for(let ic=0;ic<l;ic++){let nm=data.displaynames[ic]+" ("+data.imageDimensions.join(",")+") ("+fov.join(",")+")";console.log("name=",data.displaynames[ic],data.dims,nm),data.displaynames[ic]=nm,addElement(`${nm}`,data.partnames[ic],data.detailsname)}}else console.log("Here ...",data.displaynames),addElement(`${data.displaynames} (${data.dims.join(",")})`,data.partnames,data.detailsname)}let jobname="";jobname="RAS"===forceorient?bisgenericio.joinFilenames(outprefix,"paravisionconvert_RAS.json"):"LPS"===forceorient?bisgenericio.joinFilenames(outprefix,"paravisionconvert_LPS.json"):bisgenericio.joinFilenames(outprefix,"paravisionconvert.json");let outobj={bisformat:"ParavisionJob",job:joblist},txt=JSON.stringify(outobj);return await bisgenericio.write(jobname,txt),[!0,"saved job in "+jobname]},getMatchingFilenames:getMatchingFilenames};module.exports=algo},"./js/legacy/bis_connmatrix.js":function(module,exports,__webpack_require__){"use strict";const util=__webpack_require__("./js/core/bis_util.js"),numeric=__webpack_require__("./node_modules/numeric/numeric-1.2.6.js");module.exports=class{constructor(){this.offset=50,this.posMatrix=null,this.negMatrix=null,this.statMatrix=null,this.flagMatrix=null,this.hasnegMatrix=!1,this.posImageData=[null,null],this.negImageData=[null,null],this.maxsum=0,this.maxsumnode=-1}cleanup(){this.posMatrix=null,this.negMatrix=null,this.statMatrix=null,this.flagMatrix=null,this.hasnegMatrix=!1,this.posImageData=[null,null],this.negImageData=[null,null]}parsematrix(inpstring,mode,filename,doerror){if(console.log("\n\n\n+++++ Parsing matrix "+mode+" from "+filename),0!==mode&&null===this.posMatrix)return doerror("Read Positive Matrix first before reading negative matrix"),0;var out_lines=null;try{out_lines=util.parseMatrix(inpstring,filename,!0)}catch(e){return void doerror(e)}var numcols=out_lines.length,j=0,i=0;if(console.log("+++++ Read square matrix of size "+numcols+"*"+numcols),0!==mode){var npos=numeric.dim(this.posMatrix)[0];if(npos!==numcols)return doerror("Negative matrix read "+[numcols,numcols]+" has differnt dimensions from positive matrix "+[npos,npos]),0}var matrix=util.zero(numcols,numcols);for(i=0;i<numcols;i++)for(j=0;j<numcols;j++)matrix[i][j]=Number.parseFloat(out_lines[i][j]);return 0===mode?(this.posMatrix=matrix,!0===this.hasnegMatrix&&doerror("Reading a new positive matrix clears the old negative matrix from memory"),this.negMatrix=null,this.hasnegMatrix=!1,this.posImagedata=[null,null],this.negImagedata=[null,null]):(this.negMatrix=matrix,this.hasnegMatrix=!0,this.negImagedata=[null,null]),this.createMeasureMatrix()}setMatrices(mat1,mat2){return this.posMatrix=mat1||null,this.negMatrix=mat2||null,this.negMatrix?this.hasnegMatrix=!0:this.hasnegMatrix=!1,this.posImagedata=[null,null],this.negImagedata=[null,null],this.createMeasureMatrix()}createMeasureMatrix(){if(null===this.posMatrix)return console.log("Need pos matrix to be loaded"),this.flagMatrix=null,this.statMatrix=null,0;var numnodes=numeric.dim(this.posMatrix)[0];console.log("+++++ creating measure meatrix numnodes="+numnodes),null===this.negMatrix&&(this.negMatrix=util.zero(numnodes,numnodes)),this.statMatrix=util.zero(numnodes,4);for(var maxsum=0,maxnode=-1,row=0;row<numnodes;row++){for(var sumpos=0,sumneg=0,col=0;col<numnodes;col++)sumpos+=Math.abs(this.posMatrix[row][col]),sumneg+=Math.abs(this.negMatrix[row][col]);this.statMatrix[row][0]=sumpos,this.statMatrix[row][1]=sumneg,this.statMatrix[row][2]=sumpos+sumneg,this.statMatrix[row][3]=sumpos-sumneg,this.statMatrix[row][2]>maxsum&&(maxsum=this.statMatrix[row][2],maxnode=row)}return console.log("+++++ Done computing sums, maxsum="+maxsum+" at node="+maxnode),this.maxsum=maxsum,this.maxsumnode=maxnode,numnodes}getSortedNodesByDegree(index){if(null===this.statMatrix)return console.log("Stat Matrix is null\n"),0;void 0===index&&(index=2),index=util.range(index,0,3);for(var arr=[],np=numeric.dim(this.statMatrix)[0],i=0;i<np;i++){var val=this.statMatrix[i][index];arr.push({node:i,degree:val})}return arr.sort(function(a,b){return a.degree<b.degree?-1:a.degree>b.degree?1:0}),arr}createFlagMatrix(parc,mode,singlevalue,attribcomponent,degreethreshold,in_column){if(null===this.statMatrix)return console.log("Stat Matrix is null\n"),0;var np=numeric.dim(this.statMatrix)[0],np2=parc.rois.length,numcomp=parc.rois[0].attr.length;if(np2!=np)return console.log("Different matrix size="+np+" and parcellation numnodes="+np2),this.flagMatrix=null,0;console.log("+++++ Drawing lines, mode="+mode+" singlevalue="+singlevalue+", attribcomponent="+attribcomponent),this.flagMatrix=util.zero(np,4);var column=util.range(in_column,0,3),component=util.range(attribcomponent,0,numcomp);1===component&&(component=3);var compvalue=0;compvalue=1===mode?util.range(singlevalue,0,np-1):singlevalue;var maxsum=this.statMatrix[0][column],i=0;for(i=1;i<np;i++)maxsum=Math.max(maxsum,this.statMatrix[i][column]);degreethreshold>maxsum&&(console.log("+++++ Reducing degreethreshold to "+maxsum),degreethreshold=maxsum);var ia,row=0,att=0,v=0,col=0;if(2===mode){for(compvalue=Math.floor(compvalue),row=0;row<np;row++)if(att=Math.floor(parc.rois[row].attr[component]),v=this.statMatrix[row][column],att===compvalue&&v>=degreethreshold)for(ia=0;ia<=3;ia++)this.flagMatrix[row][ia]=2}else if(1===mode)for(ia=0;ia<=3;ia++)this.flagMatrix[compvalue][ia]=2;else for(row=0;row<np;row++)if((v=this.statMatrix[row][column])>=degreethreshold)for(ia=0;ia<=3;ia++)this.flagMatrix[row][ia]=2;var num=[0,0,0];for(row=0;row<np;row++){if(this.flagMatrix[row][0]<2)for(col=0;col<np;col++)if(this.flagMatrix[col][0]>1){var v1=this.posMatrix[row][col];v1<0&&(v1=-v1);var v2=this.negMatrix[row][col];v2<0&&(v2=-v2);var v3=v1+v2;v1>0&&(this.flagMatrix[row][0]=1),v2>0&&(this.flagMatrix[row][1]=1),v3>0&&(this.flagMatrix[row][2]=1,this.flagMatrix[row][3]=1)}num[v=util.range(this.flagMatrix[row][2],0,2)]=num[v]+1}return 1}createLinePairs(negative,matrixthreshold){if(negative=1===negative||!0===negative,null===this.posMatrix||null===this.negMatrix||null===this.statMatrix||null===this.flagMatrix)return console.log("Bad Matrices"),[];var n=numeric.dim(this.posMatrix)[0],n2=numeric.dim(this.negMatrix)[0],n3=numeric.dim(this.statMatrix)[0],n4=numeric.dim(this.flagMatrix)[0];if(n!=n2||n!=n3||n!=n4)return console.log("Bad matrix dimensions cannot create lines. ("+[n,n2,n3,n4]+")"),null;var output=[],column=0;negative&&(column=1);for(var row=0;row<n-1;row++)for(var rowval=this.flagMatrix[row][column],col=row+1;col<n;col++)if(rowval+this.flagMatrix[col][column]>2){var v=0;v=negative?this.negMatrix[row][col]:this.posMatrix[row][col],(v=Math.abs(v))>=matrixthreshold&&output.push([row,col])}return output}drawLines(parc,pairs,scolor,context,normallength,thickness){if(null===parc||null===pairs||null===context)return console.log("Bad inputs in drawLines"),0;for(var n=pairs.length,index=0;index<n;index++){var a_node=pairs[index][0],b_node=pairs[index][1],node=Math.floor(parc.indexmap[a_node]),othernode=Math.floor(parc.indexmap[b_node]),x1=parc.rois[node].cx,y1=parc.rois[node].cy,n1=parc.rois[node].nx,n2=parc.rois[node].ny,x2=x1-normallength*n1,y2=y1-normallength*n2,x4=parc.rois[othernode].cx,y4=parc.rois[othernode].cy,n3=parc.rois[othernode].nx,n4=parc.rois[othernode].ny,x3=x4-normallength*n3,y3=y4-normallength*n4;(y2<0||y3<0)&&console.log("Error in adding $node,$othernode "+[x1,y1,n1,n2]+", "+[x2,y2]+", "+[x3,y3]+", "+[x4,y4,n3,n4]),context.strokeStyle=scolor,context.lineWidth=thickness,context.beginPath(),context.moveTo(x1,y1),context.bezierCurveTo(x2,y2,x3,y3,x4,y4),context.stroke()}}draw3DLines(parc,poslines,neglines,radius,power){if(radius=radius||2,power=power||1,null===parc||null===poslines||null===neglines)return console.log("Bad inputs in draw3DLines"),0;var n,i,j,pairsarray=[poslines,neglines],lst=[],arr=0,index=0,MNI=[90,126,72],out=[];for(arr=0;arr<=1;arr++){var pairs=pairsarray[arr];if((n=pairs.length)>0){var vertices=new Float32Array(6*n),indices=new Uint16Array(2*n),v_index=0;for(index=0;index<n;index++){var a_node=pairs[index][0],b_node=pairs[index][1];lst.push(a_node),lst.push(b_node);var node=Math.floor(parc.indexmap[a_node]),othernode=Math.floor(parc.indexmap[b_node]),pt=[[parc.rois[node].x,parc.rois[node].y,parc.rois[node].z],[parc.rois[othernode].x,parc.rois[othernode].y,parc.rois[othernode].z]],lobe=[parc.rois[node].attr[0],parc.rois[othernode].attr[0]];for(i=0;i<=1;i++)for(j=0;j<=2;j++)0!==j?vertices[v_index]=pt[i][j]+MNI[j]:(vertices[v_index]=180-(pt[i][j]+MNI[j]),lobe[i]<11?vertices[v_index]-=this.offset:vertices[v_index]+=this.offset),++v_index;indices[2*index]=2*index,indices[2*index+1]=2*index+1}out.push({vertices:vertices,indices:indices})}else out.push({vertices:null,indices:null})}if(0===lst.length)return console.log("No Spheres ... Done\n"),out;lst=lst.filter(function(e,i,arr){return arr.lastIndexOf(e)===i});var poslst0=[],neglst0=[],poslst1=[],neglst1=[],maxp=.25*this.maxsum;for(i=0;i<lst.length;i++){var nd0=parc.indexmap[lst[i]],lob=parc.rois[nd0].attr[0];this.statMatrix[lst[i]][0]>=this.statMatrix[lst[i]][1]&&poslines.length>0?lob<11?poslst0.push(lst[i]):poslst1.push(lst[i]):lob<11?neglst0.push(lst[i]):neglst1.push(lst[i])}var posarray=[poslst0,neglst0,poslst1,neglst1],obj=[null,null,null,null];for(arr=0;arr<=3;arr++){obj[arr]={positions:[],scales:[]};var nodeindices=posarray[arr];if((n=nodeindices.length)>0)for(index=0;index<n;index++){for(var nd=nodeindices[index],int_nd=Math.floor(parc.indexmap[nd]),px=[parc.rois[int_nd].x,parc.rois[int_nd].y,parc.rois[int_nd].z],lb=parc.rois[int_nd].attr[0],ia=0;ia<=2;ia++)px[ia]=0!==ia?px[ia]+MNI[ia]:180-(px[ia]+MNI[ia]);lb<11?px[0]-=this.offset:px[0]+=this.offset,obj[arr].positions.push(px);var r=radius*Math.pow(this.statMatrix[nd][2]/maxp,power);obj[arr].scales.push(Math.max(radius,r))}out.push(obj[arr])}return out}getImageData(ispositive,isordered,context,parcellation){var index=0;if(1!==isordered&&!0!==isordered||(index=1),ispositive=0!==ispositive&&!1!==ispositive){if(null===this.posMatrix)return null;if(null!==this.posImageData[index])return this.posImageData[index]}else{if(null===this.negMatrix||!1===this.hasnegMatrix)return null;if(null!==this.negImageData[index])return this.negImageData[index]}var arr=this.negImageData,matrix=this.negMatrix;ispositive&&(arr=this.posImageData,matrix=this.posMatrix);var numrows=numeric.dim(matrix)[0],imgData=context.createImageData(numrows,numrows),yesc=[255,0,0,255],noc=[192,224,224,224];let px=0;for(var j=0;j<numrows;j++){var ja=j;isordered&&(ja=parcellation.indexmap[j]);for(var i=0;i<numrows;i++){var ia=i;isordered&&(ia=parcellation.indexmap[i]),matrix[ia][ja]>0?(imgData.data[px+0]=yesc[0],imgData.data[px+1]=yesc[1],imgData.data[px+2]=yesc[2],imgData.data[px+3]=yesc[3]):(imgData.data[px+0]=noc[0],imgData.data[px+1]=noc[1],imgData.data[px+2]=noc[2],imgData.data[px+3]=noc[3]),px+=4}}return arr[index]=imgData,arr[index]}}},"./js/legacy/bis_fmrimatrixconnectivity.js":function(module,exports,__webpack_require__){"use strict";const util=__webpack_require__("./js/core/bis_util.js"),numeric=__webpack_require__("./node_modules/numeric/numeric-1.2.6.js");var legendre=function(t,order){return 0===(order=util.range(order||0,0,6))?1:1===order?t:2===order?1.5*t*t-.5:3===order?2.5*t*t*t-1.5*t:4===order?4.375*t*t*t*t-3.75*t*t+.375:5===order?7.875*t*t*t*t*t-8.75*t*t*t+1.875*t:(231*t*t*t*t*t*t-315*t*t*t*t+105*t*t-5)/16},checkimages=function(image1,image2,checksameframes){if(checksameframes=checksameframes||!1,null===image1||null===image2)return console.log("null images in checkimages"),!1;var orient1=image1.getOrientationName(),orient2=image2.getOrientationName();if(orient1!==orient2)throw new Error("Cannot process images that have different orientations "+orient1+" vs "+orient2);var sum=0,i=0,dim1=image1.getDimensions(),dim2=image2.getDimensions(),max=3;for(checksameframes&&(max=4),i=0;i<max;i++)sum+=Math.abs(dim1[i]-dim2[i]);if(sum>.01)throw new Error("Cannot process images that have different dimensions "+dim1.join(",")+" vs "+dim2.join(","));var spa1=image1.getSpacing(),spa2=image2.getSpacing();for(sum=0,i=0;i<=2;i++)sum+=Math.abs(spa1[i]-spa2[i]);if(sum>.01)throw new Error("Cannot process images that have different spacing "+spa1.join(",")+" vs "+spa2.join(","));return!0},createLSQ=function(regressors){var A=regressors,At=numeric.transpose(A),invAtA=numeric.inv(numeric.dot(At,A));return numeric.dot(invAtA,At)},precomputed_regressout=function(input,regressors,LSQ){var bad=numeric.dot(LSQ,input),badT=numeric.dot(regressors,bad);return numeric.sub(input,badT)},regressout=function(input,regressors){var sz_inp,sz_reg,LSQ;try{sz_inp=numeric.dim(input),sz_reg=numeric.dim(regressors)}catch(e){throw new Error("Cannot regressout as input matrices are bad inp="+sz_inp+" reg="+sz_reg+" e="+e)}if(sz_inp[0]!==sz_reg[0])throw new Error("Bad array sizes for regressout. Data="+sz_inp+", reg="+sz_reg);try{LSQ=createLSQ(regressors)}catch(e){throw new Error(e)}return precomputed_regressout(input,regressors,LSQ)},rhoToZConversion=function(rho){var sign=1;rho<0&&(sign=-1);var gValue=6.103*sign;return Math.abs(rho)>1.00001?(console.log("Input correlation (r=",rho,") is greater than 1"),console.log("Returning z=",gValue),gValue):(rho>-.9999999&&rho<.9999999&&(gValue=.5*Math.log((1+rho)/(1-rho))),gValue)};const algo={legendre:legendre,createdriftregressor:function(numframes,order){numframes=numframes||2,order=util.range(order||3,0,6),numframes<1&&(numframes=1);for(var shift=.5*(numframes-1),bot=.5*(numframes-1),m=util.zero(numframes,order+1),i=0;i<numframes;i++)for(var t=(i-shift)/bot,j=0;j<=order;j++)m[i][j]=legendre(t,j);return m},checkimages:checkimages,roimean:function(input,roi){try{checkimages(input,roi)}catch(e){throw console.log(e),e}roi.computeIntensityRange();var r=roi.getIntensityRange();if(r[1]>999||r[0]<-3)throw new Error("Bad ROI Image. It has largest value > 999 (max="+r[1]+") or min value <-3 ( min="+r[0]+")");for(var dim=input.getDimensions(),volsize=dim[0]*dim[1]*dim[2],numframes=dim[3],numrois=Math.floor(r[1]),out=util.zero(numframes,numrois),num=new Int32Array(numrois),i=0;i<numrois;i++)num[i]=0;var inpdata=input.getImageData(),roidata=roi.getImageData(),voxel=0,region=0,frame=0;for(console.log("+++++ Computing ROI: volsize=",volsize," numrois=",numrois," numframes=",numframes," range=",r),voxel=0;voxel<volsize;voxel++)if((region=Math.floor(roidata[voxel])-1)>=0)for(num[region]=num[region]+1,frame=0;frame<numframes;frame++)out[frame][region]=out[frame][region]+inpdata[voxel+frame*volsize];for(region=0;region<numrois;region++)for(frame=0;frame<numframes;frame++)num[region]>0&&(out[frame][region]=out[frame][region]/num[region]);return{means:out,numvoxels:num}},regressout:regressout,weightedregressout:function(input,regressors,weights){if(null===(weights=weights||null))return regressout(input,regressors);var sz_inp,sz_reg,sz_w;try{sz_inp=numeric.dim(input),sz_reg=numeric.dim(regressors),sz_w=numeric.dim(weights)}catch(e){throw new Error("Cannot  compute regressout as matrices are bad inp="+sz_inp+" reg="+sz_reg+" w="+sz_w+" e="+e)}if(sz_inp[0]!==sz_reg[0]||sz_inp[0]!==sz_w[0])throw new Error("Bad array sizes for weighted regressout. Data="+sz_inp+", reg="+sz_reg+" w="+sz_w);var i,j,w,wR=util.zero(sz_reg[0],sz_reg[1]);for(i=0;i<sz_inp[0];i++)for(w=weights[i],j=0;j<sz_reg[1];j++)wR[i][j]=w*regressors[i][j];return function(input,weightedRegressors,weights,LSQ){var i,j,w,sz_inp=numeric.dim(input),wI=util.zero(sz_inp[0],sz_inp[1]);for(i=0;i<sz_inp[0];i++)for(w=weights[i],j=0;j<sz_inp[1];j++)wI[i][j]=w*input[i][j];var ordinary=precomputed_regressout(wI,weightedRegressors,LSQ);for(i=0;i<sz_inp[0];i++)if(w=weights[i],Math.abs(w)>.001)for(j=0;j<sz_inp[1];j++)ordinary[i][j]=ordinary[i][j]/w;return ordinary}(input,wR,weights,createLSQ(wR))},createButterworthFilter:function(passType,frequency,sampleRate,debug){debug=debug||!1,"high"!==passType&&(passType="low"),sampleRate=sampleRate||.6452,frequency="low"===passType?frequency||.02:frequency||.1;var c,a1,a2,a3,b1,b2,resonance=Math.sqrt(2),count=0,inputHistory=new Float32Array(2),outputHistory=new Float32Array(3);"low"===passType?(c=1/Math.tan(Math.PI*frequency/sampleRate),a2=2*(a1=1/(1+resonance*c+c*c)),a3=a1,b1=2*(1-c*c)*a1,b2=(1-resonance*c+c*c)*a1):(c=Math.tan(Math.PI*frequency/sampleRate),a2=-2*(a1=1/(1+resonance*c+c*c)),a3=a1,b1=2*(c*c-1)*a1,b2=(1-resonance*c+c*c)*a1),debug&&(console.log("\n\nCreating Butterworth "+passType+" filter."),console.log("\t input parameters resonance=",util.scaledround(resonance,1e3),"freq=",frequency," sampleRate=",sampleRate," ratio=",util.scaledround(frequency/sampleRate,1e4)," type=",passType),console.log("\t computed parameters= c=",util.scaledround(c,1e3),", a's=",[util.scaledround(a1,1e3),util.scaledround(a2,1e3),util.scaledround(a3,1e3)],"b's=",[util.scaledround(b1,1e3),util.scaledround(b2,1e3)]));var initialize=function(){count=0},update=function(newInput){var newOutput;return count>1?newOutput=a1*newInput+a2*inputHistory[0]+a3*inputHistory[1]-b1*outputHistory[0]-b2*outputHistory[1]:1===count?newOutput=a1*newInput+a2*inputHistory[0]-b1*outputHistory[0]:0===count&&(newOutput=a1*newInput),++count,inputHistory[1]=inputHistory[0],inputHistory[0]=newInput,outputHistory[2]=outputHistory[1],outputHistory[1]=outputHistory[0],outputHistory[0]=newOutput,newOutput};return function(orig_input,w){var input;input=null!==(w=w||null)?function(input,w){if(null!==(w=w||null)){var sz=numeric.dim(input),sw=numeric.dim(w);if(sz[0]!==sw[0])throw new Error("Bad array sizes for backfill. Data="+sz+" w="+sw);for(var r,c,v,out=numeric.clone(input),row=0,nextgoodrow=0;row<sz[0];){if(w[row]<.01){for(nextgoodrow=row+1;w[nextgoodrow]<.01&&nextgoodrow<sz[0];)nextgoodrow++;if(nextgoodrow!==sz[0])for(c=0;c<sz[1];c++)for(v=out[nextgoodrow][c],r=row;r<nextgoodrow;r++)out[r][c]=v}++row}return out}console.log("no need to backfill")}(orig_input,w):orig_input;var out,col,row,dm=numeric.dim(input);if(1===dm.length){for(out=util.zero(dm[0],1),initialize(),row=0;row<dm[0];row++)out[row]=update(input[row]);return out}for(out=util.zero(dm[0],dm[1]),col=0;col<dm[1];col++)for(initialize(),row=0;row<dm[0];row++)out[row][col]=update(input[row][col]);return out}},rhoToZConversion:rhoToZConversion,computeCorrelationMatrix:function(input,toz,weights){toz=toz||!1,weights=weights||null;var sz=numeric.dim(input);if(2!==sz.length||sz[0]<3)throw new Error("Bad matrix sizes for computeCorrelationMatrix. Mush be a 2D Matrix with at least three rows");if(null===weights){weights=util.zero([sz[0],1]);for(var ia=0;ia<sz[0];ia++)weights[ia]=1}else{var sw=numeric.dim(weights);if(sw[0]!==sz[0])throw new Error("Bad weight size for computeCorrelationMatrix. Mush be a 2D Matrix of dimenion ",sz[0],"*",1," it is ",sw)}var row,col,sum,sum2,mean,sigma,norm=util.zero(sz[0],sz[1]),sumw=0;for(row=0;row<sz[0];row++)sumw+=weights[row];for(row=0;row<sz[0];row++)weights[row]=weights[row]/sumw;if(sumw<1e-5)throw new Error("bad weights, must have a positive sum!");for(col=0;col<sz[1];col++){for(sum=0,sum2=0,row=0;row<sz[0];row++){var v=input[row][col];sum+=v*weights[row],sum2+=v*v*weights[row]}if(mean=sum,(sigma=Math.sqrt(sum2-mean*mean))>0)for(row=0;row<sz[0];row++)norm[row][col]=(input[row][col]-mean)/sigma}var outrow,outcol,out=util.zero(sz[1],sz[1]);for(outrow=0;outrow<sz[1];outrow++)for(outcol=0;outcol<sz[1];outcol++){for(sum=0,row=0;row<sz[0];row++)sum+=norm[row][outrow]*norm[row][outcol]*weights[row];toz&&(sum=rhoToZConversion(sum)),out[outrow][outcol]=sum,out[outcol][outrow]=sum}return out},regressGlobalSignal:function(input,weights){weights=weights||null;var sz=numeric.dim(input);if(null===weights){weights=util.zero([sz[0],1]);for(var ia=0;ia<sz[0];ia++)weights[ia]=1}else{var sw=numeric.dim(weights);if(sw[0]!==sz[0])throw new Error("Bad weight size for global Signal Regression. Mush be a 2D Matrix of dimenion ",sz[0],"*",1," it is ",sw)}var row,col,mean=function(input,weights){var row,sum,dm=numeric.dim(input),mean=util.zero(dm[0],1);for(row=0;row<dm[0];row++){if(sum=0,weights[row]>.01)for(var col=0;col<dm[1];col++)sum+=input[row][col];mean[row]=sum/dm[1]}for(sum=0,row=0;row<dm[0];row++)sum+=mean[row]*mean[row];var magn=Math.sqrt(sum);for(row=0;row<dm[0];row++)mean[row]=mean[row]/magn;return mean}(input,weights),out=util.zero(sz[0],sz[1]),sum=0;for(col=0;col<sz[1];col++){for(sum=0,row=0;row<sz[0];row++)weights[row]>.01&&(sum+=input[row][col]*mean[row]);for(row=0;row<sz[0];row++)weights[row]>.01&&(out[row][col]=input[row][col]-sum*mean[row])}return out}};module.exports=algo},"./js/legacy/bis_imagealgorithms.js":function(module,exports,__webpack_require__){"use strict";const BisWebImage=__webpack_require__("./js/dataobjects/bisweb_image.js");let computeTotalMinusLogProbability=function(intensity,current_voxel,trylabel,labels,gridspec,smoothness){-1===current_voxel&&console.log("in compute tmlp = ",intensity,current_voxel,trylabel,smoothness,gridspec);let pmrf=0,i=0;if(smoothness>.001)for(i=0;i<gridspec.increments.length;i++)Math.abs(trylabel-labels[current_voxel+gridspec.increments[i]])>1e-4&&(pmrf+=gridspec.weights[i]);return pmrf*=smoothness,Math.abs(trylabel-intensity)>1e-4&&(pmrf+=1),pmrf},classifyVoxel=function(voxel_index,intensities,labels,outlabels,gridspec,smoothness){let current_label=labels[voxel_index],intensity=intensities[voxel_index],ids=[current_label];for(let ia=0;ia<gridspec.increments.length;ia++){let l=Math.floor(intensities[voxel_index+gridspec.increments[ia]]);ids.indexOf(l)<0&&ids.push(l)}let bestprob=0,bestclass=current_label,numclasses=ids.length;if(-1==voxel_index&&console.log("in classify voxel index=",voxel_index,"ids=",ids.join()),numclasses>1){for(let i=0;i<numclasses;i++){let prob=computeTotalMinusLogProbability(intensity,voxel_index,ids[i],labels,gridspec,smoothness);(prob-bestprob<1e-6||0===i)&&(bestprob=prob,bestclass=ids[i]),-1==voxel_index&&console.log("class=",i,"prop=",prob," best=",bestprob," class=",bestclass)}if(bestclass!=current_label)return outlabels[voxel_index]=bestclass,1}return outlabels[voxel_index]=current_label,0},createClusterNumberImage=function(input,threshold,oneconnected){oneconnected=oneconnected||!1;let cluster_output=new BisWebImage;cluster_output.cloneImage(input,{type:"short"});let dim=input.getDimensions(),slicesize=dim[0]*dim[1],volsize=slicesize*dim[2],clusters={},clusterseeds={},inpdata=input.getImageData(),clustdata=cluster_output.getImageData(),i=0;for(i=0;i<volsize;i++)clustdata[i]=0;let shifts=[],maxc=1;1==dim[2]&&(maxc=0);for(let ic=-maxc;ic<=maxc;ic++)for(let ib=-1;ib<=1;ib++)for(let ia=-1;ia<=1;ia++){let sh=ic*slicesize+ib*dim[0]+ia,diff=Math.abs(ia)+Math.abs(ib)+Math.abs(ic);1===diff?shifts.push([ia,ib,ic,sh]):oneconnected||0===diff||shifts.push([ia,ib,ic,sh])}let maxshift=shifts.length,CurrentCluster=1,voxelindex=0;for(let idZ=0;idZ<dim[2];idZ++)for(let idY=0;idY<dim[1];idY++)for(let idX=0;idX<dim[0];idX++){if(0===clustdata[voxelindex]){let value=inpdata[voxelindex],voxelsign=1;if(value<0&&(voxelsign=-1),(value=Math.abs(value))>=threshold){let stack=[];stack.push([idX,idY,idZ,voxelindex]);let nClusterVoxels=1;for(clustdata[voxelindex]=CurrentCluster,clusterseeds[CurrentCluster]=[idX,idY,idZ];stack.length>0;){let CP=stack.shift();for(let nb=0;nb<maxshift;nb++){let i1=CP[0]+shifts[nb][0],i2=CP[1]+shifts[nb][1],i3=CP[2]+shifts[nb][2];if(i1>=0&&i1<dim[0]&&i2>=0&&i2<dim[1]&&i3>=0&&i3<dim[2]){let tmpindex=CP[3]+shifts[nb][3],ot=clustdata[tmpindex],it=voxelsign*inpdata[tmpindex];0===ot&&(it>=threshold?(clustdata[tmpindex]=CurrentCluster,stack.push([i1,i2,i3,tmpindex]),nClusterVoxels++):clustdata[tmpindex]=-1)}}}clusters[CurrentCluster]=nClusterVoxels,CurrentCluster+=1}else clustdata[voxelindex]=-1}++voxelindex}let sumc=0,maxsize=0;for(clusters[0]=0,i=0;i<CurrentCluster;i++)clusters[i]>maxsize&&(maxsize=clusters[i]),sumc+=clusters[i];return console.log("+++++ clustering at threshold"+threshold+", numvoxels that pass="+sumc+", maxsize="+maxsize+", numclusters=",CurrentCluster),{clusterimage:cluster_output,maxsize:maxsize,clusterhist:clusters,numclusters:CurrentCluster}},clusterFilter=function(input,clusterOutput,clustersizethreshold){let inpdata=input.getImageData(),dim=input.getDimensions(),volsize=dim[0]*dim[1]*dim[2],output=new BisWebImage;output.cloneImage(input);let outdata=output.getImageData(),clustdata=clusterOutput.clusterimage.getImageData(),clusterhist=clusterOutput.clusterhist,maxsize=clusterOutput.maxsize,numpass=0;for(let i=0;i<volsize;i++){clusterhist[Math.floor(clustdata[i])]>=clustersizethreshold?(++numpass,outdata[i]=inpdata[i]):outdata[i]=0}return console.log("+++++ cluster size masking biggest_cluster=",maxsize," threshold=",clustersizethreshold," numpass=",numpass),output};const algo={regularizeObjectmap:function(volume,numberofiterations,smoothness,convergence){numberofiterations=numberofiterations||4,smoothness=smoothness||4,convergence=convergence||.2,console.log("convergence=",convergence," smoothness=",smoothness," iter=",numberofiterations);let newvol=new BisWebImage;newvol.cloneImage(volume,{type:"short"});let intensities=volume.getImageData(),nt=intensities.length,out_labels=newvol.getImageData(),i=0,labels=new Uint16Array(nt);for(i=0;i<nt;i++)out_labels[i]=intensities[i],labels[i]=0;let gridspec=function(volume){let dim=volume.getDimensions(),sp=volume.getSpacing(),incr=null,wgt=null;if(dim[2]>1){incr=new Array(26),wgt=new Array(26);let slicesize=dim[0]*dim[1],index=0,d=[0,0,0];for(let ic=-1;ic<=1;ic++){d[2]=Math.pow(sp[2]*ic,2);for(let ib=-1;ib<=1;ib++){d[1]=Math.pow(sp[1]*ib,2);for(let ia=-1;ia<=1;ia++)d[0]=Math.pow(sp[0]*ia,2),0===ia&&0===ib&&0===ic||(incr[index]=ia+ib*dim[0]+ic*slicesize,wgt[index]=1/Math.sqrt(d[0]+d[1]+d[2]),++index)}}}else{incr=new Array(8),wgt=new Array(8);let index=0,d=[0,0,0];for(let ib=-1;ib<=1;ib++){d[1]=Math.pow(sp[1]*ib,2);for(let ia=-1;ia<=1;ia++)d[0]=Math.pow(sp[0]*ia,2),0===ia&&0===ib||(incr[index]=ia+ib*dim[0],wgt[index]=1/Math.sqrt(d[0]+d[1]),++index)}}let len=incr.length,sum=0;for(let l=0;l<len;l++)sum+=wgt[l];for(let k=0;k<len;k++)wgt[k]/=sum;return{weights:wgt,increments:incr}}(volume),tenth=Math.round(nt/11);console.log(gridspec,tenth);let dim=volume.getDimensions(),mink=1,maxk=dim[2]-1;1==dim[2]&&(mink=0,maxk=1);let slicesize=dim[0]*dim[1],iterations=0;for(;iterations<=numberofiterations;){for(++iterations,console.log("\n + + + + + +  Iteration "+iterations+"("+smoothness+")"),i=0;i<nt;i++)labels[i]=out_labels[i];let changed=0,total=0,count=0;for(let k=mink;k<maxk;k++)for(let j=1;j<dim[1]-1;j++){let vox=k*slicesize+j*dim[0]+1;for(i=1;i<dim[0]-1;i++)count==tenth&&(console.log("."),count=0),-1===vox&&console.log("vox=",vox," val=",intensities[vox]," labels=",labels[vox]," out=",out_labels[vox]," smoo=",smoothness),changed+=classifyVoxel(vox,intensities,labels,out_labels,gridspec,smoothness),++vox,++total,++count}changed=100*changed/total,console.log("changed=",changed," vs",convergence,"\n"),changed<convergence&&(iterations=numberofiterations+1)}return labels=null,newvol.computeIntensityRange(),newvol},createClusterNumberImage:createClusterNumberImage,clusterFilter:clusterFilter,maskImage:function(image,mask){let outimage=new BisWebImage;outimage.cloneImage(image,{type:"float"});let outdata=outimage.getImageData(),sum=0,i=0,nump=outdata.length,dim1=image.getDimensions(),dim2=mask.getDimensions();for(i=0;i<=2;i++)sum+=Math.abs(dim1[i]-dim2[i]);if(sum>.01)throw new Error("Cannot mask image, as mask and image have different dimensions "+dim1.join(",")+" vs "+dim2.join(","));let mdata=mask.getImageData(),indata=image.getImageData();for(i=0;i<nump;i++)mdata[i]>0?outdata[i]=indata[i]:outdata[i]=0;return outimage},multiplyImages:function(image1,image2){let outimage=new BisWebImage;outimage.cloneImage(image1,{type:"float"});let outdata=outimage.getImageData(),sum=0,i=0,nump=outdata.length,dim1=image1.getDimensions(),dim2=image2.getDimensions();for(i=0;i<=2;i++)sum+=Math.abs(dim1[i]-dim2[i]);if(sum>.01)throw new Error("Cannot mask image, as mask and image have different dimensions "+dim1.join(",")+" vs "+dim2.join(","));let indata1=image1.getImageData(),indata2=image2.getImageData();for(i=0;i<nump;i++)outdata[i]=indata1[i]*indata2[i];return outimage},spectNormalize:function(image){let outimage=new BisWebImage;outimage.cloneImage(image,{type:"float"});let outdata=outimage.getImageData(),X=0,Y=0,sum=0,i=0,num=0,nump=outdata.length,indata=image.getImageData();for(i=0;i<nump;i++)sum+=indata[i],num+=1;for(X=sum/(8*num),sum=0,num=0,i=0;i<nump;i++)indata[i]>X&&(sum+=indata[i],num+=1);let scale=50/(Y=sum/num);for(i=0;i<nump;i++){let v1=indata[i]*scale;outdata[i]=v1>40?v1:0}return outimage},spectTmap:function(ictal,interictal,templatesigma,templatemean){templatemean=templatemean||null;let sum=0,i=0,dim1=ictal.getDimensions(),dim2=interictal.getDimensions(),dim3=templatesigma.getDimensions(),dim4=dim3;for(null!==templatemean&&(dim4=templatemean.getDimensions()),i=0;i<=2;i++)sum+=Math.abs(dim1[i]-dim2[i])+Math.abs(dim1[i]-dim3[i])+Math.abs(dim1[i]-dim4[i]);if(sum>.01)throw new Error("Cannot process spect images that have different dimensions "+dim1.join(",")+" vs "+dim2.join(",")+" vs template="+dim3.join(",")+","+dim4.join(","));let spect=[ictal.getImageData(),interictal.getImageData()],templatedata=templatesigma.getImageData(),nump=templatedata.length,templatemeandata=null;null!==templatemean&&(templatemeandata=templatemean.getImageData());let outimage=new BisWebImage;outimage.cloneImage(templatesigma,{type:"float"});let outdata=outimage.getImageData();for(i=0;i<nump;i++){outdata[i]=0;let sigma=templatedata[i],v1=spect[0][i],v2=spect[1][i];if(sigma>0&&v1>0&&v2>0){let diff=v1-v2;null!==templatemean&&(diff-=templatemeandata[i]),outdata[i]=diff/sigma}}return outimage},processDiffSPECTImageTmap:function(tmapimage,sigThr,extent,positive){let tscore=1.76885;Math.abs(sigThr-.01)<.01?(tscore=2.64951,sigThr=.01):Math.abs(sigThr-.005)<.001?(tscore=3.00977,sigThr=.005):Math.abs(sigThr-.001)<.001?(tscore=3.85352,sigThr=.001):sigThr=.05,console.log("+++++ thresholding using tscore="+tscore+"( pvalue ="+sigThr+")");let tmp=Math.pow(1+tscore*tscore/13,-6),eulerDensity=[0,0,0,0];eulerDensity[0]=sigThr,eulerDensity[1]=.265*tmp,eulerDensity[2]=.1727*tscore*tmp,eulerDensity[3]=.1169*tmp*(12*tscore*tscore/13-1);let expectedVoxPerCluster=eulerDensity[0]/eulerDensity[3],expectedNumOfCluster=function(tmap,eulerDensity){let val={volume:0,cubes:0,xyFaces:0,yzFaces:0,xzFaces:0,xEdges:0,yEdges:0,zEdges:0,reselCount:[0,0,0,0]},dim=tmap.getDimensions(),data=tmap.getImageData(),slicesize=dim[0]*dim[1],rowsize=dim[0];for(let k=0;k<dim[2]-1;k++){let kindex=k*slicesize;for(let j=0;j<dim[1]-1;j++){let index=j*rowsize+kindex;for(let i=0;i<dim[0]-1;i++)Math.abs(data[index])>0&&(val.volume=val.volume+1,Math.abs(data[index+1])>0&&(val.xEdges=val.xEdges+1,Math.abs(data[index+rowsize])>0&&Math.abs(data[index+1+rowsize])>0&&(val.xyFaces+=1,Math.abs(data[index+slicesize])>0&&Math.abs(data[index+1+slicesize])>0&&Math.abs(data[index+rowsize+slicesize])>0&&Math.abs(data[index+1+rowsize+slicesize])>0&&(val.cubes+=1))),Math.abs(data[index+rowsize])>0&&(val.yEdges+=1,Math.abs(data[index+slicesize])>0&&Math.abs(data[index+rowsize+slicesize])>0&&(val.yzFaces+=1)),Math.abs(data[index+slicesize])>0&&(val.zEdges++,Math.abs(data[index+1])>0&&Math.abs(data[index+1+slicesize])>0&&val.xzFaces++)),index+=1}}let xDim=.11627907,yDim=.120481928,zDim=.109289617;val.reselCount[0]=val.volume-val.xEdges-val.yEdges-val.zEdges+val.xyFaces+val.xzFaces+val.yzFaces-val.cubes,val.reselCount[1]=(val.xEdges-val.xyFaces-val.xzFaces+val.cubes)*xDim+(val.yEdges-val.xyFaces-val.yzFaces+val.cubes)*yDim+(val.zEdges-val.yzFaces-val.xzFaces+val.cubes)*zDim,val.reselCount[2]=(val.xyFaces-val.cubes)*xDim*yDim+(val.xzFaces-val.cubes)*xDim*zDim+(val.yzFaces-val.cubes)*zDim*yDim,val.reselCount[3]=val.cubes*xDim*yDim*zDim;let expectedNumOfCluster=0;for(let kk=0;kk<4;kk++)expectedNumOfCluster+=eulerDensity[kk]*val.reselCount[kk];return expectedNumOfCluster}(tmapimage,eulerDensity),newvol=new BisWebImage;newvol.cloneImage(tmapimage);let diffdata=tmapimage.getImageData(),outdata=newvol.getImageData(),dim=newvol.getDimensions(),slicesize=dim[0]*dim[1],volsize=slicesize*dim[2],i=0;if(positive)for(i=0;i<volsize;i++)diffdata[i]<0?outdata[i]=0:outdata[i]=diffdata[i];else for(i=0;i<volsize;i++)diffdata[i]>0?outdata[i]=0:outdata[i]=diffdata[i];let clusterOutput=createClusterNumberImage(newvol,tscore,!0),outputImage=clusterFilter(newvol,clusterOutput,extent),clustdata=clusterOutput.clusterimage.getImageData(),clusterhist=clusterOutput.clusterhist,numc=clusterOutput.numclusters,clusterinfo_i=new Array(numc+1),clusterinfo_t=new Array(numc+1);for(i=0;i<=numc;i++)clusterinfo_t[i]=0;for(i=0;i<volsize;i++){let clusterno=Math.floor(clustdata[i]),v=Math.abs(diffdata[i]);v>clusterinfo_t[clusterno]&&(clusterinfo_t[clusterno]=v,clusterinfo_i[clusterno]=i)}let outputdata=[],En=expectedVoxPerCluster,EM=expectedNumOfCluster,index=1;for(i=1;i<=numc;i++)if(clusterhist[i]>extent){let ka=Math.floor(clusterinfo_i[i]/slicesize),t=clusterinfo_i[i]-ka*slicesize,ja=Math.floor(t/dim[0]),ia=t%dim[0],kSize=clusterhist[i],tval=clusterinfo_t[i];positive||(tval*=-1);let clusterPvalue=Math.exp(-Math.pow(1.3378/En*kSize/653.1270000000001,2/3)),correctPvalue=1-Math.exp(-EM*clusterPvalue);outputdata.push({string:index+"\t"+ia+"\t"+ja+"\t"+ka+"\t"+kSize+"\t"+clusterinfo_t[i].toFixed(4)+"\t"+clusterPvalue.toFixed(12)+"\t"+correctPvalue.toFixed(12),index:index,size:kSize,coords:[ia,ja,ka],clusterPvalue:clusterPvalue,correctPvalue:correctPvalue,maxt:tval}),++index}return outputdata.sort((a,b)=>a.size<b.size?1:a.size>b.size?-1:0),{image:outputImage,stats:outputdata}}};module.exports=algo},"./js/legacy/bis_imageslicer.js":function(module,exports,__webpack_require__){"use strict";const util=__webpack_require__("./js/core/bis_util.js");module.exports=class{constructor(image,opts){this.internal={imagedata:null,imagedim:null,imagespa:null,imageorientinvaxis:[0,1,2],imageorientinvflip:[0,0,0],plane:0,currentslice:-1,currentframe:-1,mapfunction:null,nexttimeforce:!1,outputslice:null,canvas:null,canvasdata:null,slicedim:[0,0],slicespa:[1,1],sliceindices:[0,1,2],cameradepth:100,camerabelow:!1,outofrange:!1},this.initialize(image,opts)}prepareCanvas(){if(null===this.internal.canvasdata){var ctx=this.internal.canvas.getContext("2d");this.internal.canvas.width=this.internal.slicedim[0],this.internal.canvas.height=this.internal.slicedim[1],this.internal.canvasdata=ctx.createImageData(this.internal.slicedim[0],this.internal.slicedim[1]),this.internal.outputslice=this.internal.canvasdata.data}}getminmaxaxis(){var out;return 2==this.internal.plane?(out=[0,1],this.internal.imageorientinvaxis[0]>this.internal.imageorientinvaxis[1]&&(out=[1,0])):1==this.internal.plane?(out=[0,2],this.internal.imageorientinvaxis[0]>this.internal.imageorientinvaxis[2]&&(out=[2,0])):(out=[1,2],this.internal.imageorientinvaxis[1]>this.internal.imageorientinvaxis[2]&&(out=[2,1])),out}initialize(bisimage,opts){if(0!==(opts=opts||{}).plane&&(opts.plane=opts.plane||2),opts.objectmapmode=opts.objectmap||!1,"function"!=typeof bisimage.getImageData||"function"!=typeof bisimage.getDimensions)throw new Error("Cannot initialize slicer, bad image ");this.internal.imagespa=[1,1,1],"function"==typeof bisimage.getSpacing&&(this.internal.imagespa=bisimage.getSpacing()),"function"==typeof bisimage.getOrientation&&(this.internal.imageorientinvaxis=bisimage.getOrientation().invaxis,this.internal.imageorientinvflip=bisimage.getOrientation().invflip),this.internal.imagedata=bisimage.getImageData(),this.internal.imagedim=bisimage.getDimensions(),this.internal.imagedim[4]>1&&(this.internal.imagedim[3]=this.internal.imagedim[3]*this.internal.imagedim[4],this.internal.imagedim[4]=1),this.internal.plane=util.range(opts.plane,0,2),0===this.internal.plane?this.internal.sliceindices=[1,2,0]:1===this.internal.plane?this.internal.sliceindices=[0,2,1]:this.internal.sliceindices=[0,1,2],this.internal.slicedim=[this.internal.imagedim[this.internal.sliceindices[0]],this.internal.imagedim[this.internal.sliceindices[1]]],this.internal.slicespa=[this.internal.imagespa[this.internal.sliceindices[0]],this.internal.imagespa[this.internal.sliceindices[1]]],this.internal.currentslice=-1,this.internal.outputslice=null;for(var d=0,i=0;i<=2;i++){var sz=this.internal.imagedim[i]*this.internal.imagespa[i];sz>d&&(d=sz)}this.internal.cameradepth=Math.round(2*d);var rng=[0,255];"function"==typeof bisimage.getIntensityRange&&(rng=bisimage.getIntensityRange()),opts.objectmapmode?this.internal.mapfunction=util.mapobjectmapfactory(255):this.internal.mapfunction=util.mapstepcolormapfactory(rng[0],rng[1],255);const that=this;this.internal.camerabelow=(()=>{var axes=that.getminmaxaxis(),flip1=that.internal.imageorientinvflip[axes[0]]>0,doflip=!1,y=that.getcameraup(),z=[0,0,0];z[that.internal.plane]=1;var x=[z[2]*y[1]-z[1]*y[2],z[0]*y[2]-z[2]*y[0],z[1]*y[0]-z[0]*y[1]];return x[0]+x[1]+x[2]>0&&(doflip=!0),flip1&&(doflip=!doflip),doflip})()}setcanvas(canvas){this.internal.canvas=canvas,this.internal.outputslice=null,this.internal.canvasdata=null}setnexttimeforce(){this.internal.nexttimeforce=!0}doineedtoupdate(slice,frame){return frame=frame||this.currentframe,!0===this.internal.nexttimeforce||null===this.internal.outputslice||(slice=util.range(slice,0,this.internal.imagedim[this.internal.plane]-1),frame=util.range(frame,0,this.internal.imagedim[3]-1),slice!==this.internal.currentslice||frame!==this.internal.currentframe)}getslice(slice,frame,mapfunction){frame=frame||0,mapfunction=mapfunction||this.internal.mapfunction,this.internal.outofrange=!1,null!==this.internal.canvas&&this.prepareCanvas(),this.internal.nexttimeforce=!1,this.internal.currentslice=slice,this.internal.currentframe=frame;let sourceWidth=this.internal.imagedim[0],sourceHeight=this.internal.imagedim[1],sourceDepth=this.internal.imagedim[2],voloffset=sourceWidth*sourceHeight*sourceDepth*this.internal.currentframe,v=[0,0,0,0];if(null===this.internal.outputslice&&(this.internal.outputslice=new Uint8Array(this.internal.slicedim[0]*this.internal.slicedim[1]*4)),2==this.internal.plane)if(this.internal.currentslice<0||this.internal.currentslice>=sourceDepth){for(let ij=0;ij<sourceHeight*sourceWidth*4;ij++)this.internal.outputslice[ij]=0;this.internal.outofrange=!0}else{let offset=this.internal.currentslice*this.internal.imagedim[0]*this.internal.imagedim[1]+voloffset,outindex=0,index=0;for(let j=0;j<sourceHeight;j++)for(let i=0;i<sourceWidth;i++)mapfunction(this.internal.imagedata,offset+index,v),this.internal.outputslice[outindex]=v[0],this.internal.outputslice[outindex+1]=v[1],this.internal.outputslice[outindex+2]=v[2],this.internal.outputslice[outindex+3]=v[3],++index,outindex+=4}else if(1===this.internal.plane)if(this.internal.currentslice<0||this.internal.currentslice>=sourceHeight){for(let ij=0;ij<sourceDepth*sourceWidth*4;ij++)this.internal.outputslice[ij]=0;this.internal.outofrange=!0}else{let outindex=0;for(let j=0;j<sourceDepth;j++){let sliceoffset=voloffset+j*sourceWidth*sourceHeight+this.internal.currentslice*sourceWidth;for(let i=0;i<sourceWidth;i++)mapfunction(this.internal.imagedata,sliceoffset+i,v),this.internal.outputslice[outindex]=v[0],this.internal.outputslice[outindex+1]=v[1],this.internal.outputslice[outindex+2]=v[2],this.internal.outputslice[outindex+3]=v[3],outindex+=4}}else if(this.internal.currentslice<0||this.internal.currentslice>=sourceWidth){for(let ij=0;ij<sourceDepth*sourceHeight*4;ij++)this.internal.outputslice[ij]=0;this.internal.outofrange=!0}else{let outindex=0;for(let j=0;j<sourceDepth;j++){let sliceoffset=j*sourceWidth*sourceHeight+this.internal.currentslice+voloffset;for(let i=0;i<sourceHeight;i++)mapfunction(this.internal.imagedata,sliceoffset+i*sourceWidth,v),this.internal.outputslice[outindex]=v[0],this.internal.outputslice[outindex+1]=v[1],this.internal.outputslice[outindex+2]=v[2],this.internal.outputslice[outindex+3]=v[3],outindex+=4}}return null!==this.internal.canvas?(this.internal.canvas.getContext("2d").putImageData(this.internal.canvasdata,0,0),this.internal.canvas):this.internal.outputslice}getsliceframecoords(){return[this.internal.currentslice,this.internal.currentframe]}getslicedims(){return[this.internal.slicedim[0],this.internal.slicedim[1]]}getsliceextent(){return[-.5*this.internal.slicespa[0],-.5*this.internal.slicespa[1],(this.internal.slicedim[0]-.5)*this.internal.slicespa[0],(this.internal.slicedim[1]-.5)*this.internal.slicespa[1]]}getsliceoffset(){var offset=[0,0,0];return offset[this.internal.plane]=.001*Math.round(this.internal.currentslice*this.internal.imagespa[this.internal.plane]*1e3),offset}getslicecenter(){var cnt=[.5*(this.internal.slicedim[0]-1)*this.internal.slicespa[0],.5*(this.internal.slicedim[1]-1)*this.internal.slicespa[1]],pos=this.internal.currentslice*this.internal.imagespa[this.internal.plane];return 2==this.internal.plane?[cnt[0],cnt[1],pos]:1==this.internal.plane?[cnt[0],pos,cnt[1]]:[pos,cnt[0],cnt[1]]}getplanepoints(){var ext=this.getsliceextent();return 2===this.internal.plane?[[ext[0],ext[1],0],[ext[0],ext[3],0],[ext[2],ext[3],0]]:1===this.internal.plane?[[ext[0],0,ext[1]],[ext[0],0,ext[3]],[ext[2],0,ext[3]]]:[[0,ext[0],ext[1]],[0,ext[0],ext[3]],[0,ext[2],ext[3]]]}getoutlineplanepoints(){var ext=this.getsliceextent();return ext[0]-=.5*this.internal.slicespa[0],ext[2]+=.5*this.internal.slicespa[0],ext[1]-=.5*this.internal.slicespa[1],ext[3]+=.5*this.internal.slicespa[1],2===this.internal.plane?[[ext[0],ext[1],0],[ext[0],ext[3],0],[ext[2],ext[3],0]]:1===this.internal.plane?[[ext[0],0,ext[1]],[ext[0],0,ext[3]],[ext[2],0,ext[3]]]:[[0,ext[0],ext[1]],[0,ext[0],ext[3]],[0,ext[2],ext[3]]]}getaxispoints(){var ext=[0,0,(this.internal.slicedim[0]-1)*this.internal.slicespa[0],(this.internal.slicedim[1]-1)*this.internal.slicespa[1]],sz=.5*this.internal.imagespa[this.internal.plane];return 2==this.internal.plane?[[[ext[0],ext[1],-sz],[ext[0],ext[1],sz],[ext[2],ext[1],sz]],[[ext[0],ext[1],-sz],[ext[0],ext[1],sz],[ext[0],ext[3],sz]]]:1===this.internal.plane?[[[ext[0],-sz,ext[1]],[ext[0],sz,ext[1]],[ext[2],sz,ext[1]]],[[ext[0],-sz,ext[1]],[ext[0],sz,ext[1]],[ext[0],sz,ext[3]]]]:[[[-sz,ext[0],ext[1]],[sz,ext[0],ext[1]],[sz,ext[2],ext[1]]],[[-sz,ext[0],ext[1]],[sz,ext[0],ext[1]],[sz,ext[0],ext[3]]]]}getcamerabelow(){return this.internal.camerabelow}getcamerapos(){var cnt=this.getslicecenter();return this.internal.camerabelow?cnt[this.internal.plane]=-.5*this.internal.cameradepth:cnt[this.internal.plane]=this.internal.imagedim[this.internal.plane]*this.internal.imagespa[this.internal.plane]+.5*this.internal.cameradepth,cnt}getcameraup(){var upv=[0,0,0],maxaxis=this.getminmaxaxis()[1],value=-1;return this.internal.imageorientinvflip[maxaxis]>0&&(value=1),upv[maxaxis]=value,upv}getoutofrange(){return this.internal.outofrange}}},"./js/legacy/bis_imagesmoothreslice.js":function(module,exports,__webpack_require__){"use strict";const util=__webpack_require__("./js/core/bis_util.js"),transformationFactory=__webpack_require__("./js/legacy/bis_transformationutil.js"),BisWebImage=__webpack_require__("./js/dataobjects/bisweb_image.js");var generateKernel=function(sigma,radius){var len=2*radius+1,kernel=new Float32Array(len),i=0,sum=0;for(i=0;i<len;i++)kernel[i]=Math.exp(-.5*Math.pow(i-radius,2)/Math.pow(sigma,2)),sum+=kernel[i];for(i=0;i<len;i++)kernel[i]=kernel[i]/sum;return kernel},oneDConvolution=function(imagedata_in,imagedata_out,dim,kernel,radius,axis){var sum,coord,ia,ib,ic,tau,fixedtau,index=0,slicesize=dim[0]*dim[1],offsets=[1,dim[0],slicesize],axes=[0,1,2];1==axis?axes=[1,0,2]:2==axis&&(axes=[2,0,1]);for(var newdim=[0,0,0],newoffsets=[0,0,0],i=0;i<=2;i++)newdim[i]=dim[axes[i]],newoffsets[i]=offsets[axes[i]];for(var newdim0minus=newdim[0]-1,maxia=newdim[0]-radius,volsize=dim[0]*dim[1]*dim[2],frame=0;frame<dim[3];frame++)for(ic=0;ic<newdim[2];ic++)for(ib=0;ib<newdim[1];ib++)for(index=ic*newoffsets[2]+ib*newoffsets[1]+frame*volsize,ia=0;ia<newdim[0];ia++){if(sum=0,ia>=radius&&ia<maxia)for(tau=-radius;tau<=radius;tau++){sum+=kernel[tau+radius]*imagedata_in[index+tau*newoffsets[0]]}else for(tau=-radius;tau<=radius;tau++)fixedtau=tau,(coord=tau+ia)<0?fixedtau=-ia:coord>newdim0minus&&(fixedtau=newdim0minus-ia),sum+=kernel[tau+radius]*imagedata_in[index+fixedtau*newoffsets[0]];imagedata_out[index]=sum,index+=newoffsets[0]}},linearInterpolationFunction4D=function(cache){var data=cache.input_data,B00=0|cache.TX[0],B01=B00+1,W00=B01-cache.TX[0],W01=1-W00,B10=0|cache.TX[1],B11=B10+1,W10=B11-cache.TX[1],W11=1-W10;B10*=cache.dim0,B11*=cache.dim0;var B20=0|cache.TX[2],B21=B20+1,W20=B21-cache.TX[2],W21=1-W20;return B20=B20*cache.slicesize+cache.offset,B21=B21*cache.slicesize+cache.offset,W20*W10*W00*data[B20+B10+B00]+W20*W10*W01*data[B20+B10+B01]+W20*W11*W00*data[B20+B11+B00]+W20*W11*W01*data[B20+B11+B01]+W21*W10*W00*data[B21+B10+B00]+W21*W10*W01*data[B21+B10+B01]+W21*W11*W00*data[B21+B11+B00]+W21*W11*W01*data[B21+B11+B01]},linearInterpolationFunction=function(cache){var data=cache.input_data,B00=0|cache.TX[0],B01=B00+1,W00=B01-cache.TX[0],W01=1-W00,B10=0|cache.TX[1],B11=B10+1,W10=B11-cache.TX[1],W11=1-W10;B10*=cache.dim0,B11*=cache.dim0;var B20=0|cache.TX[2],B21=B20+1,W20=B21-cache.TX[2],W21=1-W20;return B20*=cache.slicesize,B21*=cache.slicesize,W20*W10*W00*data[B20+B10+B00]+W20*W10*W01*data[B20+B10+B01]+W20*W11*W00*data[B20+B11+B00]+W20*W11*W01*data[B20+B11+B01]+W21*W10*W00*data[B21+B10+B00]+W21*W10*W01*data[B21+B10+B01]+W21*W11*W00*data[B21+B11+B00]+W21*W11*W01*data[B21+B11+B01]},linearInterpolationFunction2D=function(cache){var data=cache.input_data,B00=0|cache.TX[0],B01=B00+1,W00=B01-cache.TX[0],W01=1-W00,B10=0|cache.TX[1],B11=B10+1,W10=B11-cache.TX[1],W11=1-W10;return B10*=cache.dim0,B11*=cache.dim0,W10*W00*data[B10+B00]+W10*W01*data[B10+B01]+W11*W00*data[B11+B00]+W11*W01*data[B11+B01]+W10*W00*data[B10+B00]+W10*W01*data[B10+B01]+W11*W00*data[B11+B00]+W11*W01*data[B11+B01]},nearestInterpolationFunction=function(cache){return cache.input_data[Math.round(cache.TX[2])*cache.slicesize+Math.round(cache.TX[1])*cache.dim0+Math.round(cache.TX[0])+cache.offset]},cubicInterpolationFunction=function(cache){var f,fm1,fd2,ft3,data=cache.input_data,TX0=cache.TX[0],TX1=cache.TX[1],TX2=cache.TX[2],minusdim0=cache.minusdim[0],minusdim1=cache.minusdim[1],minusdim2=cache.minusdim[2],B01=0|TX0,B00=B01-1;B00<0&&(B00=0);var B02=B01+1,B03=B01+2;B02>minusdim0?(B02=minusdim0,B03=minusdim0):B03>minusdim0&&(B03=minusdim0);var W00=-(fd2=.5*(f=TX0-B01))*(fm1=f-1)*fm1,W01=(((ft3=3*f)-2)*fd2-1)*fm1,W02=-((ft3-4)*f-1)*fd2,W03=f*fd2*fm1,B11=0|TX1,B10=B11-1;B10<0&&(B10=0);var B12=B11+1,B13=B11+2;B12>minusdim1?(B12=minusdim1,B13=minusdim1):B13>minusdim1&&(B13=minusdim1);var W10=-(fd2=.5*(f=TX1-B11))*(fm1=f-1)*fm1,W11=(((ft3=3*f)-2)*fd2-1)*fm1,W12=-((ft3-4)*f-1)*fd2,W13=f*fd2*fm1,B21=0|TX2,B20=B21-1;B20<0&&(B20=0);var B22=B21+1,B23=B21+2;B22>minusdim2?(B22=minusdim2,B23=minusdim2):B23>minusdim2&&(B23=minusdim2);var W20=-(fd2=.5*(f=TX2-B21))*(fm1=f-1)*fm1,W21=(((ft3=3*f)-2)*fd2-1)*fm1,W22=-((ft3-4)*f-1)*fd2,W23=f*fd2*fm1;return B10*=cache.dim0,B11*=cache.dim0,B12*=cache.dim0,B13*=cache.dim0,B20=B20*cache.slicesize+cache.offset,B21=B21*cache.slicesize+cache.offset,B22=B22*cache.slicesize+cache.offset,B23=B23*cache.slicesize+cache.offset,W20*W10*W00*data[B20+B10+B00]+W20*W10*W01*data[B20+B10+B01]+W20*W10*W02*data[B20+B10+B02]+W20*W10*W03*data[B20+B10+B03]+W20*W11*W00*data[B20+B11+B00]+W20*W11*W01*data[B20+B11+B01]+W20*W11*W02*data[B20+B11+B02]+W20*W11*W03*data[B20+B11+B03]+W20*W12*W00*data[B20+B12+B00]+W20*W12*W01*data[B20+B12+B01]+W20*W12*W02*data[B20+B12+B02]+W20*W12*W03*data[B20+B12+B03]+W20*W13*W00*data[B20+B13+B00]+W20*W13*W01*data[B20+B13+B01]+W20*W13*W02*data[B20+B13+B02]+W20*W13*W03*data[B20+B13+B03]+W21*W10*W00*data[B21+B10+B00]+W21*W10*W01*data[B21+B10+B01]+W21*W10*W02*data[B21+B10+B02]+W21*W10*W03*data[B21+B10+B03]+W21*W11*W00*data[B21+B11+B00]+W21*W11*W01*data[B21+B11+B01]+W21*W11*W02*data[B21+B11+B02]+W21*W11*W03*data[B21+B11+B03]+W21*W12*W00*data[B21+B12+B00]+W21*W12*W01*data[B21+B12+B01]+W21*W12*W02*data[B21+B12+B02]+W21*W12*W03*data[B21+B12+B03]+W21*W13*W00*data[B21+B13+B00]+W21*W13*W01*data[B21+B13+B01]+W21*W13*W02*data[B21+B13+B02]+W21*W13*W03*data[B21+B13+B03]+W22*W10*W00*data[B22+B10+B00]+W22*W10*W01*data[B22+B10+B01]+W22*W10*W02*data[B22+B10+B02]+W22*W10*W03*data[B22+B10+B03]+W22*W11*W00*data[B22+B11+B00]+W22*W11*W01*data[B22+B11+B01]+W22*W11*W02*data[B22+B11+B02]+W22*W11*W03*data[B22+B11+B03]+W22*W12*W00*data[B22+B12+B00]+W22*W12*W01*data[B22+B12+B01]+W22*W12*W02*data[B22+B12+B02]+W22*W12*W03*data[B22+B12+B03]+W22*W13*W00*data[B22+B13+B00]+W22*W13*W01*data[B22+B13+B01]+W22*W13*W02*data[B22+B13+B02]+W22*W13*W03*data[B22+B13+B03]+W23*W10*W00*data[B23+B10+B00]+W23*W10*W01*data[B23+B10+B01]+W23*W10*W02*data[B23+B10+B02]+W23*W10*W03*data[B23+B10+B03]+W23*W11*W00*data[B23+B11+B00]+W23*W11*W01*data[B23+B11+B01]+W23*W11*W02*data[B23+B11+B02]+W23*W11*W03*data[B23+B11+B03]+W23*W12*W00*data[B23+B12+B00]+W23*W12*W01*data[B23+B12+B01]+W23*W12*W02*data[B23+B12+B02]+W23*W12*W03*data[B23+B12+B03]+W23*W13*W00*data[B23+B13+B00]+W23*W13*W01*data[B23+B13+B01]+W23*W13*W02*data[B23+B13+B02]+W23*W13*W03*data[B23+B13+B03]},resliceImage=function(input,output,transformation,interpolation,bounds){bounds=bounds||null,transformation=transformation||null,0!==interpolation&&(interpolation=interpolation||1);var dim=input.getDimensions(),spa=input.getSpacing(),newdim=output.getDimensions(),newslicesize=newdim[0]*newdim[1],newvolsize=newdim[0]*newdim[1]*newdim[2],newspa=output.getSpacing(),input_data=input.getImageData(),output_data=output.getImageData(),maxdvox=[dim[0]-1,dim[1]-1,dim[2]-1],volsize=dim[0]*dim[1]*dim[2],cache={TX:[0,0,0],slicesize:dim[0]*dim[1],input_data:input_data,dim0:dim[0],minusdim:[dim[0]-1,dim[1]-1,dim[2]-1],offset:0};null===bounds&&(bounds=[0,newdim[0]-1,0,newdim[1]-1,0,newdim[2]-1]);var interpolateFunction=linearInterpolationFunction;dim[2]<2&&(interpolateFunction=linearInterpolationFunction2D),dim[3]>1&&(interpolateFunction=linearInterpolationFunction4D),3===interpolation&&(interpolateFunction=cubicInterpolationFunction),0===interpolation&&(interpolateFunction=nearestInterpolationFunction),transformation.optimize(spa);var i,j,k,outbase,frame,X=[0,0,0],outindex=0;if(dim[3]>1)for(k=bounds[4];k<=bounds[5];k++)for(X[2]=k*newspa[2],outbase=k*newslicesize+bounds[0],j=bounds[2];j<=bounds[3];j++)for(X[1]=j*newspa[1],outindex=j*newdim[0]+outbase,i=bounds[0];i<=bounds[1];i++){if(X[0]=i*newspa[0],transformation.transformPointToVoxel(X,cache.TX,spa),cache.TX[2]>=0&&cache.TX[2]<maxdvox[2]&&cache.TX[1]>=0&&cache.TX[1]<maxdvox[1]&&cache.TX[0]>=0&&cache.TX[0]<maxdvox[0])for(frame=0;frame<dim[3];frame++)cache.offset=volsize*frame,output_data[outindex+frame*newvolsize]=interpolateFunction(cache);else if(cache.TX[2]>=0&&cache.TX[2]<=maxdvox[2]&&cache.TX[1]>=0&&cache.TX[1]<=maxdvox[1]&&cache.TX[0]>=0&&cache.TX[0]<=maxdvox[0])for(cache.TX[0]===maxdvox[0]&&(cache.TX[0]=cache.TX[0]-1e-5),cache.TX[1]===maxdvox[1]&&(cache.TX[1]=cache.TX[1]-1e-5),cache.TX[2]===maxdvox[2]&&(cache.TX[2]=cache.TX[2]-1e-5),frame=0;frame<dim[3];frame++)cache.offset=volsize*frame,output_data[outindex+frame*newvolsize]=interpolateFunction(cache);else for(frame=0;frame<dim[3];frame++)output_data[outindex+frame*newvolsize]=0;outindex++}else for(k=bounds[4];k<=bounds[5];k++)for(X[2]=k*newspa[2],outbase=k*newslicesize+bounds[0],j=bounds[2];j<=bounds[3];j++)for(X[1]=j*newspa[1],outindex=j*newdim[0]+outbase,i=bounds[0];i<=bounds[1];i++)X[0]=i*newspa[0],transformation.transformPointToVoxel(X,cache.TX,spa),cache.TX[2]>=0&&cache.TX[2]<maxdvox[2]&&cache.TX[1]>=0&&cache.TX[1]<maxdvox[1]&&cache.TX[0]>=0&&cache.TX[0]<maxdvox[0]?output_data[outindex]=interpolateFunction(cache):cache.TX[2]>=0&&cache.TX[2]<=maxdvox[2]&&cache.TX[1]>=0&&cache.TX[1]<=maxdvox[1]&&cache.TX[0]>=0&&cache.TX[0]<=maxdvox[0]?(cache.TX[0]===maxdvox[0]&&(cache.TX[0]=cache.TX[0]-1e-5),cache.TX[1]===maxdvox[1]&&(cache.TX[1]=cache.TX[1]-1e-5),cache.TX[2]===maxdvox[2]&&(cache.TX[2]=cache.TX[2]-1e-5),output_data[outindex]=interpolateFunction(cache)):output_data[outindex]=0,outindex++},arrayRobustRange=function(arr,perlow,perhigh){0!==perlow&&(perlow=util.range(perlow||.01,0,.999)),perhigh=util.range(perhigh||.99,perlow+.001,1);var min=arr[0],max=arr[0],i=0,total=arr.length;for(i=0;i<arr.length;i+=1)min>arr[i]?min=arr[i]:max<arr[i]&&(max=arr[i]);if(0===perlow&&1===perhigh)return[min,max];var diff=max-min;diff<.001&&(diff=.001);var scale=255/diff,bins=new Uint32Array(256);for(i=0;i<arr.length;i+=1)bins[Math.floor(scale*(arr[i]-min))]+=1;var foundperlow=!1,foundperhigh=!1,tlow=min,thigh=max,cumulative=0;for(i=0;i<256;i++){var v=(cumulative+=bins[i])/total;!1===foundperlow&&v>perlow&&(foundperlow=!0,tlow=i/scale+min),!1===foundperhigh&&v>perhigh&&(foundperhigh=!0,thigh=i/scale+min,i=256)}return[tlow,thigh]},arrayNormalize=function(arr,newarr,tlow,thigh,newmaxvalue){for(var scale=(newmaxvalue=newmaxvalue||64)/(thigh-tlow),newthigh=thigh-tlow,i=0;i<newarr.length;i++){var v=arr[i]-tlow+0;v>newthigh?v=newthigh:v<0&&(v=0),newarr[i]=Math.floor(v*scale+.5)}},inPlaceComputeDisplacementField=function(output,transformation,bounds){var dim=output.getDimensions();if(3!==dim[3])throw new Error("Need a displacement field here, 3 components!");var i,j,k,ia,spa=output.getSpacing(),X=[0,0,0],U=[0,0,0],outindex=0,volsize=dim[0]*dim[1]*dim[2],slicesize=dim[0]*dim[1],data=output.getImageData();for(k=(bounds=bounds||[0,dim[0]-1,0,dim[1]-1,0,dim[2]-1])[4];k<=bounds[5];k++)for(X[2]=k*spa[2],j=bounds[2];j<=bounds[3];j++)for(outindex=bounds[0]+j*dim[0]+k*slicesize,X[1]=j*spa[1],i=bounds[0];i<=bounds[1];i++){for(X[0]=i*spa[0],transformation.computeDisplacement(X,U),ia=0;ia<=2;ia++)data[outindex+ia*volsize]=U[ia];outindex++}};const algo={smoothImage:function(input,sigmas,inmm,radiusfactor,outdata){sigmas=sigmas||[1,1,1],inmm=inmm||!1,radiusfactor=radiusfactor||1.5,outdata=outdata||{};let output=new BisWebImage,temp=new BisWebImage;output.cloneImage(input,{type:"float"}),temp.cloneImage(input,{type:"float"});var input_data=input.getImageData(),output_data=output.getImageData(),temp_data=temp.getImageData(),dim=input.getDimensions(),spa=input.getSpacing(),len=input_data.length,stdev=sigmas;inmm&&(stdev=[sigmas[0]/spa[0],sigmas[1]/spa[1],sigmas[2]/spa[2]]);for(var radii=[1,1,1],i=0;i<=2;i++)radii[i]=Math.floor(stdev[i]*radiusfactor),radii[i]<1&&(radii[i]=1);outdata.sigmas=stdev;var kernelx=generateKernel(stdev[0],radii[0]),kernely=generateKernel(stdev[1],radii[1]),kernelz=generateKernel(stdev[2],radii[2]);if(oneDConvolution(input_data,temp_data,dim,kernelx,radii[0],0),oneDConvolution(temp_data,output_data,dim,kernely,radii[1],1),dim[2]>1){for(var j=0;j<len;j++)temp_data[j]=output_data[j];oneDConvolution(temp_data,output_data,dim,kernelz,radii[2],2)}else console.log("2d smoothing ...");return output},resampleImage:function(input,newspa,interpolation){for(var dim=input.getDimensions(),spa=input.getSpacing(),newdim=[0,0,0,dim[3]],ia=0;ia<=2;ia++){var sz=(dim[ia]-1)*spa[ia];newdim[ia]=Math.floor(sz/newspa[ia])+1}var output=new BisWebImage;return output.cloneImage(input,{dimensions:newdim,spacing:newspa}),resliceImage(input,output,transformationFactory.createLinearTransformation(),interpolation),output},resliceImage:resliceImage,generateKernel:generateKernel,arrayRobustRange:arrayRobustRange,arrayNormalize:arrayNormalize,imageNormalize:function(input,perlow,perhigh,newmaxvalue,outdata){outdata=outdata||{},(newmaxvalue=newmaxvalue||1024)>16384&&(newmaxvalue=16384);var output=new BisWebImage;output.cloneImage(input,{type:"short"});var input_data=input.getImageData(),output_data=output.getImageData();return outdata.range=arrayRobustRange(input_data,perlow,perhigh),arrayNormalize(input_data,output_data,outdata.range[0],outdata.range[1],newmaxvalue),output},imageExtractFrame:function(input,frame){var output=new BisWebImage;output.cloneImage(input,{numframes:1});var dim=input.getDimensions();frame=util.range(frame||0,0,dim[3]);for(var volsize=dim[0]*dim[1]*dim[2],offset=frame*volsize,input_data=input.getImageData(),output_data=output.getImageData(),i=0;i<volsize;i++)output_data[i]=input_data[i+offset];return output},computeDisplacementField:function(reference,transformation){var output=new BisWebImage;return output.cloneImage(reference,{type:"float",numframes:3}),inPlaceComputeDisplacementField(output,transformation),output},inPlaceComputeDisplacementField:inPlaceComputeDisplacementField,computeCC:function(input1,input2){return util.computeCC(input1,input2)},computeImageSSD:function(image1,image2,bounds,debug){var i,j,k,frame,index,dim=image1.getDimensions(),dim2=image2.getDimensions(),sum=0,frameoffset=0,koffset=0;for(i=0;i<=3;i++)sum+=Math.abs(dim[i]-dim2[i]);if(sum>0)throw new Error("Bad dimensions for computing image SSD"+dim+","+dim2);var volsize=dim[0]*dim[1]*dim[2],slicesize=dim[0]*dim[1],data1=image1.getImageData(),data2=image2.getImageData();for(bounds=bounds||[0,dim[0]-1,0,dim[1]-1,0,dim[2]-1],sum=0,frame=0;frame<dim[3];frame++){for(k=bounds[4];k<=bounds[5];k++)for(koffset=k*slicesize+frameoffset,j=bounds[2];j<=bounds[3];j++)for(index=bounds[0]+j*dim[0]+koffset,i=bounds[0];i<=bounds[1];i++)sum+=Math.pow(data1[index]-data2[index],2);frameoffset+=volsize}var np=(bounds[5]-bounds[4]+1)*(bounds[3]-bounds[2]+1)*(bounds[1]-bounds[0]+1),v=Math.sqrt(sum/np);return debug&&console.log("np=",np,"sum=",sum.toFixed(3),"v=",v.toFixed(4),bounds,dim),v},computeDisplacementFieldRoundTripError:function(forward,reverse,bounds,debug){var i,j,k,axis,index,dim=forward.getDimensions(),reverse_dim=reverse.getDimensions(),sum=0,error=0,koffset=0,X=[0,0,0],Y=[0,0,0],numgood=0;if(3!==dim[3]||3!==reverse_dim[3])throw new Error("Bad dimensions for computing round trip error SSD"+dim+", "+reverse_dim);var cache={TX:[0,0,0],dim0:reverse_dim[0],slicesize:reverse_dim[0]*reverse_dim[1],volsize:reverse_dim[0]*reverse_dim[1]*reverse_dim[2],input_data:reverse.getImageData(),minusdim:[reverse_dim[0]-1,reverse_dim[1]-1,reverse_dim[2]-1],offset:0},maxdvox=[reverse_dim[0]-1,reverse_dim[1]-1,reverse_dim[2]-1],reverse_spa=reverse.getSpacing(),volsize=dim[0]*dim[1]*dim[2],slicesize=dim[0]*dim[1],spa=forward.getSpacing(),indata=forward.getImageData();for(error=0,k=(bounds=bounds||[0,dim[0]-1,0,dim[1]-1,0,dim[2]-1])[4];k<=bounds[5];k++)for(koffset=k*slicesize,X[2]=k*spa[2],j=bounds[2];j<=bounds[3];j++)for(index=bounds[0]+j*dim[0]+koffset,X[1]=j*spa[1],i=bounds[0];i<=bounds[1];i++){for(X[0]=i*spa[0],axis=0;axis<=2;axis++){var disp=indata[index+axis*volsize];Y[axis]=disp+X[axis],cache.TX[axis]=Y[axis]/reverse_spa[axis],10===k&&11===j&&12===i&&!0===debug&&console.log("ijk=",[i,j,k],axis,"X=",X[axis].toFixed(2),"--\x3e disp="+disp.toFixed(2)+"-> Y"+Y[axis].toFixed(2)+" TX=",cache.TX[axis].toFixed(2))}if(cache.TX[2]>=0&&cache.TX[2]<maxdvox[2]&&cache.TX[1]>=0&&cache.TX[1]<maxdvox[1]&&cache.TX[0]>=0&&cache.TX[0]<maxdvox[0]){for(sum=0,numgood++,axis=0;axis<=2;axis++){cache.offset=cache.volsize*axis;var d=linearInterpolationFunction4D(cache);sum+=Math.pow(Y[axis]-d-X[axis],2)}error+=sum}index++}var v=Math.sqrt(error/numgood);return debug&&console.log("np=",numgood,"error=",error.toFixed(3),"v=",v.toFixed(4),bounds,dim,"numgood=",numgood),v}};module.exports=algo},"./js/legacy/bis_mni2tal.js":function(module,exports,__webpack_require__){"use strict";const bismni2tal={MNI:[90,126,72],DIMENSIONS:[181,217,181],MNIMIN:[-90,-108,-72],MNIMAX:[90,90,108],MNIFLIP:[!1,!1,!1],convertMNIToSlice:function(plane,value){var a=Math.round(value);return bismni2tal.MNIFLIP[plane]&&(a=-value),a+bismni2tal.MNI[plane]},convertSliceToMNI:function(plane,value){var mni=Math.round(value)-bismni2tal.MNI[plane];return bismni2tal.MNIFLIP[plane]&&(mni=-mni),mni}};module.exports=function(){return{getMNICoordinates:function(mm){for(var mni=[0,0,0],i=0;i<=2;i++)mni[i]=bismni2tal.convertSliceToMNI(i,mm[i]);return mni},getMMCoordinates:function(mni){for(var mm=[0,0,0],i=0;i<=2;i++)mm[i]=bismni2tal.convertMNIToSlice(i,mni[i]);return mm}}}},"./js/legacy/bis_parcellation.js":function(module,exports,__webpack_require__){"use strict";const util=__webpack_require__("./js/core/bis_util.js");let webutil=null;try{webutil=__webpack_require__("./js/coreweb/bis_webutil.js")}catch(e){console.log(".... running in commandline probably a regression test as I can not load bis_webutil.")}const computemode=function(array,debug){if(debug=debug||!1,0===array.length)return null;for(var modeMap={},maxEl=array[0],maxCount=1,i=0;i<array.length;i++){var el=array[i];void 0===modeMap[el]?modeMap[el]=1:modeMap[el]++,modeMap[el]>maxCount&&(maxEl=el,maxCount=modeMap[el])}return debug&&console.log(modeMap),maxEl},comparerois=function(a,b){let computeroivalue=function(r){let sum=.001*r.index;for(let i=0;i<r.attr.length;i++)sum+=r.attr[i]*Math.pow(1e3,r.attr.length-i);return sum};var a1=computeroivalue(a),b1=computeroivalue(b);return a1<b1?-1:a1>b1?1:0};module.exports=class{constructor(){this.initialized=!1,this.regions=null,this.normallength=70,this.linethickness=1,this.scalefactor=1,this.radius=1,this.offset=80,this.thickness=20,this.points=[],this.midlobe=11,this.maxlobe=-1,this.midpoint=-1,this.maxpoint=-1,this.actualnoderadius=1,this.viewport={x0:0,y0:0,x1:.99,y1:.71},this.rois=[],this.lobeStats=[],this.indexmap={},this.description="",this.box=[0,0,100,100]}getCanvasBounds(context){var ch=context.canvas.height,cw=context.canvas.width,width=Math.floor((this.viewport.x1-this.viewport.x0)*cw),height=Math.floor((this.viewport.y1-this.viewport.y0)*ch),cnv={width:width},fnsize=webutil.getfontsize(cnv),internal_radius=150,internal_offset=50,internal_thickness=20,internal_paddingx=130,internal_paddingy=3*fnsize,maxw=2*(internal_radius+2.5*internal_thickness+internal_paddingx)+internal_offset,maxh=2*(internal_radius+2.5*internal_thickness),padh=internal_paddingy+3*fnsize;if(height<padh)return this.box[0]=0,this.box[1]=0,this.box[2]=0,this.box[3]=0,console.log("height is too small"),[0,0,0,0,0,0];var sx=width/maxw,sy=(height-padh)/maxh,scalefactor=sy,leftoverx=0,leftovery=0;sx<sy?leftovery=((height-padh)/(scalefactor=sx)-maxh)*scalefactor:leftoverx=(width/(scalefactor=sy)-maxw)*scalefactor,this.radius=scalefactor*internal_radius;var paddingx=scalefactor*internal_paddingx+.5*leftoverx,paddingy=internal_paddingy+.5*leftovery;return this.thickness=scalefactor*internal_thickness,this.offset=scalefactor*internal_offset,this.scalefactor=scalefactor,this.box[0]=this.viewport.x0*cw+paddingx,this.box[1]=this.viewport.y0*ch+paddingy,this.box[2]=this.box[0]+(2*this.radius+this.offset+5*this.thickness),this.box[3]=this.box[1]+(2*this.radius+5*this.thickness),[cw*this.viewport.x0,ch*this.viewport.y0,cw*(this.viewport.x1-this.viewport.x0),ch*(this.viewport.y1-this.viewport.y0)]}parsejson(jsonstring,filename,doerror){var obj;try{obj=JSON.parse(jsonstring)}catch(e){return doerror(filename+" is not a valid JSON File --pick something with a .json extension"),0}if("Parcellation"!==obj.bisformat)return doerror("Bad JSON File "+filename+' element bisformat does not equal "Parcellation"'),!1;var i,j,numpoints=obj.numpoints,numattr=obj.numattr;for(this.description=obj.description,console.log("++++ Parcellation created from jsonfile:"+filename+", points="+numpoints+" attr="+numattr+" description="+this.description),this.rois=new Array(numpoints),i=0;i<numpoints;i++){var elem=obj.rois[i],index=i,attr=[];for(j=0;j<numattr;j++)attr[j]=elem.attr[j];this.rois[i]={x:elem.x,y:elem.y,z:elem.z,index:Number(index),attr:attr,cx:0,cy:0,nx:0,ny:1,angle:0}}return numpoints}parsetext(inpstring,filename,doerror){var lines=inpstring.split("\n");if("#MapFile"!==lines[0].trim())return doerror(filename+" is not a valid node definition file"),0;var i,j,numpoints=parseInt(lines[1].trim().split(" ")[0]),numattr=parseInt(lines[2].trim().split(" ")[0]),n=lines.length;if(n-numpoints<4)return doerror(filename+" file is too short"),0;for(this.rois=new Array(numpoints),i=0;i<numpoints;i++){var l2=lines[i+4].split(" "),index=i,attr=[];for(j=0;j<numattr;j++)attr[j]=Number(l2[3+j]);this.rois[i]={x:Number(l2[0]),y:Number(l2[1]),z:Number(l2[2]),index:Number(index),attr:attr,cx:0,cy:0,nx:0,ny:1,angle:0}}var testline=5+numpoints;return this.description=testline<n?lines[testline]:"unknown",console.log("++++ Node definition created from textfile:"+filename+", points="+numpoints+" attr="+numattr+" description="+this.description),numpoints}loadrois(jsonstring,filename,doerror){var numpoints=0;return 0===(numpoints="txt"==filename.split(".").pop()?this.parsetext(jsonstring,filename,doerror):this.parsejson(jsonstring,filename,doerror))?0:(this.createLobeStats(),numpoints)}createLobeStats(){if(this.rois.length<2)return console.log("--- bad rois cannot createLobeStats"),0;var i,numpoints=this.rois.length;for(this.rois.sort(comparerois),this.indexmap={},i=0;i<numpoints;i++){var idx=this.rois[i].index;this.indexmap[idx]=i}console.log("++++ Node definition mapping to lobes: Number of rois="+this.rois.length);var maxv=this.rois[0].attr[0];for(i=1;i<this.rois.length;i++){var a=this.rois[i].attr[0];a>maxv&&(maxv=a)}var numrows=maxv+1;for(this.lobeStats=new Array(numrows),i=0;i<numrows;i++)this.lobeStats[i]=[-1,-1,-1];for(i=0;i<this.rois.length;i++){var lb=this.rois[i].attr[0];this.lobeStats[lb][0]<0?(this.lobeStats[lb][0]=i,this.lobeStats[lb][1]=i):(this.lobeStats[lb][0]>i&&(this.lobeStats[lb][0]=i),this.lobeStats[lb][1]<i&&(this.lobeStats[lb][1]=i))}for(i=0;i<this.lobeStats.length;i++)this.lobeStats[i][0]>-1&&(this.lobeStats[i][2]=this.lobeStats[i][1]-this.lobeStats[i][0]+1);this.midlobe=11,this.midpoint=this.lobeStats[this.midlobe-1][1];for(var count=2;-1==this.midpoint&&this.midlobe-count>0;)this.midpoint=this.lobeStats[this.midlobe-count][1],count++;this.maxpoint=this.lobeStats[this.lobeStats.length-1][1]}getCenterLocation(index){var shiftx=-.5*this.offset;return index>this.midpoint&&(shiftx=.5*this.offset),[.5*(this.box[0]+this.box[2])+shiftx,.5*(this.box[1]+this.box[3])]}getPointLocationAndNormal(index){var angle=0,rad=(angle=index<=this.midpoint?270+index/this.midpoint*180:270-(index-(this.midpoint+1))/(this.maxpoint-(this.midpoint+1))*180)*Math.PI/180,x=this.radius*-Math.cos(rad),y=this.radius*Math.sin(rad),cent=this.getCenterLocation(index),n1=x,n2=y;x+=cent[0],y+=cent[1];var m=Math.sqrt(n1*n1+n2*n2);return n2/=m,n1/=m,angle>360&&(angle-=360),[x,y,n1,n2,angle]}getNonSidedLobeColor(lobe){lobe>=this.midlobe&&(lobe=lobe-this.midlobe+1);var c=util.objectmapcolormap[lobe];return"rgb("+Math.floor(c[0])+","+Math.floor(c[1])+","+Math.floor(c[2])+")"}getInverseNonSidedLobeColor(lobe){return lobe>=this.midlobe&&(lobe=lobe-this.midlobe+1),1===lobe||5===lobe||8===lobe||10===lobe?"#ffffff":"#000000"}clearCanvas(context){var bd=this.getCanvasBounds(context);return context.save(),context.fillStyle="#ffffff",context.fillRect(bd[0],bd[1],bd[2],bd[3]),context.restore(),bd}drawCircles(context){if(this.box[0]>=this.box[2])console.log("draw circles, bad box"+this.box[0]+" "+this.box[2]);else{this.clearCanvas(context);var lb,s,maxlb=this.lobeStats.length;for(context.save(),context.lineWidth=this.thickness,lb=1;lb<maxlb;lb++){var minp=this.lobeStats[lb][0],maxp=this.lobeStats[lb][1];if(minp>-1){var angle1=0,angle2=0,cx=this.getCenterLocation(minp);minp<=this.midpoint?(angle1=270-(maxp+.5)/this.midpoint*180,angle2=270-(minp-.5)/this.midpoint*180):(angle1=270+(minp-(this.midpoint+1)-.5)/(this.maxpoint-(this.midpoint+1))*180,angle2=270+(maxp-(this.midpoint+1)+.5)/(this.maxpoint-(this.midpoint+1))*180),angle1=angle1*Math.PI/180,angle2=angle2*Math.PI/180;var lobeindex=this.rois[minp].attr[0];s=this.getNonSidedLobeColor(lobeindex),context.strokeStyle=s,context.beginPath(),context.arc(cx[0],cx[1],this.radius+1.5*this.thickness,angle1,angle2,!1),context.stroke()}}var th=3.1415*this.radius/(.75*(this.maxpoint+1))*.5;this.actualnoderadius=th;for(var i=0;i<=this.maxpoint;i++){var x=this.getPointLocationAndNormal(i);s=this.getNonSidedLobeColor(this.rois[i].attr[0]),this.rois[i].cx=x[0],this.rois[i].cy=x[1],this.rois[i].nx=x[2],this.rois[i].ny=x[3],this.rois[i].angle=x[4],context.fillStyle=s,context.beginPath(),context.arc(x[0],x[1],th,2*Math.PI,!1),context.fill(),context.closePath()}this.drawNumbers(context),context.strokeStyle="#cccccc",context.lineWidth=1;var ch=context.canvas.height,cw=context.canvas.width;context.beginPath(),context.moveTo(this.viewport.x0*cw,this.viewport.y0*ch),context.lineTo(this.viewport.x0*cw,this.viewport.y1*ch),context.lineTo(this.viewport.x1*cw,this.viewport.y1*ch),context.lineTo(this.viewport.x1*cw,this.viewport.y0*ch),context.lineTo(this.viewport.x0*cw,this.viewport.y0*ch),context.stroke(),context.restore()}}drawLines(context){context.save(),context.lineWidth=this.linethickness;var midlobe=Math.floor((this.lobeStats.length+1)/2),midpoint=this.lobeStats[midlobe-1][1];-1===midpoint&&(midpoint=this.lobeStats[midlobe-2][1]);var nextlobe,maxlb=this.lobeStats.length,node=Math.floor(.5*(this.lobeStats[1][1]-this.lobeStats[1][0])),x1=this.rois[node].cx,y1=this.rois[node].cy,n1=this.rois[node].nx,n2=this.rois[node].ny,XX=[x1-this.normallength*n1,y1-this.normallength*n2];for(nextlobe=2;nextlobe<maxlb;nextlobe++){var s="rgb(255,0,0)";nextlobe%2==1&&(s="rgb(0,0,255)");var othernode=this.lobeStats[nextlobe][0],x4=this.rois[othernode].cx,y4=this.rois[othernode].cy,n3=this.rois[othernode].nx,n4=this.rois[othernode].ny,YY=[x4-this.normallength*n3,y4-this.normallength*n4];context.strokeStyle=s,context.beginPath(),context.moveTo(x1,y1),context.bezierCurveTo(XX[0],XX[1],YY[0],YY[1],x4,y4),context.stroke()}context.lineWidth=1,context.restore()}drawNumbers(context){if(!(this.box[0]<=this.box[2])){var cl=["rgb(64,64,64)","rgb(32,32,32)"],clindex=0,l=0,th=this.thickness;for(context.save(),l=9;l<=this.maxpoint;l+=10){var x=this.rois[l].cx,y=this.rois[l].cy,nx=this.rois[l].nx,ny=this.rois[l].ny,X1=[x+3*this.actualnoderadius*nx,y+3*this.actualnoderadius*ny],X2=[x+2*th*nx,y+2*th*ny];context.strokeStyle=cl[clindex],context.lineWidth=2*this.linethickness,context.beginPath(),context.moveTo(X1[0],X1[1]),context.lineTo(X2[0],X2[1]),context.stroke(),clindex=1-clindex}var cnv={width:(this.viewport.x1-this.viewport.x0)*context.canvas.width||context.canvas.width},fnsize=webutil.getfontsize(cnv),x0=this.box[0],x1=this.box[2],y0=this.box[1],y1=this.box[3],minsize=10*fnsize;if(x1-x0>minsize&&y1-y0>minsize){var sl=["Right","Left"];context.fillStyle=cl[1],context.font=fnsize+"px Arial",context.textAlign="start",context.fillText(sl[0],x0+10,y0+20),context.textAlign="end",context.fillText(sl[1],x1-10,y0+20)}context.lineWidth=1,context.restore()}}findPoint(x,y,context){var cw=context.canvas.width;if(x<this.box[0]||x>this.box[2]||y<this.box[1]||y>this.box[3])return-1;var center,bestpoint=-1,bestdist=1e6,diffangle=180/this.rois.length,midx=.5*cw*(this.viewport.x1+this.viewport.x0),mini=0,maxi=this.midpoint;x<midx?x>(center=this.getCenterLocation(0))[0]&&(x=center[0]):(x<(center=this.getCenterLocation(this.rois.length-1))[0]&&(x=center[0]),mini=this.midpoint+1,maxi=this.rois.length-1);var dy=y-center[1],dx=center[0]-x,newangle=180*Math.atan2(dy,dx)/Math.PI;newangle<0&&(newangle+=360);for(var n=mini;n<=maxi;n++){var angle=this.rois[n].angle;if(Math.abs(angle-newangle)<diffangle){var px=this.rois[n].cx-x,py=this.rois[n].cy-y,d=Math.abs(px*this.rois[n].nx+py*this.rois[n].ny);(d<bestdist||-1===bestpoint)&&(bestpoint=n,bestdist=d)}}return bestdist<.5*midx&&bestpoint>=0?this.rois[bestpoint].index:-1}setViewport(x1,y1,x2,y2){this.viewport={x1:x1,y1:y1,x2:x2,y2:y2}}findMNIPoint(x,y,z,context){context=context||0;var n=0,bestpoint=-1,bestn=-1,bestdist=1e3;for(n=0;n<this.rois.length;n++){var px=this.rois[n].x,py=this.rois[n].y,pz=this.rois[n].z,dist=Math.sqrt(Math.pow(x-px,2)+Math.pow(y-py,2)+Math.pow(z-pz,2));dist<bestdist&&(bestdist=dist,bestn=n)}return bestdist>10?bestn=-1:bestpoint=this.rois[bestn].index,0!==context&&this.drawPoint(bestpoint,context),bestpoint}drawPoint(bestpoint,context){if(!(this.box[0]>=this.box[2])&&this.viewport.x0!==this.viewport.x1){var x0=this.box[0],x1=this.box[2],y0=this.box[1],y1=this.box[3];if(context.save(),context.clearRect(x0,y0,x1-x0,y1-y0),bestpoint>=0){var actual=this.indexmap[bestpoint],cx=this.rois[actual].cx,cy=this.rois[actual].cy,cent=this.getCenterLocation(actual);context.lineWidth=2,context.strokeStyle="#000000",context.beginPath(),context.moveTo(.5*(x0+x1),.5*(y0+y1)),context.bezierCurveTo(.5*cent[0]+.5*cx,.5*cent[1]+.5*cy,cx,cy,cx+2*this.thickness*this.rois[actual].nx,cy+2*this.thickness*this.rois[actual].ny),context.stroke(),context.beginPath(),context.arc(.5*(x0+x1),.5*(y0+y1),3,2*Math.PI,!1),context.stroke(),context.lineWidth=1}context.restore()}}createParcellationFromImage(parcimage,atlas,description){description=description||"unknown";var dim_p=parcimage.getDimensions(),dim_a=atlas.getDimensions(),sum=0,i=0,j=0;for(i=0;i<=2;i++)sum+=Math.abs(dim_p[i]-dim_a[i]);if(0!==sum)throw new Error("---- Cannot create node definition from parcellation image. Image is not RAS 181x217x181 1mm");var dt=parcimage.getDataType();parcimage.computeIntensityRange();var r=parcimage.getIntensityRange();if(r[1]>999||r[0]<0||r[1]<2)throw new Error("Bad Node definition image. It has largest value > 999 (max="+r[1]+") or max value < 2 or min value <0 ( min="+r[0]+")");console.log("++++ Image range ="+r+" data type="+dt);var maxvoi=r[1],volsize=dim_a[0]*dim_a[1]*dim_a[2],numattr=dim_a[3],cx=new Array(maxvoi+1),cy=new Array(maxvoi+1),cz=new Array(maxvoi+1),Nv=new Array(maxvoi+1),attr=new Array(maxvoi+1);for(i=0;i<=maxvoi;i++)for(cx[i]=0,cy[i]=0,cz[i]=0,Nv[i]=0,attr[i]=new Array(numattr),j=0;j<numattr;j++)attr[i][j]=[];var ia,ja,ka,index=0,atlasdata=atlas.getImageData(),roidata=parcimage.getImageData();for(ka=0;ka<dim_a[2];ka++)for(ja=0;ja<dim_a[1];ja++)for(ia=0;ia<dim_a[0];ia++){var roi=Math.round(roidata[index]);if(roi>0&&roi<=maxvoi)for(cx[roi]+=ia,cy[roi]+=ja,cz[roi]+=ka,Nv[roi]+=1,j=0;j<numattr;j++){var fval=Math.round(atlasdata[j*volsize+index]);fval>.5&&attr[roi][j].push(fval)}++index}var numvoi=0,bad=[];for(i=1;i<=maxvoi;i++){if(Nv[i]>0){for(cx[i]/=Nv[i],cy[i]/=Nv[i],cz[i]/=Nv[i],ia=0;ia<numattr;ia++){var v=0;attr[i][ia].length>0?(v=computemode(attr[i][ia]),attr[i][ia]=v):attr[i][ia]=0}numvoi+=1}0===attr[i][0]&&bad.push(i)}for(i=0;i<bad.length;i++){var badnode=bad[i],bestnode=-1,bestdist=0;for(j=1;j<=maxvoi;j++)if(0!==attr[j][0]){var dist=Math.pow(cx[badnode]-cx[j],2)+Math.pow(cy[badnode]-cy[j],2)+Math.pow(cz[badnode]-cz[j],2);(dist<bestdist||-1==bestnode)&&(bestdist=dist,bestnode=j)}if(-1===bestnode)throw new Error("Cannot create node definition, no good nodes.");console.log("+++++ \t\t\t Mapped voi "+badnode+" to lobe "+attr[bestnode][0]+" by using the value from its closest good node ("+bestnode+" dist="+Math.sqrt(bestdist)+")"),attr[badnode][0]=attr[bestnode][0]}var obj={bisformat:"Parcellation"};obj.numpoints=numvoi,obj.numattr=numattr,obj.description=description,obj.rois=[];var MNI=[90,126,72];for(i=1;i<=maxvoi;i++)if(Nv[i]>0){var elem={};for(elem.x=Math.round(100*(cx[i]-MNI[0]))/100,elem.y=Math.round(100*(cy[i]-MNI[1]))/100,elem.z=Math.round(100*(cz[i]-MNI[2]))/100,elem.attr=[],ia=0;ia<numattr;ia++)elem.attr[ia]=attr[i][ia];obj.rois.push(elem)}return JSON.stringify(obj)}creatematrix(){for(var numpoints=this.rois.length,numattr=this.rois[0].attr.length,matrix=util.zero(numpoints,numattr+3),i=0;i<numpoints;i++){var index=this.indexmap[i];matrix[i][0]=this.rois[index].x,matrix[i][1]=this.rois[index].y,matrix[i][2]=this.rois[index].z,matrix[i][3]=this.rois[index].index;for(var j=0;j<numattr;j++)matrix[i][3+j]=this.rois[index].attr[j]}return matrix}serialize(){var numpoints=this.rois.length,numattr=this.rois[0].attr.length,obj={bisformat:"Parcellation"};obj.numpoints=numpoints,obj.numattr=numattr,obj.description=this.description,obj.rois=[];for(var i=0;i<numpoints;i++){var index=this.indexmap[i],elem={};elem.x=this.rois[index].x,elem.y=this.rois[index].y,elem.z=this.rois[index].z,elem.attr=[];for(var ia=0;ia<numattr;ia++)elem.attr[ia]=this.rois[index].attr[ia];obj.rois.push(elem)}return JSON.stringify(obj)}createParcellationFromText(textstring,filename,atlas,description){description=description||"unknown";var i,j,out_lines=null;try{out_lines=util.parseMatrix(textstring,filename,!1,3)}catch(e){throw new Error(e)}console.log("+++++ Loaded Point Matrix from "+filename+" of size ="+out_lines.length+"*3");for(var atlasdata=atlas.getImageData(),dim_a=atlas.getDimensions(),volsize=dim_a[0]*dim_a[1]*dim_a[2],numpoints=out_lines.length,MNI=[90,126,72],bad=[],cx=new Array(numpoints),cy=new Array(numpoints),cz=new Array(numpoints),attr=new Array(numpoints),numattr=dim_a[3],pt=0;pt<out_lines.length;pt++){attr[pt]=new Array(numattr),cx[pt]=parseFloat(out_lines[pt][0]),cy[pt]=parseFloat(out_lines[pt][1]),cz[pt]=parseFloat(out_lines[pt][2]);var x=Math.round(util.range(cx[pt]+MNI[0],1,179)),y=Math.round(util.range(cy[pt]+MNI[1],1,216)),z=Math.round(util.range(cz[pt]+MNI[2],1,179)),index=x+y*dim_a[0]+z*dim_a[0]*dim_a[1];for(j=0;j<numattr;j++){var fval=Math.round(atlasdata[j*volsize+index]);attr[pt][j]=fval>.5?fval:0}0===attr[pt][0]&&bad.push(pt)}for(i=0;i<bad.length;i++){var badnode=bad[i],bestnode=-1,bestdist=0;for(j=0;j<numpoints;j++)if(0!==attr[j][0]){var dist=Math.pow(cx[badnode]-cx[j],2)+Math.pow(cy[badnode]-cy[j],2)+Math.pow(cz[badnode]-cz[j],2);(dist<bestdist||-1==bestnode)&&(bestdist=dist,bestnode=j)}if(-1===bestnode)throw new Error("Cannot create node definition, no good nodes.");console.log("+++++ \t\t\t Mapped voi "+badnode+" to lobe "+attr[bestnode][0]+" by using the value from its closest good node ("+bestnode+" dist="+Math.sqrt(bestdist)+")"),attr[badnode][0]=attr[bestnode][0]}var obj={bisformat:"Parcellation"};for(obj.numpoints=numpoints,obj.numattr=numattr,obj.description=description,obj.rois=[],i=0;i<numpoints;i++){var elem={};elem.x=cx[i],elem.y=cy[i],elem.z=cz[i],elem.attr=[];for(var ia=0;ia<numattr;ia++)elem.attr[ia]=attr[i][ia];obj.rois.push(elem)}return JSON.stringify(obj)}}},"./js/legacy/bis_transformationutil.js":function(module,exports,__webpack_require__){"use strict";const genericio=__webpack_require__("./js/core/bis_genericio.js"),BisWebLinearTransformation=__webpack_require__("./js/dataobjects/bisweb_lineartransformation.js");let BisWebGridTransformation=__webpack_require__("./js/dataobjects/bisweb_gridtransformation.js"),BisWebComboTransformation=__webpack_require__("./js/dataobjects/bisweb_combotransformation.js"),BisWebTransformationCollection=__webpack_require__("./js/dataobjects/bisweb_transformationcollection.js");const bisutil=__webpack_require__("./js/core/bis_util.js"),numeric=__webpack_require__("./node_modules/numeric/numeric-1.2.6.js"),createLinearTransformation=function(md){return new BisWebLinearTransformation(md)},createGridTransformation=function(ii_dims,ii_spacing,ii_origin,ii_nonewfield,ii_linearinterpmode){return new BisWebGridTransformation(ii_dims,ii_spacing,ii_origin,ii_nonewfield,ii_linearinterpmode)},createComboTransformation=function(ii_initial){return new BisWebComboTransformation(ii_initial)};let parseTransformationFromText=function(inpstring,filename){var ext=filename.split(".").pop();let xform=null;if("matr"===ext){return!1===(xform=createLinearTransformation(0)).legacyParseFromText(inpstring,filename)?null:(xform.setFilename(filename),xform)}if("grd"===ext){return!1===(xform=createComboTransformation(null)).legacyParseFromText(inpstring,filename)?null:(xform.setFilename(filename),xform)}let b="";try{b=JSON.parse(inpstring)}catch(e){return console.log(filename+" is not a valid JSON File --pick something with a .json extension"),!1}if("BisLinearTransformation"===b.bisformat){return!1===(xform=createLinearTransformation(0)).parseFromDictionary(b)?null:(xform.setFilename(filename),xform)}if("BisComboTransformation"===b.bisformat){return!1===(xform=createComboTransformation(null)).parseFromDictionary(b)?null:(xform.setFilename(filename),xform)}if("BisGridTransformation"===b.bisformat){return!1===(xform=createGridTransformation()).parseFromDictionary(b)?null:(xform.setFilename(filename),xform)}if("BisTransformationCollection"===b.bisformat){return!1===(xform=new BisWebTransformationCollection).parseFromDictionary(b)?null:(xform.setFilename(filename),xform)}return null};module.exports={createLinearTransformation:createLinearTransformation,createGridTransformation:createGridTransformation,createComboTransformation:createComboTransformation,parseTransformationFromJSON:function(text){var b;try{b=JSON.parse(text)}catch(e){return null}let output=null;return"BisGridTransformation"===b.bisformat?output=createGridTransformation([4,4,4],[2,2,2],[0,0,0],!0):"BisComboTransformation"===b.bisformat?output=createComboTransformation(null):"BisLinearTransformation"===b.bisformat?output=createLinearTransformation(0):"BisTransformationCollection"===b.bisformat&&(output=new BisWebTransformationCollection),null!==output?(output.parseFromDictionary(b),output):null},parseTransformationFromText:parseTransformationFromText,loadTransformation:function(filename){return new Promise(function(resolve,reject){genericio.read(filename,!1).then(contents=>{let xform=parseTransformationFromText(contents.data,contents.filename);xform?(xform.setFilename(contents.filename),console.log("++++\t loaded transformation from "+filename+", "+xform.constructor.name),resolve({data:xform,filename:contents.filename})):reject("Failed to read transformation from the file:"+contents.filename)}).catch(e=>{reject(e)})})},saveTransformation:function(filename,transformation){return transformation.save(filename)},computeHeaderTransformation:function(reference,target,usetranslation=!1){let h=[reference.getHeader(),target.getHeader()],dm=[reference.getDimensions(),target.getDimensions()],sp=[reference.getSpacing(),target.getSpacing()],mat=[null,null],names=["srow_x","srow_y","srow_z"],maxk=2;usetranslation&&(maxk=3);for(let i=0;i<h.length;i++){mat[i]=numeric.identity(4);let tm=numeric.identity(4);for(let j=0;j<names.length;j++){let row=h[i].struct[names[j]];for(let k=0;k<=maxk;k++)tm[j][k]=row[k]}let s=numeric.identity(4);for(let j=0;j<=2;j++)s[j][j]=1/sp[i][j];mat[i]=numeric.dot(tm,s)}let transform=new BisWebLinearTransformation,comb=numeric.dot(numeric.inv(mat[1]),mat[0]);if(usetranslation)return transform.setMatrix(comb),transform;let center=[bisutil.zero(4,1),bisutil.zero(4,1)];for(let i=0;i<=1;i++)for(let j=0;j<=2;j++)center[i][j]=.5*(dm[i][j]-1)*sp[i][j];let shift=numeric.dot(comb,center[0]),newmat=numeric.identity(4);for(let i=0;i<=2;i++)newmat[i][3]=center[1][i]-shift[i];let finalcombo=numeric.dot(newmat,comb);return transform.setMatrix(finalcombo),console.log("oooo Using Header, I created an initial transformation = ",transform.getDescription()),transform},computeCombinedTransformation:function(regxform,headerxform){let m1=headerxform.getMatrix(),m2=regxform.getMatrix(),m3=numeric.dot(m1,m2),output=new BisWebLinearTransformation;return output.setMatrix(m3),console.log("oooo Post combining matrix with header adjustment"),output},isTransformIdentityOrNULL:function(xform){if(!xform)return console.log("oooo no initial transformation"),!0;try{let comb=xform.getMatrix(),ident=numeric.identity(4);if(numeric.norm2(numeric.sub(comb,ident))<.01)return!0}catch(e){console.log("oooo not a linear transformation",e,e.stack)}return!1}}},"./js/modules/approximateField.js":function(module,exports,__webpack_require__){"use strict";const biswrap=__webpack_require__("./build/wasm/libbiswasm_wrapper.js"),BaseModule=__webpack_require__("./js/modules/basemodule.js"),baseutils=__webpack_require__("./js/modules/baseutils.js");module.exports=class extends BaseModule{constructor(){super(),this.name="approximateField",this.useworker=!0}createDescription(){let des={name:"Approximate Displacement Field",description:"Calculates the displacement field for a given transformation for a given image.",author:"Zach Saltzman",version:"1.0",inputs:baseutils.getImageToImageInputs("Load the displacement field image to approximate"),buttonName:"Execute",shortname:"apprx",params:[{name:"Smoothness",description:"Extra regularization smoothness term weight",priority:12,advanced:!1,gui:"slider",type:"float",varname:"lambda",default:.1,low:0,high:1},{name:"Tolerance",description:"Fitting to tolerance",priority:5,advanced:!1,gui:"slider",type:"float",varname:"tolerance",default:.001},{name:"Window Size",description:"Fitting quality",priority:7,advanced:!1,gui:"slider",type:"float",varname:"windowsize",low:1,high:2,default:2},{name:"Inverse",description:"if true approximate inverse displacement field",priority:10,advanced:!1,gui:"check",type:"boolean",varname:"inverse",default:!1},{name:"Spacing",description:"The control point spacing of the output grid transform",priority:2,advanced:!1,gui:"slider",type:"float",varname:"spacing",low:2,high:50,default:25}]};return des.params=des.params.concat(baseutils.getOptParams({stepsize:.5,steps:1,iterations:20,levels:2,resolution:2})),des.outputs=[{type:"transform",name:"Output Grid Transformation",description:"Stores the fitted transformation to the input displacement field",varname:"output",required:!0,shortname:"o"}],des}directInvokeAlgorithm(vals){console.log("oooo invoking: approximateField",JSON.stringify(vals));let inputImg=this.inputs.input;return new Promise((resolve,reject)=>{biswrap.initialize().then(()=>{this.outputs.output=biswrap.approximateDisplacementFieldWASM2(inputImg,{spacing:parseFloat(vals.spacing),steps:parseInt(vals.steps),stepsize:parseFloat(vals.stepsize),lambda:parseFloat(vals.lambda),iterations:parseInt(vals.iterations),tolerance:parseFloat(vals.tolerance),optimization:baseutils.getOptimizationCode(vals.optimization),windowsize:parseFloat(vals.windowsize),levels:parseInt(vals.levels),resolution:parseFloat(vals.resolution),inverse:super.parseBoolean(vals.inverse)},vals.debug),resolve()}).catch(e=>{reject(e.stack)})})}}},"./js/modules/backProjectImage.js":function(module,exports,__webpack_require__){"use strict";const biswrap=__webpack_require__("./build/wasm/libbiswasm_wrapper.js"),baseutils=__webpack_require__("./js/modules/baseutils.js"),BaseModule=__webpack_require__("./js/modules/basemodule.js");module.exports=class extends BaseModule{constructor(){super(),this.name="backProjectImage",this.JSOnly=!0}createDescription(){return{name:"BackProject 2D->3D",description:"This algorithm performes back projecting from 2D to 3D",author:"Xenios Papademetris",version:"1.0",buttonName:"BackProject",shortname:"bprj",inputs:[{type:"image",name:"Input 2D",description:"The image to be back-projected",varname:"input",shortname:"i",required:!0,guiviewertype:"image",guiviewer:"viewer1"},{type:"image",name:"Target 3D",description:"The image to backproject to",varname:"target",shortname:"t",required:!0,guiviewertype:"image",guiviewer:"viewer2"},{type:"transformation",name:"Reslice Transform",description:"The transformation to reslice the 2d image before backprojecting",varname:"xform",shortname:"x",required:!1,guiviewer:"identity"}],outputs:baseutils.getImageToImageOutputs(null,"viewer2","overlay"),params:[{name:"Flip",description:"It true project along the increasing axis",priority:10,advanced:!0,gui:"check",varname:"flip",type:"boolean",default:!1},{name:"VFlip",description:"It true flip the vertical  axis",priority:11,advanced:!0,gui:"check",varname:"flipy",type:"boolean",default:!1},{name:"Axis",description:"Which axis to project along ('x', 'y', 'z', 'auto')",priority:1,advanced:!1,gui:"dropdown",default:"y",type:"string",fields:["x","y","z","auto"],restrictAnswer:["x","y","z","auto"],varname:"axis"},{name:"Threshold",description:"The intensity threshold to detect background in shaded projection",priority:100,advanced:!0,gui:"slider",varname:"threshold",default:.5,type:"float",low:0,high:1e3,step:.1},{name:"Windowsize",description:"Number of voxels to average in 'average' or 'project' mode",priority:20,advanced:!1,gui:"slider",varname:"window",default:3,type:"int",low:1,high:40},{name:"reduce",description:"Factor to reduce resolution by as 2D res >> 3d res",priority:5,advanced:!1,gui:"slider",varname:"reduce",default:2,type:"int",low:1,high:8},{name:"Interpolation",description:"Which type of interpolation to use (3 = cubic, 1 = linear, 0 = nearest-neighbor) when reducing",priority:6,advanced:!1,gui:"dropdown",type:"int",default:"1",varname:"interpolation",fields:[0,1,3],restrictAnswer:[0,1,3]},baseutils.getDebugParam()]}}directInvokeAlgorithm(vals){return console.log("oooo invoking: backProjectImage with vals",JSON.stringify(vals)),new Promise((resolve,reject)=>{let input=this.inputs.input,threed=this.inputs.target;console.log("des=",input.getDescription(),threed.getDescription());let axis=-1,plane=0;vals.axis.indexOf("z")>=0?(axis=2,plane=2):vals.axis.indexOf("y")>=0?(axis=1,plane=1):vals.axis.indexOf("x")>=0&&(axis=0,plane=0),biswrap.initialize().then(()=>{let xform=this.inputs.xform;if(xform){console.log("oooo reslicing with transformation first");let ref2d=biswrap.extractImageSliceWASM(threed,{frame:0,component:0,slice:0,plane:plane},vals.debug);console.log("ref2d=",ref2d.getDescription());let spa=ref2d.getSpacing(),dim=ref2d.getDimensions(),dt="float";input=biswrap.resliceImageWASM(input,xform,{spacing:[spa[0],spa[1],spa[2]],dimensions:[dim[0],dim[1],dim[2]],datatype:dt,backgroundValue:0,interpolation:parseInt(vals.interpolation)},vals.debug),console.log("Input=",input.getDescription())}let reduce=parseInt(vals.reduce);if(reduce>1){console.log("oooo reducing resolution by a factor of ",reduce);let spa=threed.getSpacing();for(let i=0;i<=2;i++)spa[i]=spa[i]*reduce;threed=biswrap.resampleImageWASM(threed,{spacing:[spa[0],spa[1],spa[2]],interpolation:parseInt(vals.interpolation),backgroundValue:0},vals.debug);let spa2d=input.getSpacing();for(let i=0;i<=1;i++)spa2d[i]=spa2d[i]*reduce;input=biswrap.resampleImageWASM(input,{spacing:[spa2d[0],spa2d[1],spa2d[2]],interpolation:parseInt(vals.interpolation),backgroundValue:0},vals.debug)}this.outputs.output=biswrap.backProjectImageWASM(threed,input,{flip:this.parseBoolean(vals.flip),flipy:this.parseBoolean(vals.flipy),axis:parseInt(axis),window:parseInt(vals.window),threshold:parseFloat(vals.threshold)},super.parseBoolean(vals.debug)),resolve()}).catch(e=>{console.log(e.stack),reject(e)})})}updateOnChangedInput(inputs){let newDes=this.getDescription(),current_input=(inputs=inputs||this.inputs).input||null;if(null===current_input)return newDes;let imagerange=current_input.getIntensityRange();for(let i=0;i<newDes.params.length;i++)"threshold"===newDes.params[i].varname&&(newDes.params[i].low=imagerange[0],newDes.params[i].high=imagerange[1],newDes.params[i].default=.95*imagerange[0]+.05*imagerange[1]);return this.recreateGUI=!0,newDes}}},"./js/modules/basemodule.js":function(module,exports,__webpack_require__){"use strict";const BisWebDataObjectCollection=__webpack_require__("./js/dataobjects/bisweb_dataobjectcollection.js"),genericio=__webpack_require__("./js/core/bis_genericio.js"),biswrap=__webpack_require__("./build/wasm/libbiswasm_wrapper.js"),baseutils=__webpack_require__("./js/modules/baseutils.js");module.exports=class{constructor(){this.name="base",this.inputs={},this.outputs={},this.description=null,this.useworker=!1,this.mouseobserver=!1,this.recreateGUI=!1}getDescription(){return null===this.description&&(this.description=this.createDescription()),this.description}execute(inputs,params={}){let fullparams=this.parseValuesAndAddDefaults(params),error=[];if(this.getDescription().inputs.forEach(param=>{let name=param.varname;this.inputs[name]=inputs[name]||null,null===this.inputs[name]&&!0===param.required&&(console.log("No/empty "+param.name+" specified."),error.push("No/empty "+param.name+" specified."))}),error.length>0)return Promise.reject(error.join("\n"));const self=this;let name=this.name;return new Promise((resolve,reject)=>{self.directInvokeAlgorithm(fullparams).then(m=>{self.storeCommentsInOutputs(baseutils.getExecutableArguments(name),params,baseutils.getSystemInfo(biswrap)),resolve(m)}).catch(e=>{reject(e)})})}directInvokeAlgorithm(vals){console.log("Called base class directInvokeAlgorithm -- this is most likely not what you wanted!"),console.log("Invoked with vals",vals)}parseValuesAndAddDefaults(cmd,extra={}){let out={};return this.getDescription().params.forEach(param=>{let vname=param.varname,name=vname.toLowerCase();if(void 0===cmd[name]||null===cmd[name])if(void 0===extra[name]||null===extra[name]){let defaultv=param.default;void 0!==defaultv&&(out[vname]=defaultv)}else out[vname]=extra[name];else out[vname]=cmd[name]}),out}updateSingleGUIElement(param,controller,guiVars,name){param.low===param.high&&(param.high=param.low+.001),void 0!==param.step?controller.min(param.low).max(param.high).step(param.step):controller.min(param.low).max(param.high),(guiVars[name]<param.low||guiVars[name]>param.high)&&(guiVars[name]=param.default),controller.onFinishChange(()=>{console.log("On finish change",name);let val=guiVars[name],changed=!1;void 0!==param.low&&val<param.low&&(guiVars[name]=param.low,changed=!0),void 0!==param.high&&val>param.high&&(guiVars[name]=param.high,changed=!0),changed&&controller.updateDisplay()}),controller.updateDisplay()}updateOnChangedInput(){return this.description}compareArrays(arr1,arr2,beginindex=0,endindex=null){if(!arr1||!arr2)return 1e3;null===endindex&&(endindex=arr1.length-1);let maxd=0;for(let i=beginindex;i<=endindex;i++){let v=Math.abs(arr1[i]-arr2[i]);v>maxd&&(maxd=v)}return maxd}setViewerCoordinates(){}typeCheckParam(param,val){if(param.type=param.type||"string",void 0===param.default)return console.log("Parameter",param.name,"does not have a default value"),!1;switch(param.type.toLowerCase()){case"bool":case"boolean":return["0","1",!0,!1,"true","false","on","off"].indexOf(val)>=0;case"float":return!1===isNaN(parseFloat(val));case"int":case"integer":return!1===isNaN(parseFloat(val,10));case"string":case"":break;default:console.log("warning: could not interpret param",val)}let restrict=param.restrict||param.restrictAnswer||null,lowval=param.lowval||param.low||null,highval=param.highval||param.high||null;return restrict&&!restrict.includes(val)?(console.log("----\n---- Parameter",param.name," val=",val,"is not in [",restrict.join(" "),"]"),!1):lowval&&val<lowval?(console.log("----\n---- Parameter",param.name," val=",val,"is < bound=",lowval),!1):!(highval&&val>highval&&(console.log("----\n---- Parameter",param.name," val=",val,"is > bound=",highval),1))}typeCheckParams(vals){let param,desc=this.getDescription();for(let i=0;i<desc.params.length;i++){if(null===vals[(param=desc.params[i]).varname]||void 0===vals[param.varname]||!this.typeCheckParam(param,vals[param.varname]))return console.log("Error: parameter with name=",param.varname,", and  value=",vals[param.varname]," does not match expected."),!1;let tp=param.type.toLowerCase();"bool"!==tp&&"boolean"!==tp||(vals[param.varname]=this.parseBoolean(vals[param.varname]))}return!0}parseBoolean(val){let out=Boolean(val);return out="1"===val||"true"===val||!0===val}loadSingleInput(key,filename,objecttype){const self=this;return new Promise((resolve,reject)=>{BisWebDataObjectCollection.loadObject(filename,objecttype).then(obj=>{self.inputs[key]=obj,resolve()}).catch(e=>{console.log("oooo Failed to load object=",key," from",filename),reject(e.stack)})})}getOutputFilename(name){let obj=this.outputs[name];if(!obj)return"none.json";let inpfilenames=[],des=this.getDescription();for(let i=0;i<des.inputs.length;i++){let varname=des.inputs[i].varname;if(this.inputs[varname]){let fn=this.inputs[varname].getFilename();if(fn.length>1){let ext=fn.split(".").pop();if("gz"===ext&&(ext=(fn=fn.substr(0,fn.length-3)).split(".").pop()),fn=fn.substr(0,fn.length-(ext.length+1)),i>0){let t=fn.lastIndexOf("/");fn=fn.substr(t+1,fn.length-t)}inpfilenames.push(fn)}}}let nm=des.shortname;nm||(nm=this.name);let extra="__"+(nm=nm.toLowerCase()),coreout=inpfilenames.join("__")+extra,twoextra=extra+extra;return(coreout=coreout.replace(twoextra,extra))+obj.getExtension()}saveSingleOutput(key,filename){return this.outputs[key].save(filename)}setInputObject(obj,name="input"){this.inputs[name]=obj}getOutputObject(name="output"){return this.outputs[name]||null}cleanupMemory(cleaninputs=!0,cleanoutputs=!0){let des=this.getDescription();cleaninputs&&des.inputs.forEach(param=>{this.inputs[param.name]=null}),cleanoutputs&&des.outputs.forEach(param=>{this.outputs[param.name]=null})}loadInputs(inputparameters={},basedirectory=""){let p=[];if(this.getDescription().inputs.forEach(param=>{let name=param.varname,inpname=inputparameters[name]||null,required=param.required||!1,objtype=param.type;if(required&&null===inpname)return console.log("---- Error no filename specified for input "+name+" (of type:"+objtype+")"),p=null,null;(required||null!==inpname)&&(console.log(".... Queuing reading of "+objtype+" "+name+" from: "+basedirectory+inpname),p.push(this.loadSingleInput(name,basedirectory+inpname,objtype)))}),null==p)return Promise.reject("error");const self=this;return new Promise((resolve,reject)=>{Promise.all(p).then(()=>{self.description=self.updateOnChangedInput(null),resolve()}).catch(e=>{reject(e)})})}storeCommentsInOutputs(commandlineargs,vars=null,systeminfo=null){this.getDescription().outputs.forEach(param=>{let name=param.varname,cmt={"command ":commandlineargs,output:name};if(vars&&(cmt.parameters=JSON.parse(JSON.stringify(vars))),systeminfo&&(cmt.systeminfo=JSON.parse(JSON.stringify(systeminfo))),this.outputs[name]){this.outputs[name].addComment({ModuleOutput:cmt});let fn=this.getOutputFilename(name);this.outputs[name].setFilename(fn)}})}saveOutputs(inputparameters={}){let p=[];return this.getDescription().outputs.forEach(param=>{let name=param.varname,objtype=param.type,required=param.required||!1,filename=inputparameters[name]||null;required&&null===filename&&(filename=this.getOutputFilename(name)),null!==filename&&null!==this.outputs[name]&&(console.log(".... Queuing writing of "+objtype+" "+name+" from: "+filename),p.push(this.saveSingleOutput(name,filename)))}),Promise.all(p)}saveParameters(fobj,guiVars){let output=JSON.stringify({module:this.name,params:guiVars},null,4);return new Promise(function(resolve,reject){genericio.write(fobj,output).then(f=>{fobj.name&&(fobj=fobj.name),resolve(f)}).catch(e=>{reject(e)})})}loadParameters(fobj){const self=this;return new Promise((resolve,reject)=>{genericio.read(fobj,!1).then(contents=>{let obj=null;try{obj=JSON.parse(contents.data)}catch(e){reject(e)}obj.module!==self.name&&reject("Module name does not match in "+contents.filename),resolve(obj.params)}).catch(e=>{reject(e)})})}}},"./js/modules/baseutils.js":function(module,exports,__webpack_require__){"use strict";(function(process){const genericio=__webpack_require__("./js/core/bis_genericio.js"),platform=__webpack_require__("./node_modules/platform/platform.js"),os=genericio.getosmodule();module.exports={getDebugParam:()=>({name:"Debug",description:"Toggles debug logging",priority:1e3,advanced:!0,gui:"check",varname:"debug",type:"boolean",default:!1}),getRegressorInput:()=>({type:"matrix",name:" Regressor",description:"The regressor matrix",varname:"regressor",shortname:"r"}),getImageToImageInputs:function(desc,viewer="viewer1",vtype="image"){return[{type:"image",name:"Input Image",description:desc||"The image to be processed",varname:"input",shortname:"i",required:!0,guiviewertype:vtype,guiviewer:viewer}]},getImageToImageOutputs:function(desc=null,viewer="viewer1",vtype="image",addlog=!1){vtype=vtype||"image",viewer=viewer||"viewer1";let arr=[{type:"image",name:"Output Image",description:desc||"Save the output image",varname:"output",shortname:"o",required:!0,extension:".nii.gz",guiviewertype:vtype,guiviewer:viewer}];return addlog&&this.addLogOutput(arr),arr},addLogOutput(arr,required=!1){arr.push({type:"text",name:"Results",description:"log file",varname:"logoutput",required:required,extension:".bistext"})},getMatrixToMatrixInputs:function(addweights=!1,desc=null){let arr=[{type:"matrix",name:"Matrix",description:desc||"The input data (matrix) to process. Rows=Frames, Columns=Series.",varname:"input",shortname:"i",required:!0}];return addweights&&arr.push({type:"vector",name:"Weights",description:"(Optional). The framewise weight vector",varname:"weight",shortname:"w",required:!1}),arr},getMatrixToMatrixOutputs:function(desc=null){return[{type:"matrix",name:"Output Matrix",description:desc||"The output matrix",varname:"output",shortname:"o",required:!0,extension:".matr"}]},getRegistrationInputs:function(includematrix=!0){let inp=[{type:"image",name:"Reference Image",description:"The reference image",varname:"reference",shortname:"r",required:!0,guiviewerinput:"image",guiviewer:"viewer1"},{type:"image",name:"Target Image",description:"The image to register",varname:"target",shortname:"t",required:!0,guiviewerinput:"image",guiviewer:"viewer2"}];return includematrix&&inp.push({type:"transformation",name:"Initial Xform",description:"The initial transformation (optional)",varname:"initial",required:!1,guiviewer:"identity"}),inp},getRegistrationOutputs:function(){return[{type:"transformation",name:"Output Transformation",description:"The output transformation",varname:"output",shortname:"o",required:!0,extension:".json"},{type:"image",name:"Resliced Image",description:"The resliced image",varname:"resliced",required:!1,extension:".nii.gz",guiviewertype:"overlay",guiviewer:"viewer1",colortype:"Orange"}]},getOptParams:function(obj=null){return(obj=obj||{}).stepsize=obj.stepsize||1,obj.levels=obj.levels||3,obj.iterations=obj.iterations||10,obj.resolution=obj.resolution||1.5,obj.steps=obj.steps||1,[{name:"Optimization",description:"Optimization Method",priority:5,advanced:!0,type:"string",gui:"dropdown",fields:["HillClimb","GradientDescent","ConjugateGradient"],restrictAnswer:["HillClimb","GradientDescent","ConjugateGradient"],varname:"optimization",default:"ConjugateGradient"},{name:"Step Size",description:"Step size for gradient computation",priority:6,advanced:!0,type:"float",gui:"slider",varname:"stepsize",default:obj.stepsize,low:.125,high:4},{name:"Levels",description:"Number of levels in multiresolution optimization",priority:3,advanced:!1,default:obj.levels,type:"int",gui:"slider",varname:"levels",low:1,high:4},{name:"Iterations",description:"Number of iterations (per level and step)",priority:9,advanced:!1,gui:"slider",type:"int",varname:"iterations",low:1,high:32,default:obj.iterations},{name:"Resolution",description:"Factor to reduce the resolution prior to registration",priority:11,advanced:!1,gui:"slider",type:"float",varname:"resolution",default:obj.resolution,low:1,high:5,step:.25},this.getDebugParam(),{name:"Steps",description:"Number of steps in multiresolution optimization",priority:8,advanced:!0,gui:"slider",type:"int",varname:"steps",default:obj.steps,low:1,high:4}]},getRegistrationParams:function(){return[{name:"Reslice",description:"If true also output a resliced targed image using the current transform",priority:100,advanced:!0,gui:"check",varname:"doreslice",type:"boolean",default:!1},{name:"Normalize",description:"If true normalize input intensities by saturating using cumulative histogram",priority:101,advanced:!0,gui:"check",varname:"norm",type:"boolean",default:!0},{name:"Int Scale",description:"Determines the intensity scaling post image normalization",priority:1,advanced:!0,type:"int",gui:"slider",varname:"intscale",default:1,low:1,high:4},{name:"Number of Bins",description:"Number of bins in joint histogram",priority:2,advanced:!0,gui:"slider",type:"int",default:64,varname:"numbins",fields:[16,32,64,128,256,512,1024],restrictAnswer:[16,32,64,128,256,512,1024]},{name:"Smoothing",description:"Amount of image smoothing to perform",priority:4,advanced:!0,type:"float",gui:"slider",varname:"imagesmoothing",default:1,low:0,high:4,step:.5},{name:"Metric",description:"Metric to compare registration",priority:7,advanced:!0,gui:"dropdown",type:"string",fields:["SSD","CC","MI","NMI"],restrictAnswer:["SSD","CC","MI","NMI"],varname:"metric",default:"NMI"}].concat(this.getOptParams())},getLinearMode:function(name="Mode",extra="",defaultv="Rigid"){let opt=["Rigid","Similarity","Affine9","Affine"];return"linearmode"===name&&opt.push("None"),{name:name,description:extra+"registration mode, one of [ "+opt.join(" ")+" ]",priority:10,advanced:!1,gui:"dropdown",type:"string",default:defaultv,fields:opt,restrictAnswer:opt,varname:name.toLowerCase()}},getOptimizationCode:function(name){return"hillclimb"===(name=(name||"ConjugateGradient").toLowerCase())?0:"gradientdescent"===name?1:2},getMetricCode:function(name){return"SSD"===(name=(name||"NMI").toUpperCase())?0:"CC"===name?1:"MI"===name?2:3},getLinearModeCode:function(name){return"similarity"===(name=(name||"Rigid").toLowerCase())?1:"affine9"===name?2:"affine"===name?3:"none"===name?-1:0},resliceRegistrationOutput:function(biswrap,reference,target,transform,interpolation=1,background=0){let spa=reference.getSpacing(),dim=reference.getDimensions(),out=biswrap.resliceImageWASM(target,transform,{spacing:[spa[0],spa[1],spa[2]],dimensions:[dim[0],dim[1],dim[2]],interpolation:interpolation,backgroundValue:background});return out.copyOrientationInfo(reference),out},findParam(paramarray,key){let i=0;for(;i<paramarray.length;){if((paramarray[i].varname||"")===key)return i;i+=1}return-1},setParamDefaultValue(paramarray,key,value){let i=this.findParam(paramarray,key);i>=0?paramarray[i].default=value:console.log("key ",key,"not found")},getSystemInfo(biswrap){let systeminfo=null;return systeminfo="node"===genericio.getmode()?{os:os.platform(),arch:os.arch(),hostname:os.hostname(),user:os.userInfo().username,date:new Date,nodeversion:process.version,biswebversion:biswrap.get_date()}:{os:platform.os.family,arch:platform.os.architecture,browser:platform.name,date:new Date,browserversion:platform.version,biswebversion:biswrap.get_date()}},getExecutableArguments(name){if("node"===genericio.getmode())return["node"];if("undefined"==typeof window)return["browser worker"];return window.location.href+" "+name}}}).call(this,__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/node_modules/process/browser.js?55cf"))},"./js/modules/binaryThresholdImage.js":function(module,exports,__webpack_require__){"use strict";const ThresholdImageModule=__webpack_require__("./js/modules/thresholdImage.js"),baseutils=__webpack_require__("./js/modules/baseutils.js");module.exports=class extends ThresholdImageModule{constructor(){super(),this.name="binaryThresholdImage",this.JSOnly=!0}createDescription(){return{name:"Create Mask",description:"This element will threshold an image and force to binary",author:"Xenios Papademetris",version:"1.0",inputs:baseutils.getImageToImageInputs(),outputs:baseutils.getImageToImageOutputs("The output mask","viewer1","overlay"),buttonName:"Create",shortname:"bthr",params:[{name:"Low Threshold",description:"The threshold below which values will be zeroed",priority:1,advanced:!1,gui:"slider",type:"float",varname:"low",default:1},{name:"High Threshold",description:"The value above which values will be zeroed",priority:2,advanced:!1,gui:"slider",type:"float",default:1e3,varname:"high"},baseutils.getDebugParam()]}}directInvokeAlgorithm(vals){return vals.replacein=!0,vals.replaceout=!0,vals.inval=1,vals.outval=0,vals.outtype="UChar",super.directInvokeAlgorithm(vals)}}},"./js/modules/bis_tfutil.js":function(module,exports,__webpack_require__){const BisWebImage=__webpack_require__("./js/dataobjects/bisweb_image.js"),bisutil=__webpack_require__("./js/core/bis_util.js"),bisgenericio=__webpack_require__("./js/core/bis_genericio.js");let tfjsModule=null;class TFWrapper{constructor(tf,mode=""){mode.length>1?this.mode=mode+" "+tf.getBackend():this.mode=tf.getBackend(),this.tf=tf,this.models={},this.modelcount=0}getMode(){return this.mode}disposeVariables(model){return new Promise(resolve=>{this.tf.disposeVariables(),this.models[model.index]=void 0,resolve(this.tf.memory().numTensors)})}disposeTensor(tensor){tensor.dispose()}predict(model,patch,shape,debug=!1){try{shape[0]=parseInt(shape[0])}catch(e){shape[0]=1}return new Promise(resolve=>{debug&&console.log("++++ creating tensor",shape,"patch=",patch.length);const tensor=this.tf.tensor(patch,shape),output=this.models[model.index].predict(tensor);tensor.dispose(),resolve(output)})}loadFrozenModel(MODEL_URL,WEIGHTS_URL){return new Promise((resolve,reject)=>{this.tf.loadFrozenModel(MODEL_URL,WEIGHTS_URL).then(m=>{this.modelcount++,this.models[this.modelcount]=m,resolve({index:this.modelcount,shape:m.inputs[0].shape,numtensors:this.tf.memory().numTensors})}).catch(e=>{reject(e)})})}warmUp(model){let shape=model.shape;shape[0]=1,this.tf.tidy(()=>{console.log("___\t Warm up model with zero input",shape.join(",")),this.models[model.index].predict(this.tf.fill(shape,0,"float32")),console.log("___\t Warm up done")})}}module.exports={BisWebTensorFlowRecon:class{constructor(tfwrapper,input,model,padding=16){this.debug=!1,this.input=input,this.output=new BisWebImage,this.output.cloneImage(this.input),this.model=model;let shape=model.shape,width=shape[1],height=shape[2],numslices=shape[3]||1,stridex=width-padding,stridey=height-padding,dims=this.input.getDimensions(),dimx=Math.floor(dims[0]/stridex);dims[0]%width>0&&(dimx+=1);let dimy=Math.floor(dims[1]/stridey);dims[1]%height>0&&(dimy+=1),numslices<1&&(numslices=1);let thickness=Math.round(numslices/2)-1;thickness<0&&(thickness=0),this.patchinfo={batchsize:1,padding:padding,thickness:thickness,numslices:numslices,height:height,width:width,numrows:dimy,numcols:dimx,stridex:stridex,stridey:stridey,numframes:dims[3]*dims[4],dims:dims},this.patch=null}createPatch(b=1){this.patchinfo.batchsize=b,this.patchinfo.patchslicesize=this.patchinfo.width*this.patchinfo.height,this.patchinfo.patchvolumesize=this.patchinfo.patchslicesize*this.patchinfo.numslices,this.patch=new Float32Array(this.patchinfo.patchslicesize*this.patchinfo.batchsize),this.debug&&console.log("+++ Created patch temp array ",this.patch.length,"( ",this.patchinfo.patchvolumesize,"*",this.patchinfo.batchsize,")")}cleanup(){this.patch=null,this.input=null,this.patchinfo=null}getOutput(){return this.output}getPatchInfo(){return this.patchinfo}getPatch(){return this.patch}getPatchLimits(slice,frame,row,col,store=!1){let dims=this.input.getDimensions(),offset=slice*dims[0]*dims[1]+frame*dims[0]*dims[1]*dims[2],begini=col*this.patchinfo.stridex,endi=begini+this.patchinfo.width-1,beginj=row*this.patchinfo.stridey,endj=beginj+this.patchinfo.height-1,obj={begini:begini,endi:endi,beginj:beginj,endj:endj,offset:offset};if(store){let midx=Math.floor(.5*(this.patchinfo.width-this.patchinfo.stridex)),midy=Math.floor(.5*(this.patchinfo.height-this.patchinfo.stridey));obj.imin=col>0?begini+midx:begini,obj.jmin=row>0?beginj+midy:beginj,col<this.patchinfo.numcols-1?obj.imax=endi-midx:obj.imax=endi,row<this.patchinfo.numrows-1?obj.jmax=endj-midy:obj.jmax=endj,obj.jmax>=dims[1]&&(obj.jmax=dims[1]-1),obj.imax>=dims[0]&&(obj.imax=dims[0]-1)}return obj.endj>=dims[1]&&(obj.endj=dims[1]-1),obj}extractPatch(indices,batchindex=0){if(null===this.patch)throw new Error("Call allocate Patch before");this.debug&&console.log("Indices=",indices);let in_slice=indices[0],frame=indices[1],row=indices[2],col=indices[3],dims=this.input.getDimensions(),minslice=in_slice-this.patchinfo.thickness,maxslice=in_slice+this.patchinfo.thickness,batchsize=this.patchinfo.batchsize;if(batchindex<0?batchindex=0:batchindex>=batchsize&&(batchindex=batchsize-1),0===batchindex){let l=this.patch.length;for(let i=0;i<l;i++)this.patch[i]=0}let imagedata=this.input.getImageData();for(let slice=minslice;slice<=maxslice;slice++){let sl=slice;sl<0&&(sl=0),sl>=dims[2]&&(sl=dims[2]-1);let limits=this.getPatchLimits(sl,frame,row,col,!1),index=slice-minslice+batchindex*this.patchinfo.patchvolumesize;this.debug&&console.log(`+++ read patch  ${slice}/${frame}/${row}/${col}, sl=${sl}, i=${limits.begini}:${limits.endi}, j=${limits.beginj}:${limits.endj}, batchindex=${batchindex}`);let iextra=0;limits.endi>=dims[0]&&(iextra=(limits.endi-(dims[0]-1))*this.patchinfo.numslices,limits.endi=dims[0]-1);for(let j=limits.beginj;j<=limits.endj;j++){let joffset=j*dims[0]+limits.offset+limits.begini;for(let i=limits.begini;i<=limits.endi;i++)this.patch[index]=imagedata[joffset],joffset++,index+=this.patchinfo.numslices;index+=iextra}}return this.patch}storePatch(patcharray,indices,batchindex=0){this.debug&&console.log("Patcharray",patcharray.constructor.name,patcharray.length,"Indices=",JSON.stringify(indices),"batchindex",batchindex);let slice=indices[0],frame=indices[1],row=indices[2],col=indices[3],limits=this.getPatchLimits(slice,frame,row,col,!0),dims=this.output.getDimensions(),batchsize=this.patchinfo.batchsize;batchindex<0?batchindex=0:batchindex>=batchsize&&(batchindex=batchsize-1);let jminextra=0,iminextra=0,imaxextra=0;limits.jmin>limits.beginj&&(jminextra=limits.jmin-limits.beginj),limits.imin>limits.begini&&(iminextra=limits.imin-limits.begini),limits.imax<limits.endi&&(imaxextra=limits.endi-limits.imax);let index=batchindex*this.patchinfo.patchvolumesize;index+=jminextra*this.patchinfo.width,this.debug&&console.log(`+++ write patch i=${limits.imin}:${limits.imax}, j=${limits.jmin}:${limits.jmax}, slice=${slice}/${frame}/${row}/${col} index=${batchindex}`);let imagedata=this.output.getImageData();for(let j=limits.jmin;j<=limits.jmax;j++){let joffset=j*dims[0]+limits.offset+limits.imin;index+=iminextra;for(let i=limits.imin;i<=limits.imax;i++)imagedata[joffset]=patcharray[index],joffset++,index++;index+=imaxextra}return!0}getPatchIndices(){let indiceslist=[],dims=this.input.getDimensions(),maxslice=dims[2]-1;for(let slice=0;slice<=maxslice;slice++)for(let frame=0;frame<dims[3]*dims[4];frame++)for(let row=0;row<this.patchinfo.numrows;row++)for(let col=0;col<this.patchinfo.numcols;col++)indiceslist.push([slice,frame,row,col]);return indiceslist}reconstruct(tfwrapper,batchsize=2,cleanup=!0){return new Promise(async resolve=>{batchsize<1&&(batchsize=1);let patchindexlist=this.getPatchIndices();batchsize>patchindexlist.length&&(batchsize=patchindexlist.length),this.createPatch(batchsize);let shape=this.model.shape;console.log(`+++\n+++ Beginning Prediction: numpatches=${patchindexlist.length}, batchsize=${this.patchinfo.batchsize}, padding=${this.patchinfo.padding}\n+++`);let startTime=new Date,step=Math.round(patchindexlist.length/20),last=0;for(let pindex=0;pindex<patchindexlist.length;pindex+=batchsize){let numpatches=patchindexlist.length-pindex;if(numpatches<batchsize?this.createPatch(numpatches):numpatches=batchsize,this.debug||pindex-last>step||0===pindex){let per=Math.round(100*pindex/patchindexlist.length);console.log(`+++ ${bisutil.getTime()}\t ${per}%. Patches ${pindex}:${pindex+numpatches-1}/${patchindexlist.length}.`),last=pindex}for(let inner=0;inner<numpatches;inner++){let elem=patchindexlist[pindex+inner];this.extractPatch(elem,inner)}let patch=this.getPatch();shape[0]=numpatches;const output=await tfwrapper.predict(this.model,patch,shape,this.debug);let predict=output.dataSync();for(let inner=0;inner<numpatches;inner++){let elem=patchindexlist[pindex+inner];this.storePatch(predict,elem,inner)}tfwrapper.disposeTensor(output)}let endTime=new Date,s=Math.floor((endTime-startTime)/1e3),ms=Math.round((endTime-startTime)/10-100*s),perslice=Math.round((endTime-startTime)/patchindexlist.length);console.log(`+++ ${bisutil.getTime()} \t100%. Total time=${s}.${ms}s. Time per patch=${perslice}ms\n+++`),cleanup&&this.cleanup(),resolve(this.getOutput())})}},TFWrapper:TFWrapper,initializeTFModule:function(forcebrowser=!1){let environment=bisgenericio.getmode();return new Promise((resolve,reject)=>{if(null===tfjsModule){if("electron"===environment){if(null!==window.BISELECTRON.tf){let md=window.BISELECTRON.tfmodulename||"electron";return tfjsModule=new TFWrapper(window.BISELECTRON.tf,md),void resolve(md)}forcebrowser=!0}if("browser"===environment||"electron"===environment&&!0===forcebrowser){if(window.tf)return tfjsModule=new TFWrapper(window.tf,"loaded from script"),void resolve("Using preloaded tfjs module");let apiTag=document.createElement("script"),url="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@0.14.1/dist/tf.min.js";return apiTag.src=url,apiTag.onload=(()=>{tfjsModule=new TFWrapper(window.tf,url),resolve("Module loaded from "+url)}),apiTag.onerror=(e=>{reject("Failed to load tfjs module"+e)}),void document.head.appendChild(apiTag)}if("node"===environment)try{let tf=__webpack_require__("request");return __webpack_require__("request"),tfjsModule=new TFWrapper(tf,"tfjs-node"),void resolve("Module loaded from tfjs-node")}catch(e){return tfjsModule=null,void reject("Failed to load tfjs-node")}}else resolve("Using preloaded module: "+tfjsModule.getMode())})},fixModelName:function(md){let environment=bisgenericio.getmode();if(0===md.indexOf("http"))return md;if("browser"===environment){let getScope=()=>{let scope=window.document.URL,index=scope.indexOf(".html");if(index>0)index=scope.lastIndexOf("/"),scope=scope.substr(0,index+1);else{let index=scope.indexOf("#");index>0&&(index=scope.lastIndexOf("/"),scope=scope.substr(0,index+1))}return scope};return 0!==md.indexOf("http")?getScope()+md:md}const path=bisgenericio.getpathmodule();if("electron"===environment){let start=7;return"\\"===path.sep&&(start=8),0===md.indexOf("file")&&(md=md.substr(start,md.length)),md=path.normalize(path.resolve(md)),8===start&&(md=bisutil.filenameUnixToWindows(md)),md="file://"+md}return 0===(md=path.normalize(path.resolve(md))).indexOf("file")?md:"file://"+md},fixBatchSize:function(batchsize){let environment=bisgenericio.getmode();return(batchsize=parseInt(batchsize))<1&&(batchsize=1),"broswer"===environment?batchsize>2&&(batchsize=2):batchsize>64&&(batchsize=64),batchsize},getTFJSModule:function(){return tfjsModule},loadAndWarmUpModel:function(tfwrapper,URL,warm=!0){console.log("___ In Load Model",URL);const MODEL_URL=URL+"/tensorflowjs_model.pb",WEIGHTS_URL=URL+"/weights_manifest.json";return new Promise((resolve,reject)=>{tfwrapper.loadFrozenModel(MODEL_URL,WEIGHTS_URL).then(model=>{let shape=model.shape;console.log("___\t Loaded model with shape",shape.join(",")," num tensors=",model.numtensors),warm&&tfwrapper.warmUp(model),resolve(model)}).catch(e=>{console.log("___\t Model load from",URL,"failed"),reject(e)})})}}},"./js/modules/blankImage.js":function(module,exports,__webpack_require__){"use strict";const biswrap=__webpack_require__("./build/wasm/libbiswasm_wrapper.js"),baseutils=__webpack_require__("./js/modules/baseutils.js"),BaseModule=__webpack_require__("./js/modules/basemodule.js"),defaultMin=-1,defaultMax=10001;module.exports=class extends BaseModule{constructor(){super(),this.name="blankImage",this.lastInputDimensions=[0,0,0]}createDescription(){let createParam=function(axis,name,shortname,value,p,adv=!1){return{name:axis.toUpperCase()+"-"+name,description:`The ${name} along the ${axis} axis.`,priority:p,advanced:adv,gui:"slider",varname:shortname,type:"int",default:value}};return{name:"Blank Image",description:"This algorithm performes image blanking",author:"Xenios Papdemetris",version:"1.0",inputs:baseutils.getImageToImageInputs("Load the image to be blanked"),outputs:baseutils.getImageToImageOutputs(),buttonName:"Execute",shortname:"blk",params:[createParam("i","Start","i0",defaultMin,1),createParam("i","End","i1",defaultMax,2),createParam("j","Start","j0",defaultMin,4),createParam("j","End","j1",defaultMax,5),createParam("k","Start","k0",defaultMin,7),createParam("k","End","k1",defaultMax,8),baseutils.getDebugParam()]}}directInvokeAlgorithm(vals){let input=this.inputs.input,dim=input.getDimensions(),names=["i0","i1","j0","j1","k0","k1"];for(let ia=0;ia<=2;ia++){let n0=names[2*ia],n1=names[2*ia+1],v0=parseInt(vals[n0]),v1=parseInt(vals[n1]);v0===-defaultMin&&(vals[n0]=0),v1===defaultMax&&(vals[n1]=dim[ia]-1)}return console.log("oooo invoking: blankImage with vals",JSON.stringify(vals)),new Promise((resolve,reject)=>{biswrap.initialize().then(()=>{this.outputs.output=biswrap.blankImageWASM(input,{i0:parseInt(vals.i0),i1:parseInt(vals.i1),j0:parseInt(vals.j0),j1:parseInt(vals.j1),k0:parseInt(vals.k0),k1:parseInt(vals.k1)},super.parseBoolean(vals.debug)),resolve()}).catch(e=>{reject(e.stack)})})}updateOnChangedInput(inputs,guiVars){let newDes=this.getDescription(),img=(inputs=inputs||this.inputs).input||null;if(null===img)return newDes;let dim=img.getDimensions(),bounds=["i0","i1","j0","j1","k0","k1"];if(!(this.compareArrays(dim,this.lastInputDimensions,0,2)<1)){this.lastInputDimensions=dim;for(let i=0;i<newDes.params.length;i++){let name=newDes.params[i].varname,index=bounds.indexOf(name);if(index>=0){let axis=Math.floor(index/2),high=index-2*axis;newDes.params[i].low=0,newDes.params[i].high=dim[axis]-1,newDes.params[i].default=high>0?dim[axis]-1:0,guiVars&&(guiVars[name]=newDes.params[i].default)}}return this.recreateGUI=!0,newDes}}}},"./js/modules/butterworthFilter.js":function(module,exports,__webpack_require__){"use strict";const biswrap=__webpack_require__("./build/wasm/libbiswasm_wrapper.js"),baseutils=__webpack_require__("./js/modules/baseutils.js"),BaseModule=__webpack_require__("./js/modules/basemodule.js");module.exports=class extends BaseModule{constructor(){super(),this.name="butterworthFilter"}createDescription(){return{name:"Butterworth Filter",description:"This element will apply a Butterworth Filter to an input matrix",author:"Zach Saltzman",version:"1.0",inputs:baseutils.getMatrixToMatrixInputs(),outputs:baseutils.getMatrixToMatrixOutputs(),buttonName:"Filter",shortname:"bwf",params:[{name:"Type",description:"What type of filter to apply (low, band, or high)",priority:1,advanced:!1,gui:"dropdown",type:"string",varname:"type",fields:["low","band","high"],restrictAnswer:["low","band","high"],default:"band"},{name:"Low Frequency",description:"Lowpass cutoff frequency of filter (in Hertz)",priority:2,advanced:!1,gui:"slider",type:"float",varname:"low",low:0,high:10,default:.1},{name:"High Frequency",description:"Highpass cutoff frequency of filter (in Hertz)",priority:2,advanced:!1,gui:"slider",type:"float",varname:"high",low:0,high:10,default:.01},{name:"Sample Rate",description:"Data time of repetition (Data TR)",priority:3,advanced:!1,gui:"slider",type:"float",varname:"tr",default:1,low:.01,high:5},baseutils.getDebugParam()]}}directInvokeAlgorithm(vals){console.log("oooo invoking: butterworthFilter with vals",JSON.stringify(vals));let input=this.inputs.input;return new Promise((resolve,reject)=>{biswrap.initialize().then(()=>{let inp=input,out=null;if("low"===vals.type||"band"===vals.type){if(out=biswrap.butterworthFilterWASM(input,{type:"low",cutoff:parseFloat(vals.low),samplerate:parseFloat(vals.tr)},super.parseBoolean(vals.debug)),"low"===vals.type)return this.outputs.output=out,void resolve();inp=out}this.outputs.output=biswrap.butterworthFilterWASM(inp,{type:"high",cutoff:parseFloat(vals.high),samplerate:parseFloat(vals.tr)},vals.debug),resolve()}).catch(e=>{reject(e.stack)})})}}},"./js/modules/changeImageSpacing.js":function(module,exports,__webpack_require__){"use strict";const BaseModule=__webpack_require__("./js/modules/basemodule.js"),baseutils=__webpack_require__("./js/modules/baseutils.js"),BisWebImage=__webpack_require__("./js/dataobjects/bisweb_image.js");module.exports=class extends BaseModule{constructor(){super(),this.name="changeImageSpacing",this.lastInputSpacing=[1,1,1]}createDescription(){return{name:"Change Image Spacing",description:"Changes the image header to have new spacing",author:"Xenios Papademetris",version:"1.0",inputs:baseutils.getImageToImageInputs(),outputs:baseutils.getImageToImageOutputs(),buttonName:"Change Header",shortname:"sp",params:[{name:"X Spacing",description:"Desired voxel spacing in X direction",priority:1,advanced:!1,gui:"slider",type:"float",varname:"xsp",default:1,low:.1,high:10,step:.1},{name:"Y Spacing",description:"Desired voxel spacing in Y direction",priority:2,advanced:!1,gui:"slider",type:"float",varname:"ysp",default:1,low:.1,high:10,step:.1},{name:"Z Spacing",description:"Desired voxel spacing in the z-direction",priority:3,advanced:!1,gui:"slider",varname:"zsp",default:1,type:"float",low:.1,high:10,step:.1}]}}directInvokeAlgorithm(vals){return console.log("oooo invoking: changeImageSpacing with vals",JSON.stringify(vals)),new Promise((resolve,reject)=>{let input=this.inputs.input;null===input&&reject("Bad Input");let output=new BisWebImage,spa=input.getSpacing();console.log("oooo Original spacing to ",spa);let inspa=[parseFloat(vals.xsp),parseFloat(vals.ysp),parseFloat(vals.zsp)];for(let i=0;i<=2;i++)inspa[i]>0&&(spa[i]=inspa[i]);console.log("oooo Setting spacing to ",spa),output.cloneImage(input,{spacing:spa}),output.getImageData().set(input.getImageData()),this.outputs.output=output,resolve()})}updateOnChangedInput(inputs,guiVars){let newDes=this.getDescription(),current_input=(inputs=inputs||this.inputs).input||null;if(null===current_input)return newDes;let spa=current_input.getSpacing();if(!(this.compareArrays(spa,this.lastInputSpacing,0,2)<.01)){this.lastInputSpacing=spa;for(let i=0;i<newDes.params.length;i++){let name=newDes.params[i].varname,index=["xsp","ysp","zsp"].indexOf(name);index>=0&&(newDes.params[i].low=Number.parseFloat(.2*spa[index]).toFixed(3),newDes.params[i].high=5*spa[index],newDes.params[i].step=Number.parseFloat(.1*spa[index]).toFixed(3),newDes.params[i].default=spa[i],guiVars&&(guiVars[name]=newDes.params[i].default))}return this.recreateGUI=!0,newDes}}}},"./js/modules/clusterThreshold.js":function(module,exports,__webpack_require__){"use strict";const biswrap=__webpack_require__("./build/wasm/libbiswasm_wrapper.js"),baseutils=__webpack_require__("./js/modules/baseutils.js"),BaseModule=__webpack_require__("./js/modules/basemodule.js");module.exports=class extends BaseModule{constructor(){super(),this.name="clusterThreshold",this.lastInputRange=[0,0]}createDescription(){return{name:"Cluster Threshold",description:"This element will separate an image into clusters and apply binary thresholding",author:"Zach Saltzman",version:"1.0",inputs:baseutils.getImageToImageInputs(),outputs:baseutils.getImageToImageOutputs("The output image","viewer1","overlay"),buttonName:"Threshold",shortname:"thr",params:[{name:"Threshold",description:"The value to threshold at (zero out voxels below threshold)",priority:1,advanced:!1,gui:"slider",type:"float",varname:"threshold",default:1},{name:"Cluster Size",description:"Size of clusters to form",priority:2,advanced:!1,gui:"slider",type:"int",varname:"size",default:1e3,low:10,high:1e4},{name:"One Connected",description:"Whether to use 6 or 26 neighbors",priority:3,advanced:!0,gui:"check",type:"bool",varname:"oneconnected",default:!0},{name:"Frame",description:"Which frame from the time series to cluster (fourth dimension)",priority:4,advanced:!0,gui:"slider",type:"int",varname:"frame",default:0},{name:"Component",description:"Which component to take a frame from (fifth dimension)",priority:5,advanced:!0,gui:"slider",type:"int",varname:"component",default:0},{name:"OutputClusterNo",description:"It true output cluster number instead of image",priority:20,advanced:!1,gui:"check",varname:"outclustno",type:"boolean",default:!1},baseutils.getDebugParam()]}}directInvokeAlgorithm(vals){console.log("oooo invoking: clusterThresholdImage with vals",JSON.stringify(vals));let input=this.inputs.input;return console.log("\n ClusterThreshold\n--------------------\ncurrent=",input.getDescription()),new Promise((resolve,reject)=>{biswrap.initialize().then(()=>{this.outputs.output=biswrap.clusterThresholdImageWASM(input,{threshold:parseFloat(vals.threshold),clustersize:parseInt(vals.size),oneconnected:super.parseBoolean(vals.oneconnected),outputclusterno:super.parseBoolean(vals.outclustno),frame:parseInt(vals.frame),component:parseInt(vals.component),datatype:-1},vals.debug),resolve()}).catch(e=>{reject(e.stack)})})}updateOnChangedInput(inputs,guiVars=null){let newDes=this.getDescription(),current_input=(inputs=inputs||this.inputs).input||null;if(null===current_input)return newDes;let dim=current_input.getDimensions(),imagerange=current_input.getIntensityRange();if(this.compareArrays(imagerange,this.lastInputRange,0,1)<1)return;this.lastInputRange=imagerange;let maxv=Math.max(Math.abs(imagerange[0]),Math.abs(imagerange[1]));for(let i=0;i<newDes.params.length;i++){let name=newDes.params[i].varname;"threshold"!==name&&"frame"!==name&&"component"!==name&&"size"!==name||("threshold"===name?(newDes.params[i].low=.01*maxv,newDes.params[i].high=maxv,newDes.params[i].default=.5*maxv):"frame"===name?(newDes.params[i].low=0,newDes.params[i].high=dim[3]-1,newDes.params[i].default=0):"component"===name?(newDes.params[i].low=0,newDes.params[i].high=dim[4]-1,newDes.params[i].default=1):"size"===name&&(newDes.params[i].low=5,newDes.params[i].high=Math.round(dim[0]*dim[1]*dim[2]*.001),newDes.params[i].default=100),guiVars&&(guiVars[name]=newDes.params[i].default))}return this.recreateGUI=!0,newDes}}},"./js/modules/combineImages.js":function(module,exports,__webpack_require__){"use strict";const BaseModule=__webpack_require__("./js/modules/basemodule.js"),baseutils=__webpack_require__("./js/modules/baseutils.js"),BisWebImage=__webpack_require__("./js/dataobjects/bisweb_image.js");module.exports=class extends BaseModule{constructor(){super(),this.JSOnly=!0,this.name="combineImages"}createDescription(){return{name:"Math Operations",description:"Performs Math Operations on a pair of Images",author:"Xenios Papademetris",version:"1.0",inputs:[{type:"image",name:"Input 1",description:"The first input image",varname:"input",shortname:"i",required:!0,guiviewerinput:"image",guiviewer:"viewer1"},{type:"image",name:"Input 2",description:"The second input image",varname:"second",shortname:"s",required:!0,guiviewerinput:"image",guiviewer:"viewer2"}],outputs:baseutils.getImageToImageOutputs("The combined image","viewer2","overlay"),buttonName:"Execute",shortname:"comb",params:[{name:"Operation",description:"Operation to perform (one of add,subtract,multiply,divide)",priority:1,advanced:!1,gui:"dropdown",default:"add",type:"string",fields:["add","subtract","multiply","divide","append","scaledappend"],restrictAnswer:["add","subtract","multiply","divide","append","scaledappend"],varname:"mode"},{name:"Weight 1",description:"Scalar to multiply Image 1 before operation",priority:10,advanced:!0,gui:"slider",varname:"weight1",default:1,type:"int",low:-100,high:100,step:.1},{name:"Weight 2",description:"Scalar to multiply Image 2 before operation",priority:10,advanced:!0,gui:"slider",varname:"weight2",default:1,type:"int",low:-100,high:100,step:.1},baseutils.getDebugParam()]}}directInvokeAlgorithm(vals){console.log("oooo invoking: combineImages with vals",JSON.stringify(vals));let first=this.inputs.input,second=this.inputs.second,mode=vals.mode,fdata=first.getImageData(),sdata=second.getImageData(),w1=parseFloat(vals.weight1),w2=parseFloat(vals.weight2);if("append"!==mode&&"scaledappend"!==mode){if(!first.hasSameSizeAndOrientation(second,.01))return Promise.reject("Images have different sizes");let output=new BisWebImage;output.cloneImage(first,{type:"float"});let odata=output.getImageData();for(let i=0;i<fdata.length;i++){let v1=w1*fdata[i],v2=w2*sdata[i];"add"===mode?odata[i]=v1+v2:"subtract"==mode?odata[i]=v1-v2:"multiply"===mode?odata[i]=v1*v2:Math.abs(v2)>.001?odata[i]=v1/v2:odata[i]=0}this.outputs.output=output}else{if(!first.hasSameSizeAndOrientation(second,.01,!0))return Promise.reject("Images have different sizes");let dim=first.getDimensions(),dim2=second.getDimensions(),numframes=dim[3]*dim[4]+dim2[3]*dim2[4],output=new BisWebImage;output.cloneImage(first,{type:"float",numframes:numframes});let odata=output.getImageData();if("scaledappend"!==mode)odata.set(fdata,0),odata.set(sdata,fdata.length);else{for(let i=0;i<fdata.length;i++)odata[i]=fdata[i]*w1;for(let i=0;i<sdata.length;i++)odata[i+fdata.length]=sdata[i]*w2}this.outputs.output=output}return Promise.resolve()}}},"./js/modules/computeCorrelation.js":function(module,exports,__webpack_require__){"use strict";const biswrap=__webpack_require__("./build/wasm/libbiswasm_wrapper.js"),baseutils=__webpack_require__("./js/modules/baseutils.js"),BaseModule=__webpack_require__("./js/modules/basemodule.js");module.exports=class extends BaseModule{constructor(){super(),this.name="computeCorrelation"}createDescription(){return{name:"Compute Correlation",description:"Computes the correlation matrix for an input matrix (pairwise) with weights",author:"Zach Saltzman",version:"1.0",inputs:baseutils.getMatrixToMatrixInputs(!0),outputs:baseutils.getMatrixToMatrixOutputs(),buttonName:"Calculate",shortname:"cor",params:[{name:"Z-Score",description:"Convert correlations to z-score.",priority:1,advanced:!1,gui:"check",type:"boolean",varname:"zscore",default:!0},baseutils.getDebugParam()]}}directInvokeAlgorithm(vals){console.log("oooo invoking: computeCorrelation with vals",JSON.stringify(vals));let weightMatrix=this.inputs.weight||0,input=this.inputs.input;return new Promise((resolve,reject)=>{biswrap.initialize().then(()=>{this.outputs.output=biswrap.computeCorrelationMatrixWASM(input,weightMatrix,{zscore:super.parseBoolean(vals.zscore)},vals.debug),resolve()}).catch(e=>{reject(e.stack)})})}}},"./js/modules/computeGLM.js":function(module,exports,__webpack_require__){"use strict";const biswrap=__webpack_require__("./build/wasm/libbiswasm_wrapper.js"),baseutils=__webpack_require__("./js/modules/baseutils.js"),BaseModule=__webpack_require__("./js/modules/basemodule.js"),numeric=__webpack_require__("./node_modules/numeric/numeric-1.2.6.js");module.exports=class extends BaseModule{constructor(){super(),this.name="computeGLM"}createDescription(){let des={name:"Compute GLM",description:"Calculates the Generalized linear model (GLM) for fMRI data sets",author:"Zach Saltzman",version:"1.0",outputs:baseutils.getImageToImageOutputs("Output beta map image"),buttonName:"Calculate",shortname:"glm",params:[{name:"Num Tasks",description:"How many of the actual columns in the regressor are actual tasks -- if 0 then all.",priority:1,advanced:!1,gui:"slider",type:"int",varname:"numtasks",default:0,low:0,high:20},baseutils.getDebugParam()]};return des.inputs=baseutils.getImageToImageInputs("Load the image to fit the model to"),des.inputs.push(baseutils.getRegressorInput()),des.inputs.push({type:"image",name:"Load Mask Image",description:"Load the mask for the input",varname:"mask",required:!1}),des}directInvokeAlgorithm(vals){return console.log("oooo invoking: computeGLM with vals",JSON.stringify(vals)),new Promise((resolve,reject)=>{let input=this.inputs.input,mask=this.inputs.mask||0,usemask=!1;mask&&(usemask=!0);let regressor=this.inputs.regressor,sz=numeric.dim(regressor),numtasks=parseInt(vals.numtasks);(numtasks<=0||numtasks>=sz[1])&&(numtasks=sz[1]),biswrap.initialize().then(()=>{this.outputs.output=biswrap.computeGLMWASM(input,mask,regressor,{numtasks:numtasks,usemask:usemask},vals.debug),resolve()}).catch(e=>{reject(e.stack)})})}}},"./js/modules/computeROI.js":function(module,exports,__webpack_require__){"use strict";const biswrap=__webpack_require__("./build/wasm/libbiswasm_wrapper.js"),baseutils=__webpack_require__("./js/modules/baseutils.js"),BaseModule=__webpack_require__("./js/modules/basemodule.js");module.exports=class extends BaseModule{constructor(){super(),this.name="computeROI"}createDescription(){let des={name:"Compute ROI",description:"Takes an input time series and ROI map and returns the mean intensity in the roi as a matrix of frames(rows)*roiindex(columns)",author:"Zach Saltzman",version:"1.0",inputs:baseutils.getImageToImageInputs("Load the image (time series) to be averaged into regions"),outputs:baseutils.getMatrixToMatrixOutputs(),buttonName:"Calculate",shortname:"roi",params:[baseutils.getDebugParam()]};return des.inputs.push({type:"image",name:"Load Regions of Interest",description:"parcellation/regions of interest to compute signal averages for",varname:"roi",shortname:"r"}),des}directInvokeAlgorithm(vals){return console.log("oooo invoking: computeROI with values",JSON.stringify(vals)),new Promise((resolve,reject)=>{let input=this.inputs.input;biswrap.initialize().then(()=>{this.outputs.output=biswrap.computeROIWASM(input,this.inputs.roi,super.parseBoolean(vals.debug)),resolve()}).catch(e=>{reject(e.stack)})})}}},"./js/modules/cropImage.js":function(module,exports,__webpack_require__){"use strict";const biswrap=__webpack_require__("./build/wasm/libbiswasm_wrapper.js"),baseutils=__webpack_require__("./js/modules/baseutils.js"),BaseModule=__webpack_require__("./js/modules/basemodule.js");module.exports=class extends BaseModule{constructor(){super(),this.name="cropImage",this.lastInputDimensions=[0,0,0,0,0]}createDescription(){let createParam=function(axis,name,shortname,value,p,adv=!1){return{name:`${axis.toUpperCase()}-${name}`,description:`The ${name} along the ${axis} axis.`,priority:p,advanced:adv,gui:"slider",varname:shortname,type:"int",default:value,low:-10,high:200}};return{name:"Crop",description:"This algorithm performs image cropping",author:"Xenios Papdemetris",version:"1.0",inputs:baseutils.getImageToImageInputs("Load the image to be cropped"),outputs:baseutils.getImageToImageOutputs(),buttonName:"Crop",shortname:"crp",params:[createParam("i","Start","i0",0,1),createParam("i","End","i1",10,2),createParam("i","Step","di",1,20,!0),createParam("j","Start","j0",0,4),createParam("j","End","j1",10,5),createParam("j","Step","dj",1,21,!0),createParam("k","Start","k0",0,7),createParam("k","End","k1",10,8),createParam("k","Step","dk",1,22,!0),createParam("t","Start","t0",0,10,!0),createParam("t","End","t1",10,11,!0),createParam("t","Step","dt",1,23,!0),baseutils.getDebugParam()]}}directInvokeAlgorithm(vals){let input=this.inputs.input;return console.log("oooo invoking: cropImage with vals",JSON.stringify(vals)),new Promise((resolve,reject)=>{biswrap.initialize().then(()=>{this.outputs.output=biswrap.cropImageWASM(input,{i0:parseInt(vals.i0),i1:parseInt(vals.i1),di:parseInt(vals.di),j0:parseInt(vals.j0),j1:parseInt(vals.j1),dj:parseInt(vals.dj),k0:parseInt(vals.k0),k1:parseInt(vals.k1),dk:parseInt(vals.dk),t0:parseInt(vals.t0),t1:parseInt(vals.t1),dt:parseInt(vals.dt)},super.parseBoolean(vals.debug)),resolve()}).catch(e=>{reject(e.stack)})})}updateOnChangedInput(inputs,guiVars=null){let newDes=this.getDescription(),img=(inputs=inputs||this.inputs).input||null;if(null===img)return newDes;let dim=img.getDimensions();if(this.compareArrays(dim,this.lastInputDimensions)<1)return;this.lastInputDimensions=dim;let extra=[0,0,0,dim[3]];for(let i=0;i<=2;i++)extra[i]=Math.round(dim[i]/5);let bounds=["i0","i1","j0","j1","k0","k1","t0","t1"],incrs=["di","dj","dk","dt"];for(let i=0;i<newDes.params.length;i++){let name=newDes.params[i].varname,index=bounds.indexOf(name);if(index>=0){let axis=Math.floor(index/2),high=index-2*axis;if(axis<=2)high>0?(newDes.params[i].low=0,newDes.params[i].high=dim[axis]+extra[axis]-1,newDes.params[i].default=dim[axis]-1):(newDes.params[i].low=-extra[axis],newDes.params[i].high=dim[axis]-1,newDes.params[i].default=0);else{let highv=dim[3]-1;newDes.params[i].default=0,newDes.params[i].low=0,newDes.params[i].high=highv,high>0&&dim[3]>1?newDes.params[i].default=dim[3]-1:newDes.params[i].default=0,newDes.params[i].step=1}}else if((index=incrs.indexOf(name))>=0){let axis=Math.floor(index);newDes.params[i].low=1,newDes.params[i].high=extra[axis],newDes.params[i].default=1}guiVars&&(guiVars[name]=newDes.params[i].default)}return this.recreateGUI=!0,newDes}}},"./js/modules/defaceImage.js":function(module,exports,__webpack_require__){"use strict";const biswrap=__webpack_require__("./build/wasm/libbiswasm_wrapper.js"),BaseModule=__webpack_require__("./js/modules/basemodule.js"),baseutils=__webpack_require__("./js/modules/baseutils.js"),BisWebImage=__webpack_require__("./js/dataobjects/bisweb_image.js"),genericio=__webpack_require__("./js/core/bis_genericio.js"),xformutil=__webpack_require__("./js/legacy/bis_transformationutil.js");module.exports=class extends BaseModule{constructor(){super(),this.name="defaceImage",this.outputmask=!1,this.JSOnly=!0}createDescription(){let m=this.outputmask;return{name:"Deface",description:"This module uses data from the openfmri project to deface an image by first affinely registering it to a template",author:"Xenios Papademetris",version:"1.0",inputs:baseutils.getImageToImageInputs(),outputs:baseutils.getImageToImageOutputs(null,"viewer1","overlay"),buttonName:"Deface",shortname:"defaced",params:[{name:"Resolution",description:"Factor to reduce the resolution prior to registration",priority:1,advanced:!0,gui:"slider",type:"float",varname:"resolution",default:3,low:1,high:5},{name:"Iterations",description:"Number of iterations (per level)",priority:2,advanced:!0,gui:"slider",type:"int",varname:"iterations",low:1,high:32,step:1,default:5},{name:"Levels",description:"Number of levels in multiresolution optimization",priority:3,advanced:!1,default:2,type:"int",gui:"slider",varname:"levels",low:1,high:4,step:1},{name:"Smoothing",description:"Amount of image smoothing to perform",priority:4,advanced:!0,type:"float",gui:"slider",varname:"imagesmoothing",default:2,low:0,high:4,step:.5},{name:"Output Mask",description:"If true output the mask",priority:5,advanced:!0,gui:"check",varname:"outputmask",type:"boolean",default:m},baseutils.getDebugParam()]}}directInvokeAlgorithm(vals){console.log("oooo invoking: defaceImage with vals",JSON.stringify(vals));let input=this.inputs.input,images=[new BisWebImage,new BisWebImage],imagepath=genericio.getimagepath();return new Promise((resolve,reject)=>{Promise.all([images[0].load(`${imagepath}/mean_reg2mean.nii.gz`),images[1].load(`${imagepath}/facemask_char.nii.gz`),biswrap.initialize()]).then(()=>{let initial=0,centeronrefonly=!1;input.getOrientationName()!==images[0].getOrientationName()&&(centeronrefonly=!0,initial=xformutil.computeHeaderTransformation(input,images[0],!1));let matr=biswrap.runLinearRegistrationWASM(input,images[0],initial,{intscale:1,numbins:64,levels:parseInt(vals.levels),centeronrefonly:this.parseBoolean(centeronrefonly),smoothing:parseFloat(vals.imagesmoothing),optimization:2,stepsize:1,metric:3,steps:1,iterations:parseInt(vals.iterations),mode:3,resolution:parseFloat(vals.resolution),normalize:!0,debug:!0,return_vector:!1},this.parseBoolean(vals.debug)),temp=baseutils.resliceRegistrationOutput(biswrap,input,images[1],matr,1,0);if(this.parseBoolean(vals.outputmask)){let output=new BisWebImage;output.cloneImage(temp,{type:"uchar"});let odat=output.getImageData(),tdat=temp.getImageData(),l=tdat.length;for(let i=0;i<l;i++)tdat[i]<50?odat[i]=0:odat[i]=1;this.outputs.output=output}else{let output=new BisWebImage;output.cloneImage(input);let idat=input.getImageData(),odat=output.getImageData(),tdat=temp.getImageData(),dm=output.getDimensions(),volumesize=dm[0]*dm[1]*dm[2],numframes=dm[3]*dm[4],count=0;for(let i=0;i<volumesize;i++)if(tdat[i]<50){count+=1;for(let f=0;f<numframes;f++)odat[f*volumesize+i]=0}else for(let f=0;f<numframes;f++)odat[f*volumesize+i]=idat[f*volumesize+i];console.log("Done masked=",count,"/",volumesize," voxels"),this.outputs.output=output}resolve()}).catch(e=>{reject(e.stack)})})}}},"./js/modules/displacementField.js":function(module,exports,__webpack_require__){"use strict";const biswrap=__webpack_require__("./build/wasm/libbiswasm_wrapper.js"),baseutils=__webpack_require__("./js/modules/baseutils.js"),BaseModule=__webpack_require__("./js/modules/basemodule.js"),BisWebTransformCollection=__webpack_require__("./js/dataobjects/bisweb_transformationcollection.js");module.exports=class extends BaseModule{constructor(){super(),this.name="displacementField"}createDescription(){let des={name:"Displacement Field",description:"Calculates the displacement field for a given transformation for the volume specified by the given image.",author:"Zach Saltzman",version:"1.0",outputs:baseutils.getImageToImageOutputs("Output displacement field image"),inputs:baseutils.getImageToImageInputs("Image that defines the output size"),buttonName:"Calculate",shortname:"dsp",params:[baseutils.getDebugParam()]};return des.inputs.push({type:"transform",name:"Transformation 1",description:"Load the transformation to compute the displacement field for",varname:"xform",required:!0,shortname:"x"},{type:"transform",name:"Transformation 2",description:"The second transformation to combine with first",varname:"xform2",required:!1,shortname:"y"},{type:"transform",name:"Transformation 3",description:"The third transformation to combine with first and second",varname:"xform3",required:!1,shortname:"z"}),des}directInvokeAlgorithm(vals){return console.log("oooo invoking: displacementField",JSON.stringify(vals)),new Promise((resolve,reject)=>{biswrap.initialize().then(()=>{let image=this.inputs.input||null,dimension=image.getDimensions(),spacing=image.getSpacing(),xform=this.inputs.xform||null,xform2=this.inputs.xform2||null,xform3=this.inputs.xform3||null;if(null!==xform&&null!==image||reject("Either no image or no transformation specified"),xform2||xform3){let coll=new BisWebTransformCollection;coll.addTransformation(xform),xform2&&coll.addTransformation(xform2),xform3&&coll.addTransformation(xform3),xform=coll}this.outputs.output=biswrap.computeDisplacementFieldWASM(xform,{dimensions:[dimension[0],dimension[1],dimension[2]],spacing:[spacing[0],spacing[1],spacing[2]]},vals.debug),resolve()}).catch(e=>{reject(e.stack)})})}}},"./js/modules/extractFrame.js":function(module,exports,__webpack_require__){"use strict";const biswrap=__webpack_require__("./build/wasm/libbiswasm_wrapper.js"),baseutils=__webpack_require__("./js/modules/baseutils.js"),BaseModule=__webpack_require__("./js/modules/basemodule.js"),smoothreslice=__webpack_require__("./js/legacy/bis_imagesmoothreslice.js");module.exports=class extends BaseModule{constructor(){super(),this.name="extractFrame",this.lastInputDimensions=[0,0,0,0,0]}createDescription(){return{name:"Extract Frame",description:"This element will extract a single frame from a time-series.",author:"Zach Saltzman",version:"1.0",inputs:baseutils.getImageToImageInputs(),outputs:baseutils.getImageToImageOutputs(),buttonName:"Extract",shortname:"fr",params:[{name:"Frame",description:"Which frame in the time series to extract (fourth dimension)",priority:1,advanced:!1,gui:"slider",type:"int",varname:"frame",default:0},{name:"Component",description:"Which component to extract a frame from (fifth dimension)",priority:2,advanced:!0,gui:"slider",type:"int",varname:"component",default:0},{name:"UseWASM",description:"If true (default) use Web-assembly implementation, else pure JS",priority:1001,advanced:!0,gui:"check",varname:"usewasm",type:"boolean",default:!0},baseutils.getDebugParam()]}}directInvokeAlgorithm(vals){console.log("oooo invoking: extractFrame with vals",JSON.stringify(vals));let input=this.inputs.input;return vals.usewasm?new Promise((resolve,reject)=>{biswrap.initialize().then(()=>{this.outputs.output=biswrap.extractImageFrameWASM(input,{frame:parseInt(vals.frame,10),component:parseInt(vals.component,10)},vals.debug),resolve()}).catch(e=>{reject(e.stack)})}):new Promise((resolve,reject)=>{vals.debug&&console.log("oooo \t using pure JS implementation\noooo");let dim=input.getDimensions(),frame=vals.frame+vals.component*dim[3],out=smoothreslice.imageExtractFrame(input,frame);null!==out&&(this.outputs.output=out,resolve()),reject("Failed to extract frame in JS")})}updateOnChangedInput(inputs,guiVars=null){let newDes=this.getDescription(),img=(inputs=inputs||this.inputs).input||null;if(null===img)return;let dim=img.getDimensions();if(!(this.compareArrays(dim,this.lastInputDimensions,3,4)<1)){this.lastInputDimensions=dim;for(let i=0;i<newDes.params.length;i++){let name=newDes.params[i].varname;"frame"!==name&&"component"!==name||("frame"===name?(newDes.params[i].low=0,dim[3]>1?newDes.params[i].high=dim[3]-1:newDes.params[i].high=1):"component"===name&&(newDes.params[i].low=0,dim[4]>1?newDes.params[i].high=dim[4]-1:newDes.params[i].high=1)),guiVars&&(guiVars[name]=newDes.params[i].default)}return this.recreateGUI=!0,newDes}}}},"./js/modules/extractSlice.js":function(module,exports,__webpack_require__){"use strict";const biswrap=__webpack_require__("./build/wasm/libbiswasm_wrapper.js"),baseutils=__webpack_require__("./js/modules/baseutils.js"),BaseModule=__webpack_require__("./js/modules/basemodule.js");module.exports=class extends BaseModule{constructor(){super(),this.name="extractSlice",this.lastInputDimensions=[0,0,0]}createDescription(){return{name:"Extract Slice",description:"This element will extract a slice from a single frame of a time-series.",author:"Zach Saltzman",version:"1.0",inputs:baseutils.getImageToImageInputs(),outputs:baseutils.getImageToImageOutputs(),buttonName:"Extract",shortname:"sl",params:[{name:"Plane",description:"Which plane to extract from the image (0 = Sagittal, 1 = Coronal, 2 = Axial)",priority:1,advanced:!1,gui:"slider",varname:"plane",type:"int",default:2,restrictAnswer:[0,1,2],low:0,high:2},{name:"Slice",description:"Which slice in the given plane to extract",priority:2,advanced:!1,gui:"slider",type:"int",default:-1,varname:"slice"},{name:"Frame",description:"Which frame in the input image to extract (fourth dimension)",priority:3,advanced:!1,gui:"slider",type:"int",default:0,varname:"frame"},{name:"Component",description:"Which component to extract a frame from (fifth dimension)",priority:4,advanced:!0,gui:"slider",type:"int",default:0,varname:"component"},baseutils.getDebugParam()]}}directInvokeAlgorithm(vals){return console.log("oooo invoking: extractSlice with vals",JSON.stringify(vals)),new Promise((resolve,reject)=>{let input=this.inputs.input;biswrap.initialize().then(()=>{this.outputs.output=biswrap.extractImageSliceWASM(input,{frame:parseInt(vals.frame,10),component:parseInt(vals.component,10),slice:parseInt(vals.slice),plane:parseInt(vals.plane)},vals.debug),resolve()}).catch(e=>{reject(e.stack)})})}updateOnChangedInput(inputs,guiVars=null){let newDes=this.getDescription(),img=(inputs=inputs||this.inputs).input||null;if(null===img)return newDes;let dim=img.getDimensions();if(this.compareArrays(dim,this.lastInputDimensions,0,2)<1)return;this.lastInputDimensions=dim;let maxd=Math.max(dim[0],dim[1],dim[2])-1;for(let i=0;i<newDes.params.length;i++){let name=newDes.params[i].varname;"slice"!==name&&"frame"!==name&&"component"!==name||("slice"===name?(newDes.params[i].low=0,newDes.params[i].high=maxd,newDes.params[i].default=Math.round(maxd/2)):"frame"===name?(newDes.params[i].low=0,newDes.params[i].high=dim[3]-1):"component"===name&&(newDes.params[i].low=0,newDes.params[i].high=dim[4]-1),guiVars&&(guiVars[name]=newDes.params[i].default))}return this.recreateGUI=!0,newDes}}},"./js/modules/flipImage.js":function(module,exports,__webpack_require__){"use strict";const biswrap=__webpack_require__("./build/wasm/libbiswasm_wrapper.js"),baseutils=__webpack_require__("./js/modules/baseutils.js"),BaseModule=__webpack_require__("./js/modules/basemodule.js");module.exports=class extends BaseModule{constructor(){super(),this.name="flipImage"}createDescription(){return{name:"Flip",description:"This algorithm performes image fliping",author:"Xenios Papdemetris",version:"1.0",inputs:baseutils.getImageToImageInputs("Load the image to be fliped"),outputs:baseutils.getImageToImageOutputs(),buttonName:"Flip",shortname:"flp",params:[{name:"Flip the i-axis",description:"Determines if the i-axis (x) will be flipped",priority:1,advanced:!1,gui:"check",varname:"flipi",type:"boolean",default:!1},{name:"Flip the j-axis",description:"Determines if the j-axis (y) will be flipped",priority:1,advanced:!1,gui:"check",varname:"flipj",type:"boolean",default:!1},{name:"Flip the k-axis",description:"Determines if the k-axis (z) will be flipped",priority:1,advanced:!1,gui:"check",varname:"flipk",type:"boolean",default:!1},baseutils.getDebugParam()]}}directInvokeAlgorithm(vals){return console.log("oooo invoking: flipImage with vals",JSON.stringify(vals)),new Promise((resolve,reject)=>{let input=this.inputs.input;biswrap.initialize().then(()=>{this.outputs.output=biswrap.flipImageWASM(input,{flipi:super.parseBoolean(vals.flipi),flipj:super.parseBoolean(vals.flipj),flipk:super.parseBoolean(vals.flipk)},super.parseBoolean(vals.debug)),resolve()}).catch(e=>{reject(e.stack)})})}}},"./js/modules/functionalConnectivityPreprocessing.js":function(module,exports,__webpack_require__){"use strict";const biswrap=__webpack_require__("./build/wasm/libbiswasm_wrapper.js"),baseutils=__webpack_require__("./js/modules/baseutils.js"),BaseModule=__webpack_require__("./js/modules/basemodule.js"),BisWebMatrix=__webpack_require__("./js/dataobjects/bisweb_matrix.js");module.exports=class extends BaseModule{constructor(){super(),this.name="funcConnectivityPreprocessing"}createDescription(){return{name:"functional Preprocessing",description:"Takes an input time series and ROI map and Nuisance Map and Motion Matrix and Filter Matrix and returns a clean time series  matrix",author:"Xenios Papademetris",version:"1.0",buttonName:"Calculate",shortname:"conn",inputs:[{type:"image",name:"Input Time series Image",description:"The image to compute on",varname:"input",shortname:"i",required:!0,guiviewerinput:"image",guiviewer:"viewer1"},{type:"image",name:"Parcellation",description:"The parcellation image",varname:"parcellation",shortname:"p",required:!0,guiviewertype:"overlay",guiviewer:"viewer1",colortype:"Orange"},{type:"image",name:"Nuisance Mask",description:"The nuisance mask",varname:"nuisance",shortname:"n",guiviewertype:"overlay",guiviewer:"viewer1",colortype:"Red",required:!1},{type:"matrix",name:"Motion",description:"The motion regressor matrix",varname:"motion",shortname:"m",required:!1},{type:"vector",name:"Weights",description:"(Optional). The framewise weight vector",varname:"weight",shortname:"w",required:!1}],outputs:[{type:"matrix",name:"Filtered Matrix",description:"The final filtered timeseries matrix",varname:"output",shortname:"f",extension:".matr"}],params:[{name:"Low Frequency",description:"Lowpass cutoff frequency of filter (in Hertz)",priority:2,advanced:!1,gui:"slider",type:"float",varname:"low",low:0,high:10,default:.1},{name:"High Frequency",description:"Highpass cutoff frequency of filter (in Hertz)",priority:2,advanced:!1,gui:"slider",type:"float",varname:"high",low:0,high:10,default:.01},{name:"Sample Rate",description:"Data time of repetition (Data TR)",priority:3,advanced:!1,gui:"slider",type:"float",varname:"tr",default:1,low:.01,high:5},{name:"Remove Global Signal",description:"Determines whether global signal is removed",priority:7,advanced:!0,gui:"check",varname:"globalsignal",type:"boolean",default:!0},baseutils.getDebugParam()]}}directInvokeAlgorithm(vals){console.log("oooo invoking: computefunctionalCOnnectivityPreprocessing with values",JSON.stringify(vals));let input=this.inputs.input,parcellation=this.inputs.parcellation,weightVector=this.inputs.weight||0,nuisance=this.inputs.nuisance||0,motion=this.inputs.motion||0,debug=super.parseBoolean(vals.debug);return new Promise((resolve,reject)=>{input.hasSameSizeAndOrientation(parcellation,.01,!0)||reject("Parcellation and Image have different dimensions"),0!==nuisance&&(input.hasSameSizeAndOrientation(nuisance,.01,!0)||reject("Nuisance parcellation and Image have different dimensions"));let numframes=input.getDimensions()[3];0!==weightVector&&weightVector.getDimensions()[0]!==numframes&&reject("Weight vector does not have the same number of rows as timeseries frames"),0!==motion&&motion.getDimensions()[0]!==numframes&&reject("Motion matrix does not have the same number of rows as timeseries frames"),biswrap.initialize().then(()=>{let original={};if(console.log("oooo ROI analysis on parcellation"),original.signal=biswrap.computeROIWASM(input,parcellation,debug),vals.globalsignal){console.log("oooo Thresholding to create gray matter mask");let graymatter=biswrap.thresholdImageWASM(input,{low:1,high:1e4,replacein:!0,replaceout:!0,invalue:1,outvalue:0},debug);console.log("oooo ROI analysis on gray matter (global signal)"),original.global=biswrap.computeROIWASM(input,graymatter,debug)}nuisance&&(console.log("oooo ROI analysis on nuisance mask (e.g. white/csf)"),original.badsignal=biswrap.computeROIWASM(input,nuisance,debug)),motion&&(original.motion=motion);let filtered={},keys=Object.keys(original);for(let i=0;i<keys.length;i++){let name=keys[i];console.log("oooo Butterworth Filtering ",name);let lowpasstmp=biswrap.butterworthFilterWASM(original[name],{type:"low",cutoff:parseFloat(vals.low),samplerate:parseFloat(vals.tr)},debug);filtered[name]=biswrap.butterworthFilterWASM(lowpasstmp,{type:"high",cutoff:parseFloat(vals.high),samplerate:parseFloat(vals.tr)},debug)}let regressor=this.combineMatrices(filtered,numframes,"signal");this.outputs.output=biswrap.weightedRegressOutWASM(filtered.signal,regressor,weightVector,debug),resolve()}).catch(e=>{reject(e.stack)})})}combineMatrices(filtered,numframes,exclude="signal"){let keys=Object.keys(filtered);console.log("Combining regressor matrices");let dimensions=[numframes,0];for(let i=0;i<keys.length;i++){let name=keys[i];if(name!==exclude){let d=filtered[name].getDimensions();console.log("oooo combining, filtered matrix",name," = ",d.join(",")),dimensions[1]=dimensions[1]+d[1]}}let cols=dimensions[1];console.log("oooo combined dimensions=",name," = ",dimensions.join(","));let regressor=new BisWebMatrix;regressor.allocate(dimensions[0],dimensions[1],0);let data=regressor.getDataArray(),begincol=0;for(let i=0;i<keys.length;i++){let name=keys[i];if("signal"!==name){let numcols=filtered[name].getDimensions()[1],partdata=filtered[name].getDataArray();console.log("oooo combining, filtered matrix",name,", numcols=",cols," beginning at",begincol);for(let row=0;row<numframes;row++){let offset=row*dimensions[1];for(let col=0;col<numcols;col++)data[offset+col+begincol]=partdata[offset+col]}begincol+=numcols}}return regressor}}},"./js/modules/gradientImage.js":function(module,exports,__webpack_require__){"use strict";const biswrap=__webpack_require__("./build/wasm/libbiswasm_wrapper.js"),baseutils=__webpack_require__("./js/modules/baseutils.js"),BaseModule=__webpack_require__("./js/modules/basemodule.js");module.exports=class extends BaseModule{constructor(){super(),this.name="gradientImage"}createDescription(){return{name:"Gradient",description:"This algorithm computes image gradients using a 2D/3D Gaussian kernel",author:"Xenios Papdemetris",version:"1.0",inputs:baseutils.getImageToImageInputs("Input image"),outputs:baseutils.getImageToImageOutputs(),buttonName:"Gradient",shortname:"grad",params:[{name:"Sigma",description:"The gaussian kernel standard deviation (either in voxels or mm)",priority:1,advanced:!1,gui:"slider",varname:"sigma",default:1,type:"float",low:0,high:8},{name:"In mm?",description:"Determines whether kernel standard deviation (sigma) will be measured in millimeters or voxels",priority:7,advanced:!1,gui:"check",varname:"inmm",type:"boolean",default:!0},{name:"Radius Factor",description:"This affects the size of the convolution kernel which is computed as sigma*radius+1",priority:2,advanced:!0,gui:"slider",type:"float",default:2,lowbound:1,highbound:4,varname:"radiusfactor"},baseutils.getDebugParam()]}}directInvokeAlgorithm(vals){return console.log("oooo invoking: gradientImage with vals",JSON.stringify(vals)),new Promise((resolve,reject)=>{let input=this.inputs.input,s=parseFloat(vals.sigma);biswrap.initialize().then(()=>{this.outputs.output=biswrap.gradientImageWASM(input,{sigmas:[s,s,s],inmm:super.parseBoolean(vals.inmm),radiusfactor:parseFloat(vals.radiusfactor)},super.parseBoolean(vals.debug)),resolve()}).catch(e=>{reject(e.stack)})})}}},"./js/modules/linearRegistration.js":function(module,exports,__webpack_require__){"use strict";const biswrap=__webpack_require__("./build/wasm/libbiswasm_wrapper.js"),BaseModule=__webpack_require__("./js/modules/basemodule.js"),baseutils=__webpack_require__("./js/modules/baseutils.js"),genericio=__webpack_require__("./js/core/bis_genericio.js"),xformutil=__webpack_require__("./js/legacy/bis_transformationutil.js");module.exports=class extends BaseModule{constructor(){super(),this.name="linearRegistration",this.useworker=!0}createDescription(){let des={name:"Linear Registration",description:"Computes a linear registration between the reference image and target image. Returns a matrix transformation.",author:"Zach Saltzman",version:"1.0",inputs:baseutils.getRegistrationInputs(),outputs:baseutils.getRegistrationOutputs(),buttonName:"Run",shortname:"lrg",params:baseutils.getRegistrationParams()};return des.params.push(baseutils.getLinearMode("Mode")),des.params.push({name:"Header Orient",description:"use header orientation for initial matrix",priority:10,advanced:!1,type:"boolean",default:!0,varname:"useheader"}),des}directInvokeAlgorithm(vals){console.log("oooo invoking: linearRegistration",JSON.stringify(vals),"\noooo");let target=this.inputs.target,reference=this.inputs.reference,initial=this.inputs.initial||0;"node"!==genericio.getenvironment()&&(vals.doreslice=!0,vals.debug=!0);let useheader=this.parseBoolean(vals.useheader),centeronrefonly=!1;return xformutil.isTransformIdentityOrNULL(initial)?useheader&&reference.getOrientationName()!==target.getOrientationName()&&(centeronrefonly=!0,initial=xformutil.computeHeaderTransformation(reference,target,!1),console.log("oooo Using header to initialize to first reslicing for orientation centeronrefonly=",centeronrefonly)):(centeronrefonly=!0,console.log("oooo an actual initial transformation is specified, assume centeronrefonly=",centeronrefonly)),new Promise((resolve,reject)=>{biswrap.initialize().then(()=>{let matr=biswrap.runLinearRegistrationWASM(reference,target,initial,{intscale:parseInt(vals.intscale),numbins:parseInt(vals.numbins),levels:parseInt(vals.levels),centeronrefonly:this.parseBoolean(centeronrefonly),smoothing:parseFloat(vals.imagesmoothing),optimization:baseutils.getOptimizationCode(vals.optimization),stepsize:parseFloat(vals.stepsize),metric:baseutils.getMetricCode(vals.metric),steps:parseInt(vals.steps),iterations:parseInt(vals.iterations),mode:baseutils.getLinearModeCode(vals.mode),resolution:parseFloat(vals.resolution),normalize:this.parseBoolean(vals.norm),debug:this.parseBoolean(vals.debug),return_vector:!0},this.parseBoolean(vals.debug));this.outputs.output=matr,vals.doreslice?this.outputs.resliced=baseutils.resliceRegistrationOutput(biswrap,reference,target,this.outputs.output):this.outputs.resliced=null,resolve()}).catch(e=>{reject(e.stack)})})}}},"./js/modules/manualRegistration.js":function(module,exports,__webpack_require__){"use strict";const biswrap=__webpack_require__("./build/wasm/libbiswasm_wrapper.js"),baseutils=__webpack_require__("./js/modules/baseutils.js"),BaseModule=__webpack_require__("./js/modules/basemodule.js"),BisWebLinearTransformation=__webpack_require__("./js/dataobjects/bisweb_lineartransformation.js"),xformutil=__webpack_require__("./js/legacy/bis_transformationutil.js");module.exports=class extends BaseModule{constructor(){super(),this.name="manualRegistration",this.JSOnly=!0}createDescription(){return{name:"Manual Registration",description:"This algorithm performes manual image registration",author:"Xenios Papademetris",version:"1.0",inputs:baseutils.getRegistrationInputs(!1),outputs:baseutils.getRegistrationOutputs(),buttonName:"Apply",shortname:"mrg",params:[{name:"Shift I (vx)",description:"I - translation (voxels)",priority:10,advanced:!1,gui:"slider",varname:"shifti",default:0,type:"float",low:-90,high:90,step:.1},{name:"Shift J (vx)",description:"J - translation (voxels)",priority:11,advanced:!1,gui:"slider",varname:"shiftj",default:0,type:"float",low:-90,high:90,step:.1},{name:"Shift K (vx)",description:"K - translation (voxels)",priority:12,advanced:!1,gui:"slider",varname:"shiftk",default:0,type:"float",low:-90,high:90,step:.1},{name:"Rotate I",description:"I - rotation",priority:13,advanced:!1,gui:"slider",varname:"rotatei",default:0,type:"float",low:-90,high:90,step:.1},{name:"Rotate J",description:"J - rotation",priority:14,advanced:!1,gui:"slider",varname:"rotatej",default:0,type:"float",low:-90,high:90,step:.1},{name:"Rotate K",description:"K - rotation",priority:15,advanced:!1,gui:"slider",varname:"rotatek",default:0,type:"float",low:-90,high:90,step:.1},{name:"Scale",description:"Scale Factor",priority:16,advanced:!1,gui:"slider",varname:"scale",default:100,type:"float",low:66,high:133,step:1},{name:"Use Header",description:"use header orientation for initial rotation matrix",priority:9,advanced:!0,type:"boolean",default:!0,varname:"useheader"},{name:"Interpolation",description:"Which type of interpolation to use (3 = cubic, 1 = linear, 0 = nearest-neighbor)",priority:12,advanced:!0,gui:"dropdown",type:"int",default:"1",varname:"interpolation",fields:[0,1,3],restrictAnswer:[0,1,3]},baseutils.getDebugParam()]}}directInvokeAlgorithm(vals){console.log("oooo invoking: manualRegistration with vals",JSON.stringify(vals));let target=this.inputs.target,reference=this.inputs.reference,dim=reference.getDimensions(),spa=reference.getSpacing(),tx=parseFloat(vals.shifti)*spa[0],ty=parseFloat(vals.shiftj)*spa[1],tz=parseFloat(vals.shiftk)*spa[2],rx=parseFloat(vals.rotatei),ry=parseFloat(vals.rotatej),rz=parseFloat(vals.rotatek),sc=parseFloat(vals.scale),linear=new BisWebLinearTransformation(1),dim2=target.getDimensions(),spa2=target.getSpacing(),interp=parseInt(vals.interpolation),useheader=this.parseBoolean(vals.useheader),headertransform=null;return reference.getOrientationName()!==target.getOrientationName()&&useheader?(headertransform=xformutil.computeHeaderTransformation(reference,target),dim2=dim,spa2=spa):useheader=!1,linear.setShifts(dim,spa,dim2,spa2),linear.setParameterVector([tx,ty,tz,rx,ry,rz,sc],{scale:!0,rigidOnly:!1}),useheader?(this.outputs.output=xformutil.computeCombinedTransformation(linear,headertransform),linear=this.outputs.output):this.outputs.output=linear,new Promise((resolve,reject)=>{biswrap.initialize().then(()=>{this.outputs.resliced=baseutils.resliceRegistrationOutput(biswrap,reference,target,linear,interp),resolve()}).catch(e=>{reject(e.stack)})})}}},"./js/modules/maskImage.js":function(module,exports,__webpack_require__){"use strict";const baseutils=__webpack_require__("./js/modules/baseutils.js"),BaseModule=__webpack_require__("./js/modules/basemodule.js"),BisWebImage=__webpack_require__("./js/dataobjects/bisweb_image.js");module.exports=class extends BaseModule{constructor(){super(),this.name="maskImage",this.JSOnly=!0,this.lastInputRange=[0,0]}createDescription(){return{name:"Mask Image",description:"This algorithm masks an image",author:"Xenios Papademetris",version:"1.0",buttonName:"Mask",shortname:"msk",inputs:[{type:"image",name:"Input Image",description:"The image to mask",varname:"input",shortname:"i",required:!0,guiviewerinput:"image",guiviewer:"viewer1"},{type:"image",name:"Mask Image",description:"The mask",varname:"mask",shortname:"m",required:!0,guiviewertype:"overlay",guiviewer:"viewer1",colortype:"Orange"}],outputs:baseutils.getImageToImageOutputs(),params:[{name:"Threshold",description:"The threshold below which values will be masked out",priority:1,advanced:!1,gui:"slider",type:"float",varname:"threshold",default:1},{name:"Inverse",description:"If true, mask the image where the mask is not zero",priority:2,advanced:!1,gui:"check",varname:"inverse",type:"boolean",default:!1},baseutils.getDebugParam()]}}directInvokeAlgorithm(vals){console.log("oooo invoking: maskImage",JSON.stringify(vals));let input=this.inputs.input,mask=this.inputs.mask;if(!input.hasSameSizeAndOrientation(mask,.01,!0))return Promise.reject("Images have different sizes");let inverse=super.parseBoolean(vals.inverse),dim=input.getDimensions(),numvoxels=dim[0]*dim[1]*dim[2],numframes=dim[3]*dim[4],output=new BisWebImage;output.cloneImage(input);let idata=input.getImageData(),mdata=mask.getImageData(),odata=output.getImageData(),thr=parseFloat(vals.threshold);if(console.log("oooo Beginning ",numvoxels," thr=",thr),inverse)for(let i=0;i<numvoxels;i++)if(mdata[i]<thr)for(let f=0;f<numframes;f++)odata[i+f*numvoxels]=idata[i+f*numvoxels];else for(let f=0;f<numframes;f++)odata[i+f*numvoxels]=0;else for(let i=0;i<numvoxels;i++)if(mdata[i]>=thr)for(let f=0;f<numframes;f++)odata[i+f*numvoxels]=idata[i+f*numvoxels];else for(let f=0;f<numframes;f++)odata[i+f*numvoxels]=0;return this.outputs.output=output,Promise.resolve()}updateOnChangedInput(inputs,guiVars){let newDes=this.getDescription(),current_input=(inputs=inputs||this.inputs).mask||null;if(null===current_input)return newDes;let imagerange=current_input.getIntensityRange();if(!(this.compareArrays(imagerange,this.lastInputRange,0,1)<1)){this.lastInputRange=imagerange;for(let i=0;i<newDes.params.length;i++){let name=newDes.params[i].varname;"threshold"===name&&(newDes.params[i].low=imagerange[0],newDes.params[i].high=imagerange[1],newDes.params[i].default=.99*imagerange[0]+.01*imagerange[1]),guiVars&&(guiVars[name]=newDes.params[i].default)}return this.recreateGUI=!0,newDes}}}},"./js/modules/moduleindex.js":function(module,exports,__webpack_require__){"use strict";const moduleImports={smoothimage:__webpack_require__("./js/modules/smoothImage.js"),qualitymeasures:__webpack_require__("./js/modules/qualityMeasures.js"),gradientimage:__webpack_require__("./js/modules/gradientImage.js"),thresholdimage:__webpack_require__("./js/modules/thresholdImage.js"),shiftscaleimage:__webpack_require__("./js/modules/shiftScaleImage.js"),changeimagespacing:__webpack_require__("./js/modules/changeImageSpacing.js"),binarythresholdimage:__webpack_require__("./js/modules/binaryThresholdImage.js"),extractslice:__webpack_require__("./js/modules/extractSlice.js"),extractframe:__webpack_require__("./js/modules/extractFrame.js"),normalizeimage:__webpack_require__("./js/modules/normalizeImage.js"),clusterthreshold:__webpack_require__("./js/modules/clusterThreshold.js"),prepareregistration:__webpack_require__("./js/modules/prepareRegistration.js"),resampleimage:__webpack_require__("./js/modules/resampleImage.js"),flipimage:__webpack_require__("./js/modules/flipImage.js"),maskimage:__webpack_require__("./js/modules/maskImage.js"),combineimages:__webpack_require__("./js/modules/combineImages.js"),cropimage:__webpack_require__("./js/modules/cropImage.js"),morphologyfilter:__webpack_require__("./js/modules/morphologyFilter.js"),blankimage:__webpack_require__("./js/modules/blankImage.js"),process4dimage:__webpack_require__("./js/modules/process4DImage.js"),slicebiascorrect:__webpack_require__("./js/modules/sliceBiasFieldCorrect.js"),segmentimage:__webpack_require__("./js/modules/segmentImage.js"),regularizeobjectmap:__webpack_require__("./js/modules/regularizeObjectmap.js"),projectimage:__webpack_require__("./js/modules/projectImage.js"),backprojectimage:__webpack_require__("./js/modules/backProjectImage.js"),butterworthfilter:__webpack_require__("./js/modules/butterworthFilter.js"),regressglobal:__webpack_require__("./js/modules/regressGlobal.js"),regressout:__webpack_require__("./js/modules/regressOut.js"),computecorrelation:__webpack_require__("./js/modules/computeCorrelation.js"),computeroi:__webpack_require__("./js/modules/computeROI.js"),functionalconnectivitypreprocessing:__webpack_require__("./js/modules/functionalConnectivityPreprocessing.js"),computeglm:__webpack_require__("./js/modules/computeGLM.js"),approximatefield:__webpack_require__("./js/modules/approximateField.js"),displacementfield:__webpack_require__("./js/modules/displacementField.js"),resliceimage:__webpack_require__("./js/modules/resliceImage.js"),motionreslice:__webpack_require__("./js/modules/motionReslice.js"),manualregistration:__webpack_require__("./js/modules/manualRegistration.js"),linearregistration:__webpack_require__("./js/modules/linearRegistration.js"),nonlinearregistration:__webpack_require__("./js/modules/nonlinearRegistration.js"),motioncorrection:__webpack_require__("./js/modules/motionCorrection.js"),defaceimage:__webpack_require__("./js/modules/defaceImage.js"),reorientimage:__webpack_require__("./js/modules/reorientImage.js"),tfrecon:__webpack_require__("./js/modules/tfRecon.js")};let createModuleNames=function(modules){let names={},keys=Object.keys(modules);for(let i=0;i<keys.length;i++){let key=keys[i];names[key.toLowerCase()]=key}return names},moduleNames=createModuleNames(moduleImports);module.exports={getModule:function(toolname){let newmodulecommand=moduleImports[toolname.toLowerCase()];return void 0===newmodulecommand?null:new newmodulecommand},getModuleNames:function(){return Object.keys(moduleNames)},createModuleNames:createModuleNames}},"./js/modules/morphologyFilter.js":function(module,exports,__webpack_require__){"use strict";const biswrap=__webpack_require__("./build/wasm/libbiswasm_wrapper.js"),BaseModule=__webpack_require__("./js/modules/basemodule.js"),baseutils=__webpack_require__("./js/modules/baseutils.js"),BisWebImage=__webpack_require__("./js/dataobjects/bisweb_image.js");module.exports=class extends BaseModule{constructor(){super(),this.name="morphologyFilter",this.mouseobserver=!0,this.lastInputDimensions=[0,0,0]}createDescription(){return{name:"Morphology Filtering",description:"Performs Binary Morphology Filtering on an Image",author:"Xenios Papademetris",version:"1.0",inputs:baseutils.getImageToImageInputs("The binary mask to be filtered","viewer1","overlay"),outputs:baseutils.getImageToImageOutputs("The output mask","viewer1","overlay"),buttonName:"Execute",shortname:"mrph",params:[{name:"Operation",description:"Operation to perform (one of erode,dilate,median,erodedilate,dilateerode)",priority:1,advanced:!1,gui:"dropdown",default:"median",type:"string",fields:["dilate","erode","median","connect","dilateerode","erodedilate"],restrictAnswer:["dilate","erode","median","connect","dilateerode","erodedilate"],varname:"mode"},{name:"Radius",description:"This filter radius in voxels",priority:2,advanced:!1,gui:"slider",type:"int",low:1,high:3,default:1,step:1,varname:"radius"},{name:"Do 3D",description:"If true (default) do 3d filtering, else 2d",priority:3,advanced:!0,gui:"check",type:"boolean",varname:"do3d",default:!0},{name:"Seed I (vx)",description:"I - seed",priority:10,advanced:!0,gui:"slider",varname:"seedi",default:50,type:"int",low:0,high:100,step:1},{name:"Seed J (vx)",description:"J - seed",priority:11,advanced:!0,gui:"slider",varname:"seedj",default:50,type:"int",low:0,high:100,step:1},{name:"Seed K (vx)",description:"K - seed",priority:12,advanced:!0,gui:"slider",varname:"seedk",default:50,type:"int",low:0,high:100,step:1},baseutils.getDebugParam()]}}directInvokeAlgorithm(vals){console.log("oooo invoking: morphologyFilter with vals",JSON.stringify(vals));let input=this.inputs.input;return new Promise((resolve,reject)=>{biswrap.initialize().then(()=>{let mode=vals.mode,md=[mode];"dilateerode"===mode?md=["dilate","erode"]:"erodedilate"==mode&&(md=["erode","dilate"]);let tmp=input;if("uchar"!==input.getImageType()){console.log("oooo thresholding and casting to uchar as input type is not uchar"),(tmp=new BisWebImage).cloneImage(input,{type:"uchar"});let odata=tmp.getImageData(),idata=input.getImageData();for(let i=0;i<idata.length;i++)idata[i]>0?odata[i]=1:odata[i]=0}for(let pass=0;pass<md.length;pass++)"connect"!==md[pass]?(this.outputs.output=biswrap.morphologyOperationWASM(tmp,{operation:md[pass],radius:parseInt(vals.radius),do3d:this.parseBoolean(vals.do3d)},this.parseBoolean(vals.debug)),tmp=this.outputs.output):this.outputs.output=biswrap.seedConnectivityWASM(tmp,{seedi:parseInt(vals.seedi),seedj:parseInt(vals.seedj),seedk:parseInt(vals.seedk),oneconnected:!0},this.parseBoolean(vals.debug));resolve()}).catch(e=>{reject(e.stack)})})}updateOnChangedInput(inputs,guiVars){let newDes=this.getDescription(),img=(inputs=inputs||this.inputs).input||null;if(null===img)return newDes;let dim=img.getDimensions();if(this.compareArrays(dim,this.lastInputDimensions,0,2)<1)return;this.lastInputDimensions=dim;let names=["seedi","seedj","seedk"];for(let i=0;i<newDes.params.length;i++){let name=newDes.params[i].varname,index=names.indexOf(name);index>=0&&(newDes.params[i].low=0,newDes.params[i].high=dim[index]-1,newDes.params[i].default=Math.round((dim[index]-1)/2)),guiVars&&(guiVars[name]=newDes.params[i].default)}return this.recreateGUI=!0,newDes}setViewerCoordinates(controllers,guivars,coords=null){if(null===coords)return;if(!guivars)return;let newDes=this.getDescription(),names=["seedi","seedj","seedk"];for(let i=0;i<newDes.params.length;i++){let name=newDes.params[i].varname,index=names.indexOf(name);if(index>=0)try{guivars[name]=coords[index],this.updateSingleGUIElement(newDes.params[i],controllers[name],guivars,name)}catch(e){console.log(e.stack)}}}}},"./js/modules/motionCorrection.js":function(module,exports,__webpack_require__){"use strict";const biswrap=__webpack_require__("./build/wasm/libbiswasm_wrapper.js"),BaseModule=__webpack_require__("./js/modules/basemodule.js"),baseutils=__webpack_require__("./js/modules/baseutils.js"),smoothreslice=__webpack_require__("./js/legacy/bis_imagesmoothreslice.js"),BisWebImage=__webpack_require__("./js/dataobjects/bisweb_image.js"),BisWebDataObjectCollection=__webpack_require__("./js/dataobjects/bisweb_dataobjectcollection.js");module.exports=class extends BaseModule{constructor(){super(),this.name="motionCorrection",this.JSOnly=!0,this.useworker=!0}getDescription(){let des={name:"Motion Correction",description:"Runs motion correction",author:"Michelle Lim",version:"1.0",buttonName:"Execute",shortname:"mot",inputs:baseutils.getRegistrationInputs(),outputs:baseutils.getRegistrationOutputs(),params:baseutils.getRegistrationParams()};return des.params.push({name:"Reference Frame Number",description:"Frame number of reference image used for linear registration",priority:12,advanced:!1,gui:"slider",type:"int",varname:"refno",default:0}),baseutils.setParamDefaultValue(des.params,"metric","CC"),baseutils.setParamDefaultValue(des.params,"numbins",1024),baseutils.setParamDefaultValue(des.params,"steps",4),baseutils.setParamDefaultValue(des.params,"resolution",1.01),baseutils.setParamDefaultValue(des.params,"iterations",32),baseutils.setParamDefaultValue(des.params,"levels",3),baseutils.setParamDefaultValue(des.params,"stepsize",.125),baseutils.setParamDefaultValue(des.params,"optimization","HillClimb"),des.outputs[0].type="collection",des.outputs[1].required=!0,des}directInvokeAlgorithm(vals){return console.log("MotionCorrection invoking with vals",JSON.stringify(vals)),new Promise((resolve,reject)=>{let target=this.inputs.target,reference=this.inputs.reference||0;0===reference&&(reference=target),biswrap.initialize().then(()=>{this.outputs.output=this.run_registrations(vals,reference,target,parseInt(vals.refno)),this.outputs.resliced=this.runReslice(target,this.outputs.output),resolve()}).catch(e=>{reject(e.stack)})})}run_registrations(vals,ReferenceImage,InputImage,refno=0){let RefFrameImage=smoothreslice.imageExtractFrame(ReferenceImage,refno),numframes=InputImage.getDimensions()[3],matrices=new BisWebDataObjectCollection;for(let frame=0;frame<numframes;frame++){let debug=!1;1===frame&&(debug=!0);let InputFrame=smoothreslice.imageExtractFrame(InputImage,frame),xform=biswrap.runLinearRegistrationWASM(RefFrameImage,InputFrame,0,{intscale:parseInt(vals.intscale),numbins:parseInt(vals.numbins),levels:parseInt(vals.levels),smoothing:parseFloat(vals.imagesmoothing),optimization:baseutils.getOptimizationCode(vals.optimization),stepsize:parseFloat(vals.stepsize),metric:baseutils.getMetricCode(vals.metric),normalize:this.parseBoolean(vals.norm),steps:parseInt(vals.steps),iterations:parseInt(vals.iterations),mode:baseutils.getLinearModeCode(vals.mode),resolution:parseFloat(vals.resolution),return_vector:"true",debug:debug},debug);frame%25==0&&console.log("++++ Done with frame",frame," p=("+xform.getParameterVector({scale:!0}).join(" ")+")"),matrices.addItem(xform,{frame:frame})}return matrices}runReslice(inputimage,matrices){let output_image=new BisWebImage,dimensions=inputimage.getDimensions(),spacing=inputimage.getSpacing(),numframes=matrices.getNumberOfItems();output_image.cloneImage(inputimage,{dimensions:dimensions,spacing:spacing});let volumesize=dimensions[0]*dimensions[1]*dimensions[2],outdata=output_image.getImageData();for(let frame=0;frame<numframes;frame++){let InputFrame=smoothreslice.imageExtractFrame(inputimage,frame),inp_data=biswrap.resliceImageWASM(InputFrame,matrices.getItemData(frame),{interpolation:3,dimensions:dimensions,spacing:spacing},0).getImageData(),offset=frame*volumesize;for(let i=0;i<volumesize;i++)outdata[i+offset]=inp_data[i];frame%25==0&&console.log("++++ Resliced frame",frame)}return output_image}}},"./js/modules/motionReslice.js":function(module,exports,__webpack_require__){"use strict";const biswrap=__webpack_require__("./build/wasm/libbiswasm_wrapper.js"),BaseModule=__webpack_require__("./js/modules/basemodule.js"),baseutils=__webpack_require__("./js/modules/baseutils.js"),smoothreslice=__webpack_require__("./js/legacy/bis_imagesmoothreslice.js"),BisWebImage=__webpack_require__("./js/dataobjects/bisweb_image.js"),BisWebTransformCollection=__webpack_require__("./js/dataobjects/bisweb_transformationcollection.js"),BisWebLinearTransformation=__webpack_require__("./js/dataobjects/bisweb_lineartransformation.js");module.exports=class extends BaseModule{constructor(){super(),this.name="motionReslice",this.JSOnly=!0,this.useworker=!0}getDescription(){return{name:"Motion Reslices data",description:"Reslices following motion correction",author:"Xenios Papademetris",version:"1.0",buttonName:"Execute",shortname:"motresl",inputs:[{type:"image",name:"Image to Reslice",description:"Load the image to reslice",varname:"input",shortname:"i",required:!0,guiviewertype:this.targetGUIInput,guiviewer:this.targetGUIViewer,colortype:"Orange"},{type:"image",name:"Reference Image",description:"Load the reference image (if not specified use input)",varname:"reference",shortname:"r",required:!1,guiviewertype:"image",guiviewer:"viewer1"},{type:"transformation",name:"Reslice Transform (Atlas->Ref)",description:"Load the transformation used to reslice the image",varname:"xform",shortname:"x",required:!1,guiviewer:"current"},{type:"transform",name:"Transformation 2 (Ref->Conv)",description:"The second transformation to combine with first",varname:"xform2",required:!1,shortname:"y"},{type:"transform",name:"Transformation 3 (Conv->EPI)",description:"The third transformation to combine with first and second",varname:"xform3",required:!1,shortname:"z"},{type:"collection",name:"Motion Correction Collection",description:"The output of the motion Correction",varname:"motionparam",required:!0,shortname:"m"}],outputs:[{type:"image",name:"Output Image",description:"Save the motion resliced image",varname:"output",shortname:"o",required:!1,extension:".nii.gz",guiviewertype:"overlay",guiviewer:"viewer1",colortype:"Orange"}],params:[{name:"Interpolation",description:"Which type of interpolation to use (3 = cubic, 1 = linear, 0 = nearest-neighbor)",priority:1,advanced:!1,gui:"dropdown",type:"int",default:"3",varname:"interpolation",fields:[0,1,3],restrictAnswer:[0,1,3]},{name:"Force Float",description:"If true force output to float",priority:100,advanced:!0,type:"boolean",default:!1,varname:"forcefloat"},{name:"Fill Value",description:"Value to use for outside the image",priority:2,advanced:!0,gui:"slider",type:"float",varname:"backgroundvalue",default:0},{name:"Res factor",description:"The amount to downsample the reference by",priority:2,advanced:!1,gui:"slider",type:"float",varname:"res",default:2,low:1,high:4},baseutils.getDebugParam()]}}directInvokeAlgorithm(vals){return console.log("oooo MotionReslice invoking with vals",JSON.stringify(vals)),new Promise((resolve,reject)=>{let input_image=this.inputs.input||null,reference=this.inputs.reference||input_image,matrices=this.inputs.motionparam||null;input_image&&matrices||reject("Either input or motion params is not specified");let numframes=matrices.getNumberOfItems();input_image.getDimensions()[3]!==numframes&&reject("Either input has different number of frames than motion parameters"),console.log("oooo Motion Parameters=",matrices.getDescription());let output_image=new BisWebImage,dt="same";vals.forcefloat&&(dt="float");let dimensions=reference.getDimensions(),spacing=reference.getSpacing(),res=parseFloat(vals.res);res<.5&&(res=.5),console.log("oooo Original dimensions:",dimensions," spacing:",spacing);for(let i=0;i<=2;i++)dimensions[i]=Math.round(dimensions[i]/res),spacing[i]=spacing[i]*res;console.log("oooo Scaled (",res,") dimensions:",dimensions," spacing:",spacing),output_image.cloneImage(input_image,{dimensions:dimensions,spacing:spacing,numframes:numframes,type:dt}),"float"!==dt&&(dt=-1);let volumesize=dimensions[0]*dimensions[1]*dimensions[2],outdata=output_image.getImageData(),xform=this.inputs.xform||null,xform2=this.inputs.xform2||null,xform3=this.inputs.xform3||null,combinedXform=new BisWebTransformCollection;xform&&combinedXform.addTransformation(xform),xform2&&combinedXform.addTransformation(xform2),xform3&&combinedXform.addTransformation(xform3),combinedXform.addTransformation(new BisWebLinearTransformation);let motionindex=combinedXform.getNumberOfTransformations()-1;console.log("oooo Using ",combinedXform.getNumberOfTransformations()," transformations to reslice"),biswrap.initialize().then(()=>{for(let frame=0;frame<numframes;frame++){let debug=!1;vals.debug&&1===frame&&(debug=!0);let InputFrame=smoothreslice.imageExtractFrame(input_image,frame);combinedXform.setTransformation(motionindex,matrices.getItemData(frame)),debug&&console.log(" In Frame",frame,combinedXform.getDescription());let resliceW=biswrap.resliceImageWASM(InputFrame,combinedXform,{interpolation:parseInt(vals.interpolation),datatype:dt,backgroundValue:parseFloat(vals.backgroundvalue),dimensions:dimensions,spacing:spacing},debug);debug&&console.log(" Resliced Frame",frame,resliceW.getDescription());let inp_data=resliceW.getImageData(),offset=frame*volumesize;for(let i=0;i<volumesize;i++)outdata[i+offset]=inp_data[i];frame%25==0&&vals.debug&&console.log("++++ Resliced frame",frame)}this.outputs.output=output_image,resolve()}).catch(e=>{console.log(e.stack),reject(e)})})}}},"./js/modules/nonlinearRegistration.js":function(module,exports,__webpack_require__){"use strict";const biswrap=__webpack_require__("./build/wasm/libbiswasm_wrapper.js"),BaseModule=__webpack_require__("./js/modules/basemodule.js"),baseutils=__webpack_require__("./js/modules/baseutils.js"),genericio=__webpack_require__("./js/core/bis_genericio.js"),xformutil=__webpack_require__("./js/legacy/bis_transformationutil.js");module.exports=class extends BaseModule{constructor(){super(),this.name="nonlinearRegistration",this.useworker=!0}createDescription(){let des={name:"Non-Linear Registration",description:"Runs non-linear registration using a reference image, target image, and a transformation specified as a transformation. Returns a transformation.",author:"Zach Saltzman",version:"1.0",inputs:baseutils.getRegistrationInputs(),outputs:baseutils.getRegistrationOutputs(),buttonName:"Run",shortname:"nlr",params:baseutils.getRegistrationParams()};return des.params.push(baseutils.getLinearMode("linearmode","","Affine")),des.params.push({name:"CP Spacing",description:"Control Point spacing of the underlying Bspline-FFD Registration",priority:10,advanced:!1,gui:"slider",type:"float",varname:"cps",default:20,low:1,high:60}),des.params.push({name:"Append Mode",description:"If true (default), grids are chained",priority:10,advanced:!1,gui:"check",varname:"append",type:"boolean",default:!0}),des.params.push({name:"CPS Rate",description:"Control Point spacing rate of the underlying Bspline-FFD Registration",priority:100,advanced:!0,gui:"slider",type:"float",varname:"cpsrate",default:2,low:1,high:3}),des.params.push({name:"Smoothness",description:"Extra regularization smoothness term weight",priority:12,advanced:!1,gui:"slider",type:"float",varname:"lambda",default:.001,low:0,high:1}),des.params.push({name:"Header Orient",description:"use header orientation for initial matrix",priority:10,advanced:!1,type:"boolean",default:!0,varname:"useheader"}),baseutils.setParamDefaultValue(des.params,"debug",!0),des}directInvokeAlgorithm(vals){console.log("oooo invoking: nonLinearRegistration",JSON.stringify(vals));let target=this.inputs.target;this.inputs.target=target;let reference=this.inputs.reference,transform=this.inputs.initial||0,linearmode=baseutils.getLinearModeCode(vals.linearmode);return"node"!==genericio.getenvironment()&&(vals.doreslice=!0,vals.debug=!0),new Promise((resolve,reject)=>{biswrap.initialize().then(()=>{let initial=transform,useheader=this.parseBoolean(vals.useheader),centeronrefonly=!1;xformutil.isTransformIdentityOrNULL(initial)?useheader&&reference.getOrientationName()!==target.getOrientationName()&&(centeronrefonly=!0,console.log("oooo Creating orientation mapping transformation to initialize either linear or nonlinear mapping"),initial=xformutil.computeHeaderTransformation(reference,target,!1)):linearmode>=0&&(centeronrefonly=!0,console.log("oooo an actual initial transformation is specified, assume centeronrefonly=",centeronrefonly)),linearmode>=0&&(initial=biswrap.runLinearRegistrationWASM(reference,target,initial,{intscale:parseInt(vals.intscale),numbins:parseInt(vals.numbins),levels:parseInt(vals.levels),centeronrefonly:this.parseBoolean(centeronrefonly),steps:parseInt(vals.steps),stepsize:parseFloat(vals.stepsize),smoothing:parseFloat(vals.imagesmoothing),optimization:baseutils.getOptimizationCode(vals.optimization),metric:baseutils.getMetricCode(vals.metric),iterations:parseInt(vals.iterations),normalize:this.parseBoolean(vals.norm),mode:linearmode,resolution:parseFloat(vals.resolution),debug:this.parseBoolean(vals.debug),return_vector:!1},this.parseBoolean(vals.debug))),this.outputs.output=biswrap.runNonLinearRegistrationWASM(reference,target,initial,{cps:parseFloat(vals.cps),appendmode:this.parseBoolean(vals.append),cpsrate:parseFloat(vals.cpsrate),lambda:parseFloat(vals.lambda),intscale:parseInt(vals.intscale),numbins:parseInt(vals.numbins),levels:parseInt(vals.levels),steps:parseInt(vals.steps),stepsize:parseFloat(vals.stepsize),smoothing:parseFloat(vals.imagesmoothing),optimization:baseutils.getOptimizationCode(vals.optimization),normalize:this.parseBoolean(vals.norm),metric:baseutils.getMetricCode(vals.metric),iterations:parseInt(vals.iterations),resolution:parseFloat(vals.resolution),debug:this.parseBoolean(vals.debug)},this.parseBoolean(vals.debug)),vals.doreslice?(console.log("Reslicing"),this.outputs.resliced=baseutils.resliceRegistrationOutput(biswrap,reference,target,this.outputs.output)):this.outputs.resliced=null,resolve()}).catch(e=>{reject(e.stack)})})}}},"./js/modules/normalizeImage.js":function(module,exports,__webpack_require__){"use strict";const biswrap=__webpack_require__("./build/wasm/libbiswasm_wrapper.js"),baseutils=__webpack_require__("./js/modules/baseutils.js"),BaseModule=__webpack_require__("./js/modules/basemodule.js");module.exports=class extends BaseModule{constructor(){super(),this.name="normalizeImage"}createDescription(){return{name:"Normalize",description:"This element will normalize an image by thresholding below low threshold and saturating above high",author:"Zach Saltzman",version:"1.0",inputs:baseutils.getImageToImageInputs(),outputs:baseutils.getImageToImageOutputs(),buttonName:"Execute",shortname:"nrm",params:[{name:"Low",description:"The percentage of the cumulative histogram to threshold below",priority:1,advanced:!1,gui:"slider",type:"float",varname:"perlow",default:.02,low:0,high:.7},{name:"High",description:"The percentage of the cumulative histogram to saturate above",priority:2,advanced:!1,gui:"slider",type:"float",varname:"perhigh",default:.98,low:.75,high:1},{name:"Max Value",description:"Maximum value for the normalized image",priority:3,advanced:!1,gui:"slider",type:"int",varname:"maxval",default:255,low:16,high:255},baseutils.getDebugParam()]}}directInvokeAlgorithm(vals){return console.log("oooo invoking: normalizeImage with vals",JSON.stringify(vals)),new Promise((resolve,reject)=>{let input=this.inputs.input;biswrap.initialize().then(()=>{this.outputs.output=biswrap.normalizeImageWASM(input,{perlow:parseFloat(vals.perlow,10),perhigh:parseFloat(vals.perhigh,10),outmaxvalue:parseInt(vals.maxval,10)},super.parseBoolean(vals.debug)),resolve()}).catch(e=>{reject(e.stack)})})}}},"./js/modules/prepareRegistration.js":function(module,exports,__webpack_require__){"use strict";const biswrap=__webpack_require__("./build/wasm/libbiswasm_wrapper.js"),baseutils=__webpack_require__("./js/modules/baseutils.js"),BaseModule=__webpack_require__("./js/modules/basemodule.js");module.exports=class extends BaseModule{constructor(){super(),this.name="prepareRegistration"}createDescription(){return{name:"Prepare Registration",description:"Prepares an image for registration by extracting a frame from the image then smoothing, resampling, and normalizing it.",author:"Zach Saltzman",version:"1.0",inputs:baseutils.getImageToImageInputs(),outputs:baseutils.getImageToImageOutputs(),buttonName:"Execute",shortname:"prp",params:[{name:"Number of Bins",description:"Number of bins in histogram",priority:1,advanced:!1,gui:"dropdown",type:"int",default:64,varname:"numbins",fields:[16,32,64,128,256,512,1024],restrictAnswer:[16,32,64,128,256,512,1024]},{name:"Normalize",description:"Perform intensity normalization using the cumulative histogram",priority:2,gui:"check",type:"boolean",varname:"normal",default:!0,advanced:!0},{name:"Resolution Factor",description:"Factor to shrink the resolution (increase the spacing) of the output image relative to the input",priority:3,advanced:!1,gui:"slider",type:"float",varname:"resolution",default:2,low:1,high:6,step:.25},{name:"Smoothing",description:"Amount of smoothing to perform (values of 0 or less will perform no smoothing)",priority:4,advanced:!1,type:"float",gui:"slider",varname:"sigma",default:1,low:0,high:5},{name:"Int Scale",description:"Determines the maximum value of the normalized image",priority:5,type:"int",gui:"slider",varname:"intscale",low:1,high:4,advanced:!0,default:1},{name:"Frame",description:"Which frame to extract from a time series (fourth dimension)",priority:6,type:"int",gui:"slider",varname:"frame",default:0,advanced:!0},baseutils.getDebugParam()]}}directInvokeAlgorithm(vals){return console.log("oooo invoking: prepareRegistration with vals",JSON.stringify(vals)),new Promise((resolve,reject)=>{biswrap.initialize().then(()=>{let input=this.inputs.input;this.outputs.output=biswrap.prepareImageForRegistrationWASM(input,{numbins:parseInt(vals.numbins),normalize:super.parseBoolean(vals.normal),resolution:parseFloat(vals.resolution),sigma:parseFloat(vals.sigma),intscale:parseInt(vals.intscale),frame:parseInt(vals.frame)},vals.debug),resolve()}).catch(e=>{reject(e.stack)})})}updateOnChangedInput(inputs,guiVars){let newDes=this.getDescription(),current_input=(inputs=inputs||this.inputs).input||null;if(null===current_input)return newDes;let imagedim=current_input.getDimensions();for(let i=0;i<newDes.params.length;i++){let name=newDes.params[i].varname;"frame"===name&&(newDes.params[i].low=0,newDes.params[i].high=imagedim[3]-1,newDes.params[i].default=0,guiVars&&(guiVars[name]=newDes.params[i].default))}return this.recreateGUI=!0,newDes}}},"./js/modules/process4DImage.js":function(module,exports,__webpack_require__){"use strict";const baseutils=__webpack_require__("./js/modules/baseutils.js"),BaseModule=__webpack_require__("./js/modules/basemodule.js"),BisWebImage=__webpack_require__("./js/dataobjects/bisweb_image.js");module.exports=class extends BaseModule{constructor(){super(),this.JSOnly=!0,this.name="process4DImage"}createDescription(){return{name:"Processs a 4D Image",description:"This algorithm computes the single frame from a 4D image",author:"Xenios Papademetris",version:"1.0",buttonName:"Execute",shortname:"comb4d",inputs:baseutils.getImageToImageInputs("The image to be processed"),outputs:baseutils.getImageToImageOutputs(),params:[{name:"Operation",description:"The operation to perform",priority:1,advanced:!1,gui:"dropdown",default:"mean",type:"string",fields:["mean","meansigma","rms","max","min"],restrictAnswer:["mean","meansigma","rms","max","min"],varname:"operation"},baseutils.getDebugParam()]}}directInvokeAlgorithm(vals){console.log("oooo invoking: process4DImage",JSON.stringify(vals));let input=this.inputs.input,dim=input.getDimensions(),numvoxels=dim[0]*dim[1]*dim[2],numframes=dim[3]*dim[4],output=new BisWebImage,operation=vals.operation,numf=1;"meansigma"===operation&&(numf=2),output.cloneImage(input,{numframes:numf,numcomponents:1});let idata=input.getImageData(),odata=output.getImageData(),correction=1;if(numframes>1&&(correction=Math.sqrt(numframes)/Math.sqrt(numframes-1)),"mean"===operation||"rms"===operation||"meansigma"===operation)for(let i=0;i<numvoxels;i++){let sum=0,sum2=0;for(let f=0;f<numframes;f++){let v=idata[i+f*numvoxels];sum+=v,sum2+=v*v}"mean"===operation||"meansigma"===operation?(odata[i]=sum/numframes,"meansigma"===operation&&(odata[i+numvoxels]=Math.sqrt(sum2/numframes-odata[i]*odata[i])*correction)):odata[i]=Math.sqrt(sum2/numframes)}else if("max"===operation||"min"===operation)for(let i=0;i<numvoxels;i++){let val=idata[i];for(let f=1;f<numframes;f++)val="max"===operation?Math.max(idata[i+f*numvoxels],val):Math.min(idata[i+f*numvoxels],val);odata[i]=val}return this.outputs.output=output,Promise.resolve()}}},"./js/modules/projectImage.js":function(module,exports,__webpack_require__){"use strict";const biswrap=__webpack_require__("./build/wasm/libbiswasm_wrapper.js"),baseutils=__webpack_require__("./js/modules/baseutils.js"),BaseModule=__webpack_require__("./js/modules/basemodule.js");module.exports=class extends BaseModule{constructor(){super(),this.name="projectImage",this.JSOnly=!0}createDescription(){return{name:"Project 3D->2D",description:"This algorithm performes image projecting to a 2D image using eigher MIP or shaded projection",author:"Xenios Papademetris",version:"1.0",inputs:[{type:"image",name:"Input Image",description:"The image to be projected",varname:"input",shortname:"i",required:!0,guiviewerinput:"image",guiviewer:"viewer1"},{type:"image",name:"Mask Image",description:"The mask used to estimate the boundary",varname:"mask",shortname:"m",required:!1,guiviewertype:"overlay",guiviewer:"viewer1",colortype:"Red"}],outputs:baseutils.getImageToImageOutputs(null,"viewer2"),buttonName:"Project",shortname:"prj",params:[{name:"Mode",description:"Mode, mip,project,average",priority:1,advanced:!1,gui:"dropdown",default:"mip",type:"string",fields:["mip","project","average"],restrictAnswer:["mip","project","average"],varname:"mode"},{name:"UseMask",description:"It true project use the mask (no mip in that case)",priority:1,advanced:!1,gui:"check",varname:"usemask",type:"boolean",default:!1},{name:"Sigma",description:"The gaussian kernel standard deviation (either in voxels or mm)",priority:1,advanced:!0,gui:"slider",varname:"sigma",default:0,type:"float",low:0,high:3},{name:"Flip",description:"It true project along the increasing axis",priority:10,advanced:!1,gui:"check",varname:"flip",type:"boolean",default:!1},{name:"Axis",description:"Which axis to project along ('x', 'y', 'z', 'auto')",priority:1,advanced:!1,gui:"dropdown",default:"y",type:"string",fields:["x","y","z","auto"],restrictAnswer:["x","y","z","auto"],varname:"axis"},{name:"Gradient Sigma",description:"The gaussian kernel standard deviation for gradient computation (in 'project' mode)",priority:8,advanced:!0,gui:"slider",varname:"gradsigma",default:2,type:"float",low:0,high:4,step:.5},{name:"Threshold",description:"The intensity threshold to detect background in shaded projection",priority:100,advanced:!0,gui:"slider",varname:"threshold",default:1,type:"float",low:0,high:1e5,step:.1},{name:"Windowsize",description:"Number of voxels to average in 'average' or 'project' mode",priority:20,advanced:!1,gui:"slider",varname:"window",default:3,type:"int",low:1,high:10},baseutils.getDebugParam()]}}directInvokeAlgorithm(vals){return console.log("oooo invoking: projectImage with vals",JSON.stringify(vals)),new Promise((resolve,reject)=>{let input=this.inputs.input,axis=-1;vals.axis.indexOf("z")>=0?axis=2:vals.axis.indexOf("y")>=0?axis=1:vals.axis.indexOf("x")>=0&&(axis=0);let lps=!1;"LPS"===input.getOrientationName()&&(lps=!0,vals.flip?vals.flip=!1:vals.flip=!0),biswrap.initialize().then(()=>{let domip="mip"===vals.mode,gradsigma=parseFloat(vals.gradsigma);"average"===vals.mode&&(gradsigma=0);let mask=0;this.parseBoolean(vals.usemask)&&(mask=this.inputs.mask||0),this.outputs.output=biswrap.projectImageWASM(input,mask,{domip:domip,flip:this.parseBoolean(vals.flip),axis:parseInt(axis),sigma:parseFloat(vals.sigma),gradsigma:gradsigma,lps:lps,window:parseInt(vals.window),threshold:parseFloat(vals.threshold)},super.parseBoolean(vals.debug)),resolve()}).catch(e=>{console.log(e.stack),reject(e)})})}updateOnChangedInput(inputs){let newDes=this.getDescription(),current_input=(inputs=inputs||this.inputs).input||null;if(null===current_input)return newDes;let imagerange=current_input.getIntensityRange();for(let i=0;i<newDes.params.length;i++)"threshold"===newDes.params[i].varname&&(newDes.params[i].low=imagerange[0],newDes.params[i].high=imagerange[1],newDes.params[i].default=.95*imagerange[0]+.05*imagerange[1]);return this.recreateGUI=!0,newDes}}},"./js/modules/qualityMeasures.js":function(module,exports,__webpack_require__){"use strict";const BaseModule=__webpack_require__("./js/modules/basemodule.js"),baseutils=__webpack_require__("./js/modules/baseutils.js"),BisWebImage=__webpack_require__("./js/dataobjects/bisweb_image.js"),biswrap=__webpack_require__("./build/wasm/libbiswasm_wrapper.js"),genericio=__webpack_require__("./js/core/bis_genericio.js"),xformutil=__webpack_require__("./js/legacy/bis_transformationutil.js"),BisWebTextObject=__webpack_require__("./js/dataobjects/bisweb_textobject.js"),BisWebMatrix=__webpack_require__("./js/dataobjects/bisweb_matrix.js");module.exports=class extends BaseModule{constructor(){super(),this.name="Quality Control",this.outputmask=!1,this.maskedImage=new BisWebImage,this.reslicedImage=new BisWebImage,this.segmentedImage=new BisWebImage,this.segmentedMaskedImage=new BisWebImage}createDescription(){let m=this.outputmask;return{name:"QC",description:"This module uses data from the openfmri project to deface an image by first affinely registering it to a template",author:"Javid Dadashkarimi",version:"1.0",inputs:baseutils.getImageToImageInputs(),outputs:[{type:"matrix",name:"Output Matrix",description:"The results matrix",varname:"output",shortname:"o",required:!1,extension:".matr"},{type:"text",name:"Results",description:"log file",varname:"logoutput",required:!0,extension:".bistext"},{type:"image",name:"Output Image",description:"Segmentation image",varname:"segm",required:!1,extension:".nii.gz",guiviewertype:"overlay",guiviewer:"viewer1"}],buttonName:"Execute",shortname:"quality",params:[{name:"Resolution",description:"Factor to reduce the resolution prior to registration",priority:1,advanced:!0,gui:"slider",type:"float",varname:"resolution",default:3,low:1,high:5},{name:"Iterations",description:"Number of iterations (per level)",priority:2,advanced:!0,gui:"slider",type:"int",varname:"iterations",low:1,high:32,step:1,default:5},{name:"Levels",description:"Number of levels in multiresolution optimization",priority:3,advanced:!1,default:2,type:"int",gui:"slider",varname:"levels",low:1,high:4,step:1},{name:"Output Mask",description:"If true output the mask",priority:5,advanced:!0,gui:"check",varname:"outputmask",type:"boolean",default:m},baseutils.getDebugParam()]}}mean(arr){return arr.length?arr.reduce(function(a,b){return a+b})/arr.length:0}variance(arr){var mu=this.mean(arr);return this.mean(arr.map(function(num){return Math.pow(num-mu,2)}))}segmentImage(maskedImage,vals,k){return biswrap.segmentImageWASM(maskedImage,{frame:0,component:0,numclasses:k,numbins:256,maxsigmaratio:.2,robust:!1,smoothhisto:!0,smoothness:0,mrfconvergence:.2,mrfiterations:8,internaliterations:4,noisesigma2:0},vals.debug)}getQualityMeasures(maskedImage,segmentedImage,segmentedMaskedImage){let indims=maskedImage.getDimensions(),idata=maskedImage.getImageData(),sdata=segmentedMaskedImage.getImageData(),bdata=segmentedImage.getImageData(),islicesize=indims[0]*indims[1];this.outputs.segm=segmentedMaskedImage;let imageVar=this.variance(idata),imageMean=this.mean(idata);console.log("variance:",imageVar);let signal=[],wm=[],gm=[],bm=[],x_j=[],x_max=0;signal.push(.01),[].push(.01),bm.push(.01),wm.push(.01),gm.push(.01),x_j.push(.01);for(let k=0;k<indims[2];k++)for(let j=0;j<indims[1];j++)for(let i=0;i<indims[0];i++){let inindex=i+j*indims[0]+k*islicesize;idata[inindex]&&x_j.push(idata[inindex]),x_max+=Math.pow(idata[inindex],2),idata[inindex]>imageMean&&signal.push(idata[inindex]),1==sdata[inindex]?wm.push(idata[inindex]):2==sdata[inindex]?gm.push(idata[inindex]):0==bdata[inindex]&&bm.push(idata[inindex])}x_max=Math.sqrt(x_max);let snr=this.mean(signal)/Math.sqrt(this.variance(bm)),cjv=(Math.sqrt(this.variance(wm))+Math.sqrt(this.variance(gm)))/Math.abs(this.mean(wm)-this.mean(gm)),cnr=Math.abs(this.mean(gm)-this.mean(wm))/Math.sqrt(this.variance(bm)+this.variance(wm)+this.variance(gm)),efc=-x_j.map(function(v){return v/x_max*Math.log(v/x_max)}).reduce((a,b)=>a+b);return console.log("xj.length:",x_j.length),console.log("x_max:",x_max),console.log("signal.length:",signal.length),console.log("bm.length:",bm.length),console.log("wm.length:",wm.length),console.log("gm.length:",gm.length),console.log("image mean:",imageMean),console.log("image var:",imageVar),console.log("mean wm:",this.mean(wm)),console.log("mean gm:",this.mean(gm)),console.log("mean bm:",this.mean(bm)),console.log("var gm:",this.variance(gm)),console.log("var bm:",this.variance(bm)),console.log("var wm:",this.variance(wm)),console.log("snr:",snr),console.log("cjv:",cjv),console.log("cnr:",cnr),console.log("efc:",efc),[snr,cnr,cjv,efc]}registeration(images,vals){let img=this.inputs.input,initial=0,centeronrefonly=!1;return img.getOrientationName()!==images[0].getOrientationName()&&(centeronrefonly=!0,initial=xformutil.computeHeaderTransformation(img,images[0],!1)),biswrap.runLinearRegistrationWASM(img,images[0],initial,{intscale:1,numbins:64,levels:parseInt(vals.levels),centeronrefonly:this.parseBoolean(centeronrefonly),smoothing:1,optimization:2,stepsize:1,metric:3,steps:1,iterations:parseInt(vals.iterations),mode:3,resolution:parseFloat(vals.resolution),normalize:!0,debug:!0,return_vector:!1},this.parseBoolean(vals.debug))}maskImage(img,vals){if(this.parseBoolean(vals.outputmask)){let tdat=this.reslicedImage.getImageData(),l=tdat.length;for(let i=0;i<l;i++)tdat[i]<1?tdat[i]=0:tdat[i]=1}else{this.maskedImage.cloneImage(img);let odat=this.maskedImage.getImageData(),idat=img.getImageData(),tdat=this.reslicedImage.getImageData(),dm=this.maskedImage.getDimensions(),volumesize=dm[0]*dm[1]*dm[2],numframes=dm[3]*dm[4],count=0;for(let i=0;i<volumesize;i++)if(tdat[i]<1){count+=1;for(let f=0;f<numframes;f++)odat[f*volumesize+i]=0}else for(let f=0;f<numframes;f++)odat[f*volumesize+i]=idat[f*volumesize+i];console.log("Done masked=",count,"/",volumesize," voxels")}return this.maskedImage}printQualityControl(maskedImage,segmentImage,segmentedMaskedImage){var snr,cnr,cjv,ecf;[snr,cnr,cjv,ecf]=this.getQualityMeasures(maskedImage,segmentImage,segmentedMaskedImage);let message='<p>  Image Quality Metrics</p><p>SNR= <span style="color:green">'+snr.toFixed(4).toString()+'</span></p><p>CNR= <span style="color:green">'+cnr.toFixed(4).toString()+'</span><a href="https://mriqc.readthedocs.io/en/stable/iqms/t1w.html#magnota2006"/></p><p>CJV= <span style="color:green">'+cjv.toFixed(4).toString()+'</span></p><p>ECF= <span style="color:green">'+ecf.toFixed(4).toString()+"</span></p>";this.outputs.logoutput=new BisWebTextObject(message);let mat=new BisWebMatrix;mat.zero(4,1),mat.setElement(0,0,snr),mat.setElement(1,0,cnr),mat.setElement(2,0,cjv),mat.setElement(3,0,ecf),this.outputs.output=mat}qualityCtrlProcess(img,vals){let images=[new BisWebImage,new BisWebImage],imagepath=genericio.getimagepath();return console.log("imagepath:",imagepath),new Promise((resolve,reject)=>{Promise.all([images[0].load(`${imagepath}/mean_reg2mean.nii.gz`),images[1].load(`${imagepath}/brain_mask_for_qc.nii.gz`),biswrap.initialize()]).then(()=>{var matr=this.registeration(images,vals);this.reslicedImage=baseutils.resliceRegistrationOutput(biswrap,img,images[1],matr,1,0),this.maskedImage=this.maskImage(img,vals),this.segmentedImage=this.segmentImage(img,vals,2),this.segmentedMaskedImage=this.segmentImage(this.maskedImage,vals,3),this.printQualityControl(this.maskedImage,this.segmentImage,this.segmentedMaskedImage),resolve()}).catch(e=>{reject(e.stack)})})}directInvokeAlgorithm(vals){console.log("oooo invoking: defaceImage with vals",JSON.stringify(vals));let img=this.inputs.input;return this.qualityCtrlProcess(img,vals)}}},"./js/modules/regressGlobal.js":function(module,exports,__webpack_require__){"use strict";const biswrap=__webpack_require__("./build/wasm/libbiswasm_wrapper.js"),BaseModule=__webpack_require__("./js/modules/basemodule.js"),baseutils=__webpack_require__("./js/modules/baseutils.js");module.exports=class extends BaseModule{constructor(){super(),this.name="regressGlobal"}createDescription(){return{name:"Regress Global Signal",description:"Regresses the global signal (average) from a time series with the option to specify a weight matrix",author:"Zach Saltzman",version:"1.0",inputs:baseutils.getMatrixToMatrixInputs(!0),outputs:baseutils.getMatrixToMatrixOutputs(),buttonName:"Regress",shortname:"glb",params:[baseutils.getDebugParam()]}}directInvokeAlgorithm(vals){return console.log("oooo invoking: regresGlobal with vals",JSON.stringify(vals)),new Promise((resolve,reject)=>{let regress=this.inputs.input,weight=this.inputs.weight||0;biswrap.initialize().then(()=>{this.outputs.output=biswrap.weightedRegressGlobalSignalWASM(regress,weight,vals.debug),resolve()}).catch(e=>{reject(e.stack)})})}}},"./js/modules/regressOut.js":function(module,exports,__webpack_require__){"use strict";const biswrap=__webpack_require__("./build/wasm/libbiswasm_wrapper.js"),BaseModule=__webpack_require__("./js/modules/basemodule.js"),baseutils=__webpack_require__("./js/modules/baseutils.js");module.exports=class extends BaseModule{constructor(){super(),this.name="regressOut"}createDescription(){let des={name:"Weighted Regress Out",description:"Regresses one time signal from another with the option to specify a weight matrix",author:"Zach Saltzman",version:"1.0",inputs:baseutils.getMatrixToMatrixInputs(!0),outputs:baseutils.getMatrixToMatrixOutputs(),buttonName:"Regress",shortname:"rgr",params:[baseutils.getDebugParam()]};return des.inputs.push(baseutils.getRegressorInput()),des}directInvokeAlgorithm(vals){return console.log("oooo invoking: regressOut with vals",JSON.stringify(vals)),new Promise((resolve,reject)=>{let input=this.inputs.input,regressor=this.inputs.regressor||0,weight=this.inputs.weight||0;biswrap.initialize().then(()=>{this.outputs.output=biswrap.weightedRegressOutWASM(input,regressor,weight,super.parseBoolean(vals.debug)),resolve()}).catch(e=>{reject(e.stack)})})}}},"./js/modules/regularizeObjectmap.js":function(module,exports,__webpack_require__){"use strict";const biswrap=__webpack_require__("./build/wasm/libbiswasm_wrapper.js"),BaseModule=__webpack_require__("./js/modules/basemodule.js"),baseutils=__webpack_require__("./js/modules/baseutils.js");module.exports=class extends BaseModule{constructor(){super(),this.name="regularizeObjectmap"}createDescription(){return{name:"Regularize Objectmap ",description:"Performs Objectmap regularization",author:"Xenios Papademetris",version:"1.0",inputs:baseutils.getImageToImageInputs("The binary mask to be regularized","viewer1","overlay"),outputs:baseutils.getImageToImageOutputs("The output mask","viewer1","overlay"),buttonName:"Smooth",shortname:"reg",params:[{name:"Smoothness",description:"If > 0 then apply spatial regularization MRF model with this value as the weight",priority:6,advanced:!1,gui:"slider",type:"float",varname:"smoothness",default:2,low:1,high:32},{name:"MRF Convergence",description:"Convergence parameter for the MRF iterations",priority:7,advanced:!0,gui:"slider",type:"float",varname:"convergence",default:.2,low:.01,high:.5},{name:"Iterations",description:"Number of MRF iterations",priority:8,advanced:!0,gui:"slider",type:"int",varname:"iterations",default:8,low:1,high:20},{name:"Internal Iterations",description:"Number of Internal iterations",priority:100,advanced:!0,gui:"slider",type:"int",varname:"internaliterations",default:4,low:1,high:20},baseutils.getDebugParam()]}}directInvokeAlgorithm(vals){return console.log("oooo invoking: regularizeObjectmap with vals",JSON.stringify(vals)),new Promise((resolve,reject)=>{let input=this.inputs.input;biswrap.initialize().then(()=>{this.outputs.output=biswrap.regularizeObjectmapWASM(input,{smoothness:parseFloat(vals.smoothness),convergence:parseFloat(vals.convergence),iterations:parseInt(vals.iterations),internaliterations:parseInt(vals.internaliterations)},vals.debug),resolve()}).catch(e=>{reject(e.stack)})})}}},"./js/modules/reorientImage.js":function(module,exports,__webpack_require__){"use strict";const baseutils=__webpack_require__("./js/modules/baseutils.js"),BisWebImage=__webpack_require__("./js/dataobjects/bisweb_image.js"),BaseModule=__webpack_require__("./js/modules/basemodule.js"),BisWebTextObject=__webpack_require__("./js/dataobjects/bisweb_textobject.js");module.exports=class extends BaseModule{constructor(){super(),this.JSOnly=!0,this.name="reorientImage"}createDescription(){let des={name:"Reorient Image",description:"This algorithm reorients an image to a fixed orientation",author:"Xenios Papademetris",version:"1.0",inputs:baseutils.getImageToImageInputs("Load the image to be blanked"),outputs:baseutils.getImageToImageOutputs(),buttonName:"Execute",shortname:"reornt",params:[{name:"Orientation",description:"Output image orientation",priority:1,advanced:!1,gui:"dropdown",type:"string",fields:["RAS","LPS","LAS"],restrictAnswer:["RAS","LPS","LAS"],varname:"orient",default:"RAS"},baseutils.getDebugParam()]};return baseutils.addLogOutput(des.outputs),des}directInvokeAlgorithm(vals){let input=this.inputs.input;console.log("oooo invoking: reorientImage with vals",JSON.stringify(vals));let debug=this.parseBoolean(vals.debug);debug&&(console.log("-- input \n",input.getDescription(),"\n"),console.log(input.getHeader().getDescription()));let dat=input.serializeToNII(),output=new BisWebImage;return output.initialize(),output.debug=debug,output.parseNII(dat.buffer,vals.orient),output.debug=!1,this.outputs.output=output,debug&&(console.log("-- output \n",output.getDescription(),"\n"),console.log(output.getHeader().getDescription())),this.outputs.logoutput=new BisWebTextObject("Reoriented\n---\n\t input:"+input.getDescription()+"\n---\n\t output:"+output.getDescription()),Promise.resolve()}}},"./js/modules/resampleImage.js":function(module,exports,__webpack_require__){"use strict";const biswrap=__webpack_require__("./build/wasm/libbiswasm_wrapper.js"),BaseModule=__webpack_require__("./js/modules/basemodule.js"),baseutils=__webpack_require__("./js/modules/baseutils.js");module.exports=class extends BaseModule{constructor(){super(),this.name="resampleImage",this.lastInputSpacing=[1,1,1]}createDescription(){return{name:"Resample Image",description:"Resamples an existing image",author:"Zach Saltzman",version:"1.0",inputs:baseutils.getImageToImageInputs(),outputs:baseutils.getImageToImageOutputs(),buttonName:"Resample",shortname:"rsp",params:[{name:"XSpacing",description:"Desired voxel spacing in X direction",priority:1,advanced:!1,gui:"slider",type:"float",varname:"xsp",default:-1},{name:"Y Spacing",description:"Desired voxel spacing in Y direction",priority:2,advanced:!1,gui:"slider",type:"float",varname:"ysp",default:-1},{name:"Z Spacing",description:"Desired voxel spacing in Z direction",priority:3,advanced:!1,gui:"slider",type:"float",varname:"zsp",default:-1},{name:"Interpolation",description:"Type of interpolation to use (0 = nearest-neighbor, 1 = linear, 3 = cubic)",priority:4,advanced:!1,gui:"dropdown",type:"int",varname:"interpolation",fields:[0,1,3],restrictAnswer:[0,1,3],default:1},{name:"Background Value",description:"value to use for outside the image",priority:100,advanced:!0,gui:"entrywidget",type:"float",varname:"backgroundvalue",default:0},baseutils.getDebugParam()]}}directInvokeAlgorithm(vals){return console.log("oooo invoking: resampleImage with vals",JSON.stringify(vals)),new Promise((resolve,reject)=>{let input=this.inputs.input;biswrap.initialize().then(()=>{this.outputs.output=biswrap.resampleImageWASM(input,{spacing:[parseFloat(vals.xsp),parseFloat(vals.ysp),parseFloat(vals.zsp)],interpolation:parseInt(vals.interpolation),backgroundValue:parseFloat(vals.backgroundvalue)},vals.debug),resolve()}).catch(e=>{reject(e.stack)})})}updateOnChangedInput(inputs,guiVars=null){let newDes=this.getDescription(),current_input=(inputs=inputs||this.inputs).input||null;if(null===current_input)return newDes;let nm=["xsp","ysp","zsp"],spa=current_input.getSpacing();if(!(this.compareArrays(spa,this.lastInputSpacing,0,2)<.01)){this.lastInputSpacing=spa;for(let i=0;i<newDes.params.length;i++){let name=newDes.params[i].varname,index=nm.indexOf(name);if(index>=0){newDes.params[i].low=.33*spa[index],newDes.params[i].high=3*spa[index],newDes.params[i].default=spa[index];let st=.1;for(;st>.1*spa[index];)st*=.1;newDes.params[i].step=st,guiVars&&(guiVars[name]=newDes.params[i].default)}}return this.recreateGUI=!0,newDes}}}},"./js/modules/resliceImage.js":function(module,exports,__webpack_require__){"use strict";const BaseModule=__webpack_require__("./js/modules/basemodule.js"),biswrap=__webpack_require__("./build/wasm/libbiswasm_wrapper.js"),baseutils=__webpack_require__("./js/modules/baseutils.js"),BisWebTransformCollection=__webpack_require__("./js/dataobjects/bisweb_transformationcollection.js");module.exports=class extends BaseModule{constructor(md){super(),this.name="resliceImage",this.targetGUIInput="image",this.targetGUIViewer="viewer2","overlay"!==md&&"single"!==md||(this.targetGUIInput="overlay",this.targetGUIViewer="viewer1")}createDescription(){return{name:"Reslice Image",description:"Reslices an existing image to match a reference and a transformation",author:"Zach Saltzman",version:"1.0",shortname:"rsl",buttonName:"Reslice",inputs:[{type:"image",name:"Image to Reslice",description:"Load the image to reslice",varname:"input",shortname:"i",required:!0,guiviewertype:this.targetGUIInput,guiviewer:this.targetGUIViewer,colortype:"Orange"},{type:"image",name:"Reference Image",description:"Load the reference image (if not specified use input)",varname:"reference",shortname:"r",required:!1,guiviewertype:"image",guiviewer:"viewer1"},{type:"transformation",name:"Reslice Transform",description:"Load the transformation used to reslice the image",varname:"xform",shortname:"x",required:!0,guiviewer:"current"},{type:"transform",name:"Transformation 2",description:"The second transformation to combine with first",varname:"xform2",required:!1,shortname:"y"},{type:"transform",name:"Transformation 3",description:"The third transformation to combine with first and second",varname:"xform3",required:!1,shortname:"z"}],outputs:[{type:"image",name:"Output Image",description:"Save the resliced image",varname:"output",shortname:"o",required:!1,extension:".nii.gz",guiviewertype:"overlay",guiviewer:"viewer1",colortype:"Orange"}],params:[{name:"Interpolation",description:"Which type of interpolation to use (3 = cubic, 1 = linear, 0 = nearest-neighbor)",priority:1,advanced:!1,gui:"dropdown",type:"int",default:"1",varname:"interpolation",fields:[0,1,3],restrictAnswer:[0,1,3]},{name:"Force Float",description:"If true force output to float",priority:100,advanced:!0,type:"boolean",default:!1,varname:"forcefloat"},{name:"Fill Value",description:"Value to use for outside the image",priority:2,advanced:!0,gui:"slider",type:"float",varname:"backgroundvalue",default:0},{name:"Add Grid",description:"If true adds a grid overlay to the image",priority:37,advanced:!0,gui:"check",varname:"addgrid",type:"boolean",default:!1},{name:"Grid Spacing",description:"If add grid is true this controls the grid spacing",priority:38,advanced:!0,gui:"slider",type:"int",default:8,lowbound:4,highbound:16,varname:"gridgap"},{name:"Grid Intensity",description:"If add grid is true this controls the intensity of the grid (as a function of the maximum image intensity)",priority:39,advanced:!0,gui:"slider",type:"float",default:.5,lowbound:.1,highbound:2,step:.1,varname:"gridvalue"},baseutils.getDebugParam()]}}directInvokeAlgorithm(vals){return console.log("oooo invoking: resliceImage with vals",JSON.stringify(vals)),new Promise((resolve,reject)=>{let xform=this.inputs.xform||null,input=this.inputs.input,reference=this.inputs.reference||input;null!==xform&&null!==input||reject("Either no image or no transformation specified");let xform2=this.inputs.xform2||null,xform3=this.inputs.xform3||null;if(xform2||xform3){let coll=new BisWebTransformCollection;coll.addTransformation(xform),xform2&&coll.addTransformation(xform2),xform3&&coll.addTransformation(xform3),xform=coll}biswrap.initialize().then(()=>{let spa=reference.getSpacing(),dim=reference.getDimensions(),dt="-1";vals.forcefloat&&(dt="float"),this.parseBoolean(vals.addgrid)&&(console.log("oooo adding grid overlay first"),input=biswrap.addGridToImageWASM(input,{gap:parseInt(vals.gridgap),value:parseFloat(vals.gridvalue)},vals.debug)),this.outputs.output=biswrap.resliceImageWASM(input,xform,{spacing:[spa[0],spa[1],spa[2]],dimensions:[dim[0],dim[1],dim[2]],datatype:dt,backgroundValue:parseFloat(vals.backgroundvalue),interpolation:parseInt(vals.interpolation)},vals.debug),this.outputs.output.copyOrientationInfo(reference),resolve()}).catch(e=>{reject(e.stack)})})}}},"./js/modules/segmentImage.js":function(module,exports,__webpack_require__){"use strict";const biswrap=__webpack_require__("./build/wasm/libbiswasm_wrapper.js"),BaseModule=__webpack_require__("./js/modules/basemodule.js"),baseutils=__webpack_require__("./js/modules/baseutils.js");module.exports=class extends BaseModule{constructor(){super(),this.name="segmentImage"}createDescription(){let des={name:"Segment Image",description:"Performs image segmentation using a histogram-based method if smoothness = 0.0 or using plus mrf segmentation if smoothness > 0.0",author:"Zach Saltzman",version:"1.0",inputs:baseutils.getImageToImageInputs(),outputs:baseutils.getImageToImageOutputs(),buttonName:"Segment",shortname:"sgm",params:[{name:"Num Classes",description:"Number of classes to segment image into",priority:1,advanced:!1,gui:"slider",type:"int",varname:"numclasses",default:3,low:2,high:8},{name:"Maximum Sigma Ratio",description:"Enforced ratio between minimum and maximum standard deviation between class parameters",priority:2,advanced:!0,gui:"slider",type:"float",varname:"maxsigmaratio",default:.2,low:0,high:1},{name:"Robust",description:"Use robust range algorithm to eliminate outliers prior to segmentation",priority:3,advanced:!0,gui:"check",type:"boolean",varname:"robust",default:!1},{name:"Number of Bins",description:"Number of bins in the histogram",priority:4,advanced:!1,gui:"slider",type:"int",varname:"numbins",low:32,high:1024,default:256},{name:"Smooth Histogram",description:"Whether or not to apply smoothing to the histogram",priority:5,advanced:!0,gui:"check",type:"boolean",varname:"smoothhisto",default:!0},{name:"Smoothness",description:"If > 0 then apply spatial regularization MRF model with this value as the weight",priority:6,advanced:!1,gui:"slider",type:"float",varname:"smoothness",default:0,low:0,high:100},{name:"MRF Convergence",description:"Convergence parameter for the MRF iterations",priority:7,advanced:!0,gui:"slider",type:"float",varname:"mrfconvergence",default:.2,low:.01,high:.5},{name:"MRF Iterations",description:"Number of MRF iterations",priority:8,advanced:!0,gui:"slider",type:"int",varname:"mrfiterations",default:8,low:1,high:20},{name:"Internal Iterations",description:"Number of Internal iterations",priority:100,advanced:!0,gui:"slider",type:"int",varname:"internaliterations",default:4,low:1,high:20},{name:"Noise Sigma",description:"Estimate of the standard deviation of noise in the image. This is used to add robustness to the algorithm",priority:9,advanced:!0,gui:"slider",type:"float",varname:"noisesigma2",default:0,low:0,high:1e3},baseutils.getDebugParam()]};return des.outputs[0].guiviewertype="overlay",des}directInvokeAlgorithm(vals){return console.log("oooo invoking: segmentImage with vals",JSON.stringify(vals)),new Promise((resolve,reject)=>{let input=this.inputs.input;biswrap.initialize().then(()=>{this.outputs.output=biswrap.segmentImageWASM(input,{frame:0,component:0,numclasses:parseInt(vals.numclasses),numbins:parseInt(vals.numbins),maxsigmaratio:parseFloat(vals.maxsigmaratio),robust:super.parseBoolean(vals.robust),smoothhisto:super.parseBoolean(vals.smoothhisto),smoothness:parseFloat(vals.smoothness),mrfconvergence:parseFloat(vals.mrfconvergence),mrfiterations:parseInt(vals.mrfiterations),internaliterations:parseInt(vals.internaliterations),noisesigma2:parseFloat(vals.noisesigma2)},vals.debug),resolve()}).catch(e=>{reject(e.stack)})})}}},"./js/modules/shiftScaleImage.js":function(module,exports,__webpack_require__){"use strict";const biswrap=__webpack_require__("./build/wasm/libbiswasm_wrapper.js"),BaseModule=__webpack_require__("./js/modules/basemodule.js"),baseutils=__webpack_require__("./js/modules/baseutils.js");module.exports=class extends BaseModule{constructor(){super(),this.name="shiftScaleImage",this.lastInputRange=[0,0]}createDescription(){return{name:"ShiftScale",description:"This element will shift and scale an image and cast to desired output",author:"Zach Saltzman",version:"1.0",inputs:baseutils.getImageToImageInputs(),outputs:baseutils.getImageToImageOutputs(),buttonName:"Shift+Scale",shortname:"shsc",params:[{name:"Shift",description:"The Shift value to add to all voxels",priority:1,advanced:!1,gui:"slider",type:"float",varname:"shift",default:0},{name:"Scale",description:"The Scale to multiple all voxels post shift",priority:2,advanced:!1,gui:"slider",type:"float",low:.001,high:1e3,default:1,varname:"scale"},{name:"Output Type",description:"Output Type",priority:3,advanced:!1,type:"string",gui:"dropdown",fields:["Same","UChar","Short","Int","Float","Double"],restrictAnswer:["Same","UChar","Short","Int","Float","Double"],default:"Same",varname:"outtype"},baseutils.getDebugParam()]}}directInvokeAlgorithm(vals){console.log("oooo invoking: shiftScaleImage with vals",JSON.stringify(vals));let input=this.inputs.input,datatype=-1;return"UChar"===vals.outtype?datatype="uchar":"Short"===vals.outtype?datatype="short":"Float"===vals.outtype?datatype="float":"Int"===vals.outtype?datatype="int32":"Double"===vals.outtype&&(datatype="double"),new Promise((resolve,reject)=>{biswrap.initialize().then(()=>{this.outputs.output=biswrap.shiftScaleImageWASM(input,{shift:parseFloat(vals.shift),scale:parseFloat(vals.scale),outvalue:parseFloat(vals.outval),datatype:datatype},vals.debug),resolve()}).catch(e=>{reject(e.stack)})})}updateOnChangedInput(inputs,guiVars){let newDes=this.getDescription(),current_input=(inputs=inputs||this.inputs).input||null;if(null===current_input)return newDes;let imagerange=current_input.getIntensityRange();if(!(this.compareArrays(imagerange,this.lastInputRange,0,1)<1)){this.lastInputRange=imagerange;for(let i=0;i<newDes.params.length;i++){let name=newDes.params[i].varname;if("shift"===name){let maxv=Math.max(Math.abs(imagerange[0]),Math.abs(imagerange[1]));newDes.params[i].low=-2*maxv,newDes.params[i].high=2*maxv,newDes.params[i].default=0,guiVars&&(guiVars[name]=newDes.params[i].default)}}return this.recreateGUI=!0,newDes}}}},"./js/modules/sliceBiasFieldCorrect.js":function(module,exports,__webpack_require__){"use strict";const biswrap=__webpack_require__("./build/wasm/libbiswasm_wrapper.js"),BaseModule=__webpack_require__("./js/modules/basemodule.js"),baseutils=__webpack_require__("./js/modules/baseutils.js");module.exports=class extends BaseModule{constructor(){super(),this.name="sliceBiasCorrect"}createDescription(){return{name:"Bias Field Correct",description:"Performs slice-based intensity inhomogeneity (bias field) correction on an image",author:"Zach Saltzman",version:"1.0",inputs:baseutils.getImageToImageInputs(),outputs:baseutils.getImageToImageOutputs(),buttonName:"Execute",shortname:"slb",params:[{name:"Axis",description:"Which axis to correct along ('x', 'y', 'z', 'triple')",priority:1,advanced:!1,gui:"dropdown",default:"z",type:"string",fields:["x","y","z","triple"],restrictAnswer:["x","y","z","triple"],varname:"axis"},{name:"Threshold",description:"This sets the threshold (percentage of max intensity), below which the image is masked",priority:2,advanced:!0,gui:"slider",type:"float",low:0,high:.5,default:.05,step:.01,varname:"threshold"},{name:"Return Bias Field",description:"If false (default), this returns the the corrected image. Otherwise (true) it returns the estimated bias field.",priority:3,advanced:!0,gui:"check",type:"boolean",varname:"returnbiasfield",default:!1},baseutils.getDebugParam()]}}directInvokeAlgorithm(vals){console.log("oooo invoking: sliceBiasCorrect with vals",JSON.stringify(vals));let input=this.inputs.input,mode=vals.axis,axis=3;return"x"===mode?axis=0:"y"===mode?axis=1:"z"===mode&&(axis=2),new Promise((resolve,reject)=>{biswrap.initialize().then(()=>{this.outputs.output=biswrap.sliceBiasFieldCorrectImageWASM(input,{axis:axis,threshold:parseFloat(vals.threshold),returnbiasfield:super.parseBoolean(vals.returnbiasfield)},vals.debug),resolve()}).catch(e=>{reject(e.stack)})})}}},"./js/modules/smoothImage.js":function(module,exports,__webpack_require__){"use strict";const biswrap=__webpack_require__("./build/wasm/libbiswasm_wrapper.js"),baseutils=__webpack_require__("./js/modules/baseutils.js"),BaseModule=__webpack_require__("./js/modules/basemodule.js");module.exports=class extends BaseModule{constructor(){super(),this.name="smoothImage"}createDescription(){return{name:"Smooth",description:"This algorithm performes image smoothing using a 2D/3D Gaussian kernel",author:"Zach Saltzman",version:"1.0",inputs:baseutils.getImageToImageInputs("Load the image to be smoothed"),outputs:baseutils.getImageToImageOutputs(),buttonName:"Smooth",shortname:"sm",params:[{name:"Sigma",description:"The gaussian kernel standard deviation (either in voxels or mm)",priority:1,advanced:!1,gui:"slider",varname:"sigma",default:1,type:"float",low:0,high:8},{name:"In mm?",description:"Determines whether kernel standard deviation (sigma) will be measured in millimeters or voxels",priority:7,advanced:!1,gui:"check",varname:"inmm",type:"boolean",default:!0},{name:"Radius Factor",description:"This affects the size of the convolution kernel which is computed as sigma*radius+1",priority:2,advanced:!0,gui:"slider",type:"float",default:2,lowbound:1,highbound:4,varname:"radiusfactor"},baseutils.getDebugParam()]}}directInvokeAlgorithm(vals){return console.log("oooo invoking: smoothImage with vals",JSON.stringify(vals)),new Promise((resolve,reject)=>{let input=this.inputs.input,s=parseFloat(vals.sigma);biswrap.initialize().then(()=>{this.outputs.output=biswrap.gaussianSmoothImageWASM(input,{sigmas:[s,s,s],inmm:super.parseBoolean(vals.inmm),radiusfactor:parseFloat(vals.radiusfactor)},super.parseBoolean(vals.debug)),resolve()}).catch(e=>{reject(e.stack)})})}}},"./js/modules/tfRecon.js":function(module,exports,__webpack_require__){"use strict";const BaseModule=__webpack_require__("./js/modules/basemodule.js"),baseutils=__webpack_require__("./js/modules/baseutils.js"),bistfutil=__webpack_require__("./js/modules/bis_tfutil.js");module.exports=class extends BaseModule{constructor(){super(),this.JSOnly=!0,this.name="tensorFlowModule",this.modelname="",this.tfjsModule=null}addModelNameParameter(){return{name:"Model name",description:"Location of Model to use",priority:20,advanced:!0,varname:"modelname",type:"string",default:""}}createDescription(){let obj={name:"Apply Model",description:"Applies TensorFlow Models on an image to get an output",author:"Xenios Papademetris",version:"1.0",inputs:baseutils.getImageToImageInputs("The Input Image"),outputs:baseutils.getImageToImageOutputs(),params:[{name:"Padding",description:"Padding to apply when doing patch-based reconstruction",priority:1,advanced:!1,gui:"dropdown",type:"int",default:"4",varname:"padding",fields:[0,2,4,8,12,16,32],restrictAnswer:[0,2,4,8,12,16,32]},{name:"Batch Size",description:"Size of batch to reconstruct (in browser set this to 1 or 2)",priority:10,advanced:!1,gui:"slider",varname:"batchsize",type:"int",default:1,low:1,high:32},{name:"Force Browser",description:"If true use webgl backend",priority:20,advanced:!0,gui:"check",varname:"forcebrowser",type:"boolean",default:!1},baseutils.getDebugParam()]},md=this.addModelNameParameter();return md&&obj.params.push(md),obj}setTFModule(tf){this.tfjsModule=tf}setModelName(modelname){this.modelname=modelname}directInvokeAlgorithm(vals){console.log("oooo invoking: tfReconModule with vals",JSON.stringify(vals));let input=this.inputs.input,padding=vals.padding,batchsize=vals.batchsize,modelname=vals.modelname;return modelname.length<2&&(modelname=this.modelname),new Promise(async(resolve,reject)=>{if(null===this.tfjsModule)try{console.log("---------------------------------------");let msg=await bistfutil.initializeTFModule(vals.forcebrowser);console.log("\t initialize done"),console.log("---",msg),console.log("--- \tinput image dims=",input.getDimensions().join(",")),console.log("---------------------------------------"),this.tfjsModule=bistfutil.getTFJSModule()}catch(e){return void reject("TFRecon Error "+e)}else console.log("--- Using preset TFJSModule");let model=null;try{model=await bistfutil.loadAndWarmUpModel(this.tfjsModule,bistfutil.fixModelName(modelname),!0)}catch(e){return console.log("--- Failed load model from",modelname,e),void reject("Failed to load model")}console.log("----------------------------------------------------------"),new bistfutil.BisWebTensorFlowRecon(this.tfjsModule,input,model,padding).reconstruct(this.tfjsModule,bistfutil.fixBatchSize(batchsize)).then(output=>{console.log("----------------------------------------------------------"),this.tfjsModule.disposeVariables(model).then(num=>{console.log("--- Cleanup num_tensors=",num),this.outputs.output=output,console.log("--- Recon finished :",output.getDescription()),resolve("Done")})}).catch(e=>{reject(e)})})}}},"./js/modules/thresholdImage.js":function(module,exports,__webpack_require__){"use strict";const biswrap=__webpack_require__("./build/wasm/libbiswasm_wrapper.js"),BaseModule=__webpack_require__("./js/modules/basemodule.js"),baseutils=__webpack_require__("./js/modules/baseutils.js");module.exports=class extends BaseModule{constructor(){super(),this.name="thresholdImage",this.lastInputRange=[0,0]}createDescription(){return{name:"Threshold",description:"This element will threshold an image -- values between the thresholds will be considered 'input' and values outside will be considered 'out'",author:"Zach Saltzman",version:"1.0",inputs:baseutils.getImageToImageInputs(),outputs:baseutils.getImageToImageOutputs(),buttonName:"Threshold",shortname:"thr",params:[{name:"Low Threshold",description:"The threshold below which values will be classified as 'out'",priority:1,advanced:!1,gui:"slider",type:"float",varname:"low",default:1},{name:"High Threshold",description:"The value above which values will be classified as 'out'",priority:2,advanced:!1,gui:"slider",type:"float",default:2,varname:"high"},{name:"Replace 'in'",description:"If true, values classified as 'in' will be replaced by 'in value'",priority:3,advanced:!0,gui:"check",type:"boolean",default:!1,varname:"replacein"},{name:"Replace 'out'",description:"If true, values classified as 'out' will be replaced by 'out value'",priority:4,advanced:!0,gui:"check",default:!0,type:"boolean",varname:"replaceout"},{name:"'in' Value",description:"Value to replace 'in' values with",priority:5,gui:"dropdown",advanced:!0,default:1,type:"int",varname:"inval",fields:[0,1,100],restrictAnswer:[0,1,100]},{name:"'out' Value",description:"Value to replace 'out' values with",priority:6,advanced:!0,type:"int",gui:"dropdown",fields:[0,1,100],restrictAnswer:[0,1,100],default:0,varname:"outval"},{name:"Output Type",description:"Output Type",priority:10,advanced:!0,type:"string",gui:"dropdown",fields:["Same","UChar","Short"],restrictAnswer:["Same","UChar","Short"],default:"Same",varname:"outtype"},baseutils.getDebugParam()]}}directInvokeAlgorithm(vals){console.log("oooo invoking: thresholdImage with vals",JSON.stringify(vals));let input=this.inputs.input,datatype=-1;return"UChar"===vals.outtype?datatype="uchar":"Short"===vals.outtype&&(datatype="short"),console.log("DataType=",datatype,vals.outtype,"low=",vals.low,"high=",vals.high),new Promise((resolve,reject)=>{biswrap.initialize().then(()=>{this.outputs.output=biswrap.thresholdImageWASM(input,{low:parseFloat(vals.low),high:parseFloat(vals.high),replacein:super.parseBoolean(vals.replacein),replaceout:super.parseBoolean(vals.replaceout),invalue:parseFloat(vals.inval),outvalue:parseFloat(vals.outval),datatype:datatype},vals.debug),resolve()}).catch(e=>{reject(e.stack)})})}updateOnChangedInput(inputs,guiVars){let newDes=this.getDescription(),current_input=(inputs=inputs||this.inputs).input||null;if(null===current_input)return newDes;let imagerange=current_input.getIntensityRange();if(!(this.compareArrays(imagerange,this.lastInputRange,0,1)<1)){this.lastInputRange=imagerange;for(let i=0;i<newDes.params.length;i++){let name=newDes.params[i].varname;"low"!==name&&"high"!==name||(newDes.params[i].low=imagerange[0],newDes.params[i].high=imagerange[1],"low"===name?newDes.params[i].default=.9*imagerange[0]+.1*imagerange[1]:"high"===name&&(newDes.params[i].default=imagerange[1]),guiVars&&(guiVars[name]=newDes.params[i].default))}return this.recreateGUI=!0,newDes}}}},"./js/modules/webworkermoduleutil.js":function(module,exports,__webpack_require__){"use strict";let modules=__webpack_require__("./js/modules/moduleindex.js");const BisWebDataObjectCollection=__webpack_require__("./js/dataobjects/bisweb_dataobjectcollection.js");let inWorkerExecuteModule=function(obj,messageCommand){let id=obj.id,modulename=obj.modulename,parameters=obj.parameters,collection=new BisWebDataObjectCollection;collection.parseFromDictionary(obj.inputs);let numitems=collection.getNumberOfItems(),inputs={};for(let i=0;i<numitems;i++){let item=collection.getItem(i);0,inputs[item.metadata]=item.data}let module=modules.getModule(modulename);module.execute(inputs,parameters).then(()=>{module.storeCommentsInOutputs("WebWorker",parameters,"WebWorker");let outcollection=new BisWebDataObjectCollection;module.getDescription().outputs.forEach(opt=>{let outobj=module.getOutputObject(opt.varname);outobj&&outcollection.addItem(outobj,opt.varname)});let output={modulename:modulename,id:id,parameters:parameters,outputs:outcollection.serializeToDictionary()};module.cleanupMemory(),messageCommand(JSON.stringify(output))}).catch(e=>{let a=JSON.stringify({modulename:modulename,id:id,error:e,parameters:parameters,outputs:[],details:"Failed to execute module"+modulename});messageCommand(a)})};const workerparams={lastjob:0,pending:{}};let inMainThreadModuleDone=function(obj){let modulename=obj.modulename,id=obj.id,collection=new BisWebDataObjectCollection;collection.parseFromDictionary(obj.outputs);let numitems=collection.getNumberOfItems(),outputs={};for(let i=0;i<numitems;i++){let item=collection.getItem(i);0,outputs[item.metadata]=item.data}let clb=workerparams.pending[id];clb.modulename===modulename?(delete workerparams.pending[id],clb.callback(outputs)):console.log("id "+id+" does not exist in pending job collection")},DummyWorker={messageCommand:function(str){console.log("\n\n-------------------------------------------\nwwww In dummy message command ",str.length);let obj=JSON.parse(str);console.log("wwww Calling inMainThreadModuleDone",Object.keys(obj)),inMainThreadModuleDone(obj)},postMessage:function(str){console.log("\n\n-------------------------------------------\nwwww In dummy post message ",str.length);let obj=JSON.parse(str);console.log("wwww Calling inWorkerExecuteModule",Object.keys(obj)),inWorkerExecuteModule(obj,this.messageCommand)}};module.exports={inWorkerExecuteModule:inWorkerExecuteModule,inMainThreadModuleDone:inMainThreadModuleDone,inMainThreadExecuteModule:function(worker,modulename,inputs,params,callback=null){workerparams.lastjob=workerparams.lastjob+1;let keys=Object.keys(inputs),collection=new BisWebDataObjectCollection;for(let i=0;i<keys.length;i++){let inpobj=inputs[keys[i]];inpobj&&collection.addItem(inpobj,keys[i])}let id=workerparams.lastjob,obj={modulename:modulename,parameters:params,inputs:collection.serializeToDictionary(),id:id};workerparams.pending[id]={modulename:modulename,parameters:params,callback:callback},worker.postMessage(JSON.stringify(obj))},DummyWorker:DummyWorker}},"./js/node/misac_util.js":function(module,exports,__webpack_require__){"use strict";const bisgenericio=__webpack_require__("./js/core/bis_genericio.js"),path=bisgenericio.getpathmodule(),BisWebImage=__webpack_require__("./js/dataobjects/bisweb_image.js"),linearRegistration=__webpack_require__("./js/modules/linearRegistration.js"),motionCorrection=__webpack_require__("./js/modules/motionCorrection.js"),misacUtil={loadJob:function(f){return new Promise((resolve,reject)=>{bisgenericio.readJSON(f,"ParavisionJob").then(obj=>{let out=obj.data.job;resolve(out)}).catch(e=>{console.log(e.stack),reject(e)})})},getItemsWithTag:function(lst,tag){let outlist=[];for(let i=0;i<lst.length;i++)lst[i].tag===tag&&outlist.push(lst[i]);return outlist},loadList:function(lst){let p=[],imagelist=[];for(let i=0;i<lst.length;i++){console.log("Looking at path",lst[i].filename,this.globaldir);let fname="";fname=path.isAbsolute(lst[i].filename)?lst.filename:path.resolve(path.join(this.globaldir,lst[i].filename));let img=new BisWebImage;imagelist.push(img),p.push(img.load(fname))}return new Promise((resolve,reject)=>{Promise.all(p).then(()=>{resolve(imagelist)}).catch(e=>{console.log(e.stack),reject(e)})})},fuseImages:function(imagelist){let refimg=imagelist[0],p=[],reglist=[];console.log("Image list length=",imagelist.length);for(let i=1;i<imagelist.length;i++){let reg=new linearRegistration;reglist.push(reg),console.log("Registering\n\t",imagelist[0].getFilename()," and \n\t ",imagelist[i].getFilename(),"\n\n"),p.push(reg.execute({reference:imagelist[0],target:imagelist[i]},{mode:"Rigid",debug:!1,doreslice:!0}))}return new Promise((resolve,reject)=>{Promise.all(p).then(()=>{let outputimage=new BisWebImage;outputimage.cloneImage(refimg);let outdata=outputimage.getImageData(),idatalist=[refimg.getImageData()];for(let i=0;i<reglist.length;i++){let res=reglist[i].getOutputObject("resliced");console.log("++++ Result=",res.getDescription()),idatalist.push(res.getImageData())}for(let v=0;v<outdata.length;v++){let sum=0;for(let i=0;i<idatalist.length;i++)sum+=idatalist[i][v];outdata[v]=sum/idatalist.length}resolve(outputimage)}).catch(e=>{console.log(e.stack),reject(e)})})},averageImages:function(origlist,name){let lst=this.getItemsWithTag(origlist,name);return new Promise((resolve,reject)=>{this.loadList(lst).then(imagelist=>{this.fuseImages(imagelist).then(output=>{console.log("\n++++ Output image=",output.getDescription()),resolve(output)})}).catch(e=>{console.log(e.stack),reject(e)})})},registerAverageImages:function(image1,image2){return new Promise((resolve,reject)=>{let reg=new linearRegistration;console.log("Registering Average Images\n\t",image1.getDescription()," and \n\t ",image2.getDescription(),"\n\n"),reg.execute({reference:image1,target:image2},{mode:"Rigid",debug:!1,doreslice:!1}).then(()=>{let transform=reg.getOutputObject("output");resolve(transform)}).catch(e=>{console.log(e.stack),reject(e)})})},motionCorrectImages:function(origlist,globaldir=null){globaldir&&(this.globaldir=globaldir);let lst=this.getItemsWithTag(origlist,"EPI");return lst=[lst[0]],console.log("++++ List(EPI)=",JSON.stringify(lst)),new Promise((resolve,reject)=>{this.loadList(lst).then(imagelist=>{let count=0,motlist=[],p=[];for(let i=0;i<imagelist.length;i++){let mot=new motionCorrection;motlist.push(mot),console.log("Motion Correcting\n\t",imagelist[i].getFilename()," to \n\t ",imagelist[0].getFilename(),"\n\n"),p.push(mot.execute({reference:imagelist[0],target:imagelist[i]},{mode:"Rigid",debug:!1,levels:1,steps:1,resolution:2,iterations:1,doreslice:!0}))}Promise.all(p).then(()=>{console.log("++++ Now saving");for(let i=0;i<imagelist.length;i++){let output=motlist[i].getOutputObject("resliced");console.log("\n++++ Output image=",output.getDescription());let fname=path.parse(imagelist[0].getFilename()).name,outname=this.outfilename+"_"+fname+"_mot.nii.gz";output.save(outname).then(n=>{console.log("+++++ \t saved corrected in "+n),(count+=1)===imagelist.length&&resolve()})}})}).catch(e=>{console.log(e.stack),reject(e)})})},createAverageAnatomical(obj,outfilename){this.globaldir=path.dirname(outfilename);const self=this;let names=["3DAnatomical","2DAnatomical"];return new Promise((resolve,reject)=>{Promise.all([self.averageImages(obj,names[0]),self.averageImages(obj,names[1])]).then(imglist=>{let outname=["","",""];for(let i=0;i<imglist.length;i++){let nm=names[i].toLowerCase();outname[i]=outfilename+`_average_${nm}.nii.gz`}self.registerAverageImages(imglist[0],imglist[1]).then(xform=>{let objlist=[imglist[0],imglist[1],xform];outname[2]=outfilename+"_3danat_2danat.matr",resolve({objlist:objlist,outnamelist:outname,names:["Average3D","Average2D","Map3Dto2D"]})}).catch(e=>{reject(e)})}).catch(e=>{reject(e)})})},setGlobalPaths(inpfilename,outfilename){this.globaldir=path.dirname(path.resolve(inpfilename)),this.outfilename=outfilename},mainFunction:function(inpfilename,outfilename,opmode="anatomical"){this.setGlobalPaths(inpfilename,outfilename),"motion"!==opmode&&(opmode="anatomical");const self=this;return console.log("++++ Ready to begin:",inpfilename,self.globaldir,self.outfilename,opmode),new Promise((resolve,reject)=>{self.loadJob(inpfilename).then(obj=>{if("anatomical"===opmode){let names=["3DAnatomical","2DAnatomical"];Promise.all([self.averageImages(obj,names[0]),self.averageImages(obj,names[1])]).then(imglist=>{let outname=["","",""];for(let i=0;i<imglist.length;i++){let nm=names[i].toLowerCase();outname[i]=this.outfilename+`_average_${nm}.nii.gz`}self.registerAverageImages(imglist[0],imglist[1]).then(xform=>{let objlist=[imglist[0],imglist[1],xform];outname[2]=this.outfilename+"_3danat_2danat.matr",resolve({objlist:objlist,outnamelist:outname,names:["Average3D","Average2D","Map3Dto2D"]})})})}else"motion"===opmode&&self.motionCorrectImages(obj).then(()=>{resolve("Done "+opmode)}).catch(e=>{console.log(e.stack),reject(e)})}).catch(e=>{console.log(e.stack),console.log(e),reject(e)})})}};module.exports=misacUtil},"./js/webcomponents/bislib.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__("./js/core/bis_util.js"),__webpack_require__("./js/core/bis_simplemat.js"),__webpack_require__("./js/webtest/bisweb_regressiontestelement.js"),__webpack_require__("./js/webtest/bisweb_displayregressionelement.js"),__webpack_require__("./js/webcomponents/bisweb_dialogelement.js"),__webpack_require__("./js/webcomponents/bisweb_collectionelement.js"),__webpack_require__("./js/webcomponents/bisweb_draganddropelement.js"),__webpack_require__("./js/webcomponents/bisweb_components.js"),__webpack_require__("./js/webcomponents/bisweb_viewerlayoutelement.js"),__webpack_require__("./js/webcomponents/bisweb_colormapcontrollerelement.js"),__webpack_require__("./js/webcomponents/bisweb_mosaicviewerelement.js"),__webpack_require__("./js/webcomponents/bisweb_orthogonalviewerelement.js"),__webpack_require__("./js/webcomponents/bisweb_landmarkcontrolelement.js"),__webpack_require__("./js/webcomponents/bisweb_atlastoolelement.js"),__webpack_require__("./js/webcomponents/bisweb_blobanalyzerelement.js"),__webpack_require__("./js/webcomponents/bisweb_painttoolelement.js"),__webpack_require__("./js/webcomponents/bisweb_snapshotelement.js"),__webpack_require__("./js/webcomponents/bisweb_console.js"),__webpack_require__("./js/webcomponents/bisweb_grapherelement.js"),__webpack_require__("./js/webcomponents/bisweb_simplealgorithmcontroller.js"),__webpack_require__("./js/webcomponents/bisweb_modulemanagerelement.js"),__webpack_require__("./js/webcomponents/bisweb_connectivitycontrolelement.js"),__webpack_require__("./js/webcomponents/bisweb_paravisionimportelement.js"),__webpack_require__("./js/webcomponents/bisweb_mni2talelement.js"),__webpack_require__("./js/webcomponents/bisweb_paravisionapplicationelement.js"),__webpack_require__("./js/webcomponents/bisweb_connectivityapplicationelement.js"),__webpack_require__("./js/webcomponents/bisweb_mainviewerapplication.js"),__webpack_require__("./js/webcomponents/bisweb_dualviewerapplication.js"),__webpack_require__("./js/webcomponents/bisweb_webworkercontroller.js"),__webpack_require__("./js/webcomponents/bisweb_diffspectelement.js"),__webpack_require__("./js/webcomponents/bisweb_fmrielement.js"),__webpack_require__("./js/cloud/bisweb_awsmodule.js"),__webpack_require__("./js/coreweb/bisweb_fileserverclient.js"),__webpack_require__("./js/webcomponents/bisweb_misactool.js"),__webpack_require__("./js/webcomponents/bisweb_filetreepanel.js"),__webpack_require__("./js/webcomponents/bisweb_dicomimportelement.js");const webutil=__webpack_require__("./js/coreweb/bis_webutil.js"),webfileutil=__webpack_require__("./js/coreweb/bis_webfileutil.js");let exportobj=__webpack_require__("./js/export/bisweb_exportobject.js");exportobj.webutil=webutil,exportobj.webfileutil=webfileutil,__webpack_exports__.default=exportobj},"./js/webcomponents/bisweb_atlastoolelement.js":function(module,exports,__webpack_require__){"use strict";const util=__webpack_require__("./js/core/bis_util.js"),webutil=__webpack_require__("./js/coreweb/bis_webutil.js"),bis_genericio=__webpack_require__("./js/core/bis_genericio.js"),$=__webpack_require__("jquery"),BisWebPanel=__webpack_require__("./js/coreweb/bisweb_panel.js"),BisWebImage=__webpack_require__("./js/dataobjects/bisweb_image.js");webutil.defineElement("bisweb-atlastoolelement",class extends HTMLElement{constructor(){super(),this.currentAtlas=null,this.panel=null;let imagepath=webutil.getWebPageImagePath();this.atlaspath=imagepath+"/atlases/",this.atlaslist=null;let mastername=this.atlaspath+"atlaslist.json";this.atlaslabelimage=null,this.atlasdescription=null,this.atlasdimensions=null,this.atlasspacing=null,this.atlasslicesize=0,this.atlasvolumesize=0,this.useAtlas=!1,this.tablebody=null,this.orientation="",this.atlasOrientation="",this.flips=[0,0,0],this.atlasLoaded=new Promise((resolve,reject)=>{bis_genericio.read(mastername).then(obj=>{let data=obj.data;this.atlaslist=null;try{this.atlaslist=JSON.parse(data)}catch(e){console.log(e)}resolve()}).catch(e=>{console.log(e,e.stack),reject()})})}compareDimensions(imgdim,imgspa,atlasdim,atlasspa,factor=2){let agrees=!0;for(let i=0;i<=2;i++){let sz=imgdim[i]*imgspa[i],asz=atlasdim[i]*atlasspa[i];Math.abs(sz-asz)>factor*atlasspa[i]&&(agrees=!1)}return agrees}removeAtlas(){this.useAtlas=!1,this.panel&&(this.parentDomElement.empty(),this.parentDomElement.append($("<div>There is no suiteable atlas for this image.</div>")),this.panel.hide())}setFlips(){if(this.flips=[0,0,0],this.orientation!==this.atlasOrientation)for(let i=0;i<=2;i++)this.orientation.substr(i,1)!==this.atlasOrientation.substr(i,1)&&(this.flips[i]=1)}initialize(subviewers,volume,samesize=!1){if(!0===samesize&&null!==this.currentAtlas)return;if(null===this.atlaslist)return;let dim=volume.getDimensions(),spa=volume.getSpacing();if(this.orientation=volume.getOrientationName(),"LPS"!==this.orientation&&"RAS"!==this.orientation&&"LAS"!==this.orientation)return void this.removeAtlas();if(this.atlaslabelimage){let atlasdim=this.atlaslabelimage.getDimensions(),atlasspa=this.atlaslabelimage.getSpacing();if(this.compareDimensions(dim,spa,atlasdim,atlasspa))return this.setFlips(),this.useAtlas=!0,this.createGUITable(),void this.updateGUI(this.queryAtlas(this.orthoviewer.getmmcoordinates()))}this.useAtlas=!1;let found=!1,i=0,keys=Object.keys(this.atlaslist);for(;i<keys.length&&!1===found;){let atlasdim=this.atlaslist[keys[i]].dimensions,atlasspa=this.atlaslist[keys[i]].spacing;this.compareDimensions(dim,spa,atlasdim,atlasspa)?found=!0:i+=1}if(found){let atlas=this.atlaslist[keys[i]];bis_genericio.read(this.atlaspath+atlas.filename).then(obj=>{try{let data=JSON.parse(obj.data);this.initializeAtlas(data)}catch(e){console.log(e)}}).catch(e=>{console.log(e),this.removeAtlas()})}else this.removeAtlas()}initializeAtlas(data){let img=new BisWebImage;img.load(this.atlaspath+data.labels.filename,"NONE").then(()=>{console.log(".... Atlas loaded ",img.getDescription()),this.useAtlas=!0,this.atlaslabelimage=img,this.atlasdescription=data,this.atlasdimensions=img.getDimensions(),this.atlasspacing=img.getSpacing(),this.atlasslicesize=this.atlasdimensions[0]*this.atlasdimensions[1],this.atlasvolumesize=this.atlasslicesize*this.atlasdimensions[2],this.atlasOrientation=img.getOrientationName(),this.createGUITable()}).catch(e=>{webutil.createAlert("Could not load atlas image from "+this.atlaspath+data.labels.filename+" "+e,!0),this.removeAtlas()})}createGUITable(){this.parentDomElement.empty();let templates=webutil.getTemplates(),newid=webutil.createWithTemplate(templates.bisscrolltable,$("body")),stable=$("#"+newid),thead=stable.find(".bisthead"),tbody=stable.find(".bistbody",stable);thead.empty(),tbody.empty(),tbody.css({"font-size":"11px","user-select":"none"}),thead.css({"font-size":"14px","user-select":"none"}),thead.append($(`<tr><td width="10%"></td><td width="90%">${this.atlasdescription.labels.description}</td></tr>`)),thead.append($("<tr><BR></tr>")),this.tablebody=tbody,this.parentDomElement.append(stable),this.setFlips(),this.updateGUI(this.queryAtlas(this.orthoviewer.getmmcoordinates()))}updateGUI(results){this.tablebody.empty();let w=`<tr><td width="50%">Coordinates (mm)</td><td width="50%">${results.coords.join(", ")}</td></tr>`;this.tablebody.append($(w));for(let i=0;i<results.data.length;i++){let elem=results.data[i],w=$(`<tr>\n                    <td width="50%">${elem.name}</td>\n                    <td width="50%">${elem.desc}</td>\n                    </tr>`);this.tablebody.append(w)}}updatemousecoordinates(mm,plane,mousestate){this.useAtlas&&void 0!==mousestate&&2!==mousestate&&this.panel.isOpen()&&this.updateGUI(this.queryAtlas(mm))}queryAtlas(mm){let voxelcoords=[0,0,0,0];for(let i=0;i<=2;i++)voxelcoords[i]=util.range(mm[i]*this.atlasspacing[i],0,this.atlasdimensions[i]-1),this.flips[i]&&(voxelcoords[i]=this.atlasdimensions[i]-1-voxelcoords[i]);let results={coords:[mm[0],mm[1],mm[2]],data:[]};if(this.atlasdescription.labels.coordinates){let atlas=[0,0,0],offsets=this.atlasdescription.labels.coordinates.offsets;for(let i=0;i<=2;i++)atlas[i]=voxelcoords[i]-offsets[i];results.data.push({name:this.atlasdescription.labels.coordinates.name,desc:atlas.join(", ")})}let data=this.atlasdescription.labels.data;for(let j=0;j<this.atlasdimensions[3];j++){voxelcoords[3]=j;let elem=data[j];if(""!==elem.name){let v=this.atlaslabelimage.getVoxel(voxelcoords),desc=elem.labels[v]||"None";desc&&results.data.push({name:elem.name,desc:desc})}}return results}connectedCallback(){let viewerid=this.getAttribute("bis-viewerid"),layoutid=this.getAttribute("bis-layoutwidgetid"),layoutcontroller=document.querySelector(layoutid);this.panel=new BisWebPanel(layoutcontroller,{name:"Atlas Tool",permanent:!1,width:"290",dual:!1}),this.parentDomElement=this.panel.getWidget(),this.parentDomElement.append($("<div>This will appear once an image is loaded.</div>")),this.orthoviewer=document.querySelector(viewerid),this.orthoviewer.addMouseObserver(this)}show(){this.panel.show()}isOpen(){return this.panel.isOpen()}})},"./js/webcomponents/bisweb_baseviewerelement.js":function(module,exports,__webpack_require__){"use strict";const util=__webpack_require__("./js/core/bis_util.js"),webutil=__webpack_require__("./js/coreweb/bis_webutil.js"),$=__webpack_require__("jquery"),bootbox=__webpack_require__("./node_modules/bootbox/bootbox.js"),BisWebImage=__webpack_require__("./js/dataobjects/bisweb_image.js");module.exports=class extends HTMLElement{constructor(){super(),this.internal={this:null,name:"viewer",layoutcontroller:null,cmapcontroller:null,colormapobservers:[],mouseobservers:[],resizeobservers:[],framechangedobservers:[],imagechangedobservers:[],ignorecolormapobservers:!1,ignoreimageobservers:!1,ignoreframeobservers:!1,ignoremouseobservers:!1,volume:null,objectmap:null,imagespa:[1,1,1],maximagespa:1,objectmapspa:[1,1,1],imagedim:[0,0,0],objectmapshift:[0,0,0],maxnumframes:0,showdecorations:!0,lockcursor:!1,datgui:{data:{},gui:null,coords:null},subviewers:null,slices:null,overlayslices:null,ismosaic:!1,snapshotcontroller:null,preservesnapshot:!1,objectmaptransferfunction:util.mapobjectmapfactory(255),objectmaptransferinfo:{isfunctional:!1,colormode:"Overlay"},framecontroller:null,enable_renderloop_flag:!0,play_movie_controller:null,pending_render:!1},this.is_slave_viewer=!1,this.slave_viewer=null,this.master_viewer=null,this.cleararea=[0,1],this.internal.saveState=null,this.internal.viewerleft=null}setName(name){this.internal.name=name}getName(){return this.internal.name}getViewerCrossHairs(){return null}getColormapController(){return this.internal.cmapcontroller}disableClustering(){let cmapcontrol=this.getColormapController(),elem=cmapcontrol.getElementState();elem.clustersize=0,cmapcontrol.setElementState(elem),cmapcontrol.updateTransferFunctions(!0)}getViewerDimensions(){return[this.internal.layoutcontroller.getviewerwidth(),this.internal.layoutcontroller.getviewerheight()]}setSlaveViewer(other){this.slave_viewer=other,this.addMouseObserver(other),this.addResizeObserver(other),other.addMouseObserver(this),this.internal.pending_render||this.renderloop()}playStopMovie(val){let data=this.internal.datgui.data;if(void 0!==val?data.playing=val:this.internal.play_movie_controller&&this.internal.play_movie_controller.updateDisplay(),!data.playing)return;let delay=1e3/data.rate;this.setframe(this.getframe()+1);const self=this;setTimeout(function(){self.playStopMovie()},delay)}createmoviecontrols(moviefolder){let data=this.internal.datgui.data;data.rate=20,data.playing=!1,moviefolder.add(data,"rate",1,40).name("Frames/s"),this.internal.play_movie_controller=moviefolder.add(data,"playing").name("Play Movie"),this.internal.play_movie_controller.onChange(val=>{this.playStopMovie(val)})}deleteoldobjectmap(){if(this.clearcolorscale(),null===this.internal.overlayslices||null===this.internal.subviewers)return void(this.internal.objectmap=null);let l=this.internal.overlayslices.length;for(let i=0;i<l;i++)null!==this.internal.overlayslices[i]&&(this.internal.overlayslices[i].removefromscene(this.internal.subviewers[i].scene),this.internal.overlayslices[i].cleanup(),this.internal.overlayslices[i]=null);this.internal.objectmap=null}deleteoldimage(samesize=!1){if(samesize||this.deleteoldobjectmap(),null===this.internal.volume)return;if(null===this.internal.subviewers)return;let l=this.internal.subviewers.length;for(let i=0;i<l;i++)null!==this.internal.subviewers[i]&&(null!==this.internal.slices[i]&&(this.internal.slices[i].removefromscene(this.internal.subviewers[i].scene),this.internal.slices[i].cleanup(),this.internal.slices[i]=null),!1===samesize&&(this.internal.subviewers[i].controls.remove(),this.internal.subviewers[i].controls=null,this.internal.subviewers[i].scene=null,this.internal.subviewers[i].camera=null,this.internal.subviewers[i]=null))}setSnapShotController(cont){this.internal.snapshotcontroller=cont}getSnapShotController(){return this.internal.snapshotcontroller}savenextrender(controller){return this.internal.preservesnapshot=!0,this.internal.snapshotcontroller=controller,!0}getmaxviewers(){return null===this.subviewers?0:this.internal.subviewers.length}disable_renderloop(){this.enable_renderloop_flag=!1,this.playStopMovie(!1),null!==this.internal.play_movie_controller&&this.internal.play_movie_controller.updateDisplay()}enable_renderloop(){this.enable_renderloop_flag=!0}renderloop(){const self=this;let numviewers=self.getmaxviewers();if(this.internal.pending_render=!1,!this.enable_renderloop_flag&&null===this.slave_viewer||this.is_slave_viewer||(this.internal.pending_render=!0,window.requestAnimationFrame(function(){self.renderloop()})),this.enable_renderloop_flag){let subviewers=this.internal.subviewers,renderer=this.internal.layoutcontroller.renderer;this.is_slave_viewer||renderer.clear();for(let i=0;i<subviewers.length;i++)if(null!==this.internal.subviewers[i]){let vp=this.internal.subviewers[i].controls.normViewport;vp.x1-vp.x0>.01&&vp.y1-vp.y0>.01&&!0===subviewers[i].controls.update(this.internal.layoutcontroller.renderer)&&i<numviewers?(renderer.render(subviewers[i].scene,subviewers[i].camera),subviewers[i].controls.enabled=!0):subviewers[i].controls.enabled=!1}}if(!0===this.internal.preservesnapshot&&null!==this.internal.snapshotcontroller){let t=this.internal.layoutcontroller.renderer.domElement.toDataURL();this.internal.preservesnapshot=!1;let hasColorbar=!0;this.internal.simplemode&&(hasColorbar=!1),this.internal.snapshotcontroller.update(t,hasColorbar)}return null!==this.slave_viewer&&this.slave_viewer.renderloop(),0}clearcolorscale(){let context=this.internal.layoutcontroller.overlaycontext,fullwidth=this.internal.layoutcontroller.getviewerwidth(),dw=fullwidth*this.cleararea[1];if(dw<500)return;let dh=this.internal.layoutcontroller.getviewerheight(),y0=.92*dh;if(this.internal.ismosaic)context.clearRect(0,y0-5,fullwidth,dh-y0+5);else{let v=[(this.cleararea[0]+.5*this.cleararea[1])*fullwidth,y0-5,.5*dw,dh-y0+5];context.clearRect(v[0],v[1],v[2],v[3])}}drawcolorscale(){if(this.clearcolorscale(),null===this.internal.objectmap||!0!==this.internal.objectmaptransferinfo.isfunctional)return;let context=this.internal.layoutcontroller.overlaycontext,fullwidth=this.internal.layoutcontroller.getviewerwidth(),dw=fullwidth*this.cleararea[1];if(dw<500)return;let dh=this.internal.layoutcontroller.getviewerheight(),y0=.92*dh,fnsize=webutil.getfontsize(context.canvas);dw<1700&&(fnsize=Math.round(dw/1700*fnsize));let colorfunction=this.internal.objectmaptransferfunction;this.internal.objectmaptransferinfo.clustersize>0&&(colorfunction=this.internal.objectmaptransferinfo.mapfunction);let md=this.internal.objectmaptransferinfo.overlay,minv=this.internal.objectmaptransferinfo.minth,maxv=this.internal.objectmaptransferinfo.maxth,numsteps=14,numpass=1,wd=.45*dw/(numsteps+1);maxv<=minv&&(maxv=minv+1);let dvalue=maxv-minv,dv=dvalue/numsteps;if(!0===md)if(3===this.internal.objectmaptransferinfo.cmode)dv=(maxv-minv)/(numsteps=8),numpass=2,wd=.45*dw/(2*(numsteps+1)+1);else if(2===this.internal.objectmaptransferinfo.cmode){let a=minv;minv=-maxv,maxv=-a}let map=[0,0,0,0],data=[0],x0=.52*dw;this.internal.ismosaic&&(x0=.275*dw),x0+=this.cleararea[0]*fullwidth;let ht=.5*(dh-(y0+=2));ht>wd&&(ht=wd);let power=10;dvalue>100&&(power=1),dvalue<.1&&(power=100);for(let pass=0;pass<numpass;pass++){context.fillStyle="#888888",context.fillRect(x0-2,y0-2,wd*(numsteps+1)+3,ht+4);for(let i=0;i<=numsteps;i++)data[0]=1===numpass||1===pass?minv+i*dv:-(maxv-dv*i),colorfunction(data,0,map),context.fillStyle=util.rgbToHex(map[0],map[1],map[2]),context.fillRect(x0+1,y0,wd-2,ht),0!==i&&i!==numsteps&&i!==numsteps/2||(context.strokeStyle="#888888",context.lineWidth=3,context.beginPath(),context.moveTo(x0+.5*(wd-1),y0+.9*ht),context.lineTo(x0+.5*(wd-1),y0+1.4*ht),context.stroke(),context.lineWidth=1,context.fillStyle="#888888",context.fontSize=`${fnsize}px Arial`,0===i?(context.textAlign=0===pass||1===numpass?"center":"left",context.fillText(util.scaledround(data[0],power),x0+.1*(wd-1),dh-4)):i===numsteps?(context.textAlign=0===pass&&2==numpass?"right":"center",context.fillText(util.scaledround(data[0],power),x0+.9*(wd-1),dh-4)):(context.textAlign="center",context.fillText(util.scaledround(data[0],power),x0+.5*(wd-1),dh-4))),x0+=wd;x0+=wd}}handleresize(){let width=this.internal.layoutcontroller.getviewerwidth();if(!(width<2||void 0===width)&&(this.is_slave_viewer||this.internal.layoutcontroller.handleresize(),null!==this.internal.subviewers))for(let i=0;i<this.internal.subviewers.length;i++)null!==this.internal.subviewers[i]&&this.internal.subviewers[i].controls.handleResize()}updatetransferfunctions(input){let num=this.internal.slices.length;if(null!==input.image){this.internal.imagetransferfunction=input.image;for(let pl=0;pl<num;pl++)this.internal.slices[pl].setnexttimeforce()}for(let pl=0;pl<num;pl++)this.internal.slices[pl].interpolate(input.interpolate);if(null!==this.internal.overlayslices[0]){if(null!==input.objectmap){this.internal.objectmaptransferfunction=input.objectmap,this.internal.objectmaptransferinfo=input.functionalparams;for(let pl=0;pl<num;pl++)null!==this.internal.overlayslices[pl]&&this.internal.overlayslices[pl].setnexttimeforce()}for(let pl=0;pl<num;pl++)null!==this.internal.overlayslices[pl]&&this.internal.overlayslices[pl].interpolate(input.objinterpolate)}this.setcoordinates(),this.updateColormapObservers(input),this.drawcolorscale()}getimage(){return this.internal.volume}getobjectmap(){return this.internal.objectmap}getcolortype(){return this.internal.objectmaptransferinfo.colormode}addColormapObserver(v){this.internal.colormapobservers.push(v)}updateColormapObservers(input){const self=this;this.internal.ignorecolormapobservers||(this.internal.ignorecolormapobservers=!0,this.internal.colormapobservers.forEach(function(f){f.updatecmap(self.internal.cmapcontroller,input)}),setTimeout(()=>{this.internal.ignorecolormapobservers=!1}))}updatecmap(other,input){!0!==this.internal.ignorecolormapobservers&&!0!==this.internal.ignoreimageobservers&&null!==this.internal.cmapcontroller&&null!==this.internal.volume&&(this.internal.cmapcontroller.setElementState(other.getElementState()),this.updatetransferfunctions(input))}addMouseObserver(v){this.internal.mouseobservers.push(v)}updateMouseObservers(mm,plane,mousestate){0!==this.internal.mouseobservers.length&&(this.internal.ignoremouseobservers=!0,this.internal.mouseobservers.forEach(function(f){f.updatemousecoordinates(mm,plane,mousestate)}),this.internal.ignoremouseobservers=!1)}addResizeObserver(v){this.internal.resizeobservers.push(v)}removeResizeObserver(v){let i=this.internal.resizeobservers.indexOf(v);i<0||this.internal.resizeobservers.splice(i,1)}updateResizeObservers(){if(0===this.internal.resizeobservers.length)return;let d=this.getViewerDimensions();this.internal.resizeobservers.forEach(function(f){f.handleresize(d)})}initializeMouseObservers(samesize=!1){if(0===this.internal.mouseobservers.length)return;const self=this;this.internal.mouseobservers.forEach(function(f){null!==(f.initialize||null)&&f.initialize(self.internal.subviewers,self.internal.volume,samesize)})}addImageChangedObserver(v){this.internal.imagechangedobservers.push(v)}removeImageChangedObserver(v){let i=this.internal.imagechangedobservers.indexOf(v);i<0||this.internal.imagechangedobservers.splice(i,1)}updateImageChangedObservers(mode="image"){0!==this.internal.imagechangedobservers.length&&(this.internal.ignoreimageobservers=!0,this.internal.imagechangedobservers.forEach(f=>{f.handleViewerImageChanged(this,mode,this.internal.objectmaptransferinfo.colormode)}),this.internal.ignoreimageobservers=!1)}handleViewerImageChanged(viewer,source,colortype){if(!0===this.internal.ignoreimageobservers)return;let img=null;if(img="overlay"===source?viewer.getobjectmap():viewer.getimage(),this.internal.ignoreimageobservers=!0,"overlay"===source){let plainmode=!1;null!==img?this.setobjectmap(img,plainmode,colortype):this.clearobjectmap()}else this.setimage(img);this.internal.ignoreimageobservers=!1}addFrameChangedObserver(v){this.internal.framechangedobservers.push(v)}removeFrameChangedObserver(v){let i=this.internal.framechangedobservers.indexOf(v);i<0||this.internal.framechangedobservers.splice(i,1)}updateFrameChangedObservers(){if(0===this.internal.framechangedobservers.length||!this.internal.volume)return;this.internal.ignoreframeobservers=!0;let frame=this.getframe();this.internal.framechangedobservers.forEach(f=>{f.handleFrameChanged(frame)}),this.internal.ignoreframeobservers=!1}handleFrameChanged(frame){!this.internal.ignoreframeobservers&&this.internal.volume&&this.setframe(frame)}finalizeTools(){return this.internal.layoutcontroller.getdockbar().collapse()}collapseCore(){let w=this.internal.layoutcontroller.getcorecontrols();$(w[0]).removeClass("in")}resetViewers(){this.internal.subviewers.forEach(function(f){null!==f&&f.controls.reset()})}zoomViewers(factor=.9){this.internal.subviewers.forEach(function(f){null!==f&&(f.controls.zoomCamera(factor),f.controls.update())})}connectedCallbackBase(){const self=this;let layoutwidgetid=this.getAttribute("bis-layoutwidgetid"),simple=this.getAttribute("bis-simplemode");this.internal.simplemode=!1,"1"!==simple&&"true"!==simple||(this.internal.simplemode=!0),this.internal.layoutcontroller=document.querySelector(layoutwidgetid);let rs=function(){this.is_slave_viewer||self.handleresize()};window.addEventListener("resize",rs),this.internal.layoutcontroller.addEventListener("resize",rs);let otherid=this.getAttribute("bis-otherviewer");null!==otherid&&(this.is_slave_viewer=!0,this.master_viewer=document.querySelector(otherid),this.master_viewer.setSlaveViewer(this))}getInsideViewer(x){let dw=this.internal.layoutcontroller.getviewerwidth();return!(x<dw*this.cleararea[0]||x>dw*(this.cleararea[0]+this.cleararea[1]))}setDualViewerMode(left=.5){this.is_slave_mode||(this.internal.viewerleft=left,left>.9?(this.setViewerMode("right",0),this.master_viewer.setViewerMode("full",1)):left<.1?(this.master_viewer.setViewerMode("left",0),this.setViewerMode("full",1)):(this.master_viewer.setViewerMode("left",left),this.setViewerMode("right",1-left)),this.master_viewer.handleresize())}setViewerMode(mode="full",size=.5){if("left"!==mode&&"right"!==mode&&(mode="full"),"full"===mode)this.cleararea=[0,1];else{let shift=0;"right"===mode&&(shift=1-size),this.cleararea=[shift,size]}return mode}viewerInformation(){let a="No image loaded";this.internal.volume&&(a=this.internal.volume.getDetailedDescription("Image"));let b="No overlay loaded";this.internal.objectmap&&(b=this.internal.objectmap.getDetailedDescription("Overlay"));const output='<div style="margin-left:5px; margin-right:5px; margin-top:5px; overflow-y: auto; position:relative; color:#fefefe; width:100%; background-color:#000000;">'+a+"<BR> <BR>"+b+"</div>";bootbox.dialog({title:"Viewer Information",message:output})}getElementState(storeImages=!1){let obj={image:"",overlay:"",colortype:""};if(this.internal.cmapcontroller&&(obj.colormap=this.internal.cmapcontroller.getElementState()),this.internal.viewerleft&&(obj.viewerleft=this.internal.viewerleft),this.internal.snapshotcontroller&&(obj.snapshotcontroller=this.internal.snapshotcontroller.getElementState()),storeImages){let img=this.getimage();if(img){obj.image=img.serializeToJSON(!1);let objmap=this.getobjectmap();objmap&&(obj.overlay=objmap.serializeToJSON(!1),obj.colortype=this.getcolortype())}}if(this.internal.subviewers){let n=this.internal.subviewers.length;if(n>0){obj.subviewers=[];for(let i=0;i<n;i++)if(this.internal.subviewers[i]){let p=this.internal.subviewers[i].controls.serializeCamera();obj.subviewers.push(p)}}}return obj}setElementState(dt=null){if(null!==dt){if(this.internal.ignorecolormapobservers=!0,dt.viewerleft&&(this.internal.viewerleft=dt.viewerleft),(dt.image||"").length>1){let newimg=new BisWebImage;if(newimg.parseFromJSON(dt.image),this.setimage(newimg),(dt.overlay||"").length>1){let newobj=new BisWebImage;newobj.parseFromJSON(dt.overlay);let colortype=dt.colortype||"Overlay",plainmode="Objectmap"===colortype;this.setobjectmap(newobj,plainmode,colortype)}}this.internal.ignorecolormapobservers=!1,this.internal.cmapcontroller&&(this.internal.cmapcontroller.setElementState(dt.colormap),this.internal.cmapcontroller.updateTransferFunctions(!0)),this.internal.snapshotcontroller&&this.internal.snapshotcontroller.setElementState(dt.snapshotcontroller)}}setElementStateCameras(dt=null){this.resetViewers();let subviewers=this.internal.subviewers;if(dt.subviewers&&subviewers){let num=subviewers.length;dt.subviewers.length<num&&(num=dt.subviewers.length);let renderer=this.internal.layoutcontroller.renderer;for(let i=0;i<num;i++)dt.subviewers[i]&&subviewers[i]&&(subviewers[i].controls.parseCamera(dt.subviewers[i]),renderer.render(subviewers[i].scene,subviewers[i].camera))}}storeState(){this.internal.saveState=this.getElementState()}restoreState(){this.internal.saveState&&this.setElementState(this.internal.saveState)}getLayoutController(){return this.internal.layoutcontroller}remapDimensionsTo4D(dim){dim[4]>1&&(dim[3]=dim[3]*dim[4],dim[4]=1)}}},"./js/webcomponents/bisweb_blobanalyzerelement.js":function(module,exports,__webpack_require__){"use strict";const webutil=__webpack_require__("./js/coreweb/bis_webutil.js"),webfileutil=__webpack_require__("./js/coreweb/bis_webfileutil.js"),$=__webpack_require__("jquery"),BisWebPanel=__webpack_require__("./js/coreweb/bisweb_panel.js"),genericio=__webpack_require__("./js/core/bis_genericio.js");webutil.defineElement("bisweb-blobanalyzerelement",class extends HTMLElement{constructor(){super(),this.clusterInfo=null,this.imageinfo=null,this.funcParams={minth:0,maxth:0,clustersize:0,cmode:-1},this.cnames=["minth","maxth","clustersize","cmode"],this.outputstring=""}cleanCache(){this.clusterInfo=null,this.outputstring="",this.parentDomElement.empty(),this.parentDomElement.append($('<div style="font-size:12px"><p>No Clusters to Examine. Please create\nan overlay as follows:</p> <OL> <LI> Load the underlying anatomical\nimage using the menu option File | Load Image</LI> <LI> Load the\nfunctional overlay using the menu option Overlay | Load Overlay</LI>\n<LI> Cluster the functional overlay by setting the Cluster Size\nparameter (found under "Overlay Color Mapping" in the "Viewer\nControls" tool on the far right of this window) to a value greater\nthan zero.</LI> </OL></div>'))}handleViewerImageChanged(){this.cleanCache()}updatecmap(mastercontroller,input){if(!input.functionalparams)return;let clinfo=this.orthoviewer.getColormapController().getClusterInfoData();if(null!==clinfo){if(null!==this.clusterInfo){let issame=!0,i=0;for(;i<this.cnames.length&&!0===issame;){let mine=this.funcParams[this.cnames[i]],theirs=input.functionalparams[this.cnames[i]]||-1e5;Math.abs(mine-theirs)>.001?issame=!1:i+=1}if(issame)return void console.log(".... No change")}for(let i=0;i<this.cnames.length;i++)this.funcParams[this.cnames[i]]=input.functionalparams[this.cnames[i]];this.clusterInfo=clinfo,this.panel.isOpen()&&this.updateDisplay()}else this.cleanCache()}updateDisplay(){if(!this.clusterInfo)return void this.cleanCache();let clustdata=this.clusterInfo.clusterimage.getImageData(),clusterhist=this.clusterInfo.clusterhist,numc=this.clusterInfo.numclusters,clusterinfo_i=new Array(numc+1),clusterinfo_t=new Array(numc+1);for(let i=0;i<=numc;i++)clusterinfo_t[i]=0,clusterinfo_i[i]=-1;let diffdata=this.orthoviewer.getobjectmap().getImageData(),cmode=this.funcParams.cmode,volsize=clustdata.length;for(let i=0;i<volsize;i++){let clusterno=Math.floor(clustdata[i]),v1=diffdata[i],v2=clusterinfo_t[clusterno];2===cmode?(v1=-v1,v2=-v2):3===cmode&&(v1=Math.abs(v1),v2=Math.abs(v2)),v1>v2&&(clusterinfo_t[clusterno]=diffdata[i],clusterinfo_i[clusterno]=i)}let outputdata=[],dim=this.clusterInfo.clusterimage.getDimensions(),slicesize=dim[0]*dim[1],cthr=this.funcParams.clustersize;for(let i=1;i<=numc;i++){let kSize=clusterhist[i];if(clusterinfo_i[i]>0&&kSize>=cthr){let ka=Math.floor(clusterinfo_i[i]/slicesize),t=clusterinfo_i[i]-ka*slicesize,ja=Math.floor(t/dim[0]),ia=t%dim[0],tval=clusterinfo_t[i],add=!0;(1===cmode&&tval<0||2===cmode&&tval>0)&&(add=!1),add&&outputdata.push({size:kSize,coords:[ia,ja,ka],maxt:tval})}}outputdata.sort((a,b)=>a.size<b.size?1:a.size>b.size?-1:0),this.updateTable(outputdata)}saveTextResults(fobj){fobj=genericio.getFixedSaveFileName(fobj,"results.csv"),genericio.write(fobj,this.outputstring).then(f=>{webutil.createAlert("Results saved in "+f)}).catch(e=>{webutil.createAlert("Failed to save results "+e,!0)})}updateTable(outputdata){const atlastoolid=this.getAttribute("bis-atlastoolid")||null;let atlascontrol=null,spa=null;atlastoolid&&(atlascontrol=document.querySelector(atlastoolid),spa=this.orthoviewer.getobjectmap().getSpacing()),this.parentDomElement.empty();let templates=webutil.getTemplates(),newid=webutil.createWithTemplate(templates.bisscrolltable,$("body")),stable=$("#"+newid);this.table=stable;let des=this.orthoviewer.getobjectmap().getDescription();this.parentDomElement.append(stable);let thead=stable.find(".bisthead"),tbody=stable.find(".bistbody",stable);thead.empty(),tbody.empty(),tbody.css({"font-size":"12px","user-select":"none"}),thead.css({"font-size":"14px","user-select":"none"});const self=this;this.parentDomElement.append($("<HR>")),this.parentDomElement.append($(`<p style="font-size:12px"> Image:${des}</p>`)),this.parentDomElement.append($("<HR>")),webfileutil.createFileButton({name:"Save Table",parent:this.parentDomElement,type:"success",callback:f=>{self.saveTextResults(f)},css:{position:"right"}},{title:"Save ClusterAnalysis Results",save:!0,filters:[{name:"CSV File",extensions:["csv"]}],suffix:"csv",initialCallback:()=>"results.csv"}),thead.append($('<tr>\n                       <td width="5%">#</td>\n                       <td width="45%">Coordinates of Peak</td>\n                       <td width="20%">Size (voxels)</td>\n                       <td width="30%">Value At Peak</td></tr>')),tbody.empty(),this.outputstring=`,${des}\n#, ,Coordinates of Peak, , Size (voxels), Value at Peak\n`;let max=outputdata.length;max>25&&(max=25);let buttoncoords=[],callback=e=>{let id=e.target.id;id||(id=e.target.parentElement.id)||(id=e.target.parentElement.parentElement.id);let coordinate=buttoncoords[id];self.orthoviewer.setcoordinates([coordinate[0],coordinate[1],coordinate[2]])};for(let i=0;i<max;i++){let elem=outputdata[i],nid=webutil.getuniqueid(),cstring=elem.coords.join(", "),dstring="";if(atlascontrol){let mm=[0,0,0];for(let i=0;i<=2;i++)mm[i]=elem.coords[i]*spa[i];let results=atlascontrol.queryAtlas(mm);"MNI Coordinates"===results.data[0].name&&(cstring=`MNI: ${results.data[0].desc}`,dstring=results.data[0].desc)}let w=$(`<tr>\n                    <td width="5%">${i+1}</td>\n                    <td width="45%"><span id="${nid}" class="btn-link">${cstring}</span></td>\n                    <td width="20%">${elem.size}</td>\n                    <td width="30%">${Number.parseFloat(elem.maxt).toFixed(3)}</td>\n                    </tr>`);this.outputstring+=`${i+1},${dstring},${elem.size},${elem.maxt}\n`,tbody.append(w),$("#"+nid).click(callback),buttoncoords[nid]=elem.coords}if(outputdata.length>max){let w=$(`<tr>\n                    <td width="5%"></td>\n                    <td width="95%">${outputdata.length-max} smaller clusters not shown</td>\n                    </tr>`);tbody.append(w)}}connectedCallback(){let viewerid=this.getAttribute("bis-viewerid"),layoutid=this.getAttribute("bis-layoutwidgetid"),layoutcontroller=document.querySelector(layoutid);this.panel=new BisWebPanel(layoutcontroller,{name:"Cluster Analyzer",permanent:!1,width:"290",dual:!1,mode:"sidebar"}),this.parentDomElement=this.panel.getWidget(),this.cleanCache(),this.orthoviewer=document.querySelector(viewerid),this.orthoviewer.addColormapObserver(this),this.orthoviewer.addImageChangedObserver(this)}show(){this.panel.show(),this.updateDisplay()}isOpen(){return this.panel.isOpen()}})},"./js/webcomponents/bisweb_collectionelement.js":function(module,exports,__webpack_require__){"use strict";const BisWebDataObjectCollection=__webpack_require__("./js/dataobjects/bisweb_dataobjectcollection.js"),BisWebLinearTransformation=__webpack_require__("./js/dataobjects/bisweb_lineartransformation.js"),webutil=__webpack_require__("./js/coreweb/bis_webutil.js"),bisgenericio=__webpack_require__("./js/core/bis_genericio.js"),$=__webpack_require__("jquery"),bootbox=__webpack_require__("./node_modules/bootbox/bootbox.js"),util=__webpack_require__("./js/core/bis_util.js"),numeric=__webpack_require__("./node_modules/numeric/numeric-1.2.6.js"),webfileutil=__webpack_require__("./js/coreweb/bis_webfileutil.js"),BisWebPanel=__webpack_require__("./js/coreweb/bisweb_panel.js");webutil.defineElement("bisweb-collectionelement",class extends HTMLElement{constructor(){super(),this.dataCollection=new BisWebDataObjectCollection,this.panel=null,this.internal={initialized:!1,parentDomElement:null,domElement:null,currentIndex:-1,currentInfo:null,currentSelect:null,currentSelectParent:null,inlineForm:null},this.counter=0}createObjectTypeSpecificInfo(type){"transform"===type?(this.specific={name:"Transformation",type:"transform",extensions:[".bisxform",".matr",".grd"],title:"Transformation Manager"},this.dataCollection.addItem(new BisWebLinearTransformation(0),{name:"0.identity"}),this.counter=1):"matrix"===type&&(this.specific={name:"Matrix",type:"matrix",extensions:[".bismatr",".matr"],title:"Matrix Manager"})}getItemIndexByName(name){let num=this.dataCollection.getNumberOfItems(),i=0,index=-1;for(;i<num&&index<0;)name===(this.dataCollection.getItemMetaData(i).name||"")&&(index=i),i+=1;return index}getCurrentItem(){return this.dataCollection.getItem(this.internal.currentIndex),this.dataCollection.getItem(this.internal.currentIndex)}getCurrentObject(){return this.dataCollection.getItemData(this.internal.currentIndex)}renameCurrentItem(){if(0===this.internal.currentIndex)return void bootbox.alert("The first item may not be changed.");let obj=this.getCurrentItem();if(!obj)return!1;let name=obj.metadata.name||`Item${this.internal.currentIndex+1}`,index=name.indexOf(".");index>0&&(name=name.substr(index+1,name.length));const self=this;return bootbox.prompt({title:"Enter new name for object",value:name,callback:function(result){null!==result&&(obj.metadata.name=`${self.counter}.${result}`,obj.data.setFilename(result),self.counter=self.counter+1,self.updateGUI())}}),!1}invertCurrentItem(){let item=this.getCurrentItem();if(!item)return!1;let obj=item.data;if("BisWebLinearTransformation"!==obj.constructor.name)return void bootbox.alert("Invert only works on linear transformations for now");let minv=numeric.inv(obj.getMatrix());obj.setMatrix(minv);let fname=obj.getFilename()||"matrix.matr",rindex=name.lastIndexOf(".");fname=fname.substr(0,rindex-1)||"matrix",fname+="_inverse.matr",item.metadata.name=`${this.counter}.${fname}`,obj.setFilename(fname),this.counter=this.counter+1,this.updateGUI()}deleteCurrentItem(){if(this.dataCollection.getNumberOfItems()<2)return void bootbox.alert("The only "+this.specific.name.toLowerCase()+" may not be deleted.");let obj=this.getCurrentItem();if(!obj)return!1;let name=obj.metadata.name||`Item${this.internal.currentIndex+1}`;const self=this;return bootbox.confirm("Are you sure you want to delete the current transformation ("+name+")",result=>{result&&(self.dataCollection.removeItem(this.internal.currentIndex),self.updateGUI())}),!1}getInitialFilename(){return this.getCurrentObject().getFilename()}saveCurrentItem(fobj){let obj=this.getCurrentObject();if(!obj)return;fobj=bisgenericio.getFixedSaveFileName(fobj,obj.getFilename()),obj.setFilename(fobj);let txt=obj.serializeToText(obj.getFilename());return bisgenericio.write(fobj,txt),!1}addItem(obj,name=null){name=name||obj.getFilename(),this.dataCollection.addItem(obj,{name:`${this.counter}.${name}`}),this.counter=this.counter+1,this.updateGUI(!0)}addItemFromFile(file){const self=this;return BisWebDataObjectCollection.loadObject(file,self.specific.type).then(obj=>{if(obj)self.addItem(obj,`${self.counter}.${obj.getFilename()}`);else{let fname=bisgenericio.getFixedLoadFileName(file);webutil.createAlert("Failed to load "+self.specific.type+" from "+fname+" ",!0)}}).catch(e=>{file.name&&(file=file.name),"matr"===file.split(".").pop()?webutil.createAlert("Failed to load "+self.specific.type+" from "+file+". This is probably a general (non 4x4) matrix file.",!0):webutil.createAlert(e,!0)}),!1}setCurrentItem(ind,force=!1){let num=this.dataCollection.getNumberOfItems();if((ind=util.range(ind||0,0,num))==this.internal.currentIndex&&!force)return;this.internal.currentIndex=ind,this.internal.currentInfo.empty();let obj=this.dataCollection.getItemData(this.internal.currentIndex),name=this.dataCollection.getItemMetaData(this.internal.currentIndex).name;name.length>20&&(name=name.substr(0,19)+"..."),this.internal.currentInfo.append(obj.getDetailedDescription(name))}updateGUI(selectlast=!1){const self=this;this.internal.currentSelect&&this.internal.currentSelect.remove();let num=this.dataCollection.getNumberOfItems();if(num<1)return void(this.internal.currentIndex=-1);this.internal.currentIndex>=num&&(selectlast=!0);let data=[],current=this.internal.currentIndex||0;selectlast&&(current=num-1);for(let i=0;i<num;i++){let nm=this.dataCollection.getItemMetaData(i).name||`${i+1}.${this.specific.name}`;data.push(nm)}if(null===this.internal.currentSelectParent){let elem1=webutil.creatediv({parent:this.internal.inlineForm,css:{"margin-top":"3px","margin-left":"10px"}}),elem1_label=$("<span>Current: </span>");elem1_label.css({padding:"5px"}),elem1.append(elem1_label),this.internal.currentSelectParent=elem1}this.internal.currentSelect=webutil.createselect({parent:this.internal.currentSelectParent,values:data,index:current,tooltip:"Select the current "+this.specific.name,callback:function(e){self.setCurrentItem(e.target.value)}}),this.setCurrentItem(current,!0)}createGUI(elementtype){if(null===this.internal.parentDomElement)return;const self=this;this.internal.parentDomElement.empty();let basediv=webutil.creatediv({parent:this.internal.parentDomElement,css:{width:"100%"}});this.internal.domElement=basediv;let sbar=webutil.creatediv({parent:basediv});this.internal.inlineForm=webutil.creatediv({parent:sbar}),this.internal.currentInfo=$('<div style="margin:5px; margin-top:10px; overflow: auto; position:relative; color:#fefefe; width:99%; height:97%; background-color:#101010; font-size:11px;"></div>'),sbar.append(this.internal.currentInfo),this.internal.currentInfo.append("No "+this.specific.name+" in memory.");let itembar=webutil.createbuttonbar({parent:basediv,css:{"margin-top":"10px"}});webfileutil.createFileButton({type:"warning",name:"Add",position:"bottom",tooltip:"Click this to add a new "+self.specific.name,parent:itembar,callback:function(f){self.addItemFromFile(f)}},{filename:"",title:"Select file to add a new "+self.specific.name+" from",filters:[{name:self.specific.name+" Files",extensions:self.specific.extensions}],save:!1,suffix:self.specific.extensions.join(",")}),webfileutil.createFileButton({type:"primary",name:"Save",position:"bottom",parent:itembar,callback:function(f){self.saveCurrentItem(f)}},{filename:"",title:"Select file to add a new "+self.specific.name+" from",filters:[{name:self.specific.name+" Files",extensions:self.specific.extensions}],save:!0,suffix:self.specific.extensions.join(","),initialCallback:()=>self.getInitialFilename()}),webutil.createbutton({type:"danger",name:"Delete",position:"bottom",tooltip:"Click this to delete the current object",parent:itembar,callback:function(){self.deleteCurrentItem()}}),webutil.createbutton({type:"primary",name:"Rename",position:"right",tooltip:"Click this to rename the current object",parent:itembar,callback:function(){self.renameCurrentItem()}}),"transform"===elementtype&&webutil.createbutton({type:"danger",name:"Invert",position:"right",tooltip:"Invert the current transform",parent:itembar,callback:function(){self.invertCurrentItem()}})}connectedCallback(){let elementtype=this.getAttribute("bis-elementtype")||"matrix";this.createObjectTypeSpecificInfo(elementtype),this.internal.parentDomElement=$("<div></div>"),this.createGUI(elementtype),this.dataCollection.getNumberOfItems()>0&&this.updateGUI(!0)}show(){if(!this.panel){let layoutid=this.getAttribute("bis-layoutwidgetid"),layoutcontroller=document.querySelector(layoutid);this.panel=new BisWebPanel(layoutcontroller,{name:this.specific.title,width:320,height:400,hasfooter:!1,mode:"docked",dual:"true"}),this.panel.getWidget().append(this.internal.parentDomElement)}this.panel.show()}})},"./js/webcomponents/bisweb_colormapcontrollerelement.js":function(module,exports,__webpack_require__){"use strict";const util=__webpack_require__("./js/core/bis_util.js"),webutil=__webpack_require__("./js/coreweb/bis_webutil.js"),imagealgo=__webpack_require__("./js/legacy/bis_imagealgorithms.js"),smoothreslice=__webpack_require__("./js/legacy/bis_imagesmoothreslice.js");webutil.defineElement("bisweb-colormapcontrollerelement",class extends HTMLElement{constructor(){super(),this.internal={plainmode:!0,funcmodelist:["Objectmap","Overlay","Overlay2","Red","Green","Blue","Orange","Gray"],funcoutlist:["Positive","Negative","Both"],imagerange:null,objectmaprange:[0,1],objectmap:null,clusterinfo:null,mode:"None",modenamelist:["Objectmap","Overlay","Image","None"],update:null,minobjectmap:null,maxobjectmap:null,clusterslider:null,interpolatecheck:null,folder:[null,null],opacityslider:null,overlaymodeselector:null,functionalcontrollers:null,anatomicalcontrollers:null,basegui:null,maxclustersize:0},this.data={interpolate:!0,autocontrast:!0}}inObjectmapMode(){return"objectmap"===this.internal.mode.toLowerCase()}inFunctionalOverlayMode(){let a=this.data.funcmode.toLowerCase();return"overlay"===a||"overlay2"===a}showClusterControls(){if(!this.inFunctionalOverlayMode())return!1;if(!this.internal.objectmap)return!1;let dim=this.internal.objectmap.getDimensions();return!(dim[3]*dim[4]>1)}setimage(volume,updatefunction,defaultopacity=.8){this.internal.volume=null,this.data.opacity=defaultopacity,this.data.minintensity=0,this.data.maxintensity=255,this.data.funcmode="Objectmap",this.data.outmode="Both",this.data.minth=1,this.data.maxth=100,this.data.clustersize=0,this.olddata={},Object.keys(this.data).forEach(key=>{this.olddata[key]=this.data[key]}),this.internal.imagerange=null,this.internal.objectmaprange=[0,1],this.internal.objectmap=null,this.internal.clusterinfo=null,this.internal.mode="None",this.internal.minobjectmap=null,this.internal.maxobjectmap=null,this.internal.clusterslider=null,this.internal.interpolatecheck=null,this.internal.functionalcontrollers=null,this.internal.maxclustersize=0,this.internal.update=updatefunction,this.internal.imagerange=volume.getIntensityRange(),this.internal.imagerange[1]-this.internal.imagerange[0]>64?this.data.minintensity=this.internal.imagerange[0]+1:this.data.minintensity=this.internal.imagerange[0],this.internal.robustrange=smoothreslice.arrayRobustRange(volume.getImageData(),.01,.99),this.internal.robustrange[1]-this.internal.robustrange[0]<.25*(this.internal.imagerange[1]-this.internal.imagerange[0])&&(this.data.autocontrast=!1,this.internal.robustrange=this.internal.imagerange),this.setAutoContrast(!1)}setAutoContrast(update=!0){this.data.autocontrast?this.data.maxintensity=this.internal.robustrange[1]:this.data.maxintensity=this.internal.imagerange[1],update&&this.internal.anatomicalcontrollers&&this.internal.anatomicalcontrollers[1].updateDisplay()}updateClients(output){null!==this.internal.update&&this.internal.update(output)}updateAnatomicalMappingFunction(force,output){if(this.data.minintensity!=this.olddata.minintensity||this.data.maxintensity!=this.olddata.maxintensity||!0===force){this.olddata.maxintensity=this.data.minintensity,this.olddata.minintensity=this.data.maxintensity;let opacity=255;null!==this.internal.objectmap&&(opacity=240),output.image=util.mapstepcolormapfactory(this.data.minintensity,this.data.maxintensity,opacity)}}updateWhenObjectmap(force,output){this.internal.clusterinfo=null,this.data.opacity==this.olddata.opacity&&this.data.funcmode===this.olddata.funcmode&&!0!==force||(this.olddata.opacity=this.data.opacity,this.olddata.funcmode=this.data.funcmode,output.objectmap=util.mapobjectmapfactory(255*this.data.opacity),output.functionalparams={isfunctional:!1,colormode:"Objectmap"})}updateWhenNotObject(force,output){let sumlthr=Math.abs(this.data.minth-this.olddata.minth),sumuthr=Math.abs(this.data.maxth-this.olddata.maxth),sumopa=Math.abs(this.data.opacity-this.olddata.opacity),sumclu=0;if(this.showClusterControls()&&(sumclu=Math.abs(this.data.clustersize-this.olddata.clustersize)),!(sumlthr+sumuthr+sumopa+sumclu>.01||this.data.funcmode!==this.olddata.funcmode||this.data.outmode!==this.olddata.outmode||!0===force))return;this.olddata.minth=this.data.minth,this.olddata.maxth=this.data.maxth,this.olddata.funcmode=this.data.funcmode,this.olddata.outmode=this.data.outmode,this.olddata.opacity=this.data.opacity,this.showClusterControls()&&(this.olddata.clustersize=this.data.clustersize);let opa=Math.round(255*Math.sqrt(this.data.opacity));if("Red"==this.data.funcmode||"Blue"==this.data.funcmode||"Green"==this.data.funcmode||"Orange"==this.data.funcmode||"Gray"==this.data.funcmode){this.internal.clusterinfo=null;let mode=1;"Green"===this.data.funcmode?mode=2:"Blue"===this.data.funcmode?mode=4:"Orange"===this.data.funcmode?mode=3:"Gray"===this.data.funcmode&&(mode=7),output.objectmap=util.mapstepcolormapfactory(this.data.minth,this.data.maxth,opa,mode),output.functionalparams={minth:this.data.minth,maxth:this.data.maxth,isfunctional:!1,colormode:this.data.funcmode,overlay:!1,clustersize:0}}else{let usef4=!1;"Overlay2"===this.data.funcmode&&(usef4=!0);let cmode=3;"Positive"==this.data.outmode&&(cmode=1),"Negative"==this.data.outmode&&(cmode=2),this.data.clustersize<1?(output.objectmap=util.mapoverlayfactory(this.data.minth,this.data.maxth,opa,cmode,usef4),output.functionalparams={minth:this.data.minth,maxth:this.data.maxth,isfunctional:!0,overlay:!0,cmode:cmode,colormode:this.data.funcmode,clustersize:0},this.internal.clusterinfo=null):(sumlthr>0?this.internal.clusterinfo=null:null!==this.internal.clusterinfo&&(this.data.clustersize>this.internal.maxclustersize&&(this.data.clustersize=this.internal.maxclustersize,this.olddata.clustersize=this.internal.maxclustersize,this.internal.clusterslider.updateDisplay()),this.internal.clusterinfo.maskarray=imagealgo.clusterFilter(this.internal.objectmap,this.internal.clusterinfo.data,this.data.clustersize).getImageData()),null===this.internal.clusterinfo&&(this.internal.clusterinfo={},this.internal.clusterinfo.data=imagealgo.createClusterNumberImage(this.internal.objectmap,this.data.minth,!1),this.internal.maxclustersize=this.internal.clusterinfo.data.maxsize,this.data.clustersize>this.internal.maxclustersize&&(this.data.clustersize=this.internal.maxclustersize,this.olddata.clustersize=this.internal.maxclustersize),this.internal.clusterslider.max(this.internal.maxclustersize),this.internal.clusterslider.updateDisplay(),this.internal.clusterinfo.maskarray=imagealgo.clusterFilter(this.internal.objectmap,this.internal.clusterinfo.data,this.data.clustersize).getImageData()),output.objectmap=util.mapoverlayfactory(this.data.minth,this.data.maxth,opa,cmode,usef4,this.internal.clusterinfo.maskarray),output.functionalparams={minth:this.data.minth,maxth:this.data.maxth,overlay:!0,isfunctional:!0,cmode:cmode,clustersize:this.data.clustersize,mapfunction:util.mapoverlayfactory(this.data.minth,this.data.maxth,opa,cmode,usef4)})}}updateTransferFunctions(force=!1){let output={image:null,interpolate:this.data.interpolate,objectmap:null,objinterpolate:!this.inObjectmapMode(),isfunctional:!1};this.updateAnatomicalMappingFunction(force,output),null!==this.internal.objectmap||null===output.image?("Objectmap"==this.data.funcmode?this.updateWhenObjectmap(force,output):this.updateWhenNotObject(force,output),this.updateClients(output)):this.updateClients(output)}updateTransferFunctionsInternal(zerocluster=!1){!0===zerocluster&&(this.data.clustersize=0,null!==this.internal.clusterslider&&this.internal.clusterslider.updateDisplay()),this.updateTransferFunctions(!1)}internalRemoveObjectmap(){if(this.internal.mode="None",this.internal.objectmap=null,this.internal.clusterinfo=null,this.internal.functionalcontrollers=null,null!==this.internal.folder[1]&&null!==this.internal.opacityslider){let f=this.internal.folder[1];for(let c=f.__controllers.length-1;c>=0;c-=1){let elem=f.__controllers[c];if(null!==elem)try{f.remove(elem)}catch(e){}}f.__controllers=[],this.internal.opacityslider=null}}createFunctionalGUI(folder){if(null!==this.internal.functionalcontrollers){let f=this.internal.folder[1];for(let i=0;i<this.internal.functionalcontrollers.length;i++)f.remove(this.internal.functionalcontrollers[i])}this.internal.functionalcontrollers=[];let overlayrange=[this.internal.objectmaprange[0],this.internal.objectmaprange[1]],modemap=null;this.inFunctionalOverlayMode()?(modemap=folder.add(this.data,"outmode",this.internal.funcoutlist).name("Overlay Show:"),this.internal.functionalcontrollers.push(modemap)):this.data.outmode="Both",this.internal.minobjectmap=folder.add(this.data,"minth",overlayrange[0],overlayrange[1]).name("Min Overlay"),this.internal.maxobjectmap=folder.add(this.data,"maxth",overlayrange[0],overlayrange[1]).name("Max Overlay"),this.internal.functionalcontrollers.push(this.internal.minobjectmap),this.internal.functionalcontrollers.push(this.internal.maxobjectmap),this.showClusterControls()?(this.internal.clusterslider=folder.add(this.data,"clustersize").min(0).max(2e3).step(1).name("Cluster Size"),this.internal.functionalcontrollers.push(this.internal.clusterslider)):(this.internal.clusterslider=null,this.data.clustersize=0);const self=this;let clbtrue=function(){self.updateTransferFunctionsInternal(!0)},clbfalse=function(){self.updateTransferFunctionsInternal(!1)};null!==modemap&&modemap.onChange(clbtrue),this.internal.minobjectmap.onChange(clbtrue),this.internal.maxobjectmap.onFinishChange(clbfalse),null!==this.internal.clusterslider&&this.internal.clusterslider.onFinishChange(clbfalse)}updateFunctionalSliders(){let overlayrange=[this.internal.objectmaprange[0],this.internal.objectmaprange[1]];if(this.inFunctionalOverlayMode()){let a1=Math.abs(this.internal.objectmaprange[0]),a2=Math.abs(this.internal.objectmaprange[1]);overlayrange[1]=a2>a1?a2:a1,overlayrange[0]=0,this.data.minth=.5*overlayrange[1],this.data.maxth=.9*overlayrange[1]}else this.data.minth=.95*overlayrange[0]+.05*overlayrange[1],this.data.maxth=overlayrange[1];null!==this.internal.minobjectmap&&(this.internal.minobjectmap.min(overlayrange[0]).max(overlayrange[1]),this.internal.maxobjectmap.min(overlayrange[0]).max(overlayrange[1]),this.internal.minobjectmap.updateDisplay(),this.internal.maxobjectmap.updateDisplay(),null!==this.internal.clusterslider&&this.internal.clusterslider.updateDisplay())}updateFunctionalGUI(m){if("Objectmap"!==m)return this.createFunctionalGUI(this.internal.folder[1]),this.data.funcmode!==this.olddata.funcmode&&this.updateFunctionalSliders(),!1;if(null!==this.internal.functionalcontrollers){for(let i=0;i<this.internal.functionalcontrollers.length;i++)this.internal.folder[1].remove(this.internal.functionalcontrollers[i]);this.internal.functionalcontrollers=null}}createOverlayGUI(folder){this.internal.overlaymodeselector=folder.add(this.data,"funcmode",this.internal.funcmodelist).name("Overlay Type:");const self=this;this.internal.overlaymodeselector.onChange(function(m){self.updateFunctionalGUI(m),self.updateTransferFunctionsInternal()}),this.inObjectmapMode()?this.internal.functionalcontrollers=null:this.createFunctionalGUI(folder)}internalAddObjectmap(objectmap,plainmode,colormapmode){let index=this.internal.funcmodelist.indexOf(colormapmode);if(null===objectmap||null===this.internal.basegui)return void(this.internal.mode="None");this.internalRemoveObjectmap(),this.internal.objectmap=objectmap;let dt=objectmap.getDataType();if(this.internal.objectmaprange=objectmap.getIntensityRange(),this.internal.plainmode=plainmode||!1,this.internal.plainmode){if(colormapmode="Objectmap","float"==dt||"double"==dt||this.internal.objectmaprange[1]>400||this.internal.objectmaprange[0]<0){let r=this.internal.objectmaprange[0]+":"+this.internal.objectmaprange[1];webutil.createAlert(`The loaded objectmap does not look like an objectmap type= ${dt} range:${r}.`,!0)}}else index<0&&(colormapmode="float"==dt||"double"==dt||this.internal.objectmaprange[1]>160||this.internal.objectmaprange[0]<0?this.internal.objectmaprange[0]<0?"Overlay":"Orange":"Objectmap");this.data.funcmode=colormapmode,"Objectmap"===this.data.funcmode?this.internal.mode="Objectmap":this.internal.mode="Overlay";let f3=null;if(null===this.internal.folder[1]?(f3=this.internal.basegui.addFolder("Overlay Color Mapping"),this.internal.folder[1]=f3):f3=this.internal.folder[1],null===this.internal.opacityslider){this.internal.opacityslider=f3.add(this.data,"opacity",0,1).name("Opacity").step(.05);const self=this;let clb=function(e){self.updateTransferFunctionsInternal(e)};this.internal.opacityslider.onChange(clb)}!1===this.internal.plainmode&&(this.createOverlayGUI(f3),this.inObjectmapMode()||this.updateFunctionalSliders()),this.olddata.opacity=-1,this.updateTransferFunctions()}creategui(basegui){let f2=null;if(null!==basegui){this.internal.basegui=basegui,f2=basegui.addFolder("Image Color Mapping"),this.internal.folder[0]=f2,this.internal.folder[1]=this.internal.basegui.addFolder("Overlay Color Mapping");let a1=f2.add(this.data,"minintensity",this.internal.imagerange[0],this.internal.imagerange[1]).name("Min Int"),a2=f2.add(this.data,"maxintensity",this.internal.imagerange[0],this.internal.imagerange[1]).name("Max Int"),a3=f2.add(this.data,"interpolate").name("Interpolate");const self=this;let clb=function(){self.updateTransferFunctionsInternal(!1)};for(let i in f2.__controllers)f2.__controllers[i].onChange(clb);let a4=f2.add(this.data,"autocontrast").name("Auto-Contrast");this.internal.anatomicalcontrollers=[a1,a2,a3,a4],a4.onChange(function(){self.setAutoContrast(!0),self.updateTransferFunctionsInternal(!1)})}else{f2=this.internal.folder[0];for(let i=0;i<=1;i++)this.internal.anatomicalcontrollers[i].min(this.internal.imagerange[0]).max(this.internal.imagerange[1]),this.internal.anatomicalcontrollers[i].updateDisplay()}return this.updateTransferFunctions(),f2}addobjectmap(objectmap,plainmode,colormapmode){this.internalAddObjectmap(objectmap,plainmode,colormapmode)}removeobjectmap(){return this.internalRemoveObjectmap(),!1}getElementState(){return JSON.parse(JSON.stringify(this.data))}setElementState(dt=null){if(null===dt)return 0;let old_mode=this.data.funcmode;for(let attr in dt)this.data.hasOwnProperty(attr)&&(this.data[attr]=dt[attr]);for(let pass=0;pass<=1;pass++)if(null!==this.internal.folder[pass])for(let ia=0;ia<this.internal.folder[pass].__controllers.length;ia++)this.internal.folder[pass].__controllers[ia].updateDisplay();let new_mode=this.data.funcmode;return new_mode!==old_mode&&(this.updateFunctionalGUI(new_mode),this.updateFunctionalSliders()),1}getClusterInfoData(){return this.internal.clusterinfo&&this.internal.clusterinfo.data||null}})},"./js/webcomponents/bisweb_components.js":function(module,exports,__webpack_require__){"use strict";const $=__webpack_require__("jquery"),webutil=__webpack_require__("./js/coreweb/bis_webutil.js"),bisversion=__webpack_require__("./build/wasm/bisdate.js"),iconpath=webutil.getWebPageImagePath();webutil.defineElement("bisweb-topmenubar",class extends HTMLElement{connectedCallback(){const logoheight=this.getAttribute("logoheight")||"50px",logo=this.getAttribute("logo")||`${iconpath}/bioimagesuite.png`;let logolink=this.getAttribute("logolink")||"./index.html";const elem=$(`\n            <nav class="navbar navbar-default navbar-fixed-top">\n            <div class="container-fluid" id="bismenucontainer">\n      \x3c!-- Brand and toggle get grouped for better mobile display --\x3e\n      <div class="navbar-header" id="bismenuheader" >\n            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bismenu">\n            <span class="sr-only">Toggle navigation</span>\n            <span class="icon-bar"></span>\n      <span class="icon-bar"></span>\n      <span class="icon-bar"></span>\n            </button>\n        <a href="${logolink}" target="_blank"><img src="${logo}" height="${logoheight}" id="bislogo" style="margin-top:5px"></a>\n    </div>  \x3c!-- Collect the nav links, forms, and other content for toggling --\x3e\n    <div class="collapse navbar-collapse" id="bismenu">\n        <ul class="nav navbar-nav" id="bismenuparent">\n        </ul>\n    </div>\x3c!-- /.navbar-collapse --\x3e\n    </div>\x3c!-- /.container-fluid --\x3e\n        </nav>`);this.appendChild(elem[0]),this.menubar=$(".navbar-nav",elem);let content=this.getAttribute("bis-content")||null;null!==content&&(this.menubar.empty(),this.menubar.append($(content))),webutil.disableDrag(this.menubar)}getMenuBar(){return this.menubar||null}}),webutil.defineElement("bisweb-botmenubar",class extends HTMLElement{connectedCallback(){const st="display: inline-block;margin-top:1px; padding-left:2px; padding-right:5px; margin-bottom:1px; height:10px; font-size:14px;",bottomtext=`<div style="${st} float:left"><img src="${iconpath}/bislogo.png" id="bislogobottom" height="20px"/></div><div style="${st} float:right">This application is part of <a href="./index.html" target="_blank">Yale\nBioImage Suite</a> (${bisversion.version}, ${bisversion.date})</div>`;let content=this.getAttribute("content")||"";content.length<3&&(content=bottomtext);const elem=$('<nav class="navbar navbar-default navbar-fixed-bottom" style=" min-height:25px; max-height:25px"></nav>');elem.append($(content)),this.appendChild(elem[0]),webutil.disableDrag(elem)}})},"./js/webcomponents/bisweb_connectivityapplicationelement.js":function(module,exports,__webpack_require__){"use strict";const BisWebImage=__webpack_require__("./js/dataobjects/bisweb_image.js"),webutil=__webpack_require__("./js/coreweb/bis_webutil.js"),$=__webpack_require__("jquery"),bootbox=__webpack_require__("./node_modules/bootbox/bootbox.js"),numeric=__webpack_require__("./node_modules/numeric/numeric-1.2.6.js"),util=__webpack_require__("./js/core/bis_util.js"),webfileutil=__webpack_require__("./js/coreweb/bis_webfileutil.js"),ViewerApplicationElement=__webpack_require__("./js/webcomponents/bisweb_mainviewerapplication.js"),imagepath=webutil.getWebPageImagePath();webutil.defineElement("bisweb-connectivityapplication",class extends ViewerApplicationElement{constructor(){super(),this.extraManualHTML="tools/conncontrol.html",this.savelightstate=!1}getElementState(storeImages=!1){let obj=super.getElementState(storeImages);return obj.connectivity=this.connectivitycontrol.getElementState(),obj}setElementState(dt=null,name=null){"connviewer"===(name=name||this.applicationName)||!1!==this.savelightstate?(this.connectivitycontrol.disableMouseUpdates(),super.setElementState(dt),this.connectivitycontrol.setElementState(dt.connectivity)):bootbox.alert("Viewer State is not from a connectivity viewer (it is from"+name+")")}connectedCallback(){this.savelightstate=this.getAttribute("bis-extrastatesave")||null;var VIEWER={inBrowser:!0,viewer:0,dialog:0,dialogtext:0,dialogtitle:0},loadatlas=function(fname){return new Promise((resolve,reject)=>{let image0=new BisWebImage;image0.load(`${imagepath}/MNI_T1_1mm_stripped_ras.nii.gz`,"RAS").then(function(){VIEWER.viewer.setimage(image0),VIEWER.viewer.setcoordinates([90,126,72]);let image1=new BisWebImage;image1.load(fname,"RAS").then(function(){!function(vol){console.log("+++++ Objectmap :",vol.getDescription());var d=vol.getDimensions(),s=vol.getSpacing(),truedim=[181,217,181,1],truespa=[1,1,1,1];d[3]=truedim[3],s[3]=truespa[3];var diff=numeric.norminf(numeric.sub(d,truedim)),diff2=numeric.norminf(numeric.sub(s,truespa)),orient=vol.getOrientation().name;if(diff>0||diff2>.01||"RAS"!==orient)return bootbox.alert("Bad Parcellation Image for creating a Parcellation file. Must be RAS 181x217x181 and 1x1x1 mm (i.e. MNI 1mm space).This image has orientation "+orient+", dimensions="+[d[0],d[1],d[2]]+" voxel size="+[util.scaledround(s[0],10),util.scaledround(s[1],10),util.scaledround(s[2],10)]),0;VIEWER.viewer.setobjectmap(vol,!0)}(image1),resolve()}).catch(e=>{myerror(e),reject(e)})}).catch(e=>{myerror(e),reject(e)})})},myerror=function(e){e=e||"",bootbox.alert("Error loading"+e)};const menubarid=this.getAttribute("bis-menubarid"),viewerid=this.getAttribute("bis-viewerid"),controlid=this.getAttribute("bis-connectivitycontrolid");VIEWER.viewer=document.querySelector(viewerid),VIEWER.viewer.finalizeTools();var viewer=VIEWER.viewer;this.VIEWERS=[viewer],this.num_independent_viewers=1;let control=document.querySelector(controlid),menubar=document.querySelector(menubarid).getMenuBar();this.connectivitycontrol=control;var fmenu=webutil.createTopMenuBarMenu("File",menubar).attr("id","bisfilemenu");const self=this;webfileutil.createFileMenuItem(fmenu,"Load Node Definition File",function(e){control.loadparcellationfile(e)},{title:"Node Definition File",save:!1,filters:[{name:"JSON formatted Node definition file",extensions:["parc"]}],suffix:".parc"}),webutil.createMenuItem(fmenu,""),webfileutil.createFileMenuItem(fmenu,"Load Positive Matrix",function(f){control.loadmatrix(0,f)},{title:"Postive Connectivity Matrix",save:!1,filters:[{name:"Text or CSV formatted matrix file",extensions:["txt","csv"]}],suffix:".csv,.txt"}),webfileutil.createFileMenuItem(fmenu,"Load Negative Matrix",function(f){control.loadmatrix(1,f)},{title:"Negative Connectivity Matrix",save:!1,filters:[{name:"Text or CSV formatted matrix file",extensions:["txt","csv"]}],suffix:".csv,.txt"}),webutil.createMenuItem(fmenu,""),webutil.createMenuItem(fmenu,"Clear Matrices",function(){control.clearmatrices()}),this.createApplicationMenu(fmenu);var editmenu=webutil.createTopMenuBarMenu("Edit",menubar);webutil.createMenuItem(editmenu,"Undo",function(){control.undo()}),webutil.createMenuItem(editmenu,""),webutil.createMenuItem(editmenu,"Reset Display Parameters",function(){control.resetdefault()}),webutil.createMenuItem(editmenu,""),webutil.createMenuItem(editmenu,"Store Application State",function(){self.storeState()}),webutil.createMenuItem(editmenu,"Retrieve Application State",function(){self.restoreState()});var viewmenu=webutil.createTopMenuBarMenu("View",menubar);webutil.createMenuItem(viewmenu,"Info about Loaded Data",function(){control.info()}),webutil.createMenuItem(viewmenu,"Show High Degree Nodes",function(){control.viewInteresting()}),webutil.createMenuItem(viewmenu,""),webutil.createMenuItem(viewmenu,"Show Matrices",function(){control.showmatrices()}),webutil.createMenuItem(viewmenu,""),webutil.createMenuItem(viewmenu,"Set 3D View To Front",function(){viewer.set3dview(1,!0)}),webutil.createMenuItem(viewmenu,"Set 3D View To Back",function(){viewer.set3dview(1,!1)}),webutil.createMenuItem(viewmenu,""),webutil.createMenuItem(viewmenu,"Set 3D View To Top",function(){viewer.set3dview(2,!1)}),webutil.createMenuItem(viewmenu,"Set 3D View To Bottom",function(){viewer.set3dview(2,!0)}),webutil.createMenuItem(viewmenu,""),webutil.createMenuItem(viewmenu,"Set 3D View To Left",function(){viewer.set3dview(0,!1)}),webutil.createMenuItem(viewmenu,"Set 3D View To Right",function(){viewer.set3dview(0,!0)});var imenu=webutil.createTopMenuBarMenu("Parcellations",menubar);webutil.createMenuItem(imenu,"Use the Shen Atlas",function(){control.clearmatrices(),loadatlas(`${imagepath}/gray_highres_groupncut150_right5_left1_emily_reord_new.nii.gz`)}),webutil.createMenuItem(imenu,"Use the AAL Atlas",function(){let img=new BisWebImage;img.load(`${imagepath}/AAL_1mm_ras.nii.gz`,"RAS").then(()=>{control.clearmatrices(),control.importparcellation(img,"AAL Atlas")})});var advmenu=webutil.createTopMenuBarMenu("Advanced",menubar);webfileutil.createFileMenuItem(advmenu,"Import Node Positions Text File (in MNI coordinates)",function(f){control.importparcellationtext(f)},{title:"Node definitions file",save:!1,filters:[{name:"Text or CSV formatted file",extensions:["txt","csv"]}],suffix:".txt,.csv"}),webfileutil.createFileMenuItem(advmenu,"Import Node Definition (Parcellation) Image",function(f){let img=new BisWebImage;img.load(f,"RAS").then(function(){control.importparcellation(img)}).catch(e=>{myerror(e)})},{title:"Node definitions image",suffix:"NII",save:!1});let helpmenu=this.createHelpMenu(menubar);webutil.createMenuItem(helpmenu,""),helpmenu.append($('<li><a href="https://www.nitrc.org/frs/?group_id=51" target="_blank" rel="noopener" ">Download Parcellation</a></li>')),webutil.createMenuItem(helpmenu,""),webutil.createMenuItem(helpmenu,"Load Sample Matrices",function(){control.loadsamplematrices([`${imagepath}/pos_mat.txt`,`${imagepath}/neg_mat.txt`])}),this.fixMobileMouseHandling(),webutil.createDragAndCropController(function(files){var filename=files[0].name,ext=filename.split(".").pop();console.log("filename="+filename+" extension="+ext),"biswebstate"===ext||"connstate"==ext?self.loadApplicationState(files[0]):"parc"===ext||"json"===ext?control.loadparcellationfile(files[0]):"txt"!==ext&&"csv"!==ext||control.loadmatrix(-1,files[0])}),this.applicationInitializedPromiseList.push(loadatlas(`${imagepath}/gray_highres_groupncut150_right5_left1_emily_reord_new.nii.gz`)),Promise.all(this.applicationInitializedPromiseList).then(()=>{webfileutil.initializeFromUserPrefs(),this.parseQueryParameters(),document.body.style.zoom=1}).catch(e=>{console.log("Error ",e)})}})},"./js/webcomponents/bisweb_connectivitycontrolelement.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var dat_gui__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/dat.gui/build/dat.gui.module.js");const numeric=__webpack_require__("./node_modules/numeric/numeric-1.2.6.js"),UndoStack=__webpack_require__("./js/dataobjects/bis_undostack.js"),bisweb_image=__webpack_require__("./js/dataobjects/bisweb_image.js"),util=__webpack_require__("./js/core/bis_util.js"),BisConnectivityMatrix=__webpack_require__("./js/legacy/bis_connmatrix.js"),webutil=__webpack_require__("./js/coreweb/bis_webutil.js"),bisgenericio=__webpack_require__("./js/core/bis_genericio.js"),bisCrossHair=__webpack_require__("./js/coreweb/bis_3dcrosshairgeometry.js"),BisParcellation=__webpack_require__("./js/legacy/bis_parcellation.js"),$=__webpack_require__("jquery"),bootbox=__webpack_require__("./node_modules/bootbox/bootbox.js"),bismni2tal=__webpack_require__("./js/legacy/bis_mni2tal.js"),BisWebMatrix=__webpack_require__("./js/dataobjects/bisweb_matrix.js"),THREE=__webpack_require__("three"),BisWebPanel=__webpack_require__("./js/coreweb/bisweb_panel.js"),imagepath=webutil.getWebPageImagePath(),gui_Lobes={1:"R-Prefrontal",2:"R-MotorStrip",3:"R-Insula",4:"R-Parietal",5:"R-Temporal",6:"R-Occipital",7:"R-Limbic",8:"R-Cerebellum",9:"R-Subcortical",10:"R-Brainstem",11:"L-Prefrontal",12:"L-MotorStrip",13:"L-Insula",14:"L-Parietal",15:"L-Temporal",16:"L-Occipital",17:"L-Limbic",18:"L-Cerebellum",19:"L-Subcortical",20:"L-Brainstem"},gui_BrodLabels={1:"PrimSensory (1)",4:"PrimMotor (4)",5:"SensoryAssoc (5)",6:"BA6",7:"BA7",8:"BA8",9:"BA9",10:"BA10",11:"BA11",13:"Insula (13)",14:"BA14",17:"PrimVisual (17)",18:"VisualAssoc (18)",19:"BA19",20:"BA20",21:"BA21",22:"BA22",23:"BA23",24:"BA24",25:"BA25",30:"BA30",31:"BA31",32:"BA32",34:"BA34",36:"Parahip (36)",37:"Fusiform (37)",38:"BA38",39:"BA39",40:"BA40",41:"PrimAuditory (41)",44:"BA44",45:"BA45",46:"BA46",47:"BA47",48:"Caudate (48)",49:"Putamen (49)",50:"Thalamus (50)",51:"GlobPal (51)",52:"NucAccumb (52)",53:"Amygdala (53)",54:"Hippocampus (54)",55:"Hypothalamus (55)",58:"BrainStem",57:"Cerebellum"},gui_Lobes_Values=["R-Prefrontal","R-MotorStrip","R-Insula","R-Parietal","R-Temporal","R-Occipital","R-Limbic","R-Cerebellum","R-Subcortical","R-Brainstem","L-Prefrontal","L-MotorStrip","L-Insula","L-Parietal","L-Temporal","L-Occipital","L-Limbic","L-Cerebellum","L-Subcortical","L-Brainstem"],gui_Networks={1:"Somato-Motor",3:"Cingular-opercular",4:"Auditory",5:"Default Mode",7:"Visual",8:"Frontal-Parietal",9:"Salience",10:"Subcortical",11:"Ventral-Attention",12:"Dorsal-Attention"},gui_Networks_Values=["Somato-Motor","Cingular-opercular","Auditory","Default Mode","Visual","Frontal-Parietal","Salience","Subcortical","Ventral-Attention","Dorsal-Attention"],gui_Lines=["Positive","Negative","Both"],gui_Modes=["All","Single Node","Single Lobe","Single Network"],axisoffset=[0,5,20],bisGUIConnectivityControl=function(parent,orthoviewer,layoutmanager){let internal={initialized:!1,this:null,parentDomElement:null,parcellation:null,conndata:new BisConnectivityMatrix,domElement:null,orthoviewer:null,layoutmanager:layoutmanager,canvas:null,context:null,tmpcanvas:document.createElement("canvas"),overlaycanvas:null,overlaycontext:null,overlaymode:!1,mni2tal:null,mni:[0,0,0,-1],currentnode:1,posFileInfo:["NONE",0],negFileInfo:["NONE",0],datgui:null,parameters:{lobe:gui_Lobes[19],mode:gui_Modes[1],network:gui_Networks[10],node:200,linestodraw:gui_Lines[2],degreethreshold:10,length:50,thickness:2,poscolor:"#ff0000",negcolor:"#00dddd",radius:1,matrixthreshold:.1},datgui_controllers:null,datgui_nodecontroller:null,datgui_degreethresholdcontroller:null,linestack:[],undostack:new UndoStack(50),hadlinesonce:!1,keynodedlg:null,matrixdlg:null,showlegend:!0,rendermode:7,meshes:[],brainmesh:[null,null],axisline:[null,null,null],planemesh:null,subviewers:null,inrestorestate:!1,parcellationtext:null,lastnode:0};internal.conndata.offset=10;var addStateToUndo=function(){var undoobj={stack:internal.linestack};internal.undostack.addOperation([JSON.stringify(undoobj)])},getStateFromUndoOrRedo=function(doredo){let elem;if(null===(elem=(doredo=doredo||!1)?internal.undostack.getRedo():internal.undostack.getUndo()))return;let undoobj=JSON.parse(elem[0]);internal.linestack=undoobj.stack,console.log("\n\n\n ***** Parsed undo element numops="+internal.linestack.length);let max=internal.linestack.length-1;max>=0&&function(state){internal.parameters.mode=state.guimode,internal.parameters.node=state.node,internal.parameters.lobe=state.lobe,internal.parameters.network=state.network,internal.parameters.degreethreshold=state.degreethreshold,internal.parameters.linestodraw=state.linestodraw,internal.parameters.poscolor=state.poscolor,internal.parameters.negcolor=state.negcolor,internal.parameters.length=state.length,internal.parameters.thickness=state.thickness,internal.parameters.radius=state.radius,internal.parameters.matrixthreshold=state.matrixthreshold;for(let ia=0;ia<internal.datgui_controllers.length;ia++)internal.datgui_controllers[ia].updateDisplay()}(internal.linestack[max]);update()},toggleshowlegend=function(){internal.showlegend=!internal.showlegend,update(!0),internal.showlegend?setnode(Math.round(internal.parameters.node-1)):null!==internal.axisline[0]&&(internal.axisline[0].visible=!1,internal.axisline[1].visible=!1,internal.axisline[2].visible=!1)},togglemode=function(doupdate){if(!1!==doupdate&&(doupdate=!0),null===internal.parcellation)return;doupdate&&(internal.rendermode=internal.rendermode+1,internal.rendermode>8&&(internal.rendermode=6));let parcvp=internal.orthoviewer.setRenderMode(internal.rendermode,!0)[4];internal.parcellation.viewport.x0=parcvp.x0,internal.parcellation.viewport.x1=parcvp.x1,internal.parcellation.viewport.y0=1-parcvp.y1,internal.parcellation.viewport.y1=1-parcvp.y0,update(!0),internal.showlegend&&setnode(Math.round(internal.parameters.node-1))},drawMatricesAndLegendsAsImages=function(){if(null===internal.parcellation)return;if(null===internal.parcellation.lobeStats||internal.parcellation.viewport.x0===internal.parcellation.viewport.x1)return;if(internal.parcellation.box[3]-internal.parcellation.box[1]<100)return;let cw=internal.context.canvas.width,vp=internal.parcellation.viewport,width=Math.floor((vp.x1-vp.x0)*cw),cnv={width:width},fnsize=webutil.getfontsize(cnv),fnsize2=webutil.getfontsize(cnv,!0),originx=Math.floor(vp.x0*cw),originy=internal.parcellation.box[1],leftgap=internal.parcellation.box[0]-originx,imagewidth=.8*leftgap,boxheight=internal.parcellation.box[3]-internal.parcellation.box[1],dlobe=Math.round(1.5*fnsize),needed=22*dlobe+8;if(needed>boxheight&&(dlobe=(boxheight-8)/22),needed=22*dlobe+8,dlobe<.75*fnsize||imagewidth<50)return;let pw=.8*leftgap;pw>8*fnsize&&(pw=8*fnsize);let px=width-pw-2,py=originy+4+0,lobegap=dlobe;if(internal.showlegend){internal.overlaycontext.save(),internal.overlaycontext.fillStyle="#cccccc",internal.overlaycontext.fillRect(px-4,py-4,pw+8,needed),internal.overlaycontext.fillStyle="#000000",internal.overlaycontext.textAlign="left",internal.overlaycontext.font=fnsize2+"px Arial",internal.overlaycontext.fillText("'Lobes'",px+5,py+lobegap),internal.overlaycontext.textAlign="center",internal.overlaycontext.font=fnsize+"px Arial",py+=2*lobegap;for(let i=1;i<=10;i++){let tot=util.range(internal.parcellation.lobeStats[i][2],0,1e4),tot2=0;if(internal.parcellation.lobeStats.length>i+10&&(tot2=util.range(internal.parcellation.lobeStats[i+10][2],0,1e4)),tot+tot2>0){internal.overlaycontext.fillStyle=internal.parcellation.getNonSidedLobeColor(i),internal.overlaycontext.fillRect(px,py,pw,1.5*lobegap),internal.overlaycontext.fillStyle=internal.parcellation.getInverseNonSidedLobeColor(i);let name=gui_Lobes[i];name=name.slice(2,name.length),internal.overlaycontext.fillText(name,px+.5*pw,py+lobegap),py+=2*lobegap}}}let y0=2*fnsize2;if(internal.showlegend){if(y0<internal.parcellation.box[1]){let midx=.5*(internal.parcellation.box[0]+internal.parcellation.box[2]);internal.overlaycontext.fillStyle="rgb(0,0,0)",internal.overlaycontext.font=fnsize2+"px Arial",internal.overlaycontext.textAlign="center",internal.overlaycontext.clearRect(0,0,cw,internal.parcellation.box[1]-2);let y0_0=internal.parcellation.box[1]-.5*(internal.parcellation.box[1]-fnsize2);internal.overlaycontext.fillText("Using node definitions from "+internal.parcellation.description+" with "+internal.parcellation.rois.length+" nodes.",midx,y0_0)}internal.overlaycontext.restore()}let needed2=2*(imagewidth+25+4)+30;needed2>boxheight?imagewidth=.5*(needed2-30)-29:originy+=.5*(boxheight-needed2),2*imagewidth+80>boxheight&&(imagewidth=(boxheight-80)/2);let offsets=[[originx+.1*leftgap,originy+30,imagewidth],[originx+.1*leftgap,originy+imagewidth+69,imagewidth]],numrows=internal.parcellation.rois.length,names=["Positive","Negative"];for(let im=0;im<=1;im++){let image=internal.conndata.getImageData(1-im,0,internal.overlaycontext,internal.parcellation),minx=offsets[im][0],miny=offsets[im][1],sz=offsets[im][2];if(internal.showlegend&&null!==image){internal.overlaycontext.save(),internal.overlaycontext.lineWidth=1,internal.overlaycontext.fillStyle="rgb(0,0,0)",internal.overlaycontext.font=fnsize+"px Arial",internal.overlaycontext.lineWidth=1,internal.overlaycontext.textAlign="center",internal.overlaycontext.fillText(names[im],minx+.5*sz,miny-10),internal.overlaycontext.lineWidth=1,internal.overlaycontext.fillStyle="#ffffff",internal.overlaycontext.fillRect(minx,miny,sz,sz),internal.overlaycontext.beginPath(),internal.overlaycontext.moveTo(minx-2,miny-2),internal.overlaycontext.lineTo(minx+sz+2,miny-2),internal.overlaycontext.lineTo(minx+sz+2,miny+sz+2),internal.overlaycontext.lineTo(minx-2,miny+sz+2),internal.overlaycontext.lineTo(minx-2,miny-2),internal.overlaycontext.stroke(),internal.overlaycontext.fillStyle="#ffeedd",internal.overlaycontext.fillRect(minx,miny,sz,sz),internal.overlaycontext.restore(),internal.tmpcanvas.width=numrows,internal.tmpcanvas.height=numrows,internal.tmpcanvas.getContext("2d").putImageData(image,0,0);let ImageObject=new Image;if(ImageObject.src=internal.tmpcanvas.toDataURL("image/png"),0==im){let a=minx,b=miny,c=sz;ImageObject.onload=function(){internal.showlegend&&internal.overlaycontext.drawImage(ImageObject,0,0,numrows,numrows,a,b,c,c)}}else{let a1=minx,b1=miny,c1=sz;ImageObject.onload=function(){internal.showlegend&&internal.overlaycontext.drawImage(ImageObject,0,0,numrows,numrows,a1,b1,c1,c1)}}}else{let a=minx,b=miny,c=sz;internal.overlaycontext.save(),internal.overlaycontext.fillStyle="#ffffff",internal.overlaycontext.fillRect(a,b,c,c),internal.overlaycontext.restore()}}},update=function(skip3d){if(skip3d=skip3d||!1,null===internal.parcellation)return;let skip2d=!1;if(internal.parcellation.viewport.x0===internal.parcellation.viewport.x1&&(internal.context.clearRect(0,0,internal.canvas.width,internal.canvas.height),internal.overlaycontext.clearRect(0,0,internal.canvas.width,internal.canvas.height),skip2d=!0),skip2d&&skip3d)return;let max=internal.linestack.length-1,bd=internal.parcellation.clearCanvas(internal.context);bd[2]>0?(internal.overlaycontext.clearRect(bd[0],bd[1],bd[2],bd[3]),internal.parcellation.drawCircles(internal.context)):skip2d=!0,skip3d||internal.meshes.forEach(function(m){m.visible=!1,internal.subviewers[3].scene.remove(m)});let ok=1,donewithmatrices=!1;if(null!==internal.axisline[0])for(let axis=0;axis<=2;axis++)internal.axisline[axis].visible=!1;if(internal.linestack.length>0){for(let i=0;i<internal.linestack.length;i++)ok=1,skip2d||(ok=drawlines(internal.linestack[i])),0===ok?i=internal.linestack.length:skip3d||drawlines3d(internal.linestack[i],!0);if(max>=0){1===internal.linestack[max].mode&&(setnode(Math.round(internal.parameters.node-1)),donewithmatrices=!0)}else!1===donewithmatrices&&(setnode(Math.round(internal.parameters.node-1)),donewithmatrices=!0)}drawMatricesAndLegendsAsImages(),skip3d||internal.layoutmanager.getrenderer().render(internal.subviewers[3].scene,internal.subviewers[3].camera)},setnode=function(node){if(null===internal.parcellation)return;node=node||0,internal.lastnode=node;let singlevalue=util.range(Math.round(node),0,internal.parcellation.rois.length-1),intnode=Math.floor(internal.parcellation.indexmap[singlevalue]);internal.mni[0]=internal.parcellation.rois[intnode].x,internal.mni[1]=internal.parcellation.rois[intnode].y,internal.mni[2]=internal.parcellation.rois[intnode].z,internal.mni[3]=singlevalue,internal.showlegend&&internal.parcellation.drawPoint(singlevalue,internal.overlaycontext);let coords=internal.mni2tal.getMMCoordinates(internal.mni);internal.orthoviewer.setcoordinates(coords),drawMatricesAndLegendsAsImages(),internal.showlegend?draw3dcrosshairs():(internal.axisline[0].visible=!1,internal.axisline[1].visible=!1,internal.axisline[2].visible=!1),updatetext()},draw3dcrosshairs=function(){if(null===internal.axisline[0])return;let coords=internal.mni2tal.getMMCoordinates(internal.mni);internal.mni[0]<0?coords[0]=-coords[0]:coords[0]=-coords[0]-20,coords[1]+=axisoffset[1],coords[2]+=axisoffset[2],internal.axisline[0].position.set(0,coords[1],coords[2]),internal.axisline[1].position.set(coords[0],0,coords[2]),internal.axisline[2].position.set(coords[0],coords[1],0),internal.axisline[0].visible=!0,internal.axisline[1].visible=!0,internal.axisline[2].visible=!0},updatetext=function(){if(!internal.showlegend)return;let ch=internal.canvas.height,cw=internal.canvas.width;if(internal.parcellation.box[0]>=internal.parcellation.box[2]||internal.parcellation.viewport.x0>=internal.parcellation.viewport.x1)return;let nodenumber=internal.mni[3],s_text="MNI=("+internal.mni[0]+","+internal.mni[1]+","+internal.mni[2]+")",s_text2="";if(nodenumber>-1){let orignode=internal.parcellation.indexmap[nodenumber],humannumber=nodenumber+1,lobe=gui_Lobes[internal.parcellation.rois[orignode].attr[0]];internal.parameters.lobe=lobe;let n=internal.parcellation.rois[orignode].attr[2],network=gui_Networks[n];void 0===network?network="unknown":internal.parameters.network=network;let brod=gui_BrodLabels[internal.parcellation.rois[orignode].attr[3]];void 0===brod&&(brod="n/a"),s_text="Node:"+humannumber+" ( "+lobe+", "+network+", "+brod+").",s_text2=" MNI=("+internal.mni[0]+","+internal.mni[1]+","+internal.mni[2]+")",null!==internal.conndata.statMatrix&&(s_text2+=", (Degree: p="+internal.conndata.statMatrix[orignode][0]+", ",s_text2+="n="+internal.conndata.statMatrix[orignode][1]+", ",s_text2+="s="+internal.conndata.statMatrix[orignode][2]+") "),s_text2+=" (sorted="+(internal.parcellation.indexmap[nodenumber]+1)+")",internal.parameters.node=humannumber;for(let ia=0;ia<internal.datgui_controllers.length;ia++)internal.datgui_controllers[ia].updateDisplay()}internal.overlaycontext.save(),internal.overlaycontext.textAlign="center";let x=.5*(internal.parcellation.viewport.x0+internal.parcellation.viewport.x1)*cw,cnv={width:(internal.parcellation.viewport.x1-internal.parcellation.viewport.x0)*cw},fnsize=webutil.getfontsize(cnv),fn=fnsize+"px Arial";internal.overlaycontext.font=fn;let ymin=internal.parcellation.box[3]+5;if(ch-ymin>3.5*fnsize){internal.overlaycontext.clearRect(0,ymin,cw,ch-ymin),internal.overlaycontext.fillStyle="rgb(0,0,0)";let y=internal.parcellation.viewport.y1*ch;internal.overlaycontext.fillText(s_text,x,y-2*fnsize),internal.overlaycontext.fillText(s_text2,x,y-.5*fnsize)}internal.overlaycontext.restore()},cleanmatrixdata=function(){internal.conndata.cleanup(),null!==internal.keynodedlg&&internal.keynodedlg.cleanup(),internal.keynodedlg=null,internal.posFileInfo=["NONE",0],internal.negFileInfo=["NONE",0],internal.undostack.initialize(),internal.linestack=[],update()},loadmatrix=function(index,filename,done,sample){if(done=done||null,sample=sample||!1,null===internal.parcellation)return loaderror("Load parcellation before loading connectivity matrix"),!0;let loaderror=function(msg){webutil.createAlert(msg,!0)};return bisgenericio.read(filename).then(obj=>{let text=obj.data;if(null===internal.parcellation)return void loaderror("Load parcellation before loading connectivity matrix");-1===index&&(index=null===internal.conndata.posMatrix?0:!1!==internal.conndata.hasnegMatrix?0:1);let n=internal.conndata.parsematrix(text,index,filename,loaderror),np=internal.parcellation.rois.length;if(n>0&&n!==np)return loaderror("Matrix has "+n+" rows, while parcellation has "+np+" nodes. This is a problem!"),void cleanmatrixdata();internal.undostack.initialize(),internal.linestack=[],n>0&&(0===index?(internal.posFileInfo[0]=filename,internal.posFileInfo[1]=n,internal.negFileInfo[0]="NONE",internal.negFileInfo[1]=0):(internal.negFileInfo[0]=filename,internal.negFileInfo[1]=n),null===done?(internal.showlegend=!0,internal.parameters.degreethreshold>internal.conndata.maxsum&&(internal.parameters.degreethreshold=Math.round(internal.conndata.maxsum/2)),internal.datgui_degreethresholdcontroller.min(.1).max(internal.conndata.maxsum),internal.datgui_degreethresholdcontroller.updateDisplay(),update(),setnode(internal.conndata.maxsumnode),sample||(filename.name&&(filename=filename.name),0===index?webutil.createAlert("Positive matrix of dimensions "+np+"*"+np+" read from "+filename):webutil.createAlert("Negative matrix of dimensions "+np+"*"+np+" read from "+filename),window.dispatchEvent(new Event("resize")))):done(),null!==internal.keynodedlg&&internal.keynodedlg.hide(),internal.keynodedlg=null)}).catch(e=>{loaderror(e)}),!1},parseparcellation=function(text,filename,silent,keepobjectmap=!1){silent=silent||!1,internal.parcellation=new BisParcellation,internal.parcellation.loadrois(text,filename,bootbox.alert),internal.datgui_nodecontroller.min(1).max(internal.parcellation.rois.length),internal.parcellationtext={text:text,filename:filename},togglemode(!1),setnode(0),internal.undostack.initialize(),internal.hadlinesonce=!1,silent||webutil.createAlert("Connectivity Viewer initialized. The node definition loaded is from "+internal.parcellation.description+".",!1),keepobjectmap||internal.orthoviewer.clearobjectmap(),cleanmatrixdata()},parsebrainsurface=function(textstring,filename){let meshindex=0;filename.lastIndexOf("right")>=0&&(meshindex=1);let obj=JSON.parse(textstring),values=[.8,.9],vertices=new Float32Array(obj.points.length),indices=new Uint16Array(obj.triangles.length);console.log("+++++ Brain surface loaded from "+filename+" "+[obj.points.length,obj.triangles.length]);for(let i=0;i<obj.points.length;i+=3)vertices[i+0]=180-obj.points[i+0],1===meshindex?vertices[i]-=10:vertices[i]+=10,vertices[i+1]=obj.points[i+1],vertices[i+2]=obj.points[i+2];for(let i=0;i<obj.triangles.length;i++)indices[i]=obj.triangles[i];null!==internal.brainmesh[meshindex]&&(internal.brainmesh[meshindex].visible=!1,internal.subviewers[3].scene.remove(internal.brainmesh[meshindex]));let buf=new THREE.BufferGeometry;buf.setIndex(new THREE.BufferAttribute(indices,1)),buf.addAttribute("position",new THREE.BufferAttribute(vertices,3)),buf.computeVertexNormals();let material=new THREE.ShaderMaterial({transparent:!0,uniforms:{diffuse:{type:"c",value:{r:values[meshindex],g:values[meshindex],b:values[meshindex]}},opacity:{type:"f",value:1}},vertexShader:"attribute vec3 lookupScalar;\nvarying vec3 vNormal;\nvoid main() {\n     vNormal = normalize( normalMatrix * normal );\n     vec3 transformed = vec3( position );\n     vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\n     gl_Position = projectionMatrix * mvPosition;\n     gl_Position.z=0.99+0.01*gl_Position.z;\n}\n",fragmentShader:"uniform float opacity;\nuniform vec3 diffuse;\nvarying vec3 vNormal;\nvoid main() {\n   float v=max(0.0,-vNormal.z)*0.7+0.3;\n   gl_FragColor = vec4( v*diffuse.x,v*diffuse.y,v*diffuse.z, opacity );\n}"});if(internal.brainmesh[meshindex]=new THREE.Mesh(buf,material),internal.brainmesh[meshindex].visible=!0,internal.subviewers[3].scene.add(internal.brainmesh[meshindex]),null===internal.axisline[0]){let p_indices=new Uint16Array(2);p_indices[0]=0,p_indices[1]=1;for(let axis=0;axis<=2;axis++){let p_vertices=new Float32Array(6);p_vertices[0]=190-axisoffset[0],p_vertices[1]=-axisoffset[1],p_vertices[2]=-axisoffset[2],p_vertices[3]=190-axisoffset[0],p_vertices[4]=-axisoffset[1],p_vertices[5]=-axisoffset[2],0===axis?p_vertices[3]=-10+axisoffset[0]:1===axis?p_vertices[4]=216+axisoffset[1]:p_vertices[5]=170;let pbuf=new THREE.BufferGeometry;pbuf.setIndex(new THREE.BufferAttribute(p_indices,1)),pbuf.addAttribute("position",new THREE.BufferAttribute(p_vertices,3)),internal.axisline[axis]=new THREE.Line(pbuf,new THREE.LineBasicMaterial({color:16746496,transparent:!1,opacity:1})),internal.axisline[axis].visible=!1,internal.subviewers[3].scene.add(internal.axisline[axis])}internal.showlegend&&setnode(Math.round(internal.parameters.node-1)),window.dispatchEvent(new Event("resize"))}},loadparcellation=function(in_filename){return internal.parcellation=null,bisgenericio.read(in_filename).then(obj=>{parseparcellation(obj.data,obj.filename)}).catch(msg=>{bootbox.alert(msg)}),!1},readatlas=function(callback,save=!0,description=null){let atlasimage=null;const img=new bisweb_image;img.load(`${imagepath}/Reorder_Atlas.nii.gz`,!1).then(function(){!function(atlas,save=!0){atlasimage=atlas,save?bootbox.prompt({title:"Please enter a description of the node definition file",value:"Unknown",callback:function(result){null!==result&&setTimeout(function(){callback(atlasimage,result)},100)}}):callback(atlasimage,description)}(img,save)}).catch(e=>{bootbox.alert("Failed to read internal atlas file. Something is wrong here.")})},importParcellationText=function(textfile){let atlasimage=null,description="",out="";var msg;bisgenericio.read(textfile).then(obj=>{let textstring=obj.data,filename=obj.filename;try{util.parseMatrix(textstring,filename,!1,3)}catch(e){return void bootbox.alert("Failed to parse file "+filename+" it does not have 3 columns or something else is wrong. ("+e+")")}readatlas(function(atlas,result){atlasimage=atlas,description=result,function(textstring,filename){console.log("++++ textstring of length="+textstring.length+" read from"+filename);try{out=(new BisParcellation).createParcellationFromText(textstring,filename,atlasimage,description)+"\n"}catch(e){return void bootbox.alert(e)}parseparcellation(out,filename+".parc",!0),bisgenericio.write({filename:filename+".parc",title:"File to save node definition in",filters:[{name:"JSON formatted Node definition file",extensions:["parc"]}]},out)}(textstring,filename)})}).catch(e=>{msg=e,bootbox.alert(msg)})},createlines=function(){if(null===internal.conndata.statMatrix)return void bootbox.alert("No connectivity data loaded");let getKeyByValue=function(obj,value,base){for(let prop in obj)if(obj.hasOwnProperty(prop)&&obj[prop]===value)return prop;return base};internal.lastopisclear=!1;let mode=2;internal.parameters.mode===gui_Modes[0]&&(mode=0),internal.parameters.mode==gui_Modes[1]&&(mode=1);let singlevalue=-1,attribcomponent=0;1===mode?singlevalue=Math.round(internal.parameters.node)-1:2===mode&&(internal.parameters.mode===gui_Modes[2]?(attribcomponent=0,singlevalue=getKeyByValue(gui_Lobes,internal.parameters.lobe,1)):(attribcomponent=2,singlevalue=getKeyByValue(gui_Networks,internal.parameters.network,1)));let degreethreshold=Math.round(internal.parameters.degreethreshold),matrixthreshold=internal.parameters.matrixthreshold,state={mode:mode,guimode:internal.parameters.mode,node:internal.parameters.node,lobe:internal.parameters.lobe,network:internal.parameters.network,degreethreshold:degreethreshold,poscolor:internal.parameters.poscolor,negcolor:internal.parameters.negcolor,length:internal.parameters.length,thickness:internal.parameters.thickness,linestodraw:internal.parameters.linestodraw,singlevalue:singlevalue,attribcomponent:attribcomponent,filter:2,radius:internal.parameters.radius,matrixthreshold:matrixthreshold};internal.hadlinesonce&&addStateToUndo(),internal.hadlinesonce=!0,internal.linestack.push(state),update()},drawlines=function(state){if(0===internal.conndata.createFlagMatrix(internal.parcellation,state.mode,state.singlevalue,state.attribcomponent,state.degreethreshold,state.filter))return bootbox.alert("Failed to create flag matrix for connectivity data!"),0;let total=0;if(state.linestodraw==gui_Lines[0]||state.linestodraw==gui_Lines[2]){let pos=internal.conndata.createLinePairs(0,state.matrixthreshold);total+=pos.length,internal.conndata.drawLines(internal.parcellation,pos,state.poscolor,internal.context,state.length*internal.parcellation.scalefactor,state.thickness)}if(state.linestodraw==gui_Lines[1]||state.linestodraw==gui_Lines[2]){let neg=internal.conndata.createLinePairs(1,state.matrixthreshold);total+=neg.length,internal.conndata.drawLines(internal.parcellation,neg,state.negcolor,internal.context,state.length*internal.parcellation.scalefactor,state.thickness)}return 0===total?-1:total},removelines=function(){null!==internal.conndata.statMatrix?(addStateToUndo(),internal.linestack=[],update()):bootbox.alert("No connectivity data loaded")},drawlines3d=function(state,doNotUpdateFlagMatrix){if(doNotUpdateFlagMatrix=doNotUpdateFlagMatrix||!1,6===internal.rendermode&&(doNotUpdateFlagMatrix=!1),null===internal.parcellations||null===internal.subviewers)return 0;if(!doNotUpdateFlagMatrix){if(console.log("Updating Flag Matrix\n"),0===internal.conndata.createFlagMatrix(internal.parcellation,state.mode,state.singlevalue,state.attribcomponent,state.degreethreshold,state.filter))return bootbox.alert("Failed to create flag matrix for 3D connectivity data!"),0}let pos=[],neg=[],total=0;if(state.linestodraw!=gui_Lines[0]&&state.linestodraw!=gui_Lines[2]||(total+=(pos=internal.conndata.createLinePairs(0,state.matrixthreshold)).length),state.linestodraw!=gui_Lines[1]&&state.linestodraw!=gui_Lines[2]||(total+=(neg=internal.conndata.createLinePairs(1,state.matrixthreshold)).length),0===total)return 0;let color=[state.poscolor,state.negcolor,state.poscolor,state.negcolor],lparr=internal.conndata.draw3DLines(internal.parcellation,pos,neg);for(let i=0;i<=1;i++){let lp=lparr[i];if(null!==lp.indices){let buf=new THREE.BufferGeometry;buf.setIndex(new THREE.BufferAttribute(lp.indices,1)),buf.addAttribute("position",new THREE.BufferAttribute(lp.vertices,3));let linemesh=new THREE.LineSegments(buf,new THREE.LineBasicMaterial({color:color[i],linewidth:1,linecap:"square"}));linemesh.visbile=!0,internal.subviewers[3].scene.add(linemesh),internal.meshes.push(linemesh)}}let sphere=new THREE.SphereGeometry(state.radius,16,16),presphere=bisCrossHair.createpregeometry([sphere]);for(let j=2;j<=5;j++){let sph=lparr[j],scale=255;if(sph.positions.length>0){let cl=util.hexToRgb(color[j-2]);j>3&&(scale=500);let spherematerial=new THREE.ShaderMaterial({transparent:!0,uniforms:{diffuse:{type:"c",value:{r:cl.r/scale,g:cl.g/scale,b:cl.b/scale}},opacity:{type:"f",value:.5}},vertexShader:"varying vec3 vNormal;\nvoid main() {\n     vNormal = normalize( normalMatrix * normal );\n     vec3 transformed = vec3( position );\n     vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\n     gl_Position = projectionMatrix * mvPosition;\n}\n",fragmentShader:"uniform float opacity;\nuniform vec3 diffuse;\nvarying vec3 vNormal;\nvoid main() {\n   float v=max(0.0,-vNormal.z);\n   gl_FragColor = vec4( v*diffuse.x,v*diffuse.y,v*diffuse.z, opacity );\n}"}),geom=bisCrossHair.createcopies(presphere,sph.positions,sph.scales);geom.computeVertexNormals();let spheremesh=new THREE.Mesh(geom,spherematerial);spheremesh.visbile=!0,internal.subviewers[3].scene.add(spheremesh),internal.meshes.push(spheremesh)}}return total};let control={initialize:function(subviewers){internal.inrestorestate||(internal.subviewers=subviewers,function(){if(null===internal.parentDomElement)return;internal.parentDomElement.empty();let basediv=webutil.creatediv({parent:internal.parentDomElement});internal.domElement=basediv;let data=internal.parameters;data.this=this,internal.datgui=new dat_gui__WEBPACK_IMPORTED_MODULE_0__.default.GUI({autoPlace:!1});let gui=internal.datgui;basediv.append(gui.domElement);let coords=gui.addFolder("Core");coords.open();let disp=gui.addFolder("Display"),clist=[];clist.push(coords.add(data,"mode",gui_Modes).name("Mode"));let a1=coords.add(data,"node",1,400).name("Node");clist.push(a1),a1.onChange(function(val){setnode(Math.round(val-1))}),internal.datgui_nodecontroller=a1,clist.push(coords.add(data,"lobe",gui_Lobes_Values).name("Lobe")),clist.push(coords.add(data,"network",gui_Networks_Values).name("Network")),internal.datgui_degreethresholdcontroller=coords.add(data,"degreethreshold",1,100).name("Degree Thrshld"),clist.push(internal.datgui_degreethresholdcontroller),clist.push(coords.add(data,"linestodraw",gui_Lines).name("Lines to Draw")),clist.push(disp.add(data,"length",10,100).name("Length")),clist.push(disp.add(data,"thickness",1,4).name("Thickness")),clist.push(disp.add(data,"radius",.2,4).name("Radius (3D)")),clist.push(disp.addColor(data,"poscolor").name("Pos-Color")),clist.push(disp.addColor(data,"negcolor").name("Neg-Color")),internal.datgui_controllers=clist,webutil.removedatclose(gui);let ldiv0=$("<H4> </H4>").css({margin:"5px"});basediv.append(ldiv0);let bbar1=webutil.createbuttonbar({parent:basediv});webutil.createbutton({type:"default",name:"Toggle Legends",position:"top",tooltip:"Show/Hide auxiliary information",parent:bbar1,callback:toggleshowlegend}),webutil.createbutton({type:"default",name:"Toggle 3D Mode",position:"top",css:{"margin-left":"5px"},tooltip:"Click this to switch display mode from circle+3D to circle to 3D",parent:bbar1,callback:togglemode});let ldiv2=$("<H4> </H4>").css({margin:"5px"});basediv.append(ldiv2);let bbar2=webutil.createbuttonbar({parent:basediv});webutil.createbutton({type:"info",name:"Create Lines",position:"bottom",css:{margin:"5px"},tooltip:"Click this to create lines",parent:bbar2,callback:createlines}),webutil.createbutton({type:"default",name:"Clear Lines",position:"bottom",css:{margin:"5px"},tooltip:"Click this to clear the lines",parent:bbar2,callback:removelines}),webutil.tooltip(internal.parentDomElement)}(),loadparcellation(`${imagepath}/shen.json`),bisgenericio.read(`${imagepath}/lobes_right.json`).then(obj=>{parsebrainsurface(obj.data,obj.filename)}).catch(e=>{console.log(e)}),bisgenericio.read(`${imagepath}/lobes_left.json`).then(obj=>{parsebrainsurface(obj.data,obj.filename)}).catch(e=>{console.log(e)}),update(!1),setTimeout(function(){window.dispatchEvent(new Event("resize"))},10))},loadparcellationfile:function(fname){console.log("Loading from"+fname),loadparcellation(fname)},updatemousecoordinates:function(mm,plane,mousestate){mousestate<0||void 0===mousestate||2===mousestate||(internal.mni=internal.mni2tal.getMNICoordinates(mm),internal.mni[3]=-1,null!==internal.mni&&(null!==internal.parcellation&&(internal.mni[3]=internal.parcellation.findMNIPoint(internal.mni[0],internal.mni[1],internal.mni[2],internal.overlaycontext)),draw3dcrosshairs(),updatetext()))},handleresize:function(){update(!1),internal.showlegend&&setnode(Math.round(internal.parameters.node-1))},loadmatrix:function(index,fname){return loadmatrix(index,fname)},loadsamplematrices:function(filenames){loadmatrix(0,filenames[0],function(){loadmatrix(1,filenames[1],null,!0),webutil.createAlert("Sample connectivity matrices loaded.")},!0)},info:function(){let s="Using node definitions from "+internal.parcellation.description+" with "+internal.parcellation.rois.length+" regions. <BR>";s+="Positive matrix info = ("+internal.posFileInfo+"). <BR>",s+="Negative matrix info = ("+internal.negFileInfo+"). <BR>",s+="The Broadmann areas use the BioImage Suite internal definition.<BR>The Networks are as defined in Power et al. Neuron 2011.",webutil.createAlert(s)},handleMouseEvent:function(e){if(null===internal.parcellation)return;let point=internal.parcellation.findPoint(e.offsetX,e.offsetY,internal.overlaycontext);-1!=point&&setnode(point)},handleKeyEvent:function(event){let key=event.keyCode,offset=0;if(80===key?offset=-1:78===key&&(offset=1),0===offset)return;let intnode,domap=event.shiftKey,nodenumber=Math.round(internal.parameters.node)-1||0,maxnode=internal.parcellation.rois.length-1;(intnode=domap?internal.parcellation.indexmap[nodenumber]+offset:nodenumber+offset)<0?intnode=maxnode:intnode>maxnode&&(intnode=0);let newnode=0;newnode=domap?internal.parcellation.rois[intnode].index:intnode,setnode(newnode)},clearmatrices:function(){cleanmatrixdata()},undo:function(){getStateFromUndoOrRedo(!1)},redo:function(){getStateFromUndoOrRedo(!0)},resetdefault:function(){internal.parameters.length=50,internal.parameters.thickness=2,internal.parameters.radius=1,internal.parameters.poscolor="#ff0000",internal.parameters.negcolor="#00dddd";for(let ia=0;ia<internal.datgui_controllers.length;ia++)internal.datgui_controllers[ia].updateDisplay()},showmatrices:function(){!function(){if(null===internal.conndata.statMatrix)return void bootbox.alert("No connectivity data loaded");let numrows=internal.parcellation.rois.length,cw=.9*internal.context.canvas.width,scalefactor=(cw-90)/(2*numrows),ch=scalefactor*numrows+45,offsets=[[30,30,scalefactor*numrows],[60+scalefactor*numrows,30,scalefactor*numrows]],names=["Positive","Negative"];null===internal.matrixdlg?internal.matrixdlg=webutil.createmodal("Connectivity Matrices"):internal.matrixdlg.body.empty();let actualcanvas=document.createElement("canvas"),cv=$(actualcanvas),h=Math.round(550/cw*ch);cv.css({width:"550px",height:`${h}px`}),actualcanvas.width=cw,actualcanvas.height=ch,internal.matrixdlg.body.append(cv),internal.matrixdlg.dialog.modal("show");let actualcontext=actualcanvas.getContext("2d");actualcontext.save(),actualcontext.fillStyle="#ffeedd",actualcontext.fillRect(0,0,cw,ch);for(let im=0;im<=1;im++){let image=internal.conndata.getImageData(1-im,0,actualcontext,internal.parcellation),minx=offsets[im][0],miny=offsets[im][1],sz=offsets[im][2];if(null!==image){actualcontext.lineWidth=1,actualcontext.fillStyle="#000000",actualcontext.font="24px Arial",actualcontext.textAlign="center",actualcontext.fillText(names[im],minx+.5*sz,miny-10),actualcontext.lineWidth=1,actualcontext.fillStyle="#ffffff",actualcontext.fillRect(minx,miny,sz,sz),actualcontext.beginPath(),actualcontext.moveTo(minx-2,miny-2),actualcontext.lineTo(minx+sz+2,miny-2),actualcontext.lineTo(minx+sz+2,miny+sz+2),actualcontext.lineTo(minx-2,miny+sz+2),actualcontext.lineTo(minx-2,miny-2),actualcontext.stroke(),internal.tmpcanvas.width=numrows,internal.tmpcanvas.height=numrows;let tmpcontext=internal.tmpcanvas.getContext("2d");tmpcontext.clearRect(0,0,numrows,numrows),tmpcontext.putImageData(image,0,0);let ImageObject=new Image;if(ImageObject.src=internal.tmpcanvas.toDataURL("image/png"),actualcontext.fillStyle="#ffeedd",actualcontext.fillRect(minx,miny,sz,sz),0==im){let a=minx,b=miny,c=sz;ImageObject.onload=function(){actualcontext.drawImage(ImageObject,0,0,numrows,numrows,a,b,c,c)}}else{let a1=minx,b1=miny,c1=sz;ImageObject.onload=function(){actualcontext.drawImage(ImageObject,0,0,numrows,numrows,a1,b1,c1,c1)}}}}actualcontext.restore()}()},about:function(){webutil.aboutDialog(" If you use this for a publication please cite Finn et. al Nature Neuro 2015.")},importparcellation:function(image,atlasdesc=null){console.log("at=",atlasdesc),function(vol,atlasdesc=null){let save=!0;atlasdesc&&(save=!1);let d=vol.getDimensions(),s=vol.getSpacing(),truedim=[181,217,181,1],truespa=[1,1,1,1];d[3]=truedim[3],s[3]=truespa[3],console.log("\n\n\n\n\n"+numeric.sub(d,truedim));let diff=numeric.norminf(numeric.sub(d,truedim));console.log(numeric.sub(s,truespa));let diff2=numeric.norminf(numeric.sub(s,truespa)),orient=vol.getOrientation().name;if(console.log([diff,diff2]),diff>0||diff2>.01||"RAS"!==orient)return bootbox.alert("Bad Parcellation Image for creating a Parcellation file.Must be RAS 181x217x181 and 1x1x1 mm (i.e. MNI 1mm space).This image has orientation "+orient+", dimensions="+[d[0],d[1],d[2]]+" voxel size="+[util.scaledround(s[0],10),util.scaledround(s[1],10),util.scaledround(s[2],10)]),0;readatlas(function(atlasimage,description){let fname=vol.getFilename(),index=fname.lastIndexOf(".nii.gz");index>0&&(fname=fname.slice(0,index)+".parc");let out="";try{out=(new BisParcellation).createParcellationFromImage(vol,atlasimage,description)+"\n"}catch(e){return void bootbox.alert(e)}parseparcellation(out,fname,!!save),internal.orthoviewer.setobjectmap(vol,!0),save&&bisgenericio.write({filename:fname,title:"File to save node definition in",filters:[{name:"JSON formatted Node definition file",extensions:["parc"]}]},out)},save,atlasdesc)}(image,atlasdesc)},importparcellationtext:function(filename){importParcellationText(filename)},viewInteresting:function(){if(null===internal.conndata.statMatrix)return void bootbox.alert("No connectivity data loaded");if(null!==internal.keynodedlg)return void internal.keynodedlg.show();let c_data=internal.conndata.getSortedNodesByDegree(2),numnodes=c_data.length-1,maxnodes=Math.round(.1*numnodes),ch=internal.context.canvas.height,cw=internal.context.canvas.width,vp=internal.parcellation.viewport;console.log("vp="+[vp.x0,vp.x1,vp.y0,vp.y1]+" w*h"+[cw,ch]);let showdialog=new BisWebPanel(internal.layoutmanager,{name:"Top "+maxnodes+" Nodes<BR>(sorted by degree)",width:350,mode:"sidebar",dual:!1}),templates=webutil.getTemplates(),newid=webutil.createWithTemplate(templates.bisscrolltable,$("body")),stable=$("#"+newid),buttonnodepairs=[],callback=function(e){let id=e.target.id,node=buttonnodepairs[id];internal.parameters.mode="Single Node",console.log("Node=",node),setnode(node)},thead=stable.find(".bisthead"),tbody=stable.find(".bistbody",stable);thead.empty(),tbody.empty(),tbody.css({"font-size":"12px","user-select":"none"}),thead.css({"font-size":"12px","user-select":"none"});let hd=$('<tr> <td width="5%">#</th> <td width="15%">Node</th> <td width="80%">Details</th></tr>');thead.append(hd),thead.css({font:"Arial 12px"});for(let i=0;i<maxnodes;i++){let node=c_data[numnodes-i].node,degree=c_data[numnodes-i].degree;if(degree>0){let s0=i+1+".",s1=node+1,s2="Degree="+degree+"\t(MNI="+[internal.parcellation.rois[node].x,internal.parcellation.rois[node].y,internal.parcellation.rois[node].z]+", Lobe="+gui_Lobes[internal.parcellation.rois[node].attr[0]]+")",nid=webutil.getuniqueid(),w=$(`<tr>\n                              <td width="5%">${s0}</td>\n                              <td width="15%">${s1}</td>\n                              <td width="80%" id="${nid}" class="btn-link">${s2}</td>\n                            </tr>`);tbody.append(w),$("#"+nid).click(callback),buttonnodepairs[nid]=node}}showdialog.getWidget().append(stable),showdialog.show(),window.dispatchEvent(new Event("resize")),internal.keynodedlg=showdialog},setElementState:function(dt=null){if(internal.context.clearRect(0,0,internal.canvas.width,internal.canvas.height),internal.overlaycontext.clearRect(0,0,internal.canvas.width,internal.canvas.height),internal.rendermode=dt.rendermode,togglemode(!1),internal.posFileInfo=["NONE",0],internal.negFileInfo=["NONE",0],dt.parcellation&&parseparcellation(dt.parcellation.text,dt.parcellation.filename,!1,!0),dt.posmatrix){let neg=null,pos=new BisWebMatrix;pos.parseFromJSON(dt.posmatrix.matrix),internal.posFileInfo=dt.posmatrix.info,pos=pos.getNumericMatrix(),dt.negmatrix&&((neg=new BisWebMatrix).parseFromJSON(dt.negmatrix.matrix),neg=neg.getNumericMatrix(),internal.negFileInfo=dt.negmatrix.info),internal.conndata.setMatrices(pos,neg)}for(let attr in dt.parameters)internal.parameters.hasOwnProperty(attr)&&(internal.parameters[attr]=dt.parameters[attr]);console.log("retrieving params(1)=",JSON.stringify(dt.parameters,null,3)),console.log("retrieving params(2)=",JSON.stringify(internal.parameters,null,3));for(let ia=0;ia<internal.datgui_controllers.length;ia++)internal.datgui_controllers[ia].updateDisplay();dt.linestack&&(internal.linestack=dt.linestack,update()),internal.showlegend=!dt.showlegend,toggleshowlegend(),internal.inrestorestate=!1},getElementState:function(){let obj={},mat=[internal.conndata.posMatrix,internal.conndata.negMatrix],matnames=["posmatrix","negmatrix"],nummatrices=0;for(let i=0;i<=1;i++){let info=internal.posFileInfo;if(1==i&&(info=internal.negFileInfo),mat[i]){nummatrices+=1;let newmat=new BisWebMatrix;newmat.setFromNumericMatrix(mat[i]),console.log("Matrix ",matnames[i],newmat.getDescription()),obj[matnames[i]]={matrix:newmat.serializeToJSON(!1),info:info}}}return nummatrices>0&&(obj.linestack=internal.linestack),obj.parameters=JSON.parse(JSON.stringify(internal.parameters)),console.log("storing params=",JSON.stringify(obj.parameters,null,2)),obj.parcellation=internal.parcellationtext,obj.lastnode=internal.lastnode,obj.showlegend=internal.showlegend,obj.rendermode=internal.rendermode,console.log("Storing Render mode=",obj.rendermode),obj},disableMouseUpdates:function(){internal.inrestorestate=!0}};internal.this=control,internal.parentDomElement=parent;let basediv=$("<div>To appear...</div>");return internal.parentDomElement.append(basediv),internal.orthoviewer=orthoviewer,internal.orthoviewer.addMouseObserver(internal.this),internal.orthoviewer.addResizeObserver(internal.this),internal.canvas=internal.layoutmanager.getcanvas(),internal.context=internal.canvas.getContext("2d"),internal.mni2tal=bismni2tal(),internal.overlaycanvas=internal.layoutmanager.getoverlaycanvas(),internal.overlaycontext=internal.overlaycanvas.getContext("2d"),internal.layoutmanager.getrenderer().domElement.addEventListener("mousedown",function(fe){internal.this.handleMouseEvent(fe)}),window.addEventListener("keydown",function(fe){internal.this.handleKeyEvent(fe)},!0),control};webutil.defineElement("bisweb-connectivitycontrolelement",class extends HTMLElement{connectedCallback(){let viewerid=this.getAttribute("bis-viewerid"),layoutid=this.getAttribute("bis-layoutwidgetid"),viewer=document.querySelector(viewerid),layoutcontroller=document.querySelector(layoutid),panel=new BisWebPanel(layoutcontroller,{name:"Connectivity Control",permanent:"true"});panel.show(),this.innercontrol=bisGUIConnectivityControl(panel.getWidget(),viewer,layoutcontroller)}loadparcellationfile(fname){this.innercontrol.loadparcellationfile(fname)}loadmatrix(index,fname){this.innercontrol.loadmatrix(index,fname)}loadsamplematrices(fnames){this.innercontrol.loadsamplematrices(fnames)}clearmatrices(){this.innercontrol.clearmatrices()}undo(){this.innercontrol.undo()}redo(){this.innercontrol.redo()}info(){this.innercontrol.info()}resetdefault(){this.innercontrol.resetdefault()}viewInteresting(){this.innercontrol.viewInteresting()}showmatrices(){this.innercontrol.showmatrices()}importparcellationtext(f){this.innercontrol.importparcellationtext(f)}importparcellation(f,desc){this.innercontrol.importparcellation(f,desc)}about(){this.innercontrol.about()}setElementState(dt=null){this.innercontrol.setElementState(dt)}getElementState(){return this.innercontrol.getElementState()}disableMouseUpdates(){this.innercontrol.disableMouseUpdates()}})},"./js/webcomponents/bisweb_console.js":function(module,exports,__webpack_require__){"use strict";const $=__webpack_require__("jquery"),webutil=__webpack_require__("./js/coreweb/bis_webutil.js"),bisgenericio=__webpack_require__("./js/core/bis_genericio.js"),BisWebDialogElement=__webpack_require__("./js/webcomponents/bisweb_dialogelement.js"),systemprint=console.log;let replacing=!1;webutil.defineElement("bisweb-console",class extends BisWebDialogElement{constructor(){super(),this.consoletext=null,this.create("Console",500,350,100,60,1e3,!0),this.hide();let elem=$('<pre class="bisconsoletext" style="margin-left:5px; margin-right:5px; margin-top:5px; overflow-y: auto; position:relative; color:#fefefe; width:99%; height:99%; background-color:#000000;"></pre>');this.widget.append(elem[0]),this.consoletext=this.widget.find(".bisconsoletext");const self=this;this.widget.css({"overflow-y":"hidden"}),this.removeCloseButton(),webutil.createbutton({type:"primary",name:"Clear",css:{"margin-left":"50px"},position:"bottom",parent:this.footer,callback:function(e){e.preventDefault(),self.clearalltext()}}),webutil.createbutton({type:"primary",name:"Save",css:{"margin-left":"50px"},position:"bottom",parent:this.footer,callback:function(e){e.preventDefault(),self.savetext()}})}clearalltext(){this.consoletext.empty()}addtext(a){this.consoletext.append(a+"\n")}savetext(){let outstring=this.consoletext.text();var msg;bisgenericio.write({filename:"bislog.txt",title:"Select file to export console in",filters:[{name:"Text Files",extensions:["txt"]}]},outstring).then(()=>{""!==msg&&webutil.createAlert("Log saved in "+msg+")")}).catch(e=>{!function(msg){webutil.createAlert("Failed to save log ("+msg+")")}(e)})}show(capture=!0){null!==this.dialog&&(super.show(),this.replacesystemprint(capture))}hide(){null!==this.dialog&&(super.hide(),this.replacesystemprint(!1))}addtomenu(menu){const self=this;webutil.createMenuItem(menu,"Show Console",function(){self.show()})}addtomenubar(menubar){var hmenu=webutil.createTopMenuBarMenu("Help",menubar);this.addtomenu(hmenu)}replacesystemprint(doreplace=!0){const self=this;if(!0===doreplace&&!1===replacing){console.log("Replacing console.log");const oldLog=console.log;replacing=!0,console.log=function(){let keys=Object.keys(arguments),s="";for(let i=0;i<keys.length;i++){let v=arguments[keys[i]];s+=JSON.stringify(v)+" "}self.addtext(s),oldLog.apply(console,arguments)}}!1===doreplace&&!0===replacing&&(console.log=systemprint,replacing=!1)}})},"./js/webcomponents/bisweb_dialogelement.js":function(module,exports,__webpack_require__){"use strict";const $=__webpack_require__("jquery"),webutil=__webpack_require__("./js/coreweb/bis_webutil.js");class BisWebDialogElement extends HTMLElement{constructor(){super(),this.name="",this.closecallback=null,this.dialog=null,this.widget=null,this.header=null,this.footer=null,this.visible=!1,this.dimensions={width:100,height:100,left:10,top:10},this.mousedata={moving:!1,left:0,top:0,width:100,height:100,leftoffset:0,topoffset:0,firstmove:!1}}isVisible(){return this.visible}getWidget(){return this.widget}getHeader(){return this.header}getFooter(){return this.footer}getContent(){return this.content}getWidgetBase(){return this.widgetbase}setCloseCallback(fn){this.closecallback=fn}removeCloseButton(){this.close.remove()}mouseCallback(state,e){if(0===state){let arr=this.dialog.css(["left","top","width","height"]);return Object.keys(arr).forEach(key=>{arr[key]=parseFloat(arr[key].replace(/px/g,""))}),this.mousedata.left=arr.left,this.mousedata.top=arr.top,this.mousedata.width=arr.width,this.mousedata.height=arr.height,this.mousedata.leftoffset=e.screenX-arr.left,this.mousedata.topoffset=e.screenY-arr.top,this.mousedata.moving=!0,this.mousedata.firstmove=!0,void this.header.css({"background-color":webutil.getactivecolor()})}if(this.mousedata.moving){if(2===state)return this.mousedata.moving=!1,void this.header.css({"background-color":webutil.getpassivecolor()});if(1==state){let posx=e.screenX-this.mousedata.leftoffset,posy=e.screenY-this.mousedata.topoffset,oldposx=posx,oldposy=posy;posx<2?posx=2:posx>window.innerWidth-(this.mousedata.width+2)&&(posx=window.innerWidth-(this.mousedata.width+2)),posy<45?posy=45:posy>window.innerHeight-(this.mousedata.height+90)&&(posy=window.innerHeight-(this.mousedata.height+90)),this.dialog.css({left:`${posx}px`,top:`${posy}px`}),posx===oldposx&&posy===oldposy||(this.mousedata.firstmove||(this.mousedata.moving=!1),this.header.css({"background-color":webutil.getpassivecolor()})),this.mousedata.firstmove=!1}}}unbindMouseEvents(){this.header.mousedown(),this.header.mousemove(),this.header.mouseup(),this.header.mouseleave(),this.footer.mousedown(),this.footer.mousemove(),this.footer.mouseup(),this.footer.mouseleave()}bindMouseEvents(){const self=this;this.header.mousedown(fe=>{self.mouseCallback(0,fe)}),this.header.mousemove(fe=>{self.mouseCallback(1,fe)}),this.header.mouseup(fe=>{self.mouseCallback(2,fe)}),this.header.mouseleave(fe=>{self.mouseCallback(2,fe)}),this.footer.mousedown(fe=>{self.mouseCallback(0,fe)}),this.footer.mousemove(fe=>{self.mouseCallback(1,fe)}),this.footer.mouseup(fe=>{self.mouseCallback(2,fe)}),this.footer.mouseleave(fe=>{self.mouseCallback(2,fe)})}show(){if(null===this.dialog)return;let w=window.innerWidth,arr=this.dialog.css(["width","height"]);Object.keys(arr).forEach(key=>{arr[key]=parseFloat(arr[key].replace(/px/g,""))});let left=w-arr.width-320;left<10&&(left=10);let l=`${left}px`;this.dialog.css({left:l,top:"60px"});let a={top:`${this.dimensions.top}px`,left:`${this.dimensions.left}px`};this.dialog.css(a),this.visible=!0;let drag=$("bisweb-draganddropelement")||null;null!==drag&&drag.length>0&&drag[0].addBlock(),this.dialog.css({visibility:"visible"})}hide(){if(null===this.dialog)return;this.dialog.css({visibility:"hidden"}),this.visible=!1;let drag=$("bisweb-draganddropelement")||null;null!==drag&&drag.length>0&&drag[0].removeBlock()}cleanup(){this.unbindMouseEvents(),this.hide()}getdimensions(){return this.dimensions}create(name,w=400,h=400,x=100,y=100,zindex=5e3,motion=!0,closecallback=null){y<100&&(y=100),x<40&&(x=40);let grow=!1;h<0&&(h=-h,grow=!0),this.name=name;const self=this;this.dimensions.left=x||100,this.dimensions.top=y||100,this.dimensions.width=Math.round(w||400),this.dimensions.height=Math.round(h||400);var newid=webutil.createWithTemplate(webutil.getTemplates().bisdialog,$("body")),div=$("#"+newid);this.headertext=div.find(".modal-title"),this.headertext.text(name),this.dialog=div.find(".modal-dialog"),this.content=div.find(".modal-content"),this.widgetbase=div.find(".modal-body"),this.footerbase=div.find(".modal-footer"),this.header=div.find(".modal-header"),this.headerbase=this.header.parent(),this.close=div.find(".btn-default"),this.secondclose=div.find(".bistoggle"),this.widget=webutil.creatediv({parent:this.widgetbase}),this.footer=webutil.creatediv({parent:this.footerbase}),webutil.disableDrag(this.header,!0),webutil.disableDrag(this.footer,!0),webutil.disableDrag(this.widget,!0),webutil.disableDrag(this.dialog,!0),this.dialog.css({visibility:"hidden","z-index":zindex,position:"absolute",width:`${this.dimensions.width}px`}),this.content.css({width:"100%"}),grow?(this.widgetbase.css({"max-height":`${this.dimensions.height}px`,"overflow-y":"auto"}),this.dialog.css({"min-width":`${this.dimensions.width}px`})):(this.dialog.css({height:`${this.dimensions.height}px`}),this.content.css({height:"100%"}),this.widgetbase.css({height:`${this.dimensions.height-130}px`})),this.footer.css({width:"100%",padding:"5px"}),this.header.css({"background-color":"#303030",color:"#ffffff",margin:"0px"}),this.closecallback=closecallback||null;let clb=function(e){e.preventDefault(),self.closecallback?self.closecallback():self.hide()};$(this.close).click(clb),$(this.secondclose).click(clb),motion&&this.bindMouseEvents()}}webutil.defineElement("bisweb-dialogelement",BisWebDialogElement),module.exports=BisWebDialogElement},"./js/webcomponents/bisweb_dicomimportelement.js":function(module,exports,__webpack_require__){const $=__webpack_require__("jquery"),bis_webutil=__webpack_require__("./js/coreweb/bis_webutil.js"),bis_webfileutil=__webpack_require__("./js/coreweb/bis_webfileutil.js"),bis_genericio=__webpack_require__("./js/core/bis_genericio.js"),bis_bidsutils=__webpack_require__("./js/core/bis_bidsutils.js"),BisWebPanel=__webpack_require__("./js/coreweb/bisweb_panel.js");bis_webutil.defineElement("bisweb-dicomimportelement",class extends HTMLElement{constructor(){super()}connectedCallback(){let viewerid=this.getAttribute("bis-viewerid"),viewerid2=this.getAttribute("bis-viewerid2"),layoutid=this.getAttribute("bis-layoutwidgetid"),filetreepanelid=this.getAttribute("bis-filetreepanelid");this.viewers=[document.querySelector(viewerid),document.querySelector(viewerid2)],this.layoutcontroller=document.querySelector(layoutid);let panel=new BisWebPanel(this.layoutcontroller,{name:"DICOM Import",permanent:!0});panel.show(),this.parentDomElement=panel.getWidget();let basediv=$("<div></div>");this.parentDomElement.append(basediv),this.filetreepanel=document.querySelector(filetreepanelid),bis_webutil.createbutton({type:"info",name:"Open File Tree Panel",tooltip:"Opens a panel which can display DICOM studies.",parent:basediv,css:{width:"90%",margin:"3px"},callback:()=>{this.filetreepanel.showTreePanel()}}),bis_webfileutil.createFileButton({type:"danger",name:"Import Images from DICOM Study",parent:basediv,css:{width:"90%",margin:"3px"},callback:f=>{this.importDicomStudy(f)}},{title:"Directory to import study from",filters:"DIRECTORY",suffix:"DIRECTORY",save:!1})}async importDicomStudy(inputDirectory){let outputDirectory=null;if(!bis_webfileutil.candoComplexIO())return void console.log("Error: cannot import DICOM study without access to file server.");bis_genericio.isDirectory(inputDirectory)||(inputDirectory=bis_genericio.getDirectoryName(bis_genericio.getNormalizedFilename(inputDirectory)));let outputFileCallback=f=>{outputDirectory=f,bis_genericio.runFileConversion({fileType:"dicom",inputDirectory:inputDirectory}).then(fileConversionOutput=>{console.log("Conversion done, now converting files to BIDS format."),bis_bidsutils.dicom2BIDS({indir:fileConversionOutput.output,outdir:outputDirectory}).then(obj=>{console.log("obj",obj)})}).catch(e=>{console.log("An error occured during file conversion",e)})};setTimeout(()=>{bis_webfileutil.genericFileCallback({filters:"DIRECTORY",suffix:"DIRECTORY",title:"Select an output directory for the conversion",save:!1},outputFileCallback)})}})},"./js/webcomponents/bisweb_diffspectelement.js":function(module,exports,__webpack_require__){"use strict";const bisimagesmoothreslice=__webpack_require__("./js/legacy/bis_imagesmoothreslice.js"),BisWebImage=__webpack_require__("./js/dataobjects/bisweb_image.js"),webutil=__webpack_require__("./js/coreweb/bis_webutil.js"),webfileutil=__webpack_require__("./js/coreweb/bis_webfileutil.js"),bisimagealgo=__webpack_require__("./js/legacy/bis_imagealgorithms.js"),$=__webpack_require__("jquery"),bootbox=__webpack_require__("./node_modules/bootbox/bootbox.js"),LinearRegistration=__webpack_require__("./js/modules/linearRegistration.js"),ResliceImage=__webpack_require__("./js/modules/resliceImage.js"),NonlinearRegistration=__webpack_require__("./js/modules/nonlinearRegistration.js"),baseutils=__webpack_require__("./js/modules/baseutils.js"),BisWebPanel=__webpack_require__("./js/coreweb/bisweb_panel.js"),DualViewerApplicationElement=__webpack_require__("./js/webcomponents/bisweb_dualviewerapplication.js"),BisWebDataObjectCollection=__webpack_require__("./js/dataobjects/bisweb_dataobjectcollection.js"),genericio=__webpack_require__("./js/core/bis_genericio.js");__webpack_require__("./node_modules/jstree/dist/jstree.js");const tree_template_string='\n\n      <div class="container" style="width:300px">\n      <div id="treeDiv">\n      </div>\n    </div>       ';let errormessage=function(e){e=e||"",webutil.createAlert("Error Message from diffSPECT"+e,!0)};webutil.defineElement("bisweb-diffspectelement",class extends DualViewerApplicationElement{constructor(){super(),this.dataPanel=null,this.resultsPanel=null,this.imageList=["ictal","interictal","tmap","mri"],this.xformList=["intertoictal_xform","atlastomri_xform","mritointerictal_xform","atlastointer_xform"],this.tempImageList=["atlastointer_reslice","atlastoictal_reslice","intertoictal_reslice","atlastomri_reslice","mritointerictal_reslice"],this.resultsList=["hyper","hypo"],this.atlasList=["ATLAS_spect","ATLAS_mri","ATLAS_stdspect","ALAS_mask"],this.saveList=this.imageList.concat(this.xformList).concat(this.resultsList),this.typeList=[];for(let i=0;i<this.saveList.length;i++)i<this.imageList.length?this.typeList.push("image"):i<this.imageList.length+this.xformList.length?this.typeList.push("transform"):this.typeList.push("dictionary");this.allList=this.saveList.concat(this.tempImageList).concat(this.atlasList),this.clearList=this.xformList.concat(this.tempImageList).concat(this.resultsList),this.app_state={patient_name:"No Name",patient_number:"0",does_have_mri:!1,nonlinear:!1};for(let i=0;i<this.allList.length;i++)this.app_state[this.allList[i]]=null;this.patientInfoModal=null}getApplicationStateFilenameExtension(saveimages=!0){return saveimages?"diffspect":"state"}getApplicationStateFilename(storeimages=!0,ext=null){ext=ext||this.getApplicationStateFilenameExtension(storeimages);let s=`${this.app_state.patient_name}_${this.app_state.patient_number}.${ext}`;return s=s.trim().replace(/ /g,"_"),console.log(s),s}showPatientInfoModal(){if(!this.patientInfoModal){let nid=webutil.getuniqueid(),uid=webutil.getuniqueid(),dataEntryBox=$(`\n                <div class='form-group'>\n                    <label for='name'>Patient Name:</label>\n                                 <input type='text' class = 'form-control' id='${nid}' value="">\n                </div>\n                <div class='form-group'>\n                    <label for='number'>Patient ID:</label>\n                    <input type='text' class = 'form-control' id='${uid}'>\n                </div>\n            `);this.patientInfoModal=webutil.createmodal("Enter Patient Information","modal-sm"),this.patientInfoModal.dialog.find(".modal-footer").find(".btn").remove(),this.patientInfoModal.body.append(dataEntryBox);let confirmButton=webutil.createbutton({name:"Save",type:"btn-success"}),cancelButton=webutil.createbutton({name:"Cancel",type:"btn-danger"});this.patientInfoModal.footer.append(confirmButton),this.patientInfoModal.footer.append(cancelButton),cancelButton.on("click",e=>{e.preventDefault(),this.patientInfoModal.dialog.modal("hide")}),confirmButton.on("click",e=>{e.preventDefault(),this.patientInfoModal.dialog.modal("hide"),console.log(this),this.app_state.patient_name=$("#"+nid).val(),this.app_state.patient_number=$("#"+uid).val()}),this.patientNameId=nid,this.patientNumberId=uid}$("#"+this.patientNameId).val(this.app_state.patient_name),$("#"+this.patientNumberId).val(this.app_state.patient_number),this.patientInfoModal.dialog.modal("show")}getElementState(storeImages=!1){let obj=super.getElementState(!1);if(storeImages){obj.spect={name:this.app_state.patient_name,number:this.app_state.patient_number};for(let i=0;i<this.saveList.length;i++){let elem=this.saveList[i];this.app_state[elem]?"dictionary"===this.typeList[i]?obj.spect[elem]=this.app_state[elem]:obj.spect[elem]=this.app_state[elem].serializeToJSON():obj.spect[elem]=""}}else{obj.spect={};for(let i=0;i<this.saveList.length;i++)obj.spect[this.saveList[i]]=""}return obj}setElementState(dt=null,name=""){if(null===dt)return;super.setElementState(dt,name);let input=dt.spect||{};this.app_state.patient_name=input.name||"",this.app_state.patient_number=input.number||0;for(let i=0;i<this.saveList.length;i++){let elem=this.saveList[i];input[elem]=input[elem]||"",input[elem].length<1?this.app_state[elem]=null:"dictionary"===this.typeList[i]?(this.app_state[elem]=input[elem],console.log(elem+" loaded elements="+this.app_state[elem].length)):(this.app_state[elem]=BisWebDataObjectCollection.parseObject(input[elem],this.typeList[i]),console.log(elem+" loaded=",this.app_state[elem].getDescription()))}null!==this.app_state.tmap&&this.showTmapImage(),null!==this.app_state.hyper&&(this.generateCharts(),this.resultsPanel.show())}loadAtlasData(){let p=new Promise(resolve=>{let imagepath=webutil.getWebPageImagePath();!function(imgnames,alldone){let numimages=imgnames.length,images=new Array(numimages);for(let i=0;i<numimages;i++)images[i]=new BisWebImage;let p=[];for(let i=0;i<numimages;i++)p.push(images[i].load(imgnames[i]));Promise.all(p).then(()=>{alldone(images),resolve()}).catch(e=>{errormessage(e)})}([`${imagepath}/ISAS_SPECT_Template.nii.gz`,`${imagepath}/MNI_T1_2mm_stripped_ras.nii.gz`,`${imagepath}/ISASHN_Standard_Deviation.nii.gz`,`${imagepath}/ISAS_SPECT_Mask.nii.gz`],images=>{this.app_state.ATLAS_spect=images[0],this.app_state.ATLAS_mri=images[1],this.app_state.ATLAS_stdspect=images[2],this.app_state.ATLAS_mask=images[3],this.VIEWERS[0].setimage(this.app_state.ATLAS_mri),webutil.createAlert("The SPECT Tool is now ready. The core data has been loaded.")})});this.applicationInitializedPromiseList.push(p)}loadImage(name="ictal"){let handleGenericFileSelect=imgfile=>{let newimage=new BisWebImage;newimage.load(imgfile,!1).then(()=>{this.app_state[name]=newimage,webutil.createAlert("Loaded "+name+": "+this.app_state[name].getDescription()),this.VIEWERS[0].setimage(this.app_state[name]);for(let i=0;i<this.clearList.length;i++){let elem=this.clearList[i];this.app_state[elem]=null}})};webfileutil.genericFileCallback({title:`Load ${name} image`,suffix:"NII"},fname=>{handleGenericFileSelect(fname)})}initializeTree(){let treeOptionsCallback=this.treeCallback.bind(this);this.loadAtlasData();let json_data={core:{data:[{text:"Images",state:{opened:!0,selected:!1},children:[{text:"Interictal"},{text:"Ictal"},{text:"MRI"}]},{text:"Registrations",state:{opened:!1,selected:!1},children:[{text:"ATLAS to Interictal"},{text:"ATLAS to Ictal"},{text:"Interictal to Ictal"}]},{text:"Diff SPECT",state:{opened:!1,selected:!1},children:[{text:"Tmap Image"}]}]},plugins:["contextmenu"],contextmenu:{items:treeOptionsCallback}};this.tree_div.find("#treeDiv").jstree(json_data)}treeCallback(node){const self=this;let items={loadinter:{label:"Load Interictal",action:()=>{self.loadImage("interictal")}},loadictal:{label:"Load Ictal",action:()=>{self.loadImage("ictal")}},loadmri:{label:"Load MRI",action:()=>{self.loadImage("mri")}},showimage:{label:"Show Image",action:()=>{"Interictal"===node.text&&(null!==self.app_state.interictal?(webutil.createAlert("Displaying original interictal image"),self.VIEWERS[0].setimage(self.app_state.interictal)):bootbox.alert("No interictal image loaded")),"Ictal"===node.text&&(null!==self.app_state.ictal?(webutil.createAlert("Displaying original ictal image"),self.VIEWERS[0].setimage(self.app_state.ictal)):bootbox.alert("No ictal image loaded")),"MRI"===node.text&&(null!==self.app_state.mri?(webutil.createAlert("Displaying original mri image"),self.VIEWERS[0].setimage(self.app_state.mri)):bootbox.alert("No MRI image loaded")),"Tmap Image"===node.text&&(null!==self.app_state.tmap?self.showTmapImage():bootbox.alert("No diff-SPECT tmap image. You need to compute this first."))}},showregistration:{label:"Show Registration",action:()=>{"ATLAS to Interictal"===node.text?self.showAtlasToInterictalRegistration():"ATLAS to Ictal"===node.text?self.showAtlasToIctalRegistration():"Interictal to Ictal"===node.text&&self.showInterictalToIctalRegistration()}}};return"Images"===node.text&&(items=null),"Interictal"!==node.text&&delete items.loadinter,"Ictal"!==node.text&&delete items.loadictal,"MRI"!==node.text&&delete items.loadmri,"Interictal"!==node.text&&"Ictal"!==node.text&&"Tmap Image"!==node.text&&"MRI"!==node.text&&delete items.showimage,"ATLAS to Interictal"!==node.text&&"ATLAS to Ictal"!==node.text&&"Interictal to Ictal"!==node.text&&delete items.showregistration,items}generateChart(parent,data,name){let templates=webutil.getTemplates(),newid=webutil.createWithTemplate(templates.bisscrolltable,$("body")),stable=$("#"+newid);const self=this;let buttoncoords={},callback=e=>{let id=e.target.id;id||((id=e.target.parentElement.id)||(id=e.target.parentElement.parentElement.id),console.log("id=",id));let coordinate=buttoncoords[id];self.VIEWERS[0].setcoordinates([coordinate[0],coordinate[1],coordinate[2]])},thead=stable.find(".bisthead"),tbody=stable.find(".bistbody",stable);thead.empty(),tbody.empty(),tbody.css({"font-size":"11px","user-select":"none"}),thead.css({"font-size":"12px","user-select":"none"});let hd=$(`<tr>\n                 <td width="5%">#</td>\n                 <td width="25%">${name}-Coords</td>\n                 <td width="15%">Size</td>\n                 <td width="20%">ClusterP</td>\n                 <td width="20%">CorrectP</td>\n                 <td width="15%">MaxT</td>\n                 </tr>`);thead.append(hd);for(let i=0;i<data.length;i++){let index=data[i].index,size=data[i].size,coords=data[i].coords.join(","),clusterP=Number.parseFloat(data[i].clusterPvalue).toFixed(4),correctP=Number.parseFloat(data[i].correctPvalue).toFixed(4),maxt=Number.parseFloat(data[i].maxt).toFixed(3),nid=webutil.getuniqueid(),w=$(`<tr>\n                    <td width="5%">${index}</td>\n                    <td width="25%"><span id="${nid}" class="btn-link">${coords}</span></td>\n                    <td width="15%">${size}</td>\n                    <td width="20%">${clusterP}</td>\n                    <td width="20%">${correctP}</td>\n                    <td width="15%">${maxt}</td>\n                    </tr>`);tbody.append(w),$("#"+nid).click(callback),buttoncoords[nid]=data[i].coords}parent.append(stable)}generateCharts(){if(null===this.app_state.hyper)return;let pdiv=this.resultsToolsDiv;pdiv.empty(),pdiv.append($(`<H4> Results for ${this.app_state.patient_name} : ${this.app_state.patient_number}</H4>`));let lst=["Hyper","Hypo"],data=[this.app_state.hyper,this.app_state.hypo];for(let pass=0;pass<=1;pass++)this.generateChart(pdiv,data[pass],lst[pass])}saveResults(fobj){let lst=["Hyper","Hypo"],datalist=[this.app_state.hyper,this.app_state.hypo],str=`Name, ${this.app_state.patient_name}, Number, ${this.app_state.patient_number}\n`;str+="Mode,Index,I,J,K,Size,clusterP,correctedP,maxT-score\n";for(let pass=0;pass<datalist.length;pass++){let data=datalist[pass],name=lst[pass];for(let i=0;i<data.length;i++){let index=data[i].index,size=data[i].size,coords=data[i].coords,clusterP=Number.parseFloat(data[i].clusterPvalue).toFixed(8),correctP=Number.parseFloat(data[i].correctPvalue).toFixed(8),maxt=Number.parseFloat(data[i].maxt).toFixed(3);str+=`${name},${index},${coords[0]},${coords[1]},${coords[2]}`,str+=`${size},${clusterP},${correctP},${maxt}\n`}}let fn=this.getApplicationStateFilename(!1,"csv");return fobj=genericio.getFixedSaveFileName(fobj,fn),new Promise(function(resolve,reject){genericio.write(fobj,str).then(f=>{webutil.createAlert("Results saved in "+f)}).catch(e=>{webutil.createAlert("Failed to save results "+e,!0),reject(e)})})}computeLinearRegistration(reference,target,mode="Rigid"){let lin_opts={intscale:1,numbins:64,levels:3,imagesmoothing:1,optimization:"ConjugateGradient",stepsize:1,metric:"NMI",steps:1,iterations:10,mode:mode,resolution:1.5,doreslice:!0,norm:!0,debug:!1},input={reference:reference,target:target},linear=new LinearRegistration,output={transformation:null,reslice:null};return new Promise((resolve,reject)=>{linear.execute(input,lin_opts).then(()=>{output.transformation=linear.getOutputObject("output"),output.reslice=linear.getOutputObject("resliced"),baseutils.getLinearMode(lin_opts.mode)&&resolve(output),resolve()}).catch(e=>{console.log("This did not run"),console.log("error",e,e.stack),reject(e)})})}computeNonlinearRegistration(reference,target){let nonlinearRegModule=new NonlinearRegistration,input={reference:reference,target:target},nonlin_opts={intscale:1,numbins:64,levels:3,imagesmoothing:1,optimization:"ConjugateGradient",stepsize:1,metric:"NMI",steps:1,iterations:10,cps:20,append:!0,linearmode:"Affine",resolution:1.5,lambda:.001,cpsrate:2,doreslice:!0,norm:!0,debug:!0},output={transformation:null,reslice:null};return new Promise((resolve,reject)=>{nonlinearRegModule.execute(input,nonlin_opts).then(()=>{output.transformation=nonlinearRegModule.getOutputObject("output"),output.reslice=nonlinearRegModule.getOutputObject("resliced"),resolve(output)}).catch(e=>{console.log("ERROR:",e,e.stack),reject(e)})})}registerImages(mode){let params={interictal2ictal:{reference:"interictal",target:"ictal",xform:"intertoictal_xform",output:"intertoictal_reslice",nonlinear:!1},atlas2mri:{reference:"ATLAS_spect",target:"mri",xform:"atlastomri_xform",output:"atlastomri_reslice",nonlinear:!0},mri2interictal:{reference:"mri",target:"interictal",output:"mritointerictal_reslice",xform:"mritointerictal_xform",nonlinear:!1},atlas2interictal:{reference:"ATLAS_spect",target:"interictal",output:"atlastointer_reslice",xform:"atlastointer_xform",nonlinear:!0}}[mode=mode||"inter2ictal"],nonlinear=params.nonlinear,text="nonlinear",linearmode="Rigid";nonlinear&&(linearmode="Affine"),this.app_state.nonlinear||(nonlinear=!1),!1===nonlinear&&(text=linearmode.toLowerCase()+" linear");let reference=this.app_state[params.reference],target=this.app_state[params.target];return null===reference||null===target?(webutil.createAlert("No images in memore (either "+params.reference+" or "+params.target+"). Can not execute registration"),Promise.reject("no images")):(webutil.createAlert("Computing "+mode+" registration, using "+text+" registration","progress",30),new Promise((resolve,reject)=>{setTimeout(()=>{nonlinear?this.computeNonlinearRegistration(reference,target).then(output=>{this.app_state[params.xform]=output.transformation,this.app_state[params.output]=output.reslice,resolve("Done Nonlinear"),webutil.createAlert("Done computing nonlinear registration for "+mode)}).catch(()=>{reject("Not computed linear")}):this.computeLinearRegistration(reference,target,linearmode).then(output=>{this.app_state[params.xform]=output.transformation,this.app_state[params.output]=output.reslice,webutil.createAlert("Done computing linear registration for "+mode),resolve("Done Linear")}).catch(()=>{reject("Not computed linear")})},100)}))}resliceImages(operation,force=!0){let resliceList={};this.app_state.does_have_mri?(resliceList.ictal2Atlas={input:"ictal",xforms:["atlastomri_xform","mritointer_xform","intertoictal_xform"],reference:"ATLAS_spect",output:"atlastoictal_reslice"},resliceList.inter2Atlas={input:"interictal",xforms:["atlastomri_xform","mritointer_xform"],reference:"ATLAS_spect",output:"atlastointer_reslice"}):(resliceList.ictal2Atlas={input:"ictal",xforms:["atlastointer_xform","intertoictal_xform"],reference:"ATLAS_spect",output:"atlastoictal_reslice"},resliceList.inter2Atlas={input:"interictal",xforms:["atlastointer_xform"],reference:"ATLAS_spect",output:"atlastointer_reslice"}),resliceList.inter2ictal={reference:"interictal",input:"ictal",xforms:["intertoictal_xform"],output:"intertoictal_reslice"};let inputKey=resliceList[operation=operation||"ictal2Atlas"].input,refKey=resliceList[operation].reference,outputKey=resliceList[operation].output;if(this.app_state[outputKey]&&!1===force)return Promise.resolve("Reliced image in "+operation+" exists");if(!this.app_state[inputKey]||!this.app_state[refKey])return Promise.reject(`Missing images in reslice ${operation}. ${inputKey}=${this.app_state[inputKey]} ${refKey}=${this.app_state[refKey]}`);let xformnames=["xform","xform2","xform3"],xformlist=[],xformKeys=resliceList[operation].xforms;for(let i=0;i<xformKeys.length;i++){let xform=this.app_state[xformKeys[i]];if(!xform)return Promise.reject("Missing Transformation "+xformKeys[i]+" in reslice "+operation);xformlist.push(xform)}return new Promise((resolve,reject)=>{let inpObjects={input:this.app_state[inputKey],reference:this.app_state[refKey]};for(let i=0;i<xformlist.length;i++)inpObjects[xformnames[i]]=xformlist[i];let reslicer=new ResliceImage;reslicer.execute(inpObjects).then(()=>{this.app_state[outputKey]=reslicer.getOutputObject("output"),resolve()}).catch(e=>{console.log(e,e.stack),reject(e)})})}computeAllRegistrations(){const self=this;let prom=null;(prom=this.app_state.does_have_mri?new Promise((resolve,reject)=>{this.registerImages("atlas2mri").then(()=>{this.registerImages("mri2interictal").then(()=>{this.registerImages("interictal2ictal").then(()=>{webutil.createAlert("Done computing registrations in with_mri mode"),resolve()})})}).catch(e=>{reject(e,e.stack)})}):new Promise((resolve,reject)=>{this.registerImages("atlas2interictal").then(()=>{this.registerImages("interictal2ictal").then(()=>{webutil.createAlert("Done computing registrations in no_mri mode"),resolve()})}).catch(e=>{reject(e,e.stack)})})).then(()=>{self.resliceImages("ictal2Atlas").then(()=>{self.showAtlasToIctalRegistration(),self.dataPanel.show()}).catch(e=>{console.log(e,e.stack)})})}setViewerOpacity(opa=.5){let cmapcontrol=this.VIEWERS[0].getColormapController(),elem=cmapcontrol.getElementState();elem.opacity=opa,cmapcontrol.setElementState(elem),cmapcontrol.updateTransferFunctions(!0)}showAtlasToInterictalRegistration(){this.resliceImages("inter2Atlas",!1).then(()=>{webutil.createAlert("Displaying resliced interictal image over atlas SPECT image"),this.VIEWERS[0].setimage(this.app_state.ATLAS_spect),this.VIEWERS[0].setobjectmap(this.app_state.atlastointer_reslice,!1,"overlay"),this.setViewerOpacity(.5)}).catch(e=>{errormessage(e)})}showAtlasToIctalRegistration(){this.resliceImages("ictal2Atlas",!1).then(()=>{webutil.createAlert("Displaying resliced ictal image over atlas SPECT image"),this.VIEWERS[0].setimage(this.app_state.ATLAS_spect),this.VIEWERS[0].setobjectmap(this.app_state.atlastoictal_reslice,!1,"overlay"),this.setViewerOpacity(.5)}).catch(e=>{errormessage(e)})}showInterictalToIctalRegistration(){this.resliceImages("inter2ictal",!1).then(()=>{webutil.createAlert("Displaying resliced ictal image over interictal image"),this.VIEWERS[0].setimage(this.app_state.interictal),this.VIEWERS[0].setobjectmap(this.app_state.intertoictal_reslice,!1,"overlay"),this.setViewerOpacity(.5)}).catch(e=>{errormessage(e)})}showTmapImage(){if(this.app_state.tmap){webutil.createAlert("Displaying diff-spect TMAP over atlas MRI image"),this.VIEWERS[0].setimage(this.app_state.ATLAS_mri),this.VIEWERS[0].setobjectmap(this.app_state.tmap,!1,"Overlay");let cmapcontrol=this.VIEWERS[0].getColormapController(),elem=cmapcontrol.getElementState();elem.minth=1,cmapcontrol.setElementState(elem),cmapcontrol.updateTransferFunctions(!0)}else errormessage("No tmap in memory")}processSpect(interictal,ictal,stdev,mask,pvalue,clustersize){let params={pvalue:pvalue||.01,clustersize:clustersize||125},d={},final=[0,0],names=["interictal","ictal"],images=[interictal,ictal,stdev,mask],showerror=!1,dim0=images[0].getDimensions();for(let m=1;m<images.length;m++){let dim1=images[m].getDimensions();Math.abs(dim0[0]-dim1[0])+Math.abs(dim0[1]-dim1[1])+Math.abs(dim0[2]-dim1[2])>0&&(console.log("Image "+m+" is different "+dim0+" , "+dim1),showerror=!0)}showerror&&errormessage("Images Not Of Same Size!");for(let i=0;i<=1;i++){let masked=bisimagealgo.multiplyImages(images[i],images[3]),smoothed=bisimagesmoothreslice.smoothImage(masked,[6.7968,6.7968,6.7968],!0,6,d),normalized=bisimagealgo.spectNormalize(smoothed);console.log("+++++ normalized "+names[i]),final[i]=normalized}let tmapimage=bisimagealgo.spectTmap(final[1],final[0],images[2],null),outspect=[0,0];for(let i=0;i<=1;i++)outspect[i]=bisimagealgo.processDiffSPECTImageTmap(tmapimage,params.pvalue,params.clustersize,0===i);return{tmap:tmapimage,hyper:outspect[0].stats,hypo:outspect[1].stats}}computeSpectNoMRI(){let resliced_inter=this.app_state.atlastointer_reslice,resliced_ictal=this.app_state.atlastoictal_reslice;var results=this.processSpect(resliced_inter,resliced_ictal,this.app_state.ATLAS_stdspect,this.app_state.ATLAS_mask);this.app_state.hyper=results.hyper,this.app_state.hypo=results.hypo,this.app_state.tmap=results.tmap}computeSpect(){this.resliceImages("ictal2Atlas").then(()=>{this.resliceImages("inter2Atlas").then(()=>{webutil.createAlert("Computing diff SPECT analysis","progress",30),setTimeout(()=>{this.computeSpectNoMRI(),this.showTmapImage(),this.generateCharts(),this.resultsPanel.show()},100)})}).catch(e=>{errormessage(e)})}createExtraMenu(menubar){const self=this;let layoutid=this.getAttribute("bis-layoutwidgetid"),layoutcontroller=document.querySelector(layoutid);this.dataPanel=new BisWebPanel(layoutcontroller,{name:"Diff-Spect DataTree",permanent:!1,width:"300",dual:!1}),this.spectToolsDiv=this.dataPanel.getWidget(),this.resultsPanel=new BisWebPanel(layoutcontroller,{name:"Diff-Spect Results",permanent:!1,width:"300",dual:!0,mode:"sidebar"}),this.resultsToolsDiv=this.resultsPanel.getWidget(),this.resultsToolsDiv.append($("<div> No results yet.</div>")),this.tree_div=$(tree_template_string),this.spectToolsDiv.append(this.tree_div),this.initializeTree();let sMenu=webutil.createTopMenuBarMenu("diff-SPECT",menubar);webutil.createMenuItem(sMenu,"Enter Patient Info",()=>{self.showPatientInfoModal()}),webutil.createMenuItem(sMenu,"Load Patient Ictal Image",()=>{self.loadImage("ictal")}),webutil.createMenuItem(sMenu,"Load Patient Inter-Ictal Image",()=>{self.loadImage("interictal")}),webutil.createMenuItem(sMenu,"Load Patient MRI Image",()=>{self.loadImage("mri")}),webutil.createMenuItem(sMenu,""),webutil.createMenuItem(sMenu,"Register Images using Linear Registration (fast,incaccurate)",()=>{self.app_state.nonlinear=!1,self.computeAllRegistrations()}),webutil.createMenuItem(sMenu,"Register Images With Nonlinear Registration (slow,accurate)",()=>{self.app_state.nonlinear=!0,self.computeAllRegistrations()}),webutil.createMenuItem(sMenu,""),webutil.createMenuItem(sMenu,"Compute Diff Spect MAPS",()=>{self.computeSpect()}),webutil.createMenuItem(sMenu,""),webutil.createMenuItem(sMenu,"Show diff SPECT Data Tree(Images)",()=>{self.dataPanel.show()}),webutil.createMenuItem(sMenu,"Show diff SPECT Text Results (Regions)",()=>{self.resultsPanel.show()}),webutil.createMenuItem(sMenu,""),webfileutil.createFileMenuItem(sMenu,"Save diff SPECT Text Results",function(f){self.saveResults(f)},{title:"Save diff SPECT Text Results",save:!0,filters:[{name:"CSV File",extensions:["csv"]}],suffix:"csv",initialCallback:()=>self.getApplicationStateFilename(!1,"csv")})}connectedCallback(){this.simpleFileMenus=!0,super.connectedCallback(),this.VIEWERS[0].collapseCore()}})},"./js/webcomponents/bisweb_draganddropelement.js":function(module,exports,__webpack_require__){"use strict";const $=__webpack_require__("jquery"),webutil=__webpack_require__("./js/coreweb/bis_webutil.js");webutil.defineElement("bisweb-draganddropelement",class extends HTMLElement{constructor(){super(),this.callback=null,this.enabled=!0,this.newdiv=null,this.appended=!1,this.blocks=0}setCallback(clb){this.callback=clb}addBlock(){this.blocks=this.blocks+1}removeBlock(){this.blocks=this.blocks-1,this.blocks<0&&(this.blocks=0)}processEvent(e){return e.stopPropagation(),e.preventDefault(),!(!this.enabled||this.blocks>0||null===this.callback)}fileDragHover(e){e.stopPropagation(),e.preventDefault(),!1!==this.processEvent(e)&&("dragover"==e.type&&!1===this.appended?(this.newdiv=$('<div align="center" style="padding:5px; width:50vw; left:25vw; top:0vh; height:100px;border-radius:30px;background-color:#884400; z-index:5000; position: absolute; color:#ffffff"><H1>Drop Files to Load</H1></div>'),$("body").append(this.newdiv),this.appended=!0):"dragleave"==e.type&&!0===this.appended&&(this.newdiv.remove(),this.newdiv=null,this.appended=!1))}fileSelectHandler(e){if(e.stopPropagation(),e.preventDefault(),!this.enabled||!1===this.callback||this.blocks>0)return;this.newdiv.remove(),this.appended=!1,this.newdiv=null;let files=e.target.files||e.dataTransfer.files||null;null!==files&&files.length>0&&this.callback(files,e)}connectedCallback(){const self=this;window.addEventListener("dragover",function(e){self.fileDragHover(e)},!1),window.addEventListener("dragleave",function(e){self.fileDragHover(e)},!1),window.addEventListener("drop",function(e){self.fileSelectHandler(e)},!1)}})},"./js/webcomponents/bisweb_dualviewerapplication.js":function(module,exports,__webpack_require__){"use strict";const webutil=__webpack_require__("./js/coreweb/bis_webutil.js"),$=__webpack_require__("jquery"),ViewerApplicationElement=__webpack_require__("./js/webcomponents/bisweb_mainviewerapplication.js");class DualViewerApplicationElement extends ViewerApplicationElement{getElementState(storeImages=!1){let obj=super.getElementState(storeImages);return obj.activeViewer=this.getVisibleTab(),obj}setElementState(dt=null,name=""){null!==dt&&(this.setVisibleTab(dt.activeViewer||1),super.setElementState(dt,name))}connectedCallback(){this.syncmode=!0,super.connectedCallback(),this.VIEWERS[0].addImageChangedObserver(this.VIEWERS[1]),this.VIEWERS[0].addColormapObserver(this.VIEWERS[1]),this.VIEWERS[1].addColormapObserver(this.VIEWERS[0]),this.VIEWERS[0].addFrameChangedObserver(this.VIEWERS[1]),this.VIEWERS[1].addFrameChangedObserver(this.VIEWERS[0]);const self=this;let tabset=this.getAttribute("bis-tabset")||null;if(null!==tabset){let tab1link=this.getAttribute("bis-tab1"),tab2link=this.getAttribute("bis-tab2");this.tab1name=tabset+' a[href="'+tab1link+'"]',this.tab2name=tabset+' a[href="'+tab2link+'"]',$(this.tab1name).tab("show"),$(this.tab1name).on("shown.bs.tab",()=>self.VIEWERS[0].handleresize()),$(this.tab2name).on("shown.bs.tab",()=>self.VIEWERS[1].handleresize())}setTimeout(()=>{this.getElementState(!1)},300)}}webutil.defineElement("bisweb-dualviewerapplication",DualViewerApplicationElement),module.exports=DualViewerApplicationElement},"./js/webcomponents/bisweb_filetreepanel.js":function(module,exports,__webpack_require__){const $=__webpack_require__("jquery"),bootbox=__webpack_require__("./node_modules/bootbox/bootbox.js"),bisweb_panel=__webpack_require__("./js/coreweb/bisweb_panel.js"),bis_webutil=__webpack_require__("./js/coreweb/bis_webutil.js"),bis_webfileutil=__webpack_require__("./js/coreweb/bis_webfileutil.js"),bis_genericio=__webpack_require__("./js/core/bis_genericio.js"),userPreferences=__webpack_require__("./js/core/bisweb_userpreferences.js");__webpack_require__("./node_modules/jstree/dist/jstree.js");bis_webutil.defineElement("bisweb-filetreepanel",class extends HTMLElement{constructor(){super()}connectedCallback(){this.viewerid=this.getAttribute("bis-viewerid"),this.viewertwoid=this.getAttribute("bis-viewerid2"),this.layoutid=this.getAttribute("bis-layoutwidgetid"),this.menubarid=this.getAttribute("bis-menubarid"),this.viewerappid=this.getAttribute("bis-viewerapplicationid"),bis_webutil.runAfterAllLoaded(()=>{userPreferences.safeGetItem("internal").then(f=>{this.viewer=document.querySelector(this.viewerid),this.viewertwo=document.querySelector(this.viewertwoid)||null,this.layout=document.querySelector(this.layoutid),this.menubar=document.querySelector(this.menubarid),this.viewerapplication=document.querySelector(this.viewerappid),this.panel=new bisweb_panel(this.layout,{name:"Files",permanent:!1,width:"400",dual:!0,mode:"sidebar"}),f&&this.addMenuItem(this.menubar.getMenuBar());let listElement=this.panel.getWidget();this.makeButtons(listElement)})}),this.contextMenuDefaultSettings={Info:{separator_before:!1,separator_after:!1,label:"File Info",action:()=>{this.showInfoModal()}},Load:{separator_before:!1,separator_after:!1,label:"Load Image",action:()=>{this.loadImageFromTree()}}}}showTreePanel(){this.panel.show()}addMenuItem(menubar){let menuItems=menubar[0].children;for(let item of menuItems)if(-1!==item.innerText.indexOf("File"))for(let childItem of item.children)if(-1!==childItem.className.indexOf("dropdown-menu"))return bis_webutil.createMenuItem($(childItem),"File Tree Panel").on("click",e=>{e.preventDefault(),this.panel.show()}),!0;return console.log("could not find 'File' menu item, cannot add File Tree Panel item to it"),!1}importFiles(filename){console.log("filename",filename);let queryString=filename;queryString=""===queryString?"*/*.nii*":"/"===queryString[queryString.length-1]?queryString.slice(0,filename.length-1)+"/*/*.nii*":filename+"/*/*.nii*",bis_genericio.getMatchingFiles(queryString).then(files=>{files.length>0?this.updateFileTree(files,filename):(queryString=filename+"/*.nii*",bis_genericio.getMatchingFiles(queryString).then(newFiles=>{console.log("filename",filename),this.updateFileTree(newFiles,filename)}))})}updateFileTree(files,baseDirectory){this.baseDirectory=baseDirectory,console.log("files",files);let fileTree=[];for(let file of files){let splitName=file.replace(baseDirectory,"").split("/"),index=0,currentDirectory=fileTree,nextDirectory=null;for(;index<splitName.length;){if(nextDirectory=findParentAtTreeLevel(splitName[index],currentDirectory))currentDirectory=nextDirectory;else{let newEntry={text:splitName[index]};if(index===splitName.length-1){let splitEntry=newEntry.text.split(".");"gz"===splitEntry[splitEntry.length-1]||"nii"===splitEntry[splitEntry.length-1]?newEntry.type="picture":newEntry.type="file"}else newEntry.type="directory",newEntry.children=[];currentDirectory.push(newEntry),currentDirectory=newEntry.children}index+=1}}if(!fileTree[0]||!fileTree[0].children)return void bis_webutil.createAlert("No study files could be found in the chosen directory, try a different directory.",!1);let listElement=this.panel.getWidget();listElement.find(".file-container").remove();let listContainer=$("<div class='file-container'></div>");listContainer.css({color:"rgb(12, 227, 172)"}),listElement.prepend(listContainer),1===fileTree.length&&""===fileTree[0].text&&(fileTree=fileTree[0].children);let tree=listContainer.jstree({core:{data:fileTree,dblclick_toggle:!0,check_callback:!0},types:{default:{icon:"glyphicon glyphicon-file"},file:{icon:"glyphicon glyphicon-file"},root:{icon:"glyphicon glyphicon-home"},directory:{icon:"glyphicon glyphicon-folder-close"},picture:{icon:"glyphicon glyphicon-picture"}},plugins:["types","dnd","contextmenu"],contextmenu:{show_at_node:!1,items:this.contextMenuDefaultSettings}}).bind("move_node.jstree",(e,data)=>{let moveNodes=this.parseSourceAndDestination(data);bis_genericio.moveDirectory(moveNodes.src+"&&"+moveNodes.dest)}),newSettings=this.contextMenuDefaultSettings;function findParentAtTreeLevel(name,entries){for(let entry of entries)if(entry.text===name)return entry.children;return!1}this.viewertwo&&(delete newSettings.Load,console.log("new settings",newSettings),newSettings=Object.assign(newSettings,{Viewer1:{separator_before:!1,separator_after:!1,label:"Load Image to Viewer 1",action:()=>{this.loadImageFromTree(0)}},Viewer2:{separator_before:!1,separator_after:!1,label:"Load Image to Viewer 2",action:()=>{this.loadImageFromTree(1)}}})),console.log("new settings",newSettings),tree.jstree(!0).settings.contextmenu.items=newSettings,tree.jstree(!0).redraw(!0),this.panel.widget.find(".load-image-button").prop("disabled",!1),this.panel.widget.find(".save-study-button").prop("disabled",!1),this.setOnClickListeners(tree,listContainer),this.fileTree=fileTree}makeButtons(listElement){let buttonGroupDisplay=$("\n            <div class='btn-group'>\n                <div class='btn-group top-bar' role='group' aria-label='Viewer Buttons' style='float: left;'>\n                </div>\n                <br>\n                <div class='btn-group bottom-bar' role='group' aria-label='Viewer Buttons' style='float: left;'>\n                </div>\n            </div>\n        "),topButtonBar=buttonGroupDisplay.find(".top-bar"),bottomButtonBar=buttonGroupDisplay.find(".bottom-bar"),loadStudyButton=bis_webfileutil.createFileButton({type:"info",name:"Import study",callback:f=>{this.importFiles(f)}},{title:"Import study",filters:"DIRECTORY",suffix:"DIRECTORY",save:!1}),saveStudyButton=bis_webfileutil.createFileButton({type:"primary",name:"Export study",callback:f=>{this.exportStudy(f)}},{title:"Export study",filters:"DIRECTORY",suffix:"DIRECTORY",save:!0});saveStudyButton.addClass("save-study-button"),saveStudyButton.prop("disabled","true");let loadImageButton=$("<button type='button' class='btn btn-success btn-sm load-image-button' disabled>Load image</button>");loadImageButton.on("click",()=>{this.loadImageFromTree()}),topButtonBar.append(loadImageButton),topButtonBar.append(loadStudyButton),bottomButtonBar.append(saveStudyButton),listElement.append("<br>"),listElement.append(buttonGroupDisplay)}setOnClickListeners(tree,listContainer){let handleLeftClick=data=>{"directory"===data.node.original.type&&(data.instance.open_node(this,!1),this.currentlySelectedNode=data.node)},handleRightClick=data=>{"directory"===data.node.original.type?this.toggleContextMenuLoadButtons(tree,"off"):this.toggleContextMenuLoadButtons(tree,"on")},handleDblClick=()=>{console.log("currently selected node",this.currentlySelectedNode),"picture"===this.currentlySelectedNode.original.type&&this.loadImageFromTree()};listContainer.on("select_node.jstree",(event,data)=>{console.log("select_node",event,data),this.currentlySelectedNode=data.node,"click"===data.event.type?handleLeftClick(data):"contextmenu"===data.event.type&&handleRightClick(data)}),tree.bind("dblclick.jstree",e=>{console.log("dblclick",e),handleDblClick()})}loadImageFromTree(viewer=0){let nodeName=this.constructNodeName();this.viewerapplication.loadImage(nodeName,viewer)}exportStudy(filepath){try{let stringifiedFiles=JSON.stringify(this.fileTree);console.log("stringified files",stringifiedFiles,"path",filepath);let splitPath=filepath.split(".");(splitPath.length<2||"JSON"!==splitPath[1]||"json"!==splitPath[1])&&(splitPath[1]="json"),filepath=splitPath.join("."),bis_genericio.write(filepath,stringifiedFiles,!1)}catch(e){console.log("an error occured while saving to disk",e),bis_webutil.createAlert("An error occured while saving the study files to disk.",!1)}}parseSourceAndDestination(data){let srcName,destName,nodeName=$(`#${data.node.id}`).find(`#${data.node.id}_anchor`).text();if(console.log("data.old_parent",data.old_parent,"data.parent",data.parent),"#"===data.old_parent)srcName=this.baseDirectory+"/"+nodeName;else{let oldParentName=$(`#${data.old_parent}`).find(`#${data.old_parent}_anchor`).text();srcName=this.baseDirectory+"/"+oldParentName+"/"+nodeName}if("#"===data.parent)destName=this.baseDirectory+"/"+nodeName;else{let newParentName=$(`#${data.parent}`).find(`#${data.parent}_anchor`).text();destName=this.baseDirectory+"/"+newParentName+"/"+nodeName}return console.log("srcName",srcName,"destName",destName),{src:srcName,dest:destName}}showInfoModal(){bis_genericio.isDirectory(this.constructNodeName()).then(isDirectory=>{bis_genericio.getFileStats(this.constructNodeName()).then(stats=>{let displayedSize,filetype;console.log("stats",stats);let kb=stats.size/1e3,mb=kb/1e3,gb=mb/1e3;gb>1?(displayedSize=gb,filetype="GB"):mb>1?(displayedSize=mb,filetype="MB"):(displayedSize=kb,filetype="KB");let roundedSize=Math.round(10*displayedSize)/10,accessedTime=new Date(stats.atimeMs),createdTime=new Date(stats.birthtimeMs),modifiedTime=new Date(stats.mtimeMs),parsedIsDirectory=isDirectory?"Yes":"No";console.log("accessed time",accessedTime.toDateString(),"created time",createdTime,"modified time",modifiedTime);let infoDisplay=`File Size: ${roundedSize}${filetype}<br> First Created: ${createdTime}<br> Last Modified: ${modifiedTime}<br> Last Accessed: ${accessedTime} <br> Is a Directory: ${parsedIsDirectory}`;bootbox.dialog({title:"File Info",message:infoDisplay})})})}toggleContextMenuLoadButtons(tree,toggle){let existingTreeSettings=tree.jstree(!0).settings.contextmenu.items;console.log("existing tree settings",existingTreeSettings),"on"===toggle?existingTreeSettings.Load?existingTreeSettings.Load._disabled=!1:(existingTreeSettings.Viewer1._disabled=!1,existingTreeSettings.Viewer2._disabled=!1):"off"===toggle&&(existingTreeSettings.Load?existingTreeSettings.Load._disabled=!0:(existingTreeSettings.Viewer1._disabled=!0,existingTreeSettings.Viewer2._disabled=!0))}constructNodeName(){console.log("currently selected node",this.currentlySelectedNode,"base directory",this.baseDirectory);let name="",currentNode=this.currentlySelectedNode,tree=this.panel.widget.find(".file-container").jstree();for(;currentNode.parent;){name="/"+currentNode.text+name;let parentNode=tree.get_node(currentNode.parent);console.log("parentNode",parentNode),currentNode=parentNode}return this.baseDirectory+name}})},"./js/webcomponents/bisweb_fmrielement.js":function(module,exports,__webpack_require__){"use strict";const BisWebImage=__webpack_require__("./js/dataobjects/bisweb_image.js"),webutil=__webpack_require__("./js/coreweb/bis_webutil.js"),webfileutil=__webpack_require__("./js/coreweb/bis_webfileutil.js"),bisgenericio=__webpack_require__("./js/core/bis_genericio.js"),$=__webpack_require__("jquery"),bootbox=__webpack_require__("./node_modules/bootbox/bootbox.js"),LinearRegistration=__webpack_require__("./js/modules/linearRegistration.js"),ResliceImage=__webpack_require__("./js/modules/resliceImage.js"),NonlinearRegistration=__webpack_require__("./js/modules/nonlinearRegistration.js"),BisWebPanel=__webpack_require__("./js/coreweb/bisweb_panel.js"),MotionCorrection=__webpack_require__("./js/modules/motionCorrection.js"),fs=__webpack_require__("./lib/js/fs.js"),TransformationCollection=__webpack_require__("./js/dataobjects/bisweb_transformationcollection.js");__webpack_require__("./node_modules/jstree/dist/jstree.js");const tree_template_string='\n<div class="container" style="width:300px">\n    <div id="treeDiv">\n    </div>\n</div> \n';let app_state={viewer:null,images:{mni:null,anat:[],func:[],dwi:[],derivatives:[]}};webutil.defineElement("bisweb-fmrielement",class extends HTMLElement{constructor(){super(),this.panel=null,app_state.images.mni=new BisWebImage;let imagepath=webutil.getWebPageImagePath();app_state.images.mni.load(`${imagepath}/MNI_T1_2mm_stripped_ras.nii.gz`,!1).then(()=>{console.log("MNI Loaded")})}createNewStudy(){const self=this;let tree=this.tree_div.find("#treeDiv");console.log(tree);let json_data={core:{data:[{text:"New Subject",children:[{text:"anat"},{text:"func"},{text:"dwi"},{text:"derivatives"}]}],check_callback:!0},plugins:["contextmenu"],contextmenu:{items:self.customMenu}};tree.jstree(json_data).bind("select_node.jstree",function(e,node){let parentID=node.node.parent;if("j1_2"===parentID){let imagearray=app_state.images.anat;console.log(imagearray);for(let i=0;i<imagearray.length;i++)if(node.node.text===imagearray[i].name){app_state.viewer.setimage(imagearray[i].image);break}}else if("j1_3"===parentID){let imagearray=app_state.images.func;console.log(imagearray);for(let i=0;i<imagearray.length;i++)if(node.node.text===imagearray[i].name){app_state.viewer.setimage(imagearray[i].image);break}}else if("j1_4"===parentID){let imagearray=app_state.images.dwi;console.log(imagearray);for(let i=0;i<imagearray.length;i++)if(node.node.text===imagearray[i].name){app_state.viewer.setimage(imagearray[i].image);break}}else if("j1_5"===parentID){let imagearray=app_state.images.derivatives;console.log(imagearray);for(let i=0;i<imagearray.length;i++)if(node.node.text===imagearray[i].name){console.log("image found"),app_state.viewer.setimage(imagearray[i].image);break}if("AVERAGE_fmri_T1space.nii.gz"===node.node.text){let t1=self.getT1Image(app_state.images.anat).image;app_state.viewer.setimage(t1);for(let i=0;i<imagearray.length;i++)if(node.node.text===imagearray[i].name){console.log("image found"),app_state.viewer.setobjectmap(imagearray[i].image);break}}}})}customMenu(node){console.log(this),console.log($("#treeDiv"));let tree=$("#treeDiv");console.log(node);let items={addImage:{label:"Load Data",action:function(){webfileutil.genericFileCallback({title:"Load Image",suffix:"NII"},function(filename){let newimg=new BisWebImage;newimg.load(filename,!1).then(()=>{"anat"===node.text?(app_state.images.anat.push({image:newimg,name:filename.name}),console.log(newimg),tree.jstree().create_node("j1_2",{text:filename.name})):"func"===node.text?(app_state.images.func.push({image:newimg,name:filename.name}),tree.jstree().create_node("j1_3",{text:filename.name})):"dwi"===node.text&&(app_state.images.dwi.push({image:newimg,name:filename.name}),tree.jstree().create_node("j1_4",{text:filename.name})),app_state.viewer.setimage(newimg)})}),console.log(app_state.images)}}};return"anat"!==node.text&&"func"!==node.text&&"dwi"!==node.text&&delete items.addImage,items}saveDataToJSON(fobj){console.log(fobj);let imgStr=JSON.stringify(app_state.images,null,2);console.log("serialized");let output={bisformat:"bisweb-fmritool",images:imgStr};bisgenericio.write(fobj,JSON.stringify(output,null,2))}loadDataFromJSON(){return new Promise((resolve,reject)=>{let input=document.createElement("input");input.type="file",input.click();let jsonobj,filename=document.getElementById("input").files[0].value,text=fs.readFileSync(filename).toString("utf-8");try{jsonobj=JSON.parse(text)}catch(e){bootbox.alert("Invalid File Type"),reject(e)}resolve(jsonobj)})}populateTree(jsonobj){let images=jsonobj.images,anat=images.anat,func=images.func,dwi=images.dwi,deriv=images.derivatives,tree=$("#treeDiv");for(let i=0;i<anat.length;i++)tree.jstree().create_node("j1_2",{text:anat[i].name});for(let i=0;i<func.length;i++)tree.jstree().create_node("j1_3",{text:func[i].name});for(let i=0;i<dwi.length;i++)tree.jstree().create_node("j1_4",{text:dwi[i].name});for(let i=0;i<deriv.length;i++)tree.jstree().create_node("j1_5",{text:deriv[i].name})}computeNonlinearRegistration(reference,target){let nonlinearReg=new NonlinearRegistration,input={reference:reference,target:target},opts={intscale:1,numbins:64,levels:3,imagesmoothing:1,optimization:"ConjugateGradient",stepsize:1,metric:"NMI",steps:1,iterations:1,cps:20,append:!0,linearmode:"Affine",resolution:1.5,lambda:.001,cpsrate:2,doreslice:!0,norm:!0,debug:!0},output={xform:null,reslice:null};return new Promise((resolve,reject)=>{nonlinearReg.execute(input,opts).then(()=>{output.xform=nonlinearReg.getOutputObject("output"),output.reslice=nonlinearReg.getOutputObject("resliced"),resolve(output)}).catch(e=>{console.log("Error:",e,e.stack),bootbox.alert("ERROR:",e,e.stack),reject(e)})})}computeLinearRegistration(reference,target){let input={reference:reference,target:target},opts={intscale:1,numbins:64,levels:3,imagesmoothing:1,optimization:"ConjugateGradient",stepsize:1,metric:"NMI",steps:1,iterations:1,mode:"Rigid",resolution:1.5,doreslice:!0,norm:!0,debug:!1},linearReg=new LinearRegistration,output={transformation:null,reslice:null};return new Promise((resolve,reject)=>{linearReg.execute(input,opts).then(()=>{output.xform=linearReg.getOutputObject("output"),output.reslice=linearReg.getOutputObject("resliced"),resolve(output)}).catch(e=>{console.log("ERROR:",e,e.stack),bootbox.alert("ERROR"),reject(e)})})}computeMotionCorrection(array){let imageArray=[];console.log(array);for(let i=0;i<array.length;i++)imageArray.push(array[i].image);let middleImage,numImages=imageArray.length;console.log(imageArray);let dims=(middleImage=imageArray[Math.round((numImages-1)/2)]).getDimensions();console.log(middleImage);let motionCorrection=new MotionCorrection,input={target:null,reference:middleImage},parameters={doreslice:!0,norm:!0,intscale:1,numbins:64,extrasmoothing:0,metric:"CC",optimization:"HillClimb",stepsize:.25,levels:3,iterations:1,resolution:1.01,debug:!1,steps:4,refno:Math.round((dims[3]-1)/2)};return new Promise((resolve,reject)=>{let outputs=[];for(let i=0;i<imageArray.length;i++)input.target=imageArray[i],motionCorrection.execute(input,parameters).then(()=>{outputs.push({xform:motionCorrection.getOutputObject("output"),image:motionCorrection.getOutputObject("resliced"),name:"CORRECTED_"+array[i].name}),$("#treeDiv").jstree().create_node("j1_5",{text:outputs[i].name})}).catch(e=>{console.log("Error:",e,e.stack),bootbox.alert("ERROR"),reject(e)});resolve(outputs)})}getMotionCorrectedImages(array){let correctedImages=[];for(let i=0;i<array.length;i++)"CORRECTED_"===array[i].name.substring(0,10)&&correctedImages.push(array[i]);return correctedImages}computeAverageImage(array){let imageArray=[];for(let i=0;i<array.length;i++)imageArray.push(array[i].image);let dims=imageArray[0].getDimensions(),pitch=[1,dims[0],dims[0]*dims[1],dims[0]*dims[1]*dims[2],dims[0]*dims[1]*dims[2]*dims[3]],averageImage=new BisWebImage;averageImage.cloneImage(imageArray[0]);for(let i=0;i<dims[0];i++)for(let j=0;j<dims[1];j++)for(let k=0;k<dims[2];k++)for(let t=0;t<dims[3];t++){let averageVoxelIntensity=0,sumVoxelIntensity=0;for(let currentImage=0;currentImage<imageArray.length;currentImage++)sumVoxelIntensity+=imageArray[currentImage].getVoxel([i,j,k,t]);averageVoxelIntensity=sumVoxelIntensity/imageArray.length,t%50==0&&console.log("Average Voxel Intensity:",averageVoxelIntensity),averageImage.getImageData()[i*pitch[0]+j*pitch[1]+k*pitch[2]+t*pitch[3]]=averageVoxelIntensity}return averageImage}getAverageFMRI(array){let averageImage=null;for(let i=0;i<array.length;i++)if("AVERAGE_fmri.nii.gz"===array[i].name){averageImage=array[i],console.log("Average Image Found");break}return averageImage}getT1Image(array){let t1=null;for(let i=0;i<array.length;i++)(array[i].name.indexOf("T1")>=0||array[i].name.indexOf("t1")>=0)&&(t1=array[i]);return t1}connectedCallback(){const self=this,menubarid=this.getAttribute("bis-menubarid");let menubar=document.querySelector(menubarid).getMenuBar(),fmenu=webutil.createTopMenuBarMenu("File",menubar),processingmenu=webutil.createTopMenuBarMenu("Image Processing",menubar),registrationmenu=webutil.createTopMenuBarMenu("Image Registration",menubar);webutil.createMenuItem(fmenu,"New Subject",function(){self.createNewStudy()}),webutil.createMenuItem(fmenu,"Load Study Data",function(){self.loadDataFromJSON().then(resolvedObj=>{"bisweb-fmritool"===resolvedObj.bisformat?(app_state.images=resolvedObj.images,self.createNewStudy(),self.populateTree()):bootbox.alert("Not a valid JSON file")})}),webfileutil.createFileMenuItem(fmenu,"Save Study Data",function(fileobj){self.saveDataToJSON(fileobj)},{title:"Save Data",save:!0,filters:[{name:"Patient File",extensions:["fmri"]}],suffix:"biswebstate",initialCallback:()=>"new_study.fmri"}),webutil.createMenuItem(processingmenu,"Correct Motion",function(){app_state.images.func.length>0?self.computeMotionCorrection(app_state.images.func).then(resolvedObject=>{app_state.images.derivatives=resolvedObject}):bootbox.alert("No Functional Images Found")}),webutil.createMenuItem(processingmenu,"Compute Average Functional Image",function(){let correctedImages=self.getMotionCorrectedImages(app_state.images.derivatives);if(correctedImages.length>0){let averageImage=self.computeAverageImage(correctedImages);app_state.images.derivatives.push({image:averageImage,xform:null,name:"AVERAGE_fmri.nii.gz"}),$("#treeDiv").jstree().create_node("j1_5",{text:"AVERAGE_fmri.nii.gz"})}else bootbox.alert("No Motion Corrected Images Found")}),webutil.createMenuItem(registrationmenu,"Register Functional to T1",function(){let averageImage=self.getAverageFMRI(app_state.images.derivatives).image,t1=self.getT1Image(app_state.images.anat).image;null!==averageImage&&null!==t1?self.computeLinearRegistration(t1,averageImage).then(output=>{let newObject={image:output.reslice,xform:output.xform,name:"AVERAGE_fmri_T1space.nii.gz"};app_state.images.derivatives.push(newObject),$("#treeDiv").jstree().create_node("j1_5",{text:"AVERAGE_fmri_T1space.nii.gz"})}):bootbox.alert("Invalid Images")}),webutil.createMenuItem(registrationmenu,"Register T1 to MNI",function(){let t1=self.getT1Image(app_state.images.anat).image,average=self.getAverageFMRI(app_state.images.derivatives);null!==t1&&self.computeLinearRegistration(app_state.mni,t1).then(output=>{let newObject={image:output.reslice,xform:output.xform,name:"T1_MNIspace.nii.gz"};app_state.images.derivatives.push(newObject),$("#treeDiv").jstree().create_node("j1_5",{text:"T1_MNIspace.nii.gz"});let input={input:average,xform:average.xform,xform2:newObject.xform,reference:app_state.mni},reslicer=new ResliceImage;reslicer.execute(input).then(()=>{let average_mni=reslicer.getOutputObject("output"),name="AVERAGE_fmri_MNIspace.nii.gz",xform=new TransformationCollection;xform.addTransformation(average.xform),xform.addTransformation(newObject.xform),app_state.images.derivatives.push({images:average_mni,name:name,xform:xform}),$("#treeDiv").jstree().create_node("j1_5",{name:name})})})}),webutil.createMenuItem(fmenu,""),webutil.createMenuItem(fmenu,"Show fMRI Tool",function(){self.panel.show()});let layoutid=this.getAttribute("bis-layoutwidgetid"),layoutcontroller=document.querySelector(layoutid);app_state.viewer=document.querySelector(this.getAttribute("bis-viewerid")),this.panel=new BisWebPanel(layoutcontroller,{name:"fMRI Tool",permanent:!1,width:"300",dual:!1,mode:"sidebar"});let fmriToolsDiv=this.panel.getWidget();if(console.log(this.panel),app_state.viewer.collapseCore(),this.tree_div=$(tree_template_string),fmriToolsDiv.append(this.tree_div),this.panel.show(),console.log(this.tree_div),webutil.inElectronApp()){let hmenu=webutil.createTopMenuBarMenu("Help",menubar);webutil.createMenuItem(hmenu,"Show JavaScript Console",()=>{window.BISELECTRON.remote.getCurrentWindow().toggleDevTools()})}}})},"./js/webcomponents/bisweb_grapherelement.js":function(module,exports,__webpack_require__){"use strict";const $=__webpack_require__("jquery"),Chart=__webpack_require__("./node_modules/chart.js/src/chart.js"),webutil=__webpack_require__("./js/coreweb/bis_webutil.js"),util=__webpack_require__("./js/core/bis_util.js"),fmriutil=__webpack_require__("./js/legacy/bis_fmrimatrixconnectivity.js"),numeric=__webpack_require__("./node_modules/numeric/numeric-1.2.6.js"),bisgenericio=__webpack_require__("./js/core/bis_genericio.js"),bootbox=__webpack_require__("./node_modules/bootbox/bootbox.js"),filesaver=__webpack_require__("./lib/js/FileSaver.js");Chart.defaults.global.defaultFontColor="white",Chart.defaults.global.defaultFontSize="16";webutil.defineElement("bisweb-graphelement",class extends HTMLElement{constructor(){super(),this.lastviewer=null,this.desired_width=500,this.desired_height=500,this.lastdata=null,this.graphcanvasid=null,this.lastShowVolume=!1,this.graphWindow=null,this.resizingTimer=null,this.buttons=[]}createGUI(showbuttons=!0){if(null!==this.graphcanvasid){if(this.buttons.length>0)for(let i=0;i<this.buttons.length;i++)showbuttons?this.buttons[i].css({visibility:"visible"}):this.buttons[i].css({visibility:"hidden"});return}this.graphcanvasid=webutil.getuniqueid(),this.graph=null,this.graphWindow=document.createElement("bisweb-dialogelement"),this.graphWindow.create("VOI Tool",this.desired_width,this.desired_height,20,100,100,!1),this.graphWindow.widget.css({"background-color":"#222222"}),this.graphWindow.setCloseCallback(()=>{if(this.buttons.length>0)for(let i=0;i<this.buttons.length;i++)this.buttons[i].css({visibility:"hidden"});this.graphWindow.hide()});let bbar=this.graphWindow.getFooter(),self=this;this.graphWindow.close.remove(),bbar.empty(),showbuttons&&(this.buttons=[],this.buttons.push(webutil.createbutton({name:"Plot VOI Values",type:"primary",tooltip:"",css:{"margin-left":"10px"},position:"right",parent:bbar}).click(()=>{this.rePlotGraph(!1).catch(()=>{})})),this.buttons.push(webutil.createbutton({name:"Plot VOI Volumes",type:"default",tooltip:"",css:{"margin-left":"10px"},position:"left",parent:bbar}).click(()=>{this.rePlotGraph(!0).catch(()=>{})}))),webutil.createbutton({name:"Export as CSV",type:"info",tooltip:"Export Data",css:{"margin-left":"10px"},position:"left",parent:bbar}).click(function(e){e.preventDefault(),self.exportLastData()}),webutil.createbutton({name:"Save Snapshot",type:"warning",tooltip:"",css:{"margin-left":"10px"},position:"left",parent:bbar}).click(()=>{this.saveSnapshot()}),bbar.tooltip()}parsePaintedAreaAverageTimeSeries(orthoElement){if(!orthoElement)return;this.lastdata=null;let image=orthoElement.getimage(),objectmap=orthoElement.getobjectmap();if(null===image||null===objectmap)return void webutil.createAlert("No image or objecmap in memory",!0);let matrix=null;try{matrix=fmriutil.roimean(image,objectmap)}catch(e){return void webutil.createAlert("Cannot create roi:"+e,!0)}let y=numeric.transpose(matrix.means),dim=numeric.dim(y),x=null;if(dim[1]>1){x=numeric.rep([matrix.means.length],0);for(let i=0;i<matrix.means.length;i++)x[i]=i}else{x=numeric.rep([dim[0]],0);for(let i=0;i<dim[0];i++)x[i]=i+1}this.plotGraph(x,y,matrix.numvoxels,orthoElement)}plotGraph(x,y,numvoxels=null,orthoElement=null){if(orthoElement||(orthoElement=document.getElementsByClassName("bisweb-orthogonalviewer").item(0)),!orthoElement)return;let changedViewer=!1;orthoElement!==this.lastviewer&&(this.lastviewer&&this.lastviewer.removeResizeObserver(this),changedViewer=!0,this.lastviewer=orthoElement),this.lastdata={x:x,y:y,numvoxels:numvoxels},this.rePlotGraph(!1).then(()=>{changedViewer&&this.lastviewer.addResizeObserver(this)}).catch(e=>{console.log(e,e.stack)})}rePlotGraph(showVolume=!1){let showbuttons=!0;if(this.lastShowVolume=showVolume,null===this.lastdata.numvoxels&&(showVolume=!1,showbuttons=!1),this.lastdata.y<1)return webutil.createAlert("No  objecmap in memory",!0),Promise.reject();let numframes=numeric.dim(this.lastdata.y)[1],data=this.formatChartData(this.lastdata.x,this.lastdata.y,this.lastdata.numvoxels,showVolume),options=null,d_type="";if(numframes>1&&!1===showVolume)options={title:{display:!0,text:"Average Intensity in each Region vs Time"},elements:{line:{tension:0}},scales:{xAxes:[{scaleLabel:{display:!0,labelString:"Time (s)",fontSize:20}}],yAxes:[{ticks:{beginAtZero:!1},scaleLabel:{display:!0,labelString:"Intensity",fontSize:20}}]},legend:{position:"right",display:!1}},d_type="line";else{let heading="Volume of each Region";!1===showVolume&&(heading="Average Intensity in each Region"),options={title:{display:!0,text:heading},legend:{position:"right",display:!1},scales:{yAxes:[{scaleLabel:{display:!0,labelString:"Volume (mm^3)",fontSize:10}}],xAxes:[{scaleLabel:{display:!0,labelString:"Region Index",fontSize:10}}]}},d_type="bar"}this.createGUI(showbuttons),this.graphWindow.show();let dm=this.getCanvasDimensions();if(!dm)return Promise.reject("Bad Dimensions");let cw=dm[0],ch=dm[1],cnv=$(`<canvas id="${this.graphcanvasid}" width="${cw}" height="${ch}"></canvas></div>`);this.graphWindow.widget.append(cnv),cnv.css({"background-color":"#555555",position:"absolute",left:"5px",top:"8px",margin:"0 0 0 0",padding:"0 0 0 0",height:`${ch}px`,width:`${cw}px`});let canvas=document.getElementById(this.graphcanvasid);return canvas.getContext("2d").clearRect(0,0,canvas.width,canvas.height),null!==this.graph&&this.graph.destroy(),new Promise(resolve=>{setTimeout(()=>{this.graph=new Chart(canvas,{type:d_type,data:data,options:options}),resolve()},1)})}formatChartData(x,y,numVoxels,showVolume){let mx=util.objectmapcolormap.length,labels=[];if(numeric.dim(y)[1]>1&&!1===showVolume){let parsedDataSets=[];for(let i=0;i<y.length;i++)if(0!=numVoxels[i]){let index=i+1;for(;index>=mx;)index-=mx;let cl=util.objectmapcolormap[index];cl="rgb("+cl[0]+", "+cl[1]+", "+cl[2]+")",parsedDataSets[i]={label:"Region "+i,data:y[i],backgroundColor:cl,borderColor:cl,borderWidth:1,pointRadius:0,fill:!1}}return{labels:labels=x,datasets:parsedDataSets=parsedDataSets.filter(Boolean)}}{let parsedDataSet=[],data=[],backgroundColor=[];for(let i=0;i<y.length;i++){let doshow=!1;if(null===numVoxels?doshow=!0:numVoxels[i]>0&&(doshow=!0),doshow){let index=i+1,colorindex=index;for(;colorindex>=mx;)colorindex=colorindex-1-(mx-1)+1;let cl=util.objectmapcolormap[colorindex];cl="rgb("+cl[0]+", "+cl[1]+", "+cl[2]+")",backgroundColor.push(cl);let out="R"+index;labels.push(out),!1===showVolume?data.push(y[i]):data.push(numVoxels[i])}}return parsedDataSet.push({data:data,backgroundColor:backgroundColor,borderWidth:1,pointRadius:0}),{labels:labels,datasets:parsedDataSet}}}saveSnapshot(){let canvas=document.getElementById(this.graphcanvasid),outcanvas=document.createElement("canvas");outcanvas.width=canvas.width,outcanvas.height=canvas.height;let ctx=outcanvas.getContext("2d");ctx.fillStyle="#555555",ctx.globalCompositeOperation="source-over",ctx.fillRect(0,0,outcanvas.width,outcanvas.height),ctx.drawImage(canvas,0,0,outcanvas.width,outcanvas.height);let outimg=outcanvas.toDataURL("image/png"),dispimg=$('<img id="dynamic">');dispimg.attr("src",outimg),dispimg.width(300);let a=webutil.creatediv();return a.append(dispimg),bootbox.dialog({title:"This is the snapshot (size="+canvas.width+"x"+canvas.height+").<BR> Click SAVE to output as png.",message:a.html(),buttons:{ok:{label:"Save To File",className:"btn-success",callback:function(){let blob=bisgenericio.dataURLToBlob(outimg);if(webutil.inElectronApp()){let reader=new FileReader;reader.onload=function(){let buf=this.result,arr=new Int8Array(buf);bisgenericio.write({filename:"snapshot.png",title:"Select file to save snapshot in",filters:[{name:"PNG Files",extensions:["png"]}]},arr,!0)},reader.readAsArrayBuffer(blob)}else filesaver(blob,"snapshot.png")}},cancel:{label:"Cancel",className:"btn-danger"}}}),!1}exportLastData(){if(null===this.lastdata)return;let dim=numeric.dim(this.lastdata.y),numrows=dim[1],numcols=dim[0],out=" ,";for(let pass=0;pass<=2;pass++){1==pass&&(out+="Volume,"),2==pass&&(out+="\nFrame,");for(let col=0;col<numcols;col++)this.lastdata.numvoxels[col]>0&&(out+=0===pass||2===pass?`Region ${col+1}`:`${this.lastdata.numvoxels[col]}`,col<numcols-1&&(out+=","));out+="\n"}for(let row=0;row<numrows;row++){let line=`${this.lastdata.x[row]}, `;for(let col=0;col<numcols;col++)this.lastdata.numvoxels[col]>0&&(line+=`${this.lastdata.y[col][row]}`,col<numcols-1&&(line+=","));out+=line+"\n"}return bisgenericio.write({filename:"voidata.csv",title:"Select file to save void timeseries as ",filters:[{name:"CSV Files",extensions:["csv"]}]},out),!1}handleresize(){if(this.resizingTimer&&(clearTimeout(this.resizingTimer),this.resizingTimer=null),null===this.graphWindow)return;if(!this.graphWindow.isVisible())return void this.getCanvasDimensions();const self=this;this.resizingTimer=setTimeout(()=>{self.rePlotGraph(self.lastShowVolume).catch(e=>{console.log(e,e.stack)})},200)}getCanvasDimensions(){let dim=[200,200];this.lastviewer?dim=this.lastviewer.getViewerDimensions():null===dim&&(dim=[window.innerWidth,window.innerHeight]);let width=dim[0]-20,height=dim[1]-20;this.graphWindow.dialog.css({left:"10px",width:`${width}px`,top:"40px",height:`${height}px`});let innerh=height-120,innerw=width-10;return this.graphWindow.widget.css({margin:"0 0 0 0",padding:"0 0 0 0",height:`${innerh}px`,width:`${innerw}px`,"overflow-y":"hidden","overflow-x":"hidden"}),this.graphWindow.widgetbase.css({height:`${innerh}px`,width:`${innerw}px`,"background-color":"#222222",margin:"0 0 0 0",padding:"0 0 0 0","overflow-y":"hidden","overflow-x":"hidden"}),this.graphWindow.footer.css({height:"40px",margin:"3 3 3 3",padding:"0 0 0 0","overflow-y":"hidden","overflow-x":"hidden"}),this.graphWindow.widget.empty(),[innerw,innerh-15]}})},"./js/webcomponents/bisweb_landmarkcontrolelement.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var dat_gui__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/dat.gui/build/dat.gui.module.js");const THREE=__webpack_require__("three"),util=__webpack_require__("./js/core/bis_util.js"),bisCrossHair=__webpack_require__("./js/coreweb/bis_3dcrosshairgeometry.js"),LandmarkSet=__webpack_require__("./js/dataobjects/bis_landmarks.js"),webutil=__webpack_require__("./js/coreweb/bis_webutil.js"),bisgenericio=__webpack_require__("./js/core/bis_genericio.js"),$=__webpack_require__("jquery"),bootbox=__webpack_require__("./node_modules/bootbox/bootbox.js"),webfileutil=__webpack_require__("./js/coreweb/bis_webfileutil.js"),inobounce=__webpack_require__("./lib/js/inobounce.js"),BisWebPanel=__webpack_require__("./js/coreweb/bisweb_panel.js");var loaderror=function(msg){console.log(msg),webutil.createAlert(msg,!0)},MAXSETS=5;webutil.defineElement("bisweb-landmarkcontrolelement",class extends HTMLElement{constructor(){super(),this.internal={initialized:!1,this:null,subviewers:null,volume:null,parentDomElement:null,domElement:null,orthoviewer:null,landmarkset:null,currentsetindex:0,currentpoint:0,mesh:[],meshcustomvisible:[],meshvisible:[],pickmode:!1,pickbutton:null,cursormesh:null,landlabelelement:null,enableelement:null,folders:null,landmarkpropertiesgui:null,currentpointselect:null,data:{showmode:"Current",allshowmodes:["Current","All","None","Custom"],customshow:!0,enabled:!1,size:2,currentname:"No Point Sets in Memory",allnames:"No Point Sets in Memory",description:"",currentpoint:0,color:"#ff0000",dummy:!1},mousestate:-2},this.panel=null}cleanupdisplayelements(docursor=!1,currentonly=!1){if(null!==this.internal.subviewers&&null!==this.internal.mesh){for(var i=0,st=0;st<this.internal.landmarkset.length;st++)if((!1===currentonly||st===this.internal.currentsetindex)&&null!==this.internal.mesh[st]){for(i=0;i<this.internal.subviewers.length;i++)null!==this.internal.subviewers[i]&&null!==this.internal.mesh[st][i]&&(this.internal.mesh[st][i].visible=!1,this.internal.subviewers[i].scene.remove(this.internal.mesh[st][i]),this.internal.mesh[st][i]=null);this.internal.mesh[st]=null}if(docursor){for(i=0;i<this.internal.subviewers.length;i++)null!==this.internal.cursormesh[i]&&(null!==this.internal.subviewers[i]&&this.internal.subviewers[i].scene.remove(this.internal.cusormesh[i]),this.internal.cursormesh[i].visible=!1,this.internal.cursormesh[i]=null);this.internal.cursormesh=null}}}createlandmarksetgeometry(points,pointsize,smallsphere){if(points.length<1)return null;smallsphere=smallsphere||!1;var sz=this.internal.volume.getImageSize(),spa=this.internal.volume.getSpacing(),length=.02*sz[0]*pointsize,thickness=.5*spa[0],radius=.5*length;smallsphere&&(radius=.5*spa[0]);var core=bisCrossHair.createcore(length,thickness,!0,radius);return bisCrossHair.createcopies(core,points)}createcursormesh(){var sz=this.internal.volume.getImageSize(),spa=this.internal.volume.getSpacing(),wd=.1*sz[0],thk=.8*spa[0],core=bisCrossHair.createcore(wd,thk,!0,.2*wd),cursorgeom=new THREE.BufferGeometry;cursorgeom.setIndex(new THREE.BufferAttribute(core.indices,1)),cursorgeom.addAttribute("position",new THREE.BufferAttribute(core.vertices,3)),this.internal.cursormesh=new Array(this.internal.subviewers.length);for(var gmat=new THREE.MeshPhongMaterial({wireframe:!0,color:16777215,specular:16777215,shininess:100}),i=0;i<this.internal.subviewers.length;i++)this.internal.cursormesh[i]=new THREE.Mesh(cursorgeom,gmat),this.internal.cursormesh[i].visible=!1,this.internal.subviewers[i].scene.add(this.internal.cursormesh[i])}createlandmarkmesh(index){var st=util.range(index||0,0,this.internal.landmarkset.length-1),pset=this.internal.landmarkset[st];if(pset.getnumpoints()<1)null!==this.internal.mesh[st]&&this.internal.mesh[st].forEach(function(e){null!==e&&(e.visible=!1)});else{this.internal.mesh[st]=new Array(this.internal.subviewers.length);for(var geometry=this.createlandmarksetgeometry(pset.points,pset.size,!0),geometry2=this.createlandmarksetgeometry(pset.points,pset.size,!1),mat=new THREE.MeshBasicMaterial({color:pset.color,wireframe:!0}),mat2=new THREE.MeshBasicMaterial({color:pset.color,wireframe:!1}),i=0;i<this.internal.subviewers.length;i++)i===this.internal.subviewers.length-1?this.internal.mesh[st][i]=new THREE.Mesh(geometry2,mat2):this.internal.mesh[st][i]=new THREE.Mesh(geometry,mat),this.internal.mesh[st][i].visible=!1,this.internal.subviewers[i].scene.add(this.internal.mesh[st][i])}}updatecolors(){var pset=this.internal.landmarkset[this.internal.currentsetindex];pset.color=this.internal.data.color;var colorValue=pset.color.replace("#","0x"),mesh=this.internal.mesh[this.internal.currentsetindex];null!==mesh&&mesh.forEach(function(e){e.material.color.setHex(colorValue)}),null!==this.internal.cursormesh&&this.internal.cursormesh.forEach(function(e){e.material.color.setHex(colorValue)})}updatelandmarkproperties(){return this.internal.landmarkpropertiesgui.modal("show"),!1}updatedisplay(currentonly){if(!1===this.internal.meshvisible[this.internal.currentsetindex])return;if(currentonly=currentonly||!1,this.cleanupdisplayelements(!1,currentonly),null===this.internal.subviewers)return;null===this.internal.cursormesh&&this.createcursormesh();for(var numsets=this.internal.mesh.length,st=0;st<numsets;st++)!1!==currentonly&&st!==this.internal.currentsetindex||this.createlandmarkmesh(st);const self=this;setTimeout(function(){self.showhidemeshes()},2),this.internal.pickmode||this.updatelandmarkselector()}updategui(nocurrentname=!1){var pset=this.internal.landmarkset[this.internal.currentsetindex];if(this.internal.data.color=pset.color,this.internal.data.size=pset.size,this.internal.data.customshow=this.internal.meshcustomvisible[this.internal.currentsetindex],this.internal.data.description="np:"+pset.getnumpoints()+" : "+pset.filename,this.internal.data.fixeddescription=this.internal.data.description,nocurrentname||(this.internal.data.currentname=this.internal.data.allnames[this.internal.currentsetindex]),null!==this.internal.folders)for(var ib=0;ib<this.internal.folders.length;ib++)for(var ia=0;ia<this.internal.folders[ib].__controllers.length;ia++)this.internal.folders[ib].__controllers[ia].updateDisplay()}isvalidlandmarkselected(){var np=this.internal.landmarkset[this.internal.currentsetindex].getnumpoints(),ind=this.internal.currentpoint;return!(ind<0||ind>=np)}selectlandmark(e,noupd){if(noupd=noupd||!1,null!==this.internal.currentpointselect){var np=this.internal.landmarkset[this.internal.currentsetindex].getnumpoints();this.internal.currentpoint=np>0&&-1===e?np-1:util.range(e,0,np-1),noupd||this.internal.currentpointselect.val(this.internal.currentpoint),this.picklandmark(!1)}}updatelandmarkselector(){if(null!==this.internal.currentpointselect){this.internal.currentpointselect.empty();var pset=this.internal.landmarkset[this.internal.currentsetindex],np=pset.getnumpoints();if(0!==np){for(var i=0;i<np;i++){var b='<option value="'+i+'">'+pset.names[i]+"."+(i+1)+"</option>";this.internal.currentpointselect.append($(b))}this.internal.currentpoint>=0&&this.internal.currentpoint<np&&this.internal.currentpointselect.val(this.internal.currentpoint)}else this.internal.currentpointselect.append($('<option value="-1">None</option>'))}}picklandmark(dopick){if(!1===dopick)return this.setcursor([0,0,0],!1),this.internal.pickmode=!1,this.internal.pickbutton.prop("textContent","Pick"),this.internal.pickbutton.removeClass("btn-info"),void this.internal.pickbutton.addClass("btn-danger");if(!1!==this.isvalidlandmarkselected()){var pset=this.internal.landmarkset[this.internal.currentsetindex],ind=this.internal.currentpoint,mm=pset.points[ind];!0===this.internal.data.enabled&&(this.setcursor(mm,!0),this.internal.pickmode=!0,this.internal.pickbutton.prop("textContent","Release"),this.internal.pickbutton.removeClass("btn-danger"),this.internal.pickbutton.addClass("btn-info")),this.internal.orthoviewer.updatemousecoordinates(mm,-1,0)}}undolast(){return this.picklandmark(!1),this.internal.landmarkset[this.internal.currentsetindex].undo()&&(this.updatedisplay(!0),this.updatelandmarkselector()),!1}redolast(){return this.picklandmark(!1),this.internal.landmarkset[this.internal.currentsetindex].redo()&&(this.updatedisplay(!0),this.updatelandmarkselector()),!1}renamecurrentlandmark(){if(!1===this.isvalidlandmarkselected())return!1;var pset=this.internal.landmarkset[this.internal.currentsetindex],ind=this.internal.currentpoint,name=pset.names[ind];const self=this;return bootbox.prompt({title:"Enter new name for landmark",value:name,callback:function(result){null!==result&&(pset.renamepoint(ind,result),self.updatelandmarkselector())}}),!1}deletecurrentlandmark(){if(!1===this.isvalidlandmarkselected())return!1;var pset=this.internal.landmarkset[this.internal.currentsetindex],ind=this.internal.currentpoint;return pset.deletepoint(ind),this.updatedisplay(!0),this.picklandmark(!1),this.internal.currentpoint=this.internal.landmarkset[this.internal.currentsetindex].getnumpoints()-1,this.updatelandmarkselector(),!1}getInitialSaveFilename(){return this.internal.landmarkset[this.internal.currentsetindex].filename}exportlandmarks(fobj){this.picklandmark(!1);var outstring=this.internal.landmarkset[this.internal.currentsetindex].legacyserialize();let fname=bisgenericio.getFixedSaveFileName(fobj,this.internal.landmarkset[this.internal.currentsetindex].filename),index=fname.lastIndexOf("."),newname=fname.substr(0,index-1)+".land";return bisgenericio.write(newname,outstring),!1}savelandmarks(fobj){this.picklandmark(!1);var a=this.internal.landmarkset[this.internal.currentsetindex].serialize();return fobj=bisgenericio.getFixedSaveFileName(fobj,this.internal.landmarkset[this.internal.currentsetindex].filename),bisgenericio.write(fobj,a),!1}clearallpoints(){const self=this;return this.picklandmark(!1),bootbox.confirm("Are you sure you want to delete all points?",function(result){!0===result&&(self.internal.landmarkset[self.internal.currentsetindex].clear(),self.updatedisplay(!0),self.picklandmark(!1))}),!1}loadlandmarks(filename){const self=this;return bisgenericio.read(filename).then(obj=>{let pset=this.internal.landmarkset[this.internal.currentsetindex];pset.deserialize(obj.data,obj.filename,loaderror)&&(pset.filename=obj.filename,self.updatedisplay(!0),self.updategui(),self.picklandmark(!1),webutil.createAlert("Landmarks loaded from"+pset.filename+" numpoints="+pset.getnumpoints()))}).catch(e=>{loaderror(e)}),!1}setcurrentset(ind){(ind=util.range(ind||0,0,MAXSETS-1))!=this.internal.currentsetindex&&(this.internal.currentsetindex=ind,this.picklandmark(!1),this.showhidemeshes(!0),this.updategui(),this.internal.currentpoint=this.internal.landmarkset[this.internal.currentsetindex].getnumpoints()-1,this.updatelandmarkselector())}showhidemeshes(){for(var st=0;st<this.internal.mesh.length;st++){var doshow=this.internal.meshcustomvisible[st];if("All"===this.internal.data.showmode?doshow=!0:"None"===this.internal.data.showmode?doshow=!1:"Current"===this.internal.data.showmode&&(doshow=st===this.internal.currentsetindex),this.internal.meshvisible[st]=doshow,null!==this.internal.mesh[st])for(var si=0;si<this.internal.mesh[st].length;si++)null!==this.internal.mesh[st][si]&&(this.internal.mesh[st][si].visible=doshow)}!1===this.internal.meshvisible[this.internal.currentsetindex]&&this.enablemouse(!1)}enablemouse(mode){this.internal.data.enabled=mode,!0===this.internal.data.enabled?(this.updatecolors(),this.panel.makeActive(!0),this.internal.landlabelelement.removeClass("label-success"),this.internal.landlabelelement.addClass("label-danger"),inobounce.enable()):(this.panel.makeActive(!1),this.internal.landlabelelement.removeClass("label-danger"),this.internal.landlabelelement.addClass("label-success"),this.picklandmark(!1),inobounce.disable())}onDemandCreateGUI(){if(null===this.internal.parentDomElement)return;this.internal.parentDomElement.empty();var basediv=webutil.creatediv({parent:this.internal.parentDomElement});this.internal.domElement=basediv;var f1=new dat_gui__WEBPACK_IMPORTED_MODULE_0__.default.GUI({autoPlace:!1});basediv.append(f1.domElement);const self=this;f1.add(this.internal.data,"currentname",this.internal.data.allnames).name("CurrentSet").onChange(function(e){var ind=self.internal.data.allnames.indexOf(e);self.setcurrentset(ind)}),f1.add(this.internal.data,"showmode",this.internal.data.allshowmodes).name("Sets to Display").onChange(function(){self.showhidemeshes(),self.updategui(!0)});var en=f1.add(this.internal.data,"enabled").name("Enable Mouse");en.onChange(function(){!1===self.internal.meshvisible[self.internal.currentsetindex]&&(self.internal.data.enabled=!1),self.enablemouse(self.internal.data.enabled)}),webutil.addtooltip($(en.domElement.children[0]),{position:"top",tooltip:"Clicking in the viewer will either add a new landmark or move the current one (in pick mode)"}),this.internal.enableelement=en.domElement.children[0],webutil.removedatclose(f1);var ldiv=$("<H4></H4>").css({margin:"15px"});basediv.append(ldiv),this.internal.landlabelelement=webutil.createlabel({type:"success",name:"Current Landmark Options",parent:ldiv});var sbar=webutil.creatediv({parent:basediv}),inlineform=webutil.creatediv({parent:sbar}),elem1=webutil.creatediv({parent:inlineform,css:{"margin-top":"20px","margin-left":"10px"}}),elem1_label=$("<span>Landmark: </span>");elem1_label.css({padding:"10px"}),elem1.append(elem1_label),this.internal.currentpointselect=webutil.createselect({parent:elem1,values:["none"],tooltip:"Select the current point.",callback:function(e){self.selectlandmark(e.target.value,!0),self.picklandmark(!0)}}),this.internal.pickbutton=webutil.createbutton({type:"danger",name:"Pick",position:"left",tooltip:"Click this to pick the current landmark so that you can reposition it.",css:{"margin-left":"20px"},parent:elem1,callback:function(){var dopick=!0;"Pick"!==self.internal.pickbutton.prop("textContent")&&(dopick=!1),self.picklandmark(dopick)}});var landmarkbar=webutil.createbuttonbar({parent:basediv,css:{"margin-top":"10px"}});webutil.createbutton({type:"warning",name:"Undo",position:"right",tooltip:"Click this to undo the last edit operation.",parent:landmarkbar,callback:function(){self.undolast()}}),webutil.createbutton({type:"info",name:"Redo",position:"bottom",tooltip:"Click this to redo the last edit operation.",parent:landmarkbar,callback:function(){self.redolast()}}),webutil.createbutton({type:"danger",name:"Delete",position:"bottom",tooltip:"Click this to delete the current landmark",parent:landmarkbar,callback:function(){self.deletecurrentlandmark()}}),webutil.createbutton({type:"primary",name:"Rename",position:"left",tooltip:"Click this to rename the current landmark",parent:landmarkbar,callback:function(){self.renamecurrentlandmark()}});var f2=new dat_gui__WEBPACK_IMPORTED_MODULE_0__.default.GUI({autoPlace:!1});f2.add(this.internal.data,"customshow").name("Show in Custom Mode").onChange(function(){self.internal.meshcustomvisible[self.internal.currentsetindex]=self.internal.data.customshow,self.showhidemeshes()}),f2.add(self.internal.data,"size",.5,4).name("Size").step(.5).onChange(function(){self.internal.landmarkset[self.internal.currentsetindex].size=self.internal.data.size,self.updatedisplay()}),f2.addColor(self.internal.data,"color").name("Landmark Color").onChange(function(){self.updatecolors()}),webutil.removedatclose(f2),self.internal.folders=[f1,f2];var bbar0=webutil.createbuttonbar({parent:basediv,css:{"margin-top":"20px","margin-bottom":"10px"}}),bbar1=webutil.createbuttonbar({parent:basediv});webutil.createbutton({type:"danger",name:"Delete All",position:"right",tooltip:"Click this to delete all landmarks in this set",parent:bbar0,callback:function(){self.clearallpoints()}}),webutil.createbutton({type:"primary",name:"Display Properties",position:"bottom",tooltip:"Click this to set advanced display properties for this set (color,size)",parent:bbar0,callback:function(){self.updatelandmarkproperties()}}),webfileutil.createFileButton({type:"warning",name:"Load",position:"bottom",tooltip:"Click this to load points from either a .land or a .ljson file",parent:bbar1,callback:function(f){self.loadlandmarks(f)}},{filename:"",title:"Select file to load current landmark set from",filters:[{name:"Landmark Files",extensions:["ljson","land"]}],save:!1,suffix:".ljson,.land"}),webfileutil.createFileButton({type:"primary",name:"Save",position:"bottom",tooltip:"Click this to save points to a .ljson or .land file",parent:bbar1,callback:function(f){return f=f||"landmarks.ljson",console.log("f=",f),"land"===f.split(".").pop()?self.exportlandmarks(f):self.savelandmarks(f)}},{filename:"",title:"Select file to load current landmark set from",filters:[{name:"Landmark Files",extensions:["ljson","land"]}],save:!0,suffix:".ljson,.land",initialCallback:()=>self.getInitialSaveFilename()}),webutil.tooltip(this.internal.parentDomElement);var modal=webutil.createmodal("Landmark Set Properties","modal-sm");modal.body.append(f2.domElement),this.internal.landmarkpropertiesgui=modal.dialog}setcursor(mm,show=!1){null!==this.internal.cursormesh&&this.internal.cursormesh.forEach(function(e){e.position.set(mm[0],mm[1],mm[2]),e.visible!==show&&(e.visible=show)})}updatepoint(mm){var pset=this.internal.landmarkset[this.internal.currentsetindex],doselect=!1;this.internal.pickmode?pset.movepoint(this.internal.currentpoint,mm):(pset.addpoint(mm),doselect=!0),this.updatedisplay(!0),this.updategui(!0),doselect&&this.selectlandmark(-1)}connectedCallback(){let viewerid=this.getAttribute("bis-viewerid"),layoutid=this.getAttribute("bis-layoutwidgetid");this.internal.orthoviewer=document.querySelector(viewerid),this.internal.orthoviewer.addMouseObserver(this);let layoutcontroller=document.querySelector(layoutid);this.panel=new BisWebPanel(layoutcontroller,{name:"Landmark Editor",permanent:!1,width:"290",dual:!1}),this.internal.parentDomElement=this.panel.getWidget();var basediv=$("<div>This will appear once an image is loaded.</div>");this.internal.parentDomElement.append(basediv)}show(){this.panel.show()}initialize(subviewers,volume,samesize=!1){if(!1===samesize){if(null===this.internal.landmarkset){this.internal.landmarkset=new Array(MAXSETS);for(let i=0;i<MAXSETS;i++){var cl=util.objectmapcolormap[i+1];this.internal.landmarkset[i]=new LandmarkSet(20),this.internal.landmarkset[i].filename="PointSet"+(i+1)+".ljson",this.internal.landmarkset[i].color=util.rgbToHex(cl[0],cl[1],cl[2])}}this.internal.currentsetindex=0,this.internal.intialized=!0,this.cleanupdisplayelements(!0,!0),this.internal.mesh=new Array(MAXSETS),this.internal.meshcustomvisible=new Array(MAXSETS),this.internal.meshvisible=new Array(MAXSETS),this.internal.data.allnames=new Array(MAXSETS);for(let j=0;j<MAXSETS;j++)this.internal.mesh[j]=null,this.internal.meshcustomvisible[j]=!0,this.internal.meshvisible[j]=0===j,this.internal.data.allnames[j]="Point Set "+(j+1);this.internal.data.currentname=this.internal.data.allnames[0],this.internal.subviewers=subviewers,this.internal.volume=volume}this.updatedisplay(),this.updatecolors(),this.onDemandCreateGUI(),this.updategui()}updatemousecoordinates(mm,plane,mousestate){void 0!==mousestate&&null!==this.internal.landmarkset&&!1!==this.internal.data.enabled&&this.panel.isOpen()&&(0===mousestate?this.setcursor(mm,!0):1===mousestate||-1===mousestate?this.setcursor(mm,!0):2===mousestate&&(this.updatepoint(mm),this.setcursor(mm,!1),this.internal.pickmode&&this.picklandmark(!1)),2!==mousestate&&(this.internal.mousestate=mousestate))}})},"./js/webcomponents/bisweb_mainviewerapplication.js":function(module,exports,__webpack_require__){"use strict";const bisweb_apputil=__webpack_require__("./js/coreweb/bisweb_apputilities.js"),BisWebImage=__webpack_require__("./js/dataobjects/bisweb_image.js"),webutil=__webpack_require__("./js/coreweb/bis_webutil.js"),webfileutil=__webpack_require__("./js/coreweb/bis_webfileutil.js"),FastClick=__webpack_require__("./node_modules/fastclick/lib/fastclick.js"),userPreferences=__webpack_require__("./js/core/bisweb_userpreferences.js"),$=__webpack_require__("jquery"),bisdbase=__webpack_require__("./js/coreweb/bisweb_dbase.js"),genericio=__webpack_require__("./js/core/bis_genericio.js"),bootbox=__webpack_require__("./node_modules/bootbox/bootbox.js"),BisWebPanel=__webpack_require__("./js/coreweb/bisweb_panel.js"),resliceImage=__webpack_require__("./js/modules/resliceImage.js"),BisWebLinearTransformation=__webpack_require__("./js/dataobjects/bisweb_lineartransformation.js"),idb=__webpack_require__("./node_modules/idb-keyval/dist/idb-keyval.mjs"),localforage=__webpack_require__("./node_modules/localforage/dist/localforage.js"),clipboard=localforage.createInstance({driver:localforage.INDEXEDDB,name:"BioImageSuiteWebClipboard",version:1,storeName:"biswebclipboard",description:"BioImageSuite Web Clipboard"});class ViewerApplicationElement extends HTMLElement{constructor(){super(),this.extraManualHTML="",this.syncmode=!1,this.simpleFileMenus=!1,this.VIEWERS=[],this.num_independent_viewers=0,this.saveState=null,this.applicationURL=webutil.getWebPageURL(),this.applicationName=webutil.getWebPageName(),console.log("+++++ App name=",this.applicationName,this.applicationURL),clipboard.setItem("appname",this.applicationName).catch(e=>{console.log("No database to store appname"+e)}),this.tab1name=null,this.tab2name=null,"overlayviewer"==this.applicationName?this.extraManualHTML="overlayviewer.html":"editor"===this.applicationName&&(this.extraManualHTML="imageeditor.html"),this.applicationInitializedPromiseList=[];let p=userPreferences.initialize(bisdbase);p.catch(e=>{console.log("No dbase available",e)}),this.applicationInitializedPromiseList.push(p)}getViewer(index){return index<0||index>=this.VIEWERS.length?this.VIEWERS[0]:this.VIEWERS[index]}getApplicationStateFilenameExtension(storeimages=!0){return storeimages?"biswebstate":"state"}getApplicationStateFilename(storeimages=!1){return this.applicationName+"."+this.getApplicationStateFilenameExtension(storeimages)}getVisibleTab(){if(this.tab1name&&this.tab2name){let tab2link=this.getAttribute("bis-tab2");if($(tab2link).attr("class").indexOf("active")>=0)return 2}return 1}setVisibleTab(n){this.tab1name&&this.tab2name&&(1===n?$(this.tab1name).tab("show"):$(this.tab2name).tab("show"))}findViewers(){const viewerid=this.getAttribute("bis-viewerid"),viewerid2=this.getAttribute("bis-viewerid2")||null;this.VIEWERS=[document.querySelector(viewerid)],this.VIEWERS[0].setName("viewer1"),null!==viewerid2&&(this.VIEWERS.push(document.querySelector(viewerid2)),this.VIEWERS[1].setName("viewer2")),this.num_independent_viewers=this.VIEWERS.length,this.syncmode&&(this.num_independent_viewers=1,webutil.setAlertTop(130))}getElementState(storeImages=!1){let obj={};for(let i=0;i<this.VIEWERS.length;i++){let name=`viewer${i+1}`,getimg=storeImages;i>=this.num_independent_viewers&&(getimg=!1),obj[name]=this.VIEWERS[i].getElementState(getimg)}obj.sidetools={};const atlastoolid=this.getAttribute("bis-atlastoolid")||null,blobanalyzerid=this.getAttribute("bis-blobanalyzerid")||null;if(atlastoolid){document.querySelector(atlastoolid).isOpen()&&(obj.sidetools.atlascontrol=!0)}if(blobanalyzerid){document.querySelector(blobanalyzerid).isOpen()&&(obj.sidetools.clustertool=!0)}return obj}setElementState(dt=null,name=""){if(null===dt)return;let numviewers=this.VIEWERS.length;"overlayviewer"===name&&"overlayviewer"!==this.applicationName&&(numviewers=1);for(let i=0;i<numviewers;i++){let elem=dt[`viewer${i+1}`]||null;this.VIEWERS[i].setElementState(elem)}this.num_independent_viewers>1&&this.VIEWERS[1].setDualViewerMode(this.VIEWERS[1].internal.viewerleft);let sidetools=dt.sidetools||{};const atlastoolid=this.getAttribute("bis-atlastoolid")||null,blobanalyzerid=this.getAttribute("bis-blobanalyzerid")||null;if(sidetools.atlascontrol&&atlastoolid){let atlascontrol=document.querySelector(atlastoolid);setTimeout(()=>{atlascontrol.show()},100)}if(sidetools.clustertool&&blobanalyzerid){let blobcontrol=document.querySelector(blobanalyzerid);setTimeout(()=>{blobcontrol.show()},500)}}storeState(saveImages=!1){this.saveState=this.getElementState(saveImages)}restoreState(obj=null,name=null){let inp=obj||this.saveState;if(name=name||this.applicationName,inp)return this.setElementState(inp,name)}copyViewer(index=0){let st=this.VIEWERS[index].getElementState(!0);clipboard.setItem("viewer",st).then(()=>{console.log("copied viewer",index,"to clipboard")}).catch(e=>{console.log(e)})}pasteViewer(index=0){clipboard.getItem("viewer").then(st=>{this.VIEWERS[index].setElementState(st)}).catch(e=>{console.log("paste error",e,e.stack)})}resliceOverlay(modulemanager,index=0){let img=this.VIEWERS[index].getimage(),ov=this.VIEWERS[index].getobjectmap(),dim=img.getDimensions(),spa=img.getSpacing(),dim2=ov.getDimensions(),spa2=ov.getSpacing(),linear=new BisWebLinearTransformation(0);linear.setShifts(dim,spa,dim2,spa2),linear.setParameterVector([0,0,0,0,0,0],{scale:!0,rigidOnly:!0});let mod=new resliceImage;mod.execute({input:ov,reference:img,xform:linear},{addgrid:!1,interpolation:3}).then(()=>{let temp=mod.getOutputObject("output");this.VIEWERS[index].setobjectmap(temp,!1)})}loadImage(fname,viewer=0){const self=this,img=new BisWebImage;return new Promise((resolve,reject)=>{webutil.createAlert("Loading image from "+genericio.getFixedLoadFileName(fname),"progress",30,0,{makeLoadSpinner:!0}),setTimeout(()=>{img.load(fname).then(function(){webutil.createAlert("Image loaded from "+img.getDescription()),self.VIEWERS[viewer].setimage(img),resolve()}).catch(e=>{reject(e)})},10)})}loadOverlay(fname,viewer=0){const self=this;return new Promise((resolve,reject)=>{let img=new BisWebImage;webutil.createAlert("Loading image from "+genericio.getFixedLoadFileName(fname),"progress",30,0,{makeLoadSpinner:!0}),setTimeout(()=>{img.load(fname).then(function(){webutil.createAlert("Objectmap loaded from "+img.getDescription()),self.VIEWERS[viewer].setobjectmap(img,!1),resolve()}).catch(e=>{webutil.createAlert(e,!0),console.log(e.stack),reject(e)})},10)})}saveImage(fname=null,viewerno=0){let name="Image";this.num_independent_viewers>1&&(name=`${name} ${viewerno+1}`);let img=this.VIEWERS[viewerno].getimage();bisweb_apputil.saveImage(img,fname,name)}getSaveImageInitialFilename(viewerno=0){let img=this.VIEWERS[viewerno].getimage();return img?img.getFilename():"none.nii.gz"}saveOverlay(fname=null,viewerno=0){let name="Overlay";this.num_independent_viewers>1&&(name=`${name} ${viewerno+1}`);let img=this.VIEWERS[viewerno].getobjectmap();bisweb_apputil.saveImage(img,fname,name)}getSaveOverlayInitialFilename(viewerno=0){let img=this.VIEWERS[viewerno].getobjectmap();return img?img.getFilename():"none.nii.gz"}createAdvancedTransferTool(modulemanager,editmenu){const self=this;let name="Advanced Transfer Tool";modulemanager||(name="App State Manager");let dual=!1;this.num_independent_viewers>1&&(dual=!0);let newdlg=new BisWebPanel(this.VIEWERS[0].getLayoutController(),{name:name,width:300,dual:dual});var bbar=webutil.createbuttonbar({parent:newdlg.getWidget(),css:{"margin-top":"10px","margin-left":"4px"}}),bbar1=webutil.createbuttonbar({parent:bbar,css:{"margin-bottom":"20px",width:"100%"}});if(webutil.createbutton({type:"default",name:"Store State",parent:bbar1,css:{width:"120px"},callback:function(){self.storeState()}}),webutil.createbutton({type:"default",name:"Retrieve State",parent:bbar1,css:{left:"140px",width:"120px",position:"absolute"},callback:function(){self.restoreState()}}),modulemanager){if(this.num_independent_viewers>1){var bbar0=webutil.createbuttonbar({parent:bbar,css:{"margin-bottom":"10px",width:"100%"}});webutil.createbutton({type:"success",name:"V1 &rarr; V2",parent:bbar0,css:{width:"80px"},callback:function(){modulemanager.transferImages(0,1)}}),webutil.createbutton({type:"success",name:"V2 &rarr; V1",parent:bbar0,css:{position:"absolute",width:"80px",left:"90px"},callback:function(){modulemanager.transferImages(1,0)}}),webutil.createbutton({type:"success",name:"V1 &harr; V2",parent:bbar0,css:{position:"absolute",width:"80px",left:"180px"},callback:function(){modulemanager.swapImages()}});var bbar2=webutil.createbuttonbar({parent:bbar,css:{"margin-bottom":"10px",width:"100%"}});webutil.createbutton({type:"info",name:"V2 Im &rarr; V1 Ov",parent:bbar2,css:{width:"120px"},callback:function(){modulemanager.transferImageToOverlay(1,0)}}),webutil.createbutton({type:"info",name:"V1 Im &rarr; V2 Ov",parent:bbar2,css:{width:"120px",left:"140px",position:"absolute"},callback:function(){modulemanager.transferImageToOverlay(0,1)}});var bbar3=webutil.createbuttonbar({parent:bbar,css:{"margin-bottom":"10px",width:"100%"}});webutil.createbutton({type:"info",name:"V2 Ov &rarr; V1 Im",parent:bbar3,css:{width:"120px"},callback:function(){modulemanager.transferOverlayToImage(1,0)}}),webutil.createbutton({type:"info",name:"V1 Ov &rarr; V2 Im",parent:bbar3,css:{width:"120px",left:"140px",position:"absolute"},callback:function(){modulemanager.transferOverlayToImage(0,1)}})}else webutil.createbutton({type:"info",name:"Copy Image &rarr; Overlay",parent:bbar,css:{width:"260px","margin-bottom":"10px"},callback:function(){modulemanager.transferImageToOverlay(0,0)}}),webutil.createbutton({type:"info",name:"Copy Overlay &rarr; Image",parent:bbar,css:{width:"260px","margin-bottom":"10px"},callback:function(){modulemanager.transferOverlayToImage(0,0)}});let bottom=webutil.createbuttonbar({parent:bbar,css:{"margin-top":"20px",width:"100%"}});webutil.createbutton({type:"danger",name:"Undo Image",parent:bottom,css:{width:"120px"},callback:function(){modulemanager.getAlgorithmController().undoImage(!0)}}),webutil.createbutton({type:"warning",name:"Redo Image",parent:bottom,css:{width:"120px",left:"140px",position:"absolute"},callback:function(){modulemanager.getAlgorithmController().undoImage(!1)}})}webutil.createMenuItem(editmenu,""),webutil.createMenuItem(editmenu,name,function(){newdlg.show()})}createFileAndOverlayMenus(menubar,painttoolid){const self=this;let paintviewerno=self.VIEWERS.length-1,fmenu=[0,0],objmenu=[0,0],fmenuname="File",objmenuname="Overlay",load_image=function(f,v){return self.loadImage(f,v)},load_objectmap=function(f,v){return self.loadOverlay(f,v)},internal_create_menu=function(viewerno){if(1===viewerno&&(fmenuname="Image2",objmenuname="Overlay2"),null!==painttoolid&&viewerno===paintviewerno&&(objmenuname="Objectmap",1===viewerno&&(objmenuname="Objectmap2")),fmenu[viewerno]=webutil.createTopMenuBarMenu(fmenuname,menubar),self.simpleFileMenus||(webfileutil.createFileMenuItem(fmenu[viewerno],"Load Image",function(f){self.loadImage(f,viewerno)},{title:"Load image",save:!1,suffix:"NII"}),webfileutil.createFileMenuItem(fmenu[viewerno],"Save Image",function(f){self.saveImage(f,viewerno)},{title:"Save Image",save:!0,filters:"NII",suffix:"NII",initialCallback:()=>self.getSaveImageInitialFilename(viewerno)}),webutil.createMenuItem(fmenu[viewerno],""),bisweb_apputil.createMNIImageLoadMenuEntries(fmenu[viewerno],load_image,viewerno)),!self.simpleFileMenus){objmenu[viewerno]=webutil.createTopMenuBarMenu(objmenuname,menubar);let painttool=null;if(null!==painttoolid&&viewerno===paintviewerno){(painttool=document.querySelector(painttoolid)).createMenu(objmenu[viewerno]);const graphtool=document.createElement("bisweb-graphelement");webutil.createMenuItem(objmenu[viewerno],"VOI Analysis",function(){graphtool.parsePaintedAreaAverageTimeSeries(self.VIEWERS[paintviewerno])})}else webfileutil.createFileMenuItem(objmenu[viewerno],"Load Overlay",function(f){self.loadOverlay(f,viewerno)},{title:"Load overlay",save:!1,suffix:"NII"}),webfileutil.createFileMenuItem(objmenu[viewerno],"Save Overlay",function(f){self.saveOverlay(f,viewerno)},{title:"Save Overlay",save:!0,filters:"NII",suffix:"NII",initialCallback:()=>self.getSaveOverlayInitialFilename(viewerno)}),webutil.createMenuItem(objmenu[viewerno],""),webutil.createMenuItem(objmenu[viewerno],"Clear Overlay",function(){self.VIEWERS[viewerno].clearobjectmap()}),"overlayviewer"==self.applicationName&&(webutil.createMenuItem(objmenu[viewerno],""),webutil.createMenuItem(objmenu[viewerno],"Reslice Overlay To Match Image",function(){self.resliceOverlay(viewerno)}));webutil.createMenuItem(objmenu[viewerno],""),bisweb_apputil.createBroadmannAtlasLoadMenuEntries(objmenu[viewerno],load_objectmap,viewerno)}};for(let viewerno=0;viewerno<this.num_independent_viewers;viewerno++)internal_create_menu(viewerno);return fmenu[0]}parseElectronArguments(){const self=this;let load=function(fname,v,a){return genericio.getFixedLoadFileName(fname).split(".").pop()===this.getApplicationStateFilenameExtension(!0)?(self.loadApplicationState(fname),1):(self.loadImage(fname,v,a),0)};if(webutil.inElectronApp()){let title=$(document).find("title").text();setTimeout(function(){window.BISELECTRON.ipc.send("arguments",title)},120),window.BISELECTRON.ipc.on("arguments-reply",function(evt,args){window.BISELECTRON.ipc.send("ping","Arguments received: "+args);let a=-1;args.length>0&&(a=load(args[0],0,!1)),args.length>1&&this.num_independent_viewers>1&&0===a&&load(args[1],1,!1)})}}addOrientationSelectToMenu(hmenu){webutil.createMenuItem(hmenu,"Set Image Orientation On Load",function(){userPreferences.safeGetImageOrientationOnLoad().then(orient=>{webutil.createRadioSelectModalPromise('<H4>Select default orientation "on load"</H4><p>If RAS or LPS is elected then the images will be reoriented to Axial RAS or LPS on load.</p><HR>',"Close",orient,[{value:"RAS",text:"Axial RAS (SPM)"},{value:"LPS",text:"Axial LPS (DICOM, BioImage Suite legacy)"},{value:"None",text:"Leave as is"}]).then(m=>{userPreferences.setImageOrientationOnLoad(m),userPreferences.storeUserPreferences()}).catch(e=>{console.log("Error ",e)})})})}createHelpMenu(menubar,extrahtml=null){null===extrahtml&&(extrahtml=this.extraManualHTML);let hmenu=webutil.createTopMenuBarMenu("Help",menubar);webutil.createMenuItem(hmenu,"About this application",()=>{this.welcomeMessage(!0)});let link=`a href="https://bioimagesuiteweb.github.io/bisweb-manual/${extrahtml}" target="_blank" rel="noopener"`;return hmenu.append($(`<li><${link}>BioImage Suite Web Online Manual</a></li>`)),webutil.createMenuItem(hmenu,""),this.addOrientationSelectToMenu(hmenu),webutil.inElectronApp()&&(webutil.createMenuItem(hmenu,""),webutil.createMenuItem(hmenu,"Show JavaScript Console",function(){window.BISELECTRON.remote.getCurrentWindow().toggleDevTools()}),userPreferences.safeGetItem("electonzoom").then(v=>{let z=v||1;(z<.8||z>1.25)&&(z=1),window.BISELECTRON.electron.webFrame.setZoomFactor(z)})),webfileutil.createFileSourceSelector(hmenu),webutil.inElectronApp()||userPreferences.safeGetItem("internal").then(f=>{f&&webutil.createMenuItem(hmenu,"Open AWS Selector",()=>{webfileutil.createAWSMenu()})}).catch(()=>{}),hmenu}createExtraMenu(){}attachDragAndDrop(){const self=this;webutil.createDragAndCropController(function(files,e){let count=0;self.num_independent_viewers>1&&(count=self.VIEWERS[0].getInsideViewer(e.offsetX)?0:1),files[0].name.split(".").pop()===self.getApplicationStateFilenameExtension(!0)?self.loadApplicationState(files[0]):self.loadImage(files[0],count,!1).then(()=>{files.length>1&&self.loadOverlay(files[1],count,!1)})})}createDisplayMenu(menubar,editmenu){const self=this;let gmenu=null,extra="Show ";editmenu?(gmenu=editmenu,webutil.createMenuItem(gmenu,"")):(gmenu=webutil.createTopMenuBarMenu("Display",menubar),extra=""),webutil.inElectronApp()&&(webutil.createMenuItem(gmenu,"Zoom 80%",function(){window.BISELECTRON.electron.webFrame.setZoomFactor(.8),userPreferences.setItem("electronzoom",.8,!0)}),webutil.createMenuItem(gmenu,"Zoom 100%",function(){window.BISELECTRON.electron.webFrame.setZoomFactor(1),userPreferences.setItem("electronzoom",1,!0)}),webutil.createMenuItem(gmenu,"Zoom 125%",function(){window.BISELECTRON.electron.webFrame.setZoomFactor(1.25),userPreferences.setItem("electronzoom",1.2,!0)}),webutil.createMenuItem(gmenu,"")),this.num_independent_viewers>1?(webutil.createMenuItem(gmenu,extra+"Both Viewers",function(){self.VIEWERS[1].setDualViewerMode(.5)}),webutil.createMenuItem(gmenu,extra+"Viewer 1 Only",function(){self.VIEWERS[1].setDualViewerMode(1)}),webutil.createMenuItem(gmenu,extra+"Viewer 2 Only",function(){self.VIEWERS[1].setDualViewerMode(0)}),webutil.createMenuItem(gmenu,""),self.VIEWERS[0].setViewerMode("left",.5),self.VIEWERS[1].setViewerMode("right",.5),webutil.createMenuItem(gmenu,"Viewer 1 Info",function(){self.VIEWERS[0].viewerInformation()}),webutil.createMenuItem(gmenu,"Viewer 2 Info",function(){self.VIEWERS[1].viewerInformation()})):webutil.createMenuItem(gmenu,"Viewer Info",function(){self.VIEWERS[0].viewerInformation()})}loadApplicationState(fobj){const self=this;return new Promise((resolve,reject)=>{genericio.read(fobj,!1).then(contents=>{let obj=null;try{obj=JSON.parse(contents.data)}catch(e){return webutil.createAlert("Bad application state file "+contents.filename+" probably not a application state file ",!0),void reject(e)}return obj.app?obj.app!==this.applicationName?(clipboard.setItem("lastappstate",obj).then(()=>{webutil.createAlert(`<p>This state file was not created using this application(<EM>${this.applicationName}</EM>).</p><p> Click <a href="./${obj.app}.html?restorestate=${contents.filename}">here to close this application and open <B>${obj.app}</B></a> instead.`,!0)}).catch(e=>{console.log(e)}),void resolve("Done")):(self.restoreState(obj.params,obj.app),webutil.createAlert("Application state loaded from "+contents.filename),void resolve("Done")):(webutil.createAlert("Bad application state file "+contents.filename+" probably not a application state file ",!0),void reject("error"))}).catch(e=>{console.log(e.stack,e),webutil.createAlert(`${e}`,!0),reject(e)})})}saveApplicationState(fobj,storeimages=!0){this.storeState(storeimages);let output=JSON.stringify({app:this.applicationName,params:this.saveState},null,4);return fobj=genericio.getFixedSaveFileName(fobj,this.getApplicationStateFilename(storeimages)),new Promise(function(resolve,reject){genericio.write(fobj,output).then(f=>{genericio.isSaveDownload()||webutil.createAlert("Application State saved "+f)}).catch(e=>{webutil.createAlert("Failed to save Application State "+e),reject(e)})})}createEditMenu(menubar){const self=this;let editmenu=webutil.createTopMenuBarMenu("Edit",menubar);return this.num_independent_viewers>1?(webutil.createMenuItem(editmenu,"Copy Viewer 1",function(){self.copyViewer(0)}),webutil.createMenuItem(editmenu,"Paste Viewer 1",function(){self.pasteViewer(0)}),webutil.createMenuItem(editmenu,""),webutil.createMenuItem(editmenu,"Copy Viewer 2",function(){self.copyViewer(1)}),webutil.createMenuItem(editmenu,"Paste Viewer 2",function(){self.pasteViewer(1)})):(webutil.createMenuItem(editmenu,"Copy Viewer",function(){self.copyViewer(0)}),webutil.createMenuItem(editmenu,"Paste Viewer",function(){self.pasteViewer(0)})),editmenu}createApplicationMenu(bmenu){const self=this;return self.simpleFileMenus||webutil.createMenuItem(bmenu,""),webfileutil.createFileMenuItem(bmenu,"Load Application State",function(f){self.loadApplicationState(f)},{title:"Load Application State",save:!1,suffix:self.getApplicationStateFilenameExtension(!0),filters:[{name:"Application State File",extensions:[self.getApplicationStateFilenameExtension(!0)]}]}),webfileutil.createFileMenuItem(bmenu,"Save Application State",function(f){self.saveApplicationState(f,!0)},{title:"Save Application State",save:!0,filters:[{name:"Application State File",extensions:[self.getApplicationStateFilenameExtension(!0)]}],suffix:self.getApplicationStateFilenameExtension(!0),initialCallback:()=>self.getApplicationStateFilename(!0)}),this.savelightstate&&webfileutil.createFileMenuItem(bmenu,"Save Light Application State",function(f){self.saveApplicationState(f,!1)},{title:"Save Application State",save:!0,filters:[{name:"Application State File",extensions:[self.getApplicationStateFilenameExtension(!1)]}],suffix:self.getApplicationStateFilenameExtension(!1),initialCallback:()=>self.getApplicationStateFilename(!1)}),webutil.createMenuItem(bmenu,""),webutil.createMenuItem(bmenu,"Restart Application",function(){bootbox.confirm("Are you sure? You will lose all unsaved data.",function(e){e&&window.open(self.applicationURL,"_self")})}),bmenu}parseQueryParameters(painttoolid){let load=webutil.getQueryParameter("load")||"",imagename=webutil.getQueryParameter("image")||"",imagename2=webutil.getQueryParameter("image2")||"",overlayname=webutil.getQueryParameter("overlay")||"",overlayname2=webutil.getQueryParameter("overlay2")||"";load.length>0?this.loadApplicationState(load):imagename.length>0&&(this.loadImage(imagename,0).then(()=>{if(overlayname.length>0)if(null===painttoolid)this.loadOverlay(overlayname,0);else{document.querySelector(painttoolid).loadobjectmap(overlayname)}}),imagename2.length>0&&this.num_independent_viewers>1&&this.loadImage(imagename2,1).then(()=>{overlayname2.length>0&&this.loadOverlay(overlayname2,1)}));let restore=webutil.getQueryParameter("restorestate");restore&&clipboard.getItem("lastappstate").then(st=>{try{st.app?setTimeout(()=>{this.restoreState(st.params,st.app),clipboard.setItem("lastappstate",""),webutil.createAlert("Loaded application state from "+restore)},100):webutil.createAlert("Failed to load application state from "+restore,!0)}catch(e){console.log("Bad Last app state",e)}}).catch(e=>{webutil.createAlert("Failed to load application state "+e,!0)})}welcomeMessage(force=!1){let show=force,p=[userPreferences.safeGetImageOrientationOnLoad(),userPreferences.safeGetItem("showwelcome"),webutil.aboutText()];webutil.inElectronApp()||p.push(idb.get("mode")),Promise.all(p).then(lst=>{let forceorient=lst[0],firsttime=lst[1],msg=lst[2];lst[3]=lst[3]||"";let offline=!1;if(lst[3].indexOf("offline")>=0&&(offline=!0),void 0===firsttime&&(firsttime=!0),force||"None"===forceorient&&!0!==firsttime||(show=!0),!show)return;let dlg=webutil.createmodal("Welcome to BioImage Suite Web"),body=dlg.body,txt=msg;if(offline&&(txt+="<HR><p>This application is operating in Offline Mode.</p><HR>"),webutil.inElectronApp()||!0!==firsttime||(txt+='<HR><H3>Some things you should\n                know ...</H3><H4>File Save</H4> <p>Because this application is\n                running inside a web browser, saving a file is performed by\n                mimicking downloading a file. You should change the options\n                inside your browser to allow you to specify the location of\n                any file saved.</p> <p><EM>Chrome</EM>: See the section titled\n                <B>Change download locations on the <a target="_blank"\n                rel="noopener"\n                href="https://support.google.com/chrome/answer/95759?co=GENIE.Platform%3DDesktop&hl=en&oco=1">following\n                link</a> for instructions as to how to change the default\n                download location. In particular you should <B> check the box\n                next to "Ask where to save each file before\n                downloading."</B></p> <p>For other browsers simply search for\n                the words "Browsername select download location" on\n                Google.</p>'),"None"!==forceorient&&(txt+=`<HR><H3>Forcing Image Orientation</H3><p>On load all images are currently <B> automatically reoriented to ${forceorient}</B> based on your user preferences. Select Help|Set Image Orientation On Load to change this.</p>`),dlg.header.empty(),dlg.header.append("<H3>Welcome to BioImage Suite Web</H3>"),body.append($(txt)),!force&&"None"===forceorient){let confirmButton=webutil.createbutton({name:"Do not show this next time",type:"success"});confirmButton.on("click",e=>{e.preventDefault(),dlg.dialog.modal("hide"),userPreferences.setItem("showwelcome",!1,!0)}),dlg.footer.append(confirmButton)}dlg.dialog.modal("show")}).catch(e=>{console.log(e.stack,e)})}fixMobileMouseHandling(){new FastClick(document.body),window.addEventListener("touchstart",event=>{event.touches.length>1&&event.preventDefault()},{passive:!1})}connectedCallback(){const self=this,menubarid=this.getAttribute("bis-menubarid"),painttoolid=this.getAttribute("bis-painttoolid")||null,landmarkcontrolid=this.getAttribute("bis-landmarkcontrolid")||null,atlastoolid=this.getAttribute("bis-atlastoolid")||null,blobanalyzerid=this.getAttribute("bis-blobanalyzerid")||null,managerid=this.getAttribute("bis-modulemanagerid")||null;this.savelightstate=this.getAttribute("bis-extrastatesave")||null,this.findViewers();let menubar=document.querySelector(menubarid).getMenuBar(),modulemanager=null;null!==managerid&&(modulemanager=document.querySelector(managerid)||null);let fmenu=this.createFileAndOverlayMenus(menubar,painttoolid);this.createApplicationMenu(fmenu);let editmenu=null;if(this.simpleFileMenus)editmenu=webutil.createTopMenuBarMenu("Edit",menubar),webutil.createMenuItem(editmenu,"Viewer Info",function(){self.VIEWERS[0].viewerInformation()});else if(editmenu=this.createEditMenu(menubar),this.createAdvancedTransferTool(modulemanager,editmenu),this.num_independent_viewers>1&&this.createDisplayMenu(menubar,null),modulemanager&&modulemanager.initializeElements(menubar,self.VIEWERS),this.num_independent_viewers<2&&this.createDisplayMenu(menubar,editmenu),null!==painttoolid||null!==landmarkcontrolid){let toolmenu=webutil.createTopMenuBarMenu("Tools",menubar),p=Promise.resolve();if(painttoolid){p=document.querySelector(painttoolid).addTools(toolmenu)}if(landmarkcontrolid){let landmarkcontrol=document.querySelector(landmarkcontrolid);p.then(()=>{painttoolid&&webutil.createMenuItem(toolmenu,""),webutil.createMenuItem(toolmenu,"Landmark Editor",function(){landmarkcontrol.show()})})}}if(atlastoolid||blobanalyzerid){if(webutil.createMenuItem(editmenu,""),atlastoolid){let atlascontrol=document.querySelector(atlastoolid);webutil.createMenuItem(editmenu,"Atlas Tool",()=>{atlascontrol.show(),this.setVisibleTab(1)})}if(blobanalyzerid){let blobcontrol=document.querySelector(blobanalyzerid);webutil.createMenuItem(editmenu,"Cluster Info Tool",()=>{blobcontrol.show(),this.setVisibleTab(1)})}}webutil.inElectronApp()&&this.parseElectronArguments(),this.createExtraMenu(menubar),this.attachDragAndDrop();let hmenu=this.createHelpMenu(menubar);"overlayviewer"===this.applicationName&&(webutil.createMenuItem(hmenu,""),webutil.createMenuItem(hmenu,"Load Sample Data",function(){let f=`${webutil.getWebPageImagePath()}/viewer.biswebstate`;self.loadApplicationState(f)})),this.fixMobileMouseHandling(),this.num_independent_viewers>1&&self.VIEWERS[1].setDualViewerMode(.5);let mainViewerDoneEvent=new CustomEvent("mainViewerDone");document.dispatchEvent(mainViewerDoneEvent);let istest=this.getAttribute("bis-testingmode")||!1;webutil.runAfterAllLoaded(()=>{Promise.all(this.applicationInitializedPromiseList).then(()=>{webfileutil.initializeFromUserPrefs(),this.parseQueryParameters(painttoolid),document.body.style.zoom=1,istest?webutil.createAlert("In Test Mode",!1):this.welcomeMessage(!1)}).catch(e=>{console.log("Error ",e)})})}}module.exports=ViewerApplicationElement,webutil.defineElement("bisweb-viewerapplication",ViewerApplicationElement)},"./js/webcomponents/bisweb_misactool.js":function(module,exports,__webpack_require__){"use strict";const $=__webpack_require__("jquery"),webutil=__webpack_require__("./js/coreweb/bis_webutil.js"),bisgenericio=__webpack_require__("./js/core/bis_genericio.js"),BisWebPanel=__webpack_require__("./js/coreweb/bisweb_panel.js"),BisWebDataObjectCollection=__webpack_require__("./js/dataobjects/bisweb_dataobjectcollection.js"),BisWebLinearTransformation=__webpack_require__("./js/dataobjects/bisweb_lineartransformation.js"),numeric=__webpack_require__("./node_modules/numeric/numeric-1.2.6.js"),resliceImage=__webpack_require__("./js/modules/resliceImage.js"),webfileutil=__webpack_require__("./js/coreweb/bis_webfileutil.js");webutil.defineElement("bisweb-misactool",class extends HTMLElement{constructor(){super(),this.setup={images:{Reference:{obj:null,filename:""},Anatomical:{obj:null,filename:""},Conventional:{obj:null,filename:""},AngioAnat:{obj:null,filename:""},Angio:{obj:null,filename:""},AngioMask:{obj:null,filename:""},ProjAngio:{obj:null,filename:""},MeanfMRI:{obj:null,filename:""},fMRIParcellation:{obj:null,filename:""},RotOptical:{obj:null,filename:""},Optical:{obj:null,filename:""},OpticalParcellation:{obj:null,filename:""},StimROI:{obj:null,filename:""}},transforms:{Ref2Anat:{obj:null,filename:"",reference:"Reference",target:"Anatomical"},Anat2Conv:{obj:null,filename:"",reference:"Anatomical",target:"Conventional"},Conv2fMRI:{obj:null,filename:"",reference:"Conventional",target:"MeanfMRI"},Anat2Angio:{obj:null,filename:"",reference:"Anatomical",target:"AngioAnat"},Angio2RotOptical:{obj:null,filename:"",reference:"ProjAngio",target:"RotOptical"},RotOptical2Optical:{obj:null,filename:"",reference:"RotOptical",target:"Optical"},Angio2fMRI:{obj:null,filename:"",reference:"Angio",target:"MeanfMRI"},"3D2fMRI":{obj:null,filename:"",reference:"Anatomical",target:"MeanfMRI"},Angio2Optical:{obj:null,filename:"",reference:"ProjAngio",target:"Optical"}}},this.infoElement={},this.data={},this.internal={},this.viewers=[null,null],this.algoController=null,this.filters={image:"NII",transform:[{name:"Transformation Files",extensions:["bisxform","matr","grd"]},{name:"All Files",extensions:["*"]}]},this.extensions={transform:["bisxform","matr","grd"],images:["nii.gz","tiff","tif"]},this.panel=null}show(){this.panel&&this.panel.show()}clearItem(key1,key2){this.setup[key1][key2]={obj:null,filename:""},this.infoElement[key2].empty(),this.infoElement[key2].append("Empty")}loadItem(f,key1,key2,objtype){const self=this;return new Promise((resolve,reject)=>{BisWebDataObjectCollection.loadObject(f,objtype).then(obj=>{obj?(self.setup[key1][key2].obj=obj,self.setup[key1][key2].filename=obj.getFilename(),self.infoElement[key2].empty(),self.infoElement[key2].append(obj.getDescription(!0)),resolve()):reject("Failed to load "+objtype+" from "+f+" ",!0)}).catch(e=>{console.log(e.stack),reject(e)})})}saveItem(f,key1,key2){const self=this;let obj=self.setup[key1][key2].obj;if(obj)return obj.save(f).then(()=>{obj.setFilename(f),self.setup[key1][key2].filename=f,self.infoElement[key2].empty(),self.infoElement[key2].append(obj.getDescription(!0))}).catch(e=>{console.log(e.stack),webutil.createAlert(e,!0)}),!1}showImage(key1,key2,viewer,overlay=!1){let obj=this.setup[key1][key2].obj;obj&&(overlay?this.viewers[viewer].setobjectmap(obj):this.viewers[viewer].setimage(obj))}setItem(obj,key1,key2){const self=this;obj&&(self.setup[key1][key2].obj=obj,self.infoElement[key2].empty(),self.infoElement[key2].append(obj.getDescription(!0)),webfileutil.electronFileCallback({filename:obj.getFilename(),title:"Select filename to save this to",filters:self.filters[obj.getObjectType],save:!0},function(f){self.saveItem(f,key1,key2)}))}grabImage(key1,key2,viewer){let img=this.viewers[viewer].getimage();img&&this.setItem(img,key1,key2)}testTransform(key){const self=this;return new Promise((resolve,reject)=>{let item=self.setup.transforms[key],xform=item.obj;if(null===xform)webutil.createAlert("No transformation to test",!0),reject("No transform in memory");else{let ref=self.setup.images[item.reference].obj,targ=self.setup.images[item.target].obj;self.showImage("images",item.reference,"viewer1"),console.log("Reslicing ",targ.getFilename()," to match",ref.getFilename()," using",xform.getFilename());let resl=new resliceImage;resl.execute({input:targ,reference:ref,xform:xform},{interpolation:1}).then(()=>{self.viewers.viewer2.setimage(resl.getOutputObject("output")),resl.cleanupMemory(),resolve()}).catch(e=>{console.log(e.stack),reject(e)})}})}saveSetup(f){let out={images:{},transforms:{}},names=["images","transforms"];for(let i=0;i<names.length;i++){let keys=Object.keys(this.setup[names[i]]);for(let j=0;j<keys.length;j++){let first=names[i],second=keys[j];out[first][second]=this.setup[first][second].filename}}let obj={bisformat:"MISAC",setup:out},txt=JSON.stringify(obj,null,2);bisgenericio.write(f,txt).then(()=>{console.log("Saved job in",f,"\n",txt)})}loadSetup(f){const self=this;return new Promise((resolve,reject)=>{bisgenericio.readJSON(f,"MISAC").then(obj=>{obj=obj.data.setup;let out={images:{},transforms:{}},p=[],names=["images","transforms"];for(let i=0;i<names.length;i++){let keys=Object.keys(self.setup[names[i]]);for(let j=0;j<keys.length;j++){let first=names[i],second=keys[j],fname=obj[first][second]||null;fname?(out[first][second]={obj:null,filename:fname},fname.length>2&&(console.log("Fname=",fname,first,second),"images"===first?p.push(self.loadItem(fname,first,second,"image")):p.push(self.loadItem(fname,first,second,"transform")))):self.clearItem(first,second)}}Promise.all(p).then(()=>{webutil.createAlert("Read setup from "+f+" (including images) "),resolve()}).catch(e=>{console.log(e.stack),webutil.createAlert("Failed to load setup from "+f+" "+e,!0)})}).catch(e=>{console.log(e.stack),webutil.createAlert("Failed to load setup from "+f+" "+e,!0),reject(e)})})}createAngio2FMRI(){let xform1=this.setup.transforms.Anat2Conv.obj,xform2=this.setup.transforms.Conv2fMRI.obj,xform3=this.setup.transforms.Anat2Angio.obj;if(!xform1||!xform2||!xform3)return void webutil.createAlert("The three transformations Anat2Conv, Conv2fMRI and Anat2Angio must exist",!0);let m1=xform1.getMatrix(),m2=xform2.getMatrix(),m3=numeric.inv(xform3.getMatrix()),m12=numeric.dot(m1,m2),all=numeric.dot(m3,m12),xform=new BisWebLinearTransformation(0);xform.setMatrix(all),xform.setFilename("combined_angio_fmri.matr"),this.setItem(xform,"transforms","Angio2fMRI")}create3D2FMRI(){let xform1=this.setup.transforms.Anat2Conv.obj,xform2=this.setup.transforms.Conv2fMRI.obj;if(!xform1||!xform2)return void webutil.createAlert("The three transformations Anat2Conv, Conv2fMRI and Anat2Angio must exist",!0);let m1=xform1.getMatrix(),m2=xform2.getMatrix(),all=numeric.dot(m1,m2),xform=new BisWebLinearTransformation(0);xform.setMatrix(all),xform.setFilename("combined_3d_fmri.matr"),this.setItem(xform,"transforms","3D2fMRI")}createAngio2Optical(){let xform1=this.setup.transforms.Angio2RotOptical.obj,xform2=this.setup.transforms.RotOptical2Optical.obj;if(!xform1||!xform2)return void webutil.createAlert("The two transformations Angio2RotOptical and RotOptical2Optical must exist",!0);let m1=xform1.getMatrix(),m2=xform2.getMatrix(),all=numeric.dot(m2,m1),xform=new BisWebLinearTransformation(0);xform.setMatrix(all),xform.setFilename("combined_angio_optical.matr"),this.setItem(xform,"transforms","Angio2Optical")}createObjectGUI(basediv,key1,key2,objtype){let sbar=webutil.creatediv({parent:basediv});sbar.append($("<HR>")),sbar.append($("<H4>"+key2+"</H4>"));let currentInfo=$('<div style="margin:5px; margin-top:10px; overflow: auto; position:relative; color:#fefefe; width:99%; height:99%; background-color:#101010; font-size:11px;">Empty</div>');sbar.append(currentInfo);let itembar=webutil.createbuttonbar({parent:basediv,css:{"margin-top":"10px"}});this.infoElement[key2]=currentInfo;const self=this;webfileutil.createFileButton({type:"warning",name:"Load",position:"bottom",parent:itembar,callback:function(f){self.loadItem(f,key1,key2,objtype).catch(e=>{webutil.createAlert(e,!0)})}},{filename:"",title:"Select file to load item from",filters:this.filters[objtype],save:!1,suffix:this.extensions[objtype]}),webfileutil.createFileButton({type:"primary",name:"Save",css:{"margin-right":"15px"},tooltip:"Click this to save points to a .ljson file",parent:itembar,callback:function(f){self.saveItem(f,key1,key2,objtype)}},{title:"Select file to save item to ",filters:this.filters[objtype],save:!0}),"image"===objtype?(webutil.createbutton({type:"info",name:"Disp1",position:"bottom",parent:itembar,callback:function(){self.showImage(key1,key2,"viewer1")}}),webutil.createbutton({type:"warning",name:"Disp1Ov",position:"bottom",parent:itembar,callback:function(){self.showImage(key1,key2,"viewer1",!0)}}),webutil.createbutton({type:"danger",name:"Disp2",position:"bottom",parent:itembar,css:{"margin-right":"15px"},callback:function(){self.showImage(key1,key2,"viewer2")}}),webutil.createbutton({type:"info",name:"Grab1",position:"bottom",parent:itembar,callback:function(){self.grabImage(key1,key2,"viewer1")}}),webutil.createbutton({type:"danger",name:"Grab2",position:"bottom",parent:itembar,callback:function(){self.grabImage(key1,key2,"viewer2")}})):(webutil.createbutton({type:"danger",name:"Send to Manager",position:"bottom",parent:itembar,css:{"margin-right":"15px"},callback:function(){let obj=self.setup[key1][key2].obj;obj&&self.currentTransformController.addItem(obj)}}),webutil.createbutton({type:"info",name:"Grab From Manager",position:"bottom",parent:itembar,callback:function(){let obj=self.currentTransformController.getCurrentObject();obj&&self.setItem(obj,key1,key2)}}),webutil.createbutton({type:"default",name:"Check",position:"bottom",parent:itembar,callback:function(){self.testTransform(key2)}}))}connectedCallback(){webutil.runAfterAllLoaded(()=>{this.internalConnectedCallback()})}internalConnectedCallback(){const algorithmcontrollerid=this.getAttribute("bis-algorithmcontrollerid");this.algoController=document.querySelector(algorithmcontrollerid),this.viewers=this.algoController.getViewers(),this.currentTransformController=this.algoController.getTransformController(),this.panel=new BisWebPanel(this.viewers.viewer1.getLayoutController(),{name:"MISAC TOOL",width:440,mode:"sidebar",dual:!1,hasfooter:!0});let basediv=this.panel.getWidget(),sbar=webutil.creatediv({parent:basediv});this.internal.inlineForm=webutil.creatediv({parent:sbar});let keys2=Object.keys(this.setup.images);for(let i=0;i<keys2.length;i++)this.createObjectGUI(sbar,"images",keys2[i],"image");keys2=Object.keys(this.setup.transforms);for(let i=0;i<keys2.length;i++)this.createObjectGUI(sbar,"transforms",keys2[i],"transform");const self=this;let footer=this.panel.getFooter();webutil.createbutton({type:"link",name:"Angio->fMRI",parent:footer,callback:function(){self.createAngio2FMRI()},css:{"margin-right":"2px"}}),webutil.createbutton({type:"link",name:"Angio->Optical",parent:footer,callback:function(){self.createAngio2Optical()},css:{"margin-right":"2px"}}),webutil.createbutton({type:"link",name:"Ref->fMRI",parent:footer,callback:function(){self.create3D2FMRI()},css:{"margin-right":"2px"}}),webfileutil.createFileButton({type:"default",name:"Load Setup",parent:footer,callback:function(f){self.loadSetup(f)}},{filters:[{name:"Setup Files",extensions:["misac"]}],title:"Select the file to load from",save:!1,suffix:""}),webfileutil.createFileButton({type:"primary",name:"Save Setup",parent:footer,callback:function(f){self.saveSetup(f)}},{filters:[{name:"Setup Files",extensions:["misac"]}],title:"Select the file to save to",save:!0,suffix:""})}addtomenu(menu){const self=this;webutil.createMenuItem(menu,"MISAC Tool",function(){self.show()})}addtomenubar(menubar){var hmenu=webutil.createTopMenuBarMenu("MISAC",menubar);this.addtomenu(hmenu)}})},"./js/webcomponents/bisweb_mni2talelement.js":function(module,exports,__webpack_require__){"use strict";const $=__webpack_require__("jquery"),bisweb_mni2talbase=__webpack_require__("./js/coreweb/bisweb_mni2talbase.js"),webutil=__webpack_require__("./js/coreweb/bis_webutil.js");webutil.defineElement("bisweb-mni2tal",class extends HTMLElement{constructor(){super(),this.viewer=null}connectedCallback(){let main=document.querySelector("#viewer");this.viewer=new bisweb_mni2talbase.OrthoViewer(main),this.viewer.initialize();let rs=function(){let width=window.innerWidth,height=window.innerHeight;width<600?$("#bottomright").css({top:"95vmin",width:"80vmin",left:"2vmin"}):height<600?$("#bottomright").css({top:"2vmin",width:"80vmin",left:"95vmin"}):$("#bottomright").css({top:"43vmin",width:"50vmin",left:"40vmin"})},imagepath=webutil.getWebPageImagePath();$("#blogo").append(`<a href="./index.html" target="_blank"><img src="${imagepath}/bioimagesuite.png" height="50px" id="bislogo" style="margin-top:0px;margin-right:20px;margin-left:15px"></a>`),window.addEventListener("resize",rs),webutil.runAfterAllLoaded(rs)}getviewer(){return this.viewer}})},"./js/webcomponents/bisweb_modulemanagerelement.js":function(module,exports,__webpack_require__){"use strict";const webutil=__webpack_require__("./js/coreweb/bis_webutil.js"),biscustom=__webpack_require__("./js/coreweb/bisweb_custommodule.js"),modules=__webpack_require__("./js/modules/moduleindex.js"),biswrap=__webpack_require__("./build/wasm/libbiswasm_wrapper.js"),userPreferences=__webpack_require__("./js/core/bisweb_userpreferences.js");webutil.defineElement("bisweb-modulemanager",class extends HTMLElement{connectedCallback(){this.mode=this.getAttribute("bis-mode")||"normal";const algorithmcontrollerid=this.getAttribute("bis-algorithmcontrollerid"),layoutwidgetid=this.getAttribute("bis-layoutwidgetid")||null;this.layoutcontroller=null===layoutwidgetid?null:document.querySelector(layoutwidgetid),this.algorithmController=document.querySelector(algorithmcontrollerid),this.customs=[],this.modules={},this.moduleMenu=[null,null,null,null],this.viewers=[]}createModuleOnDemandAndShow(name,module,moduleoptions={}){return null===this.modules[name]&&("function"==typeof module&&(module=new module(this.mode)),moduleoptions.name=name,this.modules[name]=biscustom.createCustom(this.layoutcontroller,this.algorithmController,module,moduleoptions),this.customs.push(this.modules[name])),this.modules[name].show(),this.modules[name]}createModule(name,index,dosep,module,moduleoptions={}){this.modules[name]=null;const self=this;webutil.createMenuItem(this.moduleMenu[index],name,function(){self.createModuleOnDemandAndShow(name,module,moduleoptions)}),dosep&&webutil.createMenuItem(this.moduleMenu[index],"")}attachTransformationController(index){if(this.algorithmController.getTransformController()){const self=this;webutil.createMenuItem(this.moduleMenu[index],"Transformation Manager",function(){self.algorithmController.getTransformController().show()}),webutil.createMenuItem(this.moduleMenu[index],"")}}transferImages(v1,v2){let img=this.viewers[v1].getimage();if(img){this.viewers[v2].setimage(img);let obj=this.viewers[v1].getobjectmap();if(obj){let clt=this.viewers[v1].getcolortype();this.viewers[v2].setobjectmap(obj,!1,clt)}}}transferImageToOverlay(v1,v2){let img=this.viewers[v1].getimage();img&&this.viewers[v2].setobjectmap(img)}transferOverlayToImage(v1,v2){let img=this.viewers[v1].getobjectmap();img&&this.viewers[v2].setimage(img)}swapImages(){let img=this.viewers[0].getimage(),obj=this.viewers[0].getobjectmap(),clt=this.viewers[0].getcolortype();this.transferImages(1,0),img&&(this.viewers[1].setimage(img),obj&&this.viewers[1].setobjectmap(obj,!1,clt))}initializeElements(menubar,viewers=[]){return new Promise((resolve,reject)=>{this.algorithmController||reject("No algorithm controller"),this.viewers=viewers;let numviewers=this.viewers.length;for(let i=0;i<numviewers;i++)this.viewers[i].addImageChangedObserver(this);let moduleoptions={numViewers:numviewers,dual:!1};numviewers>1&&(moduleoptions.dual=!0),this.moduleMenu[1]=webutil.createTopMenuBarMenu("Image Processing",menubar),"paravision"!==this.mode?this.moduleMenu[2]=webutil.createTopMenuBarMenu("Segmentation",menubar):this.moduleMenu[2]=this.moduleMenu[1],"single"!==this.mode&&(this.moduleMenu[3]=webutil.createTopMenuBarMenu("Registration",menubar)),biswrap.initialize().then(()=>{this.initializeElementsInternal(menubar,moduleoptions),resolve(this.moduleMenu)}).catch(e=>{reject(e+" "+e.stack)})})}initializeElementsInternal(menubar,moduleoptions){let usesgpl=biswrap.uses_gpl();usesgpl=!!usesgpl,this.createModule("Smooth Image",1,!1,modules.smoothImage,moduleoptions),userPreferences.safeGetItem("internal").then(f=>{f&&(webutil.createMenuItem(this.moduleMenu[1],""),this.createModule("Quality Measures",1,!1,modules.qualityMeasures,moduleoptions),this.createModule("Change Header Spacing",1,!1,modules.changeImageSpacing,moduleoptions))}),this.createModule("Normalize Image",1,!1,modules.normalizeImage,moduleoptions),this.createModule("Threshold Image",1,!1,modules.thresholdImage,moduleoptions),this.createModule("Cluster Threshold",1,!1,modules.clusterThreshold,moduleoptions),this.createModule("Correct Bias Field",1,!0,modules.sliceBiasFieldCorrect,moduleoptions),this.createModule("Resample Image",1,!1,modules.resampleImage,moduleoptions),this.createModule("Shift+Scale(+Cast) Image",1,!1,modules.shiftScaleImage,moduleoptions),this.createModule("Reorient Image",1,!1,modules.reorientImage,moduleoptions),this.createModule("Flip Image",1,!1,modules.flipImage,moduleoptions),this.createModule("Crop Image",1,!1,modules.cropImage,moduleoptions),this.createModule("Blank Image",1,!1,modules.blankImage,moduleoptions),this.createModule("Extract Frame",1,!0,modules.extractFrame,moduleoptions);let dosep="paravision"===this.mode;return this.createModule("Combine Images",1,!1,modules.combineImages,moduleoptions),this.createModule("Process 4D Image",1,dosep,modules.process4DImage,moduleoptions),this.createModule("Create Mask",2,!1,modules.binaryThresholdImage,moduleoptions),this.createModule("Morphology Filter",2,!1,modules.morphologyFilter,moduleoptions),usesgpl&&(this.createModule("Segment Image",2,!0,modules.segmentImage,moduleoptions),this.createModule("Deface Head Image",2,!0,modules.defaceImage,moduleoptions)),this.createModule("Regularize Objectmap",2,!0,modules.regularizeObjectmap,moduleoptions),this.createModule("Mask Image",2,!1,modules.maskImage,moduleoptions),"single"!==this.mode&&(this.attachTransformationController(3),this.createModule("Reslice Image",3,!0,modules.resliceImage,moduleoptions),this.createModule("Manual Registration",3,!0,modules.manualRegistration,moduleoptions),usesgpl&&(this.createModule("Linear Registration",3,!1,modules.linearRegistration,moduleoptions),this.createModule("Non Linear Registration",3,!0,modules.nonlinearRegistration,moduleoptions)),this.createModule("Project Image",3,!1,modules.projectImage,moduleoptions),this.createModule("Back-Project Image",3,usesgpl,modules.backProjectImage,moduleoptions),usesgpl&&this.createModule("Motion Correction",3,!1,modules.motionCorrection,moduleoptions)),this.moduleMenu[0]}handleViewerImageChanged(){biscustom.updateModules()}getAlgorithmController(){return this.algorithmController}})},"./js/webcomponents/bisweb_mosaicviewerelement.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var dat_gui__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/dat.gui/build/dat.gui.module.js");const THREE=__webpack_require__("three"),util=__webpack_require__("./js/core/bis_util.js"),BISCameraControls=__webpack_require__("./js/coreweb/bis_3dorthographiccameracontrols.js"),bis3dOrthogonalSlice=__webpack_require__("./js/coreweb/bis_3dorthogonalslice.js"),webutil=__webpack_require__("./js/coreweb/bis_webutil.js"),$=__webpack_require__("jquery"),BaseViewerElement=__webpack_require__("./js/webcomponents/bisweb_baseviewerelement.js"),MAXROWS=8,MAXCOLS=8,MAXVIEWERS=MAXROWS*MAXCOLS;webutil.defineElement("bisweb-mosaicviewer",class extends BaseViewerElement{constructor(){super(),this.internal.s_width=2,this.internal.s_depth=2,this.internal.plane=2,this.internal.numrows=1,this.internal.numcols=2,this.internal.firstslice=0,this.internal.increment=4,this.internal.frame=0,this.internal.ismosaic=!0,this.internal.lastzoom=null,this.internal.slices=[null],this.internal.displaymodes=null,this.internal.corefolder=null}getmmsl(sl){return this.computeslice(sl)*this.internal.imagespa[this.internal.plane]+this.internal.objectmapshift[this.internal.plane]}computeslice(index){return index=index||0,this.internal.imagedim[this.internal.plane]<1?0:this.internal.firstslice+this.internal.increment*index}computeviewport(index){if((index=Math.floor(util.range(index,0,MAXVIEWERS-1)))>=this.internal.numrows*this.internal.numcols)return{x0:0,y0:0,x1:0,y1:0};let dw=this.internal.layoutcontroller.canvas.width,fullw=this.cleararea[1]*dw,offsetw=this.cleararea[0]*dw,fullh=this.internal.layoutcontroller.canvas.height,vwidth=fullw/(this.internal.numcols+.01),vheight=.91*fullh/(this.internal.numrows+.01),vdim=vwidth;vheight<vwidth&&(vdim=vheight);let widthC=vdim/fullw,widthR=vdim/fullh,xoffset=.5*(1-widthC*this.internal.numcols),yoffset=1-widthR*this.internal.numrows;yoffset>1-.91&&(yoffset=.5*(yoffset-(1-.91))+(1-.91));let iy=Math.floor(index/this.internal.numcols),x0=(index-Math.floor(iy*this.internal.numcols))*widthC+xoffset,y0=iy*widthR+yoffset;return{x0:this.cleararea[1]*x0+offsetw,y0:y0,x1:this.cleararea[1]*(x0+.98*widthC)+offsetw,y1:y0+.98*widthR}}createsliceview(renderer,vol,orthoslice,index,width,depth){var plane=orthoslice.getplane(),scene=new THREE.Scene,light=new THREE.AmbientLight(16777215);scene.add(light),scene.doubleSided=!0,orthoslice.addtoscene(scene);var camera=new THREE.OrthographicCamera(-width,width,-width,width,.01,2*depth),lkv=orthoslice.positioncamera(camera),controls=new BISCameraControls(camera,plane,lkv,renderer.domElement);return controls.rotateSpeed=10,controls.zoomSpeed=1,controls.panSpeed=5,controls.noZoom=!1,controls.noPan=!1,controls.normViewport=this.computeviewport(index),{scene:scene,controls:controls,camera:camera}}deleteoldobjectmap_artifacts(){let s=this.internal.objectmap;super.deleteoldobjectmap(),this.internal.objectmap=s}deleteoldimage_artifacts(){super.deleteoldimage()}getmaxviewers(){return this.internal.numrows*this.internal.numcols}renderloop(){var hasoverlay=!1;null!==this.internal.overlayslices&&(hasoverlay=!0),this.ensureviewersexist(hasoverlay),super.renderloop()}handleresize(){super.handleresize(),this.updateviewports(this.internal.numrows,this.internal.numcols),this.updateResizeObservers(),this.drawlabels()}drawlabels(){if(null===this.internal.volume)return;let context=this.internal.layoutcontroller.context,domwidth=this.internal.layoutcontroller.getviewerwidth(),domheight=this.internal.layoutcontroller.getviewerheight(),dw=domwidth,dh=domheight;if(context.clearRect(Math.floor(this.cleararea[0]*dw),0,Math.floor(this.cleararea[1]*dw),dh),!0===this.internal.showdecorations){let labels=[["A","P","I","S"],["R","L","I","S"],["R","L","P","A"]],names=["Sagittal","Coronal","Axial"],axes=["-jk","-ik","-ij"],f=[.98,.02],imageorientinvaxis=this.internal.volume.getOrientation().invaxis,imageorientaxis=this.internal.volume.getOrientation().axis;context.font="12px Arial",context.fillStyle="#dd7700";let numslices=this.internal.numrows*this.internal.numcols,trueplane=imageorientinvaxis[this.internal.plane],lab=labels[trueplane],maxslice=this.internal.imagedim[this.internal.plane]-1;for(let i=0;i<numslices;i++){let vp=this.internal.subviewers[i].controls.normViewport,sliceno=this.computeslice(i);if(sliceno>=0&&sliceno<=maxslice&&(vp.x1-vp.x0)*domwidth>150){let xmin=Math.round((f[0]*vp.x0+f[1]*vp.x1)*domwidth),xmax=Math.round((f[0]*vp.x1+f[1]*vp.x0)*domwidth),ymid=Math.round(domheight*(1-.5*(vp.y0+vp.y1)));context.textAlign="start",context.textBaseline="middle",context.fillText(lab[0],xmin,ymid),context.textAlign="end",context.fillText(lab[1],xmax,ymid);let ymin=Math.round((1-(f[0]*vp.y0+f[1]*vp.y1))*domheight),ymax=Math.round((1-(f[0]*vp.y1+f[1]*vp.y0))*domheight),xmid=Math.round(domwidth*(.3*vp.x0+.7*vp.x1));context.textAlign="end",context.textBaseline="bottom",context.fillText(lab[2],xmid,ymin),context.textBaseline="top",context.fillText(lab[3],xmid,ymax);let name=names[trueplane]+axes[imageorientaxis[trueplane]]+"="+sliceno;this.internal.maxnumframes>1&&(name+=" (fr="+this.internal.frame+")"),context.textAlign="start",context.textBaseline="bottom";let xmid0=Math.round(domwidth*(.8*vp.x0+.2*vp.x1));context.fillText(name,xmid0,ymin)}}}this.drawcolorscale()}ensureviewersexist(hasoverlay){let numviewers=this.internal.numrows*this.internal.numcols;for(let i=0;i<numviewers;i++)if(null===this.internal.slices[i]&&(this.internal.slices[i]=bis3dOrthogonalSlice.create2dslice(this.internal.volume,this.internal.plane,1,!1,!0),this.internal.subviewers[i]=this.createsliceview(this.internal.layoutcontroller.renderer,this.internal.volume,this.internal.slices[i],i,this.internal.s_width,this.internal.s_depth)),hasoverlay&&null!==this.internal.objectmap&&null===this.internal.overlayslices[i]){this.internal.overlayslices[i]=bis3dOrthogonalSlice.create2dslice(this.internal.objectmap,this.internal.plane,0,!0,!0);let sl=this.getmmsl(i);this.internal.overlayslices[i].setsliceinmm(this.internal.slices[i],sl,this.internal.frame,this.internal.objectmaptransferfunction),this.internal.overlayslices[i].addtoscene(this.internal.subviewers[i].scene)}null!==this.internal.lastzoom&&(this.zoomViewers(this.internal.lastzoom),this.internal.lastzoom=null)}updatescene(){var numviewers=this.internal.numrows*this.internal.numcols,hasoverlay=!1;null!==this.internal.overlayslices&&(hasoverlay=!0),this.ensureviewersexist(hasoverlay);let objmapframe=this.internal.frame;objmapframe>=this.internal.objectmapnumframes&&(objmapframe=this.internal.objectmapnumframes-1);let imageframe=this.internal.frame;imageframe>=this.internal.imagedim[3]&&(imageframe=this.internal.imagedim[3]-1);for(var i=0;i<numviewers;i++){var sl=this.computeslice(i);if(this.internal.slices[i].setsliceno(sl,imageframe,this.internal.imagetransferfunction),this.internal.slices[i].showdecorations(this.internal.showdecorations),hasoverlay&&null!==this.internal.overlayslices[i]){var slmm=this.getmmsl(i);this.internal.overlayslices[i].setsliceinmm(this.internal.slices[i],slmm,objmapframe,this.internal.objectmaptransferfunction)}}this.drawlabels(),this.updateFrameChangedObservers()}updateviewports(rows,cols){if(null===this.internal.subviewers)return;var n=util.range(Math.round(rows||0),1,MAXROWS),c=util.range(Math.round(cols||0),1,MAXCOLS);this.internal.numrows=n,this.internal.numcols=c;for(var index=0;index<this.internal.subviewers.length;index++)null!==this.internal.subviewers[index]&&(this.internal.subviewers[index].controls.normViewport=this.computeviewport(index),this.internal.subviewers[index].controls.reset());let data=this.internal.datgui.data;data.numrows=this.internal.numrows,data.numcols=this.internal.numcols,this.updatescene()}updatetransferfunctions(input){var dooverlay=!1;null!==this.internal.overlayslices&&null!==this.internal.overlayslices[0]&&(dooverlay=!0);var pl=0,numviewers=this.internal.numrows*this.internal.numcols;if(null!==input.image)for(this.internal.imagetransferfunction=input.image,pl=0;pl<numviewers;pl++)null!==this.internal.slices[pl]&&this.internal.slices[pl].setnexttimeforce();for(pl=0;pl<numviewers;pl++)this.internal.slices[pl].interpolate(input.interpolate);if(dooverlay){if(null!==input.objectmap)for(this.internal.objectmaptransferfunction=input.objectmap,this.internal.objectmaptransferinfo=input.functionalparams,pl=0;pl<numviewers;pl++)null!==this.internal.overlayslices[pl]&&this.internal.overlayslices[pl].setnexttimeforce();for(pl=0;pl<numviewers;pl++)null!==this.internal.overlayslices[pl]&&this.internal.overlayslices[pl].interpolate(input.objinterpolate)}this.updatescene(),this.updateColormapObservers(input),this.drawcolorscale()}connectedCallback(){this.connectedCallbackBase()}setimage(volume){this.disable_renderloop(),this.playStopMovie(!1);let samesize=!1;null!==this.internal.volume&&null!==volume&&(samesize=this.internal.volume.hasSameSizeAndOrientation(volume)),samesize&&(this.internal.lastzoom=this.internal.subviewers[0].controls.getZoomFactor()),null!==this.internal.volume&&(this.deleteoldimage_artifacts(),this.internal.objectmap=null),this.internal.volume=volume,!1===samesize&&(this.internal.imagedim=volume.getDimensions(),this.remapDimensionsTo4D(this.internal.imagedim),this.internal.plane=2,this.internal.imagespa=volume.getSpacing(),this.internal.firstslice=Math.round(this.internal.imagedim[2]/2),this.internal.increment=1,this.internal.maxnumframes=this.internal.imagedim[3]);let imagerange=volume.getIntensityRange();this.internal.imagetransferfunction=util.mapstepcolormapfactory(imagerange[0],imagerange[1],255),this.setimageplane(this.internal.plane,!0),!1===samesize&&this.handleresize(),this.updateImageChangedObservers("image")}setimageplane(pl,force){if(force=force||!1,0!==pl&&(pl=pl||this.internal.plane),!1===force&&pl===this.internal.plane)return;let obj=this.internal.objectmap;this.deleteoldimage_artifacts(),this.internal.objectmap=obj;const self=this;if(null===this.internal.cmapcontroller){let colormapid=this.getAttribute("bis-colormapeditorid");this.internal.cmapcontroller=document.querySelector(colormapid)}this.internal.cmapcontroller.setimage(this.internal.volume,function(i){self.updatetransferfunctions(i)},1),this.internal.plane=pl;var imagesize=this.internal.volume.getImageSize(),d=imagesize[2];0===this.internal.plane?imagesize[1]>imagesize[2]&&(d=imagesize[1]):1===this.internal.plane?imagesize[0]>imagesize[2]&&(d=imagesize[0]):2===this.internal.plane&&(d=imagesize[1]>imagesize[0]?imagesize[1]:imagesize[0]),this.internal.s_width=Math.round(.6*d),this.internal.s_depth=Math.round(2*imagesize[this.internal.plane]),this.internal.slices=new Array(MAXVIEWERS),this.internal.subviewers=new Array(MAXVIEWERS);for(var i=0;i<MAXVIEWERS;i++)this.internal.slices[i]=null,this.internal.subviewers[i]=null;this.enable_renderloop(),this.renderloop(),this.drawlabels(),this.createdatgui(),null!==this.internal.objectmap&&this.setobjectmapplane(this.internal.plane,!0)}setobjectmap(ovolume,plainmode,colormapmode){if(colormapmode=colormapmode||"Auto",plainmode=plainmode||!1,null===this.internal.volume)return void webutil.createAlert("can not load objectmap if no image is in memory",!0);this.disableClustering(),this.internal.objectmap=ovolume;let ospa=this.internal.objectmap.getSpacing(),odim=this.internal.objectmap.getDimensions();this.remapDimensionsTo4D(odim);for(let i=0;i<=2;i++){var ci=.5*this.internal.imagedim[i]*this.internal.imagespa[i],co=.5*odim[i]*ospa[i];this.internal.objectmapshift[i]=co-ci}this.internal.objectmapnumframes=odim[3],this.internal.objectmapnumframes>this.internal.maxnumframes&&(this.internal.maxnumframes=this.internal.objectmapnumframes);var numviewers=this.internal.numrows*this.internal.numcols;for(let pl=0;pl<numviewers;pl++)null!==this.internal.slices[pl]&&this.internal.slices[pl].setnexttimeforce();this.internal.maxnumframes>this.internal.imagedim[3]&&this.createdatgui(),this.setobjectmapplane(this.internal.plane,!0,plainmode,colormapmode),this.updateImageChangedObservers("overlay")}setobjectmapplane(pl,force,plainmode,colormapmode){if(force=force||!1,plainmode=plainmode||!1,0!==pl&&(pl=pl||this.internal.plane),!1!==force||pl!==this.internal.plane){this.deleteoldobjectmap_artifacts(),this.internal.overlayslices=new Array(MAXVIEWERS);for(let i=0;i<MAXVIEWERS;i++)this.internal.overlayslices[i]=null;this.ensureviewersexist(!0),this.internal.cmapcontroller.addobjectmap(this.internal.objectmap,plainmode,colormapmode),this.updatescene()}}clearobjectmap(){null!==this.internal.objectmap&&(this.deleteoldobjectmap_artifacts(),this.internal.objectmap=null,this.internal.cmapcontroller.removeobjectmap(),this.internal.objectmap=null)}setslices(beginslice,increment,frame){beginslice=Math.floor(beginslice||0),increment=Math.floor(increment||1),frame=Math.floor(frame||0),this.internal.firstslice=util.range(beginslice,0,this.internal.imagedim[this.internal.plane]-1),this.internal.increment=util.range(increment,-20,20),this.internal.frame=frame;let data=this.internal.datgui.data;data.first=this.internal.firstslice,data.increment=this.internal.increment,data.tcoord=this.internal.frame,this.updatescene()}setframe(fr){if(!this.internal.framecontroller)return;let num=this.internal.maxnumframes;fr<0?fr=num-1:fr>=num&&(fr=0),this.setslices(this.internal.firstslice,this.internal.increment,fr),this.internal.datgui.data.tcoord=this.internal.frame,this.internal.framecontroller.updateDisplay(),this.updateFrameChangedObservers()}getframe(){return this.internal.frame}createdatgui(){const self=this;let base_widget=this.internal.layoutcontroller.getcorecontrols(this.is_slave_viewer);null!==this.internal.datgui.gui&&base_widget.empty();for(var names=["Sagittal","Coronal","Axial"],dpname=["","",""],imageorientinvaxis=this.internal.volume.getOrientation().invaxis,pl=0;pl<=2;pl++){var trueplane=imageorientinvaxis[pl];dpname[pl]=names[trueplane]}var data=this.internal.datgui.data;data.displaymode=dpname[this.internal.plane],data.first=this.internal.firstslice,data.numrows=this.internal.numrows,data.numcols=this.internal.numcols,data.increment=this.internal.increment,data.tcoord=this.internal.frame,data.decorations=!0,data.rate=20,data.playing=!1,this.internal.displaymodes=dpname;var gui=new dat_gui__WEBPACK_IMPORTED_MODULE_0__.default.GUI({autoPlace:!1,width:this.internal.domextra});base_widget.append(gui.domElement);var f1=gui.addFolder("Core");this.internal.corefolder=f1,f1.add(data,"displaymode",dpname).name("Plane").onChange(function(val){var ind=dpname.indexOf(val);self.setimageplane(ind,!1)});var vpchange=function(){self.updateviewports(data.numrows,data.numcols)},rowcoord=f1.add(data,"numrows",1,MAXROWS).name("Rows").step(1),colcoord=f1.add(data,"numcols",1,MAXCOLS).name("Columns").step(1);rowcoord.onChange(vpchange),colcoord.onChange(vpchange);var coordchange=function(){self.setslices(data.first,data.increment,data.tcoord)};this.internal.play_movie_controller=null;var xcoord=f1.add(data,"first",0,this.internal.imagedim[this.internal.plane]-1).name("First").step(1),ycoord=f1.add(data,"increment").name("Increment").step(1);xcoord.onChange(coordchange),ycoord.onChange(coordchange),data.decorations=self.internal.showdecorations,f1.add(data,"decorations").name("Labels").onChange(function(val){self.internal.showdecorations=val,self.updatescene()}),f1.open(),this.internal.cmapcontroller.creategui(gui),this.internal.datgui.gui=gui,webutil.removedatclose(gui);var bbar=$("<div></div>");bbar.css({margin:"10px"}),base_widget.append(bbar),webutil.createbutton({name:"Reset Slices",type:"info",tooltip:"This resets the viewer to default camera positions and zoom level",position:"bottom",parent:bbar}).click(function(e){e.preventDefault(),self.resetViewers()}),webutil.createbutton({name:"Z-",type:"info",tooltip:"Zoom out",css:{"margin-left":"8px"},position:"left",parent:bbar}).click(function(e){e.preventDefault(),self.zoomViewers(1.1)}),webutil.createbutton({name:"Z+",tooltip:"Zoom in",type:"info",css:{"margin-left":"8px"},position:"left",parent:bbar}).click(function(e){e.preventDefault(),self.zoomViewers(.9)}),webutil.createbutton({name:"?",tooltip:"Info about displayed image(s)",type:"info",css:{"margin-left":"8px"},position:"left",parent:bbar}).click(function(){self.viewerInformation()}),bbar.tooltip()}updatemousecoordinates(){}getElementState(storeImages=!1){let obj=super.getElementState(storeImages);return obj.data=JSON.parse(JSON.stringify(this.internal.datgui.data)),obj}setElementState(dt=null){if(null===dt)return;super.setElementState(dt);let sanedata=JSON.parse(JSON.stringify(this.internal.datgui.data));for(let attr in dt.data)sanedata.hasOwnProperty(attr)&&(sanedata[attr]=dt.data[attr]);try{let ind=this.internal.displaymodes.indexOf(sanedata.displaymode);this.setimageplane(ind,!1),this.internal.showdecorations=sanedata.decorations,this.internal.datgui.data.decorations=this.internal.showdecorations,this.updateviewports(parseInt(sanedata.numrows),parseInt(sanedata.numcols)),this.setslices(parseInt(sanedata.first),parseInt(sanedata.increment),parseInt(sanedata.tcoord))}catch(e){console.log(e.stack,e)}this.setElementStateCameras(dt),setTimeout(()=>{let gui=this.internal.corefolder||null;if(null!==gui)for(let ia=0;ia<gui.__controllers.length;ia++)gui.__controllers[ia].updateDisplay()},100)}})},"./js/webcomponents/bisweb_orthogonalviewerelement.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var dat_gui__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/dat.gui/build/dat.gui.module.js");const THREE=__webpack_require__("three"),util=__webpack_require__("./js/core/bis_util.js"),BISCameraControls=__webpack_require__("./js/coreweb/bis_3dorthographiccameracontrols.js"),bis3dOrthogonalSlice=__webpack_require__("./js/coreweb/bis_3dorthogonalslice.js"),bisCrossHair=__webpack_require__("./js/coreweb/bis_3dcrosshairgeometry.js"),webutil=__webpack_require__("./js/coreweb/bis_webutil.js"),$=__webpack_require__("jquery"),bootbox=__webpack_require__("./node_modules/bootbox/bootbox.js"),BaseViewerElement=__webpack_require__("./js/webcomponents/bisweb_baseviewerelement.js");webutil.defineElement("bisweb-orthogonalviewer",class extends BaseViewerElement{constructor(){super(),this.internal.simplemode=!1,this.internal.rendermode=8,this.internal.origviewports=[[{x0:.52,y0:.55,x1:.97,y1:1},{x0:.03,y0:.55,x1:.48,y1:1},{x0:.03,y0:.09,x1:.48,y1:.54},{x0:.99,y0:0,x1:.995,y1:.01},{x0:0,y0:0,x1:0,y1:0}],[{x0:.05,y0:.09,x1:.95,y1:.99},{x0:0,y0:0,x1:.01,y1:.01},{x0:0,y0:.3,x1:.01,y1:.31},{x0:0,y0:.6,x1:.01,y1:.61},{x0:0,y0:0,x1:0,y1:0}],[{x0:0,y0:0,x1:.01,y1:.01},{x0:.05,y0:.09,x1:.95,y1:.99},{x0:0,y0:.3,x1:.01,y1:.31},{x0:0,y0:.6,x1:.01,y1:.61},{x0:0,y0:0,x1:0,y1:0}],[{x0:0,y0:0,x1:.01,y1:.01},{x0:0,y0:.3,x1:.01,y1:.31},{x0:.05,y0:.09,x1:.95,y1:.99},{x0:0,y0:.6,x1:.01,y1:.61},{x0:0,y0:0,x1:0,y1:0}],[{x0:.6,y0:.81,x1:.79,y1:1},{x0:0,y0:.81,x1:.19,y1:1},{x0:0,y0:.2,x1:.19,y1:.39},{x0:.21,y0:0,x1:1,y1:.8},{x0:0,y0:0,x1:0,y1:0}],[{x0:0,y0:0,x1:.01,y1:.01},{x0:0,y0:.3,x1:.01,y1:.31},{x0:0,y0:.6,x1:.01,y1:.61},{x0:.01,y0:.01,x1:1,y1:1},{x0:0,y0:0,x1:0,y1:0}],[{x0:.01,y0:.06,x1:.26,y1:.32},{x0:.01,y0:.38,x1:.26,y1:.63},{x0:.01,y0:.74,x1:.26,y1:.99},{x0:.29,y0:.01,x1:.99,y1:.99},{x0:0,y0:0,x1:0,y1:0}],[{x0:.05,y0:.01,x1:.31,y1:.27},{x0:.37,y0:.01,x1:.63,y1:.27},{x0:.69,y0:0,x1:.95,y1:.27},{x0:.6,y0:.3,x1:.99,y1:.99},{x0:.01,y0:.3,x1:.59,y1:.99}],[{x0:.05,y0:.01,x1:.31,y1:.27},{x0:.37,y0:.01,x1:.63,y1:.27},{x0:.69,y0:0,x1:.95,y1:.27},{x0:.99,y0:0,x1:.995,y1:.01},{x0:0,y0:.29,x1:1,y1:1}],[{x0:.05,y0:.1,x1:.31,y1:.9},{x0:.37,y0:.1,x1:.63,y1:.9},{x0:.69,y0:.1,x1:.95,y1:.9},{x0:.99,y0:0,x1:.995,y1:.01},{x0:.99,y0:0,x1:.995,y1:.01}]],this.internal.viewports=this.internal.origviewports,this.internal.slicecoord=[0,0,0,0],this.internal.objectmapshift=[0,0,0],this.internal.subviewers=[null,null,null,null],this.internal.slices=[null,null,null,null],this.internal.overlayslices=[null,null,null,null],this.internal.moviefolder=null,this.internal.arrowbuttons=[null,null,null,null,null,null,null,null,null,null,null,null],this.internal.midline=null,this.internal.midline2=null,this.internal.midlinemessage=null,this.internal.midlinepresent=!1,this.internal.midlinedata={left:-1,origx:-1},this.internal.displaymodes=null,this.setObjectMapFunction=null}getobjectmapcoordinates(){for(var c=[0,0,0],i=0;i<=2;i++)c[i]=this.internal.slicecoord[i]*this.internal.imagespa[i]+this.internal.objectmapshift[i];return c}getmmcoordinates(){for(var c=[0,0,0,0],i=0;i<=2;i++)c[i]=this.internal.slicecoord[i]*this.internal.imagespa[i];return c[3]=this.internal.slicecoord[3],c}createsliceview(renderer,vol,orthoslice,width,depth){var plane=orthoslice.getplane();this.internal.slicecoord[plane]=orthoslice.getsliceno();var scene=new THREE.Scene,light=new THREE.AmbientLight(16777215);scene.add(light),scene.doubleSided=!0,orthoslice.addtoscene(scene);var camera=new THREE.OrthographicCamera(-width,width,-width,width,.01,2*depth),lkv=orthoslice.positioncamera(camera),controls=new BISCameraControls(camera,plane,lkv,renderer.domElement);return controls.rotateSpeed=10,this.internal.simplemode?controls.zoomSpeed=.5:controls.zoomSpeed=1,controls.panSpeed=5,controls.noZoom=!1,controls.noPan=!1,controls.normViewport=this.internal.viewports[1][plane],{scene:scene,controls:controls,camera:camera}}createcardview(ren,vol,cardslice,width,depth){var scene=new THREE.Scene,light=new THREE.AmbientLight(16777215);scene.add(light),scene.doubleSided=!0,cardslice.addtoscene(scene);var camera=new THREE.OrthographicCamera(-width,width,-width,width,.01,2*depth),lkv=cardslice.positioncamera(camera),controls=new BISCameraControls(camera,3,lkv,ren.domElement);controls.rotateSpeed=4,this.internal.simplemode?controls.zoomSpeed=3:controls.zoomSpeed=1,controls.panSpeed=5,controls.noZoom=!1,controls.noPan=!1,controls.normViewport=this.internal.viewports[1][3];var wd=4*this.internal.imagespa[0];if(!this.internal.simplemode){var origin=new THREE.Mesh(bisCrossHair.createcrosshair(wd,this.internal.imagespa[0],!1),new THREE.MeshBasicMaterial({color:16777215,wireframe:!1}));scene.add(origin)}return{scene:scene,camera:camera,controls:controls}}drawtext(){if(!1===this.internal.showdecorations)return;if(null===this.internal.volume)return;if(this.internal.simplemode)return;let fullwidth=this.internal.layoutcontroller.getviewerwidth(),dw=fullwidth*this.cleararea[1];if(dw<200)return;let frame=this.internal.slicecoord[3],imageframe=frame,objmapframe=frame;imageframe>=this.internal.imagedim[3]&&(imageframe=this.internal.imagedim[3]-1);let imagecoord=[this.internal.slicecoord[0],this.internal.slicecoord[1],this.internal.slicecoord[2],imageframe],value=util.scaledround(this.internal.volume.getVoxel(imagecoord),100);if(null!==this.internal.objectmap){let newc=this.getobjectmapcoordinates(),coord=[0,0,0,0];objmapframe>=this.internal.objectmapnumframes&&(objmapframe=this.internal.objectmapnumframes-1),coord[3]=objmapframe;for(let i=0;i<=2;i++)coord[i]=Math.floor(newc[i]/this.internal.objectmapspa[i]);let v2=util.scaledround(this.internal.objectmap.getVoxel(coord),100),sum=0;for(let i=0;i<=3;i++)sum+=Math.abs(imagecoord[i]-coord[i]);(sum+=Math.abs(this.internal.objectmapnumframes-this.internal.imagedim[3]))>0?(this.internal.objectmapnumframes<2&&this.maxnumframes<2&&coord.splice(3,1),value=value+", Ovr: ("+coord.join(",")+")="+v2):value=value+", Ovr:"+v2}let s="";this.is_slave_viewer&&(s="V2:"),null!==this.slave_viewer&&(s="V1:"),this.internal.imagedim[3]<2&&imagecoord.splice(3,1),s=s+" Img ("+imagecoord.join(",")+") ="+value;var dh=this.internal.layoutcontroller.getviewerheight(),y0=.95*dh,context=this.internal.layoutcontroller.context,fnsize=webutil.getfontsize(context.canvas);let r=dw/s.length/20;r<1&&(fnsize=Math.round(r*fnsize)),context.font=fnsize+"px Arial",context.fillStyle="#dddddd",context.clearRect(this.cleararea[0]*fullwidth+2,y0,.5*dw-4,dh-y0),context.textAlign="left",context.fillText(s,(this.cleararea[0]+.01)*fullwidth,.99*dh)}getViewerCrossHairs(){return this.internal.slicecoord}drawcrosshairs(){if(null!==this.internal.volume){for(var i=0;i<=2;i++)this.internal.slices[i].drawcrosshairs(this.internal.slicecoord);if(null!==this.internal.datgui.gui){this.internal.datgui.data.xcoord=this.internal.slicecoord[0],this.internal.datgui.data.ycoord=this.internal.slicecoord[1],this.internal.datgui.data.zcoord=this.internal.slicecoord[2],this.internal.datgui.data.tcoord=this.internal.slicecoord[3];var gui=this.internal.datgui.coords;if(null!==gui)for(var ia=0;ia<gui.__controllers.length;ia++)gui.__controllers[ia].updateDisplay()}this.drawtext()}}updateobjectmapdisplay(){let objcoord=this.getobjectmapcoordinates(),objmapframe=this.internal.slicecoord[3];objmapframe>=this.internal.objectmapnumframes&&(objmapframe=this.internal.objectmapnumframes-1);for(var pl=0;pl<=2;pl++)null!==this.internal.overlayslices[pl]&&(this.internal.overlayslices[pl].setsliceinmm(this.internal.slices[pl],objcoord[pl],objmapframe,this.internal.objectmaptransferfunction),this.internal.overlayslices[3].updatecoordinatesinmm(this.internal.slices[pl],pl))}updatescene(coords,plane,mousestate,force=!1){if(coords.length<4&&coords.push(this.getframe()),(!this.internal.lockcursor||!1!==force)&&null!==this.internal.slices&&null!==this.internal.slices[0]){if(2!==mousestate){void 0!==coords[3]&&null!==coords[3]||(coords[3]=0);let sl=[util.range(Math.round(coords[0]/this.internal.imagespa[0]),0,this.internal.imagedim[0]-1),util.range(Math.round(coords[1]/this.internal.imagespa[1]),0,this.internal.imagedim[1]-1),util.range(Math.round(coords[2]/this.internal.imagespa[2]),0,this.internal.imagedim[2]-1),util.range(Math.floor(coords[3]),0,this.internal.maxnumframes-1)];this.internal.slicecoord[3]=sl[3],plane>=0&&plane<=2&&(sl[plane]=this.internal.slicecoord[plane]);var old=[0,0,0],pl=0;for(pl=0;pl<=2;pl++){let imgframe=sl[3];imgframe>=this.internal.imagedim[3]&&(imgframe=this.internal.imagedim[3]-1),this.internal.slices[pl].showdecorations(this.internal.showdecorations),old[pl]=this.internal.slicecoord[pl],this.internal.slicecoord[pl]=this.internal.slices[pl].setsliceno(sl[pl],imgframe,this.internal.imagetransferfunction),this.internal.slices[pl].updatecameraclip(this.internal.subviewers[pl].camera,.5*this.internal.maxspa),old[pl]!==this.internal.slicecoord[pl]&&this.internal.slices[3].updatecoordinates(pl)}this.updateobjectmapdisplay(),this.drawcrosshairs()}if(0!==this.internal.mouseobservers.length){void 0===mousestate&&(mousestate=-1);var mm=this.getmmcoordinates();this.updateMouseObservers(mm,plane,mousestate),this.updateFrameChangedObservers()}}}createarrowbuttons(base,fontsize){if(this.internal.simplemode)return fontsize;let fn=Math.round(2*fontsize);if(fn>30?fn=30:fn<20&&(fn=20),null!==this.internal.arrowbuttons[0]){for(let ind=0;ind<=11;ind++)this.internal.arrowbuttons[ind].css({"font-size":`${fn}px`});return fn}const self=this;let symbols=["glyphicon glyphicon-chevron-left","glyphicon glyphicon-pause","glyphicon glyphicon-play","glyphicon glyphicon-chevron-right","glyphicon glyphicon-fast-backward","glyphicon glyphicon-fast-forward"],arrowcallback=function(e){let elem=$(e.target);elem.css({"background-color":"#000000"});let index=parseInt(elem.attr("index"))||0;const data=self.internal.datgui.data;if(index<=6||9===index){let increase=1;index%2==0&&(increase=-1);let md=3;index<6&&(md=Math.floor(index/2)),0===md?data.xcoord+=increase:1===md?data.ycoord+=increase:2===md?data.zcoord+=increase:3===md&&(data.tcoord+=increase,data.tcoord<0?data.tcoord=self.internal.maxnumframes-1:data.tcoord>=self.internal.maxnumframes&&(data.tcoord=0));let c=[data.xcoord,data.ycoord,data.zcoord,data.tcoord];self.setcoordinates(c)}else if(index>9){let rate=data.rate||20;11===index?rate+=5:rate-=5,rate<5?rate=5:rate>50&&(rate=50),data.rate=rate}else self.playStopMovie(8===index);setTimeout(()=>{elem.css({"background-color":"#444444"})},100)};for(let ind=0;ind<=11;ind++){let symindex=0;ind<6?ind%2==1&&(symindex=3):symindex=ind-6;let a=`<span index="${ind}" class="${symbols[symindex]}"></span>`;this.internal.arrowbuttons[ind]=$(a),this.internal.arrowbuttons[ind].css({"font-size":`${fn}px`,left:"100px",top:"0px",padding:"3px","border-radius":"10px","background-color":"#444444",color:"#cc6600",position:"absolute","z-index":"20",visibility:"hidden"}),base.append(this.internal.arrowbuttons[ind]),this.internal.arrowbuttons[ind].click(e=>{e.preventDefault(),arrowcallback(e)})}return fn}hidearrowbuttons(beg=0){for(let i=beg;i<=11;i++)this.internal.arrowbuttons[i]&&this.internal.arrowbuttons[i].css({visibility:"hidden"})}handleSeparator(e,mode,modifyCallbacks){if(!this.internal.midlinepresent)return!1;let data=this.internal.midlinedata;if(mode>=1&&data.origx<0)return!1;e.preventDefault();let x=e.pageX,cnv=this.internal.midline,cnv2=this.internal.midline2;if(0===mode)return cnv.css({left:`${data.left-3}px`,width:"9px"}),cnv2.css({left:`${data.left-4}px`}),data.origx=x,$("body").append(this.internal.midlinemessage),setTimeout(()=>{this.internal.midlinemessage.remove()},2e3),modifyCallbacks(1),!0;let offset=this.internal.layoutcontroller.getviewerleft(),vw=this.internal.layoutcontroller.getviewerwidth(),minl=.1*vw,maxl=.9*vw;if(1===mode&&data.origx>=0){(x-=offset)<minl?x=minl:x>=maxl&&(x=maxl);let shift=(x+=offset)-data.origx,l=data.left+shift;return cnv.css({left:`${l-3}px`}),cnv2.css({left:`${l-5}px`}),!0}if(2===mode){cnv.css({width:"1px"});let shiftx=x-data.origx,newclear=(data.left+shiftx-offset)/(data.left-offset)*this.cleararea[0];return newclear>.45&&newclear<.55?newclear=.5:newclear<.1?newclear=.1:newclear>.9&&(newclear=.9),data.left=(data.left-offset)*(newclear/this.cleararea[0])+offset,data.origx=-1,modifyCallbacks(2),setTimeout(()=>{this.setDualViewerMode(newclear)},10),!0}}createmidline(parentcanvas,dw,dh){if(!(this.is_slave_viewer&&this.cleararea[1]<.95&&this.cleararea[1]>.05))return void(this.internal.midlinepresent&&(this.internal.midline.remove(),this.internal.midline2.remove(),this.internal.midlinepresent=!1));const self=this;let modifyCallbacks=null,downC=function(e){self.handleSeparator(e,0,modifyCallbacks)},moveC=function(e){self.handleSeparator(e,1,modifyCallbacks)},upC=function(e){self.handleSeparator(e,2,modifyCallbacks)};if(modifyCallbacks=function(add=0){let cnv2=self.internal.midline2,par=$(parentcanvas).parent().parent();0===add?cnv2[0].addEventListener("mousedown",downC):1===add?(par[0].addEventListener("mousemove",moveC),par[0].addEventListener("mouseup",upC),par[0].addEventListener("mouseleave",upC)):2===add&&(par[0].removeEventListener("mousemove",moveC),par[0].removeEventListener("mouseup",upC),par[0].removeEventListener("mouseleave",upC))},!this.internal.midline){let cnv=$("<div></div>");this.internal.midline=cnv,cnv.css({position:"absolute",top:"0px","z-index":650}),this.internal.midline2=$('<div style="cursor:ew-resize"></div>'),this.internal.midline2.css({position:"absolute",top:"0px","z-index":641}),this.internal.midlinemessage=$(`<div align="center" style="padding:2px; width:50vw; left:25vw; top:${top}px; height:40px;border-radius:30px;background-color:#884400; z-index:5000; position: absolute; color:#ffffff"><H4>Drag the line to adjust the relative width of the two viewers</H4></div>`),modifyCallbacks(0)}this.internal.midlinedata.origx=-1;let left=this.internal.layoutcontroller.getviewerleft();if(this.internal.midlinedata.left=this.cleararea[0]*dw+left,this.internal.midlinedata.height=dh,!this.internal.midlinepresent){let par=$(parentcanvas).parent().parent();par.append(this.internal.midline),par.append(this.internal.midline2),this.internal.midlinepresent=!0}let tp=this.internal.layoutcontroller.getviewertop();this.internal.midline.css({height:`${dh}px`,top:`${tp}px`,width:"3px",left:`${this.internal.midlinedata.left-1}px`,"background-color":"rgba(128,128,128,1.0)"}),this.internal.midline2.css({height:`${dh}px`,top:`${tp}px`,width:"11px",left:`${this.internal.midlinedata.left-5}px`,"background-color":"rgba(10,10,10,0.1)"})}drawlabels(){if(null===this.internal.volume)return;var context=this.internal.layoutcontroller.context,dw=context.canvas.width,dh=context.canvas.height;context.clearRect(Math.floor(this.cleararea[0]*dw),0,Math.floor(this.cleararea[1]*dw),dh);let cdim=$(context.canvas).css(["width","height","left","top"]);var labels=[["A","P","S","I"],["R","L","S","I"],["R","L","A","P"]],names=["Sagittal","Coronal","Axial"],axes=["-jk","-ik","-ij"],fnsize=0;fnsize=this.internal.simplemode?Math.round(2*webutil.getfontsize(context.canvas)/3):Math.round(webutil.getfontsize(context.canvas)*this.cleararea[1]),context.font=fnsize+"px Arial",this.internal.simplemode?context.fillStyle="#884400":context.fillStyle="#cc6600";let arrowsize=this.createarrowbuttons($(context.canvas).parent().parent(),fnsize);if(this.createmidline(context.canvas,dw,dh),!1!==this.internal.showdecorations){for(var invorientaxis=this.internal.volume.getOrientation().invaxis,orientaxis=this.internal.volume.getOrientation().axis,pl=0;pl<=3;pl++){var trueplane=invorientaxis[pl],lab=labels[trueplane],vp=this.internal.subviewers[pl].controls.normViewport;if((vp.x1-vp.x0)*dw>200){if(pl<=2){let dx=.25*vp.shiftx*dw;dx>120&&(dx=120);let dy=.25*vp.shifty*dh;dy>50&&(dy=50);let xshift=[-(2+dx),dx-(arrowsize+1)],xshift0=[-(2+dx),dx+2],ymid=Math.round(dh*(1-.5*(vp.y0+vp.y1))+6),xmin=vp.x0*dw+xshift0[0];xmin<2&&(xmin=2);let xmax=vp.x1*dw+xshift0[1];xmax>dw-2&&(xmax=dw-2),context.textBaseline="middle",context.textAlign="start",context.fillText(lab[0],xmin,ymid),context.textAlign="end",context.fillText(lab[1],xmax,ymid);let xmid=Math.round(.5*dw*(.5*vp.x0+1.5*vp.x1)-6),ymin=Math.round((1-vp.y1)*dh)-dy;ymin<fnsize+2&&(ymin=fnsize+2);let ymax=Math.round((1-vp.y0)*dh)+dy;ymax>.9*dh&&(ymax=.9*dh),context.textAlign="center",context.textBaseline="top",context.fillText(lab[2],xmid,ymin),context.textBaseline="alphabetic",context.fillText(lab[3],xmid,ymax);let name=names[trueplane]+axes[orientaxis[trueplane]];if(context.textAlign="start",context.fillText(name,xmin,ymin),!this.internal.simplemode){let wd=Math.round(parseInt(cdim.width)),lf=Math.round(parseInt(cdim.left)),left=this.internal.layoutcontroller.getviewerleft(),l=[Math.round(vp.x0*wd+lf+xshift[0]+left),Math.round(vp.x1*wd+lf+xshift[1])+left];l[0]<0&&(l[0]=0);let h=Math.round((1-(.75*vp.y1+.25*vp.y0))*parseInt(cdim.height))+parseInt(cdim.top);for(let k=0;k<=1;k++)this.internal.arrowbuttons[2*pl+k].css({left:`${l[k]}px`,top:`${h}px`,visibility:"visible"})}}this.internal.simplemode?context.strokeStyle="#dddddd":context.strokeStyle="#222222",context.lineWidth=1,context.beginPath(),3===pl&&(vp=this.internal.subviewers[pl].controls.normViewport.old),context.moveTo(vp.x0*dw,(1-vp.y0)*dh),context.lineTo(vp.x0*dw,(1-vp.y1)*dh),context.lineTo(vp.x1*dw,(1-vp.y1)*dh),context.lineTo(vp.x1*dw,(1-vp.y0)*dh),context.lineTo(vp.x0*dw,(1-vp.y0)*dh),context.stroke()}else if(pl<3)for(let ia=0;ia<=1;ia++)this.internal.arrowbuttons[2*pl+ia]&&this.internal.arrowbuttons[2*pl+ia].css({visibility:"hidden"})}if(!this.internal.simplemode)if(this.internal.maxnumframes<2||dw<500)for(let ia=6;ia<=11;ia++)this.internal.arrowbuttons[ia]&&this.internal.arrowbuttons[ia].css({visibility:"hidden"});else{let lh=this.internal.layoutcontroller.getviewerheight(),left=this.internal.layoutcontroller.getviewerleft(),y0=.92*lh+parseInt(cdim.top);for(let k=0;k<=5;k++){let extra=0;k>3&&(extra=20),this.internal.arrowbuttons[6+k].css({left:`${50+40*k+left+extra}px`,top:`${y0}px`,visibility:"visible"})}}}else this.hidearrowbuttons()}handleresize(){super.handleresize(),this.setrendermode(this.internal.rendermode,!0),this.drawcrosshairs(),this.updateResizeObservers(),this.drawtext(),this.drawcolorscale()}setrendermode(mode,force){if(force=force||!1,((mode=mode||0)!==this.internal.rendermode||!1!==force)&&null!==this.internal.subviewers[0]){var invorientaxis=[0,1,2];null!==this.internal.volume&&(invorientaxis=this.internal.volume.getOrientation().invaxis),this.internal.rendermode=util.range(mode,0,this.internal.viewports.length-1);for(var pl=0;pl<this.internal.subviewers.length;pl++){var trueplane=pl;pl<=2&&(trueplane=invorientaxis[pl]);var vp0=this.internal.viewports[this.internal.rendermode][trueplane],vp={x0:vp0.x0,x1:vp0.x1,y0:vp0.y0,y1:vp0.y1},ratio=1,fullw=this.internal.layoutcontroller.canvas.width*(vp.x1-vp.x0),fullh=this.internal.layoutcontroller.canvas.height*(vp.y1-vp.y0);if(vp.old=vp0,fullw>fullh){ratio=fullh/fullw;var midx=.5*(vp.x0+vp.x1),scalemidx=midx*ratio;vp.x0=ratio*vp.x0+(midx-scalemidx),vp.x1=ratio*vp.x1+(midx-scalemidx),vp.shiftx=midx-scalemidx,vp.shifty=0}else if(fullh>fullw){ratio=fullw/fullh;var midy=.5*(vp.y0+vp.y1),scalemidy=midy*ratio;vp.y0=ratio*vp.y0+(midy-scalemidy),vp.y1=ratio*vp.y1+(midy-scalemidy),vp.shifty=midy-scalemidy,vp.shiftx=0}this.internal.subviewers[pl].controls.normViewport=vp}this.drawlabels(),this.drawcolorscale()}}getimage(){return this.internal.volume}setimage(volume){const self=this;this.disable_renderloop();let samesize=!1;null!==this.internal.volume&&null!==volume&&(samesize=this.internal.volume.hasSameSizeAndOrientation(volume)),volume.getDimensions()[3]>1&&(samesize=!1),null!==this.internal.volume&&this.deleteoldimage(samesize),this.internal.volume=volume,!1===samesize&&(this.internal.imagedim=volume.getDimensions(),this.internal.imagespa=volume.getSpacing(),this.internal.maxspa=this.internal.imagespa[2],this.remapDimensionsTo4D(this.internal.imagedim)),this.internal.maxnumframes=this.internal.imagedim[3];let imagesize=volume.getImageSize(),d=1,i=0;for(i=0;i<=2;i++)imagesize[i]>d&&(d=imagesize[i]),!1===samesize&&(this.internal.slicecoord[i]=Math.floor(this.internal.imagedim[i]/2)),this.internal.imagespa[i]>this.internal.maxspa&&(this.internal.maxspa=this.internal.imagespa[i]);!1===samesize&&(this.internal.slicecoord[3]=0);let s_width=Math.round(.667*d),s_depth=Math.round(2*d);!1===samesize&&(this.internal.rendermode=0);let imagerange=volume.getIntensityRange();this.internal.imagetransferfunction=util.mapstepcolormapfactory(imagerange[0],imagerange[1],255);let opacity=.8;if(this.internal.simplemode&&(opacity=.4),null===this.internal.cmapcontroller){let colormapid=this.getAttribute("bis-colormapeditorid");this.internal.cmapcontroller=document.querySelector(colormapid)}for(this.internal.cmapcontroller.setimage(this.internal.volume,function(i){self.updatetransferfunctions(i)},opacity),this.internal.slices=[null,null,null,null],!1===samesize&&(this.internal.subviewers=[null,null,null,null]),i=0;i<=2;i++)this.internal.slices[i]=bis3dOrthogonalSlice.create2dslice(this.internal.volume,i,2),this.internal.slices[i].setsliceno(this.internal.slicecoord[i],this.internal.slicecoord[3],this.internal.imagetransferfunction,!0),!1===samesize?this.internal.subviewers[i]=this.createsliceview(this.internal.layoutcontroller.renderer,this.internal.volume,this.internal.slices[i],s_width,s_depth):this.internal.slices[i].addtoscene(this.internal.subviewers[i].scene);let drawimages=!0;if(this.internal.simplemode&&(drawimages=!1),this.internal.slices[3]=bis3dOrthogonalSlice.create3cardslice(this.internal.volume,this.internal.slices,!0,!1,drawimages),!1===samesize?this.internal.subviewers[3]=this.createcardview(this.internal.layoutcontroller.renderer,this.internal.volume,this.internal.slices[3],s_width,s_depth):this.internal.slices[3].addtoscene(this.internal.subviewers[3].scene),this.enable_renderloop(),this.renderloop(),!1===samesize){let mousefn=function(coords,plane,mousestate){let c=[coords[0],coords[1],coords[2]];self.updatescene(c,plane,mousestate)};for(let j=0;j<this.internal.subviewers.length;j++)this.internal.subviewers[j].controls.coordinateChangeCallback=mousefn;this.setrendermode(this.internal.rendermode,!0)}return this.drawcrosshairs(),this.drawlabels(),this.createdatgui(samesize),this.initializeMouseObservers(samesize),!1===samesize&&(this.internal.imagedim[2]<2&&(this.internal.rendermode=3),this.handleresize()),this.updateImageChangedObservers("image"),!0}setobjectmap(ovolume,plainmode,colormapmode){null===this.setObjectMapFunction?this.setobjectmap_internal(ovolume,plainmode,colormapmode):this.setObjectMapFunction(ovolume,plainmode,colormapmode)}setobjectmap_internal(ovolume,plainmode,colormapmode){if(this.disableClustering(),colormapmode=colormapmode||"Auto",null===plainmode&&(plainmode="Objectmap"===colormapmode),null===this.internal.volume)return bootbox.alert("can not load objectmap if no image is in memory"),!1;var orient1=this.internal.volume.getOrientationName(),orient2=ovolume.getOrientationName();if(orient1!==orient2)return bootbox.alert("Loaded objectmap from has a different orientation ("+orient2+" vs "+orient1+") than currently loaded image"),!1;plainmode=plainmode||!1;var i=0;this.deleteoldobjectmap(),this.internal.objectmap=ovolume,this.internal.objectmapspa=this.internal.objectmap.getSpacing();var odim=this.internal.objectmap.getDimensions();for(this.remapDimensionsTo4D(odim),this.internal.objectmapnumframes=odim[3],i=0;i<=2;i++){var ci=.5*this.internal.imagedim[i]*this.internal.imagespa[i],co=.5*odim[i]*this.internal.objectmapspa[i];this.internal.objectmapshift[i]=co-ci}this.internal.overlayslices=[null,null,null,null];var objcoord=this.getobjectmapcoordinates();for(this.internal.objectmapnumframes>this.internal.maxnumframes&&(this.internal.maxnumframes=this.internal.objectmapnumframes),i=0;i<=2;i++)this.internal.overlayslices[i]=bis3dOrthogonalSlice.create2dslice(this.internal.objectmap,i,0,!0),this.internal.overlayslices[i].addtoscene(this.internal.subviewers[i].scene),this.internal.overlayslices[i].setsliceinmm(this.internal.slices[i],objcoord[i],this.internal.slicecoord[3],this.internal.objectmaptransferfunction,!0);var drawimages=!0;for(this.internal.simplemode&&(drawimages=!1),this.internal.overlayslices[3]=bis3dOrthogonalSlice.create3cardslice(this.internal.volume,this.internal.overlayslices,!0,!0,drawimages),i=0;i<=2;i++)this.internal.overlayslices[3].updatecoordinatesinmm(this.internal.slices[i],i);return this.internal.overlayslices[3].addtoscene(this.internal.subviewers[3].scene),this.internal.maxnumframes>this.internal.imagedim[3]&&(this.createdatgui(!1),this.drawlabels()),this.internal.cmapcontroller.addobjectmap(this.internal.objectmap,plainmode,colormapmode),this.drawtext(),this.internal.maxnumframes>this.internal.imagedim[3]&&this.drawlabels(),this.updateImageChangedObservers("overlay"),!0}clearobjectmap(){null!==this.internal.objectmap&&(this.deleteoldobjectmap(),this.internal.cmapcontroller.removeobjectmap(),this.internal.objectmaptransferinfo={isfunctional:!1,colormode:"Objectmap"},this.drawtext(),this.updateImageChangedObservers("overlay"))}setcoordinates(coords,plane){for(var c=coords||[this.internal.slicecoord[0],this.internal.slicecoord[1],this.internal.slicecoord[2],this.internal.slicecoord[3]],i=0;i<=2;i++)c[i]=c[i]*this.internal.imagespa[i];0!==plane&&1!==plane&&2!==plane&&(plane=-1),this.updatescene(c,plane,-1,!0),this.updateFrameChangedObservers()}setframe(fr){if(!this.internal.framecontroller)return;let num=this.internal.maxnumframes;fr<0?fr=num-1:fr>=num&&(fr=0);const data=this.internal.datgui.data;this.internal.slicecoord[3]=Math.floor(fr),data.tcoord=this.internal.slicecoord[3],this.setcoordinates(),this.internal.framecontroller.updateDisplay(),this.updateFrameChangedObservers()}getframe(){return this.internal.slicecoord[3]}set3dview(plane,back){0!==plane&&2!==plane&&(plane=1),back=back||!1,null!==this.internal.slices[3]&&null!==this.internal.subviewers[3]&&(this.internal.slices[3].positioncamera(this.internal.subviewers[3].camera,plane,back),this.internal.layoutcontroller.renderer.render(this.internal.subviewers[3].scene,this.internal.subviewers[3].camera))}createdatgui(samesize=!1){if(samesize){let cmapfolder=this.internal.cmapcontroller.creategui(null);return void(this.internal.simplemode&&cmapfolder.open())}let dpname=["Slices","Sagittal","Coronal","Axial","Slices+3D","3D Only","Simple Mode"],data=this.internal.datgui.data;data.displaymode=dpname[0],this.internal.imagedim[2]<2&&(this.internal.rendermode=3,data.displaymode=dpname[3]),data.decorations=!0,data.xcoord=this.internal.slicecoord[0],data.ycoord=this.internal.slicecoord[1],data.zcoord=this.internal.slicecoord[2],data.tcoord=this.internal.slicecoord[3]||0,data.rate=25,data.playing=!1,data.decorations=this.internal.showdecorations||!0,data.lockcursor=this.internal.lockcursor||!1;let creatingnew=!1,base_widget=this.internal.layoutcontroller.getcorecontrols(this.is_slave_viewer);null===this.internal.datgui.gui&&(this.internal.datgui.gui=new dat_gui__WEBPACK_IMPORTED_MODULE_0__.default.GUI({autoPlace:!1,width:this.internal.domextra}),base_widget.append(this.internal.datgui.gui.domElement),creatingnew=!0);let gui=this.internal.datgui.gui;const self=this;if(this.internal.simplemode)this.internal.rendermode=7,this.internal.datgui.coords=null;else{if(creatingnew)this.internal.datgui.coords=gui.addFolder("Core");else for(let c=this.internal.datgui.coords.__controllers.length-1;c>=0;c-=1){let elem=this.internal.datgui.coords.__controllers[c];try{this.internal.datgui.coords.remove(elem)}catch(e){}}let dmode=this.internal.datgui.coords.add(data,"displaymode",dpname).name("Mode");this.internal.displaymodes=dpname,dmode.onChange(function(val){let ind=dpname.indexOf(val);6===ind&&(ind=9),self.setrendermode(ind)});let coordchange=function(){let c=[data.xcoord,data.ycoord,data.zcoord,data.tcoord];self.setcoordinates(c)},tcoordchange=function(){let c=[data.xcoord,data.ycoord,data.zcoord,data.tcoord];self.internal.slicecoord[3]=data.tcoord,self.setcoordinates(c)},xcoord=this.internal.datgui.coords.add(data,"xcoord",0,this.internal.imagedim[0]-1).name("I-Coord").step(1),ycoord=this.internal.datgui.coords.add(data,"ycoord",0,this.internal.imagedim[1]-1).name("J-Coord").step(1);xcoord.onChange(coordchange),ycoord.onChange(coordchange),this.internal.imagedim[2]>1&&this.internal.datgui.coords.add(data,"zcoord",0,this.internal.imagedim[2]-1).name("K-Coord").step(1).onChange(coordchange),this.internal.maxnumframes>1&&(this.internal.framecontroller=this.internal.datgui.coords.add(data,"tcoord",0,this.internal.maxnumframes-1).name("Frame/Comp").step(1),this.internal.framecontroller.onChange(tcoordchange)),this.internal.datgui.coords.add(data,"decorations").name("Labels").onChange(function(val){self.internal.showdecorations=val,self.drawlabels(),self.drawcolorscale(),self.setcoordinates()}),this.internal.datgui.coords.add(data,"lockcursor").name("Disable Mouse").onChange(function(val){self.internal.lockcursor=val}),this.internal.datgui.coords.open()}let cgui=gui;creatingnew||(cgui=null);let cmapfolder=this.internal.cmapcontroller.creategui(cgui);if(!creatingnew)return;webutil.removedatclose(gui);let bbar=$("<div></div>");bbar.css({margin:"10px"}),base_widget.append(bbar);let s="Reset Slices";this.internal.simplemode&&(s="Reset 2D/3D Views",cmapfolder.open()),webutil.createbutton({name:s,type:"info",tooltip:"This resets the viewer to default camera positions and zoom level",position:"left",parent:bbar}).click(function(e){e.preventDefault(),self.resetViewers()}),webutil.createbutton({name:"Z-",type:"info",tooltip:"Zoom out",css:{"margin-left":"8px"},position:"left",parent:bbar}).click(function(e){e.preventDefault(),self.zoomViewers(1.1)}),webutil.createbutton({name:"Z+",tooltip:"Zoom in",type:"info",css:{"margin-left":"8px"},position:"left",parent:bbar}).click(function(e){e.preventDefault(),self.zoomViewers(.9)}),webutil.createbutton({name:"?",tooltip:"Info about displayed image(s)",type:"info",css:{"margin-left":"8px"},position:"left",parent:bbar}).click(function(){self.viewerInformation()}),bbar.tooltip()}updatemousecoordinates(mm,plane,mousestate){!0!==this.internal.ignoremouseobservers&&(this.internal.lockcursor||this.updatescene(mm,plane,mousestate))}setRenderMode(mode){return this.setrendermode(mode,!0),this.internal.viewports[this.internal.rendermode]}setViewerMode(in_mode="full",in_size=.5){let mode=super.setViewerMode(in_mode,in_size);if("full"===mode)this.internal.viewports=this.internal.origviewports;else{this.internal.viewports=[];let shift=this.cleararea[0],size=this.cleararea[1];for(let i=0;i<this.internal.origviewports.length;i++){let toadd=[],vp=this.internal.origviewports[i];for(let j=0;j<vp.length;j++){let it=vp[j],newit={x0:it.x0*size+shift,y0:it.y0,x1:it.x1*size+shift,y1:it.y1};toadd.push(newit)}this.internal.viewports.push(toadd)}}return this.setRenderMode(this.internal.rendermode,!0),mode}connectedCallback(){super.connectedCallbackBase()}getElementState(storeImages=!1){let obj=super.getElementState(storeImages);return obj.data=JSON.parse(JSON.stringify(this.internal.datgui.data)),obj}setElementState(dt=null){if(null===dt)return;super.setElementState(dt);let sanedata=JSON.parse(JSON.stringify(this.internal.datgui.data));for(let attr in dt.data)sanedata.hasOwnProperty(attr)&&(sanedata[attr]=dt.data[attr]);try{if(this.internal.displaymodes){let ind=this.internal.displaymodes.indexOf(sanedata.displaymode);ind>=0&&(this.internal.datgui.data.displaymode=this.internal.displaymodes[ind],6===ind&&(ind=9),this.setrendermode(ind))}this.internal.showdecorations=sanedata.decorations,this.internal.lockcursor=sanedata.lockcustor,this.internal.datgui.data.decorations=this.internal.showdecorations,this.internal.datgui.data.lockcursor=this.internal.lockcursor=sanedata.lockcustor,this.setcoordinates([parseInt(sanedata.xcoord),parseInt(sanedata.ycoord),parseInt(sanedata.zcoord),parseInt(sanedata.tcoord)])}catch(e){console.log(e.stack,e)}this.setElementStateCameras(dt),setTimeout(()=>{let gui=this.internal.datgui.coords;if(null!==gui)for(let ia=0;ia<gui.__controllers.length;ia++)gui.__controllers[ia].updateDisplay()},100)}})},"./js/webcomponents/bisweb_painttoolelement.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var dat_gui__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/dat.gui/build/dat.gui.module.js");const util=__webpack_require__("./js/core/bis_util.js"),bisweb_image=__webpack_require__("./js/dataobjects/bisweb_image.js"),UndoStack=__webpack_require__("./js/dataobjects/bis_undostack.js"),imagealgo=__webpack_require__("./js/legacy/bis_imagealgorithms.js"),webutil=__webpack_require__("./js/coreweb/bis_webutil.js"),$=__webpack_require__("jquery"),bootbox=__webpack_require__("./node_modules/bootbox/bootbox.js"),bisweb_apputil=__webpack_require__("./js/coreweb/bisweb_apputilities.js"),biscustom=__webpack_require__("./js/coreweb/bisweb_custommodule.js"),modules=__webpack_require__("./js/modules/moduleindex.js"),biswrap=__webpack_require__("./build/wasm/libbiswasm_wrapper.js"),webfileutil=__webpack_require__("./js/coreweb/bis_webfileutil.js"),inobounce=__webpack_require__("./lib/js/inobounce.js"),BisWebPanel=__webpack_require__("./js/coreweb/bisweb_panel.js"),NUMBUTTONS=[7,30],NUMFIRST=[0,5],SHIFTS=[[1,0,0],[-1,0,0],[0,1,0],[0,-1,0],[0,0,1],[0,0,-1]];webutil.defineElement("bisweb-painttoolelement",class extends HTMLElement{constructor(){super(),this.internal={initialized:!1,this:null,offsets:null,imagedim:null,imagespa:null,volume:null,volumedata:null,objectmap:null,objectmapdata:null,undostack:new UndoStack(100,10),currentundoarray:[],parentDomElement:null,orthoviewer:null,settingviewer:!1,currentvalue:1,lastselectedbutton:null,lasttwocolorbuttons:[null,null],colorbuttons:{},layoutcontroller:null,selectcolormodal:null,overwritecheck:null,threedcheck:null,thresholdcheck:null,connectcheck:null,datgui:null,regdatgui:null,regularizemodal:null,minthreshold:null,maxthreshold:null,data:{enabled:!1,threshold:!1,connect:!1,threed:!1,overwrite:!1,brushsize:3,minth:1,maxth:10,reg_iter:4,reg_smoothness:2,reg_convergence:.1},algoController:null,blockUndo:!1,regularizeModule:null,morphologyModule:null,maskModule:null,thresholdModule:null,defaceModule:null,internalUpdate:!1}}connectedCallback(){let viewerid=this.getAttribute("bis-viewerid"),layoutid=this.getAttribute("bis-layoutwidgetid"),algoid=this.getAttribute("bis-algorithmcontrollerid")||null;this.internal.algocontroller=null,null!==algoid&&(this.internal.algocontroller=document.querySelector(algoid)||null);let in_orthoviewer=document.querySelector(viewerid);this.internal.layoutcontroller=document.querySelector(layoutid),this.panel=new BisWebPanel(this.internal.layoutcontroller,{name:"Paint Tool",dual:!1,permanent:!0,width:"300px"}),$(this.panel.widget).attr("aria-label","bisweb-paint-widget"),this.panel.show(),this.internal.parentDomElement=this.panel.getWidget();var basediv=$("<div>Paint tool will appear once an image is loaded.</div>");this.internal.parentDomElement.append(basediv),this.internal.orthoviewer=in_orthoviewer,this.internal.orthoviewer.addMouseObserver(this),BisWebPanel.setMaxDockedPanels(2)}enableEdit(doenable=!1){!0!==doenable&&(doenable=!1),doenable!==this.internal.data.enabled&&(!1===doenable?this.unselectbutton(this.internal.lastselectedbutton):this.selectbutton(this.internal.lastselectedbutton),this.internal.data.enabled=doenable,this.internal.data.enabled?(this.panel.makeActive(!0),inobounce.enable()):(this.panel.makeActive(!1),inobounce.disable()))}updategui(){}resetundo(){this.internal.undostack.initialize()}applyarray(arr,usethis){var index=0,val=0,i=0;for(i=0;i<arr.length;i+=3)index=arr[i],val=arr[i+usethis],this.internal.objectmapdata[index]=val;this.internal.orthoviewer.updateobjectmapdisplay()}undooperation(){this.internal.currentundoarray.length>0&&(this.internal.undostack.addOperation(this.internal.currentundoarray),this.internal.currentundoarray=[]);var arr=this.internal.undostack.getUndo();return null!==arr&&(this.applyarray(arr,2),!1)}redooperation(){this.internal.currentundoarray.length>0&&(this.internal.undostack.addOperation(this.internal.currentundoarray),this.internal.currentundoarray=[]);var arr=this.internal.undostack.getRedo();return null!==arr&&(this.applyarray(arr,1),!1)}createconnectmask(intensities,x,bounds,minth,maxth){var maskdim=[bounds.x1-bounds.x0+1,bounds.y1-bounds.y0+1,bounds.z1-bounds.z0+1],masksize=maskdim[0]*maskdim[1]*maskdim[2],maskoffsets=[1,maskdim[0],maskdim[0]*maskdim[1]],mask=new Array(masksize),maskindex=x[0]-bounds.x0+(x[1]-bounds.y0)*maskoffsets[1]+(x[2]-bounds.z0)*maskoffsets[2];mask[maskindex]=1;for(var i=0;i<masksize;i++)mask[i]=-1;var stack=[];stack.push([x[0],x[1],x[2]]);for(var testloc=[0,0,0],diff=0,j=0,k=0,center=null,index=0;stack.length>0;)for(center=stack.pop(),j=0;j<=5;j++){for(testloc[0]=util.range(SHIFTS[j][0]+center[0],bounds.x0,bounds.x1),testloc[1]=util.range(SHIFTS[j][1]+center[1],bounds.y0,bounds.y1),testloc[2]=util.range(SHIFTS[j][2]+center[2],bounds.z0,bounds.z1),diff=0,k=0;k<=2;k++)diff+=Math.abs(testloc[k]-center[k]);diff>0&&-1===mask[maskindex=testloc[0]-bounds.x0+(testloc[1]-bounds.y0)*maskoffsets[1]+(testloc[2]-bounds.z0)*maskoffsets[2]]&&(intensities[index=testloc[0]+testloc[1]*this.internal.offsets[1]+testloc[2]*this.internal.offsets[2]]>=minth&&intensities[index]<=maxth?(mask[maskindex]=1,stack.push([testloc[0],testloc[1],testloc[2]])):mask[maskindex]=0)}return mask}dobrushoperation(x,plane){var i,j,k,slice_offset,offset,index,oldv,intensity,mask=null,dothreshold=this.internal.data.threshold,proceed=1,newv=this.internal.currentvalue,maskindex=0,w=Math.floor(this.internal.data.brushsize/2);let bounds={x0:util.range(x[0]-w,0,this.internal.imagedim[0]-1),x1:util.range(x[0]+w,0,this.internal.imagedim[0]-1),y0:util.range(x[1]-w,0,this.internal.imagedim[1]-1),y1:util.range(x[1]+w,0,this.internal.imagedim[1]-1),z0:util.range(x[2]-w,0,this.internal.imagedim[2]-1),z1:util.range(x[2]+w,0,this.internal.imagedim[2]-1)};if(!this.internal.data.threed&&plane>=0&&plane<=2&&(0===plane?(bounds.x0=x[0],bounds.x1=x[0]):1===plane?(bounds.y0=x[1],bounds.y1=x[1]):(bounds.z0=x[2],bounds.z1=x[2])),this.internal.data.connect&&dothreshold){if(!((intensity=this.internal.volumedata[x[0]+x[1]*this.internal.offsets[1]+x[2]*this.internal.offsets[2]])>=this.internal.data.minth&&intensity<=this.internal.data.maxth))return!1;mask=this.createconnectmask(this.internal.volumedata,x,bounds,this.internal.data.minth,this.internal.data.maxth),dothreshold=!1}for(k=bounds.z0;k<=bounds.z1;k++)for(slice_offset=k*this.internal.offsets[2],j=bounds.y0;j<=bounds.y1;j++)for(offset=j*this.internal.offsets[1]+slice_offset,i=bounds.x0;i<=bounds.x1;i++)index=i+offset,null!==mask&&(proceed=mask[maskindex],++maskindex),oldv=this.internal.objectmapdata[index],intensity=this.internal.volumedata[index],proceed>0&&oldv!==newv&&(!0!==this.internal.data.overwrite&&0!==oldv||(!1===dothreshold||intensity>=this.internal.data.minth&&intensity<=this.internal.data.maxth)&&(this.internal.objectmapdata[index]=newv,this.internal.currentundoarray.push(index,newv,oldv)))}smoothoperation(){var newdata=imagealgo.regularizeObjectmap(this.internal.objectmap,this.internal.reg_iter,this.internal.data.reg_smoothness,this.internal.data.reg_convergence).getImageData(),l=newdata.length;this.internal.currentundoarray=[];for(var numchanges=0,i=0;i<l;i++)this.internal.objectmapdata[i]!=newdata[i]&&(this.internal.currentundoarray.push(i,newdata[i],this.internal.objectmapdata[i]),this.internal.objectmapdata[i]=newdata[i],++numchanges);this.internal.undostack.addOperation(this.internal.currentundoarray);var per=util.scaledround(100*numchanges/l,100);webutil.createAlert("Objectmap Regularized "+per+"% voxels changed");const self=this;return setTimeout(function(){self.internal.orthoviewer.updateobjectmapdisplay()},1),!1}smoothoperationyesno(){if(null!==this.internal.objectmap){if(null===this.internal.regularizemodal){var f2=new dat_gui__WEBPACK_IMPORTED_MODULE_0__.default.GUI({autoPlace:!1});f2.add(this.internal.data,"reg_smoothness",[1,2,4,8,16,32]).name("Smoothness"),f2.add(this.internal.data,"reg_iter",[1,2,4,8,12,16]).name("Iterations"),f2.add(this.internal.data,"reg_convergence",[.05,.1,.2,.4]).name("Convergence"),this.internal.regularizemodal=webutil.createmodal("Regularize Objectmap Properties","modal-sm"),this.internal.regularizemodal.body.append(f2.domElement),webutil.removedatclose(f2),this.internal.regularizemodal.close.prop("textContent","Cancel");const self=this;let clb=function(e){e.preventDefault(),webutil.enablebutton(self.internal.regularizemodal.close,!1),webutil.enablebutton(self.internal.regularizemodal.exec,!1);var alert=$('<div class="alert alert-info" role="alert">Regularizing objectmap. See Javascript console for print output.</div>');self.internal.regularizemodal.body.append(alert),setTimeout(function(){self.smoothoperation(),self.internal.regularizemodal.dialog.modal("hide"),alert.remove(),webutil.enablebutton(self.internal.regularizemodal.close,!0),webutil.enablebutton(self.internal.regularizemodal.exec,!0)},10)};this.internal.regularizemodal.exec=webutil.createbutton({type:"danger",name:"Smooth Objectmap",parent:this.internal.regularizemodal.footer}).click(clb)}this.internal.regularizemodal.dialog.modal("show")}else webutil.createAlert("No objectmap in memory!",!0)}saveobjectmap(fname){webutil.inElectronApp()||(fname="objectmap.nii.gz"),fname=fname||this.internal.objectmap.getFilename(),bisweb_apputil.saveImage(this.internal.objectmap,fname,"Objectmap")}safeSetNewObjectmap(in_objmap){const self=this;return new Promise((resolve,reject)=>{if(null!==this.internal.imagedim){for(var dim=in_objmap.getDimensions(),spa=in_objmap.getSpacing(),name=in_objmap.getFilename(),diff=0,i=0;i<=2;i++)diff+=Math.abs(self.internal.imagedim[i]-dim[i]),diff+=Math.abs(self.internal.imagespa[i]-spa[i]);if(diff>.001)reject("Objectmap "+name+" has different dimensions or spacing ("+self.internal.imagedim.join()+" vs"+dim.join()+") than currently loaded image");else{var orient1=self.internal.volume.getOrientationName(),orient2=in_objmap.getOrientationName();orient1===orient2?setTimeout(function(){self.internal.objectmap=in_objmap,self.internal.objectmapdata=self.internal.objectmap.getImageData(),self.internal.settingviewer=!0,console.log("objectmap loaded",self.internal.objectmap.getDescription()),self.setViewerObjectmap(in_objmap,!0,"Objectmap"),self.internal.settingviewer=!1,self.resetundo(),self.updategui(),self.setObjectmapOpacity(.8),resolve("all set")},1):reject("Objectmap "+name+" has different orientation "+orient2+" vs "+orient1+" than currently loaded image")}}else reject("No image in memory can not load/accept objectmap")})}loadobjectmap(evt){const self=this;var infile=evt;try{infile=evt.target.files[0]}catch(e){}if(infile.length<2)return;let img=new bisweb_image;return img.load(infile).then(()=>{self.safeSetNewObjectmap(img).catch(e=>{webutil.createAlert(e,!0)})}).catch(e=>{webutil.createAlert(e,!0)}),!1}createnewobjectmap(){this.resetundo(),this.internal.objectmap=new bisweb_image,this.internal.objectmap.cloneImage(this.internal.volume,{type:"short",numframes:1}),this.internal.objectmapdata=this.internal.objectmap.getImageData();for(var len=this.internal.objectmapdata.length,j=0;j<len;j++)this.internal.objectmapdata[j]=0;this.internal.objectmap.computeIntensityRange(),this.setnewobjectmap(null,!0)}setnewobjectmap(newobj=null,updateviewer=!1){null!==newobj&&(this.internal.objectmap=newobj),this.internal.imagedim=this.internal.objectmap.getDimensions(),this.internal.offsets=[1,this.internal.imagedim[0],this.internal.imagedim[0]*this.internal.imagedim[1]],this.internal.imagespa=this.internal.objectmap.getSpacing(),this.internal.objectmapdata=this.internal.objectmap.getImageData();const self=this;updateviewer&&setTimeout(function(){self.setViewerObjectmap(self.internal.objectmap,!0,!1),self.updategui()},100)}createnewobjectmapyesno(){if(null===this.internal.objectmap)return;const self=this;return bootbox.confirm("Are you sure you want to delete current objectmap and create a new empty one?",function(result){!0===result&&self.createnewobjectmap()}),!1}unselectbutton(btn){null!==btn&&btn.css({"border-radius":"0px","border-color":"#000000"})}selectbutton(btn){if(null!==btn){btn.css({"border-radius":"30px","border-color":"#ffffff"}),btn.blur(),this.internal.lastselectedbutton=btn;var val=parseInt(btn.attr("bis"))||0;this.internal.currentvalue=val,val>1e3&&(val-=1e3)}}colorbuttonpressed(evt){var btn=$(evt.target);if(null!==(btn||null)){null!==this.internal.lastselectedbutton&&this.unselectbutton(this.internal.lastselectedbutton);var val=parseInt(btn.attr("bis"))||0,selected=null;if(val>1e3){val-=1e3;var b=btn.css("backgroundColor"),f=btn.css("color"),t=btn.prop("textContent");t=t.slice(1,t.length-1).trim();var title=""+val;this.internal.lasttwocolorbuttons[0].attr({bis:title}),this.internal.lasttwocolorbuttons[0].prop("textContent",t),this.internal.lasttwocolorbuttons[0].css({"background-color":b,color:f}),selected=this.internal.lasttwocolorbuttons[0];var tmp=this.internal.lasttwocolorbuttons[1];this.internal.lasttwocolorbuttons[1]=this.internal.lasttwocolorbuttons[0],this.internal.lasttwocolorbuttons[0]=tmp}else selected=btn;return this.selectbutton(selected),!1}}onDemandCreateGUI(){if(null===this.internal.parentDomElement)return;this.internal.parentDomElement.empty();let basediv=webutil.creatediv({parent:this.internal.parentDomElement}),sbar=webutil.createbuttonbar({parent:basediv}),sbar2=webutil.createbuttonbar({parent:basediv});const self=this;this.internal.enablecheck=webutil.createcheckbox({name:"Enable",type:"danger",checked:this.internal.data.enabled,parent:sbar,callback:function(sel){self.enableEdit(sel)},css:{"margin-right":"10px"}}),this.internal.overwritecheck=webutil.createcheckbox({name:"Overwrite",checked:this.internal.data.overwrite,parent:sbar,css:{"margin-right":"10px"},callback:function(sel){self.internal.data.overwrite=sel}}),this.internal.threedcheck=webutil.createcheckbox({name:"3D Brush",checked:this.internal.data.threed,parent:sbar,css:{"margin-right":"5px"},callback:function(sel){self.internal.data.threed=sel}}),this.internal.thresholdcheck=webutil.createcheckbox({name:"Threshold",checked:this.internal.data.threshold,parent:sbar2,css:{"margin-right":"10px"},callback:function(sel){self.internal.data.threshold=sel,sel||!0!==self.internal.data.connect||(self.internal.data.connect=!1,self.internal.connectcheck.prop("checked",!1))}}),this.internal.connectcheck=webutil.createcheckbox({name:"Connect",checked:this.internal.data.connect,css:{"margin-right":"10px"},parent:sbar2,callback:function(sel){self.internal.data.connect=sel,sel&&!1===self.internal.data.threshold&&(self.internal.data.threshold=!0,self.internal.thresholdcheck.prop("checked",!0))}});var f1=new dat_gui__WEBPACK_IMPORTED_MODULE_0__.default.GUI({autoPlace:!1});basediv.append(f1.domElement);var c1=f1.addFolder("Brush Parameters");c1.add(this.internal.data,"brushsize",1,25).name("Brush Size").step(1);var r=this.internal.volume.getIntensityRange();this.internal.data.minth=r[0],this.internal.data.maxth=r[1],this.internal.minthreshold=c1.add(this.internal.data,"minth",r[0],r[1]).name("Min Threshold"),this.internal.maxthreshold=c1.add(this.internal.data,"maxth",r[0],r[1]).name("Max Threshold"),c1.open();var elem1=webutil.creatediv({parent:basediv,css:{"margin-top":"20px","margin-left":"10px"}});webutil.removedatclose(f1);var cmap=util.objectmapcolormap,modal=webutil.createmodal("Select Object/Color");this.internal.selectcolormodal=modal.dialog;const colorcallback=function(e){e.preventDefault(),self.colorbuttonpressed(e)};for(var pass=0;pass<=1;pass++)for(var min=NUMFIRST[pass],i=min;i<NUMBUTTONS[pass]+min;i++){for(var cl=[cmap[i][0],cmap[i][1],cmap[i][2]],hexcolor=util.rgbToHex(cl[0],cl[1],cl[2]),k=0;k<=2;k++)cl[k]<128?cl[k]=255:cl[k]=0;var hexcolor2=util.rgbToHex(cl[0],cl[1],cl[2]),name=""+i,epar=elem1,attr=i,tooltip=null;if(1==pass){var jn="",kn="";i<100&&(jn=" "),i<10&&(kn=" "),name="["+jn+i+kn+"]",epar=modal.body,attr=i+1e3,tooltip=""+i}this.internal.colorbuttons[attr]=webutil.createbutton({name:name,attr:attr,type:"color-btn",parent:epar,tooltip:tooltip,css:{"background-color":hexcolor,"font-family":"monospace","border-color":"#000000","border-radius":"0px",color:hexcolor2},callback:colorcallback})}this.internal.lasttwocolorbuttons[0]=this.internal.colorbuttons[NUMBUTTONS[0]-1],this.internal.lasttwocolorbuttons[1]=this.internal.colorbuttons[NUMBUTTONS[0]-2],!0===this.internal.data.enabled?this.selectbutton(this.internal.colorbuttons[1]):this.internal.lastselectedbutton=this.internal.colorbuttons[1],webutil.createbutton({name:"..",type:"info",parent:elem1,position:"top",tooltip:"Click here to select more colors",css:{"margin-left":"0px"},callback:()=>{this.internal.selectcolormodal.modal("show")}});var bbar0=webutil.createbuttonbar({parent:basediv,css:{"margin-top":"20px","margin-bottom":"10px"}});webutil.createbutton({type:"warning",name:"Undo",position:"bottom",tooltip:"Click this to undo the last edit operation.",parent:bbar0,callback:function(){self.undooperation()}}),webutil.createbutton({type:"info",name:"Redo",position:"bottom",tooltip:"Click this to redo the last edit operation.",parent:bbar0,callback:function(){self.redooperation()}}),webutil.tooltip(this.internal.parentDomElement),webutil.tooltip(modal.body)}initialize(subviewers,volume,samesize=!1){this.internal.volume=volume,this.internal.volumedata=volume.getImageData(),samesize?this.setnewobjectmap(null,!0):(this.resetundo(),this.createnewobjectmap()),this.onDemandCreateGUI(),this.updategui(),this.internal.thresholdModule&&this.internal.thresholdModule.createOrUpdateGUI(),this.internal.morphologyModule&&this.internal.morphologyModule.createOrUpdateGUI(),this.internal.regularizeModule&&this.internal.regularizeModule.createOrUpdateGUI(),this.internal.maskModule&&this.internal.maskModule.createOrUpdateGUI(),this.internal.defaceModule&&this.internal.defaceModule.createOrUpdateGUI()}updatemousecoordinates(mm,plane,mousestate){if(null===this.internal.imagespa)return;let good=!0,x=[0,0,0];for(let i=0;i<=2;i++)x[i]=Math.round(mm[i]/this.internal.imagespa[i]),(x<0||x>=this.internal.imagedim[i])&&(good=!1);if(this.internal.morphologyModule&&good&&this.internal.morphologyModule.updateCrossHairs(x),!this.panel.isOpen())return;if(void 0===mousestate||null===this.internal.objectmap||!1===this.internal.data.enabled)return;if(-1===mousestate)return;if(2===mousestate&&(this.internal.undostack.addOperation(this.internal.currentundoarray),this.internal.currentundoarray=[],2===mousestate))return;0===mousestate&&(this.internal.currentundoarray.length>0&&this.internal.undostack.addOperation(this.internal.currentundoarray),this.internal.currentundoarray=[]);const self=this,clb=function(){self.internal.orthoviewer.updateobjectmapdisplay()};return good?(this.dobrushoperation(x,plane),0===mousestate&&setTimeout(clb,1),!1):void 0}createMenu(parent){const self=this;webutil.createMenuItem(parent,"Clear Objectmap",function(){self.createnewobjectmapyesno()}),webutil.createMenuItem(parent,""),webfileutil.createFileMenuItem(parent,"Load Objectmap",function(f){self.loadobjectmap(f)},{title:"Load Objectmap Image",save:!1,suffix:"NII"}),webfileutil.createFileMenuItem(parent,"Save Objectmap",function(f){!function(f){console.log(f),self.saveobjectmap(f)}(f)},{title:"Save Objectmap",save:!0,filters:"NII",suffix:"NII"}),webutil.createMenuItem(parent,"")}setObjectmapOpacity(val){setTimeout(()=>{let cmapcontrol=this.internal.orthoviewer.getColormapController(),elem=cmapcontrol.getElementState();elem.opacity=val,cmapcontrol.setElementState(elem),cmapcontrol.updateTransferFunctions(!0)},10)}addTools(tmenu){const self=this;return this.internal.orthoviewer.setObjectMapFunction=function(f){self.setobjectmapimage(f)},new Promise(resolve=>{if(this.internal.algocontroller){const self=this;this.internal.algocontroller.sendImageToViewer=function(input,options){"overlay"===(options.viewersource||"image")?self.safeSetNewObjectmap(input).catch(e=>{webutil.createAlert(e,!0)}):(self.internal.orthoviewer.setimage(input),self.setObjectmapOpacity(.5))};let moduleoptions={numViewers:0,dual:!1,name:"Create Objectmap"};this.internal.thresholdModule=biscustom.createCustom(this.internal.layoutcontroller,this.internal.algocontroller,new modules.binaryThresholdImage,moduleoptions),webutil.createMenuItem(tmenu,moduleoptions.name,function(){self.internal.thresholdModule.show()}),biswrap.initialize().then(()=>{if(biswrap.uses_gpl()){moduleoptions.name="Deface Head Image";let mod=new modules.defaceImage;mod.outputmask=!0,this.internal.defaceModule=biscustom.createCustom(this.internal.layoutcontroller,this.internal.algocontroller,mod,moduleoptions),webutil.createMenuItem(tmenu,moduleoptions.name,function(){self.internal.defaceModule.show()}),webutil.createMenuItem(tmenu,""),moduleoptions.name="Morphology Operations",this.internal.morphologyModule=biscustom.createCustom(this.internal.layoutcontroller,this.internal.algocontroller,new modules.morphologyFilter,moduleoptions),webutil.createMenuItem(tmenu,moduleoptions.name,()=>{self.internal.morphologyModule.show()}),moduleoptions.name="Regularize Objectmap",this.internal.regularizeModule=biscustom.createCustom(this.internal.layoutcontroller,this.internal.algocontroller,new modules.regularizeObjectmap,moduleoptions),webutil.createMenuItem(tmenu,moduleoptions.name,function(){self.internal.regularizeModule.show()}),webutil.createMenuItem(tmenu,""),moduleoptions.name="Mask Image",this.internal.maskModule=biscustom.createCustom(this.internal.layoutcontroller,this.internal.algocontroller,new modules.maskImage,moduleoptions),webutil.createMenuItem(tmenu,moduleoptions.name,function(){self.internal.maskModule.show()})}resolve()})}else resolve()})}setViewerObjectmap(vol,plainmode,alert){!1!==alert&&webutil.createAlert("Objectmap loaded from "+vol.getDescription()),plainmode=plainmode||!1,this.internal.orthoviewer.setobjectmap_internal(vol,plainmode)}setobjectmapimage(img){this.safeSetNewObjectmap(img).catch(e=>{webutil.createAlert(e,!0)})}})},"./js/webcomponents/bisweb_paravisionapplicationelement.js":function(module,exports,__webpack_require__){"use strict";const webutil=__webpack_require__("./js/coreweb/bis_webutil.js"),FastClick=__webpack_require__("./node_modules/fastclick/lib/fastclick.js"),ViewerApplicationElement=__webpack_require__("./js/webcomponents/bisweb_mainviewerapplication.js"),userPreferences=__webpack_require__("./js/core/bisweb_userpreferences.js"),bisgenericio=__webpack_require__("./js/core/bis_genericio.js");webutil.defineElement("bisweb-paravisionapplication",class extends ViewerApplicationElement{connectedCallback(){const self=this,menubarid=this.getAttribute("bis-menubarid"),importid=this.getAttribute("bis-paravisionimportid"),managerid=this.getAttribute("bis-modulemanagerid")||null;let modulemanager=null;null!==managerid&&(modulemanager=document.querySelector(managerid));const PARATOOL=document.querySelector(importid);this.findViewers(),this.VIEWERS[0].finalizeTools();let menubar=document.querySelector(menubarid).getMenuBar(),fmenu=this.createFileAndOverlayMenus(menubar,null);this.createApplicationMenu(fmenu);let editmenu=this.createEditMenu(menubar);this.createAdvancedTransferTool(modulemanager,editmenu),this.createDisplayMenu(menubar,null),null!==modulemanager&&modulemanager.initializeElements(menubar,self.VIEWERS).then(menus=>{userPreferences.safeGetItem("internal").then(f=>{if(f){let misactool=document.createElement("bisweb-misactool"),algoid=this.getAttribute("bis-algorithmcontrollerid");misactool.setAttribute("bis-algorithmcontrollerid","#"+algoid),document.body.appendChild(misactool);let regmenu=menus[3]||editmenu;webutil.createMenuItem(regmenu,""),misactool.addtomenu(regmenu)}})}),this.createHelpMenu(menubar),new FastClick(document.body),webutil.createDragAndCropController(function(files){let f=files[0].path||null;if(null===f)return;if(f.length<2)return;let ext=f.split(".").pop();"json"==ext?PARATOOL.importjob(f):"gz"===ext?this.loadImage(f,0):"2dseq"===bisgenericio.getBaseName(f)?PARATOOL.importfiles(f):bisgenericio.isDirectory(f).then(m=>{!0===m?PARATOOL.importfiles(f):webutil.createAlert("Can not process file "+f,!0)}).catch(()=>{webutil.createAlert("Can not process file "+f,!0)})}),this.num_independent_viewers>1&&self.VIEWERS[1].setDualViewerMode(.5)}})},"./js/webcomponents/bisweb_paravisionimportelement.js":function(module,exports,__webpack_require__){const BisWebImage=__webpack_require__("./js/dataobjects/bisweb_image.js"),bisbruker=__webpack_require__("./js/legacy/bis_asyncreadbruker.js"),webutil=__webpack_require__("./js/coreweb/bis_webutil.js"),bisgenericio=__webpack_require__("./js/core/bis_genericio.js"),$=__webpack_require__("jquery"),bootbox=__webpack_require__("./node_modules/bootbox/bootbox.js"),userPreferences=__webpack_require__("./js/core/bisweb_userpreferences.js"),misac=__webpack_require__("./js/node/misac_util.js"),webfileutil=__webpack_require__("./js/coreweb/bis_webfileutil.js"),BisWebPanel=__webpack_require__("./js/coreweb/bisweb_panel.js"),imagelabels=["None","3DAnatomical","2DAnatomical","EPI","FieldMap","Angio","AngioAnatomical","DTI","DTIResult","Computed","Anatomical","Functional","Other"];webutil.defineElement("bisweb-paravisionimportelement",class extends HTMLElement{constructor(){super(),this.internal={initialized:!1,this:null,viewers:[],table:null,buttonpairs:{},showpanel:null,joblist:[],lastfilename:""},this.layoutcontroller=null}onDemandCreateGUI(){const internal=this.internal;if(null===internal.parentDomElement)return;internal.showpanel=new BisWebPanel(this.layoutcontroller,{name:"Converted Images",width:370,mode:"sidebar",dual:!0});let templates=webutil.getTemplates();internal.parentDomElement.empty();let basediv0=webutil.creatediv({parent:internal.parentDomElement}),basediv1=webutil.creatediv({parent:internal.parentDomElement});internal.domElement=basediv1;let newid=webutil.createWithTemplate(templates.bisscrolltable,$("body")),stable=$("#"+newid),thead=stable.find(".bisthead"),tbody=stable.find(".bistbody");thead.empty(),tbody.empty(),internal.showpanel.getWidget().append(stable),tbody.css({"font-size":"12px","user-select":"none"}),thead.css({"font-size":"12px","user-select":"none"});let hd=$('<tr> <td width="10%">#</th> <td width="80%">Image</th> <td width="10%"></th></tr>');thead.append(hd),thead.css({font:"Arial 12px"}),internal.table=tbody;let hd2=$('<tr> <td width="10%"></th> <td width="80%">Nothing imported yet!</th> <td width="10%"></th></tr>');tbody.append(hd2);const self=this;webutil.createbutton({type:"info",name:"Show Results",tooltip:"Show Converted Images",parent:basediv1,css:{width:"90%",margin:"3px"},callback:function(){internal.showpanel.show()}}),userPreferences.safeGetItem("internal").then(f=>{f&&webutil.createbutton({type:"info",name:"Compute Averages",position:"danger",parent:basediv1,css:{width:"90%",margin:"3px"},callback:function(){self.computeAverageImages1()}})}),webfileutil.createFileButton({type:"danger",name:"Import Images from Paravision Study",parent:basediv0,css:{width:"90%",margin:"3px"},callback:function(f){self.importfiles(f)}},{title:"Directory to import study from",filters:"DIRECTORY",suffix:"DIRECTORY",save:!1}),webfileutil.createFileButton({type:"default",name:"Load Existing Job",parent:basediv0,css:{width:"90%",margin:"3px"},callback:function(f){self.importjob(f)}},{filters:[{name:"JSON Files",extensions:["json"]}],title:"Select the file to load from",save:!1,suffix:".json"}),webfileutil.createFileButton({type:"primary",name:"Save",parent:basediv0,css:{width:"90%",margin:"3px"},callback:function(f){self.savejob(f)}},{filters:[{name:"JSON Files",extensions:["json"]}],title:"Select the file to save to",save:!0,suffix:"json"}),"electron"!==bisgenericio.getmode()&&setTimeout(()=>{bootbox.alert('<H4> For your information</H4> <p>Since you running this appication as a web-application, you will need to:</p> <UL> <LI>  Start an instance of the BioImage Suite Web File Server to allow you to access files from disk directly. </LI><LI> Set this as the file source using the "Set FileSource" option under the "Help" menu</LI></UL>')},1e3)}addTableRow(name,fname,infoname,tagvalue=null){const internal=this.internal,buttonCallback=function(e){let id=e.target.id,arr=internal.buttonpairs[id],fname=arr[0],index=arr[1];if("gz"===fname.split(".").pop()){const img=new BisWebImage;webutil.createAlert("Loading image from "+fname,"progress"),setTimeout(()=>{img.load(fname,!1).then(function(){webutil.createAlert("Image loaded from "+img.getDescription()),internal.viewers[index].setimage(img)}).catch(e=>{webutil.createAlert(e,!0)})},100)}else bisgenericio.read(fname).then(obj=>{let info=fname+"\n"+obj.data,modal=webutil.createmodal("Imported File Properties","modal-lrg"),a2=$("<pre>"+info+"</pre>");modal.body.append(a2),modal.dialog.modal("show")})};let getDimensionsFromName=function(name){let i=name.indexOf("("),j=name.indexOf(")");if(i>0&&j>0){let dim=name.substr(i+1,j-i-1).split(",");for(let k=0;k<dim.length;k++)dim[k]=parseInt(dim[k]);return dim}return[0,0,0]};if(!tagvalue&&imagelabels.indexOf("tagvalue")<0)if(name.indexOf("EPI")>0)tagvalue="EPI";else if(name.indexOf("FLASH")>0)tagvalue=getDimensionsFromName(name)[0]>=200?"Angio":"AngioAnatomical";else if(name.indexOf("FieldMap")>0)tagvalue="FieldMap";else if(name.indexOf("MSME")>0){let dim=getDimensionsFromName(name);tagvalue=dim[2]<.5*dim[0]?"2DAnatomical":"3DAnatomical"}else tagvalue="None";console.log("Infoname=",infoname);let details={name:name,filename:bisgenericio.getBaseName(fname),details:bisgenericio.getBaseName(infoname),tag:tagvalue};internal.joblist.push(details);let counter=internal.joblist.length+1,nid0=webutil.getuniqueid(),nid1=webutil.getuniqueid(),nid2=webutil.getuniqueid(),nid3=webutil.getuniqueid(),w0=`<tr>\n                   <td width="10%">${counter}</td>\n                   <td width="75%">${name}</td>\n                   <td width="15%" id="${nid3}"></td>\n                </tr>\n                <tr>\n                   <td width="15%"></td>\n                   <td width="80%">\n                        <button type="button" class="btn-info btn-sm" style="padding: 0px, font-size: 10px"\n                              id="${nid0}">Show1</button>\n                        <button type="button" class="btn-info btn-sm" style="padding: 0px, font-size: 10px"\n                              id="${nid1}">Show2</button>\n                        <button type="button" class="btn-success  btn-sm" style="padding: 1px, font-size: 10px" id="${nid2}">Info</button>\n                   </td>\n                </tr>`;internal.table.append($(w0));let index=imagelabels.indexOf(tagvalue);index<0&&(index=0),webutil.createselect({parent:$("#"+nid3),values:imagelabels,index:index,callback:function(e){details.tag=imagelabels[e.target.value]}});let btn=$("#"+nid0);btn.click(buttonCallback),internal.buttonpairs[nid0]=[fname,0],(btn=$("#"+nid1)).click(buttonCallback),internal.buttonpairs[nid1]=[fname,1];let btn2=$("#"+nid2);infoname.length>2?(btn2.click(buttonCallback),internal.buttonpairs[nid2]=[infoname,0]):btn2.remove()}internalimportfiles2(f,outpath){const self=this,internal=this.internal;webutil.createAlert("Importing files from "+f+"--\x3e"+outpath),"electron"===bisgenericio.getmode()&&(window.BISELECTRON.ipc.send("showconsole",""),window.BISELECTRON.ipc.send("clearconsole","")),internal.table.empty(),internal.showpanel.show(),internal.buttonpairs={},internal.joblist=[];let addT=function(name,fname,infoname){self.addTableRow(name,fname,infoname)},infoT=name=>new Promise(resolve=>{setTimeout(()=>{webutil.createAlert(name,"progress"),resolve()},1)});userPreferences.safeGetImageOrientationOnLoad().then(forceorient=>{bisbruker.readMultiple(f,outpath,forceorient,addT,infoT,!1).then(out=>{!0===out[0]?webutil.createAlert("Job saved in "+out[1]):webutil.createAlert(out[1],!0)})})}importfiles(f){const internal=this.internal;let s=webfileutil.candoComplexIO();console.log("Can do =",s),s&&(bisgenericio.isDirectory(f)||(f=bisgenericio.getDirectoryName(bisgenericio.getNormalizedFilename(f))),bisbruker.getMatchingFilenames(f).then(obj=>{if(console.log(JSON.stringify(obj)),obj.names.length<1)return void webutil.createAlert("No matching files (2dseq) in "+f+" or its subdirectories",!0);let clb=function(fout){console.log("f=",f,fout),internal.this.internalimportfiles2(f,fout)};setTimeout(()=>{webfileutil.genericFileCallback({filters:"DIRECTORY",suffix:"DIRECTORY",title:"Select Directory to store output files",save:!1},clb)},100)}).catch(e=>{console.log(e,e.stack)}))}importjob(f){if(!webfileutil.candoComplexIO())return;const self=this,internal=this.internal;let dirname=bisgenericio.getDirectoryName(bisgenericio.getNormalizedFilename(f)),loaderror=function(e){webutil.createAlert("Failed to read job from"+f+" ("+e+")")};bisgenericio.read(f).then(results=>{let obj=null;try{obj=JSON.parse(results.data)}catch(e){return loaderror(e)}let name=obj.bisformat||"";if("ParavisionJob"!==name&&"DICOMImport"!==name)return loaderror("Bad File Tag "+name);let data=obj.job;self.internal.lastfilename=f,internal.buttonpairs=[],internal.joblist=[];let n=data.length;internal.showpanel.show(),internal.table.empty();for(let ic=0;ic<n;ic++){let details=data[ic].details;data[ic].details.length>1&&0===data[ic].details.indexOf("/")&&(details=bisgenericio.joinFilenames(dirname,data[ic].details)),0===data[ic].filename.indexOf("/")?self.addTableRow(data[ic].name,data[ic].filename,details,data[ic].tag):self.addTableRow(data[ic].name,bisgenericio.joinFilenames(dirname,data[ic].filename),details,data[ic].tag)}}).catch(e=>{loaderror(e)})}savejob(f){if(!webfileutil.candoComplexIO())return;let obj={bisformat:"ParavisionJob",job:this.internal.joblist},out=JSON.stringify(obj,null,2);bisgenericio.write(f,out).then(()=>{console.log("Saved job in",f)})}computeAverageImages(outdir){if(!webfileutil.candoComplexIO())return;console.log("Reading last=",this.internal.lastfilename,outdir);const self=this;misac.createAverageAnatomical(this.internal.joblist,bisgenericio.joinFilenames(bisgenericio.getDirectoryName(this.internal.lastfilename),"result")).then(results=>{let objlist=results.objlist,outname=results.outnamelist;for(let i=0;i<=2;i++)objlist[i].save(outname[i]),i<2&&self.addTableRow(results.names[i],outname[i],"","Computed")})}computeAverageImages1(){if(webfileutil.candoComplexIO())return this.internal.lastfilename?this.computeAverageImages(bisgenericio.getDirectoryName.dirname(this.internal.lastfilename)):void webutil.createAlert("No Job in Memory",!0)}connectedCallback(){let viewerid=this.getAttribute("bis-viewerid"),viewerid2=this.getAttribute("bis-viewerid2"),layoutid=this.getAttribute("bis-layoutwidgetid");this.internal.viewers=[document.querySelector(viewerid),document.querySelector(viewerid2)],this.layoutcontroller=document.querySelector(layoutid);let panel=new BisWebPanel(this.layoutcontroller,{name:"Paravision Import",permanent:!0});panel.show(),this.internal.this=this,this.internal.parentDomElement=panel.getWidget();let basediv=$("<div>To appear...</div>");this.internal.parentDomElement.append(basediv),this.onDemandCreateGUI()}})},"./js/webcomponents/bisweb_simplealgorithmcontroller.js":function(module,exports,__webpack_require__){"use strict";const BisWebLinearTransform=__webpack_require__("./js/dataobjects/bisweb_lineartransformation.js"),undoStack=__webpack_require__("./js/dataobjects/bis_undostack.js"),webutil=__webpack_require__("./js/coreweb/bis_webutil.js"),transformationutil=__webpack_require__("./js/legacy/bis_transformationutil.js");class SimpleAlgorithmControllerElement extends HTMLElement{constructor(){super(),this.viewers={viewer1:null,viewer2:null},this.undoImageStack=new undoStack(5,1),this.blockUpdates=!1,this.currentTransform=null,this.currentTransformController=null,this.currentMatrixController=null,this.identityTransform=new BisWebLinearTransform}connectedCallback(){const self=this;webutil.runAfterAllLoaded(()=>{self.attachViewers(),self.currentMatrixController=document.querySelector(this.getAttribute("bis-matrixelementid"))||null,self.currentTransformController=document.querySelector(this.getAttribute("bis-transformelementid"))||null,null===self.currentTransformController&&document.addEventListener("loadTransform",self.handleLoadTransformEvent.bind(self))})}attachViewers(){const viewerid=this.getAttribute("bis-viewerid");this.viewers.viewer1=document.querySelector(viewerid)||null,this.viewers.viewer1&&this.viewers.viewer1.setName("viewer1");const viewerid2=this.getAttribute("bis-viewerid2");this.viewers.viewer2=document.querySelector(viewerid2)||null,this.viewers.viewer2&&this.viewers.viewer2.setName("viewer2")}getImage(viewer,itype){return viewer=viewer.indexOf("2")>=0&&null!==this.viewers.viewer2?"viewer2":"viewer1",this.viewers[viewer]?"overlay"===itype?this.viewers[viewer].getobjectmap():this.viewers[viewer].getimage():(console.log("Error: attempting to get an image from nonexistent viewer",viewer," with key",itype),null)}getTransform(key){let obj=null;return"last"!==key&&"current"!==key||(this.currentTransformController?obj=this.currentTransformController.getCurrentObject():this.currentTransform&&this.currentTransform.data&&(obj=this.currentTransform.data)),null===obj?this.identityTransform:obj}getViewerCrossHairs(key){return this.viewers[key]?this.viewers[key].getViewerCrossHairs():null}pushImageToUndoStack(input,options={}){if(!input)return!1;if(input.getMemorySize()<52428800){let op={image:input,options:options};this.undoImageStack.addOperation([op])}else webutil.createAlert("Not adding image: "+input.getFilename()+" to undo stack. It is too large.",!0);return!0}sendImageToViewer(image,options={}){let type=options.viewersource||"image",key=options.viewername||"viewer1",ctype=options.colortype||"Auto",plainmode="Objectmap"===ctype;return this.blockUpdates=!0,"overlay"===type?this.viewers[key].setobjectmap(image,plainmode,ctype):this.viewers[key].setimage(image),this.blockUpdates=!1,!0}undoImage(undo=!0){let undoelement,undoMessage=()=>{let op="undo";return undo||(op="redo"),webutil.createAlert("Can not do "+op+" no prior data available",!0),!1};if(!(undoelement=0==undo?this.undoImageStack.getRedo()||null:this.undoImageStack.getUndo()||null))return undoMessage();if(!(undoelement=undoelement[0]))return undoMessage();let image=undoelement.image;return null!==image?(this.sendImageToViewer(image,undoelement.options),!0):void 0}handleImageUpdate(inpobj,options){let viewersource=options.viewersource||"image",viewername=options.viewername||"image",oldimage=null;return(oldimage="overlay"===viewersource?this.viewers[viewername].getobjectmap():this.viewers[viewername].getimage())&&this.pushImageToUndoStack(oldimage,{viewername:viewername,viewersource:viewersource,colortype:this.viewers[viewername].getcolortype()}),this.sendImageToViewer(inpobj,options),!0}handleTransformUpdate(inpobj,options={}){if(!this.currentTransformController)return this.currentTransform={data:inpobj,metadata:options.inputinfo?options.inputinfo:void 0},!0;this.currentTransformController.addItem(inpobj)}handleUpdate(inpobj,options={viewername:"image",viewersource:"image",colortype:"Auto"}){return new Promise((resolve,reject)=>{inpobj&&!0!==this.blockUpdates||reject("either null input, blockUpdates=true");let objtype=inpobj.getObjectType();"image"===objtype?this.handleImageUpdate(inpobj,options):"transform"===objtype&&this.handleTransformUpdate(inpobj,options),resolve("Added object")})}handleLoadTransformEvent(){const self=this;webutil.createhiddeninputfile(".matr, .grd",f=>{transformationutil.loadTransformation(f).then(obj=>{self.currentTransform={data:obj.data},webutil.createAlert(`Created transform ${obj.filename} and updated current transform`,!1)})},!1).click()}createMenuItems(menu){webutil.createMenuItem(menu,"Undo",()=>{this.undoImage()}),webutil.createMenuItem(menu,"Redo",()=>{this.undoImage(!1)})}getViewers(){return this.viewers}getTransformController(){return this.currentTransformController}getMatrixController(){return this.currentMatrixController}}webutil.defineElement("bisweb-simplealgorithmcontrollerelement",SimpleAlgorithmControllerElement),module.exports=SimpleAlgorithmControllerElement},"./js/webcomponents/bisweb_snapshotelement.js":function(module,exports,__webpack_require__){"use strict";const bisgenericio=__webpack_require__("./js/core/bis_genericio.js"),$=__webpack_require__("jquery"),webutil=__webpack_require__("./js/coreweb/bis_webutil.js"),filesaver=__webpack_require__("./lib/js/FileSaver.js"),bootbox=__webpack_require__("./node_modules/bootbox/bootbox.js"),userPreferences=__webpack_require__("./js/core/bisweb_userpreferences.js"),BisWebPanel=__webpack_require__("./js/coreweb/bisweb_panel.js"),BisWebImage=__webpack_require__("./js/dataobjects/bisweb_image.js"),pngReader=__webpack_require__("./node_modules/png.js/PNGReader.js");__webpack_require__("./lib/js/bootstrap-colorselector.js");webutil.defineElement("bisweb-snapshotelement",class extends HTMLElement{constructor(){super(),this.data={scale:3,dowhite:!1,crop:!0},this.testingResolve=null,this.testingReject=null,this.simplemode=!1,this.colorselector=null}getElementState(){return JSON.parse(JSON.stringify(this.data))}setElementState(dt){if(!dt)return;let names=["scale","dowhite","crop"];for(let i=0;i<names.length;i++){let key=names[i];void 0!==dt[key]&&(this.data[key]=dt[key])}this.colorselector&&this.colorselector.prop("checked",this.data.dowhite),this.cropselector.prop("checked",this.data.crop),this.select.val(this.data.scale-1)}computeGoodRows(in_imgdata,dowhite,border=20,padding=10){let ht=in_imgdata.height,wd=in_imgdata.width,badsum=0;dowhite&&(badsum=765);let rows=new Int16Array(ht),goodrows=0;for(let j=0;j<ht;j++){let found=!1;for(let i=0;i<wd;i++){let offset=4*(j*wd+i),sum=0;for(let c=0;c<=2;c++)sum+=in_imgdata.data[offset+c];sum!==badsum&&(found=!0,i=wd+1)}found?(rows[j]=goodrows,goodrows+=1):rows[j]=-1}rows[0]>=0&&(rows[0]=border);let totalp=border;for(let j=1;j<ht;j++)rows[j]>=0&&(rows[j-1]<0&&(totalp+=padding),rows[j]=rows[j]+totalp,goodrows=rows[j]+1);return{goodrows:goodrows+=border,rows:rows}}computeGoodColumns(in_imgdata,dowhite,beginj=0,endj=-1,border=20,padding=10){let ht=in_imgdata.height,wd=in_imgdata.width;beginj<0&&(beginj=0),endj<0&&(endj=ht);let badsum=0;dowhite&&(badsum=765);let columns=new Int16Array(wd),goodcolumns=0;for(let i=0;i<wd;i++){let found=!1;for(let j=beginj;j<endj;j++){let offset=4*(j*wd+i),sum=0;for(let c=0;c<=2;c++)sum+=in_imgdata.data[offset+c];sum!==badsum&&(found=!0,j=endj+1)}found?(columns[i]=goodcolumns,goodcolumns+=1):columns[i]=-1}columns[0]>=0&&(columns[0]=border);let totalp=border;for(let i=1;i<wd;i++)columns[i]>=0&&(columns[i-1]<0&&(totalp+=padding),columns[i]=columns[i]+totalp,goodcolumns=columns[i]+1);return{goodcolumns:goodcolumns+=border,columns:columns}}autoCrop(in_canvas,dowhite,hasOverlayColorbar){let wd=in_canvas.width,ht=in_canvas.height,in_imgdata=in_canvas.getContext("2d").getImageData(0,0,wd,ht),border=Math.round(.01*wd);border<4&&(border=4);let padding=Math.round(border/4),{goodrows:goodrows,rows:rows}=this.computeGoodRows(in_imgdata,dowhite,border,padding),endj=ht;hasOverlayColorbar&&(endj=Math.round(.91*ht));let tailgoodcolumns=-1,tailcolumns=null,{goodcolumns:goodcolumns,columns:columns}=this.computeGoodColumns(in_imgdata,dowhite,0,endj,border,padding);if(hasOverlayColorbar){let d=this.computeGoodColumns(in_imgdata,dowhite,endj,ht,border,border);tailgoodcolumns=d.goodcolumns,tailcolumns=d.columns,tailgoodcolumns<border+10&&(tailgoodcolumns=0)}let columnoffset=0;tailgoodcolumns>goodcolumns&&(columnoffset=Math.round((tailgoodcolumns-goodcolumns)/2),goodcolumns=tailgoodcolumns),hasOverlayColorbar&&tailgoodcolumns>0&&(goodrows=Math.floor(goodrows+border));let newcanvas=document.createElement("canvas");newcanvas.height=goodrows,newcanvas.width=goodcolumns;let newctx=newcanvas.getContext("2d"),imgdata=newctx.createImageData(goodcolumns,goodrows),l=goodcolumns*goodrows,cl=[0,0,0,255];dowhite&&(cl=[255,255,255,255]);for(let i=0;i<l;i++)for(let c=0;c<=3;c++)imgdata.data[4*i+c]=cl[c];for(let j=0;j<endj;j++)if(rows[j]>=0)for(let i=0;i<wd;i++)if(columns[i]>0){let in_offset=4*(j*wd+i),out_offset=4*(rows[j]*goodcolumns+columns[i]+columnoffset);for(let c=0;c<=3;c++)imgdata.data[out_offset+c]=in_imgdata.data[in_offset+c]}if(hasOverlayColorbar&&tailgoodcolumns>0){let widthoffset=Math.floor((goodcolumns-tailgoodcolumns)/2);for(let j=endj;j<ht;j++)if(rows[j]>=0)for(let i=0;i<wd;i++)if(tailcolumns[i]>0){let in_offset=4*(j*wd+i),out_offset=4*((border+rows[j])*goodcolumns+tailcolumns[i]+widthoffset);for(let c=0;c<=3;c++)imgdata.data[out_offset+c]=in_imgdata.data[in_offset+c]}}return newctx.putImageData(imgdata,0,0),newcanvas}createOutputCanvas(img,hasOverlayColorbar=!1,scale=1,dowhite=!1,crop=!1){let fillcolor="#000000";dowhite&&(fillcolor="#ffffff");let outcanvas=document.createElement("canvas");outcanvas.width=this.canvaslist[0].width*scale,outcanvas.height=this.canvaslist[0].height*scale;let ctx=outcanvas.getContext("2d");ctx.fillStyle=fillcolor,ctx.globalCompositeOperation="source-over",ctx.fillRect(0,0,outcanvas.width,outcanvas.height);for(let i=0;i<this.canvaslist.length;i++)ctx.drawImage(this.canvaslist[i],0,0,outcanvas.width,outcanvas.height);return ctx.drawImage(img,0,0,outcanvas.width,outcanvas.height),crop&&(outcanvas=this.autoCrop(outcanvas,dowhite,hasOverlayColorbar)),outcanvas}createsnapshot(img,hasOverlayColorbar=!1){userPreferences.setItem("snapshotscale",this.data.scale),this.simplemode||userPreferences.setItem("snapshotdowhite",this.data.dowhite),userPreferences.storeUserPreferences();let outcanvas=this.createOutputCanvas(img,hasOverlayColorbar,this.data.scale,this.data.dowhite,this.data.crop),outimg=outcanvas.toDataURL("image/png"),dispimg=$('<img id="dynamic">');dispimg.attr("src",outimg),dispimg.width(300);let a=webutil.creatediv();return a.append(dispimg),setTimeout(function(){bootbox.dialog({title:"This is the snapshot (size="+outcanvas.width+"x"+outcanvas.height+").<BR> Click SAVE to output as png.",message:a.html(),buttons:{ok:{label:"Save To File",className:"btn-success",callback:function(){let blob=bisgenericio.dataURLToBlob(outimg);if(webutil.inElectronApp()){let reader=new FileReader;reader.onload=function(){let buf=this.result,arr=new Int8Array(buf);bisgenericio.write({filename:"snapshot.png",title:"Select file to save snapshot in",filters:[{name:"PNG Files",extensions:["png"]}]},arr,!0)},reader.readAsArrayBuffer(blob)}else filesaver(blob,"snapshot.png")}}},cancel:{label:"Cancel",className:"btn-danger"}})}),!1}requestupdate(){return this.viewer.savenextrender(this),!1}connectedCallback(){"true"===this.getAttribute("bis-dowhite")&&(this.data.dowhite=!0);let viewerid=this.getAttribute("bis-viewerid"),layoutid=this.getAttribute("bis-layoutwidgetid"),viewer=document.querySelector(viewerid),layoutcontroller=document.querySelector(layoutid),simple=viewer.getAttribute("bis-simplemode");"1"!==simple&&"true"!==simple||(this.simplemode=!0,this.data.dowhite=!0),this.viewer=viewer,this.viewer.setSnapShotController(this),this.renderer=layoutcontroller.renderer,this.canvaslist=[layoutcontroller.canvas,layoutcontroller.overlaycanvas],this.select=null;const self=this;let panel=new BisWebPanel(layoutcontroller,{name:"Viewer Snapshot",dual:!1,permanent:!0,width:"300px"});panel.show();let basegui=panel.getWidget(),base=webutil.creatediv({parent:basegui}),inlineform=$('<form class="form-inline"></form>');base.append(inlineform);let elem1=webutil.creatediv({parent:inlineform}),elem2=webutil.creatediv({parent:inlineform}),bg=webutil.getpassivecolor();try{bg=basegui.parent().parent().css("background-color")}catch(e){console.log("bad color sticking to defaults",e)}webutil.createlabel({name:"Scale:",type:"default",css:{"margin-left":"2px","background-color":bg},parent:elem1}),self.select=webutil.createselect({parent:elem1,values:["x1","x2","x3","x4","x5","x6","x7"],position:"top",index:Math.floor(self.data.scale)-1,tooltip:"Set size of the snapshot to a multiple of the current viewer size"}).change(function(e){self.data.scale=parseInt(e.target.value)+1}),this.simplemode||(self.colorselector=webutil.createcheckbox({name:"White Bkgd",type:"info",checked:self.data.dowhite,parent:elem1,callback:function(sel){self.data.dowhite=sel},css:{"margin-left":"5px"},tooltip:"If on set the viewer background to white"})),self.cropselector=webutil.createcheckbox({name:"Crop",type:"info",checked:self.data.crop,parent:elem1,callback:function(sel){self.data.crop=sel},css:{"margin-left":"5px"},tooltip:"Crop Snapshot"}),webutil.createbutton({name:"Take Snapshot",type:"info",tooltip:"Self will create preview of a snaphot of the viewer that you can then save.",position:"top",css:{padding:"5px","margin-left":"5px","margin-top":"5px"},parent:elem2,callback:function(){self.requestupdate()}}),webutil.tooltip(inlineform),console.log("SNAPSHOT ::: Requesting Scale="),userPreferences.safeGetItem("snapshotscale").then(v=>{console.log("SNAPSHOT ::: Received Scale=",v),null!==v&&parseFloat(v)!==Math.Nan&&(self.data.scale=Math.floor(v),null!==self.select&&self.select.val(self.data.scale-1))}),this.simplemode||userPreferences.safeGetItem("snapshotdowhite").then(v=>{self.data.dowhite=v,null!==self.colorselector&&self.colorselector.prop("checked",self.data.dowhite)})}update(t,hasOverlayColorbar=!1){let img=document.createElement("img");img.src=t,setTimeout(()=>{null===this.testingResolve?this.createsnapshot(img,hasOverlayColorbar):this.testingResolve(this.createOutputCanvas(img,hasOverlayColorbar,this.data.scale,this.data.dowhite,this.data.crop))},500)}createBisWebImageFromCanvas(in_canvas){let wd=in_canvas.width,ht=in_canvas.height,in_imgdata=in_canvas.getContext("2d").getImageData(0,0,wd,ht).data,output=new BisWebImage;output.initialize(),output.createImage({type:"uchar",numcomponents:1,numframes:4,orientation:"LPS",dimensions:[wd,ht,1]});let out_imgdata=output.getImageData(),slicesize=wd*ht,index=0;for(let row=0;row<ht;row++)for(let col=0;col<wd;col++)for(let comp=0;comp<=3;comp++)out_imgdata[comp*slicesize+row*wd+col]=in_imgdata[index],++index;return output}createBisWebImageFromURL(url){return new Promise((resolve,reject)=>{bisgenericio.read(url,!0).then(obj=>{let data=obj.data;new pngReader(data.buffer).parse(function(err,png){err&&reject(err);let ht=png.getHeight(),wd=png.getWidth(),output=new BisWebImage;output.initialize(),output.createImage({type:"uchar",numcomponents:1,numframes:4,orientation:"LPS",dimensions:[wd,ht,1]});let out_imgdata=output.getImageData(),slicesize=wd*ht,index=0;for(let row=0;row<ht;row++)for(let col=0;col<wd;col++)for(let comp=0;comp<=3;comp++)out_imgdata[comp*slicesize+row*wd+col]=png.pixels[index],++index;resolve(output)})}).catch(e=>{reject(e)})})}getTestImage(){const self=this;return new Promise((resolve,reject)=>{self.testingResolve=(dat=>{self.testingResolve=null,self.testingReject=null,resolve(dat)}),self.testingReject=reject,self.viewer.savenextrender(self)})}})},"./js/webcomponents/bisweb_viewerlayoutelement.js":function(module,exports,__webpack_require__){"use strict";const $=__webpack_require__("jquery"),webutil=__webpack_require__("./js/coreweb/bis_webutil.js"),THREE=__webpack_require__("three");var detectWebGL=function(){try{var canvas=document.createElement("canvas");return!(!window.WebGLRenderingContext||!canvas.getContext("webgl")&&!canvas.getContext("experimental-webgl"))}catch(e){console.log("WEB GL is not available")}return!1};webutil.defineElement("bisweb-viewerlayoutelement",class extends HTMLElement{constructor(){super(),this.minimizedockpanel=!1,this.sidebarwidth=1,this.sidebarElements={},this.renderer=null,this.verticalLines=[null,null],this.verticalLines2=[null,null],this.verticalLinesX=[null,null],this.fixed=0,this.noresize=0}getCSSLength(n="width"){let style=getComputedStyle(this),v=style[n];return"auto"===v&&(v=(style=getComputedStyle(this.parentElement))[n]),parseFloat(v.replace(/px/g,""))}getInnerWidth(){return this.noresize?this.getCSSLength("width"):window.innerWidth}getInnerHeight(){return this.noresize?this.getCSSLength("height")||700:window.innerHeight}handleresize(){let dockwidth=this.dockpanelwidth,sidewidth=this.sidebarwidth||1;sidewidth<10&&(sidewidth=1);let innerW=this.getInnerWidth(),innerH=this.getInnerHeight();this.minimizedockpanel&&(dockwidth=50);let maxw=Math.round(.4*innerW);dockwidth>maxw&&(dockwidth=maxw),sidewidth>maxw&&(sidewidth=maxw);let offset=87;if(this.noresize&&(offset=0,this.topheight=0),this.viewertop=0,innerW>767){let w=innerW-90;$("#bismenuparent").css({width:`${w}px`,"max-width":`${2*w}px`})}else $("#bismenuparent").css({"max-width":"100%"});this.viewerheight=innerH-this.topheight-offset,this.viewerwidth=innerW-dockwidth-sidewidth;let docktop=0,dockleft=0,dockbarheight=this.viewerheight,sidetop=0,wide=1;innerW<768||this.viewerwidth<380?(this.viewerwidth=innerW,this.viewerheight=this.viewerheight-100,dockbarheight=1.5*this.viewerheight,dockwidth=this.viewerwidth,sidetop=(docktop=this.viewerheight+10)+dockbarheight+10,sidewidth>10&&(sidewidth=this.viewerwidth),wide=0):(dockleft=this.viewerwidth+this.sidebarwidth,docktop=this.viewertop,sidetop=this.viewertop,this.viewerleft=sidewidth);let canvascss={left:`${this.viewerleft}px`,top:`${this.viewertop}px`,width:`${this.viewerwidth}px`,height:`${this.viewerheight}px`},dockbarcss={width:`${dockwidth}px`,top:`${docktop}px`,height:`${dockbarheight}px`,left:`${dockleft}px`};sidewidth<2&&(sidewidth=2);let sidebarcss={left:"0px",top:`${sidetop}px`,width:`${sidewidth-1}px`,height:`${dockbarheight}px`,opacity:"1.0"};this.elements.rendererbase.css(canvascss),this.elements.canvasbase.css(canvascss),this.elements.dockbar.css(dockbarcss),this.minimizedockpanel?this.elements.dockbarcontent.css({opacity:"0.05",overflow:"hidden",height:`${dockbarheight-40}px`}):this.elements.dockbarcontent.css({opacity:"1.0",overflow:"auto",height:`${dockbarheight-40}px`}),sidewidth<10?this.elements.sidebar.css({opacity:"0.01"}):(this.elements.sidebar.css(sidebarcss),this.sidebarElements.header.css({height:"70px","max-height":"70px"}),this.sidebarElements.widget.css({height:`${this.viewerheight-70}px`})),this.renderer.setSize(this.viewerwidth,this.viewerheight),this.canvas.width=this.viewerwidth,this.canvas.height=this.viewerheight,this.overlaycanvas.width=this.viewerwidth,this.overlaycanvas.height=this.viewerheight,this.context.clearRect(0,0,this.viewerwidth,this.viewerheight),this.overlaycontext.clearRect(0,0,this.viewerwidth,this.viewerheight),this.fixed||this.createOrShowLines(wide*sidewidth,wide*dockwidth)}connectedCallback(){this.viewertop=0,this.viewerwidth=800,this.viewerheight=800,this.elements=null,this.canvas=null,this.context=null,this.overlaycanvas=null,this.overlaycontext=null,this.domElement=$(this),$(this).css({"-webkit-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none","-webkit-app-region":"no-drag","background-color":webutil.getpassivecolor()}),this.dockpanelwidth=parseInt(this.getAttribute("bis-dockwidth"))||300,this.topheight=parseInt(this.getAttribute("bis-topheight"))||0,this.dualmode=parseInt(this.getAttribute("bis-dualmode"))||0,this.fixed=parseInt(this.getAttribute("bis-fixed")||0),this.noresize=parseInt(this.getAttribute("bis-noresize")||0),this.minimizedockpanel=parseInt(this.getAttribute("bis-minimizedockpanel")||0),0!==this.minimizedockpanel&&(this.minimizedockpanel=1),this.defaulttext=this.getAttribute("bis-defaulttext")||"",this.defaulttext.length<5&&(this.defaulttext="");let coreopen=this.getAttribute("bis-coreopen");if(coreopen="true"===coreopen||!0===coreopen,!1===detectWebGL()){var a=$("<div><B> Your Browser does not support WebGL or it is not enabled.<BR> <BR> This viewer can not function without WebGL support.</B><BR><HR><BR></div>"),b=$("<div>If using Safari on MacOS do: <BR><BR><OL><LI>Open the Safari menu and select Preferences.</LI><LI>Click the Advanced tab in the Preferences window.</LI><LI>Then, at the bottom of the window, check the Show Develop menu in menu bar checkbox.</LI><LI>Then, open the Develop menu in the menu bar and select Enable WebGL.</LI></OL></div>");return this.domElement.append(a),this.domElement.append(b),null}this.elements={rendererbase:webutil.creatediv({parent:this.domElement,css:{position:"absolute","z-index":"2",margin:"0 0 0 0",padding:"0 0 0 0","border-color":"#888888","border-style":"solid","border-width":"0px 0px 0px 0px"}}),canvasbase:webutil.creatediv({parent:this.domElement,css:{position:"absolute",top:"0px","background-color":"#000000","z-index":"1",margin:"0 0 0 0",padding:"0 0 0 0"}}),dockbar:webutil.creatediv({parent:this.domElement,css:{position:"absolute","border-width":"0px 0px 0px 0px","border-color":"#888888","border-style":"solid","padding-left":"2px","z-index":"4","background-color":webutil.getpassivecolor()}}),sidebar:webutil.creatediv({parent:this.domElement,css:{position:"absolute",top:"0px",left:"0px","z-index":"4","margin-top":"0px","padding-right":"2px","margin-bottom":"0px",opacity:"0.01","border-width":"0px 0px 0px 0px","border-color":"#888888","border-style":"solid",width:`${this.sidebarwidth}px`,"background-color":webutil.getpassivecolor()}})},this.elements.dockbar.attr("aria-label","viewer_dockbar");let b1=this.defaulttext.substr(0,1)||"";this.defaulttext.length>10&&" "!=b1&&this.elements.canvasbase.css({"background-color":"#fefefe"});let zt=webutil.creatediv({parent:this.elements.dockbar,css:{height:"40px",width:"100%"}});this.elements.dockbarcontent=webutil.creatediv({parent:this.elements.dockbar,css:{width:"100%","padding-top":"5px"}});let minimizebutton=$('<button type="button" class="bistoggle"><span class="glyphicon glyphicon-resize-small"></span></button>');minimizebutton.css({margin:"2px"}),zt.append(minimizebutton);let newpanel=webutil.createpanelgroup(this.elements.dockbarcontent);this.dualmode>0?(this.elements.corecontrols=webutil.createCollapseElement(newpanel,"Viewer 1 Controls",coreopen),this.elements.secondviewercontrols=webutil.createCollapseElement(newpanel,"Viewer 2 Controls",!1)):this.elements.corecontrols=webutil.createCollapseElement(newpanel,"Viewer Controls",coreopen),this.elements.toolbase=webutil.createpanelgroup(this.elements.dockbarcontent),this.canvas=document.createElement("canvas"),$(this.canvas).css({"z-index":"500",position:"absolute",top:"0px",left:"0px"}),this.context=this.canvas.getContext("2d"),this.overlaycanvas=document.createElement("canvas"),$(this.overlaycanvas).css({"z-index":"502",position:"absolute",top:"0px",left:"0px"}),this.overlaycontext=this.canvas.getContext("2d"),this.elements.canvasbase.append(this.canvas),this.elements.canvasbase.append(this.overlaycanvas),this.renderer=new THREE.WebGLRenderer({alpha:!0}),this.renderer.shadowMap.Enabled=!0,this.renderer.setClearColor(0,0),this.renderer.autoClear=!1,this.elements.rendererbase.append(this.renderer.domElement);const self=this;this.context.font="28px Arial",this.context.fillStyle="#888888",this.context.clearRect(0,0,this.viewerwidth,this.viewerheight),this.originaldockwidth=this.dockpanelwidth,minimizebutton.click(function(e){e.preventDefault(),minimizebutton.empty(),self.minimizedockpanel?(self.minimizedockpanel=0,self.dockpanelwidth=self.originaldockwidth,minimizebutton.append('<span class="glyphicon glyphicon-resize-small"></span>')):(self.minimizedockpanel=1,minimizebutton.append('<span class="glyphicon glyphicon-resize-full"></span>')),window.dispatchEvent(new Event("resize"))}),this.sidebarElements.header=webutil.creatediv({parent:this.elements.sidebar,css:{width:"99%","padding-bottom":"10px",height:"5px","background-color":webutil.getpassivecolor2()}}),this.sidebarElements.widget=webutil.creatediv({parent:this.elements.sidebar,css:{width:"99%",height:"5px","overflow-y":"auto","background-color":webutil.getpassivecolor()}}),this.handleresize(),webutil.runAfterAllLoaded(()=>{if(this.defaulttext.length<4)this.context.fillText("Load (or Drag) an Image (.nii.gz or .nii)",100,100),this.context.fillText(" or an application viewer file (.biswebstate)",100,180),this.context.fillText("and it will appear here!",120,260);else{let ch=this.context.canvas.height,cw=this.context.canvas.width;this.context.textAlign="center",this.context.fillText(this.defaulttext,cw/2,ch/2)}})}getrenderer(){return this.renderer}getcanvas(){return this.canvas}getoverlaycanvas(){return this.overlaycanvas}getcorecontrols(slave=!1){return!0===slave&&this.dualmode>0?this.elements.secondviewercontrols:this.elements.corecontrols}getdockbar(){return this.elements.toolbase}getsidebar(){return this.elements.sidebar}getSidebarElements(){return this.sidebarElements}setsidebarwidth(n){n<10&&(n=0);let maxl=Math.round(.5*this.getInnerWidth());n>maxl&&(n=maxl),this.sidebarwidth=n,window.dispatchEvent(new Event("resize"))}getsidebarwidth(){return this.sidebarwidth}getviewerwidth(){return this.viewerwidth}getviewerheight(){return this.viewerheight}getviewertop(){return this.viewertop}getviewerleft(){return this.viewerleft}createDockWidget(name,open=!1){return webutil.createCollapseElement(this.elements.toolbase,name,open)}handleVerticalLines(e,index,mode,modifyCallbacks){if(mode>=1&&this.verticalLinesX[index]<0)return!1;e.preventDefault();let x=Math.round(e.pageX),cnv=this.verticalLines[index],cnv2=this.verticalLines2[index];if(0===mode)return cnv.css({left:`${x-3}px`,width:"9px"}),cnv2.css({left:`${x-4}px`}),modifyCallbacks(1),this.verticalLinesX[index]=x,!0;let minl=0,maxl=0;return 0===index?(minl=151,maxl=Math.round(.4*this.getInnerWidth())):(minl=Math.round(.4*this.getInnerWidth()+this.sidebarwidth),maxl=this.getInnerWidth()-151),x<minl?x=minl:x>maxl&&(x=maxl),1===mode&&this.verticalLinesX[index]>0?(cnv.css({left:`${x-3}px`}),cnv2.css({left:`${x-5}px`}),!0):2===mode?(cnv.css({width:"1px"}),this.verticalLinesX[index]=-1,this.midlineCallbacks(2,index),setTimeout(()=>{0===index?this.setsidebarwidth(x):(this.dockpanelwidth=this.getInnerWidth()-x,this.dockpanelwidth<150&&(this.dockpanelwidth=150),window.dispatchEvent(new Event("resize")))},10),!0):void 0}midlineCallbacks(add=0,index=0){let modifyCallbacks=null,downC=function(e){self.handleVerticalLines(e,index,0,modifyCallbacks)},moveC=function(e){self.handleVerticalLines(e,index,1,modifyCallbacks)},upC=function(e){self.handleVerticalLines(e,index,2,modifyCallbacks)};const self=this;return(modifyCallbacks=function(add=0){let cnv2=self.verticalLines2[index],par=self.domElement;0===add?cnv2[0].addEventListener("mousedown",downC):1===add?(par[0].addEventListener("mousemove",moveC),par[0].addEventListener("mouseup",upC),par[0].addEventListener("mouseleave",upC)):2===add&&(par[0].removeEventListener("mousemove",moveC),par[0].removeEventListener("mouseup",upC),par[0].removeEventListener("mouseleave",upC))})(add)}createOrShowLines(sidewidth=10,dockwidth=300){let w=[sidewidth,dockwidth],left=[sidewidth,this.getInnerWidth()-dockwidth],dh=this.viewerheight;for(let ia=0;ia<=1;ia++)w[ia]<100?this.verticalLines[ia]&&(this.midlineCallbacks(2,ia),this.verticalLines[ia].remove(),this.verticalLines2[ia].remove(),this.verticalLines[ia]=null,this.verticalLines2[ia]=null):(this.verticalLines[ia]||(this.verticalLines[ia]=$("<div></div>"),this.domElement.append(this.verticalLines[ia]),this.verticalLines2[ia]=$('<div style="cursor:ew-resize"></div>'),this.domElement.append(this.verticalLines2[ia])),this.verticalLines2[ia].css({position:"absolute",top:`${this.viewertop}px`,"z-index":601,height:`${dh}px`,width:"11px",left:`${left[ia]-5}px`,"background-color":"rgba(10,10,10,0.1)"}),this.verticalLines[ia].css({position:"absolute",top:`${this.viewertop}px`,"z-index":600,height:`${dh}px`,width:"3px",left:`${left[ia]-1}px`,"background-color":"rgba(128,128,128,1.0)"}),this.midlineCallbacks(0,ia))}})},"./js/webcomponents/bisweb_webworkercontroller.js":function(module,exports,__webpack_require__){"use strict";const webutil=__webpack_require__("./js/coreweb/bis_webutil.js"),bis_webworker=__webpack_require__("./js/modules/webworkermoduleutil.js");webutil.defineElement("bisweb-webworkercontroller",class extends HTMLElement{constructor(){super(),this.WebWorker=null,this.outsideResolve=null,this.outsideReject=null;const self=this;this.promise=new Promise((resolve,reject)=>{self.outsideResolve=resolve,self.outsideReject=reject}),this.workerInitialized=!1}connectedCallback(){let newname="webworkermain.js";"undefined"!=typeof BIS&&(newname="../build/web/"+newname);try{this.WebWorker=new Worker(newname)}catch(e){return void console.log(e)}const self=this;this.WebWorker.onmessage=function(e){if("initialized"===e.data)return self.workerInitialized=!0,void self.outsideResolve();let obj=null;try{obj=JSON.parse(e.data)}catch(err){console.log("Unknown message received",err,err.stack,e.data)}obj.modulename?(console.log("WebWorker: Received module done command "+obj.modulename),bis_webworker.inMainThreadModuleDone(obj)):(console.log("WebWorker: error",e.data),bis_webworker.inMainThreadModuleDone({error:"Failed to execute",detail:e.data}))}}getWorker(){return this.WebWorker}executeModule(modulename,inputs,params){const self=this;return new Promise((resolve,reject)=>{let clb=function(o){resolve(o)};self.workerInitialized||self.WebWorker.postMessage("initialize"),self.promise.then(()=>{try{bis_webworker.inMainThreadExecuteModule(this.WebWorker,modulename,inputs,params,clb)}catch(e){reject(e)}}).catch(e=>{console.log("Error = ",e,e.stack),reject(e)})})}})},"./js/webtest/bis_gettestdata.js":function(module,exports,__webpack_require__){const scope=__webpack_require__("./js/coreweb/bis_webutil.js").getScope(),environment=__webpack_require__("./js/core/bis_genericio.js").getenvironment();module.exports={islocal:function(){return"electron"!==environment&&(scope.indexOf("localhost")>=0||scope.indexOf("192.168")>=0)},getbase:function(forcegithub=!1,display=!1){let extra="/";if(display&&(extra="/webtestdata"),forcegithub)return"https://bioimagesuiteweb.github.io/test"+extra;let testDataRootDirectory="";if(this.islocal()){let l=scope.length,ind=scope.lastIndexOf("/build/web"),ind2=scope.lastIndexOf("/web");ind===l-11?testDataRootDirectory=scope.substr(0,l-11)+"/test"+extra:ind2===l-5&&(testDataRootDirectory=scope.substr(0,l-5)+"/test"+extra)}return testDataRootDirectory.length<2&&(testDataRootDirectory="https://bioimagesuiteweb.github.io/test"+extra),testDataRootDirectory}}},"./js/webtest/bisweb_displayregressionelement.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _test_webtestdata_displaytests_json__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./test/webtestdata/displaytests.json");const bis_webfileutil=__webpack_require__("./js/coreweb/bis_webfileutil.js"),webutil=__webpack_require__("./js/coreweb/bis_webutil.js"),$=__webpack_require__("jquery"),bisdate=__webpack_require__("./build/wasm/bisdate.js").date,BisWebImage=__webpack_require__("./js/dataobjects/bisweb_image.js"),userPreferences=__webpack_require__("./js/core/bisweb_userpreferences.js"),gettestdata=__webpack_require__("./js/webtest/bis_gettestdata.js");let displaytestlist=null,globalParams={resdiv:null,testDataRootDirectory:"",resultImageElement:null,goldImageElement:null,comparisonTextElement:null,application:null,currentViewer:null},globalImage=new BisWebImage;globalImage.createImage({dimensions:[2,2,2],numframes:2,type:"float"}),globalImage.getImageData()[4]=2;var runTest=async function(testindex,viewerindex,basestate="",viewerstate="",comparisonpng="",isconnviewer=!1){userPreferences.setImageOrientationOnLoad("None"),isconnviewer||globalParams.application.getViewer(0).setimage(globalImage);try{console.log("Reading app state from",basestate),globalParams.resdiv.append("<p>Reading app state from "+basestate+"</p>"),await globalParams.application.loadApplicationState(basestate),console.log("App state read from ",basestate),viewerstate&&(await globalParams.application.loadApplicationState(viewerstate),console.log("Viewer  state read from ",viewerstate)),globalParams.currentViewer=isconnviewer?globalParams.application.getViewer(0):globalParams.application.getViewer(globalParams.application.getVisibleTab()-1)}catch(e){throw new Error(e)}let snapshotElement=globalParams.currentViewer.getSnapShotController(),canvas=await snapshotElement.getTestImage(),outpng=canvas.toDataURL("image/png");globalParams.resultImageElement.attr("src",outpng),$("#resulttd").empty(),$("#resulttd").append("Result "+testindex);let resultimg=snapshotElement.createBisWebImageFromCanvas(canvas);return console.log("Snapshot created"),new Promise((resolve,reject)=>{let loadfn=()=>{console.log("Image Loaded ... "),$("#goldtd").empty(),$("#goldtd").append("Gold "+testindex),globalParams.goldImageElement.removeEventListener("load",loadfn),snapshotElement.createBisWebImageFromURL(comparisonpng).then(goldstandard=>{setTimeout(()=>{globalParams.resdiv.append("<p>Read result from: "+comparisonpng+"</p>"),console.log(goldstandard.getDescription());let tst=null,dim=goldstandard.getDimensions();try{(tst=resultimg.compareWithOther(goldstandard,"cc",.94)).dim=`${dim[0]},${dim[1]}`}catch(e){console.log("failed ..."+e)}if(null==tst){let canvas=document.createElement("canvas"),image_element=globalParams.resultImageElement[0];canvas.height=dim[1],canvas.width=dim[0],console.log("Canvas=",canvas),canvas.getContext("2d").drawImage(image_element,0,0,dim[0],dim[1]);let newimg=snapshotElement.createBisWebImageFromCanvas(canvas);console.log("newimg=",newimg.getDescription()),console.log("gold=",goldstandard.getDescription());try{tst=newimg.compareWithOther(goldstandard,"cc",.9)}catch(e){console.log("failed ..."+e),tst={testresult:!1,value:-1}}tst.dim=`<EM>(resized)</EM> ${dim[0]},${dim[1]}`}globalParams.resdiv.append(`<p><b>Result</b>: ${JSON.stringify(tst)}</p>`),resolve(tst)},500)}).catch(e=>{reject(e)})};globalParams.goldImageElement.addEventListener("load",loadfn),setTimeout(()=>{comparisonpng=comparisonpng+"?time="+(new Date).getTime(),console.log("Loading comparison from ",comparisonpng),globalParams.goldImageElement.src=comparisonpng},100)})},enableButtons=function(state=!0){let bt=[$("#compute"),$("#computesingle")];for(let i=0;i<bt.length;i++)state?bt[i].removeAttr("disabled"):bt[i].attr("disabled","disabled")},runTests=async function(multiple=!1,isconnviewer=!1){let forcegithub=$("#usegithub").is(":checked")||!1;globalParams.testDataRootDirectory=gettestdata.getbase(forcegithub,!0),console.log("++++ Test Data Directory=",globalParams.testDataRootDirectory),enableButtons(!1),bis_webfileutil.setMode("local",!1),globalParams.resdiv.empty();let first=parseInt($("#first").val())||0,last=parseInt($("#last").val())||0;!1===multiple&&(last=first);let good=0,bad=0,goodlist=[],intentionalfail=[],badlist=[];for(let test=first;test<=last;test++){globalParams.resdiv.append("<HR><p>Starting Test "+test+"</p>");let statefile=displaytestlist[test].state;statefile.length>0&&(statefile=globalParams.testDataRootDirectory+"/"+statefile);let desired=displaytestlist[test].result,result=await runTest(test,displaytestlist[test].viewer,globalParams.testDataRootDirectory+"/"+displaytestlist[test].base,statefile,globalParams.testDataRootDirectory+"/"+displaytestlist[test].comparison,isconnviewer);globalParams.comparisonTextElement.empty();let a="";desired||(a=" (intentiona fail!)");let b="<b>F A I L E D "+a+"</b>";result.testresult&&(b="P A S S E D "+a),globalParams.comparisonTextElement.append("<p>Test:"+test+" cc="+Number.parseFloat(result.value).toFixed(3)+" "+b+"</p>"),globalParams.resdiv.append("<p>Test:"+test+" cc="+Number.parseFloat(result.value).toFixed(3)+" "+b+"</p>"),globalParams.resdiv[0].scrollTop=globalParams.resdiv[0].scrollHeight-50,result.testresult===desired?(good+=1,!1===result.testresult?intentionalfail.push(test):goodlist.push(test)):(bad+=1,badlist.push(test));const webconsole=$("#results");webconsole.empty();let numtests=last-first+1,run=test-first+1,ps="(none)";goodlist.length>0&&(ps="["+goodlist.join(",")+"]");let ifail="(none)";intentionalfail.length>0&&(ifail="["+intentionalfail.join(",")+"]");let fail="(none)";badlist.length>0&&(fail="["+badlist.join(",")+"]"),webconsole.append(`Tests for version=${bisdate}: completed=${run}/${numtests}, passed=${good}/${numtests}, failed=${bad}/${numtests}.&nbsp;&nbsp;&nbsp; <EM>D e t a i l s :</EM> Passed=${ps}, Failed=${fail}, Intentionally Failed=${ifail}`)}if(webutil.createAlert("Tests Completed"),!1===multiple){let newfirst=first+1;newfirst<displaytestlist.length?$("#first").val(newfirst):$("#first").val(0)}enableButtons(!0)},initialize=function(testlist){var fixRange=function(targetname){let target=$(targetname),val=target.val();val<0&&(val=0),val>=testlist.length&&(val=testlist.length-1),target.val(val)};$("#first").change(e=>{e.preventDefault(),fixRange("#first")}),$("#last").change(e=>{e.preventDefault(),fixRange("#last")}),$("#first").val(0),$("#last").val(testlist.length-1)};webutil.defineElement("bisweb-displayregressionelement",class extends HTMLElement{constructor(){super(),webutil.setAlertTop(920)}connectedCallback(){gettestdata.islocal()?(console.log("Islocal"),$("#githubdiv").css({visibility:"visible"})):$("#usegithublab").text("");let numviewers=parseInt(this.getAttribute("bis-numviewers")||1);globalParams.tabset=this.getAttribute("bis-tabset")||null,globalParams.viewerid=[],globalParams.tabid=[];for(let i=1;i<=numviewers;i++)globalParams.viewerid.push(this.getAttribute("bis-viewerid"+i)),globalParams.tabid.push(this.getAttribute("bis-tab"+i));let name=this.getAttribute("bis-testlist")||"overlay";displaytestlist=_test_webtestdata_displaytests_json__WEBPACK_IMPORTED_MODULE_0__[name];let isconnviewer=!1;webutil.runAfterAllLoaded(()=>{console.log("Name = ",name),"overlay"===name?webutil.setAlertTop(920):(webutil.setAlertTop(870),isconnviewer=!0),globalParams.application=document.querySelector(this.getAttribute("bis-application")),globalParams.resdiv=$("#displayresults"),globalParams.resultImageElement=$("#imgoutput"),globalParams.goldImageElement=document.querySelector("#imggold"),globalParams.comparisonTextElement=$("#comparison"),initialize(displaytestlist),$("#compute").click(e=>{e.preventDefault(),runTests(!0,isconnviewer)}),$("#computesingle").click(e=>{e.preventDefault(),runTests(!1,isconnviewer)})})}})},"./js/webtest/bisweb_regressiontestelement.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _test_module_tests_json__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./test/module_tests.json");const $=__webpack_require__("jquery"),moduleindex=__webpack_require__("./js/modules/moduleindex.js"),biswrap=__webpack_require__("./build/wasm/libbiswasm_wrapper.js"),BisWebDataObjectCollection=__webpack_require__("./js/dataobjects/bisweb_dataobjectcollection.js"),webutil=__webpack_require__("./js/coreweb/bis_webutil.js"),systemprint=console.log,bis_genericio=__webpack_require__("./js/core/bis_genericio.js"),userPreferences=__webpack_require__("./js/core/bisweb_userpreferences.js"),bisdate=__webpack_require__("./build/wasm/bisdate.js").date,wrapperutil=__webpack_require__("./js/core/bis_wrapperutils.js"),BisWebImage=__webpack_require__("./js/dataobjects/bisweb_image.js"),bis_webfileutil=__webpack_require__("./js/coreweb/bis_webfileutil.js"),gettestdata=__webpack_require__("./js/webtest/bis_gettestdata.js");let replacing=!1,logtext="",testDataRootDirectory="",testDataModelDirectory="",threadController=null,oldTestDataRootDirectory="",serverDirectory=null,disableServer=function(){bis_webfileutil.setMode("local",!1),testDataRootDirectory=oldTestDataRootDirectory};var replacesystemprint=function(doreplace=!0){if(!0===doreplace&&!1===replacing){const oldLog=console.log;replacing=!0,logtext="",console.log=function(){let keys=Object.keys(arguments),s="";for(let i=0;i<keys.length;i++){let v=arguments[keys[i]];if("object"==typeof v){if(null!==(v.length||null))s+=" ["+v.join(" ")+" ] ";else{let d=Object.keys(v);s+=" { ";for(let i=0;i<d.length;i++)s+=`${d}: ${v[d]} `;s+=" } "}}else s+=v+" "}logtext=logtext+s+"<BR>",oldLog.apply(console,arguments)}}!1===doreplace&&!0===replacing&&(console.log=systemprint,replacing=!1)},execute_test=function(test,usethread=!1){return new Promise((resolve,reject)=>{let command=test.command.replace(/\t/g," ").replace(/ +/g," ").split(" "),modulename=command[0],module=moduleindex.getModule(modulename),params={},inputs={},paramfile="",des=module.getDescription(),test_type=get_test_object(test).test_type||"image";for(let i=1;i<command.length;i+=2){let flag=command[i];if(flag.length>0){let pname=flag.replace(/--/g,"").replace(/-/g,""),value=command[i+1],j=0,found=!1;for(;j<des.inputs.length&&!1===found;){let inp=des.inputs[j];inp.shortname!==pname&&inp.varname!==pname||(inputs[inp.varname]=testDataRootDirectory+value,found=!0),j+=1}if(!1===found)for(j=0;j<des.params.length&&!1===found;){let p=des.params[j];pname!==(p.shortname||"")&&pname!==p.varname||(params[p.varname]=value,found=!0,"modelname"===p.varname&&"tfjs"===test_type&&(params[p.varname]=testDataModelDirectory+value,console.log("Setting ",p.varname,"to ",params[p.varname]))),j+=1}!1===found&&("paramfile"===pname?paramfile=value:reject(`parameter ${flag} not found`))}}"tfjs"===test_type&&(test_type="image");let doworker=test.webworker;!1!==doworker&&(doworker=!0),"registration"===test_type&&(params.doreslice=!0),(paramfile=paramfile,module.name,params=params,paramfile.length<2?Promise.resolve():new Promise((resolve,reject)=>{bis_genericio.read(testDataRootDirectory+paramfile).then(res=>{try{let obj=JSON.parse(res.data);obj=obj.params;let keys=Object.keys(obj);for(let i=0;i<keys.length;i++)"module"!==keys[i]&&void 0===params[keys[i]]&&(params[keys[i]]=obj[keys[i]]);resolve("")}catch(e){reject("Network response was not ok.")}}).catch(e=>{reject(e)})})).then(()=>{console.log("oooo usethread=",usethread),console.log("oooo Loading Inputs ",JSON.stringify(inputs)),module.loadInputs(inputs).then(()=>{console.log("oooo Loaded."),console.log("oooo Invoking Module with params=",JSON.stringify(params));let newParams=module.parseValuesAndAddDefaults(params);usethread?doworker?(console.log("oooo ..........---Calling Web Worker ..............................-"),replacesystemprint(!0),threadController.executeModule(module.name,module.inputs,newParams).then(outputs=>{replacesystemprint(!1),Object.keys(outputs).length<1&&reject("---- Failed to execute in thread manager "),module.outputs=outputs,console.log("oooo ..........---Back from Web Worker ..............................-"),resolve({result:" Test completed, now checking results.",module:module})}).catch(e=>{replacesystemprint(!1),reject("---- Failed to invoke algorithm via thread manager "+e)})):(replacesystemprint(!1),reject("---- Cannot invoke this test via thread manager "+JSON.stringify(test,null,2))):(replacesystemprint(!1),module.directInvokeAlgorithm(newParams).then(()=>{replacesystemprint(!1),console.log("oooo -------------------------------------------------------"),resolve({result:" Test completed, now checking results.",module:module})}).catch(e=>{replacesystemprint(!1),reject("---- Failed to invoke algorithm "+e)}))}).catch(e=>{reject("----- Bad input filenames in test "+e)})}).catch(e=>{reject("----- Bad param file "+e)})});var paramfile,params};let get_test_object=function(test){let t=test.test.replace(/\t/g," ").replace(/ +/g," ").replace(/-+/g,"").split(" "),tobj={};for(let i=0;i<t.length;i+=2)tobj[t[i]]=t[i+1];return tobj};const execute_compare=function(module,test){return new Promise((resolve,reject)=>{let tobj=get_test_object(test),threshold=tobj.test_threshold||.01,comparison=tobj.test_comparison||"maxabs",test_type=tobj.test_type||"image",test_target=tobj.test_target;"image"===test_type&&"maxabs"!==comparison&&"ssd"!==comparison&&(comparison="cc"),"matrix"!==test_type&&"matrixtransform"!==test_type&&"gridtransform"!==test_type||"maxabs"!==comparison&&(comparison="ssd"),console.log("====\n============================================================\n"),console.log(`==== C o m p a r i n g  ${test_type}  u s i n g  ${comparison} and  t h r e s h o l d=${threshold}.\n====`);let c=`<B>Comparing   ${test_type} using ${comparison} and threshold=${threshold}</B>`;const orig_test_type=test_type;"matrixtransform"!==test_type&&"gridtransform"!==test_type||(test_type="transform"),BisWebDataObjectCollection.loadObject(testDataRootDirectory+test_target,test_type).then(obj=>{let resultObject=module.getOutputObject();"registration"===test_type&&(resultObject=module.getOutputObject("resliced"),console.log(".... using resliced output for test")),"gridtransform"===orig_test_type&&(obj=obj.getGridTransformation(0),console.log(".... extracting grid transformation from loaded result for test"));let result=resultObject.compareWithOther(obj,comparison,threshold),good="<",bad=">";"cc"===result.metric&&(bad=good,good=">"),result.testresult?(console.log(`++++ Module ${module.name} test passed.\n++++  deviation (${result.metric}) from expected: ${result.value} ${good} ${threshold}`),resolve({result:result.testresult,text:c+` Module ${module.name} test <span class="passed">passed</span>.<BR>  deviation (${result.metric}) from expected: ${result.value} ${good} ${threshold}`})):(console.log(`---- Module ${module.name} test failed.\n---- Module produced output significantly different from expected.\n----  deviation (${result.metric}) from expected: ${result.value} ${bad} ${threshold}`),resolve({result:result.testresult,text:c+` Module ${module.name} test <span class="failed">failed</span>. Module produced output significantly different from expected.<BR>  deviation (${result.metric}) from expected: ${result.value} ${bad} ${threshold}`}))}).catch(e=>{reject(e)})})};var run_tests=async function(testlist,firsttest=0,lasttest=-1,testname="All",usethread=!1,usefileserver=!1){let forcegithub=$("#usegithub").is(":checked")||!1;testDataRootDirectory=gettestdata.getbase(forcegithub,!1),console.log("++++ Test Data Directory=",testDataRootDirectory),testDataModelDirectory=testDataRootDirectory,oldTestDataRootDirectory=testDataRootDirectory,webutil.inElectronApp()&&window.BISELECTRON.remote.getCurrentWindow().openDevTools();let url=window.document.URL,index=url.indexOf(".html");index>=0&&(url=url.substr(0,index+5));let thread=0;usethread&&(thread=1);let fileserverflag=0;if(usefileserver&&(fileserverflag=1),thread&&null===threadController&&(threadController=document.createElement("bisweb-webworkercontroller"),$("body").append($(threadController))),usefileserver)try{console.log("Enabling Disabling File Server"),await async function(){bis_webfileutil.setMode("server",!1);let serverClient=bis_genericio.getFileServerObject();if(null===serverClient)return!1;if("bisfileserver"===serverClient.getServerType())try{await serverClient.authenticate()}catch(e){return disableServer(),Promise.reject(e)}return null!==serverDirectory||new Promise((resolve,reject)=>{bis_webfileutil.genericFileCallback({filters:"DIRECTORY",suffix:"DIRECTORY",title:"Select Testdata directory",save:!1},function(f){f.length>0?(testDataRootDirectory=(serverDirectory=f)+"/",webutil.createAlert("Connected to "+serverClient.getServerInfo()+". Using "+testDataRootDirectory+" as data directory on server"),resolve()):reject()})})}()}catch(e){return void console.log(e)}else console.log("Disabling File Server"),disableServer();userPreferences.setImageOrientationOnLoad("None"),firsttest<0&&(firsttest=0),(lasttest<=0||lasttest>=testlist.length)&&(lasttest=testlist.length-1);const main=$("#main");main.empty(),"None"!==testname?(main.append("<H3>Running Tests</H3>"),main.append(`Executing tests ${firsttest}:${lasttest} (Max index=${testlist.length-1}).`),"All"!==testname&&main.append(`Only runnng tests with name=${testname}<HR>`)):main.append("<H3>Listing Tests</H3><HR>");let run=0,good=0,bad=0,skipped=0,t00=performance.now(),goodlist=[],intentionalfail=[],badlist=[];for(let i=firsttest;i<=lasttest;i++){let v=testlist[i],name=testlist[i].command.split(" ")[0].trim(),tname="Test_"+i;if("All"===testname||testname.toLowerCase()===name.toLowerCase()){run+=1,main.append(`<a name="${tname}"></a><H4 class="testhead">Test ${i}: ${name}</H4><p><UL><LI> Command: ${v.command}</LI><LI> Test details: ${v.test}</LI><LI> Should pass: ${v.result}</LI>`),usethread&&main.append("<P> Running in WebWorker </P>"),console.log("-------------------------------"),console.log(`-------------------------------\nRunning test ${i}: ${v.command}, ${v.test},${v.result}\n------------------------`);try{let t0=performance.now(),obj=await execute_test(v,usethread);var t1=performance.now();main.append(`.... test execution time=${(.001*(t1-t0)).toFixed(2)}s`);try{let a="<P>.... WASM memory size="+biswrap.get_module().wasmMemory.buffer.byteLength/1048576+" MB.</P>";main.append(a)}catch(e){}main.append(`<p>${obj.result}</p>`);let obj2=await execute_compare(obj.module,v),result=obj2.result,text=obj2.text;result&&v.result?(main.append(`<p>${text}</p>`),good+=1,goodlist.push(tname)):result||v.result?(main.append(`<p><span style="color:red">${text}</span> </p>`),main.append('<BR><H4 style="color:red"> T E S T  F A I L E D</H4><BR>'),bad+=1,badlist.push(tname)):(main.append(`<p>${text} <BR> <B>This is OK as this test WAS EXPECTED to fail!</B></p>`),good+=1,intentionalfail.push(tname))}catch(e){main.append(`<p><span style="color:red">Test Failed ${e}</span></p>`),bad+=1,badlist.push(tname)}main.append(`<details><summary><B>Details</B></summary><PRE>${logtext}</PRE></details><HR>`),window.scrollTo(0,document.body.scrollHeight-100)}else{if("None"===testname){if(webutil.inElectronApp())main.append(`<p>Test ${i}: ${v.command}</p>`);else{let link=`${url}?first=${i}&last=${i}&testname=All&webworker=${thread}&run=1`;main.append(`<p><a href="${link}">Test ${i}:</a> ${v.command}</p>`)}window.scrollTo(0,document.body.scrollHeight-100)}skipped+=1}const webconsole=$("#results");webconsole.empty();let numtests=lasttest-firsttest+1;webconsole.append(`Tests for version=${bisdate}: completed=${run}/${numtests}, passed=${good}/${numtests}, failed=${bad}/${numtests}, skipped=${skipped}/${numtests}`)}let t11=performance.now();if("None"!==testname){if(main.append("<BR><BR><H3>All Tests Finished</H3>"),main.append(`.... total test execution time=${(.001*(t11-t00)).toFixed(2)}s`),!webutil.inElectronApp()){let link=`${url}?first=${firsttest}&last=${lasttest}&testname=${testname}&webworker=${thread}&fileserver=${fileserverflag}&run=1`;main.append(`<BR><p>To run this specific test directly click:<BR> <a href="${link}" target="_blank">${link}</a></p><HR><p></p>`)}window.scrollTo(0,document.body.scrollHeight-100)}else main.append("<BR> <BR> <BR>"),window.scrollTo(0,0);if(goodlist.length>0||badlist.length>0||intentionalfail.length>0){let names=["Passed","Intentionally Failed (which means passed)","Actual Failed"];for(let i=0;i<=2;i++){let lst=goodlist;1==i?lst=intentionalfail:2==i&&(lst=badlist),main.append(`<H4>${names[i]}</H4>`),main.append("<P>");for(let j=0;j<lst.length;j++){let n=lst[j];main.append(`<a href="#${n}">${n}</a>`),j<lst.length-1&&main.append(", ")}0===lst.length&&main.append("None"),main.append("</P><HR>")}main.append("<BR> <BR> <BR>"),window.scrollTo(0,document.body.scrollHeight-100)}};let initialize=function(data){let testlist=data.testlist,names=[];for(let i=0;i<testlist.length;i++){let modulename=testlist[i].command.replace(/\t/g," ").replace(/ +/g," ").split(" ")[0];names.indexOf(modulename)<0&&names.push(modulename)}names=names.sort();let select=$("#testselect");for(let i=0;i<names.length;i++)select.append($(`<option value="${names[i]}">${names[i]}</option>`));let firsttest=parseInt(webutil.getQueryParameter("first"))||0;firsttest<0?firsttest=0:firsttest>testlist.length-1&&(firsttest=testlist.length-1);let lasttest=parseInt(webutil.getQueryParameter("last")||0);(void 0===lasttest||lasttest<=0||lasttest>=testlist.length)&&(lasttest=testlist.length-1);let testname=webutil.getQueryParameter("testname")||"None";"None"!==testname&&"All"!==testname&&names.indexOf(testname)<0&&(testname="None");let usethread=parseInt(webutil.getQueryParameter("webworker")||0),usefileserver=parseInt(webutil.getQueryParameter("fileserver")||0),dorun=parseInt(webutil.getQueryParameter("run")||0);usethread=!!usethread,usefileserver=!!usefileserver,$("#first").val(firsttest),$("#last").val(lasttest),$("#testselect").val(testname),$("#usethread").prop("checked",usethread),webutil.inElectronApp()?usefileserver=!1:$("#usefileserver").prop("checked",usefileserver);var fixRange=function(targetname){let target=$(targetname),val=target.val();val<0&&(val=0),val>=testlist.length&&(val=testlist.length-1),target.val(val)};$("#first").change(e=>{e.preventDefault(),fixRange("#first")}),$("#last").change(e=>{e.preventDefault(),fixRange("#last")});$("#compute").click(e=>{e.preventDefault();let first=parseInt($("#first").val())||0,last=parseInt($("#last").val()),testname=$("#testselect").val()||"All",usethread=$("#usethread").is(":checked")||!1,usefileserver=!1;webutil.inElectronApp()||(usefileserver=$("#usefileserver").is(":checked")||!1),void 0===last&&(last=testlist.length-1),run_tests(testlist,first,last,testname,usethread,usefileserver)}),dorun&&run_tests(testlist,firsttest,lasttest,testname,usethread,usefileserver),webutil.inElectronApp()?($("#computemem").remove(),$("#usefileserverdiv").remove()):$("#computemem").click(function(e){e.preventDefault(),e.stopPropagation(),console.log("Starting"),function(){disableServer();let images=[new BisWebImage,new BisWebImage],imgnames=["thr.nii.gz","thr_sm.nii.gz"],fullnames=["","","",""];for(let i=0;i<=1;i++)fullnames[i]=testDataRootDirectory+"testdata/"+imgnames[i];let p=[biswrap.reinitialize()];for(let i=0;i<images.length;i++)p.push(images[i].load(fullnames[i]));console.log(p);const main=$("#main");main.empty(),main.append("<H3>Running WASM Memory Torture Test</H3><P>"),main.append("<p> This will run the web assembly memory test to try to get to just shy of 2GB. It purposely allocates lots of memory without releasing any.</p>"),Promise.all(p).then(async function(){main.append("<p>Images Loaded</p>");const c=2.1235,paramobj={sigmas:[c,c,c],inmm:!1,radiusfactor:1.5},jsonstring=JSON.stringify(paramobj);let Module=biswrap.get_module(),image1_ptr=0,alloc=async function(delay=500){return new Promise(resolve=>{setTimeout(()=>{for(let j=0;j<=99;j++)0===j?image1_ptr=wrapperutil.serializeObject(Module,images[0],"bisImage"):wrapperutil.serializeObject(Module,images[0],"bisImage");let m=Module.wasmMemory.buffer.byteLength/1048576;resolve(m)},delay)})};main.append("<HR><H4>Running Test</H4><OL>");for(let k=1;k<=22;k++){let delay=10,m=await alloc(delay);main.append(`<LI>${k}. Memory size =  ${m} MB. Last pointer=${image1_ptr}.</LI>`)}main.append("</OL><BR>");let m=Module.wasmMemory.buffer.byteLength/1048576;main.append(`<p>Memory size (end) =${m} MB</p>`);const wasm_output=Module.ccall("gaussianSmoothImageWASM","number",["number","string","number"],[image1_ptr,jsonstring,0]);m=Module.wasmMemory.buffer.byteLength/1048576,main.append(`<p>Memory size=${m} MB, wasm_output=${wasm_output}</p>`);let error=wrapperutil.deserializeAndDeleteObject(Module,wasm_output,"bisImage",images[0]).maxabsdiff(images[1]);main.append(`<p>Final error < 2.0 = ${error}</p>`),console.log(`Final error < 2.0 = ${error}`);let url=window.document.URL,index=url.indexOf(".html");index>=0&&(url=url.substr(0,index+5)),main.append(`<B><a href="${url}">Reload this page</a> before running any other tests.</B>`),window.scrollTo(0,document.body.scrollHeight-100)})}()})};var startFunction=()=>{webutil.inElectronApp()&&$("#cnote").remove(),initialize(_test_module_tests_json__WEBPACK_IMPORTED_MODULE_0__)};webutil.defineElement("bisweb-regressiontestelement",class extends HTMLElement{connectedCallback(){gettestdata.islocal()?(console.log("Islocal"),$("#githubdiv").css({visibility:"visible"})):$("#usegithublab").text(""),window.onload=startFunction}})},"./lib/js/FileSaver.js":function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_RESULT__,saveAs=saveAs||"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob.bind(navigator)||function(view){"use strict";if("undefined"==typeof navigator||!/MSIE [1-9]\./.test(navigator.userAgent)){var doc=view.document,get_URL=function(){return view.URL||view.webkitURL||view},save_link=doc.createElementNS("http://www.w3.org/1999/xhtml","a"),can_use_save_link="download"in save_link,webkit_req_fs=view.webkitRequestFileSystem,req_fs=view.requestFileSystem||webkit_req_fs||view.mozRequestFileSystem,throw_outside=function(ex){(view.setImmediate||view.setTimeout)(function(){throw ex},0)},fs_min_size=0,revoke=function(file){var revoker=function(){"string"==typeof file?get_URL().revokeObjectURL(file):file.remove()};view.chrome?revoker():setTimeout(revoker,500)},dispatch=function(filesaver,event_types,event){for(var i=(event_types=[].concat(event_types)).length;i--;){var listener=filesaver["on"+event_types[i]];if("function"==typeof listener)try{listener.call(filesaver,event||filesaver)}catch(ex){throw_outside(ex)}}},FileSaver=function(blob,name){var object_url,target_view,slice,node,event,filesaver=this,type=blob.type,blob_changed=!1,dispatch_all=function(){dispatch(filesaver,"writestart progress write writeend".split(" "))},fs_error=function(){(!blob_changed&&object_url||(object_url=get_URL().createObjectURL(blob)),target_view)?target_view.location.href=object_url:void 0==view.open(object_url,"_blank")&&"undefined"!=typeof safari&&(view.location.href=object_url);filesaver.readyState=filesaver.DONE,dispatch_all(),revoke(object_url)},abortable=function(func){return function(){if(filesaver.readyState!==filesaver.DONE)return func.apply(this,arguments)}},create_if_not_found={create:!0,exclusive:!1};if(filesaver.readyState=filesaver.INIT,name||(name="download"),can_use_save_link)return object_url=get_URL().createObjectURL(blob),save_link.href=object_url,save_link.download=name,node=save_link,(event=doc.createEvent("MouseEvents")).initMouseEvent("click",!0,!1,view,0,0,0,0,0,!1,!1,!1,!1,0,null),node.dispatchEvent(event),filesaver.readyState=filesaver.DONE,dispatch_all(),void revoke(object_url);view.chrome&&type&&"application/octet-stream"!==type&&(slice=blob.slice||blob.webkitSlice,blob=slice.call(blob,0,blob.size,"application/octet-stream"),blob_changed=!0),webkit_req_fs&&"download"!==name&&(name+=".download"),("application/octet-stream"===type||webkit_req_fs)&&(target_view=view),req_fs?(fs_min_size+=blob.size,req_fs(view.TEMPORARY,fs_min_size,abortable(function(fs){fs.root.getDirectory("saved",create_if_not_found,abortable(function(dir){var save=function(){dir.getFile(name,create_if_not_found,abortable(function(file){file.createWriter(abortable(function(writer){writer.onwriteend=function(event){target_view.location.href=file.toURL(),filesaver.readyState=filesaver.DONE,dispatch(filesaver,"writeend",event),revoke(file)},writer.onerror=function(){var error=writer.error;error.code!==error.ABORT_ERR&&fs_error()},"writestart progress write abort".split(" ").forEach(function(event){writer["on"+event]=filesaver["on"+event]}),writer.write(blob),filesaver.abort=function(){writer.abort(),filesaver.readyState=filesaver.DONE},filesaver.readyState=filesaver.WRITING}),fs_error)}),fs_error)};dir.getFile(name,{create:!1},abortable(function(file){file.remove(),save()}),abortable(function(ex){ex.code===ex.NOT_FOUND_ERR?save():fs_error()}))}),fs_error)}),fs_error)):fs_error()},FS_proto=FileSaver.prototype;return FS_proto.abort=function(){this.readyState=this.DONE,dispatch(this,"abort")},FS_proto.readyState=FS_proto.INIT=0,FS_proto.WRITING=1,FS_proto.DONE=2,FS_proto.error=FS_proto.onwritestart=FS_proto.onprogress=FS_proto.onwrite=FS_proto.onabort=FS_proto.onerror=FS_proto.onwriteend=null,function(blob,name){return new FileSaver(blob,name)}}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);void 0!==module&&module.exports?module.exports=saveAs:null!==__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/buildin/amd-define.js")&&null!=__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/buildin/amd-options.js")&&(void 0===(__WEBPACK_AMD_DEFINE_RESULT__=function(){return saveAs}.apply(exports,[]))||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))},"./lib/js/bootstrap-colorselector.js":function(module,exports){!function($){"use strict";var ColorSelector=function(select,options){this.options=options,this.$select=$(select),this._init()};ColorSelector.prototype={constructor:ColorSelector,_init:function(){var callback=this.options.callback,selectValue=this.$select.val(),selectColor=this.$select.find("option:selected").data("color"),$markupUl=$("<ul>").addClass("dropdown-menu").addClass("dropdown-caret"),$markupDiv=$("<div>").addClass("dropdown").addClass("dropdown-colorselector"),$markupSpan=$("<span>").addClass("btn-colorselector").css("background-color",selectColor),$markupA=$("<a>").attr("data-toggle","dropdown").addClass("dropdown-toggle").attr("href","#").append($markupSpan);$("option",this.$select).each(function(){var option=$(this),value=option.attr("value"),color=option.data("color"),title=option.text(),$markupA=$("<a>").addClass("color-btn");!0!==option.prop("selected")&&selectValue!==color||$markupA.addClass("selected"),$markupA.css("background-color",color),$markupA.attr("href","#").attr("data-color",color).attr("data-value",value).attr("title",title),$markupUl.append($("<li>").append($markupA))}),$markupDiv.append($markupA),$markupDiv.append($markupUl),this.$select.hide(),this.$selector=$($markupDiv).insertAfter(this.$select),this.$select.on("change",function(){var value=$(this).val(),color=$(this).find("option[value='"+value+"']").data("color"),title=$(this).find("option[value='"+value+"']").text();$(this).next().find("ul").find("li").find(".selected").removeClass("selected"),$(this).next().find("ul").find("li").find("a[data-color='"+color+"']").addClass("selected"),$(this).next().find(".btn-colorselector").css("background-color",color),callback(value,color,title)}),$markupUl.on("click.colorselector",$.proxy(this._clickColor,this))},_clickColor:function(e){var a=$(e.target);return!!a.is(".color-btn")&&(this.$select.val(a.data("value")).change(),e.preventDefault(),!0)},setColor:function(color){var value=$(this.$selector).find("li").find("a[data-color='"+color+"']").data("value");this.setValue(value)},setValue:function(value){this.$select.val(value).change()}},$.fn.colorselector=function(option){var args=Array.apply(null,arguments);return args.shift(),this.each(function(){var $this=$(this),data=$this.data("colorselector"),options=$.extend({},$.fn.colorselector.defaults,$this.data(),"object"==typeof option&&option);data||$this.data("colorselector",data=new ColorSelector(this,options)),"string"==typeof option&&data[option].apply(data,args)})},$.fn.colorselector.defaults={callback:function(value,color,title){},colorsPerRow:8},$.fn.colorselector.Constructor=ColorSelector}(jQuery,window,document)},"./lib/js/fs.js":function(module,exports){},"./lib/js/inobounce.js":function(module,exports){!function(global){var startY=0,enabled=!1,supportsPassiveOption=!1;try{var opts=Object.defineProperty({},"passive",{get:function(){supportsPassiveOption=!0}});window.addEventListener("test",null,opts)}catch(e){}var handleTouchmove=function(evt){for(var el=evt.target;el!==document.body&&el!==document;){var style=window.getComputedStyle(el);if(!style)break;if("INPUT"===el.nodeName&&"range"===el.getAttribute("type"))return;var scrolling=style.getPropertyValue("-webkit-overflow-scrolling"),overflowY=style.getPropertyValue("overflow-y"),height=parseInt(style.getPropertyValue("height"),10),isScrollable="touch"===scrolling&&("auto"===overflowY||"scroll"===overflowY),canScroll=el.scrollHeight>el.offsetHeight;if(isScrollable&&canScroll){var curY=evt.touches?evt.touches[0].screenY:evt.screenY,isAtTop=startY<=curY&&0===el.scrollTop,isAtBottom=startY>=curY&&el.scrollHeight-el.scrollTop===height;return void((isAtTop||isAtBottom)&&evt.preventDefault())}el=el.parentNode}evt.preventDefault()},handleTouchstart=function(evt){startY=evt.touches?evt.touches[0].screenY:evt.screenY},testDiv=document.createElement("div");document.documentElement.appendChild(testDiv),testDiv.style.WebkitOverflowScrolling="touch";"getComputedStyle"in window&&window.getComputedStyle(testDiv)["-webkit-overflow-scrolling"];document.documentElement.removeChild(testDiv);var iNoBounce={enable:function(){window.addEventListener("touchstart",handleTouchstart,!!supportsPassiveOption&&{passive:!1}),window.addEventListener("touchmove",handleTouchmove,!!supportsPassiveOption&&{passive:!1}),enabled=!0},disable:function(){window.removeEventListener("touchstart",handleTouchstart,!1),window.removeEventListener("touchmove",handleTouchmove,!1),enabled=!1},isEnabled:function(){return enabled}};void 0!==module&&module.exports&&(module.exports=iNoBounce),"function"==typeof global.define?(0,global.define)("iNoBounce",[],function(){return iNoBounce}):global.iNoBounce=iNoBounce}(this)},"./lib/js/tiff2.js":function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var ex,IOBuffer=(ex=__webpack_require__("./node_modules/iobuffer/IOBuffer.js"))&&"object"==typeof ex&&"default"in ex?ex.default:ex;const tagsById={254:"NewSubfileType",255:"SubfileType",256:"ImageWidth",257:"ImageLength",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",263:"Threshholding",264:"CellWidth",265:"CellLength",266:"FillOrder",270:"ImageDescription",271:"Make",272:"Model",273:"StripOffsets",274:"Orientation",277:"SamplesPerPixel",278:"RowsPerStrip",279:"StripByteCounts",280:"MinSampleValue",281:"MaxSampleValue",282:"XResolution",283:"YResolution",284:"PlanarConfiguration",288:"FreeOffsets",289:"FreeByteCounts",290:"GrayResponseUnit",291:"GrayResponseCurve",296:"ResolutionUnit",305:"Software",306:"DateTime",315:"Artist",316:"HostComputer",320:"ColorMap",338:"ExtraSamples",33432:"Copyright",269:"DocumentName",285:"PageName",286:"XPosition",287:"YPosition",292:"T4Options",293:"T6Options",297:"PageNumber",301:"TransferFunction",317:"Predictor",318:"WhitePoint",319:"PrimaryChromaticities",321:"HalftoneHints",322:"TileWidth",323:"TileLength",324:"TileOffsets",325:"TileByteCounts",326:"BadFaxLines",327:"CleanFaxData",328:"ConsecutiveBadFaxLines",330:"SubIFDs",332:"InkSet",333:"InkNames",334:"NumberOfInks",336:"DotRange",337:"TargetPrinter",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",342:"TransferRange",343:"ClipPath",344:"XClipPathUnits",345:"YClipPathUnits",346:"Indexed",347:"JPEGTables",351:"OPIProxy",400:"GlobalParametersIFD",401:"ProfileType",402:"FaxProfile",403:"CodingMethods",404:"VersionYear",405:"ModeNumber",433:"Decode",434:"DefaultImageColor",512:"JPEGProc",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",515:"JPEGRestartInterval",517:"JPEGLosslessPredictors",518:"JPEGPointTransforms",519:"JPEGQTables",520:"JPEGDCTables",521:"JPEGACTables",529:"YCbCrCoefficients",530:"YCbCrSubSampling",531:"YCbCrPositioning",532:"ReferenceBlackWhite",559:"StripRowCounts",700:"XMP",32781:"ImageID",34732:"ImageLayer",32932:"WangAnnotatio",33445:"MDFileTag",33446:"MDScalePixel",33447:"MDColorTable",33448:"MDLabName",33449:"MDSampleInfo",33450:"MDPrepDate",33451:"MDPrepTime",33452:"MDFileUnits",33550:"ModelPixelScaleTag",33723:"IPTC",33918:"INGRPacketDataTag",33919:"INGRFlagRegisters",33920:"IrasBTransformationMatrix",33922:"ModelTiepointTag",34264:"ModelTransformationTag",34377:"Photoshop",34665:"ExifIFD",34675:"ICCProfile",34735:"GeoKeyDirectoryTag",34736:"GeoDoubleParamsTag",34737:"GeoAsciiParamsTag",34853:"GPSIFD",34908:"HylaFAXFaxRecvParams",34909:"HylaFAXFaxSubAddress",34910:"HylaFAXFaxRecvTime",37724:"ImageSourceData",40965:"InteroperabilityIFD",42112:"GDAL_METADATA",42113:"GDAL_NODATA",50215:"OceScanjobDescription",50216:"OceApplicationSelector",50217:"OceIdentificationNumber",50218:"OceImageLogicCharacteristics",50706:"DNGVersion",50707:"DNGBackwardVersion",50708:"UniqueCameraModel",50709:"LocalizedCameraModel",50710:"CFAPlaneColor",50711:"CFALayout",50712:"LinearizationTable",50713:"BlackLevelRepeatDim",50714:"BlackLevel",50715:"BlackLevelDeltaH",50716:"BlackLevelDeltaV",50717:"WhiteLevel",50718:"DefaultScale",50719:"DefaultCropOrigin",50720:"DefaultCropSize",50721:"ColorMatrix1",50722:"ColorMatrix2",50723:"CameraCalibration1",50724:"CameraCalibration2",50725:"ReductionMatrix1",50726:"ReductionMatrix2",50727:"AnalogBalance",50728:"AsShotNeutral",50729:"AsShotWhiteXY",50730:"BaselineExposure",50731:"BaselineNoise",50732:"BaselineSharpness",50733:"BayerGreenSplit",50734:"LinearResponseLimit",50735:"CameraSerialNumber",50736:"LensInfo",50737:"ChromaBlurRadius",50738:"AntiAliasStrength",50740:"DNGPrivateData",50741:"MakerNoteSafety",50778:"CalibrationIlluminant1",50779:"CalibrationIlluminant2",50780:"BestQualityScale",50784:"AliasLayerMetadata"},tagsByName={};for(var i in tagsById)tagsByName[tagsById[i]]=i;var standard=Object.freeze({tagsById:tagsById,tagsByName:tagsByName});const tagsById$1={33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"ISOSpeedRatings",34856:"OECF",34864:"SensitivityType",34865:"StandardOutputSensitivity",34866:"RecommendedExposureIndex",34867:"ISOSpeed",34868:"ISOSpeedLatitudeyyy",34869:"ISOSpeedLatitudezzz",36864:"ExifVersion",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBiasValue",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",37396:"SubjectArea",37500:"MakerNote",37510:"UserComment",37520:"SubsecTime",37521:"SubsecTimeOriginal",37522:"SubsecTimeDigitized",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",40964:"RelatedSoundFile",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRatio",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",42016:"ImageUniqueID",42032:"CameraOwnerName",42033:"BodySerialNumber",42034:"LensSpecification",42035:"LensMake",42036:"LensModel",42037:"LensSerialNumber",42240:"Gamma"},tagsByName$1={};for(var i$1 in tagsById$1)tagsByName$1[tagsById$1[i$1]]=i$1;var exif=Object.freeze({tagsById:tagsById$1,tagsByName:tagsByName$1});const tagsById$2={0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential",31:"GPSHPositioningError"},tagsByName$2={};for(var i$2 in tagsById$2)tagsByName$2[tagsById$2[i$2]]=i$2;const tags={standard:standard,exif:exif,gps:Object.freeze({tagsById:tagsById$2,tagsByName:tagsByName$2})};class IFD{constructor(kind){if(!kind)throw new Error("missing kind");this.data=null,this.fields=new Map,this.kind=kind,this._map=null}get(tag){if("number"==typeof tag)return this.fields.get(tag);if("string"==typeof tag)return this.fields.get(tags[this.kind].tagsByName[tag]);throw new Error("expected a number or string")}get map(){if(!this._map){this._map={};const taglist=tags[this.kind].tagsById;for(var key of this.fields.keys())taglist[key]&&(this._map[taglist[key]]=this.fields.get(key))}return this._map}}const dateTimeRegex=/^(\d{4}):(\d{2}):(\d{2}) (\d{2}):(\d{2}):(\d{2})$/;class TiffIfd extends IFD{constructor(){super("standard")}get size(){return this.width*this.height}get width(){return this.imageWidth}get height(){return this.imageLength}get components(){return this.samplesPerPixel}get date(){var date=new Date,result=dateTimeRegex.exec(this.dateTime);return date.setFullYear(result[1],result[2]-1,result[3]),date.setHours(result[4],result[5],result[6]),date}get newSubfileType(){return this.get(254)}get imageWidth(){return this.get(256)}get imageLength(){return this.get(257)}get bitsPerSample(){return this.get(258)}get compression(){return this.get(259)||1}get type(){return this.get(262)}get fillOrder(){return this.get(266)||1}get documentName(){return this.get(269)}get imageDescription(){return this.get(270)}get stripOffsets(){return alwaysArray(this.get(273))}get orientation(){return this.get(274)}get samplesPerPixel(){return this.get(277)}get rowsPerStrip(){return this.get(278)}get stripByteCounts(){return alwaysArray(this.get(279))}get minSampleValue(){return this.get(280)||0}get maxSampleValue(){return this.get(281)||Math.pow(2,this.bitsPerSample)-1}get xResolution(){return this.get(282)}get yResolution(){return this.get(283)}get planarConfiguration(){return this.get(284)||1}get resolutionUnit(){return this.get(296)||2}get dateTime(){return this.get(306)}get predictor(){return this.get(317)||1}get sampleFormat(){return this.get(339)||1}get sMinSampleValue(){return this.get(340)||this.minSampleValue}get sMaxSampleValue(){return this.get(341)||this.maxSampleValue}}function alwaysArray(value){return"number"==typeof value?[value]:value}var types=new Map([[1,[1,readByte]],[2,[1,function(decoder,count){for(var strings=[],currentString="",i=0;i<count;i++){var char=String.fromCharCode(decoder.readUint8());"\0"===char?(strings.push(currentString),currentString=""):currentString+=char}return 1===strings.length?strings[0]:strings}]],[3,[2,function(decoder,count){if(1===count)return decoder.readUint16();for(var array=new Uint16Array(count),i=0;i<count;i++)array[i]=decoder.readUint16();return array}]],[4,[4,function(decoder,count){if(1===count)return decoder.readUint32();for(var array=new Uint32Array(count),i=0;i<count;i++)array[i]=decoder.readUint32();return array}]],[5,[8,function(decoder,count){if(1===count)return decoder.readUint32()/decoder.readUint32();for(var rationals=new Array(count),i=0;i<count;i++)rationals[i]=decoder.readUint32()/decoder.readUint32();return rationals}]],[6,[1,function(decoder,count){if(1===count)return decoder.readInt8();for(var array=new Int8Array(count),i=0;i<count;i++)array[i]=decoder.readInt8();return array}]],[7,[1,readByte]],[8,[2,function(decoder,count){if(1===count)return decoder.readInt16();for(var array=new Int16Array(count),i=0;i<count;i++)array[i]=decoder.readInt16();return array}]],[9,[4,function(decoder,count){if(1===count)return decoder.readInt32();for(var array=new Int32Array(count),i=0;i<count;i++)array[i]=decoder.readInt32();return array}]],[10,[8,function(decoder,count){if(1===count)return decoder.readInt32()/decoder.readInt32();for(var rationals=new Array(count),i=0;i<count;i++)rationals[i]=decoder.readInt32()/decoder.readInt32();return rationals}]],[11,[4,function(decoder,count){if(1===count)return decoder.readFloat32();for(var array=new Float32Array(count),i=0;i<count;i++)array[i]=decoder.readFloat32();return array}]],[12,[8,function(decoder,count){if(1===count)return decoder.readFloat64();for(var array=new Float64Array(count),i=0;i<count;i++)array[i]=decoder.readFloat64();return array}]]]);function readByte(decoder,count){if(1===count)return decoder.readUint8();for(var array=new Uint8Array(count),i=0;i<count;i++)array[i]=decoder.readUint8();return array}const defaultOptions={ignoreImageData:!1,onlyFirst:!1};class TIFFDecoder extends IOBuffer{constructor(data,options){super(data,options),this._nextIFD=0}get isMultiPage(){let c=0;for(this.decodeHeader();this._nextIFD;)if(c++,this.decodeIFD({ignoreImageData:!0}),2===c)return!0;if(1===c)return!1;throw unsupported("ifdCount",c)}get nextIFD(){return this._nextIFD}get pageCount(){let c=0;for(this.decodeHeader();this._nextIFD;)c++,this.decodeIFD({ignoreImageData:!0});if(c>0)return c;throw unsupported("ifdCount",c)}decode(options){options=Object.assign({},defaultOptions,options);const result=[];for(this.decodeHeader();this._nextIFD;)if(result.push(this.decodeIFD(options)),options.onlyFirst)return result[0];return result}decodeHeader(){const value=this.readUint16();if(18761===value)this.setLittleEndian();else{if(19789!==value)throw new Error("invalid byte order: 0x"+value.toString(16));this.setBigEndian()}if(42!==this.readUint16())throw new Error("not a TIFF file");this._nextIFD=this.readUint32()}decodeIFD(options){var ifd;this.seek(this._nextIFD),ifd=options.kind?new IFD(options.kind):new TiffIfd;const numEntries=this.readUint16();for(var i=0;i<numEntries;i++)this.decodeIFDEntry(ifd);return options.ignoreImageData||this.decodeImageData(ifd),this._nextIFD=this.readUint32(),ifd}decodeIFDEntry(ifd){const offset=this.offset,tag=this.readUint16(),type=this.readUint16(),numValues=this.readUint32();if(type<1||type>12)return void this.skip(4);(function(type,count){return types.get(type)[0]*count})(type,numValues)>4&&this.seek(this.readUint32());const value=function(decoder,type,count){return types.get(type)[1](decoder,count)}(this,type,numValues);if(ifd.fields.set(tag,value),34665===tag||34853===tag){let kind,currentOffset=this.offset;34665===tag?kind="exif":34853===tag&&(kind="gps"),this._nextIFD=value,ifd[kind]=this.decodeIFD({kind:kind,ignoreImageData:!0}),this.offset=currentOffset}this.seek(offset),this.skip(12)}decodeImageData(ifd){const orientation=ifd.orientation;if(orientation&&1!==orientation)throw unsupported("orientation",orientation);switch(ifd.type){case 1:case 2:this.readStripData(ifd);break;default:throw unsupported("image type",ifd.type)}}readStripData(ifd){const width=ifd.width,height=ifd.height,bitDepth=function(bitDepth){if(bitDepth.length){const bitDepthArray=bitDepth;bitDepth=bitDepthArray[0];for(var i=0;i<bitDepthArray.length;i++)if(bitDepthArray[i]!==bitDepth)throw unsupported("bit depth",bitDepthArray)}return bitDepth}(ifd.bitsPerSample),sampleFormat=ifd.sampleFormat,size=width*height,data=function(size,channels,bitDepth,sampleFormat){if(8===bitDepth)return new Uint8Array(size*channels);if(16===bitDepth)return 1===sampleFormat?new Uint16Array(size*channels):new Int16Array(size*channels);if(32===bitDepth&&3===sampleFormat)return new Float32Array(size*channels);throw unsupported("bit depth / sample format",bitDepth+" / "+sampleFormat)}(size,1,bitDepth,sampleFormat),compression=ifd.compression,maxPixels=ifd.rowsPerStrip*width,stripOffsets=ifd.stripOffsets,stripByteCounts=ifd.stripByteCounts;for(var remainingPixels=size,pixel=0,i=0;i<stripOffsets.length;i++){var stripData=new DataView(this.buffer,stripOffsets[i],stripByteCounts[i]),length=remainingPixels>maxPixels?maxPixels:remainingPixels;switch(remainingPixels-=length,compression){case 1:pixel=this.fillUncompressed(bitDepth,sampleFormat,data,stripData,pixel,length);break;case 5:throw unsupported("lzw");case 2:case 32773:throw unsupported("Compression",compression);default:throw new Error("invalid compression: "+compression)}}ifd.data=data}fillUncompressed(bitDepth,sampleFormat,data,stripData,pixel,length){if(8===bitDepth)return function(dataTo,dataFrom,index,length){for(var i=0;i<length;i++)dataTo[index++]=dataFrom.getUint8(i);return index}(data,stripData,pixel,length);if(16===bitDepth)return function(dataTo,dataFrom,index,length,littleEndian){for(var i=0;i<2*length;i+=2)dataTo[index++]=dataFrom.getUint16(i,littleEndian);return index}(data,stripData,pixel,length,this.isLittleEndian());if(32===bitDepth&&3===sampleFormat)return function(dataTo,dataFrom,index,length,littleEndian){for(var i=0;i<4*length;i+=4)dataTo[index++]=dataFrom.getFloat32(i,littleEndian);return index}(data,stripData,pixel,length,this.isLittleEndian());throw unsupported("bitDepth",bitDepth)}}function unsupported(type,value){return new Error("Unsupported "+type+": "+value)}exports.decode=function(data,options={}){return new TIFFDecoder(data,options).decode(options)},exports.isMultiPage=function(data){return new TIFFDecoder(data).isMultiPage},exports.pageCount=function(data){return new TIFFDecoder(data).pageCount},exports.newobject=function(data,options={}){return new TIFFDecoder(data,options)}},"./node_modules/atob/browser-atob.js":function(module,exports,__webpack_require__){(function(Buffer,module){!function(w){"use strict";var atobNative,atobBest="function"==typeof(atobNative=w.atob)?atobNative:"function"==typeof Buffer?function(a){return new Buffer(a,"base64").toString("binary")}:"object"==typeof w.base64js?function(a){var buf=w.base64js.b64ToByteArray(a);return Array.prototype.map.call(buf,function(ch){return String.fromCharCode(ch)}).join("")}:function(){throw new Error("You're probably in an old browser or an iOS webworker. It might help to include beatgammit's base64-js.")};w.atob=atobBest,"object"==typeof module&&module&&module.exports&&(module.exports=atobBest)}(window)}).call(this,__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/node_modules/buffer/index.js?c412").Buffer,__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/buildin/module.js")(module))},"./node_modules/balanced-match/index.js":function(module,exports,__webpack_require__){"use strict";function balanced(a,b,str){a instanceof RegExp&&(a=maybeMatch(a,str)),b instanceof RegExp&&(b=maybeMatch(b,str));var r=range(a,b,str);return r&&{start:r[0],end:r[1],pre:str.slice(0,r[0]),body:str.slice(r[0]+a.length,r[1]),post:str.slice(r[1]+b.length)}}function maybeMatch(reg,str){var m=str.match(reg);return m?m[0]:null}function range(a,b,str){var begs,beg,left,right,result,ai=str.indexOf(a),bi=str.indexOf(b,ai+1),i=ai;if(ai>=0&&bi>0){for(begs=[],left=str.length;i>=0&&!result;)i==ai?(begs.push(i),ai=str.indexOf(a,i+1)):1==begs.length?result=[begs.pop(),bi]:((beg=begs.pop())<left&&(left=beg,right=bi),bi=str.indexOf(b,i+1)),i=ai<bi&&ai>=0?ai:bi;begs.length&&(result=[left,right])}return result}module.exports=balanced,balanced.range=range},"./node_modules/base64-js/index.js":function(module,exports,__webpack_require__){"use strict";exports.byteLength=function(b64){var lens=getLens(b64),validLen=lens[0],placeHoldersLen=lens[1];return 3*(validLen+placeHoldersLen)/4-placeHoldersLen},exports.toByteArray=function(b64){for(var tmp,lens=getLens(b64),validLen=lens[0],placeHoldersLen=lens[1],arr=new Arr(function(b64,validLen,placeHoldersLen){return 3*(validLen+placeHoldersLen)/4-placeHoldersLen}(0,validLen,placeHoldersLen)),curByte=0,len=placeHoldersLen>0?validLen-4:validLen,i=0;i<len;i+=4)tmp=revLookup[b64.charCodeAt(i)]<<18|revLookup[b64.charCodeAt(i+1)]<<12|revLookup[b64.charCodeAt(i+2)]<<6|revLookup[b64.charCodeAt(i+3)],arr[curByte++]=tmp>>16&255,arr[curByte++]=tmp>>8&255,arr[curByte++]=255&tmp;2===placeHoldersLen&&(tmp=revLookup[b64.charCodeAt(i)]<<2|revLookup[b64.charCodeAt(i+1)]>>4,arr[curByte++]=255&tmp);1===placeHoldersLen&&(tmp=revLookup[b64.charCodeAt(i)]<<10|revLookup[b64.charCodeAt(i+1)]<<4|revLookup[b64.charCodeAt(i+2)]>>2,arr[curByte++]=tmp>>8&255,arr[curByte++]=255&tmp);return arr},exports.fromByteArray=function(uint8){for(var tmp,len=uint8.length,extraBytes=len%3,parts=[],i=0,len2=len-extraBytes;i<len2;i+=16383)parts.push(encodeChunk(uint8,i,i+16383>len2?len2:i+16383));1===extraBytes?(tmp=uint8[len-1],parts.push(lookup[tmp>>2]+lookup[tmp<<4&63]+"==")):2===extraBytes&&(tmp=(uint8[len-2]<<8)+uint8[len-1],parts.push(lookup[tmp>>10]+lookup[tmp>>4&63]+lookup[tmp<<2&63]+"="));return parts.join("")};for(var lookup=[],revLookup=[],Arr="undefined"!=typeof Uint8Array?Uint8Array:Array,code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,len=code.length;i<len;++i)lookup[i]=code[i],revLookup[code.charCodeAt(i)]=i;function getLens(b64){var len=b64.length;if(len%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var validLen=b64.indexOf("=");return-1===validLen&&(validLen=len),[validLen,validLen===len?0:4-validLen%4]}function encodeChunk(uint8,start,end){for(var tmp,num,output=[],i=start;i<end;i+=3)tmp=(uint8[i]<<16&16711680)+(uint8[i+1]<<8&65280)+(255&uint8[i+2]),output.push(lookup[(num=tmp)>>18&63]+lookup[num>>12&63]+lookup[num>>6&63]+lookup[63&num]);return output.join("")}revLookup["-".charCodeAt(0)]=62,revLookup["_".charCodeAt(0)]=63},"./node_modules/bootbox/bootbox.js":function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;!function(root,factory){"use strict";__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__("jquery")],void 0===(__WEBPACK_AMD_DEFINE_RESULT__="function"==typeof(__WEBPACK_AMD_DEFINE_FACTORY__=function init($,undefined){var templates={dialog:"<div class='bootbox modal' tabindex='-1' role='dialog'><div class='modal-dialog'><div class='modal-content'><div class='modal-body'><div class='bootbox-body'></div></div></div></div></div>",header:"<div class='modal-header'><h4 class='modal-title'></h4></div>",footer:"<div class='modal-footer'></div>",closeButton:"<button type='button' class='bootbox-close-button close' data-dismiss='modal' aria-hidden='true'>&times;</button>",form:"<form class='bootbox-form'></form>",inputs:{text:"<input class='bootbox-input bootbox-input-text form-control' autocomplete=off type=text />",textarea:"<textarea class='bootbox-input bootbox-input-textarea form-control'></textarea>",email:"<input class='bootbox-input bootbox-input-email form-control' autocomplete='off' type='email' />",select:"<select class='bootbox-input bootbox-input-select form-control'></select>",checkbox:"<div class='checkbox'><label><input class='bootbox-input bootbox-input-checkbox' type='checkbox' /></label></div>",date:"<input class='bootbox-input bootbox-input-date form-control' autocomplete=off type='date' />",time:"<input class='bootbox-input bootbox-input-time form-control' autocomplete=off type='time' />",number:"<input class='bootbox-input bootbox-input-number form-control' autocomplete=off type='number' />",password:"<input class='bootbox-input bootbox-input-password form-control' autocomplete='off' type='password' />"}},defaults={locale:"en",backdrop:"static",animate:!0,className:null,closeButton:!0,show:!0,container:"body"},exports={};function _t(key){var locale=locales[defaults.locale];return locale?locale[key]:locales.en[key]}function processCallback(e,dialog,callback){e.stopPropagation(),e.preventDefault();var preserveDialog=$.isFunction(callback)&&!1===callback.call(dialog,e);preserveDialog||dialog.modal("hide")}function each(collection,iterator){var index=0;$.each(collection,function(key,value){iterator(key,value,index++)})}function mergeArguments(defaults,args,properties){return $.extend(!0,{},defaults,function(args,properties){var argn=args.length,options={};if(argn<1||argn>2)throw new Error("Invalid argument length");2===argn||"string"==typeof args[0]?(options[properties[0]]=args[0],options[properties[1]]=args[1]):options=args[0];return options}(args,properties))}function mergeDialogOptions(className,labels,properties,args){var baseOptions={className:"bootbox-"+className,buttons:createLabels.apply(null,labels)};return validateButtons(mergeArguments(baseOptions,args,properties),labels)}function createLabels(){for(var buttons={},i=0,j=arguments.length;i<j;i++){var argument=arguments[i],key=argument.toLowerCase(),value=argument.toUpperCase();buttons[key]={label:_t(value)}}return buttons}function validateButtons(options,buttons){var allowedButtons={};return each(buttons,function(key,value){allowedButtons[value]=!0}),each(options.buttons,function(key){if(allowedButtons[key]===undefined)throw new Error("button key "+key+" is not allowed (options are "+buttons.join("\n")+")")}),options}exports.alert=function(){var options;if((options=mergeDialogOptions("alert",["ok"],["message","callback"],arguments)).callback&&!$.isFunction(options.callback))throw new Error("alert requires callback property to be a function when provided");return options.buttons.ok.callback=options.onEscape=function(){return!$.isFunction(options.callback)||options.callback.call(this)},exports.dialog(options)},exports.confirm=function(){var options;if((options=mergeDialogOptions("confirm",["cancel","confirm"],["message","callback"],arguments)).buttons.cancel.callback=options.onEscape=function(){return options.callback.call(this,!1)},options.buttons.confirm.callback=function(){return options.callback.call(this,!0)},!$.isFunction(options.callback))throw new Error("confirm requires a callback");return exports.dialog(options)},exports.prompt=function(){var options,defaults,dialog,form,input,shouldShow,inputOptions;if(form=$(templates.form),defaults={className:"bootbox-prompt",buttons:createLabels("cancel","confirm"),value:"",inputType:"text"},options=validateButtons(mergeArguments(defaults,arguments,["title","callback"]),["cancel","confirm"]),shouldShow=options.show===undefined||options.show,options.message=form,options.buttons.cancel.callback=options.onEscape=function(){return options.callback.call(this,null)},options.buttons.confirm.callback=function(){var value;switch(options.inputType){case"text":case"textarea":case"email":case"select":case"date":case"time":case"number":case"password":value=input.val();break;case"checkbox":var checkedItems=input.find("input:checked");value=[],each(checkedItems,function(_,item){value.push($(item).val())})}return options.callback.call(this,value)},options.show=!1,!options.title)throw new Error("prompt requires a title");if(!$.isFunction(options.callback))throw new Error("prompt requires a callback");if(!templates.inputs[options.inputType])throw new Error("invalid prompt type");switch(input=$(templates.inputs[options.inputType]),options.inputType){case"text":case"textarea":case"email":case"date":case"time":case"number":case"password":input.val(options.value);break;case"select":var groups={};if(inputOptions=options.inputOptions||[],!$.isArray(inputOptions))throw new Error("Please pass an array of input options");if(!inputOptions.length)throw new Error("prompt with select requires options");each(inputOptions,function(_,option){var elem=input;if(option.value===undefined||option.text===undefined)throw new Error("given options in wrong format");option.group&&(groups[option.group]||(groups[option.group]=$("<optgroup/>").attr("label",option.group)),elem=groups[option.group]),elem.append("<option value='"+option.value+"'>"+option.text+"</option>")}),each(groups,function(_,group){input.append(group)}),input.val(options.value);break;case"checkbox":var values=$.isArray(options.value)?options.value:[options.value];if(!(inputOptions=options.inputOptions||[]).length)throw new Error("prompt with checkbox requires options");if(!inputOptions[0].value||!inputOptions[0].text)throw new Error("given options in wrong format");input=$("<div/>"),each(inputOptions,function(_,option){var checkbox=$(templates.inputs[options.inputType]);checkbox.find("input").attr("value",option.value),checkbox.find("label").append(option.text),each(values,function(_,value){value===option.value&&checkbox.find("input").prop("checked",!0)}),input.append(checkbox)})}return options.placeholder&&input.attr("placeholder",options.placeholder),options.pattern&&input.attr("pattern",options.pattern),options.maxlength&&input.attr("maxlength",options.maxlength),form.append(input),form.on("submit",function(e){e.preventDefault(),e.stopPropagation(),dialog.find(".btn-primary").click()}),(dialog=exports.dialog(options)).off("shown.bs.modal"),dialog.on("shown.bs.modal",function(){input.focus()}),!0===shouldShow&&dialog.modal("show"),dialog},exports.dialog=function(options){options=function(options){var buttons,total;if("object"!=typeof options)throw new Error("Please supply an object of options");if(!options.message)throw new Error("Please specify a message");(options=$.extend({},defaults,options)).buttons||(options.buttons={});return buttons=options.buttons,total=function(obj){var k,t=0;for(k in obj)t++;return t}(buttons),each(buttons,function(key,button,index){if($.isFunction(button)&&(button=buttons[key]={callback:button}),"object"!==$.type(button))throw new Error("button with key "+key+" must be an object");button.label||(button.label=key),button.className||(button.className=total<=2&&index===total-1?"btn-primary":"btn-default")}),options}(options);var dialog=$(templates.dialog),innerDialog=dialog.find(".modal-dialog"),body=dialog.find(".modal-body"),buttons=options.buttons,buttonStr="",callbacks={onEscape:options.onEscape};if($.fn.modal===undefined)throw new Error("$.fn.modal is not defined; please double check you have included the Bootstrap JavaScript library. See http://getbootstrap.com/javascript/ for more details.");if(each(buttons,function(key,button){buttonStr+="<button data-bb-handler='"+key+"' type='button' class='btn "+button.className+"'>"+button.label+"</button>",callbacks[key]=button.callback}),body.find(".bootbox-body").html(options.message),!0===options.animate&&dialog.addClass("fade"),options.className&&dialog.addClass(options.className),"large"===options.size?innerDialog.addClass("modal-lg"):"small"===options.size&&innerDialog.addClass("modal-sm"),options.title&&body.before(templates.header),options.closeButton){var closeButton=$(templates.closeButton);options.title?dialog.find(".modal-header").prepend(closeButton):closeButton.css("margin-top","-10px").prependTo(body)}return options.title&&dialog.find(".modal-title").html(options.title),buttonStr.length&&(body.after(templates.footer),dialog.find(".modal-footer").html(buttonStr)),dialog.on("hidden.bs.modal",function(e){e.target===this&&dialog.remove()}),dialog.on("shown.bs.modal",function(){dialog.find(".btn-primary:first").focus()}),"static"!==options.backdrop&&dialog.on("click.dismiss.bs.modal",function(e){dialog.children(".modal-backdrop").length&&(e.currentTarget=dialog.children(".modal-backdrop").get(0)),e.target===e.currentTarget&&dialog.trigger("escape.close.bb")}),dialog.on("escape.close.bb",function(e){callbacks.onEscape&&processCallback(e,dialog,callbacks.onEscape)}),dialog.on("click",".modal-footer button",function(e){var callbackKey=$(this).data("bb-handler");processCallback(e,dialog,callbacks[callbackKey])}),dialog.on("click",".bootbox-close-button",function(e){processCallback(e,dialog,callbacks.onEscape)}),dialog.on("keyup",function(e){27===e.which&&dialog.trigger("escape.close.bb")}),$(options.container).append(dialog),dialog.modal({backdrop:!!options.backdrop&&"static",keyboard:!1,show:!1}),options.show&&dialog.modal("show"),dialog},exports.setDefaults=function(){var values={};2===arguments.length?values[arguments[0]]=arguments[1]:values=arguments[0],$.extend(defaults,values)},exports.hideAll=function(){return $(".bootbox").modal("hide"),exports};var locales={bg_BG:{OK:"",CANCEL:"",CONFIRM:""},br:{OK:"OK",CANCEL:"Cancelar",CONFIRM:"Sim"},cs:{OK:"OK",CANCEL:"Zruit",CONFIRM:"Potvrdit"},da:{OK:"OK",CANCEL:"Annuller",CONFIRM:"Accepter"},de:{OK:"OK",CANCEL:"Abbrechen",CONFIRM:"Akzeptieren"},el:{OK:"",CANCEL:"",CONFIRM:""},en:{OK:"OK",CANCEL:"Cancel",CONFIRM:"OK"},es:{OK:"OK",CANCEL:"Cancelar",CONFIRM:"Aceptar"},et:{OK:"OK",CANCEL:"Katkesta",CONFIRM:"OK"},fa:{OK:"",CANCEL:"",CONFIRM:""},fi:{OK:"OK",CANCEL:"Peruuta",CONFIRM:"OK"},fr:{OK:"OK",CANCEL:"Annuler",CONFIRM:"D'accord"},he:{OK:"",CANCEL:"",CONFIRM:""},hu:{OK:"OK",CANCEL:"Mgsem",CONFIRM:"Megerst"},hr:{OK:"OK",CANCEL:"Odustani",CONFIRM:"Potvrdi"},id:{OK:"OK",CANCEL:"Batal",CONFIRM:"OK"},it:{OK:"OK",CANCEL:"Annulla",CONFIRM:"Conferma"},ja:{OK:"OK",CANCEL:"",CONFIRM:""},lt:{OK:"Gerai",CANCEL:"Ataukti",CONFIRM:"Patvirtinti"},lv:{OK:"Labi",CANCEL:"Atcelt",CONFIRM:"Apstiprint"},nl:{OK:"OK",CANCEL:"Annuleren",CONFIRM:"Accepteren"},no:{OK:"OK",CANCEL:"Avbryt",CONFIRM:"OK"},pl:{OK:"OK",CANCEL:"Anuluj",CONFIRM:"Potwierd"},pt:{OK:"OK",CANCEL:"Cancelar",CONFIRM:"Confirmar"},ru:{OK:"OK",CANCEL:"",CONFIRM:""},sq:{OK:"OK",CANCEL:"Anulo",CONFIRM:"Prano"},sv:{OK:"OK",CANCEL:"Avbryt",CONFIRM:"OK"},th:{OK:"",CANCEL:"",CONFIRM:""},tr:{OK:"Tamam",CANCEL:"ptal",CONFIRM:"Onayla"},zh_CN:{OK:"OK",CANCEL:"",CONFIRM:""},zh_TW:{OK:"OK",CANCEL:"",CONFIRM:""}};return exports.addLocale=function(name,values){return $.each(["OK","CANCEL","CONFIRM"],function(_,v){if(!values[v])throw new Error("Please supply a translation for '"+v+"'")}),locales[name]={OK:values.OK,CANCEL:values.CANCEL,CONFIRM:values.CONFIRM},exports},exports.removeLocale=function(name){return delete locales[name],exports},exports.setLocale=function(name){return exports.setDefaults("locale",name)},exports.init=function(_$){return init(_$||$)},exports})?__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__):__WEBPACK_AMD_DEFINE_FACTORY__)||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)}()},"./node_modules/brace-expansion/index.js":function(module,exports,__webpack_require__){var concatMap=__webpack_require__("./node_modules/concat-map/index.js"),balanced=__webpack_require__("./node_modules/balanced-match/index.js");module.exports=function(str){if(!str)return[];"{}"===str.substr(0,2)&&(str="\\{\\}"+str.substr(2));return function expand(str,isTop){var expansions=[];var m=balanced("{","}",str);if(!m||/\$$/.test(m.pre))return[str];var isNumericSequence=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(m.body);var isAlphaSequence=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(m.body);var isSequence=isNumericSequence||isAlphaSequence;var isOptions=m.body.indexOf(",")>=0;if(!isSequence&&!isOptions)return m.post.match(/,.*\}/)?(str=m.pre+"{"+m.body+escClose+m.post,expand(str)):[str];var n;if(isSequence)n=m.body.split(/\.\./);else if(1===(n=function parseCommaParts(str){if(!str)return[""];var parts=[];var m=balanced("{","}",str);if(!m)return str.split(",");var pre=m.pre;var body=m.body;var post=m.post;var p=pre.split(",");p[p.length-1]+="{"+body+"}";var postParts=parseCommaParts(post);post.length&&(p[p.length-1]+=postParts.shift(),p.push.apply(p,postParts));parts.push.apply(parts,p);return parts}(m.body)).length&&1===(n=expand(n[0],!1).map(embrace)).length){var post=m.post.length?expand(m.post,!1):[""];return post.map(function(p){return m.pre+n[0]+p})}var pre=m.pre;var post=m.post.length?expand(m.post,!1):[""];var N;if(isSequence){var x=numeric(n[0]),y=numeric(n[1]),width=Math.max(n[0].length,n[1].length),incr=3==n.length?Math.abs(numeric(n[2])):1,test=lte,reverse=y<x;reverse&&(incr*=-1,test=gte);var pad=n.some(isPadded);N=[];for(var i=x;test(i,y);i+=incr){var c;if(isAlphaSequence)"\\"===(c=String.fromCharCode(i))&&(c="");else if(c=String(i),pad){var need=width-c.length;if(need>0){var z=new Array(need+1).join("0");c=i<0?"-"+z+c.slice(1):z+c}}N.push(c)}}else N=concatMap(n,function(el){return expand(el,!1)});for(var j=0;j<N.length;j++)for(var k=0;k<post.length;k++){var expansion=pre+N[j]+post[k];(!isTop||isSequence||expansion)&&expansions.push(expansion)}return expansions}(function(str){return str.split("\\\\").join(escSlash).split("\\{").join(escOpen).split("\\}").join(escClose).split("\\,").join(escComma).split("\\.").join(escPeriod)}(str),!0).map(unescapeBraces)};var escSlash="\0SLASH"+Math.random()+"\0",escOpen="\0OPEN"+Math.random()+"\0",escClose="\0CLOSE"+Math.random()+"\0",escComma="\0COMMA"+Math.random()+"\0",escPeriod="\0PERIOD"+Math.random()+"\0";function numeric(str){return parseInt(str,10)==str?parseInt(str,10):str.charCodeAt(0)}function unescapeBraces(str){return str.split(escSlash).join("\\").split(escOpen).join("{").split(escClose).join("}").split(escComma).join(",").split(escPeriod).join(".")}function embrace(str){return"{"+str+"}"}function isPadded(el){return/^-?0\d/.test(el)}function lte(i,y){return i<=y}function gte(i,y){return i>=y}},"./node_modules/btoa/index.js":function(module,exports,__webpack_require__){(function(Buffer){!function(){"use strict";module.exports=function(str){return(str instanceof Buffer?str:Buffer.from(str.toString(),"binary")).toString("base64")}}()}).call(this,__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/node_modules/buffer/index.js?c412").Buffer)},"./node_modules/chart.js/src/chart.js":function(module,exports,__webpack_require__){var Chart=__webpack_require__("./node_modules/chart.js/src/core/core.js")();Chart.helpers=__webpack_require__("./node_modules/chart.js/src/helpers/index.js"),__webpack_require__("./node_modules/chart.js/src/core/core.helpers.js")(Chart),Chart.defaults=__webpack_require__("./node_modules/chart.js/src/core/core.defaults.js"),Chart.Element=__webpack_require__("./node_modules/chart.js/src/core/core.element.js"),Chart.elements=__webpack_require__("./node_modules/chart.js/src/elements/index.js"),Chart.Interaction=__webpack_require__("./node_modules/chart.js/src/core/core.interaction.js"),Chart.layouts=__webpack_require__("./node_modules/chart.js/src/core/core.layouts.js"),Chart.platform=__webpack_require__("./node_modules/chart.js/src/platforms/platform.js"),Chart.plugins=__webpack_require__("./node_modules/chart.js/src/core/core.plugins.js"),Chart.Ticks=__webpack_require__("./node_modules/chart.js/src/core/core.ticks.js"),__webpack_require__("./node_modules/chart.js/src/core/core.animation.js")(Chart),__webpack_require__("./node_modules/chart.js/src/core/core.controller.js")(Chart),__webpack_require__("./node_modules/chart.js/src/core/core.datasetController.js")(Chart),__webpack_require__("./node_modules/chart.js/src/core/core.scaleService.js")(Chart),__webpack_require__("./node_modules/chart.js/src/core/core.scale.js")(Chart),__webpack_require__("./node_modules/chart.js/src/core/core.tooltip.js")(Chart),__webpack_require__("./node_modules/chart.js/src/scales/scale.linearbase.js")(Chart),__webpack_require__("./node_modules/chart.js/src/scales/scale.category.js")(Chart),__webpack_require__("./node_modules/chart.js/src/scales/scale.linear.js")(Chart),__webpack_require__("./node_modules/chart.js/src/scales/scale.logarithmic.js")(Chart),__webpack_require__("./node_modules/chart.js/src/scales/scale.radialLinear.js")(Chart),__webpack_require__("./node_modules/chart.js/src/scales/scale.time.js")(Chart),__webpack_require__("./node_modules/chart.js/src/controllers/controller.bar.js")(Chart),__webpack_require__("./node_modules/chart.js/src/controllers/controller.bubble.js")(Chart),__webpack_require__("./node_modules/chart.js/src/controllers/controller.doughnut.js")(Chart),__webpack_require__("./node_modules/chart.js/src/controllers/controller.line.js")(Chart),__webpack_require__("./node_modules/chart.js/src/controllers/controller.polarArea.js")(Chart),__webpack_require__("./node_modules/chart.js/src/controllers/controller.radar.js")(Chart),__webpack_require__("./node_modules/chart.js/src/controllers/controller.scatter.js")(Chart),__webpack_require__("./node_modules/chart.js/src/charts/Chart.Bar.js")(Chart),__webpack_require__("./node_modules/chart.js/src/charts/Chart.Bubble.js")(Chart),__webpack_require__("./node_modules/chart.js/src/charts/Chart.Doughnut.js")(Chart),__webpack_require__("./node_modules/chart.js/src/charts/Chart.Line.js")(Chart),__webpack_require__("./node_modules/chart.js/src/charts/Chart.PolarArea.js")(Chart),__webpack_require__("./node_modules/chart.js/src/charts/Chart.Radar.js")(Chart),__webpack_require__("./node_modules/chart.js/src/charts/Chart.Scatter.js")(Chart);var plugins=__webpack_require__("./node_modules/chart.js/src/plugins/index.js");for(var k in plugins)plugins.hasOwnProperty(k)&&Chart.plugins.register(plugins[k]);Chart.platform.initialize(),module.exports=Chart,"undefined"!=typeof window&&(window.Chart=Chart),Chart.Legend=plugins.legend._element,Chart.Title=plugins.title._element,Chart.pluginService=Chart.plugins,Chart.PluginBase=Chart.Element.extend({}),Chart.canvasHelpers=Chart.helpers.canvas,Chart.layoutService=Chart.layouts},"./node_modules/chart.js/src/charts/Chart.Bar.js":function(module,exports,__webpack_require__){"use strict";module.exports=function(Chart){Chart.Bar=function(context,config){return config.type="bar",new Chart(context,config)}}},"./node_modules/chart.js/src/charts/Chart.Bubble.js":function(module,exports,__webpack_require__){"use strict";module.exports=function(Chart){Chart.Bubble=function(context,config){return config.type="bubble",new Chart(context,config)}}},"./node_modules/chart.js/src/charts/Chart.Doughnut.js":function(module,exports,__webpack_require__){"use strict";module.exports=function(Chart){Chart.Doughnut=function(context,config){return config.type="doughnut",new Chart(context,config)}}},"./node_modules/chart.js/src/charts/Chart.Line.js":function(module,exports,__webpack_require__){"use strict";module.exports=function(Chart){Chart.Line=function(context,config){return config.type="line",new Chart(context,config)}}},"./node_modules/chart.js/src/charts/Chart.PolarArea.js":function(module,exports,__webpack_require__){"use strict";module.exports=function(Chart){Chart.PolarArea=function(context,config){return config.type="polarArea",new Chart(context,config)}}},"./node_modules/chart.js/src/charts/Chart.Radar.js":function(module,exports,__webpack_require__){"use strict";module.exports=function(Chart){Chart.Radar=function(context,config){return config.type="radar",new Chart(context,config)}}},"./node_modules/chart.js/src/charts/Chart.Scatter.js":function(module,exports,__webpack_require__){"use strict";module.exports=function(Chart){Chart.Scatter=function(context,config){return config.type="scatter",new Chart(context,config)}}},"./node_modules/chart.js/src/controllers/controller.bar.js":function(module,exports,__webpack_require__){"use strict";var defaults=__webpack_require__("./node_modules/chart.js/src/core/core.defaults.js"),elements=__webpack_require__("./node_modules/chart.js/src/elements/index.js"),helpers=__webpack_require__("./node_modules/chart.js/src/helpers/index.js");defaults._set("bar",{hover:{mode:"label"},scales:{xAxes:[{type:"category",categoryPercentage:.8,barPercentage:.9,offset:!0,gridLines:{offsetGridLines:!0}}],yAxes:[{type:"linear"}]}}),defaults._set("horizontalBar",{hover:{mode:"index",axis:"y"},scales:{xAxes:[{type:"linear",position:"bottom"}],yAxes:[{position:"left",type:"category",categoryPercentage:.8,barPercentage:.9,offset:!0,gridLines:{offsetGridLines:!0}}]},elements:{rectangle:{borderSkipped:"left"}},tooltips:{callbacks:{title:function(item,data){var title="";return item.length>0&&(item[0].yLabel?title=item[0].yLabel:data.labels.length>0&&item[0].index<data.labels.length&&(title=data.labels[item[0].index])),title},label:function(item,data){return(data.datasets[item.datasetIndex].label||"")+": "+item.xLabel}},mode:"index",axis:"y"}}),module.exports=function(Chart){Chart.controllers.bar=Chart.DatasetController.extend({dataElementType:elements.Rectangle,initialize:function(){var meta;Chart.DatasetController.prototype.initialize.apply(this,arguments),(meta=this.getMeta()).stack=this.getDataset().stack,meta.bar=!0},update:function(reset){var i,ilen,rects=this.getMeta().data;for(this._ruler=this.getRuler(),i=0,ilen=rects.length;i<ilen;++i)this.updateElement(rects[i],i,reset)},updateElement:function(rectangle,index,reset){var me=this,chart=me.chart,meta=me.getMeta(),dataset=me.getDataset(),custom=rectangle.custom||{},rectangleOptions=chart.options.elements.rectangle;rectangle._xScale=me.getScaleForId(meta.xAxisID),rectangle._yScale=me.getScaleForId(meta.yAxisID),rectangle._datasetIndex=me.index,rectangle._index=index,rectangle._model={datasetLabel:dataset.label,label:chart.data.labels[index],borderSkipped:custom.borderSkipped?custom.borderSkipped:rectangleOptions.borderSkipped,backgroundColor:custom.backgroundColor?custom.backgroundColor:helpers.valueAtIndexOrDefault(dataset.backgroundColor,index,rectangleOptions.backgroundColor),borderColor:custom.borderColor?custom.borderColor:helpers.valueAtIndexOrDefault(dataset.borderColor,index,rectangleOptions.borderColor),borderWidth:custom.borderWidth?custom.borderWidth:helpers.valueAtIndexOrDefault(dataset.borderWidth,index,rectangleOptions.borderWidth)},me.updateElementGeometry(rectangle,index,reset),rectangle.pivot()},updateElementGeometry:function(rectangle,index,reset){var me=this,model=rectangle._model,vscale=me.getValueScale(),base=vscale.getBasePixel(),horizontal=vscale.isHorizontal(),ruler=me._ruler||me.getRuler(),vpixels=me.calculateBarValuePixels(me.index,index),ipixels=me.calculateBarIndexPixels(me.index,index,ruler);model.horizontal=horizontal,model.base=reset?base:vpixels.base,model.x=horizontal?reset?base:vpixels.head:ipixels.center,model.y=horizontal?ipixels.center:reset?base:vpixels.head,model.height=horizontal?ipixels.size:void 0,model.width=horizontal?void 0:ipixels.size},getValueScaleId:function(){return this.getMeta().yAxisID},getIndexScaleId:function(){return this.getMeta().xAxisID},getValueScale:function(){return this.getScaleForId(this.getValueScaleId())},getIndexScale:function(){return this.getScaleForId(this.getIndexScaleId())},_getStacks:function(last){var i,meta,chart=this.chart,stacked=this.getIndexScale().options.stacked,ilen=void 0===last?chart.data.datasets.length:last+1,stacks=[];for(i=0;i<ilen;++i)(meta=chart.getDatasetMeta(i)).bar&&chart.isDatasetVisible(i)&&(!1===stacked||!0===stacked&&-1===stacks.indexOf(meta.stack)||void 0===stacked&&(void 0===meta.stack||-1===stacks.indexOf(meta.stack)))&&stacks.push(meta.stack);return stacks},getStackCount:function(){return this._getStacks().length},getStackIndex:function(datasetIndex,name){var stacks=this._getStacks(datasetIndex),index=void 0!==name?stacks.indexOf(name):-1;return-1===index?stacks.length-1:index},getRuler:function(){var i,ilen,scale=this.getIndexScale(),stackCount=this.getStackCount(),datasetIndex=this.index,isHorizontal=scale.isHorizontal(),start=isHorizontal?scale.left:scale.top,end=start+(isHorizontal?scale.width:scale.height),pixels=[];for(i=0,ilen=this.getMeta().data.length;i<ilen;++i)pixels.push(scale.getPixelForValue(null,i,datasetIndex));return{min:helpers.isNullOrUndef(scale.options.barThickness)?function(scale,pixels){var prev,curr,i,ilen,min=scale.isHorizontal()?scale.width:scale.height,ticks=scale.getTicks();for(i=1,ilen=pixels.length;i<ilen;++i)min=Math.min(min,pixels[i]-pixels[i-1]);for(i=0,ilen=ticks.length;i<ilen;++i)curr=scale.getPixelForTick(i),min=i>0?Math.min(min,curr-prev):min,prev=curr;return min}(scale,pixels):-1,pixels:pixels,start:start,end:end,stackCount:stackCount,scale:scale}},calculateBarValuePixels:function(datasetIndex,index){var i,imeta,ivalue,base,head,size,chart=this.chart,meta=this.getMeta(),scale=this.getValueScale(),datasets=chart.data.datasets,value=scale.getRightValue(datasets[datasetIndex].data[index]),stacked=scale.options.stacked,stack=meta.stack,start=0;if(stacked||void 0===stacked&&void 0!==stack)for(i=0;i<datasetIndex;++i)(imeta=chart.getDatasetMeta(i)).bar&&imeta.stack===stack&&imeta.controller.getValueScaleId()===scale.id&&chart.isDatasetVisible(i)&&(ivalue=scale.getRightValue(datasets[i].data[index]),(value<0&&ivalue<0||value>=0&&ivalue>0)&&(start+=ivalue));return base=scale.getPixelForValue(start),{size:size=((head=scale.getPixelForValue(start+value))-base)/2,base:base,head:head,center:head+size/2}},calculateBarIndexPixels:function(datasetIndex,index,ruler){var options=ruler.scale.options,range="flex"===options.barThickness?function(index,ruler,options){var start,pixels=ruler.pixels,curr=pixels[index],prev=index>0?pixels[index-1]:null,next=index<pixels.length-1?pixels[index+1]:null,percent=options.categoryPercentage;return null===prev&&(prev=curr-(null===next?ruler.end-curr:next-curr)),null===next&&(next=curr+curr-prev),start=curr-(curr-prev)/2*percent,{chunk:(next-prev)/2*percent/ruler.stackCount,ratio:options.barPercentage,start:start}}(index,ruler,options):function(index,ruler,options){var size,ratio,thickness=options.barThickness,count=ruler.stackCount,curr=ruler.pixels[index];return helpers.isNullOrUndef(thickness)?(size=ruler.min*options.categoryPercentage,ratio=options.barPercentage):(size=thickness*count,ratio=1),{chunk:size/count,ratio:ratio,start:curr-size/2}}(index,ruler,options),stackIndex=this.getStackIndex(datasetIndex,this.getMeta().stack),center=range.start+range.chunk*stackIndex+range.chunk/2,size=Math.min(helpers.valueOrDefault(options.maxBarThickness,1/0),range.chunk*range.ratio);return{base:center-size/2,head:center+size/2,center:center,size:size}},draw:function(){var chart=this.chart,scale=this.getValueScale(),rects=this.getMeta().data,dataset=this.getDataset(),ilen=rects.length,i=0;for(helpers.canvas.clipArea(chart.ctx,chart.chartArea);i<ilen;++i)isNaN(scale.getRightValue(dataset.data[i]))||rects[i].draw();helpers.canvas.unclipArea(chart.ctx)},setHoverStyle:function(rectangle){var dataset=this.chart.data.datasets[rectangle._datasetIndex],index=rectangle._index,custom=rectangle.custom||{},model=rectangle._model;model.backgroundColor=custom.hoverBackgroundColor?custom.hoverBackgroundColor:helpers.valueAtIndexOrDefault(dataset.hoverBackgroundColor,index,helpers.getHoverColor(model.backgroundColor)),model.borderColor=custom.hoverBorderColor?custom.hoverBorderColor:helpers.valueAtIndexOrDefault(dataset.hoverBorderColor,index,helpers.getHoverColor(model.borderColor)),model.borderWidth=custom.hoverBorderWidth?custom.hoverBorderWidth:helpers.valueAtIndexOrDefault(dataset.hoverBorderWidth,index,model.borderWidth)},removeHoverStyle:function(rectangle){var dataset=this.chart.data.datasets[rectangle._datasetIndex],index=rectangle._index,custom=rectangle.custom||{},model=rectangle._model,rectangleElementOptions=this.chart.options.elements.rectangle;model.backgroundColor=custom.backgroundColor?custom.backgroundColor:helpers.valueAtIndexOrDefault(dataset.backgroundColor,index,rectangleElementOptions.backgroundColor),model.borderColor=custom.borderColor?custom.borderColor:helpers.valueAtIndexOrDefault(dataset.borderColor,index,rectangleElementOptions.borderColor),model.borderWidth=custom.borderWidth?custom.borderWidth:helpers.valueAtIndexOrDefault(dataset.borderWidth,index,rectangleElementOptions.borderWidth)}}),Chart.controllers.horizontalBar=Chart.controllers.bar.extend({getValueScaleId:function(){return this.getMeta().xAxisID},getIndexScaleId:function(){return this.getMeta().yAxisID}})}},"./node_modules/chart.js/src/controllers/controller.bubble.js":function(module,exports,__webpack_require__){"use strict";var defaults=__webpack_require__("./node_modules/chart.js/src/core/core.defaults.js"),elements=__webpack_require__("./node_modules/chart.js/src/elements/index.js"),helpers=__webpack_require__("./node_modules/chart.js/src/helpers/index.js");defaults._set("bubble",{hover:{mode:"single"},scales:{xAxes:[{type:"linear",position:"bottom",id:"x-axis-0"}],yAxes:[{type:"linear",position:"left",id:"y-axis-0"}]},tooltips:{callbacks:{title:function(){return""},label:function(item,data){var datasetLabel=data.datasets[item.datasetIndex].label||"",dataPoint=data.datasets[item.datasetIndex].data[item.index];return datasetLabel+": ("+item.xLabel+", "+item.yLabel+", "+dataPoint.r+")"}}}}),module.exports=function(Chart){Chart.controllers.bubble=Chart.DatasetController.extend({dataElementType:elements.Point,update:function(reset){var me=this,points=me.getMeta().data;helpers.each(points,function(point,index){me.updateElement(point,index,reset)})},updateElement:function(point,index,reset){var me=this,meta=me.getMeta(),custom=point.custom||{},xScale=me.getScaleForId(meta.xAxisID),yScale=me.getScaleForId(meta.yAxisID),options=me._resolveElementOptions(point,index),data=me.getDataset().data[index],dsIndex=me.index,x=reset?xScale.getPixelForDecimal(.5):xScale.getPixelForValue("object"==typeof data?data:NaN,index,dsIndex),y=reset?yScale.getBasePixel():yScale.getPixelForValue(data,index,dsIndex);point._xScale=xScale,point._yScale=yScale,point._options=options,point._datasetIndex=dsIndex,point._index=index,point._model={backgroundColor:options.backgroundColor,borderColor:options.borderColor,borderWidth:options.borderWidth,hitRadius:options.hitRadius,pointStyle:options.pointStyle,radius:reset?0:options.radius,skip:custom.skip||isNaN(x)||isNaN(y),x:x,y:y},point.pivot()},setHoverStyle:function(point){var model=point._model,options=point._options;model.backgroundColor=helpers.valueOrDefault(options.hoverBackgroundColor,helpers.getHoverColor(options.backgroundColor)),model.borderColor=helpers.valueOrDefault(options.hoverBorderColor,helpers.getHoverColor(options.borderColor)),model.borderWidth=helpers.valueOrDefault(options.hoverBorderWidth,options.borderWidth),model.radius=options.radius+options.hoverRadius},removeHoverStyle:function(point){var model=point._model,options=point._options;model.backgroundColor=options.backgroundColor,model.borderColor=options.borderColor,model.borderWidth=options.borderWidth,model.radius=options.radius},_resolveElementOptions:function(point,index){var i,ilen,key,chart=this.chart,dataset=chart.data.datasets[this.index],custom=point.custom||{},options=chart.options.elements.point,resolve=helpers.options.resolve,data=dataset.data[index],values={},context={chart:chart,dataIndex:index,dataset:dataset,datasetIndex:this.index},keys=["backgroundColor","borderColor","borderWidth","hoverBackgroundColor","hoverBorderColor","hoverBorderWidth","hoverRadius","hitRadius","pointStyle"];for(i=0,ilen=keys.length;i<ilen;++i)values[key=keys[i]]=resolve([custom[key],dataset[key],options[key]],context,index);return values.radius=resolve([custom.radius,data?data.r:void 0,dataset.radius,options.radius],context,index),values}})}},"./node_modules/chart.js/src/controllers/controller.doughnut.js":function(module,exports,__webpack_require__){"use strict";var defaults=__webpack_require__("./node_modules/chart.js/src/core/core.defaults.js"),elements=__webpack_require__("./node_modules/chart.js/src/elements/index.js"),helpers=__webpack_require__("./node_modules/chart.js/src/helpers/index.js");defaults._set("doughnut",{animation:{animateRotate:!0,animateScale:!1},hover:{mode:"single"},legendCallback:function(chart){var text=[];text.push('<ul class="'+chart.id+'-legend">');var data=chart.data,datasets=data.datasets,labels=data.labels;if(datasets.length)for(var i=0;i<datasets[0].data.length;++i)text.push('<li><span style="background-color:'+datasets[0].backgroundColor[i]+'"></span>'),labels[i]&&text.push(labels[i]),text.push("</li>");return text.push("</ul>"),text.join("")},legend:{labels:{generateLabels:function(chart){var data=chart.data;return data.labels.length&&data.datasets.length?data.labels.map(function(label,i){var meta=chart.getDatasetMeta(0),ds=data.datasets[0],arc=meta.data[i],custom=arc&&arc.custom||{},valueAtIndexOrDefault=helpers.valueAtIndexOrDefault,arcOpts=chart.options.elements.arc;return{text:label,fillStyle:custom.backgroundColor?custom.backgroundColor:valueAtIndexOrDefault(ds.backgroundColor,i,arcOpts.backgroundColor),strokeStyle:custom.borderColor?custom.borderColor:valueAtIndexOrDefault(ds.borderColor,i,arcOpts.borderColor),lineWidth:custom.borderWidth?custom.borderWidth:valueAtIndexOrDefault(ds.borderWidth,i,arcOpts.borderWidth),hidden:isNaN(ds.data[i])||meta.data[i].hidden,index:i}}):[]}},onClick:function(e,legendItem){var i,ilen,meta,index=legendItem.index,chart=this.chart;for(i=0,ilen=(chart.data.datasets||[]).length;i<ilen;++i)(meta=chart.getDatasetMeta(i)).data[index]&&(meta.data[index].hidden=!meta.data[index].hidden);chart.update()}},cutoutPercentage:50,rotation:-.5*Math.PI,circumference:2*Math.PI,tooltips:{callbacks:{title:function(){return""},label:function(tooltipItem,data){var dataLabel=data.labels[tooltipItem.index],value=": "+data.datasets[tooltipItem.datasetIndex].data[tooltipItem.index];return helpers.isArray(dataLabel)?(dataLabel=dataLabel.slice())[0]+=value:dataLabel+=value,dataLabel}}}}),defaults._set("pie",helpers.clone(defaults.doughnut)),defaults._set("pie",{cutoutPercentage:0}),module.exports=function(Chart){Chart.controllers.doughnut=Chart.controllers.pie=Chart.DatasetController.extend({dataElementType:elements.Arc,linkScales:helpers.noop,getRingIndex:function(datasetIndex){for(var ringIndex=0,j=0;j<datasetIndex;++j)this.chart.isDatasetVisible(j)&&++ringIndex;return ringIndex},update:function(reset){var me=this,chart=me.chart,chartArea=chart.chartArea,opts=chart.options,arcOpts=opts.elements.arc,availableWidth=chartArea.right-chartArea.left-arcOpts.borderWidth,availableHeight=chartArea.bottom-chartArea.top-arcOpts.borderWidth,minSize=Math.min(availableWidth,availableHeight),offset={x:0,y:0},meta=me.getMeta(),cutoutPercentage=opts.cutoutPercentage,circumference=opts.circumference;if(circumference<2*Math.PI){var startAngle=opts.rotation%(2*Math.PI),endAngle=(startAngle+=2*Math.PI*(startAngle>=Math.PI?-1:startAngle<-Math.PI?1:0))+circumference,start={x:Math.cos(startAngle),y:Math.sin(startAngle)},end={x:Math.cos(endAngle),y:Math.sin(endAngle)},contains0=startAngle<=0&&endAngle>=0||startAngle<=2*Math.PI&&2*Math.PI<=endAngle,contains90=startAngle<=.5*Math.PI&&.5*Math.PI<=endAngle||startAngle<=2.5*Math.PI&&2.5*Math.PI<=endAngle,contains180=startAngle<=-Math.PI&&-Math.PI<=endAngle||startAngle<=Math.PI&&Math.PI<=endAngle,contains270=startAngle<=.5*-Math.PI&&.5*-Math.PI<=endAngle||startAngle<=1.5*Math.PI&&1.5*Math.PI<=endAngle,cutout=cutoutPercentage/100,min={x:contains180?-1:Math.min(start.x*(start.x<0?1:cutout),end.x*(end.x<0?1:cutout)),y:contains270?-1:Math.min(start.y*(start.y<0?1:cutout),end.y*(end.y<0?1:cutout))},max={x:contains0?1:Math.max(start.x*(start.x>0?1:cutout),end.x*(end.x>0?1:cutout)),y:contains90?1:Math.max(start.y*(start.y>0?1:cutout),end.y*(end.y>0?1:cutout))},size={width:.5*(max.x-min.x),height:.5*(max.y-min.y)};minSize=Math.min(availableWidth/size.width,availableHeight/size.height),offset={x:-.5*(max.x+min.x),y:-.5*(max.y+min.y)}}chart.borderWidth=me.getMaxBorderWidth(meta.data),chart.outerRadius=Math.max((minSize-chart.borderWidth)/2,0),chart.innerRadius=Math.max(cutoutPercentage?chart.outerRadius/100*cutoutPercentage:0,0),chart.radiusLength=(chart.outerRadius-chart.innerRadius)/chart.getVisibleDatasetCount(),chart.offsetX=offset.x*chart.outerRadius,chart.offsetY=offset.y*chart.outerRadius,meta.total=me.calculateTotal(),me.outerRadius=chart.outerRadius-chart.radiusLength*me.getRingIndex(me.index),me.innerRadius=Math.max(me.outerRadius-chart.radiusLength,0),helpers.each(meta.data,function(arc,index){me.updateElement(arc,index,reset)})},updateElement:function(arc,index,reset){var me=this,chart=me.chart,chartArea=chart.chartArea,opts=chart.options,animationOpts=opts.animation,centerX=(chartArea.left+chartArea.right)/2,centerY=(chartArea.top+chartArea.bottom)/2,startAngle=opts.rotation,endAngle=opts.rotation,dataset=me.getDataset(),circumference=reset&&animationOpts.animateRotate?0:arc.hidden?0:me.calculateCircumference(dataset.data[index])*(opts.circumference/(2*Math.PI)),innerRadius=reset&&animationOpts.animateScale?0:me.innerRadius,outerRadius=reset&&animationOpts.animateScale?0:me.outerRadius,valueAtIndexOrDefault=helpers.valueAtIndexOrDefault;helpers.extend(arc,{_datasetIndex:me.index,_index:index,_model:{x:centerX+chart.offsetX,y:centerY+chart.offsetY,startAngle:startAngle,endAngle:endAngle,circumference:circumference,outerRadius:outerRadius,innerRadius:innerRadius,label:valueAtIndexOrDefault(dataset.label,index,chart.data.labels[index])}});var model=arc._model;this.removeHoverStyle(arc),reset&&animationOpts.animateRotate||(model.startAngle=0===index?opts.rotation:me.getMeta().data[index-1]._model.endAngle,model.endAngle=model.startAngle+model.circumference),arc.pivot()},removeHoverStyle:function(arc){Chart.DatasetController.prototype.removeHoverStyle.call(this,arc,this.chart.options.elements.arc)},calculateTotal:function(){var value,dataset=this.getDataset(),meta=this.getMeta(),total=0;return helpers.each(meta.data,function(element,index){value=dataset.data[index],isNaN(value)||element.hidden||(total+=Math.abs(value))}),total},calculateCircumference:function(value){var total=this.getMeta().total;return total>0&&!isNaN(value)?2*Math.PI*(Math.abs(value)/total):0},getMaxBorderWidth:function(arcs){for(var borderWidth,hoverWidth,max=0,index=this.index,length=arcs.length,i=0;i<length;i++)borderWidth=arcs[i]._model?arcs[i]._model.borderWidth:0,max=(hoverWidth=arcs[i]._chart?arcs[i]._chart.config.data.datasets[index].hoverBorderWidth:0)>(max=borderWidth>max?borderWidth:max)?hoverWidth:max;return max}})}},"./node_modules/chart.js/src/controllers/controller.line.js":function(module,exports,__webpack_require__){"use strict";var defaults=__webpack_require__("./node_modules/chart.js/src/core/core.defaults.js"),elements=__webpack_require__("./node_modules/chart.js/src/elements/index.js"),helpers=__webpack_require__("./node_modules/chart.js/src/helpers/index.js");defaults._set("line",{showLines:!0,spanGaps:!1,hover:{mode:"label"},scales:{xAxes:[{type:"category",id:"x-axis-0"}],yAxes:[{type:"linear",id:"y-axis-0"}]}}),module.exports=function(Chart){function lineEnabled(dataset,options){return helpers.valueOrDefault(dataset.showLine,options.showLines)}Chart.controllers.line=Chart.DatasetController.extend({datasetElementType:elements.Line,dataElementType:elements.Point,update:function(reset){var i,ilen,custom,me=this,meta=me.getMeta(),line=meta.dataset,points=meta.data||[],options=me.chart.options,lineElementOptions=options.elements.line,scale=me.getScaleForId(meta.yAxisID),dataset=me.getDataset(),showLine=lineEnabled(dataset,options);for(showLine&&(custom=line.custom||{},void 0!==dataset.tension&&void 0===dataset.lineTension&&(dataset.lineTension=dataset.tension),line._scale=scale,line._datasetIndex=me.index,line._children=points,line._model={spanGaps:dataset.spanGaps?dataset.spanGaps:options.spanGaps,tension:custom.tension?custom.tension:helpers.valueOrDefault(dataset.lineTension,lineElementOptions.tension),backgroundColor:custom.backgroundColor?custom.backgroundColor:dataset.backgroundColor||lineElementOptions.backgroundColor,borderWidth:custom.borderWidth?custom.borderWidth:dataset.borderWidth||lineElementOptions.borderWidth,borderColor:custom.borderColor?custom.borderColor:dataset.borderColor||lineElementOptions.borderColor,borderCapStyle:custom.borderCapStyle?custom.borderCapStyle:dataset.borderCapStyle||lineElementOptions.borderCapStyle,borderDash:custom.borderDash?custom.borderDash:dataset.borderDash||lineElementOptions.borderDash,borderDashOffset:custom.borderDashOffset?custom.borderDashOffset:dataset.borderDashOffset||lineElementOptions.borderDashOffset,borderJoinStyle:custom.borderJoinStyle?custom.borderJoinStyle:dataset.borderJoinStyle||lineElementOptions.borderJoinStyle,fill:custom.fill?custom.fill:void 0!==dataset.fill?dataset.fill:lineElementOptions.fill,steppedLine:custom.steppedLine?custom.steppedLine:helpers.valueOrDefault(dataset.steppedLine,lineElementOptions.stepped),cubicInterpolationMode:custom.cubicInterpolationMode?custom.cubicInterpolationMode:helpers.valueOrDefault(dataset.cubicInterpolationMode,lineElementOptions.cubicInterpolationMode)},line.pivot()),i=0,ilen=points.length;i<ilen;++i)me.updateElement(points[i],i,reset);for(showLine&&0!==line._model.tension&&me.updateBezierControlPoints(),i=0,ilen=points.length;i<ilen;++i)points[i].pivot()},getPointBackgroundColor:function(point,index){var backgroundColor=this.chart.options.elements.point.backgroundColor,dataset=this.getDataset(),custom=point.custom||{};return custom.backgroundColor?backgroundColor=custom.backgroundColor:dataset.pointBackgroundColor?backgroundColor=helpers.valueAtIndexOrDefault(dataset.pointBackgroundColor,index,backgroundColor):dataset.backgroundColor&&(backgroundColor=dataset.backgroundColor),backgroundColor},getPointBorderColor:function(point,index){var borderColor=this.chart.options.elements.point.borderColor,dataset=this.getDataset(),custom=point.custom||{};return custom.borderColor?borderColor=custom.borderColor:dataset.pointBorderColor?borderColor=helpers.valueAtIndexOrDefault(dataset.pointBorderColor,index,borderColor):dataset.borderColor&&(borderColor=dataset.borderColor),borderColor},getPointBorderWidth:function(point,index){var borderWidth=this.chart.options.elements.point.borderWidth,dataset=this.getDataset(),custom=point.custom||{};return isNaN(custom.borderWidth)?!isNaN(dataset.pointBorderWidth)||helpers.isArray(dataset.pointBorderWidth)?borderWidth=helpers.valueAtIndexOrDefault(dataset.pointBorderWidth,index,borderWidth):isNaN(dataset.borderWidth)||(borderWidth=dataset.borderWidth):borderWidth=custom.borderWidth,borderWidth},updateElement:function(point,index,reset){var x,y,me=this,meta=me.getMeta(),custom=point.custom||{},dataset=me.getDataset(),datasetIndex=me.index,value=dataset.data[index],yScale=me.getScaleForId(meta.yAxisID),xScale=me.getScaleForId(meta.xAxisID),pointOptions=me.chart.options.elements.point;void 0!==dataset.radius&&void 0===dataset.pointRadius&&(dataset.pointRadius=dataset.radius),void 0!==dataset.hitRadius&&void 0===dataset.pointHitRadius&&(dataset.pointHitRadius=dataset.hitRadius),x=xScale.getPixelForValue("object"==typeof value?value:NaN,index,datasetIndex),y=reset?yScale.getBasePixel():me.calculatePointY(value,index,datasetIndex),point._xScale=xScale,point._yScale=yScale,point._datasetIndex=datasetIndex,point._index=index,point._model={x:x,y:y,skip:custom.skip||isNaN(x)||isNaN(y),radius:custom.radius||helpers.valueAtIndexOrDefault(dataset.pointRadius,index,pointOptions.radius),pointStyle:custom.pointStyle||helpers.valueAtIndexOrDefault(dataset.pointStyle,index,pointOptions.pointStyle),backgroundColor:me.getPointBackgroundColor(point,index),borderColor:me.getPointBorderColor(point,index),borderWidth:me.getPointBorderWidth(point,index),tension:meta.dataset._model?meta.dataset._model.tension:0,steppedLine:!!meta.dataset._model&&meta.dataset._model.steppedLine,hitRadius:custom.hitRadius||helpers.valueAtIndexOrDefault(dataset.pointHitRadius,index,pointOptions.hitRadius)}},calculatePointY:function(value,index,datasetIndex){var i,ds,dsMeta,chart=this.chart,meta=this.getMeta(),yScale=this.getScaleForId(meta.yAxisID),sumPos=0,sumNeg=0;if(yScale.options.stacked){for(i=0;i<datasetIndex;i++)if(ds=chart.data.datasets[i],"line"===(dsMeta=chart.getDatasetMeta(i)).type&&dsMeta.yAxisID===yScale.id&&chart.isDatasetVisible(i)){var stackedRightValue=Number(yScale.getRightValue(ds.data[index]));stackedRightValue<0?sumNeg+=stackedRightValue||0:sumPos+=stackedRightValue||0}var rightValue=Number(yScale.getRightValue(value));return rightValue<0?yScale.getPixelForValue(sumNeg+rightValue):yScale.getPixelForValue(sumPos+rightValue)}return yScale.getPixelForValue(value)},updateBezierControlPoints:function(){var i,ilen,model,controlPoints,meta=this.getMeta(),area=this.chart.chartArea,points=meta.data||[];function capControlPoint(pt,min,max){return Math.max(Math.min(pt,max),min)}if(meta.dataset._model.spanGaps&&(points=points.filter(function(pt){return!pt._model.skip})),"monotone"===meta.dataset._model.cubicInterpolationMode)helpers.splineCurveMonotone(points);else for(i=0,ilen=points.length;i<ilen;++i)model=points[i]._model,controlPoints=helpers.splineCurve(helpers.previousItem(points,i)._model,model,helpers.nextItem(points,i)._model,meta.dataset._model.tension),model.controlPointPreviousX=controlPoints.previous.x,model.controlPointPreviousY=controlPoints.previous.y,model.controlPointNextX=controlPoints.next.x,model.controlPointNextY=controlPoints.next.y;if(this.chart.options.elements.line.capBezierPoints)for(i=0,ilen=points.length;i<ilen;++i)(model=points[i]._model).controlPointPreviousX=capControlPoint(model.controlPointPreviousX,area.left,area.right),model.controlPointPreviousY=capControlPoint(model.controlPointPreviousY,area.top,area.bottom),model.controlPointNextX=capControlPoint(model.controlPointNextX,area.left,area.right),model.controlPointNextY=capControlPoint(model.controlPointNextY,area.top,area.bottom)},draw:function(){var chart=this.chart,meta=this.getMeta(),points=meta.data||[],area=chart.chartArea,ilen=points.length,i=0;for(helpers.canvas.clipArea(chart.ctx,area),lineEnabled(this.getDataset(),chart.options)&&meta.dataset.draw(),helpers.canvas.unclipArea(chart.ctx);i<ilen;++i)points[i].draw(area)},setHoverStyle:function(point){var dataset=this.chart.data.datasets[point._datasetIndex],index=point._index,custom=point.custom||{},model=point._model;model.radius=custom.hoverRadius||helpers.valueAtIndexOrDefault(dataset.pointHoverRadius,index,this.chart.options.elements.point.hoverRadius),model.backgroundColor=custom.hoverBackgroundColor||helpers.valueAtIndexOrDefault(dataset.pointHoverBackgroundColor,index,helpers.getHoverColor(model.backgroundColor)),model.borderColor=custom.hoverBorderColor||helpers.valueAtIndexOrDefault(dataset.pointHoverBorderColor,index,helpers.getHoverColor(model.borderColor)),model.borderWidth=custom.hoverBorderWidth||helpers.valueAtIndexOrDefault(dataset.pointHoverBorderWidth,index,model.borderWidth)},removeHoverStyle:function(point){var me=this,dataset=me.chart.data.datasets[point._datasetIndex],index=point._index,custom=point.custom||{},model=point._model;void 0!==dataset.radius&&void 0===dataset.pointRadius&&(dataset.pointRadius=dataset.radius),model.radius=custom.radius||helpers.valueAtIndexOrDefault(dataset.pointRadius,index,me.chart.options.elements.point.radius),model.backgroundColor=me.getPointBackgroundColor(point,index),model.borderColor=me.getPointBorderColor(point,index),model.borderWidth=me.getPointBorderWidth(point,index)}})}},"./node_modules/chart.js/src/controllers/controller.polarArea.js":function(module,exports,__webpack_require__){"use strict";var defaults=__webpack_require__("./node_modules/chart.js/src/core/core.defaults.js"),elements=__webpack_require__("./node_modules/chart.js/src/elements/index.js"),helpers=__webpack_require__("./node_modules/chart.js/src/helpers/index.js");defaults._set("polarArea",{scale:{type:"radialLinear",angleLines:{display:!1},gridLines:{circular:!0},pointLabels:{display:!1},ticks:{beginAtZero:!0}},animation:{animateRotate:!0,animateScale:!0},startAngle:-.5*Math.PI,legendCallback:function(chart){var text=[];text.push('<ul class="'+chart.id+'-legend">');var data=chart.data,datasets=data.datasets,labels=data.labels;if(datasets.length)for(var i=0;i<datasets[0].data.length;++i)text.push('<li><span style="background-color:'+datasets[0].backgroundColor[i]+'"></span>'),labels[i]&&text.push(labels[i]),text.push("</li>");return text.push("</ul>"),text.join("")},legend:{labels:{generateLabels:function(chart){var data=chart.data;return data.labels.length&&data.datasets.length?data.labels.map(function(label,i){var meta=chart.getDatasetMeta(0),ds=data.datasets[0],custom=meta.data[i].custom||{},valueAtIndexOrDefault=helpers.valueAtIndexOrDefault,arcOpts=chart.options.elements.arc;return{text:label,fillStyle:custom.backgroundColor?custom.backgroundColor:valueAtIndexOrDefault(ds.backgroundColor,i,arcOpts.backgroundColor),strokeStyle:custom.borderColor?custom.borderColor:valueAtIndexOrDefault(ds.borderColor,i,arcOpts.borderColor),lineWidth:custom.borderWidth?custom.borderWidth:valueAtIndexOrDefault(ds.borderWidth,i,arcOpts.borderWidth),hidden:isNaN(ds.data[i])||meta.data[i].hidden,index:i}}):[]}},onClick:function(e,legendItem){var i,ilen,meta,index=legendItem.index,chart=this.chart;for(i=0,ilen=(chart.data.datasets||[]).length;i<ilen;++i)(meta=chart.getDatasetMeta(i)).data[index].hidden=!meta.data[index].hidden;chart.update()}},tooltips:{callbacks:{title:function(){return""},label:function(item,data){return data.labels[item.index]+": "+item.yLabel}}}}),module.exports=function(Chart){Chart.controllers.polarArea=Chart.DatasetController.extend({dataElementType:elements.Arc,linkScales:helpers.noop,update:function(reset){var me=this,chart=me.chart,chartArea=chart.chartArea,meta=me.getMeta(),opts=chart.options,arcOpts=opts.elements.arc,minSize=Math.min(chartArea.right-chartArea.left,chartArea.bottom-chartArea.top);chart.outerRadius=Math.max((minSize-arcOpts.borderWidth/2)/2,0),chart.innerRadius=Math.max(opts.cutoutPercentage?chart.outerRadius/100*opts.cutoutPercentage:1,0),chart.radiusLength=(chart.outerRadius-chart.innerRadius)/chart.getVisibleDatasetCount(),me.outerRadius=chart.outerRadius-chart.radiusLength*me.index,me.innerRadius=me.outerRadius-chart.radiusLength,meta.count=me.countVisibleElements(),helpers.each(meta.data,function(arc,index){me.updateElement(arc,index,reset)})},updateElement:function(arc,index,reset){for(var me=this,chart=me.chart,dataset=me.getDataset(),opts=chart.options,animationOpts=opts.animation,scale=chart.scale,labels=chart.data.labels,circumference=me.calculateCircumference(dataset.data[index]),centerX=scale.xCenter,centerY=scale.yCenter,visibleCount=0,meta=me.getMeta(),i=0;i<index;++i)isNaN(dataset.data[i])||meta.data[i].hidden||++visibleCount;var datasetStartAngle=opts.startAngle,distance=arc.hidden?0:scale.getDistanceFromCenterForValue(dataset.data[index]),startAngle=datasetStartAngle+circumference*visibleCount,endAngle=startAngle+(arc.hidden?0:circumference),resetRadius=animationOpts.animateScale?0:scale.getDistanceFromCenterForValue(dataset.data[index]);helpers.extend(arc,{_datasetIndex:me.index,_index:index,_scale:scale,_model:{x:centerX,y:centerY,innerRadius:0,outerRadius:reset?resetRadius:distance,startAngle:reset&&animationOpts.animateRotate?datasetStartAngle:startAngle,endAngle:reset&&animationOpts.animateRotate?datasetStartAngle:endAngle,label:helpers.valueAtIndexOrDefault(labels,index,labels[index])}}),me.removeHoverStyle(arc),arc.pivot()},removeHoverStyle:function(arc){Chart.DatasetController.prototype.removeHoverStyle.call(this,arc,this.chart.options.elements.arc)},countVisibleElements:function(){var dataset=this.getDataset(),meta=this.getMeta(),count=0;return helpers.each(meta.data,function(element,index){isNaN(dataset.data[index])||element.hidden||count++}),count},calculateCircumference:function(value){var count=this.getMeta().count;return count>0&&!isNaN(value)?2*Math.PI/count:0}})}},"./node_modules/chart.js/src/controllers/controller.radar.js":function(module,exports,__webpack_require__){"use strict";var defaults=__webpack_require__("./node_modules/chart.js/src/core/core.defaults.js"),elements=__webpack_require__("./node_modules/chart.js/src/elements/index.js"),helpers=__webpack_require__("./node_modules/chart.js/src/helpers/index.js");defaults._set("radar",{scale:{type:"radialLinear"},elements:{line:{tension:0}}}),module.exports=function(Chart){Chart.controllers.radar=Chart.DatasetController.extend({datasetElementType:elements.Line,dataElementType:elements.Point,linkScales:helpers.noop,update:function(reset){var me=this,meta=me.getMeta(),line=meta.dataset,points=meta.data,custom=line.custom||{},dataset=me.getDataset(),lineElementOptions=me.chart.options.elements.line,scale=me.chart.scale;void 0!==dataset.tension&&void 0===dataset.lineTension&&(dataset.lineTension=dataset.tension),helpers.extend(meta.dataset,{_datasetIndex:me.index,_scale:scale,_children:points,_loop:!0,_model:{tension:custom.tension?custom.tension:helpers.valueOrDefault(dataset.lineTension,lineElementOptions.tension),backgroundColor:custom.backgroundColor?custom.backgroundColor:dataset.backgroundColor||lineElementOptions.backgroundColor,borderWidth:custom.borderWidth?custom.borderWidth:dataset.borderWidth||lineElementOptions.borderWidth,borderColor:custom.borderColor?custom.borderColor:dataset.borderColor||lineElementOptions.borderColor,fill:custom.fill?custom.fill:void 0!==dataset.fill?dataset.fill:lineElementOptions.fill,borderCapStyle:custom.borderCapStyle?custom.borderCapStyle:dataset.borderCapStyle||lineElementOptions.borderCapStyle,borderDash:custom.borderDash?custom.borderDash:dataset.borderDash||lineElementOptions.borderDash,borderDashOffset:custom.borderDashOffset?custom.borderDashOffset:dataset.borderDashOffset||lineElementOptions.borderDashOffset,borderJoinStyle:custom.borderJoinStyle?custom.borderJoinStyle:dataset.borderJoinStyle||lineElementOptions.borderJoinStyle}}),meta.dataset.pivot(),helpers.each(points,function(point,index){me.updateElement(point,index,reset)},me),me.updateBezierControlPoints()},updateElement:function(point,index,reset){var me=this,custom=point.custom||{},dataset=me.getDataset(),scale=me.chart.scale,pointElementOptions=me.chart.options.elements.point,pointPosition=scale.getPointPositionForValue(index,dataset.data[index]);void 0!==dataset.radius&&void 0===dataset.pointRadius&&(dataset.pointRadius=dataset.radius),void 0!==dataset.hitRadius&&void 0===dataset.pointHitRadius&&(dataset.pointHitRadius=dataset.hitRadius),helpers.extend(point,{_datasetIndex:me.index,_index:index,_scale:scale,_model:{x:reset?scale.xCenter:pointPosition.x,y:reset?scale.yCenter:pointPosition.y,tension:custom.tension?custom.tension:helpers.valueOrDefault(dataset.lineTension,me.chart.options.elements.line.tension),radius:custom.radius?custom.radius:helpers.valueAtIndexOrDefault(dataset.pointRadius,index,pointElementOptions.radius),backgroundColor:custom.backgroundColor?custom.backgroundColor:helpers.valueAtIndexOrDefault(dataset.pointBackgroundColor,index,pointElementOptions.backgroundColor),borderColor:custom.borderColor?custom.borderColor:helpers.valueAtIndexOrDefault(dataset.pointBorderColor,index,pointElementOptions.borderColor),borderWidth:custom.borderWidth?custom.borderWidth:helpers.valueAtIndexOrDefault(dataset.pointBorderWidth,index,pointElementOptions.borderWidth),pointStyle:custom.pointStyle?custom.pointStyle:helpers.valueAtIndexOrDefault(dataset.pointStyle,index,pointElementOptions.pointStyle),hitRadius:custom.hitRadius?custom.hitRadius:helpers.valueAtIndexOrDefault(dataset.pointHitRadius,index,pointElementOptions.hitRadius)}}),point._model.skip=custom.skip?custom.skip:isNaN(point._model.x)||isNaN(point._model.y)},updateBezierControlPoints:function(){var chartArea=this.chart.chartArea,meta=this.getMeta();helpers.each(meta.data,function(point,index){var model=point._model,controlPoints=helpers.splineCurve(helpers.previousItem(meta.data,index,!0)._model,model,helpers.nextItem(meta.data,index,!0)._model,model.tension);model.controlPointPreviousX=Math.max(Math.min(controlPoints.previous.x,chartArea.right),chartArea.left),model.controlPointPreviousY=Math.max(Math.min(controlPoints.previous.y,chartArea.bottom),chartArea.top),model.controlPointNextX=Math.max(Math.min(controlPoints.next.x,chartArea.right),chartArea.left),model.controlPointNextY=Math.max(Math.min(controlPoints.next.y,chartArea.bottom),chartArea.top),point.pivot()})},setHoverStyle:function(point){var dataset=this.chart.data.datasets[point._datasetIndex],custom=point.custom||{},index=point._index,model=point._model;model.radius=custom.hoverRadius?custom.hoverRadius:helpers.valueAtIndexOrDefault(dataset.pointHoverRadius,index,this.chart.options.elements.point.hoverRadius),model.backgroundColor=custom.hoverBackgroundColor?custom.hoverBackgroundColor:helpers.valueAtIndexOrDefault(dataset.pointHoverBackgroundColor,index,helpers.getHoverColor(model.backgroundColor)),model.borderColor=custom.hoverBorderColor?custom.hoverBorderColor:helpers.valueAtIndexOrDefault(dataset.pointHoverBorderColor,index,helpers.getHoverColor(model.borderColor)),model.borderWidth=custom.hoverBorderWidth?custom.hoverBorderWidth:helpers.valueAtIndexOrDefault(dataset.pointHoverBorderWidth,index,model.borderWidth)},removeHoverStyle:function(point){var dataset=this.chart.data.datasets[point._datasetIndex],custom=point.custom||{},index=point._index,model=point._model,pointElementOptions=this.chart.options.elements.point;model.radius=custom.radius?custom.radius:helpers.valueAtIndexOrDefault(dataset.pointRadius,index,pointElementOptions.radius),model.backgroundColor=custom.backgroundColor?custom.backgroundColor:helpers.valueAtIndexOrDefault(dataset.pointBackgroundColor,index,pointElementOptions.backgroundColor),model.borderColor=custom.borderColor?custom.borderColor:helpers.valueAtIndexOrDefault(dataset.pointBorderColor,index,pointElementOptions.borderColor),model.borderWidth=custom.borderWidth?custom.borderWidth:helpers.valueAtIndexOrDefault(dataset.pointBorderWidth,index,pointElementOptions.borderWidth)}})}},"./node_modules/chart.js/src/controllers/controller.scatter.js":function(module,exports,__webpack_require__){"use strict";__webpack_require__("./node_modules/chart.js/src/core/core.defaults.js")._set("scatter",{hover:{mode:"single"},scales:{xAxes:[{id:"x-axis-1",type:"linear",position:"bottom"}],yAxes:[{id:"y-axis-1",type:"linear",position:"left"}]},showLines:!1,tooltips:{callbacks:{title:function(){return""},label:function(item){return"("+item.xLabel+", "+item.yLabel+")"}}}}),module.exports=function(Chart){Chart.controllers.scatter=Chart.controllers.line}},"./node_modules/chart.js/src/core/core.animation.js":function(module,exports,__webpack_require__){"use strict";var defaults=__webpack_require__("./node_modules/chart.js/src/core/core.defaults.js"),Element=__webpack_require__("./node_modules/chart.js/src/core/core.element.js"),helpers=__webpack_require__("./node_modules/chart.js/src/helpers/index.js");defaults._set("global",{animation:{duration:1e3,easing:"easeOutQuart",onProgress:helpers.noop,onComplete:helpers.noop}}),module.exports=function(Chart){Chart.Animation=Element.extend({chart:null,currentStep:0,numSteps:60,easing:"",render:null,onAnimationProgress:null,onAnimationComplete:null}),Chart.animationService={frameDuration:17,animations:[],dropFrames:0,request:null,addAnimation:function(chart,animation,duration,lazy){var i,ilen,animations=this.animations;for(animation.chart=chart,lazy||(chart.animating=!0),i=0,ilen=animations.length;i<ilen;++i)if(animations[i].chart===chart)return void(animations[i]=animation);animations.push(animation),1===animations.length&&this.requestAnimationFrame()},cancelAnimation:function(chart){var index=helpers.findIndex(this.animations,function(animation){return animation.chart===chart});-1!==index&&(this.animations.splice(index,1),chart.animating=!1)},requestAnimationFrame:function(){var me=this;null===me.request&&(me.request=helpers.requestAnimFrame.call(window,function(){me.request=null,me.startDigest()}))},startDigest:function(){var me=this,startTime=Date.now(),framesToDrop=0;me.dropFrames>1&&(framesToDrop=Math.floor(me.dropFrames),me.dropFrames=me.dropFrames%1),me.advance(1+framesToDrop);var endTime=Date.now();me.dropFrames+=(endTime-startTime)/me.frameDuration,me.animations.length>0&&me.requestAnimationFrame()},advance:function(count){for(var animation,chart,animations=this.animations,i=0;i<animations.length;)chart=(animation=animations[i]).chart,animation.currentStep=(animation.currentStep||0)+count,animation.currentStep=Math.min(animation.currentStep,animation.numSteps),helpers.callback(animation.render,[chart,animation],chart),helpers.callback(animation.onAnimationProgress,[animation],chart),animation.currentStep>=animation.numSteps?(helpers.callback(animation.onAnimationComplete,[animation],chart),chart.animating=!1,animations.splice(i,1)):++i}},Object.defineProperty(Chart.Animation.prototype,"animationObject",{get:function(){return this}}),Object.defineProperty(Chart.Animation.prototype,"chartInstance",{get:function(){return this.chart},set:function(value){this.chart=value}})}},"./node_modules/chart.js/src/core/core.controller.js":function(module,exports,__webpack_require__){"use strict";var defaults=__webpack_require__("./node_modules/chart.js/src/core/core.defaults.js"),helpers=__webpack_require__("./node_modules/chart.js/src/helpers/index.js"),Interaction=__webpack_require__("./node_modules/chart.js/src/core/core.interaction.js"),layouts=__webpack_require__("./node_modules/chart.js/src/core/core.layouts.js"),platform=__webpack_require__("./node_modules/chart.js/src/platforms/platform.js"),plugins=__webpack_require__("./node_modules/chart.js/src/core/core.plugins.js");module.exports=function(Chart){function positionIsHorizontal(position){return"top"===position||"bottom"===position}Chart.types={},Chart.instances={},Chart.controllers={},helpers.extend(Chart.prototype,{construct:function(item,config){var me=this;config=function(config){var data=(config=config||{}).data=config.data||{};return data.datasets=data.datasets||[],data.labels=data.labels||[],config.options=helpers.configMerge(defaults.global,defaults[config.type],config.options||{}),config}(config);var context=platform.acquireContext(item,config),canvas=context&&context.canvas,height=canvas&&canvas.height,width=canvas&&canvas.width;me.id=helpers.uid(),me.ctx=context,me.canvas=canvas,me.config=config,me.width=width,me.height=height,me.aspectRatio=height?width/height:null,me.options=config.options,me._bufferedRender=!1,me.chart=me,me.controller=me,Chart.instances[me.id]=me,Object.defineProperty(me,"data",{get:function(){return me.config.data},set:function(value){me.config.data=value}}),context&&canvas?(me.initialize(),me.update()):console.error("Failed to create chart: can't acquire context from the given item")},initialize:function(){var me=this;return plugins.notify(me,"beforeInit"),helpers.retinaScale(me,me.options.devicePixelRatio),me.bindEvents(),me.options.responsive&&me.resize(!0),me.ensureScalesHaveIDs(),me.buildOrUpdateScales(),me.initToolTip(),plugins.notify(me,"afterInit"),me},clear:function(){return helpers.canvas.clear(this),this},stop:function(){return Chart.animationService.cancelAnimation(this),this},resize:function(silent){var me=this,options=me.options,canvas=me.canvas,aspectRatio=options.maintainAspectRatio&&me.aspectRatio||null,newWidth=Math.max(0,Math.floor(helpers.getMaximumWidth(canvas))),newHeight=Math.max(0,Math.floor(aspectRatio?newWidth/aspectRatio:helpers.getMaximumHeight(canvas)));if((me.width!==newWidth||me.height!==newHeight)&&(canvas.width=me.width=newWidth,canvas.height=me.height=newHeight,canvas.style.width=newWidth+"px",canvas.style.height=newHeight+"px",helpers.retinaScale(me,options.devicePixelRatio),!silent)){var newSize={width:newWidth,height:newHeight};plugins.notify(me,"resize",[newSize]),me.options.onResize&&me.options.onResize(me,newSize),me.stop(),me.update(me.options.responsiveAnimationDuration)}},ensureScalesHaveIDs:function(){var options=this.options,scalesOptions=options.scales||{},scaleOptions=options.scale;helpers.each(scalesOptions.xAxes,function(xAxisOptions,index){xAxisOptions.id=xAxisOptions.id||"x-axis-"+index}),helpers.each(scalesOptions.yAxes,function(yAxisOptions,index){yAxisOptions.id=yAxisOptions.id||"y-axis-"+index}),scaleOptions&&(scaleOptions.id=scaleOptions.id||"scale")},buildOrUpdateScales:function(){var me=this,options=me.options,scales=me.scales||{},items=[],updated=Object.keys(scales).reduce(function(obj,id){return obj[id]=!1,obj},{});options.scales&&(items=items.concat((options.scales.xAxes||[]).map(function(xAxisOptions){return{options:xAxisOptions,dtype:"category",dposition:"bottom"}}),(options.scales.yAxes||[]).map(function(yAxisOptions){return{options:yAxisOptions,dtype:"linear",dposition:"left"}}))),options.scale&&items.push({options:options.scale,dtype:"radialLinear",isDefault:!0,dposition:"chartArea"}),helpers.each(items,function(item){var scaleOptions=item.options,id=scaleOptions.id,scaleType=helpers.valueOrDefault(scaleOptions.type,item.dtype);positionIsHorizontal(scaleOptions.position)!==positionIsHorizontal(item.dposition)&&(scaleOptions.position=item.dposition),updated[id]=!0;var scale=null;if(id in scales&&scales[id].type===scaleType)(scale=scales[id]).options=scaleOptions,scale.ctx=me.ctx,scale.chart=me;else{var scaleClass=Chart.scaleService.getScaleConstructor(scaleType);if(!scaleClass)return;scale=new scaleClass({id:id,type:scaleType,options:scaleOptions,ctx:me.ctx,chart:me}),scales[scale.id]=scale}scale.mergeTicksOptions(),item.isDefault&&(me.scale=scale)}),helpers.each(updated,function(hasUpdated,id){hasUpdated||delete scales[id]}),me.scales=scales,Chart.scaleService.addScalesToLayout(this)},buildOrUpdateControllers:function(){var me=this,types=[],newControllers=[];return helpers.each(me.data.datasets,function(dataset,datasetIndex){var meta=me.getDatasetMeta(datasetIndex),type=dataset.type||me.config.type;if(meta.type&&meta.type!==type&&(me.destroyDatasetMeta(datasetIndex),meta=me.getDatasetMeta(datasetIndex)),meta.type=type,types.push(meta.type),meta.controller)meta.controller.updateIndex(datasetIndex),meta.controller.linkScales();else{var ControllerClass=Chart.controllers[meta.type];if(void 0===ControllerClass)throw new Error('"'+meta.type+'" is not a chart type.');meta.controller=new ControllerClass(me,datasetIndex),newControllers.push(meta.controller)}},me),newControllers},resetElements:function(){var me=this;helpers.each(me.data.datasets,function(dataset,datasetIndex){me.getDatasetMeta(datasetIndex).controller.reset()},me)},reset:function(){this.resetElements(),this.tooltip.initialize()},update:function(config){var chart,newOptions,me=this;if(config&&"object"==typeof config||(config={duration:config,lazy:arguments[1]}),newOptions=(chart=me).options,helpers.each(chart.scales,function(scale){layouts.removeBox(chart,scale)}),newOptions=helpers.configMerge(Chart.defaults.global,Chart.defaults[chart.config.type],newOptions),chart.options=chart.config.options=newOptions,chart.ensureScalesHaveIDs(),chart.buildOrUpdateScales(),chart.tooltip._options=newOptions.tooltips,chart.tooltip.initialize(),plugins._invalidate(me),!1!==plugins.notify(me,"beforeUpdate")){me.tooltip._data=me.data;var newControllers=me.buildOrUpdateControllers();helpers.each(me.data.datasets,function(dataset,datasetIndex){me.getDatasetMeta(datasetIndex).controller.buildOrUpdateElements()},me),me.updateLayout(),me.options.animation&&me.options.animation.duration&&helpers.each(newControllers,function(controller){controller.reset()}),me.updateDatasets(),me.tooltip.initialize(),me.lastActive=[],plugins.notify(me,"afterUpdate"),me._bufferedRender?me._bufferedRequest={duration:config.duration,easing:config.easing,lazy:config.lazy}:me.render(config)}},updateLayout:function(){!1!==plugins.notify(this,"beforeLayout")&&(layouts.update(this,this.width,this.height),plugins.notify(this,"afterScaleUpdate"),plugins.notify(this,"afterLayout"))},updateDatasets:function(){if(!1!==plugins.notify(this,"beforeDatasetsUpdate")){for(var i=0,ilen=this.data.datasets.length;i<ilen;++i)this.updateDataset(i);plugins.notify(this,"afterDatasetsUpdate")}},updateDataset:function(index){var meta=this.getDatasetMeta(index),args={meta:meta,index:index};!1!==plugins.notify(this,"beforeDatasetUpdate",[args])&&(meta.controller.update(),plugins.notify(this,"afterDatasetUpdate",[args]))},render:function(config){var me=this;config&&"object"==typeof config||(config={duration:config,lazy:arguments[1]});var duration=config.duration,lazy=config.lazy;if(!1!==plugins.notify(me,"beforeRender")){var animationOptions=me.options.animation,onComplete=function(animation){plugins.notify(me,"afterRender"),helpers.callback(animationOptions&&animationOptions.onComplete,[animation],me)};if(animationOptions&&(void 0!==duration&&0!==duration||void 0===duration&&0!==animationOptions.duration)){var animation=new Chart.Animation({numSteps:(duration||animationOptions.duration)/16.66,easing:config.easing||animationOptions.easing,render:function(chart,animationObject){var easingFunction=helpers.easing.effects[animationObject.easing],currentStep=animationObject.currentStep,stepDecimal=currentStep/animationObject.numSteps;chart.draw(easingFunction(stepDecimal),stepDecimal,currentStep)},onAnimationProgress:animationOptions.onProgress,onAnimationComplete:onComplete});Chart.animationService.addAnimation(me,animation,duration,lazy)}else me.draw(),onComplete(new Chart.Animation({numSteps:0,chart:me}));return me}},draw:function(easingValue){var me=this;me.clear(),helpers.isNullOrUndef(easingValue)&&(easingValue=1),me.transition(easingValue),!1!==plugins.notify(me,"beforeDraw",[easingValue])&&(helpers.each(me.boxes,function(box){box.draw(me.chartArea)},me),me.scale&&me.scale.draw(),me.drawDatasets(easingValue),me._drawTooltip(easingValue),plugins.notify(me,"afterDraw",[easingValue]))},transition:function(easingValue){for(var i=0,ilen=(this.data.datasets||[]).length;i<ilen;++i)this.isDatasetVisible(i)&&this.getDatasetMeta(i).controller.transition(easingValue);this.tooltip.transition(easingValue)},drawDatasets:function(easingValue){var me=this;if(!1!==plugins.notify(me,"beforeDatasetsDraw",[easingValue])){for(var i=(me.data.datasets||[]).length-1;i>=0;--i)me.isDatasetVisible(i)&&me.drawDataset(i,easingValue);plugins.notify(me,"afterDatasetsDraw",[easingValue])}},drawDataset:function(index,easingValue){var meta=this.getDatasetMeta(index),args={meta:meta,index:index,easingValue:easingValue};!1!==plugins.notify(this,"beforeDatasetDraw",[args])&&(meta.controller.draw(easingValue),plugins.notify(this,"afterDatasetDraw",[args]))},_drawTooltip:function(easingValue){var tooltip=this.tooltip,args={tooltip:tooltip,easingValue:easingValue};!1!==plugins.notify(this,"beforeTooltipDraw",[args])&&(tooltip.draw(),plugins.notify(this,"afterTooltipDraw",[args]))},getElementAtEvent:function(e){return Interaction.modes.single(this,e)},getElementsAtEvent:function(e){return Interaction.modes.label(this,e,{intersect:!0})},getElementsAtXAxis:function(e){return Interaction.modes["x-axis"](this,e,{intersect:!0})},getElementsAtEventForMode:function(e,mode,options){var method=Interaction.modes[mode];return"function"==typeof method?method(this,e,options):[]},getDatasetAtEvent:function(e){return Interaction.modes.dataset(this,e,{intersect:!0})},getDatasetMeta:function(datasetIndex){var dataset=this.data.datasets[datasetIndex];dataset._meta||(dataset._meta={});var meta=dataset._meta[this.id];return meta||(meta=dataset._meta[this.id]={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null}),meta},getVisibleDatasetCount:function(){for(var count=0,i=0,ilen=this.data.datasets.length;i<ilen;++i)this.isDatasetVisible(i)&&count++;return count},isDatasetVisible:function(datasetIndex){var meta=this.getDatasetMeta(datasetIndex);return"boolean"==typeof meta.hidden?!meta.hidden:!this.data.datasets[datasetIndex].hidden},generateLegend:function(){return this.options.legendCallback(this)},destroyDatasetMeta:function(datasetIndex){var id=this.id,dataset=this.data.datasets[datasetIndex],meta=dataset._meta&&dataset._meta[id];meta&&(meta.controller.destroy(),delete dataset._meta[id])},destroy:function(){var i,ilen,me=this,canvas=me.canvas;for(me.stop(),i=0,ilen=me.data.datasets.length;i<ilen;++i)me.destroyDatasetMeta(i);canvas&&(me.unbindEvents(),helpers.canvas.clear(me),platform.releaseContext(me.ctx),me.canvas=null,me.ctx=null),plugins.notify(me,"destroy"),delete Chart.instances[me.id]},toBase64Image:function(){return this.canvas.toDataURL.apply(this.canvas,arguments)},initToolTip:function(){var me=this;me.tooltip=new Chart.Tooltip({_chart:me,_chartInstance:me,_data:me.data,_options:me.options.tooltips},me)},bindEvents:function(){var me=this,listeners=me._listeners={},listener=function(){me.eventHandler.apply(me,arguments)};helpers.each(me.options.events,function(type){platform.addEventListener(me,type,listener),listeners[type]=listener}),me.options.responsive&&(listener=function(){me.resize()},platform.addEventListener(me,"resize",listener),listeners.resize=listener)},unbindEvents:function(){var me=this,listeners=me._listeners;listeners&&(delete me._listeners,helpers.each(listeners,function(listener,type){platform.removeEventListener(me,type,listener)}))},updateHoverStyle:function(elements,mode,enabled){var element,i,ilen,method=enabled?"setHoverStyle":"removeHoverStyle";for(i=0,ilen=elements.length;i<ilen;++i)(element=elements[i])&&this.getDatasetMeta(element._datasetIndex).controller[method](element)},eventHandler:function(e){var me=this,tooltip=me.tooltip;if(!1!==plugins.notify(me,"beforeEvent",[e])){me._bufferedRender=!0,me._bufferedRequest=null;var changed=me.handleEvent(e);tooltip&&(changed=tooltip._start?tooltip.handleEvent(e):changed|tooltip.handleEvent(e)),plugins.notify(me,"afterEvent",[e]);var bufferedRequest=me._bufferedRequest;return bufferedRequest?me.render(bufferedRequest):changed&&!me.animating&&(me.stop(),me.render(me.options.hover.animationDuration,!0)),me._bufferedRender=!1,me._bufferedRequest=null,me}},handleEvent:function(e){var changed,me=this,options=me.options||{},hoverOptions=options.hover;return me.lastActive=me.lastActive||[],"mouseout"===e.type?me.active=[]:me.active=me.getElementsAtEventForMode(e,hoverOptions.mode,hoverOptions),helpers.callback(options.onHover||options.hover.onHover,[e.native,me.active],me),"mouseup"!==e.type&&"click"!==e.type||options.onClick&&options.onClick.call(me,e.native,me.active),me.lastActive.length&&me.updateHoverStyle(me.lastActive,hoverOptions.mode,!1),me.active.length&&hoverOptions.mode&&me.updateHoverStyle(me.active,hoverOptions.mode,!0),changed=!helpers.arrayEquals(me.active,me.lastActive),me.lastActive=me.active,changed}}),Chart.Controller=Chart}},"./node_modules/chart.js/src/core/core.datasetController.js":function(module,exports,__webpack_require__){"use strict";var helpers=__webpack_require__("./node_modules/chart.js/src/helpers/index.js");module.exports=function(Chart){var arrayEvents=["push","pop","shift","splice","unshift"];function unlistenArrayEvents(array,listener){var stub=array._chartjs;if(stub){var listeners=stub.listeners,index=listeners.indexOf(listener);-1!==index&&listeners.splice(index,1),listeners.length>0||(arrayEvents.forEach(function(key){delete array[key]}),delete array._chartjs)}}Chart.DatasetController=function(chart,datasetIndex){this.initialize(chart,datasetIndex)},helpers.extend(Chart.DatasetController.prototype,{datasetElementType:null,dataElementType:null,initialize:function(chart,datasetIndex){this.chart=chart,this.index=datasetIndex,this.linkScales(),this.addElements()},updateIndex:function(datasetIndex){this.index=datasetIndex},linkScales:function(){var me=this,meta=me.getMeta(),dataset=me.getDataset();null!==meta.xAxisID&&meta.xAxisID in me.chart.scales||(meta.xAxisID=dataset.xAxisID||me.chart.options.scales.xAxes[0].id),null!==meta.yAxisID&&meta.yAxisID in me.chart.scales||(meta.yAxisID=dataset.yAxisID||me.chart.options.scales.yAxes[0].id)},getDataset:function(){return this.chart.data.datasets[this.index]},getMeta:function(){return this.chart.getDatasetMeta(this.index)},getScaleForId:function(scaleID){return this.chart.scales[scaleID]},reset:function(){this.update(!0)},destroy:function(){this._data&&unlistenArrayEvents(this._data,this)},createMetaDataset:function(){var type=this.datasetElementType;return type&&new type({_chart:this.chart,_datasetIndex:this.index})},createMetaData:function(index){var type=this.dataElementType;return type&&new type({_chart:this.chart,_datasetIndex:this.index,_index:index})},addElements:function(){var i,ilen,meta=this.getMeta(),data=this.getDataset().data||[],metaData=meta.data;for(i=0,ilen=data.length;i<ilen;++i)metaData[i]=metaData[i]||this.createMetaData(i);meta.dataset=meta.dataset||this.createMetaDataset()},addElementAndReset:function(index){var element=this.createMetaData(index);this.getMeta().data.splice(index,0,element),this.updateElement(element,index,!0)},buildOrUpdateElements:function(){var array,listener,me=this,dataset=me.getDataset(),data=dataset.data||(dataset.data=[]);me._data!==data&&(me._data&&unlistenArrayEvents(me._data,me),listener=me,(array=data)._chartjs?array._chartjs.listeners.push(listener):(Object.defineProperty(array,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[listener]}}),arrayEvents.forEach(function(key){var method="onData"+key.charAt(0).toUpperCase()+key.slice(1),base=array[key];Object.defineProperty(array,key,{configurable:!0,enumerable:!1,value:function(){var args=Array.prototype.slice.call(arguments),res=base.apply(this,args);return helpers.each(array._chartjs.listeners,function(object){"function"==typeof object[method]&&object[method].apply(object,args)}),res}})})),me._data=data),me.resyncElements()},update:helpers.noop,transition:function(easingValue){for(var meta=this.getMeta(),elements=meta.data||[],ilen=elements.length,i=0;i<ilen;++i)elements[i].transition(easingValue);meta.dataset&&meta.dataset.transition(easingValue)},draw:function(){var meta=this.getMeta(),elements=meta.data||[],ilen=elements.length,i=0;for(meta.dataset&&meta.dataset.draw();i<ilen;++i)elements[i].draw()},removeHoverStyle:function(element,elementOpts){var dataset=this.chart.data.datasets[element._datasetIndex],index=element._index,custom=element.custom||{},valueOrDefault=helpers.valueAtIndexOrDefault,model=element._model;model.backgroundColor=custom.backgroundColor?custom.backgroundColor:valueOrDefault(dataset.backgroundColor,index,elementOpts.backgroundColor),model.borderColor=custom.borderColor?custom.borderColor:valueOrDefault(dataset.borderColor,index,elementOpts.borderColor),model.borderWidth=custom.borderWidth?custom.borderWidth:valueOrDefault(dataset.borderWidth,index,elementOpts.borderWidth)},setHoverStyle:function(element){var dataset=this.chart.data.datasets[element._datasetIndex],index=element._index,custom=element.custom||{},valueOrDefault=helpers.valueAtIndexOrDefault,getHoverColor=helpers.getHoverColor,model=element._model;model.backgroundColor=custom.hoverBackgroundColor?custom.hoverBackgroundColor:valueOrDefault(dataset.hoverBackgroundColor,index,getHoverColor(model.backgroundColor)),model.borderColor=custom.hoverBorderColor?custom.hoverBorderColor:valueOrDefault(dataset.hoverBorderColor,index,getHoverColor(model.borderColor)),model.borderWidth=custom.hoverBorderWidth?custom.hoverBorderWidth:valueOrDefault(dataset.hoverBorderWidth,index,model.borderWidth)},resyncElements:function(){var meta=this.getMeta(),data=this.getDataset().data,numMeta=meta.data.length,numData=data.length;numData<numMeta?meta.data.splice(numData,numMeta-numData):numData>numMeta&&this.insertElements(numMeta,numData-numMeta)},insertElements:function(start,count){for(var i=0;i<count;++i)this.addElementAndReset(start+i)},onDataPush:function(){this.insertElements(this.getDataset().data.length-1,arguments.length)},onDataPop:function(){this.getMeta().data.pop()},onDataShift:function(){this.getMeta().data.shift()},onDataSplice:function(start,count){this.getMeta().data.splice(start,count),this.insertElements(start,arguments.length-2)},onDataUnshift:function(){this.insertElements(0,arguments.length)}}),Chart.DatasetController.extend=helpers.inherits}},"./node_modules/chart.js/src/core/core.defaults.js":function(module,exports,__webpack_require__){"use strict";var helpers=__webpack_require__("./node_modules/chart.js/src/helpers/index.js");module.exports={_set:function(scope,values){return helpers.merge(this[scope]||(this[scope]={}),values)}}},"./node_modules/chart.js/src/core/core.element.js":function(module,exports,__webpack_require__){"use strict";var color=__webpack_require__("./node_modules/chartjs-color/index.js"),helpers=__webpack_require__("./node_modules/chart.js/src/helpers/index.js");var Element=function(configuration){helpers.extend(this,configuration),this.initialize.apply(this,arguments)};helpers.extend(Element.prototype,{initialize:function(){this.hidden=!1},pivot:function(){var me=this;return me._view||(me._view=helpers.clone(me._model)),me._start={},me},transition:function(ease){var me=this,model=me._model,start=me._start,view=me._view;return model&&1!==ease?(view||(view=me._view={}),start||(start=me._start={}),function(start,view,model,ease){var i,ilen,key,actual,origin,target,type,c0,c1,keys=Object.keys(model);for(i=0,ilen=keys.length;i<ilen;++i)if(target=model[key=keys[i]],view.hasOwnProperty(key)||(view[key]=target),(actual=view[key])!==target&&"_"!==key[0]){if(start.hasOwnProperty(key)||(start[key]=actual),(type=typeof target)==typeof(origin=start[key]))if("string"===type){if((c0=color(origin)).valid&&(c1=color(target)).valid){view[key]=c1.mix(c0,ease).rgbString();continue}}else if("number"===type&&isFinite(origin)&&isFinite(target)){view[key]=origin+(target-origin)*ease;continue}view[key]=target}}(start,view,model,ease),me):(me._view=model,me._start=null,me)},tooltipPosition:function(){return{x:this._model.x,y:this._model.y}},hasValue:function(){return helpers.isNumber(this._model.x)&&helpers.isNumber(this._model.y)}}),Element.extend=helpers.inherits,module.exports=Element},"./node_modules/chart.js/src/core/core.helpers.js":function(module,exports,__webpack_require__){"use strict";var color=__webpack_require__("./node_modules/chartjs-color/index.js"),defaults=__webpack_require__("./node_modules/chart.js/src/core/core.defaults.js"),helpers=__webpack_require__("./node_modules/chart.js/src/helpers/index.js");module.exports=function(Chart){function parseMaxStyle(styleValue,node,parentProperty){var valueInPixels;return"string"==typeof styleValue?(valueInPixels=parseInt(styleValue,10),-1!==styleValue.indexOf("%")&&(valueInPixels=valueInPixels/100*node.parentNode[parentProperty])):valueInPixels=styleValue,valueInPixels}function isConstrainedValue(value){return void 0!==value&&null!==value&&"none"!==value}function getConstraintDimension(domNode,maxStyle,percentageProperty){var view=document.defaultView,parentNode=domNode.parentNode,constrainedNode=view.getComputedStyle(domNode)[maxStyle],constrainedContainer=view.getComputedStyle(parentNode)[maxStyle],hasCNode=isConstrainedValue(constrainedNode),hasCContainer=isConstrainedValue(constrainedContainer),infinity=Number.POSITIVE_INFINITY;return hasCNode||hasCContainer?Math.min(hasCNode?parseMaxStyle(constrainedNode,domNode,percentageProperty):infinity,hasCContainer?parseMaxStyle(constrainedContainer,parentNode,percentageProperty):infinity):"none"}helpers.configMerge=function(){return helpers.merge(helpers.clone(arguments[0]),[].slice.call(arguments,1),{merger:function(key,target,source,options){var tval=target[key]||{},sval=source[key];"scales"===key?target[key]=helpers.scaleMerge(tval,sval):"scale"===key?target[key]=helpers.merge(tval,[Chart.scaleService.getScaleDefaults(sval.type),sval]):helpers._merger(key,target,source,options)}})},helpers.scaleMerge=function(){return helpers.merge(helpers.clone(arguments[0]),[].slice.call(arguments,1),{merger:function(key,target,source,options){if("xAxes"===key||"yAxes"===key){var i,type,scale,slen=source[key].length;for(target[key]||(target[key]=[]),i=0;i<slen;++i)scale=source[key][i],type=helpers.valueOrDefault(scale.type,"xAxes"===key?"category":"linear"),i>=target[key].length&&target[key].push({}),!target[key][i].type||scale.type&&scale.type!==target[key][i].type?helpers.merge(target[key][i],[Chart.scaleService.getScaleDefaults(type),scale]):helpers.merge(target[key][i],scale)}else helpers._merger(key,target,source,options)}})},helpers.where=function(collection,filterCallback){if(helpers.isArray(collection)&&Array.prototype.filter)return collection.filter(filterCallback);var filtered=[];return helpers.each(collection,function(item){filterCallback(item)&&filtered.push(item)}),filtered},helpers.findIndex=Array.prototype.findIndex?function(array,callback,scope){return array.findIndex(callback,scope)}:function(array,callback,scope){scope=void 0===scope?array:scope;for(var i=0,ilen=array.length;i<ilen;++i)if(callback.call(scope,array[i],i,array))return i;return-1},helpers.findNextWhere=function(arrayToSearch,filterCallback,startIndex){helpers.isNullOrUndef(startIndex)&&(startIndex=-1);for(var i=startIndex+1;i<arrayToSearch.length;i++){var currentItem=arrayToSearch[i];if(filterCallback(currentItem))return currentItem}},helpers.findPreviousWhere=function(arrayToSearch,filterCallback,startIndex){helpers.isNullOrUndef(startIndex)&&(startIndex=arrayToSearch.length);for(var i=startIndex-1;i>=0;i--){var currentItem=arrayToSearch[i];if(filterCallback(currentItem))return currentItem}},helpers.isNumber=function(n){return!isNaN(parseFloat(n))&&isFinite(n)},helpers.almostEquals=function(x,y,epsilon){return Math.abs(x-y)<epsilon},helpers.almostWhole=function(x,epsilon){var rounded=Math.round(x);return rounded-epsilon<x&&rounded+epsilon>x},helpers.max=function(array){return array.reduce(function(max,value){return isNaN(value)?max:Math.max(max,value)},Number.NEGATIVE_INFINITY)},helpers.min=function(array){return array.reduce(function(min,value){return isNaN(value)?min:Math.min(min,value)},Number.POSITIVE_INFINITY)},helpers.sign=Math.sign?function(x){return Math.sign(x)}:function(x){return 0===(x=+x)||isNaN(x)?x:x>0?1:-1},helpers.log10=Math.log10?function(x){return Math.log10(x)}:function(x){var exponent=Math.log(x)*Math.LOG10E,powerOf10=Math.round(exponent);return x===Math.pow(10,powerOf10)?powerOf10:exponent},helpers.toRadians=function(degrees){return degrees*(Math.PI/180)},helpers.toDegrees=function(radians){return radians*(180/Math.PI)},helpers.getAngleFromPoint=function(centrePoint,anglePoint){var distanceFromXCenter=anglePoint.x-centrePoint.x,distanceFromYCenter=anglePoint.y-centrePoint.y,radialDistanceFromCenter=Math.sqrt(distanceFromXCenter*distanceFromXCenter+distanceFromYCenter*distanceFromYCenter),angle=Math.atan2(distanceFromYCenter,distanceFromXCenter);return angle<-.5*Math.PI&&(angle+=2*Math.PI),{angle:angle,distance:radialDistanceFromCenter}},helpers.distanceBetweenPoints=function(pt1,pt2){return Math.sqrt(Math.pow(pt2.x-pt1.x,2)+Math.pow(pt2.y-pt1.y,2))},helpers.aliasPixel=function(pixelWidth){return pixelWidth%2==0?0:.5},helpers.splineCurve=function(firstPoint,middlePoint,afterPoint,t){var previous=firstPoint.skip?middlePoint:firstPoint,current=middlePoint,next=afterPoint.skip?middlePoint:afterPoint,d01=Math.sqrt(Math.pow(current.x-previous.x,2)+Math.pow(current.y-previous.y,2)),d12=Math.sqrt(Math.pow(next.x-current.x,2)+Math.pow(next.y-current.y,2)),s01=d01/(d01+d12),s12=d12/(d01+d12),fa=t*(s01=isNaN(s01)?0:s01),fb=t*(s12=isNaN(s12)?0:s12);return{previous:{x:current.x-fa*(next.x-previous.x),y:current.y-fa*(next.y-previous.y)},next:{x:current.x+fb*(next.x-previous.x),y:current.y+fb*(next.y-previous.y)}}},helpers.EPSILON=Number.EPSILON||1e-14,helpers.splineCurveMonotone=function(points){var i,pointBefore,pointCurrent,pointAfter,alphaK,betaK,tauK,squaredMagnitude,deltaX,pointsWithTangents=(points||[]).map(function(point){return{model:point._model,deltaK:0,mK:0}}),pointsLen=pointsWithTangents.length;for(i=0;i<pointsLen;++i)if(!(pointCurrent=pointsWithTangents[i]).model.skip){if(pointBefore=i>0?pointsWithTangents[i-1]:null,(pointAfter=i<pointsLen-1?pointsWithTangents[i+1]:null)&&!pointAfter.model.skip){var slopeDeltaX=pointAfter.model.x-pointCurrent.model.x;pointCurrent.deltaK=0!==slopeDeltaX?(pointAfter.model.y-pointCurrent.model.y)/slopeDeltaX:0}!pointBefore||pointBefore.model.skip?pointCurrent.mK=pointCurrent.deltaK:!pointAfter||pointAfter.model.skip?pointCurrent.mK=pointBefore.deltaK:this.sign(pointBefore.deltaK)!==this.sign(pointCurrent.deltaK)?pointCurrent.mK=0:pointCurrent.mK=(pointBefore.deltaK+pointCurrent.deltaK)/2}for(i=0;i<pointsLen-1;++i)pointCurrent=pointsWithTangents[i],pointAfter=pointsWithTangents[i+1],pointCurrent.model.skip||pointAfter.model.skip||(helpers.almostEquals(pointCurrent.deltaK,0,this.EPSILON)?pointCurrent.mK=pointAfter.mK=0:(alphaK=pointCurrent.mK/pointCurrent.deltaK,betaK=pointAfter.mK/pointCurrent.deltaK,(squaredMagnitude=Math.pow(alphaK,2)+Math.pow(betaK,2))<=9||(tauK=3/Math.sqrt(squaredMagnitude),pointCurrent.mK=alphaK*tauK*pointCurrent.deltaK,pointAfter.mK=betaK*tauK*pointCurrent.deltaK)));for(i=0;i<pointsLen;++i)(pointCurrent=pointsWithTangents[i]).model.skip||(pointBefore=i>0?pointsWithTangents[i-1]:null,pointAfter=i<pointsLen-1?pointsWithTangents[i+1]:null,pointBefore&&!pointBefore.model.skip&&(deltaX=(pointCurrent.model.x-pointBefore.model.x)/3,pointCurrent.model.controlPointPreviousX=pointCurrent.model.x-deltaX,pointCurrent.model.controlPointPreviousY=pointCurrent.model.y-deltaX*pointCurrent.mK),pointAfter&&!pointAfter.model.skip&&(deltaX=(pointAfter.model.x-pointCurrent.model.x)/3,pointCurrent.model.controlPointNextX=pointCurrent.model.x+deltaX,pointCurrent.model.controlPointNextY=pointCurrent.model.y+deltaX*pointCurrent.mK))},helpers.nextItem=function(collection,index,loop){return loop?index>=collection.length-1?collection[0]:collection[index+1]:index>=collection.length-1?collection[collection.length-1]:collection[index+1]},helpers.previousItem=function(collection,index,loop){return loop?index<=0?collection[collection.length-1]:collection[index-1]:index<=0?collection[0]:collection[index-1]},helpers.niceNum=function(range,round){var exponent=Math.floor(helpers.log10(range)),fraction=range/Math.pow(10,exponent);return(round?fraction<1.5?1:fraction<3?2:fraction<7?5:10:fraction<=1?1:fraction<=2?2:fraction<=5?5:10)*Math.pow(10,exponent)},helpers.requestAnimFrame="undefined"==typeof window?function(callback){callback()}:window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(callback){return window.setTimeout(callback,1e3/60)},helpers.getRelativePosition=function(evt,chart){var mouseX,mouseY,e=evt.originalEvent||evt,canvas=evt.currentTarget||evt.srcElement,boundingRect=canvas.getBoundingClientRect(),touches=e.touches;touches&&touches.length>0?(mouseX=touches[0].clientX,mouseY=touches[0].clientY):(mouseX=e.clientX,mouseY=e.clientY);var paddingLeft=parseFloat(helpers.getStyle(canvas,"padding-left")),paddingTop=parseFloat(helpers.getStyle(canvas,"padding-top")),paddingRight=parseFloat(helpers.getStyle(canvas,"padding-right")),paddingBottom=parseFloat(helpers.getStyle(canvas,"padding-bottom")),width=boundingRect.right-boundingRect.left-paddingLeft-paddingRight,height=boundingRect.bottom-boundingRect.top-paddingTop-paddingBottom;return{x:mouseX=Math.round((mouseX-boundingRect.left-paddingLeft)/width*canvas.width/chart.currentDevicePixelRatio),y:mouseY=Math.round((mouseY-boundingRect.top-paddingTop)/height*canvas.height/chart.currentDevicePixelRatio)}},helpers.getConstraintWidth=function(domNode){return getConstraintDimension(domNode,"max-width","clientWidth")},helpers.getConstraintHeight=function(domNode){return getConstraintDimension(domNode,"max-height","clientHeight")},helpers.getMaximumWidth=function(domNode){var container=domNode.parentNode;if(!container)return domNode.clientWidth;var paddingLeft=parseInt(helpers.getStyle(container,"padding-left"),10),paddingRight=parseInt(helpers.getStyle(container,"padding-right"),10),w=container.clientWidth-paddingLeft-paddingRight,cw=helpers.getConstraintWidth(domNode);return isNaN(cw)?w:Math.min(w,cw)},helpers.getMaximumHeight=function(domNode){var container=domNode.parentNode;if(!container)return domNode.clientHeight;var paddingTop=parseInt(helpers.getStyle(container,"padding-top"),10),paddingBottom=parseInt(helpers.getStyle(container,"padding-bottom"),10),h=container.clientHeight-paddingTop-paddingBottom,ch=helpers.getConstraintHeight(domNode);return isNaN(ch)?h:Math.min(h,ch)},helpers.getStyle=function(el,property){return el.currentStyle?el.currentStyle[property]:document.defaultView.getComputedStyle(el,null).getPropertyValue(property)},helpers.retinaScale=function(chart,forceRatio){var pixelRatio=chart.currentDevicePixelRatio=forceRatio||window.devicePixelRatio||1;if(1!==pixelRatio){var canvas=chart.canvas,height=chart.height,width=chart.width;canvas.height=height*pixelRatio,canvas.width=width*pixelRatio,chart.ctx.scale(pixelRatio,pixelRatio),canvas.style.height||canvas.style.width||(canvas.style.height=height+"px",canvas.style.width=width+"px")}},helpers.fontString=function(pixelSize,fontStyle,fontFamily){return fontStyle+" "+pixelSize+"px "+fontFamily},helpers.longestText=function(ctx,font,arrayOfThings,cache){var data=(cache=cache||{}).data=cache.data||{},gc=cache.garbageCollect=cache.garbageCollect||[];cache.font!==font&&(data=cache.data={},gc=cache.garbageCollect=[],cache.font=font),ctx.font=font;var longest=0;helpers.each(arrayOfThings,function(thing){void 0!==thing&&null!==thing&&!0!==helpers.isArray(thing)?longest=helpers.measureText(ctx,data,gc,longest,thing):helpers.isArray(thing)&&helpers.each(thing,function(nestedThing){void 0===nestedThing||null===nestedThing||helpers.isArray(nestedThing)||(longest=helpers.measureText(ctx,data,gc,longest,nestedThing))})});var gcLen=gc.length/2;if(gcLen>arrayOfThings.length){for(var i=0;i<gcLen;i++)delete data[gc[i]];gc.splice(0,gcLen)}return longest},helpers.measureText=function(ctx,data,gc,longest,string){var textWidth=data[string];return textWidth||(textWidth=data[string]=ctx.measureText(string).width,gc.push(string)),textWidth>longest&&(longest=textWidth),longest},helpers.numberOfLabelLines=function(arrayOfThings){var numberOfLines=1;return helpers.each(arrayOfThings,function(thing){helpers.isArray(thing)&&thing.length>numberOfLines&&(numberOfLines=thing.length)}),numberOfLines},helpers.color=color?function(value){return value instanceof CanvasGradient&&(value=defaults.global.defaultColor),color(value)}:function(value){return console.error("Color.js not found!"),value},helpers.getHoverColor=function(colorValue){return colorValue instanceof CanvasPattern?colorValue:helpers.color(colorValue).saturate(.5).darken(.1).rgbString()}}},"./node_modules/chart.js/src/core/core.interaction.js":function(module,exports,__webpack_require__){"use strict";var helpers=__webpack_require__("./node_modules/chart.js/src/helpers/index.js");function getRelativePosition(e,chart){return e.native?{x:e.x,y:e.y}:helpers.getRelativePosition(e,chart)}function parseVisibleItems(chart,handler){var meta,i,j,ilen,jlen;for(i=0,ilen=chart.data.datasets.length;i<ilen;++i)if(chart.isDatasetVisible(i))for(j=0,jlen=(meta=chart.getDatasetMeta(i)).data.length;j<jlen;++j){var element=meta.data[j];element._view.skip||handler(element)}}function getIntersectItems(chart,position){var elements=[];return parseVisibleItems(chart,function(element){element.inRange(position.x,position.y)&&elements.push(element)}),elements}function getNearestItems(chart,position,intersect,distanceMetric){var minDistance=Number.POSITIVE_INFINITY,nearestItems=[];return parseVisibleItems(chart,function(element){if(!intersect||element.inRange(position.x,position.y)){var center=element.getCenterPoint(),distance=distanceMetric(position,center);distance<minDistance?(nearestItems=[element],minDistance=distance):distance===minDistance&&nearestItems.push(element)}}),nearestItems}function getDistanceMetricForAxis(axis){var useX=-1!==axis.indexOf("x"),useY=-1!==axis.indexOf("y");return function(pt1,pt2){var deltaX=useX?Math.abs(pt1.x-pt2.x):0,deltaY=useY?Math.abs(pt1.y-pt2.y):0;return Math.sqrt(Math.pow(deltaX,2)+Math.pow(deltaY,2))}}function indexMode(chart,e,options){var position=getRelativePosition(e,chart);options.axis=options.axis||"x";var distanceMetric=getDistanceMetricForAxis(options.axis),items=options.intersect?getIntersectItems(chart,position):getNearestItems(chart,position,!1,distanceMetric),elements=[];return items.length?(chart.data.datasets.forEach(function(dataset,datasetIndex){if(chart.isDatasetVisible(datasetIndex)){var element=chart.getDatasetMeta(datasetIndex).data[items[0]._index];element&&!element._view.skip&&elements.push(element)}}),elements):[]}module.exports={modes:{single:function(chart,e){var position=getRelativePosition(e,chart),elements=[];return parseVisibleItems(chart,function(element){if(element.inRange(position.x,position.y))return elements.push(element),elements}),elements.slice(0,1)},label:indexMode,index:indexMode,dataset:function(chart,e,options){var position=getRelativePosition(e,chart);options.axis=options.axis||"xy";var distanceMetric=getDistanceMetricForAxis(options.axis),items=options.intersect?getIntersectItems(chart,position):getNearestItems(chart,position,!1,distanceMetric);return items.length>0&&(items=chart.getDatasetMeta(items[0]._datasetIndex).data),items},"x-axis":function(chart,e){return indexMode(chart,e,{intersect:!1})},point:function(chart,e){return getIntersectItems(chart,getRelativePosition(e,chart))},nearest:function(chart,e,options){var position=getRelativePosition(e,chart);options.axis=options.axis||"xy";var distanceMetric=getDistanceMetricForAxis(options.axis),nearestItems=getNearestItems(chart,position,options.intersect,distanceMetric);return nearestItems.length>1&&nearestItems.sort(function(a,b){var ret=a.getArea()-b.getArea();return 0===ret&&(ret=a._datasetIndex-b._datasetIndex),ret}),nearestItems.slice(0,1)},x:function(chart,e,options){var position=getRelativePosition(e,chart),items=[],intersectsItem=!1;return parseVisibleItems(chart,function(element){element.inXRange(position.x)&&items.push(element),element.inRange(position.x,position.y)&&(intersectsItem=!0)}),options.intersect&&!intersectsItem&&(items=[]),items},y:function(chart,e,options){var position=getRelativePosition(e,chart),items=[],intersectsItem=!1;return parseVisibleItems(chart,function(element){element.inYRange(position.y)&&items.push(element),element.inRange(position.x,position.y)&&(intersectsItem=!0)}),options.intersect&&!intersectsItem&&(items=[]),items}}}},"./node_modules/chart.js/src/core/core.js":function(module,exports,__webpack_require__){"use strict";__webpack_require__("./node_modules/chart.js/src/core/core.defaults.js")._set("global",{responsive:!0,responsiveAnimationDuration:0,maintainAspectRatio:!0,events:["mousemove","mouseout","click","touchstart","touchmove"],hover:{onHover:null,mode:"nearest",intersect:!0,animationDuration:400},onClick:null,defaultColor:"rgba(0,0,0,0.1)",defaultFontColor:"#666",defaultFontFamily:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",defaultFontSize:12,defaultFontStyle:"normal",showLines:!0,elements:{},layout:{padding:{top:0,right:0,bottom:0,left:0}}}),module.exports=function(){var Chart=function(item,config){return this.construct(item,config),this};return Chart.Chart=Chart,Chart}},"./node_modules/chart.js/src/core/core.layouts.js":function(module,exports,__webpack_require__){"use strict";var helpers=__webpack_require__("./node_modules/chart.js/src/helpers/index.js");function filterByPosition(array,position){return helpers.where(array,function(v){return v.position===position})}function sortByWeight(array,reverse){array.forEach(function(v,i){return v._tmpIndex_=i,v}),array.sort(function(a,b){var v0=reverse?b:a,v1=reverse?a:b;return v0.weight===v1.weight?v0._tmpIndex_-v1._tmpIndex_:v0.weight-v1.weight}),array.forEach(function(v){delete v._tmpIndex_})}module.exports={defaults:{},addBox:function(chart,item){chart.boxes||(chart.boxes=[]),item.fullWidth=item.fullWidth||!1,item.position=item.position||"top",item.weight=item.weight||0,chart.boxes.push(item)},removeBox:function(chart,layoutItem){var index=chart.boxes?chart.boxes.indexOf(layoutItem):-1;-1!==index&&chart.boxes.splice(index,1)},configure:function(chart,item,options){for(var prop,props=["fullWidth","position","weight"],ilen=props.length,i=0;i<ilen;++i)prop=props[i],options.hasOwnProperty(prop)&&(item[prop]=options[prop])},update:function(chart,width,height){if(chart){var layoutOptions=chart.options.layout||{},padding=helpers.options.toPadding(layoutOptions.padding),leftPadding=padding.left,rightPadding=padding.right,topPadding=padding.top,bottomPadding=padding.bottom,leftBoxes=filterByPosition(chart.boxes,"left"),rightBoxes=filterByPosition(chart.boxes,"right"),topBoxes=filterByPosition(chart.boxes,"top"),bottomBoxes=filterByPosition(chart.boxes,"bottom"),chartAreaBoxes=filterByPosition(chart.boxes,"chartArea");sortByWeight(leftBoxes,!0),sortByWeight(rightBoxes,!1),sortByWeight(topBoxes,!0),sortByWeight(bottomBoxes,!1);var chartWidth=width-leftPadding-rightPadding,chartHeight=height-topPadding-bottomPadding,chartAreaHeight=chartHeight/2,verticalBoxWidth=(width-chartWidth/2)/(leftBoxes.length+rightBoxes.length),horizontalBoxHeight=(height-chartAreaHeight)/(topBoxes.length+bottomBoxes.length),maxChartAreaWidth=chartWidth,maxChartAreaHeight=chartHeight,minBoxSizes=[];helpers.each(leftBoxes.concat(rightBoxes,topBoxes,bottomBoxes),function(box){var minSize,isHorizontal=box.isHorizontal();isHorizontal?(minSize=box.update(box.fullWidth?chartWidth:maxChartAreaWidth,horizontalBoxHeight),maxChartAreaHeight-=minSize.height):(minSize=box.update(verticalBoxWidth,maxChartAreaHeight),maxChartAreaWidth-=minSize.width),minBoxSizes.push({horizontal:isHorizontal,minSize:minSize,box:box})});var maxHorizontalLeftPadding=0,maxHorizontalRightPadding=0,maxVerticalTopPadding=0,maxVerticalBottomPadding=0;helpers.each(topBoxes.concat(bottomBoxes),function(horizontalBox){if(horizontalBox.getPadding){var boxPadding=horizontalBox.getPadding();maxHorizontalLeftPadding=Math.max(maxHorizontalLeftPadding,boxPadding.left),maxHorizontalRightPadding=Math.max(maxHorizontalRightPadding,boxPadding.right)}}),helpers.each(leftBoxes.concat(rightBoxes),function(verticalBox){if(verticalBox.getPadding){var boxPadding=verticalBox.getPadding();maxVerticalTopPadding=Math.max(maxVerticalTopPadding,boxPadding.top),maxVerticalBottomPadding=Math.max(maxVerticalBottomPadding,boxPadding.bottom)}});var totalLeftBoxesWidth=leftPadding,totalRightBoxesWidth=rightPadding,totalTopBoxesHeight=topPadding,totalBottomBoxesHeight=bottomPadding;helpers.each(leftBoxes.concat(rightBoxes),fitBox),helpers.each(leftBoxes,function(box){totalLeftBoxesWidth+=box.width}),helpers.each(rightBoxes,function(box){totalRightBoxesWidth+=box.width}),helpers.each(topBoxes.concat(bottomBoxes),fitBox),helpers.each(topBoxes,function(box){totalTopBoxesHeight+=box.height}),helpers.each(bottomBoxes,function(box){totalBottomBoxesHeight+=box.height}),helpers.each(leftBoxes.concat(rightBoxes),function(box){var minBoxSize=helpers.findNextWhere(minBoxSizes,function(minSize){return minSize.box===box}),scaleMargin={left:0,right:0,top:totalTopBoxesHeight,bottom:totalBottomBoxesHeight};minBoxSize&&box.update(minBoxSize.minSize.width,maxChartAreaHeight,scaleMargin)}),totalLeftBoxesWidth=leftPadding,totalRightBoxesWidth=rightPadding,totalTopBoxesHeight=topPadding,totalBottomBoxesHeight=bottomPadding,helpers.each(leftBoxes,function(box){totalLeftBoxesWidth+=box.width}),helpers.each(rightBoxes,function(box){totalRightBoxesWidth+=box.width}),helpers.each(topBoxes,function(box){totalTopBoxesHeight+=box.height}),helpers.each(bottomBoxes,function(box){totalBottomBoxesHeight+=box.height});var leftPaddingAddition=Math.max(maxHorizontalLeftPadding-totalLeftBoxesWidth,0);totalLeftBoxesWidth+=leftPaddingAddition,totalRightBoxesWidth+=Math.max(maxHorizontalRightPadding-totalRightBoxesWidth,0);var topPaddingAddition=Math.max(maxVerticalTopPadding-totalTopBoxesHeight,0);totalTopBoxesHeight+=topPaddingAddition,totalBottomBoxesHeight+=Math.max(maxVerticalBottomPadding-totalBottomBoxesHeight,0);var newMaxChartAreaHeight=height-totalTopBoxesHeight-totalBottomBoxesHeight,newMaxChartAreaWidth=width-totalLeftBoxesWidth-totalRightBoxesWidth;newMaxChartAreaWidth===maxChartAreaWidth&&newMaxChartAreaHeight===maxChartAreaHeight||(helpers.each(leftBoxes,function(box){box.height=newMaxChartAreaHeight}),helpers.each(rightBoxes,function(box){box.height=newMaxChartAreaHeight}),helpers.each(topBoxes,function(box){box.fullWidth||(box.width=newMaxChartAreaWidth)}),helpers.each(bottomBoxes,function(box){box.fullWidth||(box.width=newMaxChartAreaWidth)}),maxChartAreaHeight=newMaxChartAreaHeight,maxChartAreaWidth=newMaxChartAreaWidth);var left=leftPadding+leftPaddingAddition,top=topPadding+topPaddingAddition;helpers.each(leftBoxes.concat(topBoxes),placeBox),left+=maxChartAreaWidth,top+=maxChartAreaHeight,helpers.each(rightBoxes,placeBox),helpers.each(bottomBoxes,placeBox),chart.chartArea={left:totalLeftBoxesWidth,top:totalTopBoxesHeight,right:totalLeftBoxesWidth+maxChartAreaWidth,bottom:totalTopBoxesHeight+maxChartAreaHeight},helpers.each(chartAreaBoxes,function(box){box.left=chart.chartArea.left,box.top=chart.chartArea.top,box.right=chart.chartArea.right,box.bottom=chart.chartArea.bottom,box.update(maxChartAreaWidth,maxChartAreaHeight)})}function fitBox(box){var minBoxSize=helpers.findNextWhere(minBoxSizes,function(minBox){return minBox.box===box});if(minBoxSize)if(box.isHorizontal()){var scaleMargin={left:Math.max(totalLeftBoxesWidth,maxHorizontalLeftPadding),right:Math.max(totalRightBoxesWidth,maxHorizontalRightPadding),top:0,bottom:0};box.update(box.fullWidth?chartWidth:maxChartAreaWidth,chartHeight/2,scaleMargin)}else box.update(minBoxSize.minSize.width,maxChartAreaHeight)}function placeBox(box){box.isHorizontal()?(box.left=box.fullWidth?leftPadding:totalLeftBoxesWidth,box.right=box.fullWidth?width-rightPadding:totalLeftBoxesWidth+maxChartAreaWidth,box.top=top,box.bottom=top+box.height,top=box.bottom):(box.left=left,box.right=left+box.width,box.top=totalTopBoxesHeight,box.bottom=totalTopBoxesHeight+maxChartAreaHeight,left=box.right)}}}},"./node_modules/chart.js/src/core/core.plugins.js":function(module,exports,__webpack_require__){"use strict";var defaults=__webpack_require__("./node_modules/chart.js/src/core/core.defaults.js"),helpers=__webpack_require__("./node_modules/chart.js/src/helpers/index.js");defaults._set("global",{plugins:{}}),module.exports={_plugins:[],_cacheId:0,register:function(plugins){var p=this._plugins;[].concat(plugins).forEach(function(plugin){-1===p.indexOf(plugin)&&p.push(plugin)}),this._cacheId++},unregister:function(plugins){var p=this._plugins;[].concat(plugins).forEach(function(plugin){var idx=p.indexOf(plugin);-1!==idx&&p.splice(idx,1)}),this._cacheId++},clear:function(){this._plugins=[],this._cacheId++},count:function(){return this._plugins.length},getAll:function(){return this._plugins},notify:function(chart,hook,args){var i,descriptor,plugin,params,method,descriptors=this.descriptors(chart),ilen=descriptors.length;for(i=0;i<ilen;++i)if("function"==typeof(method=(plugin=(descriptor=descriptors[i]).plugin)[hook])&&((params=[chart].concat(args||[])).push(descriptor.options),!1===method.apply(plugin,params)))return!1;return!0},descriptors:function(chart){var cache=chart.$plugins||(chart.$plugins={});if(cache.id===this._cacheId)return cache.descriptors;var plugins=[],descriptors=[],config=chart&&chart.config||{},options=config.options&&config.options.plugins||{};return this._plugins.concat(config.plugins||[]).forEach(function(plugin){if(-1===plugins.indexOf(plugin)){var id=plugin.id,opts=options[id];!1!==opts&&(!0===opts&&(opts=helpers.clone(defaults.global.plugins[id])),plugins.push(plugin),descriptors.push({plugin:plugin,options:opts||{}}))}}),cache.descriptors=descriptors,cache.id=this._cacheId,descriptors},_invalidate:function(chart){delete chart.$plugins}}},"./node_modules/chart.js/src/core/core.scale.js":function(module,exports,__webpack_require__){"use strict";var defaults=__webpack_require__("./node_modules/chart.js/src/core/core.defaults.js"),Element=__webpack_require__("./node_modules/chart.js/src/core/core.element.js"),helpers=__webpack_require__("./node_modules/chart.js/src/helpers/index.js"),Ticks=__webpack_require__("./node_modules/chart.js/src/core/core.ticks.js");function labelsFromTicks(ticks){var i,ilen,labels=[];for(i=0,ilen=ticks.length;i<ilen;++i)labels.push(ticks[i].label);return labels}function getLineValue(scale,index,offsetGridLines){var lineValue=scale.getPixelForTick(index);return offsetGridLines&&(lineValue-=0===index?(scale.getPixelForTick(1)-lineValue)/2:(lineValue-scale.getPixelForTick(index-1))/2),lineValue}defaults._set("scale",{display:!0,position:"left",offset:!1,gridLines:{display:!0,color:"rgba(0, 0, 0, 0.1)",lineWidth:1,drawBorder:!0,drawOnChartArea:!0,drawTicks:!0,tickMarkLength:10,zeroLineWidth:1,zeroLineColor:"rgba(0,0,0,0.25)",zeroLineBorderDash:[],zeroLineBorderDashOffset:0,offsetGridLines:!1,borderDash:[],borderDashOffset:0},scaleLabel:{display:!1,labelString:"",lineHeight:1.2,padding:{top:4,bottom:4}},ticks:{beginAtZero:!1,minRotation:0,maxRotation:50,mirror:!1,padding:0,reverse:!1,display:!0,autoSkip:!0,autoSkipPadding:0,labelOffset:0,callback:Ticks.formatters.values,minor:{},major:{}}}),module.exports=function(Chart){function computeTextSize(context,tick,font){return helpers.isArray(tick)?helpers.longestText(context,font,tick):context.measureText(tick).width}function parseFontOptions(options){var valueOrDefault=helpers.valueOrDefault,globalDefaults=defaults.global,size=valueOrDefault(options.fontSize,globalDefaults.defaultFontSize),style=valueOrDefault(options.fontStyle,globalDefaults.defaultFontStyle),family=valueOrDefault(options.fontFamily,globalDefaults.defaultFontFamily);return{size:size,style:style,family:family,font:helpers.fontString(size,style,family)}}function parseLineHeight(options){return helpers.options.toLineHeight(helpers.valueOrDefault(options.lineHeight,1.2),helpers.valueOrDefault(options.fontSize,defaults.global.defaultFontSize))}Chart.Scale=Element.extend({getPadding:function(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}},getTicks:function(){return this._ticks},mergeTicksOptions:function(){var ticks=this.options.ticks;for(var key in!1===ticks.minor&&(ticks.minor={display:!1}),!1===ticks.major&&(ticks.major={display:!1}),ticks)"major"!==key&&"minor"!==key&&(void 0===ticks.minor[key]&&(ticks.minor[key]=ticks[key]),void 0===ticks.major[key]&&(ticks.major[key]=ticks[key]))},beforeUpdate:function(){helpers.callback(this.options.beforeUpdate,[this])},update:function(maxWidth,maxHeight,margins){var i,ilen,labels,label,ticks,tick,me=this;for(me.beforeUpdate(),me.maxWidth=maxWidth,me.maxHeight=maxHeight,me.margins=helpers.extend({left:0,right:0,top:0,bottom:0},margins),me.longestTextCache=me.longestTextCache||{},me.beforeSetDimensions(),me.setDimensions(),me.afterSetDimensions(),me.beforeDataLimits(),me.determineDataLimits(),me.afterDataLimits(),me.beforeBuildTicks(),ticks=me.buildTicks()||[],me.afterBuildTicks(),me.beforeTickToLabelConversion(),labels=me.convertTicksToLabels(ticks)||me.ticks,me.afterTickToLabelConversion(),me.ticks=labels,i=0,ilen=labels.length;i<ilen;++i)label=labels[i],(tick=ticks[i])?tick.label=label:ticks.push(tick={label:label,major:!1});return me._ticks=ticks,me.beforeCalculateTickRotation(),me.calculateTickRotation(),me.afterCalculateTickRotation(),me.beforeFit(),me.fit(),me.afterFit(),me.afterUpdate(),me.minSize},afterUpdate:function(){helpers.callback(this.options.afterUpdate,[this])},beforeSetDimensions:function(){helpers.callback(this.options.beforeSetDimensions,[this])},setDimensions:function(){var me=this;me.isHorizontal()?(me.width=me.maxWidth,me.left=0,me.right=me.width):(me.height=me.maxHeight,me.top=0,me.bottom=me.height),me.paddingLeft=0,me.paddingTop=0,me.paddingRight=0,me.paddingBottom=0},afterSetDimensions:function(){helpers.callback(this.options.afterSetDimensions,[this])},beforeDataLimits:function(){helpers.callback(this.options.beforeDataLimits,[this])},determineDataLimits:helpers.noop,afterDataLimits:function(){helpers.callback(this.options.afterDataLimits,[this])},beforeBuildTicks:function(){helpers.callback(this.options.beforeBuildTicks,[this])},buildTicks:helpers.noop,afterBuildTicks:function(){helpers.callback(this.options.afterBuildTicks,[this])},beforeTickToLabelConversion:function(){helpers.callback(this.options.beforeTickToLabelConversion,[this])},convertTicksToLabels:function(){var tickOpts=this.options.ticks;this.ticks=this.ticks.map(tickOpts.userCallback||tickOpts.callback,this)},afterTickToLabelConversion:function(){helpers.callback(this.options.afterTickToLabelConversion,[this])},beforeCalculateTickRotation:function(){helpers.callback(this.options.beforeCalculateTickRotation,[this])},calculateTickRotation:function(){var me=this,context=me.ctx,tickOpts=me.options.ticks,labels=labelsFromTicks(me._ticks),tickFont=parseFontOptions(tickOpts);context.font=tickFont.font;var labelRotation=tickOpts.minRotation||0;if(labels.length&&me.options.display&&me.isHorizontal())for(var cosRotation,originalLabelWidth=helpers.longestText(context,tickFont.font,labels,me.longestTextCache),labelWidth=originalLabelWidth,tickWidth=me.getPixelForTick(1)-me.getPixelForTick(0)-6;labelWidth>tickWidth&&labelRotation<tickOpts.maxRotation;){var angleRadians=helpers.toRadians(labelRotation);if(cosRotation=Math.cos(angleRadians),Math.sin(angleRadians)*originalLabelWidth>me.maxHeight){labelRotation--;break}labelRotation++,labelWidth=cosRotation*originalLabelWidth}me.labelRotation=labelRotation},afterCalculateTickRotation:function(){helpers.callback(this.options.afterCalculateTickRotation,[this])},beforeFit:function(){helpers.callback(this.options.beforeFit,[this])},fit:function(){var me=this,minSize=me.minSize={width:0,height:0},labels=labelsFromTicks(me._ticks),opts=me.options,tickOpts=opts.ticks,scaleLabelOpts=opts.scaleLabel,gridLineOpts=opts.gridLines,display=opts.display,isHorizontal=me.isHorizontal(),tickFont=parseFontOptions(tickOpts),tickMarkLength=opts.gridLines.tickMarkLength;if(minSize.width=isHorizontal?me.isFullWidth()?me.maxWidth-me.margins.left-me.margins.right:me.maxWidth:display&&gridLineOpts.drawTicks?tickMarkLength:0,minSize.height=isHorizontal?display&&gridLineOpts.drawTicks?tickMarkLength:0:me.maxHeight,scaleLabelOpts.display&&display){var deltaHeight=parseLineHeight(scaleLabelOpts)+helpers.options.toPadding(scaleLabelOpts.padding).height;isHorizontal?minSize.height+=deltaHeight:minSize.width+=deltaHeight}if(tickOpts.display&&display){var largestTextWidth=helpers.longestText(me.ctx,tickFont.font,labels,me.longestTextCache),tallestLabelHeightInLines=helpers.numberOfLabelLines(labels),lineSpace=.5*tickFont.size,tickPadding=me.options.ticks.padding;if(isHorizontal){me.longestLabelWidth=largestTextWidth;var angleRadians=helpers.toRadians(me.labelRotation),cosRotation=Math.cos(angleRadians),labelHeight=Math.sin(angleRadians)*largestTextWidth+tickFont.size*tallestLabelHeightInLines+lineSpace*(tallestLabelHeightInLines-1)+lineSpace;minSize.height=Math.min(me.maxHeight,minSize.height+labelHeight+tickPadding),me.ctx.font=tickFont.font;var firstLabelWidth=computeTextSize(me.ctx,labels[0],tickFont.font),lastLabelWidth=computeTextSize(me.ctx,labels[labels.length-1],tickFont.font);0!==me.labelRotation?(me.paddingLeft="bottom"===opts.position?cosRotation*firstLabelWidth+3:cosRotation*lineSpace+3,me.paddingRight="bottom"===opts.position?cosRotation*lineSpace+3:cosRotation*lastLabelWidth+3):(me.paddingLeft=firstLabelWidth/2+3,me.paddingRight=lastLabelWidth/2+3)}else tickOpts.mirror?largestTextWidth=0:largestTextWidth+=tickPadding+lineSpace,minSize.width=Math.min(me.maxWidth,minSize.width+largestTextWidth),me.paddingTop=tickFont.size/2,me.paddingBottom=tickFont.size/2}me.handleMargins(),me.width=minSize.width,me.height=minSize.height},handleMargins:function(){var me=this;me.margins&&(me.paddingLeft=Math.max(me.paddingLeft-me.margins.left,0),me.paddingTop=Math.max(me.paddingTop-me.margins.top,0),me.paddingRight=Math.max(me.paddingRight-me.margins.right,0),me.paddingBottom=Math.max(me.paddingBottom-me.margins.bottom,0))},afterFit:function(){helpers.callback(this.options.afterFit,[this])},isHorizontal:function(){return"top"===this.options.position||"bottom"===this.options.position},isFullWidth:function(){return this.options.fullWidth},getRightValue:function(rawValue){if(helpers.isNullOrUndef(rawValue))return NaN;if("number"==typeof rawValue&&!isFinite(rawValue))return NaN;if(rawValue)if(this.isHorizontal()){if(void 0!==rawValue.x)return this.getRightValue(rawValue.x)}else if(void 0!==rawValue.y)return this.getRightValue(rawValue.y);return rawValue},getLabelForIndex:helpers.noop,getPixelForValue:helpers.noop,getValueForPixel:helpers.noop,getPixelForTick:function(index){var me=this,offset=me.options.offset;if(me.isHorizontal()){var tickWidth=(me.width-(me.paddingLeft+me.paddingRight))/Math.max(me._ticks.length-(offset?0:1),1),pixel=tickWidth*index+me.paddingLeft;offset&&(pixel+=tickWidth/2);var finalVal=me.left+Math.round(pixel);return finalVal+=me.isFullWidth()?me.margins.left:0}var innerHeight=me.height-(me.paddingTop+me.paddingBottom);return me.top+index*(innerHeight/(me._ticks.length-1))},getPixelForDecimal:function(decimal){var me=this;if(me.isHorizontal()){var valueOffset=(me.width-(me.paddingLeft+me.paddingRight))*decimal+me.paddingLeft,finalVal=me.left+Math.round(valueOffset);return finalVal+=me.isFullWidth()?me.margins.left:0}return me.top+decimal*me.height},getBasePixel:function(){return this.getPixelForValue(this.getBaseValue())},getBaseValue:function(){var min=this.min,max=this.max;return this.beginAtZero?0:min<0&&max<0?max:min>0&&max>0?min:0},_autoSkip:function(ticks){var skipRatio,i,tick,maxTicks,me=this,isHorizontal=me.isHorizontal(),optionTicks=me.options.ticks.minor,tickCount=ticks.length,labelRotationRadians=helpers.toRadians(me.labelRotation),cosRotation=Math.cos(labelRotationRadians),longestRotatedLabel=me.longestLabelWidth*cosRotation,result=[];for(optionTicks.maxTicksLimit&&(maxTicks=optionTicks.maxTicksLimit),isHorizontal&&(skipRatio=!1,(longestRotatedLabel+optionTicks.autoSkipPadding)*tickCount>me.width-(me.paddingLeft+me.paddingRight)&&(skipRatio=1+Math.floor((longestRotatedLabel+optionTicks.autoSkipPadding)*tickCount/(me.width-(me.paddingLeft+me.paddingRight)))),maxTicks&&tickCount>maxTicks&&(skipRatio=Math.max(skipRatio,Math.floor(tickCount/maxTicks)))),i=0;i<tickCount;i++)tick=ticks[i],(skipRatio>1&&i%skipRatio>0||i%skipRatio==0&&i+skipRatio>=tickCount)&&i!==tickCount-1&&delete tick.label,result.push(tick);return result},draw:function(chartArea){var me=this,options=me.options;if(options.display){var context=me.ctx,globalDefaults=defaults.global,optionTicks=options.ticks.minor,optionMajorTicks=options.ticks.major||optionTicks,gridLines=options.gridLines,scaleLabel=options.scaleLabel,isRotated=0!==me.labelRotation,isHorizontal=me.isHorizontal(),ticks=optionTicks.autoSkip?me._autoSkip(me.getTicks()):me.getTicks(),tickFontColor=helpers.valueOrDefault(optionTicks.fontColor,globalDefaults.defaultFontColor),tickFont=parseFontOptions(optionTicks),majorTickFontColor=helpers.valueOrDefault(optionMajorTicks.fontColor,globalDefaults.defaultFontColor),majorTickFont=parseFontOptions(optionMajorTicks),tl=gridLines.drawTicks?gridLines.tickMarkLength:0,scaleLabelFontColor=helpers.valueOrDefault(scaleLabel.fontColor,globalDefaults.defaultFontColor),scaleLabelFont=parseFontOptions(scaleLabel),scaleLabelPadding=helpers.options.toPadding(scaleLabel.padding),labelRotationRadians=helpers.toRadians(me.labelRotation),itemsToDraw=[],axisWidth=me.options.gridLines.lineWidth,xTickStart="right"===options.position?me.right:me.right-axisWidth-tl,xTickEnd="right"===options.position?me.right+tl:me.right,yTickStart="bottom"===options.position?me.top+axisWidth:me.bottom-tl-axisWidth,yTickEnd="bottom"===options.position?me.top+axisWidth+tl:me.bottom+axisWidth;if(helpers.each(ticks,function(tick,index){if(!helpers.isNullOrUndef(tick.label)){var lineWidth,lineColor,borderDash,borderDashOffset,tx1,ty1,tx2,ty2,x1,y1,x2,y2,labelX,labelY,label=tick.label;index===me.zeroLineIndex&&options.offset===gridLines.offsetGridLines?(lineWidth=gridLines.zeroLineWidth,lineColor=gridLines.zeroLineColor,borderDash=gridLines.zeroLineBorderDash,borderDashOffset=gridLines.zeroLineBorderDashOffset):(lineWidth=helpers.valueAtIndexOrDefault(gridLines.lineWidth,index),lineColor=helpers.valueAtIndexOrDefault(gridLines.color,index),borderDash=helpers.valueOrDefault(gridLines.borderDash,globalDefaults.borderDash),borderDashOffset=helpers.valueOrDefault(gridLines.borderDashOffset,globalDefaults.borderDashOffset));var textAlign="middle",textBaseline="middle",tickPadding=optionTicks.padding;if(isHorizontal){var labelYOffset=tl+tickPadding;"bottom"===options.position?(textBaseline=isRotated?"middle":"top",textAlign=isRotated?"right":"center",labelY=me.top+labelYOffset):(textBaseline=isRotated?"middle":"bottom",textAlign=isRotated?"left":"center",labelY=me.bottom-labelYOffset);var xLineValue=getLineValue(me,index,gridLines.offsetGridLines&&ticks.length>1);xLineValue<me.left&&(lineColor="rgba(0,0,0,0)"),xLineValue+=helpers.aliasPixel(lineWidth),labelX=me.getPixelForTick(index)+optionTicks.labelOffset,tx1=tx2=x1=x2=xLineValue,ty1=yTickStart,ty2=yTickEnd,y1=chartArea.top,y2=chartArea.bottom+axisWidth}else{var labelXOffset,isLeft="left"===options.position;optionTicks.mirror?(textAlign=isLeft?"left":"right",labelXOffset=tickPadding):(textAlign=isLeft?"right":"left",labelXOffset=tl+tickPadding),labelX=isLeft?me.right-labelXOffset:me.left+labelXOffset;var yLineValue=getLineValue(me,index,gridLines.offsetGridLines&&ticks.length>1);yLineValue<me.top&&(lineColor="rgba(0,0,0,0)"),yLineValue+=helpers.aliasPixel(lineWidth),labelY=me.getPixelForTick(index)+optionTicks.labelOffset,tx1=xTickStart,tx2=xTickEnd,x1=chartArea.left,x2=chartArea.right+axisWidth,ty1=ty2=y1=y2=yLineValue}itemsToDraw.push({tx1:tx1,ty1:ty1,tx2:tx2,ty2:ty2,x1:x1,y1:y1,x2:x2,y2:y2,labelX:labelX,labelY:labelY,glWidth:lineWidth,glColor:lineColor,glBorderDash:borderDash,glBorderDashOffset:borderDashOffset,rotation:-1*labelRotationRadians,label:label,major:tick.major,textBaseline:textBaseline,textAlign:textAlign})}}),helpers.each(itemsToDraw,function(itemToDraw){if(gridLines.display&&(context.save(),context.lineWidth=itemToDraw.glWidth,context.strokeStyle=itemToDraw.glColor,context.setLineDash&&(context.setLineDash(itemToDraw.glBorderDash),context.lineDashOffset=itemToDraw.glBorderDashOffset),context.beginPath(),gridLines.drawTicks&&(context.moveTo(itemToDraw.tx1,itemToDraw.ty1),context.lineTo(itemToDraw.tx2,itemToDraw.ty2)),gridLines.drawOnChartArea&&(context.moveTo(itemToDraw.x1,itemToDraw.y1),context.lineTo(itemToDraw.x2,itemToDraw.y2)),context.stroke(),context.restore()),optionTicks.display){context.save(),context.translate(itemToDraw.labelX,itemToDraw.labelY),context.rotate(itemToDraw.rotation),context.font=itemToDraw.major?majorTickFont.font:tickFont.font,context.fillStyle=itemToDraw.major?majorTickFontColor:tickFontColor,context.textBaseline=itemToDraw.textBaseline,context.textAlign=itemToDraw.textAlign;var label=itemToDraw.label;if(helpers.isArray(label))for(var lineCount=label.length,lineHeight=1.5*tickFont.size,y=me.isHorizontal()?0:-lineHeight*(lineCount-1)/2,i=0;i<lineCount;++i)context.fillText(""+label[i],0,y),y+=lineHeight;else context.fillText(label,0,0);context.restore()}}),scaleLabel.display){var scaleLabelX,scaleLabelY,rotation=0,halfLineHeight=parseLineHeight(scaleLabel)/2;if(isHorizontal)scaleLabelX=me.left+(me.right-me.left)/2,scaleLabelY="bottom"===options.position?me.bottom-halfLineHeight-scaleLabelPadding.bottom:me.top+halfLineHeight+scaleLabelPadding.top;else{var isLeft="left"===options.position;scaleLabelX=isLeft?me.left+halfLineHeight+scaleLabelPadding.top:me.right-halfLineHeight-scaleLabelPadding.top,scaleLabelY=me.top+(me.bottom-me.top)/2,rotation=isLeft?-.5*Math.PI:.5*Math.PI}context.save(),context.translate(scaleLabelX,scaleLabelY),context.rotate(rotation),context.textAlign="center",context.textBaseline="middle",context.fillStyle=scaleLabelFontColor,context.font=scaleLabelFont.font,context.fillText(scaleLabel.labelString,0,0),context.restore()}if(gridLines.drawBorder){context.lineWidth=helpers.valueAtIndexOrDefault(gridLines.lineWidth,0),context.strokeStyle=helpers.valueAtIndexOrDefault(gridLines.color,0);var x1=me.left,x2=me.right+axisWidth,y1=me.top,y2=me.bottom+axisWidth,aliasPixel=helpers.aliasPixel(context.lineWidth);isHorizontal?(y1=y2="top"===options.position?me.bottom:me.top,y1+=aliasPixel,y2+=aliasPixel):(x1=x2="left"===options.position?me.right:me.left,x1+=aliasPixel,x2+=aliasPixel),context.beginPath(),context.moveTo(x1,y1),context.lineTo(x2,y2),context.stroke()}}}})}},"./node_modules/chart.js/src/core/core.scaleService.js":function(module,exports,__webpack_require__){"use strict";var defaults=__webpack_require__("./node_modules/chart.js/src/core/core.defaults.js"),helpers=__webpack_require__("./node_modules/chart.js/src/helpers/index.js"),layouts=__webpack_require__("./node_modules/chart.js/src/core/core.layouts.js");module.exports=function(Chart){Chart.scaleService={constructors:{},defaults:{},registerScaleType:function(type,scaleConstructor,scaleDefaults){this.constructors[type]=scaleConstructor,this.defaults[type]=helpers.clone(scaleDefaults)},getScaleConstructor:function(type){return this.constructors.hasOwnProperty(type)?this.constructors[type]:void 0},getScaleDefaults:function(type){return this.defaults.hasOwnProperty(type)?helpers.merge({},[defaults.scale,this.defaults[type]]):{}},updateScaleDefaults:function(type,additions){this.defaults.hasOwnProperty(type)&&(this.defaults[type]=helpers.extend(this.defaults[type],additions))},addScalesToLayout:function(chart){helpers.each(chart.scales,function(scale){scale.fullWidth=scale.options.fullWidth,scale.position=scale.options.position,scale.weight=scale.options.weight,layouts.addBox(chart,scale)})}}}},"./node_modules/chart.js/src/core/core.ticks.js":function(module,exports,__webpack_require__){"use strict";var helpers=__webpack_require__("./node_modules/chart.js/src/helpers/index.js");module.exports={formatters:{values:function(value){return helpers.isArray(value)?value:""+value},linear:function(tickValue,index,ticks){var delta=ticks.length>3?ticks[2]-ticks[1]:ticks[1]-ticks[0];Math.abs(delta)>1&&tickValue!==Math.floor(tickValue)&&(delta=tickValue-Math.floor(tickValue));var logDelta=helpers.log10(Math.abs(delta)),tickString="";if(0!==tickValue){var numDecimal=-1*Math.floor(logDelta);numDecimal=Math.max(Math.min(numDecimal,20),0),tickString=tickValue.toFixed(numDecimal)}else tickString="0";return tickString},logarithmic:function(tickValue,index,ticks){var remain=tickValue/Math.pow(10,Math.floor(helpers.log10(tickValue)));return 0===tickValue?"0":1===remain||2===remain||5===remain||0===index||index===ticks.length-1?tickValue.toExponential():""}}}},"./node_modules/chart.js/src/core/core.tooltip.js":function(module,exports,__webpack_require__){"use strict";var defaults=__webpack_require__("./node_modules/chart.js/src/core/core.defaults.js"),Element=__webpack_require__("./node_modules/chart.js/src/core/core.element.js"),helpers=__webpack_require__("./node_modules/chart.js/src/helpers/index.js");defaults._set("global",{tooltips:{enabled:!0,custom:null,mode:"nearest",position:"average",intersect:!0,backgroundColor:"rgba(0,0,0,0.8)",titleFontStyle:"bold",titleSpacing:2,titleMarginBottom:6,titleFontColor:"#fff",titleAlign:"left",bodySpacing:2,bodyFontColor:"#fff",bodyAlign:"left",footerFontStyle:"bold",footerSpacing:2,footerMarginTop:6,footerFontColor:"#fff",footerAlign:"left",yPadding:6,xPadding:6,caretPadding:2,caretSize:5,cornerRadius:6,multiKeyBackground:"#fff",displayColors:!0,borderColor:"rgba(0,0,0,0)",borderWidth:0,callbacks:{beforeTitle:helpers.noop,title:function(tooltipItems,data){var title="",labels=data.labels,labelCount=labels?labels.length:0;if(tooltipItems.length>0){var item=tooltipItems[0];item.xLabel?title=item.xLabel:labelCount>0&&item.index<labelCount&&(title=labels[item.index])}return title},afterTitle:helpers.noop,beforeBody:helpers.noop,beforeLabel:helpers.noop,label:function(tooltipItem,data){var label=data.datasets[tooltipItem.datasetIndex].label||"";return label&&(label+=": "),label+=tooltipItem.yLabel},labelColor:function(tooltipItem,chart){var view=chart.getDatasetMeta(tooltipItem.datasetIndex).data[tooltipItem.index]._view;return{borderColor:view.borderColor,backgroundColor:view.backgroundColor}},labelTextColor:function(){return this._options.bodyFontColor},afterLabel:helpers.noop,afterBody:helpers.noop,beforeFooter:helpers.noop,footer:helpers.noop,afterFooter:helpers.noop}}}),module.exports=function(Chart){function mergeOpacity(colorString,opacity){var color=helpers.color(colorString);return color.alpha(opacity*color.alpha()).rgbaString()}function pushOrConcat(base,toPush){return toPush&&(helpers.isArray(toPush)?Array.prototype.push.apply(base,toPush):base.push(toPush)),base}function getBaseModel(tooltipOpts){var globalDefaults=defaults.global,valueOrDefault=helpers.valueOrDefault;return{xPadding:tooltipOpts.xPadding,yPadding:tooltipOpts.yPadding,xAlign:tooltipOpts.xAlign,yAlign:tooltipOpts.yAlign,bodyFontColor:tooltipOpts.bodyFontColor,_bodyFontFamily:valueOrDefault(tooltipOpts.bodyFontFamily,globalDefaults.defaultFontFamily),_bodyFontStyle:valueOrDefault(tooltipOpts.bodyFontStyle,globalDefaults.defaultFontStyle),_bodyAlign:tooltipOpts.bodyAlign,bodyFontSize:valueOrDefault(tooltipOpts.bodyFontSize,globalDefaults.defaultFontSize),bodySpacing:tooltipOpts.bodySpacing,titleFontColor:tooltipOpts.titleFontColor,_titleFontFamily:valueOrDefault(tooltipOpts.titleFontFamily,globalDefaults.defaultFontFamily),_titleFontStyle:valueOrDefault(tooltipOpts.titleFontStyle,globalDefaults.defaultFontStyle),titleFontSize:valueOrDefault(tooltipOpts.titleFontSize,globalDefaults.defaultFontSize),_titleAlign:tooltipOpts.titleAlign,titleSpacing:tooltipOpts.titleSpacing,titleMarginBottom:tooltipOpts.titleMarginBottom,footerFontColor:tooltipOpts.footerFontColor,_footerFontFamily:valueOrDefault(tooltipOpts.footerFontFamily,globalDefaults.defaultFontFamily),_footerFontStyle:valueOrDefault(tooltipOpts.footerFontStyle,globalDefaults.defaultFontStyle),footerFontSize:valueOrDefault(tooltipOpts.footerFontSize,globalDefaults.defaultFontSize),_footerAlign:tooltipOpts.footerAlign,footerSpacing:tooltipOpts.footerSpacing,footerMarginTop:tooltipOpts.footerMarginTop,caretSize:tooltipOpts.caretSize,cornerRadius:tooltipOpts.cornerRadius,backgroundColor:tooltipOpts.backgroundColor,opacity:0,legendColorBackground:tooltipOpts.multiKeyBackground,displayColors:tooltipOpts.displayColors,borderColor:tooltipOpts.borderColor,borderWidth:tooltipOpts.borderWidth}}Chart.Tooltip=Element.extend({initialize:function(){this._model=getBaseModel(this._options),this._lastActive=[]},getTitle:function(){var callbacks=this._options.callbacks,beforeTitle=callbacks.beforeTitle.apply(this,arguments),title=callbacks.title.apply(this,arguments),afterTitle=callbacks.afterTitle.apply(this,arguments),lines=[];return lines=pushOrConcat(lines=pushOrConcat(lines=pushOrConcat(lines,beforeTitle),title),afterTitle)},getBeforeBody:function(){var lines=this._options.callbacks.beforeBody.apply(this,arguments);return helpers.isArray(lines)?lines:void 0!==lines?[lines]:[]},getBody:function(tooltipItems,data){var me=this,callbacks=me._options.callbacks,bodyItems=[];return helpers.each(tooltipItems,function(tooltipItem){var bodyItem={before:[],lines:[],after:[]};pushOrConcat(bodyItem.before,callbacks.beforeLabel.call(me,tooltipItem,data)),pushOrConcat(bodyItem.lines,callbacks.label.call(me,tooltipItem,data)),pushOrConcat(bodyItem.after,callbacks.afterLabel.call(me,tooltipItem,data)),bodyItems.push(bodyItem)}),bodyItems},getAfterBody:function(){var lines=this._options.callbacks.afterBody.apply(this,arguments);return helpers.isArray(lines)?lines:void 0!==lines?[lines]:[]},getFooter:function(){var callbacks=this._options.callbacks,beforeFooter=callbacks.beforeFooter.apply(this,arguments),footer=callbacks.footer.apply(this,arguments),afterFooter=callbacks.afterFooter.apply(this,arguments),lines=[];return lines=pushOrConcat(lines=pushOrConcat(lines=pushOrConcat(lines,beforeFooter),footer),afterFooter)},update:function(changed){var i,len,element,xScale,yScale,index,datasetIndex,me=this,opts=me._options,existingModel=me._model,model=me._model=getBaseModel(opts),active=me._active,data=me._data,alignment={xAlign:existingModel.xAlign,yAlign:existingModel.yAlign},backgroundPoint={x:existingModel.x,y:existingModel.y},tooltipSize={width:existingModel.width,height:existingModel.height},tooltipPosition={x:existingModel.caretX,y:existingModel.caretY};if(active.length){model.opacity=1;var labelColors=[],labelTextColors=[];tooltipPosition=Chart.Tooltip.positioners[opts.position].call(me,active,me._eventPosition);var tooltipItems=[];for(i=0,len=active.length;i<len;++i)tooltipItems.push((element=active[i],xScale=void 0,yScale=void 0,void 0,void 0,xScale=element._xScale,yScale=element._yScale||element._scale,index=element._index,datasetIndex=element._datasetIndex,{xLabel:xScale?xScale.getLabelForIndex(index,datasetIndex):"",yLabel:yScale?yScale.getLabelForIndex(index,datasetIndex):"",index:index,datasetIndex:datasetIndex,x:element._model.x,y:element._model.y}));opts.filter&&(tooltipItems=tooltipItems.filter(function(a){return opts.filter(a,data)})),opts.itemSort&&(tooltipItems=tooltipItems.sort(function(a,b){return opts.itemSort(a,b,data)})),helpers.each(tooltipItems,function(tooltipItem){labelColors.push(opts.callbacks.labelColor.call(me,tooltipItem,me._chart)),labelTextColors.push(opts.callbacks.labelTextColor.call(me,tooltipItem,me._chart))}),model.title=me.getTitle(tooltipItems,data),model.beforeBody=me.getBeforeBody(tooltipItems,data),model.body=me.getBody(tooltipItems,data),model.afterBody=me.getAfterBody(tooltipItems,data),model.footer=me.getFooter(tooltipItems,data),model.x=Math.round(tooltipPosition.x),model.y=Math.round(tooltipPosition.y),model.caretPadding=opts.caretPadding,model.labelColors=labelColors,model.labelTextColors=labelTextColors,model.dataPoints=tooltipItems,backgroundPoint=function(vm,size,alignment,chart){var x=vm.x,y=vm.y,caretSize=vm.caretSize,caretPadding=vm.caretPadding,cornerRadius=vm.cornerRadius,xAlign=alignment.xAlign,yAlign=alignment.yAlign,paddingAndSize=caretSize+caretPadding,radiusAndPadding=cornerRadius+caretPadding;return"right"===xAlign?x-=size.width:"center"===xAlign&&((x-=size.width/2)+size.width>chart.width&&(x=chart.width-size.width),x<0&&(x=0)),"top"===yAlign?y+=paddingAndSize:y-="bottom"===yAlign?size.height+paddingAndSize:size.height/2,"center"===yAlign?"left"===xAlign?x+=paddingAndSize:"right"===xAlign&&(x-=paddingAndSize):"left"===xAlign?x-=radiusAndPadding:"right"===xAlign&&(x+=radiusAndPadding),{x:x,y:y}}(model,tooltipSize=function(tooltip,model){var ctx=tooltip._chart.ctx,height=2*model.yPadding,width=0,body=model.body,combinedBodyLength=body.reduce(function(count,bodyItem){return count+bodyItem.before.length+bodyItem.lines.length+bodyItem.after.length},0);combinedBodyLength+=model.beforeBody.length+model.afterBody.length;var titleLineCount=model.title.length,footerLineCount=model.footer.length,titleFontSize=model.titleFontSize,bodyFontSize=model.bodyFontSize,footerFontSize=model.footerFontSize;height+=titleLineCount*titleFontSize,height+=titleLineCount?(titleLineCount-1)*model.titleSpacing:0,height+=titleLineCount?model.titleMarginBottom:0,height+=combinedBodyLength*bodyFontSize,height+=combinedBodyLength?(combinedBodyLength-1)*model.bodySpacing:0,height+=footerLineCount?model.footerMarginTop:0,height+=footerLineCount*footerFontSize,height+=footerLineCount?(footerLineCount-1)*model.footerSpacing:0;var widthPadding=0,maxLineWidth=function(line){width=Math.max(width,ctx.measureText(line).width+widthPadding)};return ctx.font=helpers.fontString(titleFontSize,model._titleFontStyle,model._titleFontFamily),helpers.each(model.title,maxLineWidth),ctx.font=helpers.fontString(bodyFontSize,model._bodyFontStyle,model._bodyFontFamily),helpers.each(model.beforeBody.concat(model.afterBody),maxLineWidth),widthPadding=model.displayColors?bodyFontSize+2:0,helpers.each(body,function(bodyItem){helpers.each(bodyItem.before,maxLineWidth),helpers.each(bodyItem.lines,maxLineWidth),helpers.each(bodyItem.after,maxLineWidth)}),widthPadding=0,ctx.font=helpers.fontString(footerFontSize,model._footerFontStyle,model._footerFontFamily),helpers.each(model.footer,maxLineWidth),{width:width+=2*model.xPadding,height:height}}(this,model),alignment=function(tooltip,size){var lf,rf,olf,orf,yf,model=tooltip._model,chart=tooltip._chart,chartArea=tooltip._chart.chartArea,xAlign="center",yAlign="center";model.y<size.height?yAlign="top":model.y>chart.height-size.height&&(yAlign="bottom");var midX=(chartArea.left+chartArea.right)/2,midY=(chartArea.top+chartArea.bottom)/2;"center"===yAlign?(lf=function(x){return x<=midX},rf=function(x){return x>midX}):(lf=function(x){return x<=size.width/2},rf=function(x){return x>=chart.width-size.width/2}),olf=function(x){return x+size.width+model.caretSize+model.caretPadding>chart.width},orf=function(x){return x-size.width-model.caretSize-model.caretPadding<0},yf=function(y){return y<=midY?"top":"bottom"},lf(model.x)?(xAlign="left",olf(model.x)&&(xAlign="center",yAlign=yf(model.y))):rf(model.x)&&(xAlign="right",orf(model.x)&&(xAlign="center",yAlign=yf(model.y)));var opts=tooltip._options;return{xAlign:opts.xAlign?opts.xAlign:xAlign,yAlign:opts.yAlign?opts.yAlign:yAlign}}(this,tooltipSize),me._chart)}else model.opacity=0;return model.xAlign=alignment.xAlign,model.yAlign=alignment.yAlign,model.x=backgroundPoint.x,model.y=backgroundPoint.y,model.width=tooltipSize.width,model.height=tooltipSize.height,model.caretX=tooltipPosition.x,model.caretY=tooltipPosition.y,me._model=model,changed&&opts.custom&&opts.custom.call(me,model),me},drawCaret:function(tooltipPoint,size){var ctx=this._chart.ctx,vm=this._view,caretPosition=this.getCaretPosition(tooltipPoint,size,vm);ctx.lineTo(caretPosition.x1,caretPosition.y1),ctx.lineTo(caretPosition.x2,caretPosition.y2),ctx.lineTo(caretPosition.x3,caretPosition.y3)},getCaretPosition:function(tooltipPoint,size,vm){var x1,x2,x3,y1,y2,y3,caretSize=vm.caretSize,cornerRadius=vm.cornerRadius,xAlign=vm.xAlign,yAlign=vm.yAlign,ptX=tooltipPoint.x,ptY=tooltipPoint.y,width=size.width,height=size.height;if("center"===yAlign)y2=ptY+height/2,"left"===xAlign?(x2=(x1=ptX)-caretSize,x3=x1,y1=y2+caretSize,y3=y2-caretSize):(x2=(x1=ptX+width)+caretSize,x3=x1,y1=y2-caretSize,y3=y2+caretSize);else if("left"===xAlign?(x1=(x2=ptX+cornerRadius+caretSize)-caretSize,x3=x2+caretSize):"right"===xAlign?(x1=(x2=ptX+width-cornerRadius-caretSize)-caretSize,x3=x2+caretSize):(x1=(x2=vm.caretX)-caretSize,x3=x2+caretSize),"top"===yAlign)y2=(y1=ptY)-caretSize,y3=y1;else{y2=(y1=ptY+height)+caretSize,y3=y1;var tmp=x3;x3=x1,x1=tmp}return{x1:x1,x2:x2,x3:x3,y1:y1,y2:y2,y3:y3}},drawTitle:function(pt,vm,ctx,opacity){var title=vm.title;if(title.length){ctx.textAlign=vm._titleAlign,ctx.textBaseline="top";var i,len,titleFontSize=vm.titleFontSize,titleSpacing=vm.titleSpacing;for(ctx.fillStyle=mergeOpacity(vm.titleFontColor,opacity),ctx.font=helpers.fontString(titleFontSize,vm._titleFontStyle,vm._titleFontFamily),i=0,len=title.length;i<len;++i)ctx.fillText(title[i],pt.x,pt.y),pt.y+=titleFontSize+titleSpacing,i+1===title.length&&(pt.y+=vm.titleMarginBottom-titleSpacing)}},drawBody:function(pt,vm,ctx,opacity){var bodyFontSize=vm.bodyFontSize,bodySpacing=vm.bodySpacing,body=vm.body;ctx.textAlign=vm._bodyAlign,ctx.textBaseline="top",ctx.font=helpers.fontString(bodyFontSize,vm._bodyFontStyle,vm._bodyFontFamily);var xLinePadding=0,fillLineOfText=function(line){ctx.fillText(line,pt.x+xLinePadding,pt.y),pt.y+=bodyFontSize+bodySpacing};ctx.fillStyle=mergeOpacity(vm.bodyFontColor,opacity),helpers.each(vm.beforeBody,fillLineOfText);var drawColorBoxes=vm.displayColors;xLinePadding=drawColorBoxes?bodyFontSize+2:0,helpers.each(body,function(bodyItem,i){var textColor=mergeOpacity(vm.labelTextColors[i],opacity);ctx.fillStyle=textColor,helpers.each(bodyItem.before,fillLineOfText),helpers.each(bodyItem.lines,function(line){drawColorBoxes&&(ctx.fillStyle=mergeOpacity(vm.legendColorBackground,opacity),ctx.fillRect(pt.x,pt.y,bodyFontSize,bodyFontSize),ctx.lineWidth=1,ctx.strokeStyle=mergeOpacity(vm.labelColors[i].borderColor,opacity),ctx.strokeRect(pt.x,pt.y,bodyFontSize,bodyFontSize),ctx.fillStyle=mergeOpacity(vm.labelColors[i].backgroundColor,opacity),ctx.fillRect(pt.x+1,pt.y+1,bodyFontSize-2,bodyFontSize-2),ctx.fillStyle=textColor),fillLineOfText(line)}),helpers.each(bodyItem.after,fillLineOfText)}),xLinePadding=0,helpers.each(vm.afterBody,fillLineOfText),pt.y-=bodySpacing},drawFooter:function(pt,vm,ctx,opacity){var footer=vm.footer;footer.length&&(pt.y+=vm.footerMarginTop,ctx.textAlign=vm._footerAlign,ctx.textBaseline="top",ctx.fillStyle=mergeOpacity(vm.footerFontColor,opacity),ctx.font=helpers.fontString(vm.footerFontSize,vm._footerFontStyle,vm._footerFontFamily),helpers.each(footer,function(line){ctx.fillText(line,pt.x,pt.y),pt.y+=vm.footerFontSize+vm.footerSpacing}))},drawBackground:function(pt,vm,ctx,tooltipSize,opacity){ctx.fillStyle=mergeOpacity(vm.backgroundColor,opacity),ctx.strokeStyle=mergeOpacity(vm.borderColor,opacity),ctx.lineWidth=vm.borderWidth;var xAlign=vm.xAlign,yAlign=vm.yAlign,x=pt.x,y=pt.y,width=tooltipSize.width,height=tooltipSize.height,radius=vm.cornerRadius;ctx.beginPath(),ctx.moveTo(x+radius,y),"top"===yAlign&&this.drawCaret(pt,tooltipSize),ctx.lineTo(x+width-radius,y),ctx.quadraticCurveTo(x+width,y,x+width,y+radius),"center"===yAlign&&"right"===xAlign&&this.drawCaret(pt,tooltipSize),ctx.lineTo(x+width,y+height-radius),ctx.quadraticCurveTo(x+width,y+height,x+width-radius,y+height),"bottom"===yAlign&&this.drawCaret(pt,tooltipSize),ctx.lineTo(x+radius,y+height),ctx.quadraticCurveTo(x,y+height,x,y+height-radius),"center"===yAlign&&"left"===xAlign&&this.drawCaret(pt,tooltipSize),ctx.lineTo(x,y+radius),ctx.quadraticCurveTo(x,y,x+radius,y),ctx.closePath(),ctx.fill(),vm.borderWidth>0&&ctx.stroke()},draw:function(){var ctx=this._chart.ctx,vm=this._view;if(0!==vm.opacity){var tooltipSize={width:vm.width,height:vm.height},pt={x:vm.x,y:vm.y},opacity=Math.abs(vm.opacity<.001)?0:vm.opacity,hasTooltipContent=vm.title.length||vm.beforeBody.length||vm.body.length||vm.afterBody.length||vm.footer.length;this._options.enabled&&hasTooltipContent&&(this.drawBackground(pt,vm,ctx,tooltipSize,opacity),pt.x+=vm.xPadding,pt.y+=vm.yPadding,this.drawTitle(pt,vm,ctx,opacity),this.drawBody(pt,vm,ctx,opacity),this.drawFooter(pt,vm,ctx,opacity))}},handleEvent:function(e){var changed,me=this,options=me._options;return me._lastActive=me._lastActive||[],"mouseout"===e.type?me._active=[]:me._active=me._chart.getElementsAtEventForMode(e,options.mode,options),(changed=!helpers.arrayEquals(me._active,me._lastActive))&&(me._lastActive=me._active,(options.enabled||options.custom)&&(me._eventPosition={x:e.x,y:e.y},me.update(!0),me.pivot())),changed}}),Chart.Tooltip.positioners={average:function(elements){if(!elements.length)return!1;var i,len,x=0,y=0,count=0;for(i=0,len=elements.length;i<len;++i){var el=elements[i];if(el&&el.hasValue()){var pos=el.tooltipPosition();x+=pos.x,y+=pos.y,++count}}return{x:Math.round(x/count),y:Math.round(y/count)}},nearest:function(elements,eventPosition){var i,len,nearestElement,x=eventPosition.x,y=eventPosition.y,minDistance=Number.POSITIVE_INFINITY;for(i=0,len=elements.length;i<len;++i){var el=elements[i];if(el&&el.hasValue()){var center=el.getCenterPoint(),d=helpers.distanceBetweenPoints(eventPosition,center);d<minDistance&&(minDistance=d,nearestElement=el)}}if(nearestElement){var tp=nearestElement.tooltipPosition();x=tp.x,y=tp.y}return{x:x,y:y}}}}},"./node_modules/chart.js/src/elements/element.arc.js":function(module,exports,__webpack_require__){"use strict";var defaults=__webpack_require__("./node_modules/chart.js/src/core/core.defaults.js"),Element=__webpack_require__("./node_modules/chart.js/src/core/core.element.js"),helpers=__webpack_require__("./node_modules/chart.js/src/helpers/index.js");defaults._set("global",{elements:{arc:{backgroundColor:defaults.global.defaultColor,borderColor:"#fff",borderWidth:2}}}),module.exports=Element.extend({inLabelRange:function(mouseX){var vm=this._view;return!!vm&&Math.pow(mouseX-vm.x,2)<Math.pow(vm.radius+vm.hoverRadius,2)},inRange:function(chartX,chartY){var vm=this._view;if(vm){for(var pointRelativePosition=helpers.getAngleFromPoint(vm,{x:chartX,y:chartY}),angle=pointRelativePosition.angle,distance=pointRelativePosition.distance,startAngle=vm.startAngle,endAngle=vm.endAngle;endAngle<startAngle;)endAngle+=2*Math.PI;for(;angle>endAngle;)angle-=2*Math.PI;for(;angle<startAngle;)angle+=2*Math.PI;var betweenAngles=angle>=startAngle&&angle<=endAngle,withinRadius=distance>=vm.innerRadius&&distance<=vm.outerRadius;return betweenAngles&&withinRadius}return!1},getCenterPoint:function(){var vm=this._view,halfAngle=(vm.startAngle+vm.endAngle)/2,halfRadius=(vm.innerRadius+vm.outerRadius)/2;return{x:vm.x+Math.cos(halfAngle)*halfRadius,y:vm.y+Math.sin(halfAngle)*halfRadius}},getArea:function(){var vm=this._view;return Math.PI*((vm.endAngle-vm.startAngle)/(2*Math.PI))*(Math.pow(vm.outerRadius,2)-Math.pow(vm.innerRadius,2))},tooltipPosition:function(){var vm=this._view,centreAngle=vm.startAngle+(vm.endAngle-vm.startAngle)/2,rangeFromCentre=(vm.outerRadius-vm.innerRadius)/2+vm.innerRadius;return{x:vm.x+Math.cos(centreAngle)*rangeFromCentre,y:vm.y+Math.sin(centreAngle)*rangeFromCentre}},draw:function(){var ctx=this._chart.ctx,vm=this._view,sA=vm.startAngle,eA=vm.endAngle;ctx.beginPath(),ctx.arc(vm.x,vm.y,vm.outerRadius,sA,eA),ctx.arc(vm.x,vm.y,vm.innerRadius,eA,sA,!0),ctx.closePath(),ctx.strokeStyle=vm.borderColor,ctx.lineWidth=vm.borderWidth,ctx.fillStyle=vm.backgroundColor,ctx.fill(),ctx.lineJoin="bevel",vm.borderWidth&&ctx.stroke()}})},"./node_modules/chart.js/src/elements/element.line.js":function(module,exports,__webpack_require__){"use strict";var defaults=__webpack_require__("./node_modules/chart.js/src/core/core.defaults.js"),Element=__webpack_require__("./node_modules/chart.js/src/core/core.element.js"),helpers=__webpack_require__("./node_modules/chart.js/src/helpers/index.js"),globalDefaults=defaults.global;defaults._set("global",{elements:{line:{tension:.4,backgroundColor:globalDefaults.defaultColor,borderWidth:3,borderColor:globalDefaults.defaultColor,borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",capBezierPoints:!0,fill:!0}}}),module.exports=Element.extend({draw:function(){var index,current,previous,currentVM,vm=this._view,ctx=this._chart.ctx,spanGaps=vm.spanGaps,points=this._children.slice(),globalOptionLineElements=globalDefaults.elements.line,lastDrawnIndex=-1;for(this._loop&&points.length&&points.push(points[0]),ctx.save(),ctx.lineCap=vm.borderCapStyle||globalOptionLineElements.borderCapStyle,ctx.setLineDash&&ctx.setLineDash(vm.borderDash||globalOptionLineElements.borderDash),ctx.lineDashOffset=vm.borderDashOffset||globalOptionLineElements.borderDashOffset,ctx.lineJoin=vm.borderJoinStyle||globalOptionLineElements.borderJoinStyle,ctx.lineWidth=vm.borderWidth||globalOptionLineElements.borderWidth,ctx.strokeStyle=vm.borderColor||globalDefaults.defaultColor,ctx.beginPath(),lastDrawnIndex=-1,index=0;index<points.length;++index)current=points[index],previous=helpers.previousItem(points,index),currentVM=current._view,0===index?currentVM.skip||(ctx.moveTo(currentVM.x,currentVM.y),lastDrawnIndex=index):(previous=-1===lastDrawnIndex?previous:points[lastDrawnIndex],currentVM.skip||(lastDrawnIndex!==index-1&&!spanGaps||-1===lastDrawnIndex?ctx.moveTo(currentVM.x,currentVM.y):helpers.canvas.lineTo(ctx,previous._view,current._view),lastDrawnIndex=index));ctx.stroke(),ctx.restore()}})},"./node_modules/chart.js/src/elements/element.point.js":function(module,exports,__webpack_require__){"use strict";var defaults=__webpack_require__("./node_modules/chart.js/src/core/core.defaults.js"),Element=__webpack_require__("./node_modules/chart.js/src/core/core.element.js"),helpers=__webpack_require__("./node_modules/chart.js/src/helpers/index.js"),defaultColor=defaults.global.defaultColor;function xRange(mouseX){var vm=this._view;return!!vm&&Math.abs(mouseX-vm.x)<vm.radius+vm.hitRadius}defaults._set("global",{elements:{point:{radius:3,pointStyle:"circle",backgroundColor:defaultColor,borderColor:defaultColor,borderWidth:1,hitRadius:1,hoverRadius:4,hoverBorderWidth:1}}}),module.exports=Element.extend({inRange:function(mouseX,mouseY){var vm=this._view;return!!vm&&Math.pow(mouseX-vm.x,2)+Math.pow(mouseY-vm.y,2)<Math.pow(vm.hitRadius+vm.radius,2)},inLabelRange:xRange,inXRange:xRange,inYRange:function(mouseY){var vm=this._view;return!!vm&&Math.abs(mouseY-vm.y)<vm.radius+vm.hitRadius},getCenterPoint:function(){var vm=this._view;return{x:vm.x,y:vm.y}},getArea:function(){return Math.PI*Math.pow(this._view.radius,2)},tooltipPosition:function(){var vm=this._view;return{x:vm.x,y:vm.y,padding:vm.radius+vm.borderWidth}},draw:function(chartArea){var vm=this._view,model=this._model,ctx=this._chart.ctx,pointStyle=vm.pointStyle,radius=vm.radius,x=vm.x,y=vm.y,color=helpers.color,ratio=0;vm.skip||(ctx.strokeStyle=vm.borderColor||defaultColor,ctx.lineWidth=helpers.valueOrDefault(vm.borderWidth,defaults.global.elements.point.borderWidth),ctx.fillStyle=vm.backgroundColor||defaultColor,void 0!==chartArea&&(model.x<chartArea.left||1.01*chartArea.right<model.x||model.y<chartArea.top||1.01*chartArea.bottom<model.y)&&(model.x<chartArea.left?ratio=(x-model.x)/(chartArea.left-model.x):1.01*chartArea.right<model.x?ratio=(model.x-x)/(model.x-chartArea.right):model.y<chartArea.top?ratio=(y-model.y)/(chartArea.top-model.y):1.01*chartArea.bottom<model.y&&(ratio=(model.y-y)/(model.y-chartArea.bottom)),ratio=Math.round(100*ratio)/100,ctx.strokeStyle=color(ctx.strokeStyle).alpha(ratio).rgbString(),ctx.fillStyle=color(ctx.fillStyle).alpha(ratio).rgbString()),helpers.canvas.drawPoint(ctx,pointStyle,radius,x,y))}})},"./node_modules/chart.js/src/elements/element.rectangle.js":function(module,exports,__webpack_require__){"use strict";var defaults=__webpack_require__("./node_modules/chart.js/src/core/core.defaults.js"),Element=__webpack_require__("./node_modules/chart.js/src/core/core.element.js");function isVertical(bar){return void 0!==bar._view.width}function getBarBounds(bar){var x1,x2,y1,y2,vm=bar._view;if(isVertical(bar)){var halfWidth=vm.width/2;x1=vm.x-halfWidth,x2=vm.x+halfWidth,y1=Math.min(vm.y,vm.base),y2=Math.max(vm.y,vm.base)}else{var halfHeight=vm.height/2;x1=Math.min(vm.x,vm.base),x2=Math.max(vm.x,vm.base),y1=vm.y-halfHeight,y2=vm.y+halfHeight}return{left:x1,top:y1,right:x2,bottom:y2}}defaults._set("global",{elements:{rectangle:{backgroundColor:defaults.global.defaultColor,borderColor:defaults.global.defaultColor,borderSkipped:"bottom",borderWidth:0}}}),module.exports=Element.extend({draw:function(){var left,right,top,bottom,signX,signY,borderSkipped,ctx=this._chart.ctx,vm=this._view,borderWidth=vm.borderWidth;if(vm.horizontal?(left=vm.base,right=vm.x,top=vm.y-vm.height/2,bottom=vm.y+vm.height/2,signX=right>left?1:-1,signY=1,borderSkipped=vm.borderSkipped||"left"):(left=vm.x-vm.width/2,right=vm.x+vm.width/2,top=vm.y,signX=1,signY=(bottom=vm.base)>top?1:-1,borderSkipped=vm.borderSkipped||"bottom"),borderWidth){var barSize=Math.min(Math.abs(left-right),Math.abs(top-bottom)),halfStroke=(borderWidth=borderWidth>barSize?barSize:borderWidth)/2,borderLeft=left+("left"!==borderSkipped?halfStroke*signX:0),borderRight=right+("right"!==borderSkipped?-halfStroke*signX:0),borderTop=top+("top"!==borderSkipped?halfStroke*signY:0),borderBottom=bottom+("bottom"!==borderSkipped?-halfStroke*signY:0);borderLeft!==borderRight&&(top=borderTop,bottom=borderBottom),borderTop!==borderBottom&&(left=borderLeft,right=borderRight)}ctx.beginPath(),ctx.fillStyle=vm.backgroundColor,ctx.strokeStyle=vm.borderColor,ctx.lineWidth=borderWidth;var corners=[[left,bottom],[left,top],[right,top],[right,bottom]],startCorner=["bottom","left","top","right"].indexOf(borderSkipped,0);function cornerAt(index){return corners[(startCorner+index)%4]}-1===startCorner&&(startCorner=0);var corner=cornerAt(0);ctx.moveTo(corner[0],corner[1]);for(var i=1;i<4;i++)corner=cornerAt(i),ctx.lineTo(corner[0],corner[1]);ctx.fill(),borderWidth&&ctx.stroke()},height:function(){var vm=this._view;return vm.base-vm.y},inRange:function(mouseX,mouseY){var inRange=!1;if(this._view){var bounds=getBarBounds(this);inRange=mouseX>=bounds.left&&mouseX<=bounds.right&&mouseY>=bounds.top&&mouseY<=bounds.bottom}return inRange},inLabelRange:function(mouseX,mouseY){if(!this._view)return!1;var bounds=getBarBounds(this);return isVertical(this)?mouseX>=bounds.left&&mouseX<=bounds.right:mouseY>=bounds.top&&mouseY<=bounds.bottom},inXRange:function(mouseX){var bounds=getBarBounds(this);return mouseX>=bounds.left&&mouseX<=bounds.right},inYRange:function(mouseY){var bounds=getBarBounds(this);return mouseY>=bounds.top&&mouseY<=bounds.bottom},getCenterPoint:function(){var x,y,vm=this._view;return isVertical(this)?(x=vm.x,y=(vm.y+vm.base)/2):(x=(vm.x+vm.base)/2,y=vm.y),{x:x,y:y}},getArea:function(){var vm=this._view;return vm.width*Math.abs(vm.y-vm.base)},tooltipPosition:function(){var vm=this._view;return{x:vm.x,y:vm.y}}})},"./node_modules/chart.js/src/elements/index.js":function(module,exports,__webpack_require__){"use strict";module.exports={},module.exports.Arc=__webpack_require__("./node_modules/chart.js/src/elements/element.arc.js"),module.exports.Line=__webpack_require__("./node_modules/chart.js/src/elements/element.line.js"),module.exports.Point=__webpack_require__("./node_modules/chart.js/src/elements/element.point.js"),module.exports.Rectangle=__webpack_require__("./node_modules/chart.js/src/elements/element.rectangle.js")},"./node_modules/chart.js/src/helpers/helpers.canvas.js":function(module,exports,__webpack_require__){"use strict";var helpers=__webpack_require__("./node_modules/chart.js/src/helpers/helpers.core.js");exports=module.exports={clear:function(chart){chart.ctx.clearRect(0,0,chart.width,chart.height)},roundedRect:function(ctx,x,y,width,height,radius){if(radius){var rx=Math.min(radius,width/2),ry=Math.min(radius,height/2);ctx.moveTo(x+rx,y),ctx.lineTo(x+width-rx,y),ctx.quadraticCurveTo(x+width,y,x+width,y+ry),ctx.lineTo(x+width,y+height-ry),ctx.quadraticCurveTo(x+width,y+height,x+width-rx,y+height),ctx.lineTo(x+rx,y+height),ctx.quadraticCurveTo(x,y+height,x,y+height-ry),ctx.lineTo(x,y+ry),ctx.quadraticCurveTo(x,y,x+rx,y)}else ctx.rect(x,y,width,height)},drawPoint:function(ctx,style,radius,x,y){var type,edgeLength,xOffset,yOffset,height,size;if(!style||"object"!=typeof style||"[object HTMLImageElement]"!==(type=style.toString())&&"[object HTMLCanvasElement]"!==type){if(!(isNaN(radius)||radius<=0)){switch(style){default:ctx.beginPath(),ctx.arc(x,y,radius,0,2*Math.PI),ctx.closePath(),ctx.fill();break;case"triangle":ctx.beginPath(),height=(edgeLength=3*radius/Math.sqrt(3))*Math.sqrt(3)/2,ctx.moveTo(x-edgeLength/2,y+height/3),ctx.lineTo(x+edgeLength/2,y+height/3),ctx.lineTo(x,y-2*height/3),ctx.closePath(),ctx.fill();break;case"rect":size=1/Math.SQRT2*radius,ctx.beginPath(),ctx.fillRect(x-size,y-size,2*size,2*size),ctx.strokeRect(x-size,y-size,2*size,2*size);break;case"rectRounded":var offset=radius/Math.SQRT2,leftX=x-offset,topY=y-offset,sideSize=Math.SQRT2*radius;ctx.beginPath(),this.roundedRect(ctx,leftX,topY,sideSize,sideSize,radius/2),ctx.closePath(),ctx.fill();break;case"rectRot":size=1/Math.SQRT2*radius,ctx.beginPath(),ctx.moveTo(x-size,y),ctx.lineTo(x,y+size),ctx.lineTo(x+size,y),ctx.lineTo(x,y-size),ctx.closePath(),ctx.fill();break;case"cross":ctx.beginPath(),ctx.moveTo(x,y+radius),ctx.lineTo(x,y-radius),ctx.moveTo(x-radius,y),ctx.lineTo(x+radius,y),ctx.closePath();break;case"crossRot":ctx.beginPath(),xOffset=Math.cos(Math.PI/4)*radius,yOffset=Math.sin(Math.PI/4)*radius,ctx.moveTo(x-xOffset,y-yOffset),ctx.lineTo(x+xOffset,y+yOffset),ctx.moveTo(x-xOffset,y+yOffset),ctx.lineTo(x+xOffset,y-yOffset),ctx.closePath();break;case"star":ctx.beginPath(),ctx.moveTo(x,y+radius),ctx.lineTo(x,y-radius),ctx.moveTo(x-radius,y),ctx.lineTo(x+radius,y),xOffset=Math.cos(Math.PI/4)*radius,yOffset=Math.sin(Math.PI/4)*radius,ctx.moveTo(x-xOffset,y-yOffset),ctx.lineTo(x+xOffset,y+yOffset),ctx.moveTo(x-xOffset,y+yOffset),ctx.lineTo(x+xOffset,y-yOffset),ctx.closePath();break;case"line":ctx.beginPath(),ctx.moveTo(x-radius,y),ctx.lineTo(x+radius,y),ctx.closePath();break;case"dash":ctx.beginPath(),ctx.moveTo(x,y),ctx.lineTo(x+radius,y),ctx.closePath()}ctx.stroke()}}else ctx.drawImage(style,x-style.width/2,y-style.height/2,style.width,style.height)},clipArea:function(ctx,area){ctx.save(),ctx.beginPath(),ctx.rect(area.left,area.top,area.right-area.left,area.bottom-area.top),ctx.clip()},unclipArea:function(ctx){ctx.restore()},lineTo:function(ctx,previous,target,flip){if(target.steppedLine)return"after"===target.steppedLine&&!flip||"after"!==target.steppedLine&&flip?ctx.lineTo(previous.x,target.y):ctx.lineTo(target.x,previous.y),void ctx.lineTo(target.x,target.y);target.tension?ctx.bezierCurveTo(flip?previous.controlPointPreviousX:previous.controlPointNextX,flip?previous.controlPointPreviousY:previous.controlPointNextY,flip?target.controlPointNextX:target.controlPointPreviousX,flip?target.controlPointNextY:target.controlPointPreviousY,target.x,target.y):ctx.lineTo(target.x,target.y)}};helpers.clear=exports.clear,helpers.drawRoundedRectangle=function(ctx){ctx.beginPath(),exports.roundedRect.apply(exports,arguments),ctx.closePath()}},"./node_modules/chart.js/src/helpers/helpers.core.js":function(module,exports,__webpack_require__){"use strict";var id,helpers={noop:function(){},uid:(id=0,function(){return id++}),isNullOrUndef:function(value){return null===value||void 0===value},isArray:Array.isArray?Array.isArray:function(value){return"[object Array]"===Object.prototype.toString.call(value)},isObject:function(value){return null!==value&&"[object Object]"===Object.prototype.toString.call(value)},valueOrDefault:function(value,defaultValue){return void 0===value?defaultValue:value},valueAtIndexOrDefault:function(value,index,defaultValue){return helpers.valueOrDefault(helpers.isArray(value)?value[index]:value,defaultValue)},callback:function(fn,args,thisArg){if(fn&&"function"==typeof fn.call)return fn.apply(thisArg,args)},each:function(loopable,fn,thisArg,reverse){var i,len,keys;if(helpers.isArray(loopable))if(len=loopable.length,reverse)for(i=len-1;i>=0;i--)fn.call(thisArg,loopable[i],i);else for(i=0;i<len;i++)fn.call(thisArg,loopable[i],i);else if(helpers.isObject(loopable))for(len=(keys=Object.keys(loopable)).length,i=0;i<len;i++)fn.call(thisArg,loopable[keys[i]],keys[i])},arrayEquals:function(a0,a1){var i,ilen,v0,v1;if(!a0||!a1||a0.length!==a1.length)return!1;for(i=0,ilen=a0.length;i<ilen;++i)if(v0=a0[i],v1=a1[i],v0 instanceof Array&&v1 instanceof Array){if(!helpers.arrayEquals(v0,v1))return!1}else if(v0!==v1)return!1;return!0},clone:function(source){if(helpers.isArray(source))return source.map(helpers.clone);if(helpers.isObject(source)){for(var target={},keys=Object.keys(source),klen=keys.length,k=0;k<klen;++k)target[keys[k]]=helpers.clone(source[keys[k]]);return target}return source},_merger:function(key,target,source,options){var tval=target[key],sval=source[key];helpers.isObject(tval)&&helpers.isObject(sval)?helpers.merge(tval,sval,options):target[key]=helpers.clone(sval)},_mergerIf:function(key,target,source){var tval=target[key],sval=source[key];helpers.isObject(tval)&&helpers.isObject(sval)?helpers.mergeIf(tval,sval):target.hasOwnProperty(key)||(target[key]=helpers.clone(sval))},merge:function(target,source,options){var merge,i,keys,klen,k,sources=helpers.isArray(source)?source:[source],ilen=sources.length;if(!helpers.isObject(target))return target;for(merge=(options=options||{}).merger||helpers._merger,i=0;i<ilen;++i)if(source=sources[i],helpers.isObject(source))for(k=0,klen=(keys=Object.keys(source)).length;k<klen;++k)merge(keys[k],target,source,options);return target},mergeIf:function(target,source){return helpers.merge(target,source,{merger:helpers._mergerIf})},extend:function(target){for(var setFn=function(value,key){target[key]=value},i=1,ilen=arguments.length;i<ilen;++i)helpers.each(arguments[i],setFn);return target},inherits:function(extensions){var me=this,ChartElement=extensions&&extensions.hasOwnProperty("constructor")?extensions.constructor:function(){return me.apply(this,arguments)},Surrogate=function(){this.constructor=ChartElement};return Surrogate.prototype=me.prototype,ChartElement.prototype=new Surrogate,ChartElement.extend=helpers.inherits,extensions&&helpers.extend(ChartElement.prototype,extensions),ChartElement.__super__=me.prototype,ChartElement}};module.exports=helpers,helpers.callCallback=helpers.callback,helpers.indexOf=function(array,item,fromIndex){return Array.prototype.indexOf.call(array,item,fromIndex)},helpers.getValueOrDefault=helpers.valueOrDefault,helpers.getValueAtIndexOrDefault=helpers.valueAtIndexOrDefault},"./node_modules/chart.js/src/helpers/helpers.easing.js":function(module,exports,__webpack_require__){"use strict";var helpers=__webpack_require__("./node_modules/chart.js/src/helpers/helpers.core.js"),effects={linear:function(t){return t},easeInQuad:function(t){return t*t},easeOutQuad:function(t){return-t*(t-2)},easeInOutQuad:function(t){return(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1)},easeInCubic:function(t){return t*t*t},easeOutCubic:function(t){return(t-=1)*t*t+1},easeInOutCubic:function(t){return(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},easeInQuart:function(t){return t*t*t*t},easeOutQuart:function(t){return-((t-=1)*t*t*t-1)},easeInOutQuart:function(t){return(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},easeInQuint:function(t){return t*t*t*t*t},easeOutQuint:function(t){return(t-=1)*t*t*t*t+1},easeInOutQuint:function(t){return(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},easeInSine:function(t){return 1-Math.cos(t*(Math.PI/2))},easeOutSine:function(t){return Math.sin(t*(Math.PI/2))},easeInOutSine:function(t){return-.5*(Math.cos(Math.PI*t)-1)},easeInExpo:function(t){return 0===t?0:Math.pow(2,10*(t-1))},easeOutExpo:function(t){return 1===t?1:1-Math.pow(2,-10*t)},easeInOutExpo:function(t){return 0===t?0:1===t?1:(t/=.5)<1?.5*Math.pow(2,10*(t-1)):.5*(2-Math.pow(2,-10*--t))},easeInCirc:function(t){return t>=1?t:-(Math.sqrt(1-t*t)-1)},easeOutCirc:function(t){return Math.sqrt(1-(t-=1)*t)},easeInOutCirc:function(t){return(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},easeInElastic:function(t){var s=1.70158,p=0,a=1;return 0===t?0:1===t?1:(p||(p=.3),a<1?(a=1,s=p/4):s=p/(2*Math.PI)*Math.asin(1/a),-a*Math.pow(2,10*(t-=1))*Math.sin((t-s)*(2*Math.PI)/p))},easeOutElastic:function(t){var s=1.70158,p=0,a=1;return 0===t?0:1===t?1:(p||(p=.3),a<1?(a=1,s=p/4):s=p/(2*Math.PI)*Math.asin(1/a),a*Math.pow(2,-10*t)*Math.sin((t-s)*(2*Math.PI)/p)+1)},easeInOutElastic:function(t){var s=1.70158,p=0,a=1;return 0===t?0:2==(t/=.5)?1:(p||(p=.45),a<1?(a=1,s=p/4):s=p/(2*Math.PI)*Math.asin(1/a),t<1?a*Math.pow(2,10*(t-=1))*Math.sin((t-s)*(2*Math.PI)/p)*-.5:a*Math.pow(2,-10*(t-=1))*Math.sin((t-s)*(2*Math.PI)/p)*.5+1)},easeInBack:function(t){var s=1.70158;return t*t*((s+1)*t-s)},easeOutBack:function(t){var s=1.70158;return(t-=1)*t*((s+1)*t+s)+1},easeInOutBack:function(t){var s=1.70158;return(t/=.5)<1?t*t*((1+(s*=1.525))*t-s)*.5:.5*((t-=2)*t*((1+(s*=1.525))*t+s)+2)},easeInBounce:function(t){return 1-effects.easeOutBounce(1-t)},easeOutBounce:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},easeInOutBounce:function(t){return t<.5?.5*effects.easeInBounce(2*t):.5*effects.easeOutBounce(2*t-1)+.5}};module.exports={effects:effects},helpers.easingEffects=effects},"./node_modules/chart.js/src/helpers/helpers.options.js":function(module,exports,__webpack_require__){"use strict";var helpers=__webpack_require__("./node_modules/chart.js/src/helpers/helpers.core.js");module.exports={toLineHeight:function(value,size){var matches=(""+value).match(/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/);if(!matches||"normal"===matches[1])return 1.2*size;switch(value=+matches[2],matches[3]){case"px":return value;case"%":value/=100}return size*value},toPadding:function(value){var t,r,b,l;return helpers.isObject(value)?(t=+value.top||0,r=+value.right||0,b=+value.bottom||0,l=+value.left||0):t=r=b=l=+value||0,{top:t,right:r,bottom:b,left:l,height:t+b,width:l+r}},resolve:function(inputs,context,index){var i,ilen,value;for(i=0,ilen=inputs.length;i<ilen;++i)if(void 0!==(value=inputs[i])&&(void 0!==context&&"function"==typeof value&&(value=value(context)),void 0!==index&&helpers.isArray(value)&&(value=value[index]),void 0!==value))return value}}},"./node_modules/chart.js/src/helpers/index.js":function(module,exports,__webpack_require__){"use strict";module.exports=__webpack_require__("./node_modules/chart.js/src/helpers/helpers.core.js"),module.exports.easing=__webpack_require__("./node_modules/chart.js/src/helpers/helpers.easing.js"),module.exports.canvas=__webpack_require__("./node_modules/chart.js/src/helpers/helpers.canvas.js"),module.exports.options=__webpack_require__("./node_modules/chart.js/src/helpers/helpers.options.js")},"./node_modules/chart.js/src/platforms/platform.basic.js":function(module,exports){module.exports={acquireContext:function(item){return item&&item.canvas&&(item=item.canvas),item&&item.getContext("2d")||null}}},"./node_modules/chart.js/src/platforms/platform.dom.js":function(module,exports,__webpack_require__){"use strict";var helpers=__webpack_require__("./node_modules/chart.js/src/helpers/index.js"),EXPANDO_KEY="$chartjs",CSS_PREFIX="chartjs-",CSS_RENDER_MONITOR=CSS_PREFIX+"render-monitor",CSS_RENDER_ANIMATION=CSS_PREFIX+"render-animation",ANIMATION_START_EVENTS=["animationstart","webkitAnimationStart"],EVENT_TYPES={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"};function readUsedSize(element,property){var value=helpers.getStyle(element,property),matches=value&&value.match(/^(\d+)(\.\d+)?px$/);return matches?Number(matches[1]):void 0}var eventListenerOptions=!!function(){var supports=!1;try{var options=Object.defineProperty({},"passive",{get:function(){supports=!0}});window.addEventListener("e",null,options)}catch(e){}return supports}()&&{passive:!0};function addEventListener(node,type,listener){node.addEventListener(type,listener,eventListenerOptions)}function removeEventListener(node,type,listener){node.removeEventListener(type,listener,eventListenerOptions)}function createEvent(type,chart,x,y,nativeEvent){return{type:type,chart:chart,native:nativeEvent||null,x:void 0!==x?x:null,y:void 0!==y?y:null}}function addResizeListener(node,listener,chart){var fn,thisArg,ticking,args,expando=node[EXPANDO_KEY]||(node[EXPANDO_KEY]={}),resizer=expando.resizer=function(handler){var resizer=document.createElement("div"),cls=CSS_PREFIX+"size-monitor",style="position:absolute;left:0;top:0;right:0;bottom:0;overflow:hidden;pointer-events:none;visibility:hidden;z-index:-1;";resizer.style.cssText=style,resizer.className=cls,resizer.innerHTML='<div class="'+cls+'-expand" style="'+style+'"><div style="position:absolute;width:1000000px;height:1000000px;left:0;top:0"></div></div><div class="'+cls+'-shrink" style="'+style+'"><div style="position:absolute;width:200%;height:200%;left:0; top:0"></div></div>';var expand=resizer.childNodes[0],shrink=resizer.childNodes[1];resizer._reset=function(){expand.scrollLeft=1e6,expand.scrollTop=1e6,shrink.scrollLeft=1e6,shrink.scrollTop=1e6};var onScroll=function(){resizer._reset(),handler()};return addEventListener(expand,"scroll",onScroll.bind(expand,"expand")),addEventListener(shrink,"scroll",onScroll.bind(shrink,"shrink")),resizer}((fn=function(){if(expando.resizer)return listener(createEvent("resize",chart))},ticking=!1,args=[],function(){args=Array.prototype.slice.call(arguments),thisArg=thisArg||this,ticking||(ticking=!0,helpers.requestAnimFrame.call(window,function(){ticking=!1,fn.apply(thisArg,args)}))}));!function(node,handler){var expando=node[EXPANDO_KEY]||(node[EXPANDO_KEY]={}),proxy=expando.renderProxy=function(e){e.animationName===CSS_RENDER_ANIMATION&&handler()};helpers.each(ANIMATION_START_EVENTS,function(type){addEventListener(node,type,proxy)}),expando.reflow=!!node.offsetParent,node.classList.add(CSS_RENDER_MONITOR)}(node,function(){if(expando.resizer){var container=node.parentNode;container&&container!==resizer.parentNode&&container.insertBefore(resizer,container.firstChild),resizer._reset()}})}function removeResizeListener(node){var expando=node[EXPANDO_KEY]||{},resizer=expando.resizer;delete expando.resizer,function(node){var expando=node[EXPANDO_KEY]||{},proxy=expando.renderProxy;proxy&&(helpers.each(ANIMATION_START_EVENTS,function(type){removeEventListener(node,type,proxy)}),delete expando.renderProxy),node.classList.remove(CSS_RENDER_MONITOR)}(node),resizer&&resizer.parentNode&&resizer.parentNode.removeChild(resizer)}module.exports={_enabled:"undefined"!=typeof window&&"undefined"!=typeof document,initialize:function(){var platform,css,style,keyframes="from{opacity:0.99}to{opacity:1}";css="@-webkit-keyframes "+CSS_RENDER_ANIMATION+"{"+keyframes+"}@keyframes "+CSS_RENDER_ANIMATION+"{"+keyframes+"}."+CSS_RENDER_MONITOR+"{-webkit-animation:"+CSS_RENDER_ANIMATION+" 0.001s;animation:"+CSS_RENDER_ANIMATION+" 0.001s;}",style=(platform=this)._style||document.createElement("style"),platform._style||(platform._style=style,css="/* Chart.js */\n"+css,style.setAttribute("type","text/css"),document.getElementsByTagName("head")[0].appendChild(style)),style.appendChild(document.createTextNode(css))},acquireContext:function(item,config){"string"==typeof item?item=document.getElementById(item):item.length&&(item=item[0]),item&&item.canvas&&(item=item.canvas);var context=item&&item.getContext&&item.getContext("2d");return context&&context.canvas===item?(function(canvas,config){var style=canvas.style,renderHeight=canvas.getAttribute("height"),renderWidth=canvas.getAttribute("width");if(canvas[EXPANDO_KEY]={initial:{height:renderHeight,width:renderWidth,style:{display:style.display,height:style.height,width:style.width}}},style.display=style.display||"block",null===renderWidth||""===renderWidth){var displayWidth=readUsedSize(canvas,"width");void 0!==displayWidth&&(canvas.width=displayWidth)}if(null===renderHeight||""===renderHeight)if(""===canvas.style.height)canvas.height=canvas.width/(config.options.aspectRatio||2);else{var displayHeight=readUsedSize(canvas,"height");void 0!==displayWidth&&(canvas.height=displayHeight)}}(item,config),context):null},releaseContext:function(context){var canvas=context.canvas;if(canvas[EXPANDO_KEY]){var initial=canvas[EXPANDO_KEY].initial;["height","width"].forEach(function(prop){var value=initial[prop];helpers.isNullOrUndef(value)?canvas.removeAttribute(prop):canvas.setAttribute(prop,value)}),helpers.each(initial.style||{},function(value,key){canvas.style[key]=value}),canvas.width=canvas.width,delete canvas[EXPANDO_KEY]}},addEventListener:function(chart,type,listener){var canvas=chart.canvas;if("resize"!==type){var expando=listener[EXPANDO_KEY]||(listener[EXPANDO_KEY]={});addEventListener(canvas,type,(expando.proxies||(expando.proxies={}))[chart.id+"_"+type]=function(event){listener(function(event,chart){var type=EVENT_TYPES[event.type]||event.type,pos=helpers.getRelativePosition(event,chart);return createEvent(type,chart,pos.x,pos.y,event)}(event,chart))})}else addResizeListener(canvas,listener,chart)},removeEventListener:function(chart,type,listener){var canvas=chart.canvas;if("resize"!==type){var proxy=((listener[EXPANDO_KEY]||{}).proxies||{})[chart.id+"_"+type];proxy&&removeEventListener(canvas,type,proxy)}else removeResizeListener(canvas)}},helpers.addEvent=addEventListener,helpers.removeEvent=removeEventListener},"./node_modules/chart.js/src/platforms/platform.js":function(module,exports,__webpack_require__){"use strict";var helpers=__webpack_require__("./node_modules/chart.js/src/helpers/index.js"),basic=__webpack_require__("./node_modules/chart.js/src/platforms/platform.basic.js"),dom=__webpack_require__("./node_modules/chart.js/src/platforms/platform.dom.js"),implementation=dom._enabled?dom:basic;module.exports=helpers.extend({initialize:function(){},acquireContext:function(){},releaseContext:function(){},addEventListener:function(){},removeEventListener:function(){}},implementation)},"./node_modules/chart.js/src/plugins/index.js":function(module,exports,__webpack_require__){"use strict";module.exports={},module.exports.filler=__webpack_require__("./node_modules/chart.js/src/plugins/plugin.filler.js"),module.exports.legend=__webpack_require__("./node_modules/chart.js/src/plugins/plugin.legend.js"),module.exports.title=__webpack_require__("./node_modules/chart.js/src/plugins/plugin.title.js")},"./node_modules/chart.js/src/plugins/plugin.filler.js":function(module,exports,__webpack_require__){"use strict";var defaults=__webpack_require__("./node_modules/chart.js/src/core/core.defaults.js"),elements=__webpack_require__("./node_modules/chart.js/src/elements/index.js"),helpers=__webpack_require__("./node_modules/chart.js/src/helpers/index.js");defaults._set("global",{plugins:{filler:{propagate:!0}}});var mappers={dataset:function(source){var index=source.fill,chart=source.chart,meta=chart.getDatasetMeta(index),points=meta&&chart.isDatasetVisible(index)&&meta.dataset._children||[],length=points.length||0;return length?function(point,i){return i<length&&points[i]._view||null}:null},boundary:function(source){var boundary=source.boundary,x=boundary?boundary.x:null,y=boundary?boundary.y:null;return function(point){return{x:null===x?point.x:x,y:null===y?point.y:y}}}};function decodeFill(el,index,count){var target,model=el._model||{},fill=model.fill;if(void 0===fill&&(fill=!!model.backgroundColor),!1===fill||null===fill)return!1;if(!0===fill)return"origin";if(target=parseFloat(fill,10),isFinite(target)&&Math.floor(target)===target)return"-"!==fill[0]&&"+"!==fill[0]||(target=index+target),!(target===index||target<0||target>=count)&&target;switch(fill){case"bottom":return"start";case"top":return"end";case"zero":return"origin";case"origin":case"start":case"end":return fill;default:return!1}}function computeBoundary(source){var horizontal,model=source.el._model||{},scale=source.el._scale||{},fill=source.fill,target=null;if(isFinite(fill))return null;if("start"===fill?target=void 0===model.scaleBottom?scale.bottom:model.scaleBottom:"end"===fill?target=void 0===model.scaleTop?scale.top:model.scaleTop:void 0!==model.scaleZero?target=model.scaleZero:scale.getBasePosition?target=scale.getBasePosition():scale.getBasePixel&&(target=scale.getBasePixel()),void 0!==target&&null!==target){if(void 0!==target.x&&void 0!==target.y)return target;if("number"==typeof target&&isFinite(target))return{x:(horizontal=scale.isHorizontal())?target:null,y:horizontal?null:target}}return null}function resolveTarget(sources,index,propagate){var target,fill=sources[index].fill,visited=[index];if(!propagate)return fill;for(;!1!==fill&&-1===visited.indexOf(fill);){if(!isFinite(fill))return fill;if(!(target=sources[fill]))return!1;if(target.visible)return fill;visited.push(fill),fill=target.fill}return!1}function createMapper(source){var fill=source.fill,type="dataset";return!1===fill?null:(isFinite(fill)||(type="boundary"),mappers[type](source))}function isDrawable(point){return point&&!point.skip}function drawArea(ctx,curve0,curve1,len0,len1){var i;if(len0&&len1){for(ctx.moveTo(curve0[0].x,curve0[0].y),i=1;i<len0;++i)helpers.canvas.lineTo(ctx,curve0[i-1],curve0[i]);for(ctx.lineTo(curve1[len1-1].x,curve1[len1-1].y),i=len1-1;i>0;--i)helpers.canvas.lineTo(ctx,curve1[i],curve1[i-1],!0)}}module.exports={id:"filler",afterDatasetsUpdate:function(chart,options){var meta,i,el,source,count=(chart.data.datasets||[]).length,propagate=options.propagate,sources=[];for(i=0;i<count;++i)source=null,(el=(meta=chart.getDatasetMeta(i)).dataset)&&el._model&&el instanceof elements.Line&&(source={visible:chart.isDatasetVisible(i),fill:decodeFill(el,i,count),chart:chart,el:el}),meta.$filler=source,sources.push(source);for(i=0;i<count;++i)(source=sources[i])&&(source.fill=resolveTarget(sources,i,propagate),source.boundary=computeBoundary(source),source.mapper=createMapper(source))},beforeDatasetDraw:function(chart,args){var meta=args.meta.$filler;if(meta){var ctx=chart.ctx,el=meta.el,view=el._view,points=el._children||[],mapper=meta.mapper,color=view.backgroundColor||defaults.global.defaultColor;mapper&&color&&points.length&&(helpers.canvas.clipArea(ctx,chart.chartArea),function(ctx,points,mapper,view,color,loop){var i,ilen,index,p0,p1,d0,d1,count=points.length,span=view.spanGaps,curve0=[],curve1=[],len0=0,len1=0;for(ctx.beginPath(),i=0,ilen=count+!!loop;i<ilen;++i)p1=mapper(p0=points[index=i%count]._view,index,view),d0=isDrawable(p0),d1=isDrawable(p1),d0&&d1?(len0=curve0.push(p0),len1=curve1.push(p1)):len0&&len1&&(span?(d0&&curve0.push(p0),d1&&curve1.push(p1)):(drawArea(ctx,curve0,curve1,len0,len1),len0=len1=0,curve0=[],curve1=[]));drawArea(ctx,curve0,curve1,len0,len1),ctx.closePath(),ctx.fillStyle=color,ctx.fill()}(ctx,points,mapper,view,color,el._loop),helpers.canvas.unclipArea(ctx))}}}},"./node_modules/chart.js/src/plugins/plugin.legend.js":function(module,exports,__webpack_require__){"use strict";var defaults=__webpack_require__("./node_modules/chart.js/src/core/core.defaults.js"),Element=__webpack_require__("./node_modules/chart.js/src/core/core.element.js"),helpers=__webpack_require__("./node_modules/chart.js/src/helpers/index.js"),layouts=__webpack_require__("./node_modules/chart.js/src/core/core.layouts.js"),noop=helpers.noop;function getBoxWidth(labelOpts,fontSize){return labelOpts.usePointStyle?fontSize*Math.SQRT2:labelOpts.boxWidth}defaults._set("global",{legend:{display:!0,position:"top",fullWidth:!0,reverse:!1,weight:1e3,onClick:function(e,legendItem){var index=legendItem.datasetIndex,ci=this.chart,meta=ci.getDatasetMeta(index);meta.hidden=null===meta.hidden?!ci.data.datasets[index].hidden:null,ci.update()},onHover:null,labels:{boxWidth:40,padding:10,generateLabels:function(chart){var data=chart.data;return helpers.isArray(data.datasets)?data.datasets.map(function(dataset,i){return{text:dataset.label,fillStyle:helpers.isArray(dataset.backgroundColor)?dataset.backgroundColor[0]:dataset.backgroundColor,hidden:!chart.isDatasetVisible(i),lineCap:dataset.borderCapStyle,lineDash:dataset.borderDash,lineDashOffset:dataset.borderDashOffset,lineJoin:dataset.borderJoinStyle,lineWidth:dataset.borderWidth,strokeStyle:dataset.borderColor,pointStyle:dataset.pointStyle,datasetIndex:i}},this):[]}}},legendCallback:function(chart){var text=[];text.push('<ul class="'+chart.id+'-legend">');for(var i=0;i<chart.data.datasets.length;i++)text.push('<li><span style="background-color:'+chart.data.datasets[i].backgroundColor+'"></span>'),chart.data.datasets[i].label&&text.push(chart.data.datasets[i].label),text.push("</li>");return text.push("</ul>"),text.join("")}});var Legend=Element.extend({initialize:function(config){helpers.extend(this,config),this.legendHitBoxes=[],this.doughnutMode=!1},beforeUpdate:noop,update:function(maxWidth,maxHeight,margins){var me=this;return me.beforeUpdate(),me.maxWidth=maxWidth,me.maxHeight=maxHeight,me.margins=margins,me.beforeSetDimensions(),me.setDimensions(),me.afterSetDimensions(),me.beforeBuildLabels(),me.buildLabels(),me.afterBuildLabels(),me.beforeFit(),me.fit(),me.afterFit(),me.afterUpdate(),me.minSize},afterUpdate:noop,beforeSetDimensions:noop,setDimensions:function(){var me=this;me.isHorizontal()?(me.width=me.maxWidth,me.left=0,me.right=me.width):(me.height=me.maxHeight,me.top=0,me.bottom=me.height),me.paddingLeft=0,me.paddingTop=0,me.paddingRight=0,me.paddingBottom=0,me.minSize={width:0,height:0}},afterSetDimensions:noop,beforeBuildLabels:noop,buildLabels:function(){var me=this,labelOpts=me.options.labels||{},legendItems=helpers.callback(labelOpts.generateLabels,[me.chart],me)||[];labelOpts.filter&&(legendItems=legendItems.filter(function(item){return labelOpts.filter(item,me.chart.data)})),me.options.reverse&&legendItems.reverse(),me.legendItems=legendItems},afterBuildLabels:noop,beforeFit:noop,fit:function(){var me=this,opts=me.options,labelOpts=opts.labels,display=opts.display,ctx=me.ctx,globalDefault=defaults.global,valueOrDefault=helpers.valueOrDefault,fontSize=valueOrDefault(labelOpts.fontSize,globalDefault.defaultFontSize),fontStyle=valueOrDefault(labelOpts.fontStyle,globalDefault.defaultFontStyle),fontFamily=valueOrDefault(labelOpts.fontFamily,globalDefault.defaultFontFamily),labelFont=helpers.fontString(fontSize,fontStyle,fontFamily),hitboxes=me.legendHitBoxes=[],minSize=me.minSize,isHorizontal=me.isHorizontal();if(isHorizontal?(minSize.width=me.maxWidth,minSize.height=display?10:0):(minSize.width=display?10:0,minSize.height=me.maxHeight),display)if(ctx.font=labelFont,isHorizontal){var lineWidths=me.lineWidths=[0],totalHeight=me.legendItems.length?fontSize+labelOpts.padding:0;ctx.textAlign="left",ctx.textBaseline="top",helpers.each(me.legendItems,function(legendItem,i){var width=getBoxWidth(labelOpts,fontSize)+fontSize/2+ctx.measureText(legendItem.text).width;lineWidths[lineWidths.length-1]+width+labelOpts.padding>=me.width&&(totalHeight+=fontSize+labelOpts.padding,lineWidths[lineWidths.length]=me.left),hitboxes[i]={left:0,top:0,width:width,height:fontSize},lineWidths[lineWidths.length-1]+=width+labelOpts.padding}),minSize.height+=totalHeight}else{var vPadding=labelOpts.padding,columnWidths=me.columnWidths=[],totalWidth=labelOpts.padding,currentColWidth=0,currentColHeight=0,itemHeight=fontSize+vPadding;helpers.each(me.legendItems,function(legendItem,i){var itemWidth=getBoxWidth(labelOpts,fontSize)+fontSize/2+ctx.measureText(legendItem.text).width;currentColHeight+itemHeight>minSize.height&&(totalWidth+=currentColWidth+labelOpts.padding,columnWidths.push(currentColWidth),currentColWidth=0,currentColHeight=0),currentColWidth=Math.max(currentColWidth,itemWidth),currentColHeight+=itemHeight,hitboxes[i]={left:0,top:0,width:itemWidth,height:fontSize}}),totalWidth+=currentColWidth,columnWidths.push(currentColWidth),minSize.width+=totalWidth}me.width=minSize.width,me.height=minSize.height},afterFit:noop,isHorizontal:function(){return"top"===this.options.position||"bottom"===this.options.position},draw:function(){var me=this,opts=me.options,labelOpts=opts.labels,globalDefault=defaults.global,lineDefault=globalDefault.elements.line,legendWidth=me.width,lineWidths=me.lineWidths;if(opts.display){var cursor,ctx=me.ctx,valueOrDefault=helpers.valueOrDefault,fontColor=valueOrDefault(labelOpts.fontColor,globalDefault.defaultFontColor),fontSize=valueOrDefault(labelOpts.fontSize,globalDefault.defaultFontSize),fontStyle=valueOrDefault(labelOpts.fontStyle,globalDefault.defaultFontStyle),fontFamily=valueOrDefault(labelOpts.fontFamily,globalDefault.defaultFontFamily),labelFont=helpers.fontString(fontSize,fontStyle,fontFamily);ctx.textAlign="left",ctx.textBaseline="middle",ctx.lineWidth=.5,ctx.strokeStyle=fontColor,ctx.fillStyle=fontColor,ctx.font=labelFont;var boxWidth=getBoxWidth(labelOpts,fontSize),hitboxes=me.legendHitBoxes,isHorizontal=me.isHorizontal();cursor=isHorizontal?{x:me.left+(legendWidth-lineWidths[0])/2,y:me.top+labelOpts.padding,line:0}:{x:me.left+labelOpts.padding,y:me.top+labelOpts.padding,line:0};var itemHeight=fontSize+labelOpts.padding;helpers.each(me.legendItems,function(legendItem,i){var textWidth=ctx.measureText(legendItem.text).width,width=boxWidth+fontSize/2+textWidth,x=cursor.x,y=cursor.y;isHorizontal?x+width>=legendWidth&&(y=cursor.y+=itemHeight,cursor.line++,x=cursor.x=me.left+(legendWidth-lineWidths[cursor.line])/2):y+itemHeight>me.bottom&&(x=cursor.x=x+me.columnWidths[cursor.line]+labelOpts.padding,y=cursor.y=me.top+labelOpts.padding,cursor.line++),function(x,y,legendItem){if(!(isNaN(boxWidth)||boxWidth<=0)){ctx.save(),ctx.fillStyle=valueOrDefault(legendItem.fillStyle,globalDefault.defaultColor),ctx.lineCap=valueOrDefault(legendItem.lineCap,lineDefault.borderCapStyle),ctx.lineDashOffset=valueOrDefault(legendItem.lineDashOffset,lineDefault.borderDashOffset),ctx.lineJoin=valueOrDefault(legendItem.lineJoin,lineDefault.borderJoinStyle),ctx.lineWidth=valueOrDefault(legendItem.lineWidth,lineDefault.borderWidth),ctx.strokeStyle=valueOrDefault(legendItem.strokeStyle,globalDefault.defaultColor);var isLineWidthZero=0===valueOrDefault(legendItem.lineWidth,lineDefault.borderWidth);if(ctx.setLineDash&&ctx.setLineDash(valueOrDefault(legendItem.lineDash,lineDefault.borderDash)),opts.labels&&opts.labels.usePointStyle){var radius=fontSize*Math.SQRT2/2,offSet=radius/Math.SQRT2,centerX=x+offSet,centerY=y+offSet;helpers.canvas.drawPoint(ctx,legendItem.pointStyle,radius,centerX,centerY)}else isLineWidthZero||ctx.strokeRect(x,y,boxWidth,fontSize),ctx.fillRect(x,y,boxWidth,fontSize);ctx.restore()}}(x,y,legendItem),hitboxes[i].left=x,hitboxes[i].top=y,function(x,y,legendItem,textWidth){var halfFontSize=fontSize/2,xLeft=boxWidth+halfFontSize+x,yMiddle=y+halfFontSize;ctx.fillText(legendItem.text,xLeft,yMiddle),legendItem.hidden&&(ctx.beginPath(),ctx.lineWidth=2,ctx.moveTo(xLeft,yMiddle),ctx.lineTo(xLeft+textWidth,yMiddle),ctx.stroke())}(x,y,legendItem,textWidth),isHorizontal?cursor.x+=width+labelOpts.padding:cursor.y+=itemHeight})}},handleEvent:function(e){var me=this,opts=me.options,type="mouseup"===e.type?"click":e.type,changed=!1;if("mousemove"===type){if(!opts.onHover)return}else{if("click"!==type)return;if(!opts.onClick)return}var x=e.x,y=e.y;if(x>=me.left&&x<=me.right&&y>=me.top&&y<=me.bottom)for(var lh=me.legendHitBoxes,i=0;i<lh.length;++i){var hitBox=lh[i];if(x>=hitBox.left&&x<=hitBox.left+hitBox.width&&y>=hitBox.top&&y<=hitBox.top+hitBox.height){if("click"===type){opts.onClick.call(me,e.native,me.legendItems[i]),changed=!0;break}if("mousemove"===type){opts.onHover.call(me,e.native,me.legendItems[i]),changed=!0;break}}}return changed}});function createNewLegendAndAttach(chart,legendOpts){var legend=new Legend({ctx:chart.ctx,options:legendOpts,chart:chart});layouts.configure(chart,legend,legendOpts),layouts.addBox(chart,legend),chart.legend=legend}module.exports={id:"legend",_element:Legend,beforeInit:function(chart){var legendOpts=chart.options.legend;legendOpts&&createNewLegendAndAttach(chart,legendOpts)},beforeUpdate:function(chart){var legendOpts=chart.options.legend,legend=chart.legend;legendOpts?(helpers.mergeIf(legendOpts,defaults.global.legend),legend?(layouts.configure(chart,legend,legendOpts),legend.options=legendOpts):createNewLegendAndAttach(chart,legendOpts)):legend&&(layouts.removeBox(chart,legend),delete chart.legend)},afterEvent:function(chart,e){var legend=chart.legend;legend&&legend.handleEvent(e)}}},"./node_modules/chart.js/src/plugins/plugin.title.js":function(module,exports,__webpack_require__){"use strict";var defaults=__webpack_require__("./node_modules/chart.js/src/core/core.defaults.js"),Element=__webpack_require__("./node_modules/chart.js/src/core/core.element.js"),helpers=__webpack_require__("./node_modules/chart.js/src/helpers/index.js"),layouts=__webpack_require__("./node_modules/chart.js/src/core/core.layouts.js"),noop=helpers.noop;defaults._set("global",{title:{display:!1,fontStyle:"bold",fullWidth:!0,lineHeight:1.2,padding:10,position:"top",text:"",weight:2e3}});var Title=Element.extend({initialize:function(config){helpers.extend(this,config),this.legendHitBoxes=[]},beforeUpdate:noop,update:function(maxWidth,maxHeight,margins){var me=this;return me.beforeUpdate(),me.maxWidth=maxWidth,me.maxHeight=maxHeight,me.margins=margins,me.beforeSetDimensions(),me.setDimensions(),me.afterSetDimensions(),me.beforeBuildLabels(),me.buildLabels(),me.afterBuildLabels(),me.beforeFit(),me.fit(),me.afterFit(),me.afterUpdate(),me.minSize},afterUpdate:noop,beforeSetDimensions:noop,setDimensions:function(){var me=this;me.isHorizontal()?(me.width=me.maxWidth,me.left=0,me.right=me.width):(me.height=me.maxHeight,me.top=0,me.bottom=me.height),me.paddingLeft=0,me.paddingTop=0,me.paddingRight=0,me.paddingBottom=0,me.minSize={width:0,height:0}},afterSetDimensions:noop,beforeBuildLabels:noop,buildLabels:noop,afterBuildLabels:noop,beforeFit:noop,fit:function(){var me=this,valueOrDefault=helpers.valueOrDefault,opts=me.options,display=opts.display,fontSize=valueOrDefault(opts.fontSize,defaults.global.defaultFontSize),minSize=me.minSize,lineCount=helpers.isArray(opts.text)?opts.text.length:1,lineHeight=helpers.options.toLineHeight(opts.lineHeight,fontSize),textSize=display?lineCount*lineHeight+2*opts.padding:0;me.isHorizontal()?(minSize.width=me.maxWidth,minSize.height=textSize):(minSize.width=textSize,minSize.height=me.maxHeight),me.width=minSize.width,me.height=minSize.height},afterFit:noop,isHorizontal:function(){var pos=this.options.position;return"top"===pos||"bottom"===pos},draw:function(){var me=this,ctx=me.ctx,valueOrDefault=helpers.valueOrDefault,opts=me.options,globalDefaults=defaults.global;if(opts.display){var maxWidth,titleX,titleY,fontSize=valueOrDefault(opts.fontSize,globalDefaults.defaultFontSize),fontStyle=valueOrDefault(opts.fontStyle,globalDefaults.defaultFontStyle),fontFamily=valueOrDefault(opts.fontFamily,globalDefaults.defaultFontFamily),titleFont=helpers.fontString(fontSize,fontStyle,fontFamily),lineHeight=helpers.options.toLineHeight(opts.lineHeight,fontSize),offset=lineHeight/2+opts.padding,rotation=0,top=me.top,left=me.left,bottom=me.bottom,right=me.right;ctx.fillStyle=valueOrDefault(opts.fontColor,globalDefaults.defaultFontColor),ctx.font=titleFont,me.isHorizontal()?(titleX=left+(right-left)/2,titleY=top+offset,maxWidth=right-left):(titleX="left"===opts.position?left+offset:right-offset,titleY=top+(bottom-top)/2,maxWidth=bottom-top,rotation=Math.PI*("left"===opts.position?-.5:.5)),ctx.save(),ctx.translate(titleX,titleY),ctx.rotate(rotation),ctx.textAlign="center",ctx.textBaseline="middle";var text=opts.text;if(helpers.isArray(text))for(var y=0,i=0;i<text.length;++i)ctx.fillText(text[i],0,y,maxWidth),y+=lineHeight;else ctx.fillText(text,0,0,maxWidth);ctx.restore()}}});function createNewTitleBlockAndAttach(chart,titleOpts){var title=new Title({ctx:chart.ctx,options:titleOpts,chart:chart});layouts.configure(chart,title,titleOpts),layouts.addBox(chart,title),chart.titleBlock=title}module.exports={id:"title",_element:Title,beforeInit:function(chart){var titleOpts=chart.options.title;titleOpts&&createNewTitleBlockAndAttach(chart,titleOpts)},beforeUpdate:function(chart){var titleOpts=chart.options.title,titleBlock=chart.titleBlock;titleOpts?(helpers.mergeIf(titleOpts,defaults.global.title),titleBlock?(layouts.configure(chart,titleBlock,titleOpts),titleBlock.options=titleOpts):createNewTitleBlockAndAttach(chart,titleOpts)):titleBlock&&(layouts.removeBox(chart,titleBlock),delete chart.titleBlock)}}},"./node_modules/chart.js/src/scales/scale.category.js":function(module,exports,__webpack_require__){"use strict";module.exports=function(Chart){var DatasetScale=Chart.Scale.extend({getLabels:function(){var data=this.chart.data;return this.options.labels||(this.isHorizontal()?data.xLabels:data.yLabels)||data.labels},determineDataLimits:function(){var findIndex,me=this,labels=me.getLabels();me.minIndex=0,me.maxIndex=labels.length-1,void 0!==me.options.ticks.min&&(findIndex=labels.indexOf(me.options.ticks.min),me.minIndex=-1!==findIndex?findIndex:me.minIndex),void 0!==me.options.ticks.max&&(findIndex=labels.indexOf(me.options.ticks.max),me.maxIndex=-1!==findIndex?findIndex:me.maxIndex),me.min=labels[me.minIndex],me.max=labels[me.maxIndex]},buildTicks:function(){var me=this,labels=me.getLabels();me.ticks=0===me.minIndex&&me.maxIndex===labels.length-1?labels:labels.slice(me.minIndex,me.maxIndex+1)},getLabelForIndex:function(index,datasetIndex){var me=this,data=me.chart.data,isHorizontal=me.isHorizontal();return data.yLabels&&!isHorizontal?me.getRightValue(data.datasets[datasetIndex].data[index]):me.ticks[index-me.minIndex]},getPixelForValue:function(value,index){var valueCategory,me=this,offset=me.options.offset,offsetAmt=Math.max(me.maxIndex+1-me.minIndex-(offset?0:1),1);if(void 0!==value&&null!==value&&(valueCategory=me.isHorizontal()?value.x:value.y),void 0!==valueCategory||void 0!==value&&isNaN(index)){var labels=me.getLabels();value=valueCategory||value;var idx=labels.indexOf(value);index=-1!==idx?idx:index}if(me.isHorizontal()){var valueWidth=me.width/offsetAmt,widthOffset=valueWidth*(index-me.minIndex);return offset&&(widthOffset+=valueWidth/2),me.left+Math.round(widthOffset)}var valueHeight=me.height/offsetAmt,heightOffset=valueHeight*(index-me.minIndex);return offset&&(heightOffset+=valueHeight/2),me.top+Math.round(heightOffset)},getPixelForTick:function(index){return this.getPixelForValue(this.ticks[index],index+this.minIndex,null)},getValueForPixel:function(pixel){var me=this,offset=me.options.offset,offsetAmt=Math.max(me._ticks.length-(offset?0:1),1),horz=me.isHorizontal(),valueDimension=(horz?me.width:me.height)/offsetAmt;return pixel-=horz?me.left:me.top,offset&&(pixel-=valueDimension/2),(pixel<=0?0:Math.round(pixel/valueDimension))+me.minIndex},getBasePixel:function(){return this.bottom}});Chart.scaleService.registerScaleType("category",DatasetScale,{position:"bottom"})}},"./node_modules/chart.js/src/scales/scale.linear.js":function(module,exports,__webpack_require__){"use strict";var defaults=__webpack_require__("./node_modules/chart.js/src/core/core.defaults.js"),helpers=__webpack_require__("./node_modules/chart.js/src/helpers/index.js"),Ticks=__webpack_require__("./node_modules/chart.js/src/core/core.ticks.js");module.exports=function(Chart){var defaultConfig={position:"left",ticks:{callback:Ticks.formatters.linear}},LinearScale=Chart.LinearScaleBase.extend({determineDataLimits:function(){var me=this,opts=me.options,chart=me.chart,datasets=chart.data.datasets,isHorizontal=me.isHorizontal();function IDMatches(meta){return isHorizontal?meta.xAxisID===me.id:meta.yAxisID===me.id}me.min=null,me.max=null;var hasStacks=opts.stacked;if(void 0===hasStacks&&helpers.each(datasets,function(dataset,datasetIndex){if(!hasStacks){var meta=chart.getDatasetMeta(datasetIndex);chart.isDatasetVisible(datasetIndex)&&IDMatches(meta)&&void 0!==meta.stack&&(hasStacks=!0)}}),opts.stacked||hasStacks){var valuesPerStack={};helpers.each(datasets,function(dataset,datasetIndex){var meta=chart.getDatasetMeta(datasetIndex),key=[meta.type,void 0===opts.stacked&&void 0===meta.stack?datasetIndex:"",meta.stack].join(".");void 0===valuesPerStack[key]&&(valuesPerStack[key]={positiveValues:[],negativeValues:[]});var positiveValues=valuesPerStack[key].positiveValues,negativeValues=valuesPerStack[key].negativeValues;chart.isDatasetVisible(datasetIndex)&&IDMatches(meta)&&helpers.each(dataset.data,function(rawValue,index){var value=+me.getRightValue(rawValue);isNaN(value)||meta.data[index].hidden||(positiveValues[index]=positiveValues[index]||0,negativeValues[index]=negativeValues[index]||0,opts.relativePoints?positiveValues[index]=100:value<0?negativeValues[index]+=value:positiveValues[index]+=value)})}),helpers.each(valuesPerStack,function(valuesForType){var values=valuesForType.positiveValues.concat(valuesForType.negativeValues),minVal=helpers.min(values),maxVal=helpers.max(values);me.min=null===me.min?minVal:Math.min(me.min,minVal),me.max=null===me.max?maxVal:Math.max(me.max,maxVal)})}else helpers.each(datasets,function(dataset,datasetIndex){var meta=chart.getDatasetMeta(datasetIndex);chart.isDatasetVisible(datasetIndex)&&IDMatches(meta)&&helpers.each(dataset.data,function(rawValue,index){var value=+me.getRightValue(rawValue);isNaN(value)||meta.data[index].hidden||(null===me.min?me.min=value:value<me.min&&(me.min=value),null===me.max?me.max=value:value>me.max&&(me.max=value))})});me.min=isFinite(me.min)&&!isNaN(me.min)?me.min:0,me.max=isFinite(me.max)&&!isNaN(me.max)?me.max:1,this.handleTickRangeOptions()},getTickLimit:function(){var maxTicks,tickOpts=this.options.ticks;if(this.isHorizontal())maxTicks=Math.min(tickOpts.maxTicksLimit?tickOpts.maxTicksLimit:11,Math.ceil(this.width/50));else{var tickFontSize=helpers.valueOrDefault(tickOpts.fontSize,defaults.global.defaultFontSize);maxTicks=Math.min(tickOpts.maxTicksLimit?tickOpts.maxTicksLimit:11,Math.ceil(this.height/(2*tickFontSize)))}return maxTicks},handleDirectionalChanges:function(){this.isHorizontal()||this.ticks.reverse()},getLabelForIndex:function(index,datasetIndex){return+this.getRightValue(this.chart.data.datasets[datasetIndex].data[index])},getPixelForValue:function(value){var me=this,start=me.start,rightValue=+me.getRightValue(value),range=me.end-start;return me.isHorizontal()?me.left+me.width/range*(rightValue-start):me.bottom-me.height/range*(rightValue-start)},getValueForPixel:function(pixel){var me=this,isHorizontal=me.isHorizontal(),innerDimension=isHorizontal?me.width:me.height,offset=(isHorizontal?pixel-me.left:me.bottom-pixel)/innerDimension;return me.start+(me.end-me.start)*offset},getPixelForTick:function(index){return this.getPixelForValue(this.ticksAsNumbers[index])}});Chart.scaleService.registerScaleType("linear",LinearScale,defaultConfig)}},"./node_modules/chart.js/src/scales/scale.linearbase.js":function(module,exports,__webpack_require__){"use strict";var helpers=__webpack_require__("./node_modules/chart.js/src/helpers/index.js");module.exports=function(Chart){var noop=helpers.noop;Chart.LinearScaleBase=Chart.Scale.extend({getRightValue:function(value){return"string"==typeof value?+value:Chart.Scale.prototype.getRightValue.call(this,value)},handleTickRangeOptions:function(){var me=this,tickOpts=me.options.ticks;if(tickOpts.beginAtZero){var minSign=helpers.sign(me.min),maxSign=helpers.sign(me.max);minSign<0&&maxSign<0?me.max=0:minSign>0&&maxSign>0&&(me.min=0)}var setMin=void 0!==tickOpts.min||void 0!==tickOpts.suggestedMin,setMax=void 0!==tickOpts.max||void 0!==tickOpts.suggestedMax;void 0!==tickOpts.min?me.min=tickOpts.min:void 0!==tickOpts.suggestedMin&&(null===me.min?me.min=tickOpts.suggestedMin:me.min=Math.min(me.min,tickOpts.suggestedMin)),void 0!==tickOpts.max?me.max=tickOpts.max:void 0!==tickOpts.suggestedMax&&(null===me.max?me.max=tickOpts.suggestedMax:me.max=Math.max(me.max,tickOpts.suggestedMax)),setMin!==setMax&&me.min>=me.max&&(setMin?me.max=me.min+1:me.min=me.max-1),me.min===me.max&&(me.max++,tickOpts.beginAtZero||me.min--)},getTickLimit:noop,handleDirectionalChanges:noop,buildTicks:function(){var me=this,tickOpts=me.options.ticks,maxTicks=me.getTickLimit(),numericGeneratorOptions={maxTicks:maxTicks=Math.max(2,maxTicks),min:tickOpts.min,max:tickOpts.max,stepSize:helpers.valueOrDefault(tickOpts.fixedStepSize,tickOpts.stepSize)},ticks=me.ticks=function(generationOptions,dataRange){var spacing,ticks=[];if(generationOptions.stepSize&&generationOptions.stepSize>0)spacing=generationOptions.stepSize;else{var niceRange=helpers.niceNum(dataRange.max-dataRange.min,!1);spacing=helpers.niceNum(niceRange/(generationOptions.maxTicks-1),!0)}var niceMin=Math.floor(dataRange.min/spacing)*spacing,niceMax=Math.ceil(dataRange.max/spacing)*spacing;generationOptions.min&&generationOptions.max&&generationOptions.stepSize&&helpers.almostWhole((generationOptions.max-generationOptions.min)/generationOptions.stepSize,spacing/1e3)&&(niceMin=generationOptions.min,niceMax=generationOptions.max);var numSpaces=(niceMax-niceMin)/spacing;numSpaces=helpers.almostEquals(numSpaces,Math.round(numSpaces),spacing/1e3)?Math.round(numSpaces):Math.ceil(numSpaces);var precision=1;spacing<1&&(precision=Math.pow(10,spacing.toString().length-2),niceMin=Math.round(niceMin*precision)/precision,niceMax=Math.round(niceMax*precision)/precision),ticks.push(void 0!==generationOptions.min?generationOptions.min:niceMin);for(var j=1;j<numSpaces;++j)ticks.push(Math.round((niceMin+j*spacing)*precision)/precision);return ticks.push(void 0!==generationOptions.max?generationOptions.max:niceMax),ticks}(numericGeneratorOptions,me);me.handleDirectionalChanges(),me.max=helpers.max(ticks),me.min=helpers.min(ticks),tickOpts.reverse?(ticks.reverse(),me.start=me.max,me.end=me.min):(me.start=me.min,me.end=me.max)},convertTicksToLabels:function(){var me=this;me.ticksAsNumbers=me.ticks.slice(),me.zeroLineIndex=me.ticks.indexOf(0),Chart.Scale.prototype.convertTicksToLabels.call(me)}})}},"./node_modules/chart.js/src/scales/scale.logarithmic.js":function(module,exports,__webpack_require__){"use strict";var helpers=__webpack_require__("./node_modules/chart.js/src/helpers/index.js"),Ticks=__webpack_require__("./node_modules/chart.js/src/core/core.ticks.js");module.exports=function(Chart){var defaultConfig={position:"left",ticks:{callback:Ticks.formatters.logarithmic}},LogarithmicScale=Chart.Scale.extend({determineDataLimits:function(){var me=this,opts=me.options,chart=me.chart,datasets=chart.data.datasets,isHorizontal=me.isHorizontal();function IDMatches(meta){return isHorizontal?meta.xAxisID===me.id:meta.yAxisID===me.id}me.min=null,me.max=null,me.minNotZero=null;var hasStacks=opts.stacked;if(void 0===hasStacks&&helpers.each(datasets,function(dataset,datasetIndex){if(!hasStacks){var meta=chart.getDatasetMeta(datasetIndex);chart.isDatasetVisible(datasetIndex)&&IDMatches(meta)&&void 0!==meta.stack&&(hasStacks=!0)}}),opts.stacked||hasStacks){var valuesPerStack={};helpers.each(datasets,function(dataset,datasetIndex){var meta=chart.getDatasetMeta(datasetIndex),key=[meta.type,void 0===opts.stacked&&void 0===meta.stack?datasetIndex:"",meta.stack].join(".");chart.isDatasetVisible(datasetIndex)&&IDMatches(meta)&&(void 0===valuesPerStack[key]&&(valuesPerStack[key]=[]),helpers.each(dataset.data,function(rawValue,index){var values=valuesPerStack[key],value=+me.getRightValue(rawValue);isNaN(value)||meta.data[index].hidden||value<0||(values[index]=values[index]||0,values[index]+=value)}))}),helpers.each(valuesPerStack,function(valuesForType){if(valuesForType.length>0){var minVal=helpers.min(valuesForType),maxVal=helpers.max(valuesForType);me.min=null===me.min?minVal:Math.min(me.min,minVal),me.max=null===me.max?maxVal:Math.max(me.max,maxVal)}})}else helpers.each(datasets,function(dataset,datasetIndex){var meta=chart.getDatasetMeta(datasetIndex);chart.isDatasetVisible(datasetIndex)&&IDMatches(meta)&&helpers.each(dataset.data,function(rawValue,index){var value=+me.getRightValue(rawValue);isNaN(value)||meta.data[index].hidden||value<0||(null===me.min?me.min=value:value<me.min&&(me.min=value),null===me.max?me.max=value:value>me.max&&(me.max=value),0!==value&&(null===me.minNotZero||value<me.minNotZero)&&(me.minNotZero=value))})});this.handleTickRangeOptions()},handleTickRangeOptions:function(){var me=this,tickOpts=me.options.ticks,valueOrDefault=helpers.valueOrDefault;me.min=valueOrDefault(tickOpts.min,me.min),me.max=valueOrDefault(tickOpts.max,me.max),me.min===me.max&&(0!==me.min&&null!==me.min?(me.min=Math.pow(10,Math.floor(helpers.log10(me.min))-1),me.max=Math.pow(10,Math.floor(helpers.log10(me.max))+1)):(me.min=1,me.max=10)),null===me.min&&(me.min=Math.pow(10,Math.floor(helpers.log10(me.max))-1)),null===me.max&&(me.max=0!==me.min?Math.pow(10,Math.floor(helpers.log10(me.min))+1):10),null===me.minNotZero&&(me.min>0?me.minNotZero=me.min:me.max<1?me.minNotZero=Math.pow(10,Math.floor(helpers.log10(me.max))):me.minNotZero=1)},buildTicks:function(){var me=this,tickOpts=me.options.ticks,reverse=!me.isHorizontal(),generationOptions={min:tickOpts.min,max:tickOpts.max},ticks=me.ticks=function(generationOptions,dataRange){var exp,significand,ticks=[],valueOrDefault=helpers.valueOrDefault,tickVal=valueOrDefault(generationOptions.min,Math.pow(10,Math.floor(helpers.log10(dataRange.min)))),endExp=Math.floor(helpers.log10(dataRange.max)),endSignificand=Math.ceil(dataRange.max/Math.pow(10,endExp));0===tickVal?(exp=Math.floor(helpers.log10(dataRange.minNotZero)),significand=Math.floor(dataRange.minNotZero/Math.pow(10,exp)),ticks.push(tickVal),tickVal=significand*Math.pow(10,exp)):(exp=Math.floor(helpers.log10(tickVal)),significand=Math.floor(tickVal/Math.pow(10,exp)));var precision=exp<0?Math.pow(10,Math.abs(exp)):1;do{ticks.push(tickVal),10==++significand&&(significand=1,precision=++exp>=0?1:precision),tickVal=Math.round(significand*Math.pow(10,exp)*precision)/precision}while(exp<endExp||exp===endExp&&significand<endSignificand);var lastTick=valueOrDefault(generationOptions.max,tickVal);return ticks.push(lastTick),ticks}(generationOptions,me);me.max=helpers.max(ticks),me.min=helpers.min(ticks),tickOpts.reverse?(reverse=!reverse,me.start=me.max,me.end=me.min):(me.start=me.min,me.end=me.max),reverse&&ticks.reverse()},convertTicksToLabels:function(){this.tickValues=this.ticks.slice(),Chart.Scale.prototype.convertTicksToLabels.call(this)},getLabelForIndex:function(index,datasetIndex){return+this.getRightValue(this.chart.data.datasets[datasetIndex].data[index])},getPixelForTick:function(index){return this.getPixelForValue(this.tickValues[index])},_getFirstTickValue:function(value){var exp=Math.floor(helpers.log10(value));return Math.floor(value/Math.pow(10,exp))*Math.pow(10,exp)},getPixelForValue:function(value){var innerDimension,pixel,start,end,sign,me=this,reverse=me.options.ticks.reverse,log10=helpers.log10,firstTickValue=me._getFirstTickValue(me.minNotZero),offset=0;return value=+me.getRightValue(value),reverse?(start=me.end,end=me.start,sign=-1):(start=me.start,end=me.end,sign=1),me.isHorizontal()?(innerDimension=me.width,pixel=reverse?me.right:me.left):(innerDimension=me.height,sign*=-1,pixel=reverse?me.top:me.bottom),value!==start&&(0===start&&(innerDimension-=offset=helpers.getValueOrDefault(me.options.ticks.fontSize,Chart.defaults.global.defaultFontSize),start=firstTickValue),0!==value&&(offset+=innerDimension/(log10(end)-log10(start))*(log10(value)-log10(start))),pixel+=sign*offset),pixel},getValueForPixel:function(pixel){var innerDimension,start,end,value,me=this,reverse=me.options.ticks.reverse,log10=helpers.log10,firstTickValue=me._getFirstTickValue(me.minNotZero);if(reverse?(start=me.end,end=me.start):(start=me.start,end=me.end),me.isHorizontal()?(innerDimension=me.width,value=reverse?me.right-pixel:pixel-me.left):(innerDimension=me.height,value=reverse?pixel-me.top:me.bottom-pixel),value!==start){if(0===start){var offset=helpers.getValueOrDefault(me.options.ticks.fontSize,Chart.defaults.global.defaultFontSize);value-=offset,innerDimension-=offset,start=firstTickValue}value*=log10(end)-log10(start),value/=innerDimension,value=Math.pow(10,log10(start)+value)}return value}});Chart.scaleService.registerScaleType("logarithmic",LogarithmicScale,defaultConfig)}},"./node_modules/chart.js/src/scales/scale.radialLinear.js":function(module,exports,__webpack_require__){"use strict";var defaults=__webpack_require__("./node_modules/chart.js/src/core/core.defaults.js"),helpers=__webpack_require__("./node_modules/chart.js/src/helpers/index.js"),Ticks=__webpack_require__("./node_modules/chart.js/src/core/core.ticks.js");module.exports=function(Chart){var globalDefaults=defaults.global,defaultConfig={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,color:"rgba(0, 0, 0, 0.1)",lineWidth:1},gridLines:{circular:!1},ticks:{showLabelBackdrop:!0,backdropColor:"rgba(255,255,255,0.75)",backdropPaddingY:2,backdropPaddingX:2,callback:Ticks.formatters.linear},pointLabels:{display:!0,fontSize:10,callback:function(label){return label}}};function getValueCount(scale){var opts=scale.options;return opts.angleLines.display||opts.pointLabels.display?scale.chart.data.labels.length:0}function getPointLabelFontOptions(scale){var pointLabelOptions=scale.options.pointLabels,fontSize=helpers.valueOrDefault(pointLabelOptions.fontSize,globalDefaults.defaultFontSize),fontStyle=helpers.valueOrDefault(pointLabelOptions.fontStyle,globalDefaults.defaultFontStyle),fontFamily=helpers.valueOrDefault(pointLabelOptions.fontFamily,globalDefaults.defaultFontFamily);return{size:fontSize,style:fontStyle,family:fontFamily,font:helpers.fontString(fontSize,fontStyle,fontFamily)}}function determineLimits(angle,pos,size,min,max){return angle===min||angle===max?{start:pos-size/2,end:pos+size/2}:angle<min||angle>max?{start:pos-size-5,end:pos}:{start:pos,end:pos+size+5}}function getTextAlignForAngle(angle){return 0===angle||180===angle?"center":angle<180?"left":"right"}function fillText(ctx,text,position,fontSize){if(helpers.isArray(text))for(var y=position.y,spacing=1.5*fontSize,i=0;i<text.length;++i)ctx.fillText(text[i],position.x,y),y+=spacing;else ctx.fillText(text,position.x,position.y)}function adjustPointPositionForLabelHeight(angle,textSize,position){90===angle||270===angle?position.y-=textSize.h/2:(angle>270||angle<90)&&(position.y-=textSize.h)}function numberOrZero(param){return helpers.isNumber(param)?param:0}var LinearRadialScale=Chart.LinearScaleBase.extend({setDimensions:function(){var me=this,opts=me.options,tickOpts=opts.ticks;me.width=me.maxWidth,me.height=me.maxHeight,me.xCenter=Math.round(me.width/2),me.yCenter=Math.round(me.height/2);var minSize=helpers.min([me.height,me.width]),tickFontSize=helpers.valueOrDefault(tickOpts.fontSize,globalDefaults.defaultFontSize);me.drawingArea=opts.display?minSize/2-(tickFontSize/2+tickOpts.backdropPaddingY):minSize/2},determineDataLimits:function(){var me=this,chart=me.chart,min=Number.POSITIVE_INFINITY,max=Number.NEGATIVE_INFINITY;helpers.each(chart.data.datasets,function(dataset,datasetIndex){if(chart.isDatasetVisible(datasetIndex)){var meta=chart.getDatasetMeta(datasetIndex);helpers.each(dataset.data,function(rawValue,index){var value=+me.getRightValue(rawValue);isNaN(value)||meta.data[index].hidden||(min=Math.min(value,min),max=Math.max(value,max))})}}),me.min=min===Number.POSITIVE_INFINITY?0:min,me.max=max===Number.NEGATIVE_INFINITY?0:max,me.handleTickRangeOptions()},getTickLimit:function(){var tickOpts=this.options.ticks,tickFontSize=helpers.valueOrDefault(tickOpts.fontSize,globalDefaults.defaultFontSize);return Math.min(tickOpts.maxTicksLimit?tickOpts.maxTicksLimit:11,Math.ceil(this.drawingArea/(1.5*tickFontSize)))},convertTicksToLabels:function(){var me=this;Chart.LinearScaleBase.prototype.convertTicksToLabels.call(me),me.pointLabels=me.chart.data.labels.map(me.options.pointLabels.callback,me)},getLabelForIndex:function(index,datasetIndex){return+this.getRightValue(this.chart.data.datasets[datasetIndex].data[index])},fit:function(){var scale,largestPossibleRadius;this.options.pointLabels.display?function(scale){var i,textSize,pointPosition,plFont=getPointLabelFontOptions(scale),largestPossibleRadius=Math.min(scale.height/2,scale.width/2),furthestLimits={r:scale.width,l:0,t:scale.height,b:0},furthestAngles={};scale.ctx.font=plFont.font,scale._pointLabelSizes=[];var ctx,fontSize,label,valueCount=getValueCount(scale);for(i=0;i<valueCount;i++){pointPosition=scale.getPointPosition(i,largestPossibleRadius),ctx=scale.ctx,fontSize=plFont.size,label=scale.pointLabels[i]||"",textSize=helpers.isArray(label)?{w:helpers.longestText(ctx,ctx.font,label),h:label.length*fontSize+1.5*(label.length-1)*fontSize}:{w:ctx.measureText(label).width,h:fontSize},scale._pointLabelSizes[i]=textSize;var angleRadians=scale.getIndexAngle(i),angle=helpers.toDegrees(angleRadians)%360,hLimits=determineLimits(angle,pointPosition.x,textSize.w,0,180),vLimits=determineLimits(angle,pointPosition.y,textSize.h,90,270);hLimits.start<furthestLimits.l&&(furthestLimits.l=hLimits.start,furthestAngles.l=angleRadians),hLimits.end>furthestLimits.r&&(furthestLimits.r=hLimits.end,furthestAngles.r=angleRadians),vLimits.start<furthestLimits.t&&(furthestLimits.t=vLimits.start,furthestAngles.t=angleRadians),vLimits.end>furthestLimits.b&&(furthestLimits.b=vLimits.end,furthestAngles.b=angleRadians)}scale.setReductions(largestPossibleRadius,furthestLimits,furthestAngles)}(this):(scale=this,largestPossibleRadius=Math.min(scale.height/2,scale.width/2),scale.drawingArea=Math.round(largestPossibleRadius),scale.setCenterPoint(0,0,0,0))},setReductions:function(largestPossibleRadius,furthestLimits,furthestAngles){var radiusReductionLeft=furthestLimits.l/Math.sin(furthestAngles.l),radiusReductionRight=Math.max(furthestLimits.r-this.width,0)/Math.sin(furthestAngles.r),radiusReductionTop=-furthestLimits.t/Math.cos(furthestAngles.t),radiusReductionBottom=-Math.max(furthestLimits.b-this.height,0)/Math.cos(furthestAngles.b);radiusReductionLeft=numberOrZero(radiusReductionLeft),radiusReductionRight=numberOrZero(radiusReductionRight),radiusReductionTop=numberOrZero(radiusReductionTop),radiusReductionBottom=numberOrZero(radiusReductionBottom),this.drawingArea=Math.min(Math.round(largestPossibleRadius-(radiusReductionLeft+radiusReductionRight)/2),Math.round(largestPossibleRadius-(radiusReductionTop+radiusReductionBottom)/2)),this.setCenterPoint(radiusReductionLeft,radiusReductionRight,radiusReductionTop,radiusReductionBottom)},setCenterPoint:function(leftMovement,rightMovement,topMovement,bottomMovement){var me=this,maxRight=me.width-rightMovement-me.drawingArea,maxLeft=leftMovement+me.drawingArea,maxTop=topMovement+me.drawingArea,maxBottom=me.height-bottomMovement-me.drawingArea;me.xCenter=Math.round((maxLeft+maxRight)/2+me.left),me.yCenter=Math.round((maxTop+maxBottom)/2+me.top)},getIndexAngle:function(index){return index*(2*Math.PI/getValueCount(this))+(this.chart.options&&this.chart.options.startAngle?this.chart.options.startAngle:0)*Math.PI*2/360},getDistanceFromCenterForValue:function(value){var me=this;if(null===value)return 0;var scalingFactor=me.drawingArea/(me.max-me.min);return me.options.ticks.reverse?(me.max-value)*scalingFactor:(value-me.min)*scalingFactor},getPointPosition:function(index,distanceFromCenter){var thisAngle=this.getIndexAngle(index)-Math.PI/2;return{x:Math.round(Math.cos(thisAngle)*distanceFromCenter)+this.xCenter,y:Math.round(Math.sin(thisAngle)*distanceFromCenter)+this.yCenter}},getPointPositionForValue:function(index,value){return this.getPointPosition(index,this.getDistanceFromCenterForValue(value))},getBasePosition:function(){var min=this.min,max=this.max;return this.getPointPositionForValue(0,this.beginAtZero?0:min<0&&max<0?max:min>0&&max>0?min:0)},draw:function(){var me=this,opts=me.options,gridLineOpts=opts.gridLines,tickOpts=opts.ticks,valueOrDefault=helpers.valueOrDefault;if(opts.display){var ctx=me.ctx,startAngle=this.getIndexAngle(0),tickFontSize=valueOrDefault(tickOpts.fontSize,globalDefaults.defaultFontSize),tickFontStyle=valueOrDefault(tickOpts.fontStyle,globalDefaults.defaultFontStyle),tickFontFamily=valueOrDefault(tickOpts.fontFamily,globalDefaults.defaultFontFamily),tickLabelFont=helpers.fontString(tickFontSize,tickFontStyle,tickFontFamily);helpers.each(me.ticks,function(label,index){if(index>0||tickOpts.reverse){var yCenterOffset=me.getDistanceFromCenterForValue(me.ticksAsNumbers[index]);if(gridLineOpts.display&&0!==index&&function(scale,gridLineOpts,radius,index){var ctx=scale.ctx;if(ctx.strokeStyle=helpers.valueAtIndexOrDefault(gridLineOpts.color,index-1),ctx.lineWidth=helpers.valueAtIndexOrDefault(gridLineOpts.lineWidth,index-1),scale.options.gridLines.circular)ctx.beginPath(),ctx.arc(scale.xCenter,scale.yCenter,radius,0,2*Math.PI),ctx.closePath(),ctx.stroke();else{var valueCount=getValueCount(scale);if(0===valueCount)return;ctx.beginPath();var pointPosition=scale.getPointPosition(0,radius);ctx.moveTo(pointPosition.x,pointPosition.y);for(var i=1;i<valueCount;i++)pointPosition=scale.getPointPosition(i,radius),ctx.lineTo(pointPosition.x,pointPosition.y);ctx.closePath(),ctx.stroke()}}(me,gridLineOpts,yCenterOffset,index),tickOpts.display){var tickFontColor=valueOrDefault(tickOpts.fontColor,globalDefaults.defaultFontColor);if(ctx.font=tickLabelFont,ctx.save(),ctx.translate(me.xCenter,me.yCenter),ctx.rotate(startAngle),tickOpts.showLabelBackdrop){var labelWidth=ctx.measureText(label).width;ctx.fillStyle=tickOpts.backdropColor,ctx.fillRect(-labelWidth/2-tickOpts.backdropPaddingX,-yCenterOffset-tickFontSize/2-tickOpts.backdropPaddingY,labelWidth+2*tickOpts.backdropPaddingX,tickFontSize+2*tickOpts.backdropPaddingY)}ctx.textAlign="center",ctx.textBaseline="middle",ctx.fillStyle=tickFontColor,ctx.fillText(label,0,-yCenterOffset),ctx.restore()}}}),(opts.angleLines.display||opts.pointLabels.display)&&function(scale){var ctx=scale.ctx,opts=scale.options,angleLineOpts=opts.angleLines,pointLabelOpts=opts.pointLabels;ctx.lineWidth=angleLineOpts.lineWidth,ctx.strokeStyle=angleLineOpts.color;var outerDistance=scale.getDistanceFromCenterForValue(opts.ticks.reverse?scale.min:scale.max),plFont=getPointLabelFontOptions(scale);ctx.textBaseline="top";for(var i=getValueCount(scale)-1;i>=0;i--){if(angleLineOpts.display){var outerPosition=scale.getPointPosition(i,outerDistance);ctx.beginPath(),ctx.moveTo(scale.xCenter,scale.yCenter),ctx.lineTo(outerPosition.x,outerPosition.y),ctx.stroke(),ctx.closePath()}if(pointLabelOpts.display){var pointLabelPosition=scale.getPointPosition(i,outerDistance+5),pointLabelFontColor=helpers.valueAtIndexOrDefault(pointLabelOpts.fontColor,i,globalDefaults.defaultFontColor);ctx.font=plFont.font,ctx.fillStyle=pointLabelFontColor;var angleRadians=scale.getIndexAngle(i),angle=helpers.toDegrees(angleRadians);ctx.textAlign=getTextAlignForAngle(angle),adjustPointPositionForLabelHeight(angle,scale._pointLabelSizes[i],pointLabelPosition),fillText(ctx,scale.pointLabels[i]||"",pointLabelPosition,plFont.size)}}}(me)}}});Chart.scaleService.registerScaleType("radialLinear",LinearRadialScale,defaultConfig)}},"./node_modules/chart.js/src/scales/scale.time.js":function(module,exports,__webpack_require__){"use strict";var moment=__webpack_require__("./node_modules/moment/moment.js");moment="function"==typeof moment?moment:window.moment;var defaults=__webpack_require__("./node_modules/chart.js/src/core/core.defaults.js"),helpers=__webpack_require__("./node_modules/chart.js/src/helpers/index.js"),MIN_INTEGER=Number.MIN_SAFE_INTEGER||-9007199254740991,MAX_INTEGER=Number.MAX_SAFE_INTEGER||9007199254740991,INTERVALS={millisecond:{common:!0,size:1,steps:[1,2,5,10,20,50,100,250,500]},second:{common:!0,size:1e3,steps:[1,2,5,10,30]},minute:{common:!0,size:6e4,steps:[1,2,5,10,30]},hour:{common:!0,size:36e5,steps:[1,2,3,6,12]},day:{common:!0,size:864e5,steps:[1,2,5]},week:{common:!1,size:6048e5,steps:[1,2,3,4]},month:{common:!0,size:2628e6,steps:[1,2,3]},quarter:{common:!1,size:7884e6,steps:[1,2,3,4]},year:{common:!0,size:3154e7}},UNITS=Object.keys(INTERVALS);function sorter(a,b){return a-b}function arrayUnique(items){var i,ilen,item,hash={},out=[];for(i=0,ilen=items.length;i<ilen;++i)hash[item=items[i]]||(hash[item]=!0,out.push(item));return out}function interpolate(table,skey,sval,tkey){var range=function(table,key,value){for(var mid,i0,i1,lo=0,hi=table.length-1;lo>=0&&lo<=hi;){if(i0=table[(mid=lo+hi>>1)-1]||null,i1=table[mid],!i0)return{lo:null,hi:i1};if(i1[key]<value)lo=mid+1;else{if(!(i0[key]>value))return{lo:i0,hi:i1};hi=mid-1}}return{lo:i1,hi:null}}(table,skey,sval),prev=range.lo?range.hi?range.lo:table[table.length-2]:table[0],next=range.lo?range.hi?range.hi:table[table.length-1]:table[1],span=next[skey]-prev[skey],ratio=span?(sval-prev[skey])/span:0,offset=(next[tkey]-prev[tkey])*ratio;return prev[tkey]+offset}function momentify(value,options){var parser=options.parser,format=options.parser||options.format;return"function"==typeof parser?parser(value):"string"==typeof value&&"string"==typeof format?moment(value,format):(value instanceof moment||(value=moment(value)),value.isValid()?value:"function"==typeof format?format(value):value)}function parse(input,scale){if(helpers.isNullOrUndef(input))return null;var options=scale.options.time,value=momentify(scale.getRightValue(input),options);return value.isValid()?(options.round&&value.startOf(options.round),value.valueOf()):null}function determineMajorUnit(unit){for(var i=UNITS.indexOf(unit)+1,ilen=UNITS.length;i<ilen;++i)if(INTERVALS[UNITS[i]].common)return UNITS[i]}function generate(min,max,capacity,options){var time,timeOpts=options.time,minor=timeOpts.unit||function(minUnit,min,max,capacity){var i,interval,factor,ilen=UNITS.length;for(i=UNITS.indexOf(minUnit);i<ilen-1;++i)if(factor=(interval=INTERVALS[UNITS[i]]).steps?interval.steps[interval.steps.length-1]:MAX_INTEGER,interval.common&&Math.ceil((max-min)/(factor*interval.size))<=capacity)return UNITS[i];return UNITS[ilen-1]}(timeOpts.minUnit,min,max,capacity),major=determineMajorUnit(minor),stepSize=helpers.valueOrDefault(timeOpts.stepSize,timeOpts.unitStepSize),weekday="week"===minor&&timeOpts.isoWeekday,majorTicksEnabled=options.ticks.major.enabled,interval=INTERVALS[minor],first=moment(min),last=moment(max),ticks=[];for(stepSize||(stepSize=function(min,max,unit,capacity){var i,ilen,factor,range=max-min,interval=INTERVALS[unit],milliseconds=interval.size,steps=interval.steps;if(!steps)return Math.ceil(range/(capacity*milliseconds));for(i=0,ilen=steps.length;i<ilen&&(factor=steps[i],!(Math.ceil(range/(milliseconds*factor))<=capacity));++i);return factor}(min,max,minor,capacity)),weekday&&(first=first.isoWeekday(weekday),last=last.isoWeekday(weekday)),first=first.startOf(weekday?"day":minor),(last=last.startOf(weekday?"day":minor))<max&&last.add(1,minor),time=moment(first),majorTicksEnabled&&major&&!weekday&&!timeOpts.round&&(time.startOf(major),time.add(~~((first-time)/(interval.size*stepSize))*stepSize,minor));time<last;time.add(stepSize,minor))ticks.push(+time);return ticks.push(+time),ticks}module.exports=function(Chart){var TimeScale=Chart.Scale.extend({initialize:function(){if(!moment)throw new Error("Chart.js - Moment.js could not be found! You must include it before Chart.js to use the time scale. Download at https://momentjs.com");this.mergeTicksOptions(),Chart.Scale.prototype.initialize.call(this)},update:function(){var options=this.options;return options.time&&options.time.format&&console.warn("options.time.format is deprecated and replaced by options.time.parser."),Chart.Scale.prototype.update.apply(this,arguments)},getRightValue:function(rawValue){return rawValue&&void 0!==rawValue.t&&(rawValue=rawValue.t),Chart.Scale.prototype.getRightValue.call(this,rawValue)},determineDataLimits:function(){var i,j,ilen,jlen,data,timestamp,me=this,chart=me.chart,timeOpts=me.options.time,unit=timeOpts.unit||"day",min=MAX_INTEGER,max=MIN_INTEGER,timestamps=[],datasets=[],labels=[];for(i=0,ilen=chart.data.labels.length;i<ilen;++i)labels.push(parse(chart.data.labels[i],me));for(i=0,ilen=(chart.data.datasets||[]).length;i<ilen;++i)if(chart.isDatasetVisible(i))if(data=chart.data.datasets[i].data,helpers.isObject(data[0]))for(datasets[i]=[],j=0,jlen=data.length;j<jlen;++j)timestamp=parse(data[j],me),timestamps.push(timestamp),datasets[i][j]=timestamp;else timestamps.push.apply(timestamps,labels),datasets[i]=labels.slice(0);else datasets[i]=[];labels.length&&(labels=arrayUnique(labels).sort(sorter),min=Math.min(min,labels[0]),max=Math.max(max,labels[labels.length-1])),timestamps.length&&(timestamps=arrayUnique(timestamps).sort(sorter),min=Math.min(min,timestamps[0]),max=Math.max(max,timestamps[timestamps.length-1])),min=parse(timeOpts.min,me)||min,max=parse(timeOpts.max,me)||max,min=min===MAX_INTEGER?+moment().startOf(unit):min,max=max===MIN_INTEGER?+moment().endOf(unit)+1:max,me.min=Math.min(min,max),me.max=Math.max(min+1,max),me._horizontal=me.isHorizontal(),me._table=[],me._timestamps={data:timestamps,datasets:datasets,labels:labels}},buildTicks:function(){var i,ilen,timestamp,me=this,min=me.min,max=me.max,options=me.options,timeOpts=options.time,timestamps=[],ticks=[];switch(options.ticks.source){case"data":timestamps=me._timestamps.data;break;case"labels":timestamps=me._timestamps.labels;break;case"auto":default:timestamps=generate(min,max,me.getLabelCapacity(min),options)}for("ticks"===options.bounds&&timestamps.length&&(min=timestamps[0],max=timestamps[timestamps.length-1]),min=parse(timeOpts.min,me)||min,max=parse(timeOpts.max,me)||max,i=0,ilen=timestamps.length;i<ilen;++i)(timestamp=timestamps[i])>=min&&timestamp<=max&&ticks.push(timestamp);return me.min=min,me.max=max,me._unit=timeOpts.unit||function(ticks,minUnit,min,max){var i,unit,duration=moment.duration(moment(max).diff(moment(min)));for(i=UNITS.length-1;i>=UNITS.indexOf(minUnit);i--)if(unit=UNITS[i],INTERVALS[unit].common&&duration.as(unit)>=ticks.length)return unit;return UNITS[minUnit?UNITS.indexOf(minUnit):0]}(ticks,timeOpts.minUnit,me.min,me.max),me._majorUnit=determineMajorUnit(me._unit),me._table=function(timestamps,min,max,distribution){if("linear"===distribution||!timestamps.length)return[{time:min,pos:0},{time:max,pos:1}];var i,ilen,prev,curr,next,table=[],items=[min];for(i=0,ilen=timestamps.length;i<ilen;++i)(curr=timestamps[i])>min&&curr<max&&items.push(curr);for(items.push(max),i=0,ilen=items.length;i<ilen;++i)next=items[i+1],prev=items[i-1],curr=items[i],void 0!==prev&&void 0!==next&&Math.round((next+prev)/2)===curr||table.push({time:curr,pos:i/(ilen-1)});return table}(me._timestamps.data,min,max,options.distribution),me._offsets=function(table,ticks,min,max,options){var upper,lower,left=0,right=0;return options.offset&&ticks.length&&(options.time.min||(upper=ticks.length>1?ticks[1]:max,lower=ticks[0],left=(interpolate(table,"time",upper,"pos")-interpolate(table,"time",lower,"pos"))/2),options.time.max||(upper=ticks[ticks.length-1],lower=ticks.length>1?ticks[ticks.length-2]:min,right=(interpolate(table,"time",upper,"pos")-interpolate(table,"time",lower,"pos"))/2)),{left:left,right:right}}(me._table,ticks,min,max,options),me._labelFormat=function(data,timeOpts){var i,momentDate,hasTime,ilen=data.length;for(i=0;i<ilen;i++){if(0!==(momentDate=momentify(data[i],timeOpts)).millisecond())return"MMM D, YYYY h:mm:ss.SSS a";0===momentDate.second()&&0===momentDate.minute()&&0===momentDate.hour()||(hasTime=!0)}return hasTime?"MMM D, YYYY h:mm:ss a":"MMM D, YYYY"}(me._timestamps.data,timeOpts),function(values,majorUnit){var i,ilen,value,major,ticks=[];for(i=0,ilen=values.length;i<ilen;++i)value=values[i],major=!!majorUnit&&value===+moment(value).startOf(majorUnit),ticks.push({value:value,major:major});return ticks}(ticks,me._majorUnit)},getLabelForIndex:function(index,datasetIndex){var data=this.chart.data,timeOpts=this.options.time,label=data.labels&&index<data.labels.length?data.labels[index]:"",value=data.datasets[datasetIndex].data[index];return helpers.isObject(value)&&(label=this.getRightValue(value)),timeOpts.tooltipFormat?momentify(label,timeOpts).format(timeOpts.tooltipFormat):"string"==typeof label?label:momentify(label,timeOpts).format(this._labelFormat)},tickFormatFunction:function(tick,index,ticks,formatOverride){var options=this.options,time=tick.valueOf(),formats=options.time.displayFormats,minorFormat=formats[this._unit],majorUnit=this._majorUnit,majorFormat=formats[majorUnit],majorTime=tick.clone().startOf(majorUnit).valueOf(),majorTickOpts=options.ticks.major,major=majorTickOpts.enabled&&majorUnit&&majorFormat&&time===majorTime,label=tick.format(formatOverride||(major?majorFormat:minorFormat)),tickOpts=major?majorTickOpts:options.ticks.minor,formatter=helpers.valueOrDefault(tickOpts.callback,tickOpts.userCallback);return formatter?formatter(label,index,ticks):label},convertTicksToLabels:function(ticks){var i,ilen,labels=[];for(i=0,ilen=ticks.length;i<ilen;++i)labels.push(this.tickFormatFunction(moment(ticks[i].value),i,ticks));return labels},getPixelForOffset:function(time){var me=this,size=me._horizontal?me.width:me.height,start=me._horizontal?me.left:me.top,pos=interpolate(me._table,"time",time,"pos");return start+size*(me._offsets.left+pos)/(me._offsets.left+1+me._offsets.right)},getPixelForValue:function(value,index,datasetIndex){var time=null;if(void 0!==index&&void 0!==datasetIndex&&(time=this._timestamps.datasets[datasetIndex][index]),null===time&&(time=parse(value,this)),null!==time)return this.getPixelForOffset(time)},getPixelForTick:function(index){var ticks=this.getTicks();return index>=0&&index<ticks.length?this.getPixelForOffset(ticks[index].value):null},getValueForPixel:function(pixel){var me=this,size=me._horizontal?me.width:me.height,start=me._horizontal?me.left:me.top,pos=(size?(pixel-start)/size:0)*(me._offsets.left+1+me._offsets.left)-me._offsets.right,time=interpolate(me._table,"pos",pos,"time");return moment(time)},getLabelWidth:function(label){var ticksOpts=this.options.ticks,tickLabelWidth=this.ctx.measureText(label).width,angle=helpers.toRadians(ticksOpts.maxRotation),cosRotation=Math.cos(angle),sinRotation=Math.sin(angle);return tickLabelWidth*cosRotation+helpers.valueOrDefault(ticksOpts.fontSize,defaults.global.defaultFontSize)*sinRotation},getLabelCapacity:function(exampleTime){var me=this,formatOverride=me.options.time.displayFormats.millisecond,exampleLabel=me.tickFormatFunction(moment(exampleTime),0,[],formatOverride),tickLabelWidth=me.getLabelWidth(exampleLabel),innerWidth=me.isHorizontal()?me.width:me.height,capacity=Math.floor(innerWidth/tickLabelWidth);return capacity>0?capacity:1}});Chart.scaleService.registerScaleType("time",TimeScale,{position:"bottom",distribution:"linear",bounds:"data",time:{parser:!1,format:!1,unit:!1,round:!1,displayFormat:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{millisecond:"h:mm:ss.SSS a",second:"h:mm:ss a",minute:"h:mm a",hour:"hA",day:"MMM D",week:"ll",month:"MMM YYYY",quarter:"[Q]Q - YYYY",year:"YYYY"}},ticks:{autoSkip:!1,source:"auto",major:{enabled:!1}}})}},"./node_modules/chartjs-color-string/color-string.js":function(module,exports,__webpack_require__){var colorNames=__webpack_require__("./node_modules/color-name/index.js");function getRgba(string){if(string){var rgb=[0,0,0],a=1,match=string.match(/^#([a-fA-F0-9]{3})$/i);if(match){match=match[1];for(var i=0;i<rgb.length;i++)rgb[i]=parseInt(match[i]+match[i],16)}else if(match=string.match(/^#([a-fA-F0-9]{6})$/i)){match=match[1];for(i=0;i<rgb.length;i++)rgb[i]=parseInt(match.slice(2*i,2*i+2),16)}else if(match=string.match(/^rgba?\(\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/i)){for(i=0;i<rgb.length;i++)rgb[i]=parseInt(match[i+1]);a=parseFloat(match[4])}else if(match=string.match(/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/i)){for(i=0;i<rgb.length;i++)rgb[i]=Math.round(2.55*parseFloat(match[i+1]));a=parseFloat(match[4])}else if(match=string.match(/(\w+)/)){if("transparent"==match[1])return[0,0,0,0];if(!(rgb=colorNames[match[1]]))return}for(i=0;i<rgb.length;i++)rgb[i]=scale(rgb[i],0,255);return a=a||0==a?scale(a,0,1):1,rgb[3]=a,rgb}}function getHsla(string){if(string){var match=string.match(/^hsla?\(\s*([+-]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)/);if(match){var alpha=parseFloat(match[4]);return[scale(parseInt(match[1]),0,360),scale(parseFloat(match[2]),0,100),scale(parseFloat(match[3]),0,100),scale(isNaN(alpha)?1:alpha,0,1)]}}}function getHwb(string){if(string){var match=string.match(/^hwb\(\s*([+-]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)/);if(match){var alpha=parseFloat(match[4]);return[scale(parseInt(match[1]),0,360),scale(parseFloat(match[2]),0,100),scale(parseFloat(match[3]),0,100),scale(isNaN(alpha)?1:alpha,0,1)]}}}function rgbaString(rgba,alpha){return void 0===alpha&&(alpha=void 0!==rgba[3]?rgba[3]:1),"rgba("+rgba[0]+", "+rgba[1]+", "+rgba[2]+", "+alpha+")"}function percentaString(rgba,alpha){return"rgba("+Math.round(rgba[0]/255*100)+"%, "+Math.round(rgba[1]/255*100)+"%, "+Math.round(rgba[2]/255*100)+"%, "+(alpha||rgba[3]||1)+")"}function hslaString(hsla,alpha){return void 0===alpha&&(alpha=void 0!==hsla[3]?hsla[3]:1),"hsla("+hsla[0]+", "+hsla[1]+"%, "+hsla[2]+"%, "+alpha+")"}function scale(num,min,max){return Math.min(Math.max(min,num),max)}function hexDouble(num){var str=num.toString(16).toUpperCase();return str.length<2?"0"+str:str}module.exports={getRgba:getRgba,getHsla:getHsla,getRgb:function(string){var rgba=getRgba(string);return rgba&&rgba.slice(0,3)},getHsl:function(string){var hsla=getHsla(string);return hsla&&hsla.slice(0,3)},getHwb:getHwb,getAlpha:function(string){var vals=getRgba(string);if(vals)return vals[3];if(vals=getHsla(string))return vals[3];if(vals=getHwb(string))return vals[3]},hexString:function(rgb){return"#"+hexDouble(rgb[0])+hexDouble(rgb[1])+hexDouble(rgb[2])},rgbString:function(rgba,alpha){if(alpha<1||rgba[3]&&rgba[3]<1)return rgbaString(rgba,alpha);return"rgb("+rgba[0]+", "+rgba[1]+", "+rgba[2]+")"},rgbaString:rgbaString,percentString:function(rgba,alpha){if(alpha<1||rgba[3]&&rgba[3]<1)return percentaString(rgba,alpha);var r=Math.round(rgba[0]/255*100),g=Math.round(rgba[1]/255*100),b=Math.round(rgba[2]/255*100);return"rgb("+r+"%, "+g+"%, "+b+"%)"},percentaString:percentaString,hslString:function(hsla,alpha){if(alpha<1||hsla[3]&&hsla[3]<1)return hslaString(hsla,alpha);return"hsl("+hsla[0]+", "+hsla[1]+"%, "+hsla[2]+"%)"},hslaString:hslaString,hwbString:function(hwb,alpha){void 0===alpha&&(alpha=void 0!==hwb[3]?hwb[3]:1);return"hwb("+hwb[0]+", "+hwb[1]+"%, "+hwb[2]+"%"+(void 0!==alpha&&1!==alpha?", "+alpha:"")+")"},keyword:function(rgb){return reverseNames[rgb.slice(0,3)]}};var reverseNames={};for(var name in colorNames)reverseNames[colorNames[name]]=name},"./node_modules/chartjs-color/index.js":function(module,exports,__webpack_require__){var convert=__webpack_require__("./node_modules/color-convert/index.js"),string=__webpack_require__("./node_modules/chartjs-color-string/color-string.js"),Color=function(obj){return obj instanceof Color?obj:this instanceof Color?(this.valid=!1,this.values={rgb:[0,0,0],hsl:[0,0,0],hsv:[0,0,0],hwb:[0,0,0],cmyk:[0,0,0,0],alpha:1},void("string"==typeof obj?(vals=string.getRgba(obj))?this.setValues("rgb",vals):(vals=string.getHsla(obj))?this.setValues("hsl",vals):(vals=string.getHwb(obj))&&this.setValues("hwb",vals):"object"==typeof obj&&(void 0!==(vals=obj).r||void 0!==vals.red?this.setValues("rgb",vals):void 0!==vals.l||void 0!==vals.lightness?this.setValues("hsl",vals):void 0!==vals.v||void 0!==vals.value?this.setValues("hsv",vals):void 0!==vals.w||void 0!==vals.whiteness?this.setValues("hwb",vals):void 0===vals.c&&void 0===vals.cyan||this.setValues("cmyk",vals)))):new Color(obj);var vals};Color.prototype={isValid:function(){return this.valid},rgb:function(){return this.setSpace("rgb",arguments)},hsl:function(){return this.setSpace("hsl",arguments)},hsv:function(){return this.setSpace("hsv",arguments)},hwb:function(){return this.setSpace("hwb",arguments)},cmyk:function(){return this.setSpace("cmyk",arguments)},rgbArray:function(){return this.values.rgb},hslArray:function(){return this.values.hsl},hsvArray:function(){return this.values.hsv},hwbArray:function(){var values=this.values;return 1!==values.alpha?values.hwb.concat([values.alpha]):values.hwb},cmykArray:function(){return this.values.cmyk},rgbaArray:function(){var values=this.values;return values.rgb.concat([values.alpha])},hslaArray:function(){var values=this.values;return values.hsl.concat([values.alpha])},alpha:function(val){return void 0===val?this.values.alpha:(this.setValues("alpha",val),this)},red:function(val){return this.setChannel("rgb",0,val)},green:function(val){return this.setChannel("rgb",1,val)},blue:function(val){return this.setChannel("rgb",2,val)},hue:function(val){return val&&(val=(val%=360)<0?360+val:val),this.setChannel("hsl",0,val)},saturation:function(val){return this.setChannel("hsl",1,val)},lightness:function(val){return this.setChannel("hsl",2,val)},saturationv:function(val){return this.setChannel("hsv",1,val)},whiteness:function(val){return this.setChannel("hwb",1,val)},blackness:function(val){return this.setChannel("hwb",2,val)},value:function(val){return this.setChannel("hsv",2,val)},cyan:function(val){return this.setChannel("cmyk",0,val)},magenta:function(val){return this.setChannel("cmyk",1,val)},yellow:function(val){return this.setChannel("cmyk",2,val)},black:function(val){return this.setChannel("cmyk",3,val)},hexString:function(){return string.hexString(this.values.rgb)},rgbString:function(){return string.rgbString(this.values.rgb,this.values.alpha)},rgbaString:function(){return string.rgbaString(this.values.rgb,this.values.alpha)},percentString:function(){return string.percentString(this.values.rgb,this.values.alpha)},hslString:function(){return string.hslString(this.values.hsl,this.values.alpha)},hslaString:function(){return string.hslaString(this.values.hsl,this.values.alpha)},hwbString:function(){return string.hwbString(this.values.hwb,this.values.alpha)},keyword:function(){return string.keyword(this.values.rgb,this.values.alpha)},rgbNumber:function(){var rgb=this.values.rgb;return rgb[0]<<16|rgb[1]<<8|rgb[2]},luminosity:function(){for(var rgb=this.values.rgb,lum=[],i=0;i<rgb.length;i++){var chan=rgb[i]/255;lum[i]=chan<=.03928?chan/12.92:Math.pow((chan+.055)/1.055,2.4)}return.2126*lum[0]+.7152*lum[1]+.0722*lum[2]},contrast:function(color2){var lum1=this.luminosity(),lum2=color2.luminosity();return lum1>lum2?(lum1+.05)/(lum2+.05):(lum2+.05)/(lum1+.05)},level:function(color2){var contrastRatio=this.contrast(color2);return contrastRatio>=7.1?"AAA":contrastRatio>=4.5?"AA":""},dark:function(){var rgb=this.values.rgb;return(299*rgb[0]+587*rgb[1]+114*rgb[2])/1e3<128},light:function(){return!this.dark()},negate:function(){for(var rgb=[],i=0;i<3;i++)rgb[i]=255-this.values.rgb[i];return this.setValues("rgb",rgb),this},lighten:function(ratio){var hsl=this.values.hsl;return hsl[2]+=hsl[2]*ratio,this.setValues("hsl",hsl),this},darken:function(ratio){var hsl=this.values.hsl;return hsl[2]-=hsl[2]*ratio,this.setValues("hsl",hsl),this},saturate:function(ratio){var hsl=this.values.hsl;return hsl[1]+=hsl[1]*ratio,this.setValues("hsl",hsl),this},desaturate:function(ratio){var hsl=this.values.hsl;return hsl[1]-=hsl[1]*ratio,this.setValues("hsl",hsl),this},whiten:function(ratio){var hwb=this.values.hwb;return hwb[1]+=hwb[1]*ratio,this.setValues("hwb",hwb),this},blacken:function(ratio){var hwb=this.values.hwb;return hwb[2]+=hwb[2]*ratio,this.setValues("hwb",hwb),this},greyscale:function(){var rgb=this.values.rgb,val=.3*rgb[0]+.59*rgb[1]+.11*rgb[2];return this.setValues("rgb",[val,val,val]),this},clearer:function(ratio){var alpha=this.values.alpha;return this.setValues("alpha",alpha-alpha*ratio),this},opaquer:function(ratio){var alpha=this.values.alpha;return this.setValues("alpha",alpha+alpha*ratio),this},rotate:function(degrees){var hsl=this.values.hsl,hue=(hsl[0]+degrees)%360;return hsl[0]=hue<0?360+hue:hue,this.setValues("hsl",hsl),this},mix:function(mixinColor,weight){var color2=mixinColor,p=void 0===weight?.5:weight,w=2*p-1,a=this.alpha()-color2.alpha(),w1=((w*a==-1?w:(w+a)/(1+w*a))+1)/2,w2=1-w1;return this.rgb(w1*this.red()+w2*color2.red(),w1*this.green()+w2*color2.green(),w1*this.blue()+w2*color2.blue()).alpha(this.alpha()*p+color2.alpha()*(1-p))},toJSON:function(){return this.rgb()},clone:function(){var value,type,result=new Color,source=this.values,target=result.values;for(var prop in source)source.hasOwnProperty(prop)&&(value=source[prop],"[object Array]"===(type={}.toString.call(value))?target[prop]=value.slice(0):"[object Number]"===type?target[prop]=value:console.error("unexpected color value:",value));return result}},Color.prototype.spaces={rgb:["red","green","blue"],hsl:["hue","saturation","lightness"],hsv:["hue","saturation","value"],hwb:["hue","whiteness","blackness"],cmyk:["cyan","magenta","yellow","black"]},Color.prototype.maxes={rgb:[255,255,255],hsl:[360,100,100],hsv:[360,100,100],hwb:[360,100,100],cmyk:[100,100,100,100]},Color.prototype.getValues=function(space){for(var values=this.values,vals={},i=0;i<space.length;i++)vals[space.charAt(i)]=values[space][i];return 1!==values.alpha&&(vals.a=values.alpha),vals},Color.prototype.setValues=function(space,vals){var i,capped,values=this.values,spaces=this.spaces,maxes=this.maxes,alpha=1;if(this.valid=!0,"alpha"===space)alpha=vals;else if(vals.length)values[space]=vals.slice(0,space.length),alpha=vals[space.length];else if(void 0!==vals[space.charAt(0)]){for(i=0;i<space.length;i++)values[space][i]=vals[space.charAt(i)];alpha=vals.a}else if(void 0!==vals[spaces[space][0]]){var chans=spaces[space];for(i=0;i<space.length;i++)values[space][i]=vals[chans[i]];alpha=vals.alpha}if(values.alpha=Math.max(0,Math.min(1,void 0===alpha?values.alpha:alpha)),"alpha"===space)return!1;for(i=0;i<space.length;i++)capped=Math.max(0,Math.min(maxes[space][i],values[space][i])),values[space][i]=Math.round(capped);for(var sname in spaces)sname!==space&&(values[sname]=convert[space][sname](values[space]));return!0},Color.prototype.setSpace=function(space,args){var vals=args[0];return void 0===vals?this.getValues(space):("number"==typeof vals&&(vals=Array.prototype.slice.call(args)),this.setValues(space,vals),this)},Color.prototype.setChannel=function(space,index,val){var svalues=this.values[space];return void 0===val?svalues[index]:val===svalues[index]?this:(svalues[index]=val,this.setValues(space,svalues),this)},"undefined"!=typeof window&&(window.Color=Color),module.exports=Color},"./node_modules/color-convert/conversions.js":function(module,exports){function rgb2hsl(rgb){var h,l,r=rgb[0]/255,g=rgb[1]/255,b=rgb[2]/255,min=Math.min(r,g,b),max=Math.max(r,g,b),delta=max-min;return max==min?h=0:r==max?h=(g-b)/delta:g==max?h=2+(b-r)/delta:b==max&&(h=4+(r-g)/delta),(h=Math.min(60*h,360))<0&&(h+=360),l=(min+max)/2,[h,100*(max==min?0:l<=.5?delta/(max+min):delta/(2-max-min)),100*l]}function rgb2hsv(rgb){var h,s,r=rgb[0],g=rgb[1],b=rgb[2],min=Math.min(r,g,b),max=Math.max(r,g,b),delta=max-min;return s=0==max?0:delta/max*1e3/10,max==min?h=0:r==max?h=(g-b)/delta:g==max?h=2+(b-r)/delta:b==max&&(h=4+(r-g)/delta),(h=Math.min(60*h,360))<0&&(h+=360),[h,s,max/255*1e3/10]}function rgb2hwb(rgb){var r=rgb[0],g=rgb[1],b=rgb[2];return[rgb2hsl(rgb)[0],100*(1/255*Math.min(r,Math.min(g,b))),100*(b=1-1/255*Math.max(r,Math.max(g,b)))]}function rgb2cmyk(rgb){var k,r=rgb[0]/255,g=rgb[1]/255,b=rgb[2]/255;return[100*((1-r-(k=Math.min(1-r,1-g,1-b)))/(1-k)||0),100*((1-g-k)/(1-k)||0),100*((1-b-k)/(1-k)||0),100*k]}function rgb2keyword(rgb){return reverseKeywords[JSON.stringify(rgb)]}function rgb2xyz(rgb){var r=rgb[0]/255,g=rgb[1]/255,b=rgb[2]/255;return[100*(.4124*(r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92)+.3576*(g=g>.04045?Math.pow((g+.055)/1.055,2.4):g/12.92)+.1805*(b=b>.04045?Math.pow((b+.055)/1.055,2.4):b/12.92)),100*(.2126*r+.7152*g+.0722*b),100*(.0193*r+.1192*g+.9505*b)]}function rgb2lab(rgb){var xyz=rgb2xyz(rgb),x=xyz[0],y=xyz[1],z=xyz[2];return y/=100,z/=108.883,x=(x/=95.047)>.008856?Math.pow(x,1/3):7.787*x+16/116,[116*(y=y>.008856?Math.pow(y,1/3):7.787*y+16/116)-16,500*(x-y),200*(y-(z=z>.008856?Math.pow(z,1/3):7.787*z+16/116))]}function hsl2rgb(hsl){var t1,t2,t3,rgb,val,h=hsl[0]/360,s=hsl[1]/100,l=hsl[2]/100;if(0==s)return[val=255*l,val,val];t1=2*l-(t2=l<.5?l*(1+s):l+s-l*s),rgb=[0,0,0];for(var i=0;i<3;i++)(t3=h+1/3*-(i-1))<0&&t3++,t3>1&&t3--,val=6*t3<1?t1+6*(t2-t1)*t3:2*t3<1?t2:3*t3<2?t1+(t2-t1)*(2/3-t3)*6:t1,rgb[i]=255*val;return rgb}function hsv2rgb(hsv){var h=hsv[0]/60,s=hsv[1]/100,v=hsv[2]/100,hi=Math.floor(h)%6,f=h-Math.floor(h),p=255*v*(1-s),q=255*v*(1-s*f),t=255*v*(1-s*(1-f));v*=255;switch(hi){case 0:return[v,t,p];case 1:return[q,v,p];case 2:return[p,v,t];case 3:return[p,q,v];case 4:return[t,p,v];case 5:return[v,p,q]}}function hwb2rgb(hwb){var i,v,f,n,h=hwb[0]/360,wh=hwb[1]/100,bl=hwb[2]/100,ratio=wh+bl;switch(ratio>1&&(wh/=ratio,bl/=ratio),v=1-bl,f=6*h-(i=Math.floor(6*h)),0!=(1&i)&&(f=1-f),n=wh+f*(v-wh),i){default:case 6:case 0:r=v,g=n,b=wh;break;case 1:r=n,g=v,b=wh;break;case 2:r=wh,g=v,b=n;break;case 3:r=wh,g=n,b=v;break;case 4:r=n,g=wh,b=v;break;case 5:r=v,g=wh,b=n}return[255*r,255*g,255*b]}function cmyk2rgb(cmyk){var c=cmyk[0]/100,m=cmyk[1]/100,y=cmyk[2]/100,k=cmyk[3]/100;return[255*(1-Math.min(1,c*(1-k)+k)),255*(1-Math.min(1,m*(1-k)+k)),255*(1-Math.min(1,y*(1-k)+k))]}function xyz2rgb(xyz){var r,g,b,x=xyz[0]/100,y=xyz[1]/100,z=xyz[2]/100;return g=-.9689*x+1.8758*y+.0415*z,b=.0557*x+-.204*y+1.057*z,r=(r=3.2406*x+-1.5372*y+-.4986*z)>.0031308?1.055*Math.pow(r,1/2.4)-.055:r*=12.92,g=g>.0031308?1.055*Math.pow(g,1/2.4)-.055:g*=12.92,b=b>.0031308?1.055*Math.pow(b,1/2.4)-.055:b*=12.92,[255*(r=Math.min(Math.max(0,r),1)),255*(g=Math.min(Math.max(0,g),1)),255*(b=Math.min(Math.max(0,b),1))]}function xyz2lab(xyz){var x=xyz[0],y=xyz[1],z=xyz[2];return y/=100,z/=108.883,x=(x/=95.047)>.008856?Math.pow(x,1/3):7.787*x+16/116,[116*(y=y>.008856?Math.pow(y,1/3):7.787*y+16/116)-16,500*(x-y),200*(y-(z=z>.008856?Math.pow(z,1/3):7.787*z+16/116))]}function lab2xyz(lab){var x,y,z,y2,l=lab[0],a=lab[1],b=lab[2];return l<=8?y2=(y=100*l/903.3)/100*7.787+16/116:(y=100*Math.pow((l+16)/116,3),y2=Math.pow(y/100,1/3)),[x=x/95.047<=.008856?x=95.047*(a/500+y2-16/116)/7.787:95.047*Math.pow(a/500+y2,3),y,z=z/108.883<=.008859?z=108.883*(y2-b/200-16/116)/7.787:108.883*Math.pow(y2-b/200,3)]}function lab2lch(lab){var h,l=lab[0],a=lab[1],b=lab[2];return(h=360*Math.atan2(b,a)/2/Math.PI)<0&&(h+=360),[l,Math.sqrt(a*a+b*b),h]}function lab2rgb(args){return xyz2rgb(lab2xyz(args))}function lch2lab(lch){var hr,l=lch[0],c=lch[1];return hr=lch[2]/360*2*Math.PI,[l,c*Math.cos(hr),c*Math.sin(hr)]}function keyword2rgb(keyword){return cssKeywords[keyword]}module.exports={rgb2hsl:rgb2hsl,rgb2hsv:rgb2hsv,rgb2hwb:rgb2hwb,rgb2cmyk:rgb2cmyk,rgb2keyword:rgb2keyword,rgb2xyz:rgb2xyz,rgb2lab:rgb2lab,rgb2lch:function(args){return lab2lch(rgb2lab(args))},hsl2rgb:hsl2rgb,hsl2hsv:function(hsl){var h=hsl[0],s=hsl[1]/100,l=hsl[2]/100;if(0===l)return[0,0,0];return[h,100*(2*(s*=(l*=2)<=1?l:2-l)/(l+s)),100*((l+s)/2)]},hsl2hwb:function(args){return rgb2hwb(hsl2rgb(args))},hsl2cmyk:function(args){return rgb2cmyk(hsl2rgb(args))},hsl2keyword:function(args){return rgb2keyword(hsl2rgb(args))},hsv2rgb:hsv2rgb,hsv2hsl:function(hsv){var sl,l,h=hsv[0],s=hsv[1]/100,v=hsv[2]/100;return sl=s*v,[h,100*(sl=(sl/=(l=(2-s)*v)<=1?l:2-l)||0),100*(l/=2)]},hsv2hwb:function(args){return rgb2hwb(hsv2rgb(args))},hsv2cmyk:function(args){return rgb2cmyk(hsv2rgb(args))},hsv2keyword:function(args){return rgb2keyword(hsv2rgb(args))},hwb2rgb:hwb2rgb,hwb2hsl:function(args){return rgb2hsl(hwb2rgb(args))},hwb2hsv:function(args){return rgb2hsv(hwb2rgb(args))},hwb2cmyk:function(args){return rgb2cmyk(hwb2rgb(args))},hwb2keyword:function(args){return rgb2keyword(hwb2rgb(args))},cmyk2rgb:cmyk2rgb,cmyk2hsl:function(args){return rgb2hsl(cmyk2rgb(args))},cmyk2hsv:function(args){return rgb2hsv(cmyk2rgb(args))},cmyk2hwb:function(args){return rgb2hwb(cmyk2rgb(args))},cmyk2keyword:function(args){return rgb2keyword(cmyk2rgb(args))},keyword2rgb:keyword2rgb,keyword2hsl:function(args){return rgb2hsl(keyword2rgb(args))},keyword2hsv:function(args){return rgb2hsv(keyword2rgb(args))},keyword2hwb:function(args){return rgb2hwb(keyword2rgb(args))},keyword2cmyk:function(args){return rgb2cmyk(keyword2rgb(args))},keyword2lab:function(args){return rgb2lab(keyword2rgb(args))},keyword2xyz:function(args){return rgb2xyz(keyword2rgb(args))},xyz2rgb:xyz2rgb,xyz2lab:xyz2lab,xyz2lch:function(args){return lab2lch(xyz2lab(args))},lab2xyz:lab2xyz,lab2rgb:lab2rgb,lab2lch:lab2lch,lch2lab:lch2lab,lch2xyz:function(args){return lab2xyz(lch2lab(args))},lch2rgb:function(args){return lab2rgb(lch2lab(args))}};var cssKeywords={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},reverseKeywords={};for(var key in cssKeywords)reverseKeywords[JSON.stringify(cssKeywords[key])]=key},"./node_modules/color-convert/index.js":function(module,exports,__webpack_require__){var conversions=__webpack_require__("./node_modules/color-convert/conversions.js"),convert=function(){return new Converter};for(var func in conversions){convert[func+"Raw"]=function(func){return function(arg){return"number"==typeof arg&&(arg=Array.prototype.slice.call(arguments)),conversions[func](arg)}}(func);var pair=/(\w+)2(\w+)/.exec(func),from=pair[1],to=pair[2];(convert[from]=convert[from]||{})[to]=convert[func]=function(func){return function(arg){"number"==typeof arg&&(arg=Array.prototype.slice.call(arguments));var val=conversions[func](arg);if("string"==typeof val||void 0===val)return val;for(var i=0;i<val.length;i++)val[i]=Math.round(val[i]);return val}}(func)}var Converter=function(){this.convs={}};Converter.prototype.routeSpace=function(space,args){var values=args[0];return void 0===values?this.getValues(space):("number"==typeof values&&(values=Array.prototype.slice.call(args)),this.setValues(space,values))},Converter.prototype.setValues=function(space,values){return this.space=space,this.convs={},this.convs[space]=values,this},Converter.prototype.getValues=function(space){var vals=this.convs[space];if(!vals){var fspace=this.space,from=this.convs[fspace];vals=convert[fspace][space](from),this.convs[space]=vals}return vals},["rgb","hsl","hsv","cmyk","keyword"].forEach(function(space){Converter.prototype[space]=function(vals){return this.routeSpace(space,arguments)}}),module.exports=convert},"./node_modules/color-name/index.js":function(module,exports,__webpack_require__){"use strict";module.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},"./node_modules/concat-map/index.js":function(module,exports){module.exports=function(xs,fn){for(var res=[],i=0;i<xs.length;i++){var x=fn(xs[i],i);isArray(x)?res.push.apply(res,x):res.push(x)}return res};var isArray=Array.isArray||function(xs){return"[object Array]"===Object.prototype.toString.call(xs)}},"./node_modules/core-util-is/lib/util.js":function(module,exports,__webpack_require__){(function(Buffer){function objectToString(o){return Object.prototype.toString.call(o)}exports.isArray=function(arg){return Array.isArray?Array.isArray(arg):"[object Array]"===objectToString(arg)},exports.isBoolean=function(arg){return"boolean"==typeof arg},exports.isNull=function(arg){return null===arg},exports.isNullOrUndefined=function(arg){return null==arg},exports.isNumber=function(arg){return"number"==typeof arg},exports.isString=function(arg){return"string"==typeof arg},exports.isSymbol=function(arg){return"symbol"==typeof arg},exports.isUndefined=function(arg){return void 0===arg},exports.isRegExp=function(re){return"[object RegExp]"===objectToString(re)},exports.isObject=function(arg){return"object"==typeof arg&&null!==arg},exports.isDate=function(d){return"[object Date]"===objectToString(d)},exports.isError=function(e){return"[object Error]"===objectToString(e)||e instanceof Error},exports.isFunction=function(arg){return"function"==typeof arg},exports.isPrimitive=function(arg){return null===arg||"boolean"==typeof arg||"number"==typeof arg||"string"==typeof arg||"symbol"==typeof arg||void 0===arg},exports.isBuffer=Buffer.isBuffer}).call(this,__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/node_modules/buffer/index.js?c412").Buffer)},"./node_modules/crypto-js/aes.js":function(module,exports,__webpack_require__){var CryptoJS;module.exports=(CryptoJS=__webpack_require__("./node_modules/crypto-js/core.js"),__webpack_require__("./node_modules/crypto-js/enc-base64.js"),__webpack_require__("./node_modules/crypto-js/md5.js"),__webpack_require__("./node_modules/crypto-js/evpkdf.js"),__webpack_require__("./node_modules/crypto-js/cipher-core.js"),function(){var C=CryptoJS,BlockCipher=C.lib.BlockCipher,C_algo=C.algo,SBOX=[],INV_SBOX=[],SUB_MIX_0=[],SUB_MIX_1=[],SUB_MIX_2=[],SUB_MIX_3=[],INV_SUB_MIX_0=[],INV_SUB_MIX_1=[],INV_SUB_MIX_2=[],INV_SUB_MIX_3=[];!function(){for(var d=[],i=0;i<256;i++)d[i]=i<128?i<<1:i<<1^283;var x=0,xi=0;for(i=0;i<256;i++){var sx=xi^xi<<1^xi<<2^xi<<3^xi<<4;sx=sx>>>8^255&sx^99,SBOX[x]=sx,INV_SBOX[sx]=x;var x2=d[x],x4=d[x2],x8=d[x4],t=257*d[sx]^16843008*sx;SUB_MIX_0[x]=t<<24|t>>>8,SUB_MIX_1[x]=t<<16|t>>>16,SUB_MIX_2[x]=t<<8|t>>>24,SUB_MIX_3[x]=t,t=16843009*x8^65537*x4^257*x2^16843008*x,INV_SUB_MIX_0[sx]=t<<24|t>>>8,INV_SUB_MIX_1[sx]=t<<16|t>>>16,INV_SUB_MIX_2[sx]=t<<8|t>>>24,INV_SUB_MIX_3[sx]=t,x?(x=x2^d[d[d[x8^x2]]],xi^=d[d[xi]]):x=xi=1}}();var RCON=[0,1,2,4,8,16,32,64,128,27,54],AES=C_algo.AES=BlockCipher.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var key=this._keyPriorReset=this._key,keyWords=key.words,keySize=key.sigBytes/4,ksRows=4*((this._nRounds=keySize+6)+1),keySchedule=this._keySchedule=[],ksRow=0;ksRow<ksRows;ksRow++)if(ksRow<keySize)keySchedule[ksRow]=keyWords[ksRow];else{var t=keySchedule[ksRow-1];ksRow%keySize?keySize>6&&ksRow%keySize==4&&(t=SBOX[t>>>24]<<24|SBOX[t>>>16&255]<<16|SBOX[t>>>8&255]<<8|SBOX[255&t]):(t=SBOX[(t=t<<8|t>>>24)>>>24]<<24|SBOX[t>>>16&255]<<16|SBOX[t>>>8&255]<<8|SBOX[255&t],t^=RCON[ksRow/keySize|0]<<24),keySchedule[ksRow]=keySchedule[ksRow-keySize]^t}for(var invKeySchedule=this._invKeySchedule=[],invKsRow=0;invKsRow<ksRows;invKsRow++)ksRow=ksRows-invKsRow,t=invKsRow%4?keySchedule[ksRow]:keySchedule[ksRow-4],invKeySchedule[invKsRow]=invKsRow<4||ksRow<=4?t:INV_SUB_MIX_0[SBOX[t>>>24]]^INV_SUB_MIX_1[SBOX[t>>>16&255]]^INV_SUB_MIX_2[SBOX[t>>>8&255]]^INV_SUB_MIX_3[SBOX[255&t]]}},encryptBlock:function(M,offset){this._doCryptBlock(M,offset,this._keySchedule,SUB_MIX_0,SUB_MIX_1,SUB_MIX_2,SUB_MIX_3,SBOX)},decryptBlock:function(M,offset){var t=M[offset+1];M[offset+1]=M[offset+3],M[offset+3]=t,this._doCryptBlock(M,offset,this._invKeySchedule,INV_SUB_MIX_0,INV_SUB_MIX_1,INV_SUB_MIX_2,INV_SUB_MIX_3,INV_SBOX),t=M[offset+1],M[offset+1]=M[offset+3],M[offset+3]=t},_doCryptBlock:function(M,offset,keySchedule,SUB_MIX_0,SUB_MIX_1,SUB_MIX_2,SUB_MIX_3,SBOX){for(var nRounds=this._nRounds,s0=M[offset]^keySchedule[0],s1=M[offset+1]^keySchedule[1],s2=M[offset+2]^keySchedule[2],s3=M[offset+3]^keySchedule[3],ksRow=4,round=1;round<nRounds;round++){var t0=SUB_MIX_0[s0>>>24]^SUB_MIX_1[s1>>>16&255]^SUB_MIX_2[s2>>>8&255]^SUB_MIX_3[255&s3]^keySchedule[ksRow++],t1=SUB_MIX_0[s1>>>24]^SUB_MIX_1[s2>>>16&255]^SUB_MIX_2[s3>>>8&255]^SUB_MIX_3[255&s0]^keySchedule[ksRow++],t2=SUB_MIX_0[s2>>>24]^SUB_MIX_1[s3>>>16&255]^SUB_MIX_2[s0>>>8&255]^SUB_MIX_3[255&s1]^keySchedule[ksRow++],t3=SUB_MIX_0[s3>>>24]^SUB_MIX_1[s0>>>16&255]^SUB_MIX_2[s1>>>8&255]^SUB_MIX_3[255&s2]^keySchedule[ksRow++];s0=t0,s1=t1,s2=t2,s3=t3}t0=(SBOX[s0>>>24]<<24|SBOX[s1>>>16&255]<<16|SBOX[s2>>>8&255]<<8|SBOX[255&s3])^keySchedule[ksRow++],t1=(SBOX[s1>>>24]<<24|SBOX[s2>>>16&255]<<16|SBOX[s3>>>8&255]<<8|SBOX[255&s0])^keySchedule[ksRow++],t2=(SBOX[s2>>>24]<<24|SBOX[s3>>>16&255]<<16|SBOX[s0>>>8&255]<<8|SBOX[255&s1])^keySchedule[ksRow++],t3=(SBOX[s3>>>24]<<24|SBOX[s0>>>16&255]<<16|SBOX[s1>>>8&255]<<8|SBOX[255&s2])^keySchedule[ksRow++],M[offset]=t0,M[offset+1]=t1,M[offset+2]=t2,M[offset+3]=t3},keySize:8});C.AES=BlockCipher._createHelper(AES)}(),CryptoJS.AES)},"./node_modules/crypto-js/cipher-core.js":function(module,exports,__webpack_require__){var CryptoJS;module.exports=(CryptoJS=__webpack_require__("./node_modules/crypto-js/core.js"),__webpack_require__("./node_modules/crypto-js/evpkdf.js"),void(CryptoJS.lib.Cipher||function(undefined){var C=CryptoJS,C_lib=C.lib,Base=C_lib.Base,WordArray=C_lib.WordArray,BufferedBlockAlgorithm=C_lib.BufferedBlockAlgorithm,C_enc=C.enc,Base64=(C_enc.Utf8,C_enc.Base64),C_algo=C.algo,EvpKDF=C_algo.EvpKDF,Cipher=C_lib.Cipher=BufferedBlockAlgorithm.extend({cfg:Base.extend(),createEncryptor:function(key,cfg){return this.create(this._ENC_XFORM_MODE,key,cfg)},createDecryptor:function(key,cfg){return this.create(this._DEC_XFORM_MODE,key,cfg)},init:function(xformMode,key,cfg){this.cfg=this.cfg.extend(cfg),this._xformMode=xformMode,this._key=key,this.reset()},reset:function(){BufferedBlockAlgorithm.reset.call(this),this._doReset()},process:function(dataUpdate){return this._append(dataUpdate),this._process()},finalize:function(dataUpdate){dataUpdate&&this._append(dataUpdate);var finalProcessedData=this._doFinalize();return finalProcessedData},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function selectCipherStrategy(key){return"string"==typeof key?PasswordBasedCipher:SerializableCipher}return function(cipher){return{encrypt:function(message,key,cfg){return selectCipherStrategy(key).encrypt(cipher,message,key,cfg)},decrypt:function(ciphertext,key,cfg){return selectCipherStrategy(key).decrypt(cipher,ciphertext,key,cfg)}}}}()}),C_mode=(C_lib.StreamCipher=Cipher.extend({_doFinalize:function(){var finalProcessedBlocks=this._process(!0);return finalProcessedBlocks},blockSize:1}),C.mode={}),BlockCipherMode=C_lib.BlockCipherMode=Base.extend({createEncryptor:function(cipher,iv){return this.Encryptor.create(cipher,iv)},createDecryptor:function(cipher,iv){return this.Decryptor.create(cipher,iv)},init:function(cipher,iv){this._cipher=cipher,this._iv=iv}}),CBC=C_mode.CBC=function(){var CBC=BlockCipherMode.extend();function xorBlock(words,offset,blockSize){var iv=this._iv;if(iv){var block=iv;this._iv=undefined}else var block=this._prevBlock;for(var i=0;i<blockSize;i++)words[offset+i]^=block[i]}return CBC.Encryptor=CBC.extend({processBlock:function(words,offset){var cipher=this._cipher,blockSize=cipher.blockSize;xorBlock.call(this,words,offset,blockSize),cipher.encryptBlock(words,offset),this._prevBlock=words.slice(offset,offset+blockSize)}}),CBC.Decryptor=CBC.extend({processBlock:function(words,offset){var cipher=this._cipher,blockSize=cipher.blockSize,thisBlock=words.slice(offset,offset+blockSize);cipher.decryptBlock(words,offset),xorBlock.call(this,words,offset,blockSize),this._prevBlock=thisBlock}}),CBC}(),C_pad=C.pad={},Pkcs7=C_pad.Pkcs7={pad:function(data,blockSize){for(var blockSizeBytes=4*blockSize,nPaddingBytes=blockSizeBytes-data.sigBytes%blockSizeBytes,paddingWord=nPaddingBytes<<24|nPaddingBytes<<16|nPaddingBytes<<8|nPaddingBytes,paddingWords=[],i=0;i<nPaddingBytes;i+=4)paddingWords.push(paddingWord);var padding=WordArray.create(paddingWords,nPaddingBytes);data.concat(padding)},unpad:function(data){var nPaddingBytes=255&data.words[data.sigBytes-1>>>2];data.sigBytes-=nPaddingBytes}},CipherParams=(C_lib.BlockCipher=Cipher.extend({cfg:Cipher.cfg.extend({mode:CBC,padding:Pkcs7}),reset:function(){Cipher.reset.call(this);var cfg=this.cfg,iv=cfg.iv,mode=cfg.mode;if(this._xformMode==this._ENC_XFORM_MODE)var modeCreator=mode.createEncryptor;else{var modeCreator=mode.createDecryptor;this._minBufferSize=1}this._mode&&this._mode.__creator==modeCreator?this._mode.init(this,iv&&iv.words):(this._mode=modeCreator.call(mode,this,iv&&iv.words),this._mode.__creator=modeCreator)},_doProcessBlock:function(words,offset){this._mode.processBlock(words,offset)},_doFinalize:function(){var padding=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){padding.pad(this._data,this.blockSize);var finalProcessedBlocks=this._process(!0)}else{var finalProcessedBlocks=this._process(!0);padding.unpad(finalProcessedBlocks)}return finalProcessedBlocks},blockSize:4}),C_lib.CipherParams=Base.extend({init:function(cipherParams){this.mixIn(cipherParams)},toString:function(formatter){return(formatter||this.formatter).stringify(this)}})),C_format=C.format={},OpenSSLFormatter=C_format.OpenSSL={stringify:function(cipherParams){var ciphertext=cipherParams.ciphertext,salt=cipherParams.salt;if(salt)var wordArray=WordArray.create([1398893684,1701076831]).concat(salt).concat(ciphertext);else var wordArray=ciphertext;return wordArray.toString(Base64)},parse:function(openSSLStr){var ciphertext=Base64.parse(openSSLStr),ciphertextWords=ciphertext.words;if(1398893684==ciphertextWords[0]&&1701076831==ciphertextWords[1]){var salt=WordArray.create(ciphertextWords.slice(2,4));ciphertextWords.splice(0,4),ciphertext.sigBytes-=16}return CipherParams.create({ciphertext:ciphertext,salt:salt})}},SerializableCipher=C_lib.SerializableCipher=Base.extend({cfg:Base.extend({format:OpenSSLFormatter}),encrypt:function(cipher,message,key,cfg){cfg=this.cfg.extend(cfg);var encryptor=cipher.createEncryptor(key,cfg),ciphertext=encryptor.finalize(message),cipherCfg=encryptor.cfg;return CipherParams.create({ciphertext:ciphertext,key:key,iv:cipherCfg.iv,algorithm:cipher,mode:cipherCfg.mode,padding:cipherCfg.padding,blockSize:cipher.blockSize,formatter:cfg.format})},decrypt:function(cipher,ciphertext,key,cfg){cfg=this.cfg.extend(cfg),ciphertext=this._parse(ciphertext,cfg.format);var plaintext=cipher.createDecryptor(key,cfg).finalize(ciphertext.ciphertext);return plaintext},_parse:function(ciphertext,format){return"string"==typeof ciphertext?format.parse(ciphertext,this):ciphertext}}),C_kdf=C.kdf={},OpenSSLKdf=C_kdf.OpenSSL={execute:function(password,keySize,ivSize,salt){salt||(salt=WordArray.random(8));var key=EvpKDF.create({keySize:keySize+ivSize}).compute(password,salt),iv=WordArray.create(key.words.slice(keySize),4*ivSize);return key.sigBytes=4*keySize,CipherParams.create({key:key,iv:iv,salt:salt})}},PasswordBasedCipher=C_lib.PasswordBasedCipher=SerializableCipher.extend({cfg:SerializableCipher.cfg.extend({kdf:OpenSSLKdf}),encrypt:function(cipher,message,password,cfg){var derivedParams=(cfg=this.cfg.extend(cfg)).kdf.execute(password,cipher.keySize,cipher.ivSize);cfg.iv=derivedParams.iv;var ciphertext=SerializableCipher.encrypt.call(this,cipher,message,derivedParams.key,cfg);return ciphertext.mixIn(derivedParams),ciphertext},decrypt:function(cipher,ciphertext,password,cfg){cfg=this.cfg.extend(cfg),ciphertext=this._parse(ciphertext,cfg.format);var derivedParams=cfg.kdf.execute(password,cipher.keySize,cipher.ivSize,ciphertext.salt);cfg.iv=derivedParams.iv;var plaintext=SerializableCipher.decrypt.call(this,cipher,ciphertext,derivedParams.key,cfg);return plaintext}})}()))},"./node_modules/crypto-js/core.js":function(module,exports,__webpack_require__){var CryptoJS;module.exports=(CryptoJS=CryptoJS||function(Math,undefined){var create=Object.create||function(){function F(){}return function(obj){var subtype;return F.prototype=obj,subtype=new F,F.prototype=null,subtype}}(),C={},C_lib=C.lib={},Base=C_lib.Base={extend:function(overrides){var subtype=create(this);return overrides&&subtype.mixIn(overrides),subtype.hasOwnProperty("init")&&this.init!==subtype.init||(subtype.init=function(){subtype.$super.init.apply(this,arguments)}),subtype.init.prototype=subtype,subtype.$super=this,subtype},create:function(){var instance=this.extend();return instance.init.apply(instance,arguments),instance},init:function(){},mixIn:function(properties){for(var propertyName in properties)properties.hasOwnProperty(propertyName)&&(this[propertyName]=properties[propertyName]);properties.hasOwnProperty("toString")&&(this.toString=properties.toString)},clone:function(){return this.init.prototype.extend(this)}},WordArray=C_lib.WordArray=Base.extend({init:function(words,sigBytes){words=this.words=words||[],this.sigBytes=void 0!=sigBytes?sigBytes:4*words.length},toString:function(encoder){return(encoder||Hex).stringify(this)},concat:function(wordArray){var thisWords=this.words,thatWords=wordArray.words,thisSigBytes=this.sigBytes,thatSigBytes=wordArray.sigBytes;if(this.clamp(),thisSigBytes%4)for(var i=0;i<thatSigBytes;i++){var thatByte=thatWords[i>>>2]>>>24-i%4*8&255;thisWords[thisSigBytes+i>>>2]|=thatByte<<24-(thisSigBytes+i)%4*8}else for(var i=0;i<thatSigBytes;i+=4)thisWords[thisSigBytes+i>>>2]=thatWords[i>>>2];return this.sigBytes+=thatSigBytes,this},clamp:function(){var words=this.words,sigBytes=this.sigBytes;words[sigBytes>>>2]&=4294967295<<32-sigBytes%4*8,words.length=Math.ceil(sigBytes/4)},clone:function(){var clone=Base.clone.call(this);return clone.words=this.words.slice(0),clone},random:function(nBytes){for(var rcache,words=[],r=function(m_w){var m_w=m_w,m_z=987654321,mask=4294967295;return function(){var result=((m_z=36969*(65535&m_z)+(m_z>>16)&mask)<<16)+(m_w=18e3*(65535&m_w)+(m_w>>16)&mask)&mask;return result/=4294967296,(result+=.5)*(Math.random()>.5?1:-1)}},i=0;i<nBytes;i+=4){var _r=r(4294967296*(rcache||Math.random()));rcache=987654071*_r(),words.push(4294967296*_r()|0)}return new WordArray.init(words,nBytes)}}),C_enc=C.enc={},Hex=C_enc.Hex={stringify:function(wordArray){for(var words=wordArray.words,sigBytes=wordArray.sigBytes,hexChars=[],i=0;i<sigBytes;i++){var bite=words[i>>>2]>>>24-i%4*8&255;hexChars.push((bite>>>4).toString(16)),hexChars.push((15&bite).toString(16))}return hexChars.join("")},parse:function(hexStr){for(var hexStrLength=hexStr.length,words=[],i=0;i<hexStrLength;i+=2)words[i>>>3]|=parseInt(hexStr.substr(i,2),16)<<24-i%8*4;return new WordArray.init(words,hexStrLength/2)}},Latin1=C_enc.Latin1={stringify:function(wordArray){for(var words=wordArray.words,sigBytes=wordArray.sigBytes,latin1Chars=[],i=0;i<sigBytes;i++){var bite=words[i>>>2]>>>24-i%4*8&255;latin1Chars.push(String.fromCharCode(bite))}return latin1Chars.join("")},parse:function(latin1Str){for(var latin1StrLength=latin1Str.length,words=[],i=0;i<latin1StrLength;i++)words[i>>>2]|=(255&latin1Str.charCodeAt(i))<<24-i%4*8;return new WordArray.init(words,latin1StrLength)}},Utf8=C_enc.Utf8={stringify:function(wordArray){try{return decodeURIComponent(escape(Latin1.stringify(wordArray)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(utf8Str){return Latin1.parse(unescape(encodeURIComponent(utf8Str)))}},BufferedBlockAlgorithm=C_lib.BufferedBlockAlgorithm=Base.extend({reset:function(){this._data=new WordArray.init,this._nDataBytes=0},_append:function(data){"string"==typeof data&&(data=Utf8.parse(data)),this._data.concat(data),this._nDataBytes+=data.sigBytes},_process:function(doFlush){var data=this._data,dataWords=data.words,dataSigBytes=data.sigBytes,blockSize=this.blockSize,blockSizeBytes=4*blockSize,nBlocksReady=dataSigBytes/blockSizeBytes,nWordsReady=(nBlocksReady=doFlush?Math.ceil(nBlocksReady):Math.max((0|nBlocksReady)-this._minBufferSize,0))*blockSize,nBytesReady=Math.min(4*nWordsReady,dataSigBytes);if(nWordsReady){for(var offset=0;offset<nWordsReady;offset+=blockSize)this._doProcessBlock(dataWords,offset);var processedWords=dataWords.splice(0,nWordsReady);data.sigBytes-=nBytesReady}return new WordArray.init(processedWords,nBytesReady)},clone:function(){var clone=Base.clone.call(this);return clone._data=this._data.clone(),clone},_minBufferSize:0}),C_algo=(C_lib.Hasher=BufferedBlockAlgorithm.extend({cfg:Base.extend(),init:function(cfg){this.cfg=this.cfg.extend(cfg),this.reset()},reset:function(){BufferedBlockAlgorithm.reset.call(this),this._doReset()},update:function(messageUpdate){return this._append(messageUpdate),this._process(),this},finalize:function(messageUpdate){messageUpdate&&this._append(messageUpdate);var hash=this._doFinalize();return hash},blockSize:16,_createHelper:function(hasher){return function(message,cfg){return new hasher.init(cfg).finalize(message)}},_createHmacHelper:function(hasher){return function(message,key){return new C_algo.HMAC.init(hasher,key).finalize(message)}}}),C.algo={});return C}(Math),CryptoJS)},"./node_modules/crypto-js/enc-base64.js":function(module,exports,__webpack_require__){var CryptoJS,C,WordArray;module.exports=(CryptoJS=__webpack_require__("./node_modules/crypto-js/core.js"),WordArray=(C=CryptoJS).lib.WordArray,C.enc.Base64={stringify:function(wordArray){var words=wordArray.words,sigBytes=wordArray.sigBytes,map=this._map;wordArray.clamp();for(var base64Chars=[],i=0;i<sigBytes;i+=3)for(var triplet=(words[i>>>2]>>>24-i%4*8&255)<<16|(words[i+1>>>2]>>>24-(i+1)%4*8&255)<<8|words[i+2>>>2]>>>24-(i+2)%4*8&255,j=0;j<4&&i+.75*j<sigBytes;j++)base64Chars.push(map.charAt(triplet>>>6*(3-j)&63));var paddingChar=map.charAt(64);if(paddingChar)for(;base64Chars.length%4;)base64Chars.push(paddingChar);return base64Chars.join("")},parse:function(base64Str){var base64StrLength=base64Str.length,map=this._map,reverseMap=this._reverseMap;if(!reverseMap){reverseMap=this._reverseMap=[];for(var j=0;j<map.length;j++)reverseMap[map.charCodeAt(j)]=j}var paddingChar=map.charAt(64);if(paddingChar){var paddingIndex=base64Str.indexOf(paddingChar);-1!==paddingIndex&&(base64StrLength=paddingIndex)}return function(base64Str,base64StrLength,reverseMap){for(var words=[],nBytes=0,i=0;i<base64StrLength;i++)if(i%4){var bits1=reverseMap[base64Str.charCodeAt(i-1)]<<i%4*2,bits2=reverseMap[base64Str.charCodeAt(i)]>>>6-i%4*2;words[nBytes>>>2]|=(bits1|bits2)<<24-nBytes%4*8,nBytes++}return WordArray.create(words,nBytes)}(base64Str,base64StrLength,reverseMap)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},CryptoJS.enc.Base64)},"./node_modules/crypto-js/enc-utf16.js":function(module,exports,__webpack_require__){var CryptoJS;module.exports=(CryptoJS=__webpack_require__("./node_modules/crypto-js/core.js"),function(){var C=CryptoJS,WordArray=C.lib.WordArray,C_enc=C.enc;function swapEndian(word){return word<<8&4278255360|word>>>8&16711935}C_enc.Utf16=C_enc.Utf16BE={stringify:function(wordArray){for(var words=wordArray.words,sigBytes=wordArray.sigBytes,utf16Chars=[],i=0;i<sigBytes;i+=2){var codePoint=words[i>>>2]>>>16-i%4*8&65535;utf16Chars.push(String.fromCharCode(codePoint))}return utf16Chars.join("")},parse:function(utf16Str){for(var utf16StrLength=utf16Str.length,words=[],i=0;i<utf16StrLength;i++)words[i>>>1]|=utf16Str.charCodeAt(i)<<16-i%2*16;return WordArray.create(words,2*utf16StrLength)}},C_enc.Utf16LE={stringify:function(wordArray){for(var words=wordArray.words,sigBytes=wordArray.sigBytes,utf16Chars=[],i=0;i<sigBytes;i+=2){var codePoint=swapEndian(words[i>>>2]>>>16-i%4*8&65535);utf16Chars.push(String.fromCharCode(codePoint))}return utf16Chars.join("")},parse:function(utf16Str){for(var utf16StrLength=utf16Str.length,words=[],i=0;i<utf16StrLength;i++)words[i>>>1]|=swapEndian(utf16Str.charCodeAt(i)<<16-i%2*16);return WordArray.create(words,2*utf16StrLength)}}}(),CryptoJS.enc.Utf16)},"./node_modules/crypto-js/evpkdf.js":function(module,exports,__webpack_require__){var CryptoJS,C,C_lib,Base,WordArray,C_algo,MD5,EvpKDF;module.exports=(CryptoJS=__webpack_require__("./node_modules/crypto-js/core.js"),__webpack_require__("./node_modules/crypto-js/sha1.js"),__webpack_require__("./node_modules/crypto-js/hmac.js"),C_lib=(C=CryptoJS).lib,Base=C_lib.Base,WordArray=C_lib.WordArray,C_algo=C.algo,MD5=C_algo.MD5,EvpKDF=C_algo.EvpKDF=Base.extend({cfg:Base.extend({keySize:4,hasher:MD5,iterations:1}),init:function(cfg){this.cfg=this.cfg.extend(cfg)},compute:function(password,salt){for(var cfg=this.cfg,hasher=cfg.hasher.create(),derivedKey=WordArray.create(),derivedKeyWords=derivedKey.words,keySize=cfg.keySize,iterations=cfg.iterations;derivedKeyWords.length<keySize;){block&&hasher.update(block);var block=hasher.update(password).finalize(salt);hasher.reset();for(var i=1;i<iterations;i++)block=hasher.finalize(block),hasher.reset();derivedKey.concat(block)}return derivedKey.sigBytes=4*keySize,derivedKey}}),C.EvpKDF=function(password,salt,cfg){return EvpKDF.create(cfg).compute(password,salt)},CryptoJS.EvpKDF)},"./node_modules/crypto-js/format-hex.js":function(module,exports,__webpack_require__){var CryptoJS,C,CipherParams,Hex;module.exports=(CryptoJS=__webpack_require__("./node_modules/crypto-js/core.js"),__webpack_require__("./node_modules/crypto-js/cipher-core.js"),CipherParams=(C=CryptoJS).lib.CipherParams,Hex=C.enc.Hex,C.format.Hex={stringify:function(cipherParams){return cipherParams.ciphertext.toString(Hex)},parse:function(input){var ciphertext=Hex.parse(input);return CipherParams.create({ciphertext:ciphertext})}},CryptoJS.format.Hex)},"./node_modules/crypto-js/hmac.js":function(module,exports,__webpack_require__){var CryptoJS,C,C_lib,Base,C_enc,Utf8,C_algo;module.exports=(CryptoJS=__webpack_require__("./node_modules/crypto-js/core.js"),C_lib=(C=CryptoJS).lib,Base=C_lib.Base,C_enc=C.enc,Utf8=C_enc.Utf8,C_algo=C.algo,void(C_algo.HMAC=Base.extend({init:function(hasher,key){hasher=this._hasher=new hasher.init,"string"==typeof key&&(key=Utf8.parse(key));var hasherBlockSize=hasher.blockSize,hasherBlockSizeBytes=4*hasherBlockSize;key.sigBytes>hasherBlockSizeBytes&&(key=hasher.finalize(key)),key.clamp();for(var oKey=this._oKey=key.clone(),iKey=this._iKey=key.clone(),oKeyWords=oKey.words,iKeyWords=iKey.words,i=0;i<hasherBlockSize;i++)oKeyWords[i]^=1549556828,iKeyWords[i]^=909522486;oKey.sigBytes=iKey.sigBytes=hasherBlockSizeBytes,this.reset()},reset:function(){var hasher=this._hasher;hasher.reset(),hasher.update(this._iKey)},update:function(messageUpdate){return this._hasher.update(messageUpdate),this},finalize:function(messageUpdate){var hasher=this._hasher,innerHash=hasher.finalize(messageUpdate);hasher.reset();var hmac=hasher.finalize(this._oKey.clone().concat(innerHash));return hmac}})))},"./node_modules/crypto-js/index.js":function(module,exports,__webpack_require__){var CryptoJS;module.exports=(CryptoJS=__webpack_require__("./node_modules/crypto-js/core.js"),__webpack_require__("./node_modules/crypto-js/x64-core.js"),__webpack_require__("./node_modules/crypto-js/lib-typedarrays.js"),__webpack_require__("./node_modules/crypto-js/enc-utf16.js"),__webpack_require__("./node_modules/crypto-js/enc-base64.js"),__webpack_require__("./node_modules/crypto-js/md5.js"),__webpack_require__("./node_modules/crypto-js/sha1.js"),__webpack_require__("./node_modules/crypto-js/sha256.js"),__webpack_require__("./node_modules/crypto-js/sha224.js"),__webpack_require__("./node_modules/crypto-js/sha512.js"),__webpack_require__("./node_modules/crypto-js/sha384.js"),__webpack_require__("./node_modules/crypto-js/sha3.js"),__webpack_require__("./node_modules/crypto-js/ripemd160.js"),__webpack_require__("./node_modules/crypto-js/hmac.js"),__webpack_require__("./node_modules/crypto-js/pbkdf2.js"),__webpack_require__("./node_modules/crypto-js/evpkdf.js"),__webpack_require__("./node_modules/crypto-js/cipher-core.js"),__webpack_require__("./node_modules/crypto-js/mode-cfb.js"),__webpack_require__("./node_modules/crypto-js/mode-ctr.js"),__webpack_require__("./node_modules/crypto-js/mode-ctr-gladman.js"),__webpack_require__("./node_modules/crypto-js/mode-ofb.js"),__webpack_require__("./node_modules/crypto-js/mode-ecb.js"),__webpack_require__("./node_modules/crypto-js/pad-ansix923.js"),__webpack_require__("./node_modules/crypto-js/pad-iso10126.js"),__webpack_require__("./node_modules/crypto-js/pad-iso97971.js"),__webpack_require__("./node_modules/crypto-js/pad-zeropadding.js"),__webpack_require__("./node_modules/crypto-js/pad-nopadding.js"),__webpack_require__("./node_modules/crypto-js/format-hex.js"),__webpack_require__("./node_modules/crypto-js/aes.js"),__webpack_require__("./node_modules/crypto-js/tripledes.js"),__webpack_require__("./node_modules/crypto-js/rc4.js"),__webpack_require__("./node_modules/crypto-js/rabbit.js"),__webpack_require__("./node_modules/crypto-js/rabbit-legacy.js"),CryptoJS)},"./node_modules/crypto-js/lib-typedarrays.js":function(module,exports,__webpack_require__){var CryptoJS;module.exports=(CryptoJS=__webpack_require__("./node_modules/crypto-js/core.js"),function(){if("function"==typeof ArrayBuffer){var WordArray=CryptoJS.lib.WordArray,superInit=WordArray.init;(WordArray.init=function(typedArray){if(typedArray instanceof ArrayBuffer&&(typedArray=new Uint8Array(typedArray)),(typedArray instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&typedArray instanceof Uint8ClampedArray||typedArray instanceof Int16Array||typedArray instanceof Uint16Array||typedArray instanceof Int32Array||typedArray instanceof Uint32Array||typedArray instanceof Float32Array||typedArray instanceof Float64Array)&&(typedArray=new Uint8Array(typedArray.buffer,typedArray.byteOffset,typedArray.byteLength)),typedArray instanceof Uint8Array){for(var typedArrayByteLength=typedArray.byteLength,words=[],i=0;i<typedArrayByteLength;i++)words[i>>>2]|=typedArray[i]<<24-i%4*8;superInit.call(this,words,typedArrayByteLength)}else superInit.apply(this,arguments)}).prototype=WordArray}}(),CryptoJS.lib.WordArray)},"./node_modules/crypto-js/md5.js":function(module,exports,__webpack_require__){var CryptoJS;module.exports=(CryptoJS=__webpack_require__("./node_modules/crypto-js/core.js"),function(Math){var C=CryptoJS,C_lib=C.lib,WordArray=C_lib.WordArray,Hasher=C_lib.Hasher,C_algo=C.algo,T=[];!function(){for(var i=0;i<64;i++)T[i]=4294967296*Math.abs(Math.sin(i+1))|0}();var MD5=C_algo.MD5=Hasher.extend({_doReset:function(){this._hash=new WordArray.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(M,offset){for(var i=0;i<16;i++){var offset_i=offset+i,M_offset_i=M[offset_i];M[offset_i]=16711935&(M_offset_i<<8|M_offset_i>>>24)|4278255360&(M_offset_i<<24|M_offset_i>>>8)}var H=this._hash.words,M_offset_0=M[offset+0],M_offset_1=M[offset+1],M_offset_2=M[offset+2],M_offset_3=M[offset+3],M_offset_4=M[offset+4],M_offset_5=M[offset+5],M_offset_6=M[offset+6],M_offset_7=M[offset+7],M_offset_8=M[offset+8],M_offset_9=M[offset+9],M_offset_10=M[offset+10],M_offset_11=M[offset+11],M_offset_12=M[offset+12],M_offset_13=M[offset+13],M_offset_14=M[offset+14],M_offset_15=M[offset+15],a=H[0],b=H[1],c=H[2],d=H[3];b=II(b=II(b=II(b=II(b=HH(b=HH(b=HH(b=HH(b=GG(b=GG(b=GG(b=GG(b=FF(b=FF(b=FF(b=FF(b,c=FF(c,d=FF(d,a=FF(a,b,c,d,M_offset_0,7,T[0]),b,c,M_offset_1,12,T[1]),a,b,M_offset_2,17,T[2]),d,a,M_offset_3,22,T[3]),c=FF(c,d=FF(d,a=FF(a,b,c,d,M_offset_4,7,T[4]),b,c,M_offset_5,12,T[5]),a,b,M_offset_6,17,T[6]),d,a,M_offset_7,22,T[7]),c=FF(c,d=FF(d,a=FF(a,b,c,d,M_offset_8,7,T[8]),b,c,M_offset_9,12,T[9]),a,b,M_offset_10,17,T[10]),d,a,M_offset_11,22,T[11]),c=FF(c,d=FF(d,a=FF(a,b,c,d,M_offset_12,7,T[12]),b,c,M_offset_13,12,T[13]),a,b,M_offset_14,17,T[14]),d,a,M_offset_15,22,T[15]),c=GG(c,d=GG(d,a=GG(a,b,c,d,M_offset_1,5,T[16]),b,c,M_offset_6,9,T[17]),a,b,M_offset_11,14,T[18]),d,a,M_offset_0,20,T[19]),c=GG(c,d=GG(d,a=GG(a,b,c,d,M_offset_5,5,T[20]),b,c,M_offset_10,9,T[21]),a,b,M_offset_15,14,T[22]),d,a,M_offset_4,20,T[23]),c=GG(c,d=GG(d,a=GG(a,b,c,d,M_offset_9,5,T[24]),b,c,M_offset_14,9,T[25]),a,b,M_offset_3,14,T[26]),d,a,M_offset_8,20,T[27]),c=GG(c,d=GG(d,a=GG(a,b,c,d,M_offset_13,5,T[28]),b,c,M_offset_2,9,T[29]),a,b,M_offset_7,14,T[30]),d,a,M_offset_12,20,T[31]),c=HH(c,d=HH(d,a=HH(a,b,c,d,M_offset_5,4,T[32]),b,c,M_offset_8,11,T[33]),a,b,M_offset_11,16,T[34]),d,a,M_offset_14,23,T[35]),c=HH(c,d=HH(d,a=HH(a,b,c,d,M_offset_1,4,T[36]),b,c,M_offset_4,11,T[37]),a,b,M_offset_7,16,T[38]),d,a,M_offset_10,23,T[39]),c=HH(c,d=HH(d,a=HH(a,b,c,d,M_offset_13,4,T[40]),b,c,M_offset_0,11,T[41]),a,b,M_offset_3,16,T[42]),d,a,M_offset_6,23,T[43]),c=HH(c,d=HH(d,a=HH(a,b,c,d,M_offset_9,4,T[44]),b,c,M_offset_12,11,T[45]),a,b,M_offset_15,16,T[46]),d,a,M_offset_2,23,T[47]),c=II(c,d=II(d,a=II(a,b,c,d,M_offset_0,6,T[48]),b,c,M_offset_7,10,T[49]),a,b,M_offset_14,15,T[50]),d,a,M_offset_5,21,T[51]),c=II(c,d=II(d,a=II(a,b,c,d,M_offset_12,6,T[52]),b,c,M_offset_3,10,T[53]),a,b,M_offset_10,15,T[54]),d,a,M_offset_1,21,T[55]),c=II(c,d=II(d,a=II(a,b,c,d,M_offset_8,6,T[56]),b,c,M_offset_15,10,T[57]),a,b,M_offset_6,15,T[58]),d,a,M_offset_13,21,T[59]),c=II(c,d=II(d,a=II(a,b,c,d,M_offset_4,6,T[60]),b,c,M_offset_11,10,T[61]),a,b,M_offset_2,15,T[62]),d,a,M_offset_9,21,T[63]),H[0]=H[0]+a|0,H[1]=H[1]+b|0,H[2]=H[2]+c|0,H[3]=H[3]+d|0},_doFinalize:function(){var data=this._data,dataWords=data.words,nBitsTotal=8*this._nDataBytes,nBitsLeft=8*data.sigBytes;dataWords[nBitsLeft>>>5]|=128<<24-nBitsLeft%32;var nBitsTotalH=Math.floor(nBitsTotal/4294967296),nBitsTotalL=nBitsTotal;dataWords[15+(nBitsLeft+64>>>9<<4)]=16711935&(nBitsTotalH<<8|nBitsTotalH>>>24)|4278255360&(nBitsTotalH<<24|nBitsTotalH>>>8),dataWords[14+(nBitsLeft+64>>>9<<4)]=16711935&(nBitsTotalL<<8|nBitsTotalL>>>24)|4278255360&(nBitsTotalL<<24|nBitsTotalL>>>8),data.sigBytes=4*(dataWords.length+1),this._process();for(var hash=this._hash,H=hash.words,i=0;i<4;i++){var H_i=H[i];H[i]=16711935&(H_i<<8|H_i>>>24)|4278255360&(H_i<<24|H_i>>>8)}return hash},clone:function(){var clone=Hasher.clone.call(this);return clone._hash=this._hash.clone(),clone}});function FF(a,b,c,d,x,s,t){var n=a+(b&c|~b&d)+x+t;return(n<<s|n>>>32-s)+b}function GG(a,b,c,d,x,s,t){var n=a+(b&d|c&~d)+x+t;return(n<<s|n>>>32-s)+b}function HH(a,b,c,d,x,s,t){var n=a+(b^c^d)+x+t;return(n<<s|n>>>32-s)+b}function II(a,b,c,d,x,s,t){var n=a+(c^(b|~d))+x+t;return(n<<s|n>>>32-s)+b}C.MD5=Hasher._createHelper(MD5),C.HmacMD5=Hasher._createHmacHelper(MD5)}(Math),CryptoJS.MD5)},"./node_modules/crypto-js/mode-cfb.js":function(module,exports,__webpack_require__){var CryptoJS;module.exports=(CryptoJS=__webpack_require__("./node_modules/crypto-js/core.js"),__webpack_require__("./node_modules/crypto-js/cipher-core.js"),CryptoJS.mode.CFB=function(){var CFB=CryptoJS.lib.BlockCipherMode.extend();function generateKeystreamAndEncrypt(words,offset,blockSize,cipher){var iv=this._iv;if(iv){var keystream=iv.slice(0);this._iv=void 0}else keystream=this._prevBlock;cipher.encryptBlock(keystream,0);for(var i=0;i<blockSize;i++)words[offset+i]^=keystream[i]}return CFB.Encryptor=CFB.extend({processBlock:function(words,offset){var cipher=this._cipher,blockSize=cipher.blockSize;generateKeystreamAndEncrypt.call(this,words,offset,blockSize,cipher),this._prevBlock=words.slice(offset,offset+blockSize)}}),CFB.Decryptor=CFB.extend({processBlock:function(words,offset){var cipher=this._cipher,blockSize=cipher.blockSize,thisBlock=words.slice(offset,offset+blockSize);generateKeystreamAndEncrypt.call(this,words,offset,blockSize,cipher),this._prevBlock=thisBlock}}),CFB}(),CryptoJS.mode.CFB)},"./node_modules/crypto-js/mode-ctr-gladman.js":function(module,exports,__webpack_require__){var CryptoJS;module.exports=(CryptoJS=__webpack_require__("./node_modules/crypto-js/core.js"),__webpack_require__("./node_modules/crypto-js/cipher-core.js"),CryptoJS.mode.CTRGladman=function(){var CTRGladman=CryptoJS.lib.BlockCipherMode.extend();function incWord(word){if(255==(word>>24&255)){var b1=word>>16&255,b2=word>>8&255,b3=255&word;255===b1?(b1=0,255===b2?(b2=0,255===b3?b3=0:++b3):++b2):++b1,word=0,word+=b1<<16,word+=b2<<8,word+=b3}else word+=1<<24;return word}var Encryptor=CTRGladman.Encryptor=CTRGladman.extend({processBlock:function(words,offset){var cipher=this._cipher,blockSize=cipher.blockSize,iv=this._iv,counter=this._counter;iv&&(counter=this._counter=iv.slice(0),this._iv=void 0),function(counter){0===(counter[0]=incWord(counter[0]))&&(counter[1]=incWord(counter[1]))}(counter);var keystream=counter.slice(0);cipher.encryptBlock(keystream,0);for(var i=0;i<blockSize;i++)words[offset+i]^=keystream[i]}});return CTRGladman.Decryptor=Encryptor,CTRGladman}(),CryptoJS.mode.CTRGladman)},"./node_modules/crypto-js/mode-ctr.js":function(module,exports,__webpack_require__){var CryptoJS,CTR,Encryptor;module.exports=(CryptoJS=__webpack_require__("./node_modules/crypto-js/core.js"),__webpack_require__("./node_modules/crypto-js/cipher-core.js"),CryptoJS.mode.CTR=(CTR=CryptoJS.lib.BlockCipherMode.extend(),Encryptor=CTR.Encryptor=CTR.extend({processBlock:function(words,offset){var cipher=this._cipher,blockSize=cipher.blockSize,iv=this._iv,counter=this._counter;iv&&(counter=this._counter=iv.slice(0),this._iv=void 0);var keystream=counter.slice(0);cipher.encryptBlock(keystream,0),counter[blockSize-1]=counter[blockSize-1]+1|0;for(var i=0;i<blockSize;i++)words[offset+i]^=keystream[i]}}),CTR.Decryptor=Encryptor,CTR),CryptoJS.mode.CTR)},"./node_modules/crypto-js/mode-ecb.js":function(module,exports,__webpack_require__){var CryptoJS,ECB;module.exports=(CryptoJS=__webpack_require__("./node_modules/crypto-js/core.js"),__webpack_require__("./node_modules/crypto-js/cipher-core.js"),CryptoJS.mode.ECB=((ECB=CryptoJS.lib.BlockCipherMode.extend()).Encryptor=ECB.extend({processBlock:function(words,offset){this._cipher.encryptBlock(words,offset)}}),ECB.Decryptor=ECB.extend({processBlock:function(words,offset){this._cipher.decryptBlock(words,offset)}}),ECB),CryptoJS.mode.ECB)},"./node_modules/crypto-js/mode-ofb.js":function(module,exports,__webpack_require__){var CryptoJS,OFB,Encryptor;module.exports=(CryptoJS=__webpack_require__("./node_modules/crypto-js/core.js"),__webpack_require__("./node_modules/crypto-js/cipher-core.js"),CryptoJS.mode.OFB=(OFB=CryptoJS.lib.BlockCipherMode.extend(),Encryptor=OFB.Encryptor=OFB.extend({processBlock:function(words,offset){var cipher=this._cipher,blockSize=cipher.blockSize,iv=this._iv,keystream=this._keystream;iv&&(keystream=this._keystream=iv.slice(0),this._iv=void 0),cipher.encryptBlock(keystream,0);for(var i=0;i<blockSize;i++)words[offset+i]^=keystream[i]}}),OFB.Decryptor=Encryptor,OFB),CryptoJS.mode.OFB)},"./node_modules/crypto-js/pad-ansix923.js":function(module,exports,__webpack_require__){var CryptoJS;module.exports=(CryptoJS=__webpack_require__("./node_modules/crypto-js/core.js"),__webpack_require__("./node_modules/crypto-js/cipher-core.js"),CryptoJS.pad.AnsiX923={pad:function(data,blockSize){var dataSigBytes=data.sigBytes,blockSizeBytes=4*blockSize,nPaddingBytes=blockSizeBytes-dataSigBytes%blockSizeBytes,lastBytePos=dataSigBytes+nPaddingBytes-1;data.clamp(),data.words[lastBytePos>>>2]|=nPaddingBytes<<24-lastBytePos%4*8,data.sigBytes+=nPaddingBytes},unpad:function(data){var nPaddingBytes=255&data.words[data.sigBytes-1>>>2];data.sigBytes-=nPaddingBytes}},CryptoJS.pad.Ansix923)},"./node_modules/crypto-js/pad-iso10126.js":function(module,exports,__webpack_require__){var CryptoJS;module.exports=(CryptoJS=__webpack_require__("./node_modules/crypto-js/core.js"),__webpack_require__("./node_modules/crypto-js/cipher-core.js"),CryptoJS.pad.Iso10126={pad:function(data,blockSize){var blockSizeBytes=4*blockSize,nPaddingBytes=blockSizeBytes-data.sigBytes%blockSizeBytes;data.concat(CryptoJS.lib.WordArray.random(nPaddingBytes-1)).concat(CryptoJS.lib.WordArray.create([nPaddingBytes<<24],1))},unpad:function(data){var nPaddingBytes=255&data.words[data.sigBytes-1>>>2];data.sigBytes-=nPaddingBytes}},CryptoJS.pad.Iso10126)},"./node_modules/crypto-js/pad-iso97971.js":function(module,exports,__webpack_require__){var CryptoJS;module.exports=(CryptoJS=__webpack_require__("./node_modules/crypto-js/core.js"),__webpack_require__("./node_modules/crypto-js/cipher-core.js"),CryptoJS.pad.Iso97971={pad:function(data,blockSize){data.concat(CryptoJS.lib.WordArray.create([2147483648],1)),CryptoJS.pad.ZeroPadding.pad(data,blockSize)},unpad:function(data){CryptoJS.pad.ZeroPadding.unpad(data),data.sigBytes--}},CryptoJS.pad.Iso97971)},"./node_modules/crypto-js/pad-nopadding.js":function(module,exports,__webpack_require__){var CryptoJS;module.exports=(CryptoJS=__webpack_require__("./node_modules/crypto-js/core.js"),__webpack_require__("./node_modules/crypto-js/cipher-core.js"),CryptoJS.pad.NoPadding={pad:function(){},unpad:function(){}},CryptoJS.pad.NoPadding)},"./node_modules/crypto-js/pad-zeropadding.js":function(module,exports,__webpack_require__){var CryptoJS;module.exports=(CryptoJS=__webpack_require__("./node_modules/crypto-js/core.js"),__webpack_require__("./node_modules/crypto-js/cipher-core.js"),CryptoJS.pad.ZeroPadding={pad:function(data,blockSize){var blockSizeBytes=4*blockSize;data.clamp(),data.sigBytes+=blockSizeBytes-(data.sigBytes%blockSizeBytes||blockSizeBytes)},unpad:function(data){for(var dataWords=data.words,i=data.sigBytes-1;!(dataWords[i>>>2]>>>24-i%4*8&255);)i--;data.sigBytes=i+1}},CryptoJS.pad.ZeroPadding)},"./node_modules/crypto-js/pbkdf2.js":function(module,exports,__webpack_require__){var CryptoJS,C,C_lib,Base,WordArray,C_algo,SHA1,HMAC,PBKDF2;module.exports=(CryptoJS=__webpack_require__("./node_modules/crypto-js/core.js"),__webpack_require__("./node_modules/crypto-js/sha1.js"),__webpack_require__("./node_modules/crypto-js/hmac.js"),C_lib=(C=CryptoJS).lib,Base=C_lib.Base,WordArray=C_lib.WordArray,C_algo=C.algo,SHA1=C_algo.SHA1,HMAC=C_algo.HMAC,PBKDF2=C_algo.PBKDF2=Base.extend({cfg:Base.extend({keySize:4,hasher:SHA1,iterations:1}),init:function(cfg){this.cfg=this.cfg.extend(cfg)},compute:function(password,salt){for(var cfg=this.cfg,hmac=HMAC.create(cfg.hasher,password),derivedKey=WordArray.create(),blockIndex=WordArray.create([1]),derivedKeyWords=derivedKey.words,blockIndexWords=blockIndex.words,keySize=cfg.keySize,iterations=cfg.iterations;derivedKeyWords.length<keySize;){var block=hmac.update(salt).finalize(blockIndex);hmac.reset();for(var blockWords=block.words,blockWordsLength=blockWords.length,intermediate=block,i=1;i<iterations;i++){intermediate=hmac.finalize(intermediate),hmac.reset();for(var intermediateWords=intermediate.words,j=0;j<blockWordsLength;j++)blockWords[j]^=intermediateWords[j]}derivedKey.concat(block),blockIndexWords[0]++}return derivedKey.sigBytes=4*keySize,derivedKey}}),C.PBKDF2=function(password,salt,cfg){return PBKDF2.create(cfg).compute(password,salt)},CryptoJS.PBKDF2)},"./node_modules/crypto-js/rabbit-legacy.js":function(module,exports,__webpack_require__){var CryptoJS;module.exports=(CryptoJS=__webpack_require__("./node_modules/crypto-js/core.js"),__webpack_require__("./node_modules/crypto-js/enc-base64.js"),__webpack_require__("./node_modules/crypto-js/md5.js"),__webpack_require__("./node_modules/crypto-js/evpkdf.js"),__webpack_require__("./node_modules/crypto-js/cipher-core.js"),function(){var C=CryptoJS,StreamCipher=C.lib.StreamCipher,S=[],C_=[],G=[],RabbitLegacy=C.algo.RabbitLegacy=StreamCipher.extend({_doReset:function(){var K=this._key.words,iv=this.cfg.iv,X=this._X=[K[0],K[3]<<16|K[2]>>>16,K[1],K[0]<<16|K[3]>>>16,K[2],K[1]<<16|K[0]>>>16,K[3],K[2]<<16|K[1]>>>16],C=this._C=[K[2]<<16|K[2]>>>16,4294901760&K[0]|65535&K[1],K[3]<<16|K[3]>>>16,4294901760&K[1]|65535&K[2],K[0]<<16|K[0]>>>16,4294901760&K[2]|65535&K[3],K[1]<<16|K[1]>>>16,4294901760&K[3]|65535&K[0]];this._b=0;for(var i=0;i<4;i++)nextState.call(this);for(i=0;i<8;i++)C[i]^=X[i+4&7];if(iv){var IV=iv.words,IV_0=IV[0],IV_1=IV[1],i0=16711935&(IV_0<<8|IV_0>>>24)|4278255360&(IV_0<<24|IV_0>>>8),i2=16711935&(IV_1<<8|IV_1>>>24)|4278255360&(IV_1<<24|IV_1>>>8),i1=i0>>>16|4294901760&i2,i3=i2<<16|65535&i0;for(C[0]^=i0,C[1]^=i1,C[2]^=i2,C[3]^=i3,C[4]^=i0,C[5]^=i1,C[6]^=i2,C[7]^=i3,i=0;i<4;i++)nextState.call(this)}},_doProcessBlock:function(M,offset){var X=this._X;nextState.call(this),S[0]=X[0]^X[5]>>>16^X[3]<<16,S[1]=X[2]^X[7]>>>16^X[5]<<16,S[2]=X[4]^X[1]>>>16^X[7]<<16,S[3]=X[6]^X[3]>>>16^X[1]<<16;for(var i=0;i<4;i++)S[i]=16711935&(S[i]<<8|S[i]>>>24)|4278255360&(S[i]<<24|S[i]>>>8),M[offset+i]^=S[i]},blockSize:4,ivSize:2});function nextState(){for(var X=this._X,C=this._C,i=0;i<8;i++)C_[i]=C[i];for(C[0]=C[0]+1295307597+this._b|0,C[1]=C[1]+3545052371+(C[0]>>>0<C_[0]>>>0?1:0)|0,C[2]=C[2]+886263092+(C[1]>>>0<C_[1]>>>0?1:0)|0,C[3]=C[3]+1295307597+(C[2]>>>0<C_[2]>>>0?1:0)|0,C[4]=C[4]+3545052371+(C[3]>>>0<C_[3]>>>0?1:0)|0,C[5]=C[5]+886263092+(C[4]>>>0<C_[4]>>>0?1:0)|0,C[6]=C[6]+1295307597+(C[5]>>>0<C_[5]>>>0?1:0)|0,C[7]=C[7]+3545052371+(C[6]>>>0<C_[6]>>>0?1:0)|0,this._b=C[7]>>>0<C_[7]>>>0?1:0,i=0;i<8;i++){var gx=X[i]+C[i],ga=65535&gx,gb=gx>>>16,gh=((ga*ga>>>17)+ga*gb>>>15)+gb*gb,gl=((4294901760&gx)*gx|0)+((65535&gx)*gx|0);G[i]=gh^gl}X[0]=G[0]+(G[7]<<16|G[7]>>>16)+(G[6]<<16|G[6]>>>16)|0,X[1]=G[1]+(G[0]<<8|G[0]>>>24)+G[7]|0,X[2]=G[2]+(G[1]<<16|G[1]>>>16)+(G[0]<<16|G[0]>>>16)|0,X[3]=G[3]+(G[2]<<8|G[2]>>>24)+G[1]|0,X[4]=G[4]+(G[3]<<16|G[3]>>>16)+(G[2]<<16|G[2]>>>16)|0,X[5]=G[5]+(G[4]<<8|G[4]>>>24)+G[3]|0,X[6]=G[6]+(G[5]<<16|G[5]>>>16)+(G[4]<<16|G[4]>>>16)|0,X[7]=G[7]+(G[6]<<8|G[6]>>>24)+G[5]|0}C.RabbitLegacy=StreamCipher._createHelper(RabbitLegacy)}(),CryptoJS.RabbitLegacy)},"./node_modules/crypto-js/rabbit.js":function(module,exports,__webpack_require__){var CryptoJS;module.exports=(CryptoJS=__webpack_require__("./node_modules/crypto-js/core.js"),__webpack_require__("./node_modules/crypto-js/enc-base64.js"),__webpack_require__("./node_modules/crypto-js/md5.js"),__webpack_require__("./node_modules/crypto-js/evpkdf.js"),__webpack_require__("./node_modules/crypto-js/cipher-core.js"),function(){var C=CryptoJS,StreamCipher=C.lib.StreamCipher,S=[],C_=[],G=[],Rabbit=C.algo.Rabbit=StreamCipher.extend({_doReset:function(){for(var K=this._key.words,iv=this.cfg.iv,i=0;i<4;i++)K[i]=16711935&(K[i]<<8|K[i]>>>24)|4278255360&(K[i]<<24|K[i]>>>8);var X=this._X=[K[0],K[3]<<16|K[2]>>>16,K[1],K[0]<<16|K[3]>>>16,K[2],K[1]<<16|K[0]>>>16,K[3],K[2]<<16|K[1]>>>16],C=this._C=[K[2]<<16|K[2]>>>16,4294901760&K[0]|65535&K[1],K[3]<<16|K[3]>>>16,4294901760&K[1]|65535&K[2],K[0]<<16|K[0]>>>16,4294901760&K[2]|65535&K[3],K[1]<<16|K[1]>>>16,4294901760&K[3]|65535&K[0]];for(this._b=0,i=0;i<4;i++)nextState.call(this);for(i=0;i<8;i++)C[i]^=X[i+4&7];if(iv){var IV=iv.words,IV_0=IV[0],IV_1=IV[1],i0=16711935&(IV_0<<8|IV_0>>>24)|4278255360&(IV_0<<24|IV_0>>>8),i2=16711935&(IV_1<<8|IV_1>>>24)|4278255360&(IV_1<<24|IV_1>>>8),i1=i0>>>16|4294901760&i2,i3=i2<<16|65535&i0;for(C[0]^=i0,C[1]^=i1,C[2]^=i2,C[3]^=i3,C[4]^=i0,C[5]^=i1,C[6]^=i2,C[7]^=i3,i=0;i<4;i++)nextState.call(this)}},_doProcessBlock:function(M,offset){var X=this._X;nextState.call(this),S[0]=X[0]^X[5]>>>16^X[3]<<16,S[1]=X[2]^X[7]>>>16^X[5]<<16,S[2]=X[4]^X[1]>>>16^X[7]<<16,S[3]=X[6]^X[3]>>>16^X[1]<<16;for(var i=0;i<4;i++)S[i]=16711935&(S[i]<<8|S[i]>>>24)|4278255360&(S[i]<<24|S[i]>>>8),M[offset+i]^=S[i]},blockSize:4,ivSize:2});function nextState(){for(var X=this._X,C=this._C,i=0;i<8;i++)C_[i]=C[i];for(C[0]=C[0]+1295307597+this._b|0,C[1]=C[1]+3545052371+(C[0]>>>0<C_[0]>>>0?1:0)|0,C[2]=C[2]+886263092+(C[1]>>>0<C_[1]>>>0?1:0)|0,C[3]=C[3]+1295307597+(C[2]>>>0<C_[2]>>>0?1:0)|0,C[4]=C[4]+3545052371+(C[3]>>>0<C_[3]>>>0?1:0)|0,C[5]=C[5]+886263092+(C[4]>>>0<C_[4]>>>0?1:0)|0,C[6]=C[6]+1295307597+(C[5]>>>0<C_[5]>>>0?1:0)|0,C[7]=C[7]+3545052371+(C[6]>>>0<C_[6]>>>0?1:0)|0,this._b=C[7]>>>0<C_[7]>>>0?1:0,i=0;i<8;i++){var gx=X[i]+C[i],ga=65535&gx,gb=gx>>>16,gh=((ga*ga>>>17)+ga*gb>>>15)+gb*gb,gl=((4294901760&gx)*gx|0)+((65535&gx)*gx|0);G[i]=gh^gl}X[0]=G[0]+(G[7]<<16|G[7]>>>16)+(G[6]<<16|G[6]>>>16)|0,X[1]=G[1]+(G[0]<<8|G[0]>>>24)+G[7]|0,X[2]=G[2]+(G[1]<<16|G[1]>>>16)+(G[0]<<16|G[0]>>>16)|0,X[3]=G[3]+(G[2]<<8|G[2]>>>24)+G[1]|0,X[4]=G[4]+(G[3]<<16|G[3]>>>16)+(G[2]<<16|G[2]>>>16)|0,X[5]=G[5]+(G[4]<<8|G[4]>>>24)+G[3]|0,X[6]=G[6]+(G[5]<<16|G[5]>>>16)+(G[4]<<16|G[4]>>>16)|0,X[7]=G[7]+(G[6]<<8|G[6]>>>24)+G[5]|0}C.Rabbit=StreamCipher._createHelper(Rabbit)}(),CryptoJS.Rabbit)},"./node_modules/crypto-js/rc4.js":function(module,exports,__webpack_require__){var CryptoJS;module.exports=(CryptoJS=__webpack_require__("./node_modules/crypto-js/core.js"),__webpack_require__("./node_modules/crypto-js/enc-base64.js"),__webpack_require__("./node_modules/crypto-js/md5.js"),__webpack_require__("./node_modules/crypto-js/evpkdf.js"),__webpack_require__("./node_modules/crypto-js/cipher-core.js"),function(){var C=CryptoJS,StreamCipher=C.lib.StreamCipher,C_algo=C.algo,RC4=C_algo.RC4=StreamCipher.extend({_doReset:function(){for(var key=this._key,keyWords=key.words,keySigBytes=key.sigBytes,S=this._S=[],i=0;i<256;i++)S[i]=i;i=0;for(var j=0;i<256;i++){var keyByteIndex=i%keySigBytes,keyByte=keyWords[keyByteIndex>>>2]>>>24-keyByteIndex%4*8&255;j=(j+S[i]+keyByte)%256;var t=S[i];S[i]=S[j],S[j]=t}this._i=this._j=0},_doProcessBlock:function(M,offset){M[offset]^=generateKeystreamWord.call(this)},keySize:8,ivSize:0});function generateKeystreamWord(){for(var S=this._S,i=this._i,j=this._j,keystreamWord=0,n=0;n<4;n++){j=(j+S[i=(i+1)%256])%256;var t=S[i];S[i]=S[j],S[j]=t,keystreamWord|=S[(S[i]+S[j])%256]<<24-8*n}return this._i=i,this._j=j,keystreamWord}C.RC4=StreamCipher._createHelper(RC4);var RC4Drop=C_algo.RC4Drop=RC4.extend({cfg:RC4.cfg.extend({drop:192}),_doReset:function(){RC4._doReset.call(this);for(var i=this.cfg.drop;i>0;i--)generateKeystreamWord.call(this)}});C.RC4Drop=StreamCipher._createHelper(RC4Drop)}(),CryptoJS.RC4)},"./node_modules/crypto-js/ripemd160.js":function(module,exports,__webpack_require__){var CryptoJS;module.exports=(CryptoJS=__webpack_require__("./node_modules/crypto-js/core.js"),function(Math){var C=CryptoJS,C_lib=C.lib,WordArray=C_lib.WordArray,Hasher=C_lib.Hasher,C_algo=C.algo,_zl=WordArray.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),_zr=WordArray.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),_sl=WordArray.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),_sr=WordArray.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),_hl=WordArray.create([0,1518500249,1859775393,2400959708,2840853838]),_hr=WordArray.create([1352829926,1548603684,1836072691,2053994217,0]),RIPEMD160=C_algo.RIPEMD160=Hasher.extend({_doReset:function(){this._hash=WordArray.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(M,offset){for(var i=0;i<16;i++){var offset_i=offset+i,M_offset_i=M[offset_i];M[offset_i]=16711935&(M_offset_i<<8|M_offset_i>>>24)|4278255360&(M_offset_i<<24|M_offset_i>>>8)}var al,bl,cl,dl,el,ar,br,cr,dr,er,t,H=this._hash.words,hl=_hl.words,hr=_hr.words,zl=_zl.words,zr=_zr.words,sl=_sl.words,sr=_sr.words;for(ar=al=H[0],br=bl=H[1],cr=cl=H[2],dr=dl=H[3],er=el=H[4],i=0;i<80;i+=1)t=al+M[offset+zl[i]]|0,t+=i<16?f1(bl,cl,dl)+hl[0]:i<32?f2(bl,cl,dl)+hl[1]:i<48?f3(bl,cl,dl)+hl[2]:i<64?f4(bl,cl,dl)+hl[3]:f5(bl,cl,dl)+hl[4],t=(t=rotl(t|=0,sl[i]))+el|0,al=el,el=dl,dl=rotl(cl,10),cl=bl,bl=t,t=ar+M[offset+zr[i]]|0,t+=i<16?f5(br,cr,dr)+hr[0]:i<32?f4(br,cr,dr)+hr[1]:i<48?f3(br,cr,dr)+hr[2]:i<64?f2(br,cr,dr)+hr[3]:f1(br,cr,dr)+hr[4],t=(t=rotl(t|=0,sr[i]))+er|0,ar=er,er=dr,dr=rotl(cr,10),cr=br,br=t;t=H[1]+cl+dr|0,H[1]=H[2]+dl+er|0,H[2]=H[3]+el+ar|0,H[3]=H[4]+al+br|0,H[4]=H[0]+bl+cr|0,H[0]=t},_doFinalize:function(){var data=this._data,dataWords=data.words,nBitsTotal=8*this._nDataBytes,nBitsLeft=8*data.sigBytes;dataWords[nBitsLeft>>>5]|=128<<24-nBitsLeft%32,dataWords[14+(nBitsLeft+64>>>9<<4)]=16711935&(nBitsTotal<<8|nBitsTotal>>>24)|4278255360&(nBitsTotal<<24|nBitsTotal>>>8),data.sigBytes=4*(dataWords.length+1),this._process();for(var hash=this._hash,H=hash.words,i=0;i<5;i++){var H_i=H[i];H[i]=16711935&(H_i<<8|H_i>>>24)|4278255360&(H_i<<24|H_i>>>8)}return hash},clone:function(){var clone=Hasher.clone.call(this);return clone._hash=this._hash.clone(),clone}});function f1(x,y,z){return x^y^z}function f2(x,y,z){return x&y|~x&z}function f3(x,y,z){return(x|~y)^z}function f4(x,y,z){return x&z|y&~z}function f5(x,y,z){return x^(y|~z)}function rotl(x,n){return x<<n|x>>>32-n}C.RIPEMD160=Hasher._createHelper(RIPEMD160),C.HmacRIPEMD160=Hasher._createHmacHelper(RIPEMD160)}(Math),CryptoJS.RIPEMD160)},"./node_modules/crypto-js/sha1.js":function(module,exports,__webpack_require__){var CryptoJS,C,C_lib,WordArray,Hasher,W,SHA1;module.exports=(CryptoJS=__webpack_require__("./node_modules/crypto-js/core.js"),C_lib=(C=CryptoJS).lib,WordArray=C_lib.WordArray,Hasher=C_lib.Hasher,W=[],SHA1=C.algo.SHA1=Hasher.extend({_doReset:function(){this._hash=new WordArray.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(M,offset){for(var H=this._hash.words,a=H[0],b=H[1],c=H[2],d=H[3],e=H[4],i=0;i<80;i++){if(i<16)W[i]=0|M[offset+i];else{var n=W[i-3]^W[i-8]^W[i-14]^W[i-16];W[i]=n<<1|n>>>31}var t=(a<<5|a>>>27)+e+W[i];t+=i<20?1518500249+(b&c|~b&d):i<40?1859775393+(b^c^d):i<60?(b&c|b&d|c&d)-1894007588:(b^c^d)-899497514,e=d,d=c,c=b<<30|b>>>2,b=a,a=t}H[0]=H[0]+a|0,H[1]=H[1]+b|0,H[2]=H[2]+c|0,H[3]=H[3]+d|0,H[4]=H[4]+e|0},_doFinalize:function(){var data=this._data,dataWords=data.words,nBitsTotal=8*this._nDataBytes,nBitsLeft=8*data.sigBytes;return dataWords[nBitsLeft>>>5]|=128<<24-nBitsLeft%32,dataWords[14+(nBitsLeft+64>>>9<<4)]=Math.floor(nBitsTotal/4294967296),dataWords[15+(nBitsLeft+64>>>9<<4)]=nBitsTotal,data.sigBytes=4*dataWords.length,this._process(),this._hash},clone:function(){var clone=Hasher.clone.call(this);return clone._hash=this._hash.clone(),clone}}),C.SHA1=Hasher._createHelper(SHA1),C.HmacSHA1=Hasher._createHmacHelper(SHA1),CryptoJS.SHA1)},"./node_modules/crypto-js/sha224.js":function(module,exports,__webpack_require__){var CryptoJS,C,WordArray,C_algo,SHA256,SHA224;module.exports=(CryptoJS=__webpack_require__("./node_modules/crypto-js/core.js"),__webpack_require__("./node_modules/crypto-js/sha256.js"),WordArray=(C=CryptoJS).lib.WordArray,C_algo=C.algo,SHA256=C_algo.SHA256,SHA224=C_algo.SHA224=SHA256.extend({_doReset:function(){this._hash=new WordArray.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var hash=SHA256._doFinalize.call(this);return hash.sigBytes-=4,hash}}),C.SHA224=SHA256._createHelper(SHA224),C.HmacSHA224=SHA256._createHmacHelper(SHA224),CryptoJS.SHA224)},"./node_modules/crypto-js/sha256.js":function(module,exports,__webpack_require__){var CryptoJS;module.exports=(CryptoJS=__webpack_require__("./node_modules/crypto-js/core.js"),function(Math){var C=CryptoJS,C_lib=C.lib,WordArray=C_lib.WordArray,Hasher=C_lib.Hasher,C_algo=C.algo,H=[],K=[];!function(){function isPrime(n){for(var sqrtN=Math.sqrt(n),factor=2;factor<=sqrtN;factor++)if(!(n%factor))return!1;return!0}function getFractionalBits(n){return 4294967296*(n-(0|n))|0}for(var n=2,nPrime=0;nPrime<64;)isPrime(n)&&(nPrime<8&&(H[nPrime]=getFractionalBits(Math.pow(n,.5))),K[nPrime]=getFractionalBits(Math.pow(n,1/3)),nPrime++),n++}();var W=[],SHA256=C_algo.SHA256=Hasher.extend({_doReset:function(){this._hash=new WordArray.init(H.slice(0))},_doProcessBlock:function(M,offset){for(var H=this._hash.words,a=H[0],b=H[1],c=H[2],d=H[3],e=H[4],f=H[5],g=H[6],h=H[7],i=0;i<64;i++){if(i<16)W[i]=0|M[offset+i];else{var gamma0x=W[i-15],gamma0=(gamma0x<<25|gamma0x>>>7)^(gamma0x<<14|gamma0x>>>18)^gamma0x>>>3,gamma1x=W[i-2],gamma1=(gamma1x<<15|gamma1x>>>17)^(gamma1x<<13|gamma1x>>>19)^gamma1x>>>10;W[i]=gamma0+W[i-7]+gamma1+W[i-16]}var maj=a&b^a&c^b&c,sigma0=(a<<30|a>>>2)^(a<<19|a>>>13)^(a<<10|a>>>22),t1=h+((e<<26|e>>>6)^(e<<21|e>>>11)^(e<<7|e>>>25))+(e&f^~e&g)+K[i]+W[i];h=g,g=f,f=e,e=d+t1|0,d=c,c=b,b=a,a=t1+(sigma0+maj)|0}H[0]=H[0]+a|0,H[1]=H[1]+b|0,H[2]=H[2]+c|0,H[3]=H[3]+d|0,H[4]=H[4]+e|0,H[5]=H[5]+f|0,H[6]=H[6]+g|0,H[7]=H[7]+h|0},_doFinalize:function(){var data=this._data,dataWords=data.words,nBitsTotal=8*this._nDataBytes,nBitsLeft=8*data.sigBytes;return dataWords[nBitsLeft>>>5]|=128<<24-nBitsLeft%32,dataWords[14+(nBitsLeft+64>>>9<<4)]=Math.floor(nBitsTotal/4294967296),dataWords[15+(nBitsLeft+64>>>9<<4)]=nBitsTotal,data.sigBytes=4*dataWords.length,this._process(),this._hash},clone:function(){var clone=Hasher.clone.call(this);return clone._hash=this._hash.clone(),clone}});C.SHA256=Hasher._createHelper(SHA256),C.HmacSHA256=Hasher._createHmacHelper(SHA256)}(Math),CryptoJS.SHA256)},"./node_modules/crypto-js/sha3.js":function(module,exports,__webpack_require__){var CryptoJS;module.exports=(CryptoJS=__webpack_require__("./node_modules/crypto-js/core.js"),__webpack_require__("./node_modules/crypto-js/x64-core.js"),function(Math){var C=CryptoJS,C_lib=C.lib,WordArray=C_lib.WordArray,Hasher=C_lib.Hasher,X64Word=C.x64.Word,C_algo=C.algo,RHO_OFFSETS=[],PI_INDEXES=[],ROUND_CONSTANTS=[];!function(){for(var x=1,y=0,t=0;t<24;t++){RHO_OFFSETS[x+5*y]=(t+1)*(t+2)/2%64;var newY=(2*x+3*y)%5;x=y%5,y=newY}for(x=0;x<5;x++)for(y=0;y<5;y++)PI_INDEXES[x+5*y]=y+(2*x+3*y)%5*5;for(var LFSR=1,i=0;i<24;i++){for(var roundConstantMsw=0,roundConstantLsw=0,j=0;j<7;j++){if(1&LFSR){var bitPosition=(1<<j)-1;bitPosition<32?roundConstantLsw^=1<<bitPosition:roundConstantMsw^=1<<bitPosition-32}128&LFSR?LFSR=LFSR<<1^113:LFSR<<=1}ROUND_CONSTANTS[i]=X64Word.create(roundConstantMsw,roundConstantLsw)}}();var T=[];!function(){for(var i=0;i<25;i++)T[i]=X64Word.create()}();var SHA3=C_algo.SHA3=Hasher.extend({cfg:Hasher.cfg.extend({outputLength:512}),_doReset:function(){for(var state=this._state=[],i=0;i<25;i++)state[i]=new X64Word.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(M,offset){for(var state=this._state,nBlockSizeLanes=this.blockSize/2,i=0;i<nBlockSizeLanes;i++){var M2i=M[offset+2*i],M2i1=M[offset+2*i+1];M2i=16711935&(M2i<<8|M2i>>>24)|4278255360&(M2i<<24|M2i>>>8),M2i1=16711935&(M2i1<<8|M2i1>>>24)|4278255360&(M2i1<<24|M2i1>>>8),(lane=state[i]).high^=M2i1,lane.low^=M2i}for(var round=0;round<24;round++){for(var x=0;x<5;x++){for(var tMsw=0,tLsw=0,y=0;y<5;y++)tMsw^=(lane=state[x+5*y]).high,tLsw^=lane.low;var Tx=T[x];Tx.high=tMsw,Tx.low=tLsw}for(x=0;x<5;x++){var Tx4=T[(x+4)%5],Tx1=T[(x+1)%5],Tx1Msw=Tx1.high,Tx1Lsw=Tx1.low;for(tMsw=Tx4.high^(Tx1Msw<<1|Tx1Lsw>>>31),tLsw=Tx4.low^(Tx1Lsw<<1|Tx1Msw>>>31),y=0;y<5;y++)(lane=state[x+5*y]).high^=tMsw,lane.low^=tLsw}for(var laneIndex=1;laneIndex<25;laneIndex++){var laneMsw=(lane=state[laneIndex]).high,laneLsw=lane.low,rhoOffset=RHO_OFFSETS[laneIndex];rhoOffset<32?(tMsw=laneMsw<<rhoOffset|laneLsw>>>32-rhoOffset,tLsw=laneLsw<<rhoOffset|laneMsw>>>32-rhoOffset):(tMsw=laneLsw<<rhoOffset-32|laneMsw>>>64-rhoOffset,tLsw=laneMsw<<rhoOffset-32|laneLsw>>>64-rhoOffset);var TPiLane=T[PI_INDEXES[laneIndex]];TPiLane.high=tMsw,TPiLane.low=tLsw}var T0=T[0],state0=state[0];for(T0.high=state0.high,T0.low=state0.low,x=0;x<5;x++)for(y=0;y<5;y++){var lane=state[laneIndex=x+5*y],TLane=T[laneIndex],Tx1Lane=T[(x+1)%5+5*y],Tx2Lane=T[(x+2)%5+5*y];lane.high=TLane.high^~Tx1Lane.high&Tx2Lane.high,lane.low=TLane.low^~Tx1Lane.low&Tx2Lane.low}lane=state[0];var roundConstant=ROUND_CONSTANTS[round];lane.high^=roundConstant.high,lane.low^=roundConstant.low}},_doFinalize:function(){var data=this._data,dataWords=data.words,nBitsLeft=(this._nDataBytes,8*data.sigBytes),blockSizeBits=32*this.blockSize;dataWords[nBitsLeft>>>5]|=1<<24-nBitsLeft%32,dataWords[(Math.ceil((nBitsLeft+1)/blockSizeBits)*blockSizeBits>>>5)-1]|=128,data.sigBytes=4*dataWords.length,this._process();for(var state=this._state,outputLengthBytes=this.cfg.outputLength/8,outputLengthLanes=outputLengthBytes/8,hashWords=[],i=0;i<outputLengthLanes;i++){var lane=state[i],laneMsw=lane.high,laneLsw=lane.low;laneMsw=16711935&(laneMsw<<8|laneMsw>>>24)|4278255360&(laneMsw<<24|laneMsw>>>8),laneLsw=16711935&(laneLsw<<8|laneLsw>>>24)|4278255360&(laneLsw<<24|laneLsw>>>8),hashWords.push(laneLsw),hashWords.push(laneMsw)}return new WordArray.init(hashWords,outputLengthBytes)},clone:function(){for(var clone=Hasher.clone.call(this),state=clone._state=this._state.slice(0),i=0;i<25;i++)state[i]=state[i].clone();return clone}});C.SHA3=Hasher._createHelper(SHA3),C.HmacSHA3=Hasher._createHmacHelper(SHA3)}(Math),CryptoJS.SHA3)},"./node_modules/crypto-js/sha384.js":function(module,exports,__webpack_require__){var CryptoJS,C,C_x64,X64Word,X64WordArray,C_algo,SHA512,SHA384;module.exports=(CryptoJS=__webpack_require__("./node_modules/crypto-js/core.js"),__webpack_require__("./node_modules/crypto-js/x64-core.js"),__webpack_require__("./node_modules/crypto-js/sha512.js"),C_x64=(C=CryptoJS).x64,X64Word=C_x64.Word,X64WordArray=C_x64.WordArray,C_algo=C.algo,SHA512=C_algo.SHA512,SHA384=C_algo.SHA384=SHA512.extend({_doReset:function(){this._hash=new X64WordArray.init([new X64Word.init(3418070365,3238371032),new X64Word.init(1654270250,914150663),new X64Word.init(2438529370,812702999),new X64Word.init(355462360,4144912697),new X64Word.init(1731405415,4290775857),new X64Word.init(2394180231,1750603025),new X64Word.init(3675008525,1694076839),new X64Word.init(1203062813,3204075428)])},_doFinalize:function(){var hash=SHA512._doFinalize.call(this);return hash.sigBytes-=16,hash}}),C.SHA384=SHA512._createHelper(SHA384),C.HmacSHA384=SHA512._createHmacHelper(SHA384),CryptoJS.SHA384)},"./node_modules/crypto-js/sha512.js":function(module,exports,__webpack_require__){var CryptoJS;module.exports=(CryptoJS=__webpack_require__("./node_modules/crypto-js/core.js"),__webpack_require__("./node_modules/crypto-js/x64-core.js"),function(){var C=CryptoJS,Hasher=C.lib.Hasher,C_x64=C.x64,X64Word=C_x64.Word,X64WordArray=C_x64.WordArray,C_algo=C.algo;function X64Word_create(){return X64Word.create.apply(X64Word,arguments)}var K=[X64Word_create(1116352408,3609767458),X64Word_create(1899447441,602891725),X64Word_create(3049323471,3964484399),X64Word_create(3921009573,2173295548),X64Word_create(961987163,4081628472),X64Word_create(1508970993,3053834265),X64Word_create(2453635748,2937671579),X64Word_create(2870763221,3664609560),X64Word_create(3624381080,2734883394),X64Word_create(310598401,1164996542),X64Word_create(607225278,1323610764),X64Word_create(1426881987,3590304994),X64Word_create(1925078388,4068182383),X64Word_create(2162078206,991336113),X64Word_create(2614888103,633803317),X64Word_create(3248222580,3479774868),X64Word_create(3835390401,2666613458),X64Word_create(4022224774,944711139),X64Word_create(264347078,2341262773),X64Word_create(604807628,2007800933),X64Word_create(770255983,1495990901),X64Word_create(1249150122,1856431235),X64Word_create(1555081692,3175218132),X64Word_create(1996064986,2198950837),X64Word_create(2554220882,3999719339),X64Word_create(2821834349,766784016),X64Word_create(2952996808,2566594879),X64Word_create(3210313671,3203337956),X64Word_create(3336571891,1034457026),X64Word_create(3584528711,2466948901),X64Word_create(113926993,3758326383),X64Word_create(338241895,168717936),X64Word_create(666307205,1188179964),X64Word_create(773529912,1546045734),X64Word_create(1294757372,1522805485),X64Word_create(1396182291,2643833823),X64Word_create(1695183700,2343527390),X64Word_create(1986661051,1014477480),X64Word_create(2177026350,1206759142),X64Word_create(2456956037,344077627),X64Word_create(2730485921,1290863460),X64Word_create(2820302411,3158454273),X64Word_create(3259730800,3505952657),X64Word_create(3345764771,106217008),X64Word_create(3516065817,3606008344),X64Word_create(3600352804,1432725776),X64Word_create(4094571909,1467031594),X64Word_create(275423344,851169720),X64Word_create(430227734,3100823752),X64Word_create(506948616,1363258195),X64Word_create(659060556,3750685593),X64Word_create(883997877,3785050280),X64Word_create(958139571,3318307427),X64Word_create(1322822218,3812723403),X64Word_create(1537002063,2003034995),X64Word_create(1747873779,3602036899),X64Word_create(1955562222,1575990012),X64Word_create(2024104815,1125592928),X64Word_create(2227730452,2716904306),X64Word_create(2361852424,442776044),X64Word_create(2428436474,593698344),X64Word_create(2756734187,3733110249),X64Word_create(3204031479,2999351573),X64Word_create(3329325298,3815920427),X64Word_create(3391569614,3928383900),X64Word_create(3515267271,566280711),X64Word_create(3940187606,3454069534),X64Word_create(4118630271,4000239992),X64Word_create(116418474,1914138554),X64Word_create(174292421,2731055270),X64Word_create(289380356,3203993006),X64Word_create(460393269,320620315),X64Word_create(685471733,587496836),X64Word_create(852142971,1086792851),X64Word_create(1017036298,365543100),X64Word_create(1126000580,2618297676),X64Word_create(1288033470,3409855158),X64Word_create(1501505948,4234509866),X64Word_create(1607167915,987167468),X64Word_create(1816402316,1246189591)],W=[];!function(){for(var i=0;i<80;i++)W[i]=X64Word_create()}();var SHA512=C_algo.SHA512=Hasher.extend({_doReset:function(){this._hash=new X64WordArray.init([new X64Word.init(1779033703,4089235720),new X64Word.init(3144134277,2227873595),new X64Word.init(1013904242,4271175723),new X64Word.init(2773480762,1595750129),new X64Word.init(1359893119,2917565137),new X64Word.init(2600822924,725511199),new X64Word.init(528734635,4215389547),new X64Word.init(1541459225,327033209)])},_doProcessBlock:function(M,offset){for(var H=this._hash.words,H0=H[0],H1=H[1],H2=H[2],H3=H[3],H4=H[4],H5=H[5],H6=H[6],H7=H[7],H0h=H0.high,H0l=H0.low,H1h=H1.high,H1l=H1.low,H2h=H2.high,H2l=H2.low,H3h=H3.high,H3l=H3.low,H4h=H4.high,H4l=H4.low,H5h=H5.high,H5l=H5.low,H6h=H6.high,H6l=H6.low,H7h=H7.high,H7l=H7.low,ah=H0h,al=H0l,bh=H1h,bl=H1l,ch=H2h,cl=H2l,dh=H3h,dl=H3l,eh=H4h,el=H4l,fh=H5h,fl=H5l,gh=H6h,gl=H6l,hh=H7h,hl=H7l,i=0;i<80;i++){var Wi=W[i];if(i<16)var Wih=Wi.high=0|M[offset+2*i],Wil=Wi.low=0|M[offset+2*i+1];else{var gamma0x=W[i-15],gamma0xh=gamma0x.high,gamma0xl=gamma0x.low,gamma0h=(gamma0xh>>>1|gamma0xl<<31)^(gamma0xh>>>8|gamma0xl<<24)^gamma0xh>>>7,gamma0l=(gamma0xl>>>1|gamma0xh<<31)^(gamma0xl>>>8|gamma0xh<<24)^(gamma0xl>>>7|gamma0xh<<25),gamma1x=W[i-2],gamma1xh=gamma1x.high,gamma1xl=gamma1x.low,gamma1h=(gamma1xh>>>19|gamma1xl<<13)^(gamma1xh<<3|gamma1xl>>>29)^gamma1xh>>>6,gamma1l=(gamma1xl>>>19|gamma1xh<<13)^(gamma1xl<<3|gamma1xh>>>29)^(gamma1xl>>>6|gamma1xh<<26),Wi7=W[i-7],Wi7h=Wi7.high,Wi7l=Wi7.low,Wi16=W[i-16],Wi16h=Wi16.high,Wi16l=Wi16.low;Wih=(Wih=(Wih=gamma0h+Wi7h+((Wil=gamma0l+Wi7l)>>>0<gamma0l>>>0?1:0))+gamma1h+((Wil+=gamma1l)>>>0<gamma1l>>>0?1:0))+Wi16h+((Wil+=Wi16l)>>>0<Wi16l>>>0?1:0),Wi.high=Wih,Wi.low=Wil}var t1l,chh=eh&fh^~eh&gh,chl=el&fl^~el&gl,majh=ah&bh^ah&ch^bh&ch,majl=al&bl^al&cl^bl&cl,sigma0h=(ah>>>28|al<<4)^(ah<<30|al>>>2)^(ah<<25|al>>>7),sigma0l=(al>>>28|ah<<4)^(al<<30|ah>>>2)^(al<<25|ah>>>7),sigma1h=(eh>>>14|el<<18)^(eh>>>18|el<<14)^(eh<<23|el>>>9),sigma1l=(el>>>14|eh<<18)^(el>>>18|eh<<14)^(el<<23|eh>>>9),Ki=K[i],Kih=Ki.high,Kil=Ki.low,t1h=hh+sigma1h+((t1l=hl+sigma1l)>>>0<hl>>>0?1:0),t2l=sigma0l+majl;hh=gh,hl=gl,gh=fh,gl=fl,fh=eh,fl=el,eh=dh+(t1h=(t1h=(t1h=t1h+chh+((t1l+=chl)>>>0<chl>>>0?1:0))+Kih+((t1l+=Kil)>>>0<Kil>>>0?1:0))+Wih+((t1l+=Wil)>>>0<Wil>>>0?1:0))+((el=dl+t1l|0)>>>0<dl>>>0?1:0)|0,dh=ch,dl=cl,ch=bh,cl=bl,bh=ah,bl=al,ah=t1h+(sigma0h+majh+(t2l>>>0<sigma0l>>>0?1:0))+((al=t1l+t2l|0)>>>0<t1l>>>0?1:0)|0}H0l=H0.low=H0l+al,H0.high=H0h+ah+(H0l>>>0<al>>>0?1:0),H1l=H1.low=H1l+bl,H1.high=H1h+bh+(H1l>>>0<bl>>>0?1:0),H2l=H2.low=H2l+cl,H2.high=H2h+ch+(H2l>>>0<cl>>>0?1:0),H3l=H3.low=H3l+dl,H3.high=H3h+dh+(H3l>>>0<dl>>>0?1:0),H4l=H4.low=H4l+el,H4.high=H4h+eh+(H4l>>>0<el>>>0?1:0),H5l=H5.low=H5l+fl,H5.high=H5h+fh+(H5l>>>0<fl>>>0?1:0),H6l=H6.low=H6l+gl,H6.high=H6h+gh+(H6l>>>0<gl>>>0?1:0),H7l=H7.low=H7l+hl,H7.high=H7h+hh+(H7l>>>0<hl>>>0?1:0)},_doFinalize:function(){var data=this._data,dataWords=data.words,nBitsTotal=8*this._nDataBytes,nBitsLeft=8*data.sigBytes;return dataWords[nBitsLeft>>>5]|=128<<24-nBitsLeft%32,dataWords[30+(nBitsLeft+128>>>10<<5)]=Math.floor(nBitsTotal/4294967296),dataWords[31+(nBitsLeft+128>>>10<<5)]=nBitsTotal,data.sigBytes=4*dataWords.length,this._process(),this._hash.toX32()},clone:function(){var clone=Hasher.clone.call(this);return clone._hash=this._hash.clone(),clone},blockSize:32});C.SHA512=Hasher._createHelper(SHA512),C.HmacSHA512=Hasher._createHmacHelper(SHA512)}(),CryptoJS.SHA512)},"./node_modules/crypto-js/tripledes.js":function(module,exports,__webpack_require__){var CryptoJS;module.exports=(CryptoJS=__webpack_require__("./node_modules/crypto-js/core.js"),__webpack_require__("./node_modules/crypto-js/enc-base64.js"),__webpack_require__("./node_modules/crypto-js/md5.js"),__webpack_require__("./node_modules/crypto-js/evpkdf.js"),__webpack_require__("./node_modules/crypto-js/cipher-core.js"),function(){var C=CryptoJS,C_lib=C.lib,WordArray=C_lib.WordArray,BlockCipher=C_lib.BlockCipher,C_algo=C.algo,PC1=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],PC2=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],BIT_SHIFTS=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],SBOX_P=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],SBOX_MASK=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],DES=C_algo.DES=BlockCipher.extend({_doReset:function(){for(var keyWords=this._key.words,keyBits=[],i=0;i<56;i++){var keyBitPos=PC1[i]-1;keyBits[i]=keyWords[keyBitPos>>>5]>>>31-keyBitPos%32&1}for(var subKeys=this._subKeys=[],nSubKey=0;nSubKey<16;nSubKey++){var subKey=subKeys[nSubKey]=[],bitShift=BIT_SHIFTS[nSubKey];for(i=0;i<24;i++)subKey[i/6|0]|=keyBits[(PC2[i]-1+bitShift)%28]<<31-i%6,subKey[4+(i/6|0)]|=keyBits[28+(PC2[i+24]-1+bitShift)%28]<<31-i%6;for(subKey[0]=subKey[0]<<1|subKey[0]>>>31,i=1;i<7;i++)subKey[i]=subKey[i]>>>4*(i-1)+3;subKey[7]=subKey[7]<<5|subKey[7]>>>27}var invSubKeys=this._invSubKeys=[];for(i=0;i<16;i++)invSubKeys[i]=subKeys[15-i]},encryptBlock:function(M,offset){this._doCryptBlock(M,offset,this._subKeys)},decryptBlock:function(M,offset){this._doCryptBlock(M,offset,this._invSubKeys)},_doCryptBlock:function(M,offset,subKeys){this._lBlock=M[offset],this._rBlock=M[offset+1],exchangeLR.call(this,4,252645135),exchangeLR.call(this,16,65535),exchangeRL.call(this,2,858993459),exchangeRL.call(this,8,16711935),exchangeLR.call(this,1,1431655765);for(var round=0;round<16;round++){for(var subKey=subKeys[round],lBlock=this._lBlock,rBlock=this._rBlock,f=0,i=0;i<8;i++)f|=SBOX_P[i][((rBlock^subKey[i])&SBOX_MASK[i])>>>0];this._lBlock=rBlock,this._rBlock=lBlock^f}var t=this._lBlock;this._lBlock=this._rBlock,this._rBlock=t,exchangeLR.call(this,1,1431655765),exchangeRL.call(this,8,16711935),exchangeRL.call(this,2,858993459),exchangeLR.call(this,16,65535),exchangeLR.call(this,4,252645135),M[offset]=this._lBlock,M[offset+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});function exchangeLR(offset,mask){var t=(this._lBlock>>>offset^this._rBlock)&mask;this._rBlock^=t,this._lBlock^=t<<offset}function exchangeRL(offset,mask){var t=(this._rBlock>>>offset^this._lBlock)&mask;this._lBlock^=t,this._rBlock^=t<<offset}C.DES=BlockCipher._createHelper(DES);var TripleDES=C_algo.TripleDES=BlockCipher.extend({_doReset:function(){var keyWords=this._key.words;this._des1=DES.createEncryptor(WordArray.create(keyWords.slice(0,2))),this._des2=DES.createEncryptor(WordArray.create(keyWords.slice(2,4))),this._des3=DES.createEncryptor(WordArray.create(keyWords.slice(4,6)))},encryptBlock:function(M,offset){this._des1.encryptBlock(M,offset),this._des2.decryptBlock(M,offset),this._des3.encryptBlock(M,offset)},decryptBlock:function(M,offset){this._des3.decryptBlock(M,offset),this._des2.encryptBlock(M,offset),this._des1.decryptBlock(M,offset)},keySize:6,ivSize:2,blockSize:2});C.TripleDES=BlockCipher._createHelper(TripleDES)}(),CryptoJS.TripleDES)},"./node_modules/crypto-js/x64-core.js":function(module,exports,__webpack_require__){var CryptoJS,C,C_lib,Base,X32WordArray,C_x64;module.exports=(CryptoJS=__webpack_require__("./node_modules/crypto-js/core.js"),C_lib=(C=CryptoJS).lib,Base=C_lib.Base,X32WordArray=C_lib.WordArray,(C_x64=C.x64={}).Word=Base.extend({init:function(high,low){this.high=high,this.low=low}}),C_x64.WordArray=Base.extend({init:function(words,sigBytes){words=this.words=words||[],this.sigBytes=void 0!=sigBytes?sigBytes:8*words.length},toX32:function(){for(var x64Words=this.words,x64WordsLength=x64Words.length,x32Words=[],i=0;i<x64WordsLength;i++){var x64Word=x64Words[i];x32Words.push(x64Word.high),x32Words.push(x64Word.low)}return X32WordArray.create(x32Words,this.sigBytes)},clone:function(){for(var clone=Base.clone.call(this),words=clone.words=this.words.slice(0),wordsLength=words.length,i=0;i<wordsLength;i++)words[i]=words[i].clone();return clone}}),CryptoJS)},"./node_modules/dat.gui/build/dat.gui.js":function(module,exports,__webpack_require__){!function(exports){"use strict";function colorToString(color,forceCSSHex){var colorFormat=color.__state.conversionName.toString(),r=Math.round(color.r),g=Math.round(color.g),b=Math.round(color.b),a=color.a,h=Math.round(color.h),s=color.s.toFixed(1),v=color.v.toFixed(1);if(forceCSSHex||"THREE_CHAR_HEX"===colorFormat||"SIX_CHAR_HEX"===colorFormat){for(var str=color.hex.toString(16);str.length<6;)str="0"+str;return"#"+str}return"CSS_RGB"===colorFormat?"rgb("+r+","+g+","+b+")":"CSS_RGBA"===colorFormat?"rgba("+r+","+g+","+b+","+a+")":"HEX"===colorFormat?"0x"+color.hex.toString(16):"RGB_ARRAY"===colorFormat?"["+r+","+g+","+b+"]":"RGBA_ARRAY"===colorFormat?"["+r+","+g+","+b+","+a+"]":"RGB_OBJ"===colorFormat?"{r:"+r+",g:"+g+",b:"+b+"}":"RGBA_OBJ"===colorFormat?"{r:"+r+",g:"+g+",b:"+b+",a:"+a+"}":"HSV_OBJ"===colorFormat?"{h:"+h+",s:"+s+",v:"+v+"}":"HSVA_OBJ"===colorFormat?"{h:"+h+",s:"+s+",v:"+v+",a:"+a+"}":"unknown format"}var ARR_EACH=Array.prototype.forEach,ARR_SLICE=Array.prototype.slice,Common={BREAK:{},extend:function(target){return this.each(ARR_SLICE.call(arguments,1),function(obj){var keys=this.isObject(obj)?Object.keys(obj):[];keys.forEach(function(key){this.isUndefined(obj[key])||(target[key]=obj[key])}.bind(this))},this),target},defaults:function(target){return this.each(ARR_SLICE.call(arguments,1),function(obj){var keys=this.isObject(obj)?Object.keys(obj):[];keys.forEach(function(key){this.isUndefined(target[key])&&(target[key]=obj[key])}.bind(this))},this),target},compose:function(){var toCall=ARR_SLICE.call(arguments);return function(){for(var args=ARR_SLICE.call(arguments),i=toCall.length-1;i>=0;i--)args=[toCall[i].apply(this,args)];return args[0]}},each:function(obj,itr,scope){if(obj)if(ARR_EACH&&obj.forEach&&obj.forEach===ARR_EACH)obj.forEach(itr,scope);else if(obj.length===obj.length+0){var key=void 0,l=void 0;for(key=0,l=obj.length;key<l;key++)if(key in obj&&itr.call(scope,obj[key],key)===this.BREAK)return}else for(var _key in obj)if(itr.call(scope,obj[_key],_key)===this.BREAK)return},defer:function(fnc){setTimeout(fnc,0)},debounce:function(func,threshold,callImmediately){var timeout=void 0;return function(){var obj=this,args=arguments,callNow=callImmediately||!timeout;clearTimeout(timeout),timeout=setTimeout(function(){timeout=null,callImmediately||func.apply(obj,args)},threshold),callNow&&func.apply(obj,args)}},toArray:function(obj){return obj.toArray?obj.toArray():ARR_SLICE.call(obj)},isUndefined:function(obj){return void 0===obj},isNull:function(obj){return null===obj},isNaN:function(_isNaN){function isNaN(_x){return _isNaN.apply(this,arguments)}return isNaN.toString=function(){return _isNaN.toString()},isNaN}(function(obj){return isNaN(obj)}),isArray:Array.isArray||function(obj){return obj.constructor===Array},isObject:function(obj){return obj===Object(obj)},isNumber:function(obj){return obj===obj+0},isString:function(obj){return obj===obj+""},isBoolean:function(obj){return!1===obj||!0===obj},isFunction:function(obj){return"[object Function]"===Object.prototype.toString.call(obj)}},INTERPRETATIONS=[{litmus:Common.isString,conversions:{THREE_CHAR_HEX:{read:function(original){var test=original.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null!==test&&{space:"HEX",hex:parseInt("0x"+test[1].toString()+test[1].toString()+test[2].toString()+test[2].toString()+test[3].toString()+test[3].toString(),0)}},write:colorToString},SIX_CHAR_HEX:{read:function(original){var test=original.match(/^#([A-F0-9]{6})$/i);return null!==test&&{space:"HEX",hex:parseInt("0x"+test[1].toString(),0)}},write:colorToString},CSS_RGB:{read:function(original){var test=original.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==test&&{space:"RGB",r:parseFloat(test[1]),g:parseFloat(test[2]),b:parseFloat(test[3])}},write:colorToString},CSS_RGBA:{read:function(original){var test=original.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==test&&{space:"RGB",r:parseFloat(test[1]),g:parseFloat(test[2]),b:parseFloat(test[3]),a:parseFloat(test[4])}},write:colorToString}}},{litmus:Common.isNumber,conversions:{HEX:{read:function(original){return{space:"HEX",hex:original,conversionName:"HEX"}},write:function(color){return color.hex}}}},{litmus:Common.isArray,conversions:{RGB_ARRAY:{read:function(original){return 3===original.length&&{space:"RGB",r:original[0],g:original[1],b:original[2]}},write:function(color){return[color.r,color.g,color.b]}},RGBA_ARRAY:{read:function(original){return 4===original.length&&{space:"RGB",r:original[0],g:original[1],b:original[2],a:original[3]}},write:function(color){return[color.r,color.g,color.b,color.a]}}}},{litmus:Common.isObject,conversions:{RGBA_OBJ:{read:function(original){return!!(Common.isNumber(original.r)&&Common.isNumber(original.g)&&Common.isNumber(original.b)&&Common.isNumber(original.a))&&{space:"RGB",r:original.r,g:original.g,b:original.b,a:original.a}},write:function(color){return{r:color.r,g:color.g,b:color.b,a:color.a}}},RGB_OBJ:{read:function(original){return!!(Common.isNumber(original.r)&&Common.isNumber(original.g)&&Common.isNumber(original.b))&&{space:"RGB",r:original.r,g:original.g,b:original.b}},write:function(color){return{r:color.r,g:color.g,b:color.b}}},HSVA_OBJ:{read:function(original){return!!(Common.isNumber(original.h)&&Common.isNumber(original.s)&&Common.isNumber(original.v)&&Common.isNumber(original.a))&&{space:"HSV",h:original.h,s:original.s,v:original.v,a:original.a}},write:function(color){return{h:color.h,s:color.s,v:color.v,a:color.a}}},HSV_OBJ:{read:function(original){return!!(Common.isNumber(original.h)&&Common.isNumber(original.s)&&Common.isNumber(original.v))&&{space:"HSV",h:original.h,s:original.s,v:original.v}},write:function(color){return{h:color.h,s:color.s,v:color.v}}}}}],result=void 0,toReturn=void 0,interpret=function(){toReturn=!1;var original=arguments.length>1?Common.toArray(arguments):arguments[0];return Common.each(INTERPRETATIONS,function(family){if(family.litmus(original))return Common.each(family.conversions,function(conversion,conversionName){if(result=conversion.read(original),!1===toReturn&&!1!==result)return toReturn=result,result.conversionName=conversionName,result.conversion=conversion,Common.BREAK}),Common.BREAK}),toReturn},tmpComponent=void 0,ColorMath={hsv_to_rgb:function(h,s,v){var hi=Math.floor(h/60)%6,f=h/60-Math.floor(h/60),p=v*(1-s),q=v*(1-f*s),t=v*(1-(1-f)*s),c=[[v,t,p],[q,v,p],[p,v,t],[p,q,v],[t,p,v],[v,p,q]][hi];return{r:255*c[0],g:255*c[1],b:255*c[2]}},rgb_to_hsv:function(r,g,b){var min=Math.min(r,g,b),max=Math.max(r,g,b),delta=max-min,h=void 0;return 0===max?{h:NaN,s:0,v:0}:(h=r===max?(g-b)/delta:g===max?2+(b-r)/delta:4+(r-g)/delta,(h/=6)<0&&(h+=1),{h:360*h,s:delta/max,v:max/255})},rgb_to_hex:function(r,g,b){var hex=this.hex_with_component(0,2,r);return hex=this.hex_with_component(hex,1,g),hex=this.hex_with_component(hex,0,b)},component_from_hex:function(hex,componentIndex){return hex>>8*componentIndex&255},hex_with_component:function(hex,componentIndex,value){return value<<(tmpComponent=8*componentIndex)|hex&~(255<<tmpComponent)}},_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},classCallCheck=function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")},createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),get=function get(object,property,receiver){null===object&&(object=Function.prototype);var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0===desc){var parent=Object.getPrototypeOf(object);return null===parent?void 0:get(parent,property,receiver)}if("value"in desc)return desc.value;var getter=desc.get;return void 0!==getter?getter.call(receiver):void 0},inherits=function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)},possibleConstructorReturn=function(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call},Color=function(){function Color(){if(classCallCheck(this,Color),this.__state=interpret.apply(this,arguments),!1===this.__state)throw new Error("Failed to interpret color arguments");this.__state.a=this.__state.a||1}return createClass(Color,[{key:"toString",value:function(){return colorToString(this)}},{key:"toHexString",value:function(){return colorToString(this,!0)}},{key:"toOriginal",value:function(){return this.__state.conversion.write(this)}}]),Color}();function defineRGBComponent(target,component,componentHexIndex){Object.defineProperty(target,component,{get:function(){return"RGB"===this.__state.space?this.__state[component]:(Color.recalculateRGB(this,component,componentHexIndex),this.__state[component])},set:function(v){"RGB"!==this.__state.space&&(Color.recalculateRGB(this,component,componentHexIndex),this.__state.space="RGB"),this.__state[component]=v}})}function defineHSVComponent(target,component){Object.defineProperty(target,component,{get:function(){return"HSV"===this.__state.space?this.__state[component]:(Color.recalculateHSV(this),this.__state[component])},set:function(v){"HSV"!==this.__state.space&&(Color.recalculateHSV(this),this.__state.space="HSV"),this.__state[component]=v}})}Color.recalculateRGB=function(color,component,componentHexIndex){if("HEX"===color.__state.space)color.__state[component]=ColorMath.component_from_hex(color.__state.hex,componentHexIndex);else{if("HSV"!==color.__state.space)throw new Error("Corrupted color state");Common.extend(color.__state,ColorMath.hsv_to_rgb(color.__state.h,color.__state.s,color.__state.v))}},Color.recalculateHSV=function(color){var result=ColorMath.rgb_to_hsv(color.r,color.g,color.b);Common.extend(color.__state,{s:result.s,v:result.v}),Common.isNaN(result.h)?Common.isUndefined(color.__state.h)&&(color.__state.h=0):color.__state.h=result.h},Color.COMPONENTS=["r","g","b","h","s","v","hex","a"],defineRGBComponent(Color.prototype,"r",2),defineRGBComponent(Color.prototype,"g",1),defineRGBComponent(Color.prototype,"b",0),defineHSVComponent(Color.prototype,"h"),defineHSVComponent(Color.prototype,"s"),defineHSVComponent(Color.prototype,"v"),Object.defineProperty(Color.prototype,"a",{get:function(){return this.__state.a},set:function(v){this.__state.a=v}}),Object.defineProperty(Color.prototype,"hex",{get:function(){return"HEX"!==!this.__state.space&&(this.__state.hex=ColorMath.rgb_to_hex(this.r,this.g,this.b)),this.__state.hex},set:function(v){this.__state.space="HEX",this.__state.hex=v}});var Controller=function(){function Controller(object,property){classCallCheck(this,Controller),this.initialValue=object[property],this.domElement=document.createElement("div"),this.object=object,this.property=property,this.__onChange=void 0,this.__onFinishChange=void 0}return createClass(Controller,[{key:"onChange",value:function(fnc){return this.__onChange=fnc,this}},{key:"onFinishChange",value:function(fnc){return this.__onFinishChange=fnc,this}},{key:"setValue",value:function(newValue){return this.object[this.property]=newValue,this.__onChange&&this.__onChange.call(this,newValue),this.updateDisplay(),this}},{key:"getValue",value:function(){return this.object[this.property]}},{key:"updateDisplay",value:function(){return this}},{key:"isModified",value:function(){return this.initialValue!==this.getValue()}}]),Controller}(),EVENT_MAP_INV={};Common.each({HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},function(v,k){Common.each(v,function(e){EVENT_MAP_INV[e]=k})});var CSS_VALUE_PIXELS=/(\d+(\.\d+)?)px/;function cssValueToPixels(val){if("0"===val||Common.isUndefined(val))return 0;var match=val.match(CSS_VALUE_PIXELS);return Common.isNull(match)?0:parseFloat(match[1])}var dom={makeSelectable:function(elem,selectable){void 0!==elem&&void 0!==elem.style&&(elem.onselectstart=selectable?function(){return!1}:function(){},elem.style.MozUserSelect=selectable?"auto":"none",elem.style.KhtmlUserSelect=selectable?"auto":"none",elem.unselectable=selectable?"on":"off")},makeFullscreen:function(elem,hor,vert){var vertical=vert,horizontal=hor;Common.isUndefined(horizontal)&&(horizontal=!0),Common.isUndefined(vertical)&&(vertical=!0),elem.style.position="absolute",horizontal&&(elem.style.left=0,elem.style.right=0),vertical&&(elem.style.top=0,elem.style.bottom=0)},fakeEvent:function(elem,eventType,pars,aux){var params=pars||{},className=EVENT_MAP_INV[eventType];if(!className)throw new Error("Event type "+eventType+" not supported.");var evt=document.createEvent(className);switch(className){case"MouseEvents":var clientX=params.x||params.clientX||0,clientY=params.y||params.clientY||0;evt.initMouseEvent(eventType,params.bubbles||!1,params.cancelable||!0,window,params.clickCount||1,0,0,clientX,clientY,!1,!1,!1,!1,0,null);break;case"KeyboardEvents":var init=evt.initKeyboardEvent||evt.initKeyEvent;Common.defaults(params,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),init(eventType,params.bubbles||!1,params.cancelable,window,params.ctrlKey,params.altKey,params.shiftKey,params.metaKey,params.keyCode,params.charCode);break;default:evt.initEvent(eventType,params.bubbles||!1,params.cancelable||!0)}Common.defaults(evt,aux),elem.dispatchEvent(evt)},bind:function(elem,event,func,newBool){var bool=newBool||!1;return elem.addEventListener?elem.addEventListener(event,func,bool):elem.attachEvent&&elem.attachEvent("on"+event,func),dom},unbind:function(elem,event,func,newBool){var bool=newBool||!1;return elem.removeEventListener?elem.removeEventListener(event,func,bool):elem.detachEvent&&elem.detachEvent("on"+event,func),dom},addClass:function(elem,className){if(void 0===elem.className)elem.className=className;else if(elem.className!==className){var classes=elem.className.split(/ +/);-1===classes.indexOf(className)&&(classes.push(className),elem.className=classes.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return dom},removeClass:function(elem,className){if(className)if(elem.className===className)elem.removeAttribute("class");else{var classes=elem.className.split(/ +/),index=classes.indexOf(className);-1!==index&&(classes.splice(index,1),elem.className=classes.join(" "))}else elem.className=void 0;return dom},hasClass:function(elem,className){return new RegExp("(?:^|\\s+)"+className+"(?:\\s+|$)").test(elem.className)||!1},getWidth:function(elem){var style=getComputedStyle(elem);return cssValueToPixels(style["border-left-width"])+cssValueToPixels(style["border-right-width"])+cssValueToPixels(style["padding-left"])+cssValueToPixels(style["padding-right"])+cssValueToPixels(style.width)},getHeight:function(elem){var style=getComputedStyle(elem);return cssValueToPixels(style["border-top-width"])+cssValueToPixels(style["border-bottom-width"])+cssValueToPixels(style["padding-top"])+cssValueToPixels(style["padding-bottom"])+cssValueToPixels(style.height)},getOffset:function(el){var elem=el,offset={left:0,top:0};if(elem.offsetParent)do{offset.left+=elem.offsetLeft,offset.top+=elem.offsetTop,elem=elem.offsetParent}while(elem);return offset},isActive:function(elem){return elem===document.activeElement&&(elem.type||elem.href)}},BooleanController=function(_Controller){function BooleanController(object,property){classCallCheck(this,BooleanController);var _this2=possibleConstructorReturn(this,(BooleanController.__proto__||Object.getPrototypeOf(BooleanController)).call(this,object,property)),_this=_this2;return _this2.__prev=_this2.getValue(),_this2.__checkbox=document.createElement("input"),_this2.__checkbox.setAttribute("type","checkbox"),dom.bind(_this2.__checkbox,"change",function(){_this.setValue(!_this.__prev)},!1),_this2.domElement.appendChild(_this2.__checkbox),_this2.updateDisplay(),_this2}return inherits(BooleanController,_Controller),createClass(BooleanController,[{key:"setValue",value:function(v){var toReturn=get(BooleanController.prototype.__proto__||Object.getPrototypeOf(BooleanController.prototype),"setValue",this).call(this,v);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),toReturn}},{key:"updateDisplay",value:function(){return!0===this.getValue()?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0,this.__prev=!0):(this.__checkbox.checked=!1,this.__prev=!1),get(BooleanController.prototype.__proto__||Object.getPrototypeOf(BooleanController.prototype),"updateDisplay",this).call(this)}}]),BooleanController}(Controller),OptionController=function(_Controller){function OptionController(object,property,opts){classCallCheck(this,OptionController);var _this2=possibleConstructorReturn(this,(OptionController.__proto__||Object.getPrototypeOf(OptionController)).call(this,object,property)),options=opts,_this=_this2;if(_this2.__select=document.createElement("select"),Common.isArray(options)){var map={};Common.each(options,function(element){map[element]=element}),options=map}return Common.each(options,function(value,key){var opt=document.createElement("option");opt.innerHTML=key,opt.setAttribute("value",value),_this.__select.appendChild(opt)}),_this2.updateDisplay(),dom.bind(_this2.__select,"change",function(){var desiredValue=this.options[this.selectedIndex].value;_this.setValue(desiredValue)}),_this2.domElement.appendChild(_this2.__select),_this2}return inherits(OptionController,_Controller),createClass(OptionController,[{key:"setValue",value:function(v){var toReturn=get(OptionController.prototype.__proto__||Object.getPrototypeOf(OptionController.prototype),"setValue",this).call(this,v);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),toReturn}},{key:"updateDisplay",value:function(){return dom.isActive(this.__select)?this:(this.__select.value=this.getValue(),get(OptionController.prototype.__proto__||Object.getPrototypeOf(OptionController.prototype),"updateDisplay",this).call(this))}}]),OptionController}(Controller),StringController=function(_Controller){function StringController(object,property){classCallCheck(this,StringController);var _this2=possibleConstructorReturn(this,(StringController.__proto__||Object.getPrototypeOf(StringController)).call(this,object,property)),_this=_this2;function onChange(){_this.setValue(_this.__input.value)}return _this2.__input=document.createElement("input"),_this2.__input.setAttribute("type","text"),dom.bind(_this2.__input,"keyup",onChange),dom.bind(_this2.__input,"change",onChange),dom.bind(_this2.__input,"blur",function(){_this.__onFinishChange&&_this.__onFinishChange.call(_this,_this.getValue())}),dom.bind(_this2.__input,"keydown",function(e){13===e.keyCode&&this.blur()}),_this2.updateDisplay(),_this2.domElement.appendChild(_this2.__input),_this2}return inherits(StringController,_Controller),createClass(StringController,[{key:"updateDisplay",value:function(){return dom.isActive(this.__input)||(this.__input.value=this.getValue()),get(StringController.prototype.__proto__||Object.getPrototypeOf(StringController.prototype),"updateDisplay",this).call(this)}}]),StringController}(Controller);function numDecimals(x){var _x=x.toString();return _x.indexOf(".")>-1?_x.length-_x.indexOf(".")-1:0}var NumberController=function(_Controller){function NumberController(object,property,params){classCallCheck(this,NumberController);var _this=possibleConstructorReturn(this,(NumberController.__proto__||Object.getPrototypeOf(NumberController)).call(this,object,property)),_params=params||{};return _this.__min=_params.min,_this.__max=_params.max,_this.__step=_params.step,Common.isUndefined(_this.__step)?0===_this.initialValue?_this.__impliedStep=1:_this.__impliedStep=Math.pow(10,Math.floor(Math.log(Math.abs(_this.initialValue))/Math.LN10))/10:_this.__impliedStep=_this.__step,_this.__precision=numDecimals(_this.__impliedStep),_this}return inherits(NumberController,_Controller),createClass(NumberController,[{key:"setValue",value:function(v){var _v=v;return void 0!==this.__min&&_v<this.__min?_v=this.__min:void 0!==this.__max&&_v>this.__max&&(_v=this.__max),void 0!==this.__step&&_v%this.__step!=0&&(_v=Math.round(_v/this.__step)*this.__step),get(NumberController.prototype.__proto__||Object.getPrototypeOf(NumberController.prototype),"setValue",this).call(this,_v)}},{key:"min",value:function(minValue){return this.__min=minValue,this}},{key:"max",value:function(maxValue){return this.__max=maxValue,this}},{key:"step",value:function(stepValue){return this.__step=stepValue,this.__impliedStep=stepValue,this.__precision=numDecimals(stepValue),this}}]),NumberController}(Controller),NumberControllerBox=function(_NumberController){function NumberControllerBox(object,property,params){classCallCheck(this,NumberControllerBox);var _this2=possibleConstructorReturn(this,(NumberControllerBox.__proto__||Object.getPrototypeOf(NumberControllerBox)).call(this,object,property,params));_this2.__truncationSuspended=!1;var _this=_this2,prevY=void 0;function onFinish(){_this.__onFinishChange&&_this.__onFinishChange.call(_this,_this.getValue())}function onMouseDrag(e){var diff=prevY-e.clientY;_this.setValue(_this.getValue()+diff*_this.__impliedStep),prevY=e.clientY}function onMouseUp(){dom.unbind(window,"mousemove",onMouseDrag),dom.unbind(window,"mouseup",onMouseUp),onFinish()}return _this2.__input=document.createElement("input"),_this2.__input.setAttribute("type","text"),dom.bind(_this2.__input,"change",function(){var attempted=parseFloat(_this.__input.value);Common.isNaN(attempted)||_this.setValue(attempted)}),dom.bind(_this2.__input,"blur",function(){onFinish()}),dom.bind(_this2.__input,"mousedown",function(e){dom.bind(window,"mousemove",onMouseDrag),dom.bind(window,"mouseup",onMouseUp),prevY=e.clientY}),dom.bind(_this2.__input,"keydown",function(e){13===e.keyCode&&(_this.__truncationSuspended=!0,this.blur(),_this.__truncationSuspended=!1,onFinish())}),_this2.updateDisplay(),_this2.domElement.appendChild(_this2.__input),_this2}return inherits(NumberControllerBox,_NumberController),createClass(NumberControllerBox,[{key:"updateDisplay",value:function(){var value,decimals,tenTo;return this.__input.value=this.__truncationSuspended?this.getValue():(value=this.getValue(),decimals=this.__precision,tenTo=Math.pow(10,decimals),Math.round(value*tenTo)/tenTo),get(NumberControllerBox.prototype.__proto__||Object.getPrototypeOf(NumberControllerBox.prototype),"updateDisplay",this).call(this)}}]),NumberControllerBox}(NumberController);function map(v,i1,i2,o1,o2){return o1+(v-i1)/(i2-i1)*(o2-o1)}var NumberControllerSlider=function(_NumberController){function NumberControllerSlider(object,property,min,max,step){classCallCheck(this,NumberControllerSlider);var _this2=possibleConstructorReturn(this,(NumberControllerSlider.__proto__||Object.getPrototypeOf(NumberControllerSlider)).call(this,object,property,{min:min,max:max,step:step})),_this=_this2;function onMouseDrag(e){e.preventDefault();var bgRect=_this.__background.getBoundingClientRect();return _this.setValue(map(e.clientX,bgRect.left,bgRect.right,_this.__min,_this.__max)),!1}function onMouseUp(){dom.unbind(window,"mousemove",onMouseDrag),dom.unbind(window,"mouseup",onMouseUp),_this.__onFinishChange&&_this.__onFinishChange.call(_this,_this.getValue())}function onTouchMove(e){var clientX=e.touches[0].clientX,bgRect=_this.__background.getBoundingClientRect();_this.setValue(map(clientX,bgRect.left,bgRect.right,_this.__min,_this.__max))}function onTouchEnd(){dom.unbind(window,"touchmove",onTouchMove),dom.unbind(window,"touchend",onTouchEnd),_this.__onFinishChange&&_this.__onFinishChange.call(_this,_this.getValue())}return _this2.__background=document.createElement("div"),_this2.__foreground=document.createElement("div"),dom.bind(_this2.__background,"mousedown",function(e){document.activeElement.blur(),dom.bind(window,"mousemove",onMouseDrag),dom.bind(window,"mouseup",onMouseUp),onMouseDrag(e)}),dom.bind(_this2.__background,"touchstart",function(e){1===e.touches.length&&(dom.bind(window,"touchmove",onTouchMove),dom.bind(window,"touchend",onTouchEnd),onTouchMove(e))}),dom.addClass(_this2.__background,"slider"),dom.addClass(_this2.__foreground,"slider-fg"),_this2.updateDisplay(),_this2.__background.appendChild(_this2.__foreground),_this2.domElement.appendChild(_this2.__background),_this2}return inherits(NumberControllerSlider,_NumberController),createClass(NumberControllerSlider,[{key:"updateDisplay",value:function(){var pct=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=100*pct+"%",get(NumberControllerSlider.prototype.__proto__||Object.getPrototypeOf(NumberControllerSlider.prototype),"updateDisplay",this).call(this)}}]),NumberControllerSlider}(NumberController),FunctionController=function(_Controller){function FunctionController(object,property,text){classCallCheck(this,FunctionController);var _this2=possibleConstructorReturn(this,(FunctionController.__proto__||Object.getPrototypeOf(FunctionController)).call(this,object,property)),_this=_this2;return _this2.__button=document.createElement("div"),_this2.__button.innerHTML=void 0===text?"Fire":text,dom.bind(_this2.__button,"click",function(e){return e.preventDefault(),_this.fire(),!1}),dom.addClass(_this2.__button,"button"),_this2.domElement.appendChild(_this2.__button),_this2}return inherits(FunctionController,_Controller),createClass(FunctionController,[{key:"fire",value:function(){this.__onChange&&this.__onChange.call(this),this.getValue().call(this.object),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue())}}]),FunctionController}(Controller),ColorController=function(_Controller){function ColorController(object,property){classCallCheck(this,ColorController);var _this2=possibleConstructorReturn(this,(ColorController.__proto__||Object.getPrototypeOf(ColorController)).call(this,object,property));_this2.__color=new Color(_this2.getValue()),_this2.__temp=new Color(0);var _this=_this2;_this2.domElement=document.createElement("div"),dom.makeSelectable(_this2.domElement,!1),_this2.__selector=document.createElement("div"),_this2.__selector.className="selector",_this2.__saturation_field=document.createElement("div"),_this2.__saturation_field.className="saturation-field",_this2.__field_knob=document.createElement("div"),_this2.__field_knob.className="field-knob",_this2.__field_knob_border="2px solid ",_this2.__hue_knob=document.createElement("div"),_this2.__hue_knob.className="hue-knob",_this2.__hue_field=document.createElement("div"),_this2.__hue_field.className="hue-field",_this2.__input=document.createElement("input"),_this2.__input.type="text",_this2.__input_textShadow="0 1px 1px ",dom.bind(_this2.__input,"keydown",function(e){13===e.keyCode&&onBlur.call(this)}),dom.bind(_this2.__input,"blur",onBlur),dom.bind(_this2.__selector,"mousedown",function(){dom.addClass(this,"drag").bind(window,"mouseup",function(){dom.removeClass(_this.__selector,"drag")})}),dom.bind(_this2.__selector,"touchstart",function(){dom.addClass(this,"drag").bind(window,"touchend",function(){dom.removeClass(_this.__selector,"drag")})});var elem,valueField=document.createElement("div");function fieldDown(e){setSV(e),dom.bind(window,"mousemove",setSV),dom.bind(window,"touchmove",setSV),dom.bind(window,"mouseup",fieldUpSV),dom.bind(window,"touchend",fieldUpSV)}function fieldDownH(e){setH(e),dom.bind(window,"mousemove",setH),dom.bind(window,"touchmove",setH),dom.bind(window,"mouseup",fieldUpH),dom.bind(window,"touchend",fieldUpH)}function fieldUpSV(){dom.unbind(window,"mousemove",setSV),dom.unbind(window,"touchmove",setSV),dom.unbind(window,"mouseup",fieldUpSV),dom.unbind(window,"touchend",fieldUpSV),onFinish()}function fieldUpH(){dom.unbind(window,"mousemove",setH),dom.unbind(window,"touchmove",setH),dom.unbind(window,"mouseup",fieldUpH),dom.unbind(window,"touchend",fieldUpH),onFinish()}function onBlur(){var i=interpret(this.value);!1!==i?(_this.__color.__state=i,_this.setValue(_this.__color.toOriginal())):this.value=_this.__color.toString()}function onFinish(){_this.__onFinishChange&&_this.__onFinishChange.call(_this,_this.__color.toOriginal())}function setSV(e){-1===e.type.indexOf("touch")&&e.preventDefault();var fieldRect=_this.__saturation_field.getBoundingClientRect(),_ref=e.touches&&e.touches[0]||e,clientX=_ref.clientX,clientY=_ref.clientY,s=(clientX-fieldRect.left)/(fieldRect.right-fieldRect.left),v=1-(clientY-fieldRect.top)/(fieldRect.bottom-fieldRect.top);return v>1?v=1:v<0&&(v=0),s>1?s=1:s<0&&(s=0),_this.__color.v=v,_this.__color.s=s,_this.setValue(_this.__color.toOriginal()),!1}function setH(e){-1===e.type.indexOf("touch")&&e.preventDefault();var fieldRect=_this.__hue_field.getBoundingClientRect(),_ref2=e.touches&&e.touches[0]||e,clientY=_ref2.clientY,h=1-(clientY-fieldRect.top)/(fieldRect.bottom-fieldRect.top);return h>1?h=1:h<0&&(h=0),_this.__color.h=360*h,_this.setValue(_this.__color.toOriginal()),!1}return Common.extend(_this2.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),Common.extend(_this2.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:_this2.__field_knob_border+(_this2.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),Common.extend(_this2.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),Common.extend(_this2.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),Common.extend(valueField.style,{width:"100%",height:"100%",background:"none"}),linearGradient(valueField,"top","rgba(0,0,0,0)","#000"),Common.extend(_this2.__hue_field.style,{width:"15px",height:"100px",border:"1px solid #555",cursor:"ns-resize",position:"absolute",top:"3px",right:"3px"}),(elem=_this2.__hue_field).style.background="",elem.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",elem.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",elem.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",elem.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",elem.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",Common.extend(_this2.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:_this2.__input_textShadow+"rgba(0,0,0,0.7)"}),dom.bind(_this2.__saturation_field,"mousedown",fieldDown),dom.bind(_this2.__saturation_field,"touchstart",fieldDown),dom.bind(_this2.__field_knob,"mousedown",fieldDown),dom.bind(_this2.__field_knob,"touchstart",fieldDown),dom.bind(_this2.__hue_field,"mousedown",fieldDownH),dom.bind(_this2.__hue_field,"touchstart",fieldDownH),_this2.__saturation_field.appendChild(valueField),_this2.__selector.appendChild(_this2.__field_knob),_this2.__selector.appendChild(_this2.__saturation_field),_this2.__selector.appendChild(_this2.__hue_field),_this2.__hue_field.appendChild(_this2.__hue_knob),_this2.domElement.appendChild(_this2.__input),_this2.domElement.appendChild(_this2.__selector),_this2.updateDisplay(),_this2}return inherits(ColorController,_Controller),createClass(ColorController,[{key:"updateDisplay",value:function(){var i=interpret(this.getValue());if(!1!==i){var mismatch=!1;Common.each(Color.COMPONENTS,function(component){if(!Common.isUndefined(i[component])&&!Common.isUndefined(this.__color.__state[component])&&i[component]!==this.__color.__state[component])return mismatch=!0,{}},this),mismatch&&Common.extend(this.__color.__state,i)}Common.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var flip=this.__color.v<.5||this.__color.s>.5?255:0,_flip=255-flip;Common.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toHexString(),border:this.__field_knob_border+"rgb("+flip+","+flip+","+flip+")"}),this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px",this.__temp.s=1,this.__temp.v=1,linearGradient(this.__saturation_field,"left","#fff",this.__temp.toHexString()),this.__input.value=this.__color.toString(),Common.extend(this.__input.style,{backgroundColor:this.__color.toHexString(),color:"rgb("+flip+","+flip+","+flip+")",textShadow:this.__input_textShadow+"rgba("+_flip+","+_flip+","+_flip+",.7)"})}}]),ColorController}(Controller),vendors=["-moz-","-o-","-webkit-","-ms-",""];function linearGradient(elem,x,a,b){elem.style.background="",Common.each(vendors,function(vendor){elem.style.cssText+="background: "+vendor+"linear-gradient("+x+", "+a+" 0%, "+b+" 100%); "})}var css={load:function(url,indoc){var doc=indoc||document,link=doc.createElement("link");link.type="text/css",link.rel="stylesheet",link.href=url,doc.getElementsByTagName("head")[0].appendChild(link)},inject:function(cssContent,indoc){var doc=indoc||document,injected=document.createElement("style");injected.type="text/css",injected.innerHTML=cssContent;var head=doc.getElementsByTagName("head")[0];try{head.appendChild(injected)}catch(e){}}},ControllerFactory=function(object,property){var initialValue=object[property];return Common.isArray(arguments[2])||Common.isObject(arguments[2])?new OptionController(object,property,arguments[2]):Common.isNumber(initialValue)?Common.isNumber(arguments[2])&&Common.isNumber(arguments[3])?Common.isNumber(arguments[4])?new NumberControllerSlider(object,property,arguments[2],arguments[3],arguments[4]):new NumberControllerSlider(object,property,arguments[2],arguments[3]):Common.isNumber(arguments[4])?new NumberControllerBox(object,property,{min:arguments[2],max:arguments[3],step:arguments[4]}):new NumberControllerBox(object,property,{min:arguments[2],max:arguments[3]}):Common.isString(initialValue)?new StringController(object,property):Common.isFunction(initialValue)?new FunctionController(object,property,""):Common.isBoolean(initialValue)?new BooleanController(object,property):null},requestAnimationFrame$1=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(callback){setTimeout(callback,1e3/60)},CenteredDiv=function(){function CenteredDiv(){classCallCheck(this,CenteredDiv),this.backgroundElement=document.createElement("div"),Common.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear",transition:"opacity 0.2s linear"}),dom.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),Common.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear",transition:"transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var _this=this;dom.bind(this.backgroundElement,"click",function(){_this.hide()})}return createClass(CenteredDiv,[{key:"show",value:function(){var _this=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),Common.defer(function(){_this.backgroundElement.style.opacity=1,_this.domElement.style.opacity=1,_this.domElement.style.webkitTransform="scale(1)"})}},{key:"hide",value:function(){var _this=this,hide=function hide(){_this.domElement.style.display="none",_this.backgroundElement.style.display="none",dom.unbind(_this.domElement,"webkitTransitionEnd",hide),dom.unbind(_this.domElement,"transitionend",hide),dom.unbind(_this.domElement,"oTransitionEnd",hide)};dom.bind(this.domElement,"webkitTransitionEnd",hide),dom.bind(this.domElement,"transitionend",hide),dom.bind(this.domElement,"oTransitionEnd",hide),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"}},{key:"layout",value:function(){this.domElement.style.left=window.innerWidth/2-dom.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-dom.getHeight(this.domElement)/2+"px"}}]),CenteredDiv}(),styleSheet=function(css){if(css&&"undefined"!=typeof window){var style=document.createElement("style");return style.setAttribute("type","text/css"),style.innerHTML=css,document.head.appendChild(style),css}}(".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear;border:0;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button.close-top{position:relative}.dg.main .close-button.close-bottom{position:absolute}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-y:visible}.dg.a.has-save>ul.close-top{margin-top:0}.dg.a.has-save>ul.close-bottom{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{top:0;z-index:1002}.dg.a .save-row.close-top{position:relative}.dg.a .save-row.close-bottom{position:fixed}.dg li{-webkit-transition:height .1s ease-out;-o-transition:height .1s ease-out;-moz-transition:height .1s ease-out;transition:height .1s ease-out;-webkit-transition:overflow .1s linear;-o-transition:overflow .1s linear;-moz-transition:overflow .1s linear;transition:overflow .1s linear}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px;overflow:hidden}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .c{float:left;width:60%;position:relative}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:7px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .cr.color{overflow:visible}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2FA1D6}.dg .cr.number input[type=text]{color:#2FA1D6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2FA1D6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}\n");css.inject(styleSheet);var DEFAULT_DEFAULT_PRESET_NAME="Default",SUPPORTS_LOCAL_STORAGE=function(){try{return!!window.localStorage}catch(e){return!1}}(),SAVE_DIALOGUE=void 0,autoPlaceVirgin=!0,autoPlaceContainer=void 0,hide=!1,hideableGuis=[],GUI=function GUI(pars){var _this=this,params=pars||{};this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),dom.addClass(this.domElement,"dg"),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],params=Common.defaults(params,{closeOnTop:!1,autoPlace:!0,width:GUI.DEFAULT_WIDTH}),params=Common.defaults(params,{resizable:params.autoPlace,hideable:params.autoPlace}),Common.isUndefined(params.load)?params.load={preset:DEFAULT_DEFAULT_PRESET_NAME}:params.preset&&(params.load.preset=params.preset),Common.isUndefined(params.parent)&&params.hideable&&hideableGuis.push(this),params.resizable=Common.isUndefined(params.parent)&&params.resizable,params.autoPlace&&Common.isUndefined(params.scrollable)&&(params.scrollable=!0);var root,useLocalStorage=SUPPORTS_LOCAL_STORAGE&&"true"===localStorage.getItem(getLocalStorageHash(0,"isLocal")),saveToLocalStorage=void 0,titleRow=void 0;if(Object.defineProperties(this,{parent:{get:function(){return params.parent}},scrollable:{get:function(){return params.scrollable}},autoPlace:{get:function(){return params.autoPlace}},closeOnTop:{get:function(){return params.closeOnTop}},preset:{get:function(){return _this.parent?_this.getRoot().preset:params.load.preset},set:function(v){_this.parent?_this.getRoot().preset=v:params.load.preset=v,function(gui){for(var index=0;index<gui.__preset_select.length;index++)gui.__preset_select[index].value===gui.preset&&(gui.__preset_select.selectedIndex=index)}(this),_this.revert()}},width:{get:function(){return params.width},set:function(v){params.width=v,setWidth(_this,v)}},name:{get:function(){return params.name},set:function(v){params.name=v,titleRow&&(titleRow.innerHTML=params.name)}},closed:{get:function(){return params.closed},set:function(v){params.closed=v,params.closed?dom.addClass(_this.__ul,GUI.CLASS_CLOSED):dom.removeClass(_this.__ul,GUI.CLASS_CLOSED),this.onResize(),_this.__closeButton&&(_this.__closeButton.innerHTML=v?GUI.TEXT_OPEN:GUI.TEXT_CLOSED)}},load:{get:function(){return params.load}},useLocalStorage:{get:function(){return useLocalStorage},set:function(bool){SUPPORTS_LOCAL_STORAGE&&(useLocalStorage=bool,bool?dom.bind(window,"unload",saveToLocalStorage):dom.unbind(window,"unload",saveToLocalStorage),localStorage.setItem(getLocalStorageHash(0,"isLocal"),bool))}}}),Common.isUndefined(params.parent)){if(params.closed=!1,dom.addClass(this.domElement,GUI.CLASS_MAIN),dom.makeSelectable(this.domElement,!1),SUPPORTS_LOCAL_STORAGE&&useLocalStorage){_this.useLocalStorage=!0;var savedGui=localStorage.getItem(getLocalStorageHash(0,"gui"));savedGui&&(params.load=JSON.parse(savedGui))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=GUI.TEXT_CLOSED,dom.addClass(this.__closeButton,GUI.CLASS_CLOSE_BUTTON),params.closeOnTop?(dom.addClass(this.__closeButton,GUI.CLASS_CLOSE_TOP),this.domElement.insertBefore(this.__closeButton,this.domElement.childNodes[0])):(dom.addClass(this.__closeButton,GUI.CLASS_CLOSE_BOTTOM),this.domElement.appendChild(this.__closeButton)),dom.bind(this.__closeButton,"click",function(){_this.closed=!_this.closed})}else{void 0===params.closed&&(params.closed=!0);var titleRowName=document.createTextNode(params.name);dom.addClass(titleRowName,"controller-name"),titleRow=addRow(_this,titleRowName),dom.addClass(this.__ul,GUI.CLASS_CLOSED),dom.addClass(titleRow,"title"),dom.bind(titleRow,"click",function(e){return e.preventDefault(),_this.closed=!_this.closed,!1}),params.closed||(this.closed=!1)}params.autoPlace&&(Common.isUndefined(params.parent)&&(autoPlaceVirgin&&(autoPlaceContainer=document.createElement("div"),dom.addClass(autoPlaceContainer,"dg"),dom.addClass(autoPlaceContainer,GUI.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(autoPlaceContainer),autoPlaceVirgin=!1),autoPlaceContainer.appendChild(this.domElement),dom.addClass(this.domElement,GUI.CLASS_AUTO_PLACE)),this.parent||setWidth(_this,params.width)),this.__resizeHandler=function(){_this.onResizeDebounced()},dom.bind(window,"resize",this.__resizeHandler),dom.bind(this.__ul,"webkitTransitionEnd",this.__resizeHandler),dom.bind(this.__ul,"transitionend",this.__resizeHandler),dom.bind(this.__ul,"oTransitionEnd",this.__resizeHandler),this.onResize(),params.resizable&&addResizeHandle(this),saveToLocalStorage=function(){SUPPORTS_LOCAL_STORAGE&&"true"===localStorage.getItem(getLocalStorageHash(0,"isLocal"))&&localStorage.setItem(getLocalStorageHash(0,"gui"),JSON.stringify(_this.getSaveObject()))},this.saveToLocalStorageIfPossible=saveToLocalStorage,params.parent||((root=_this.getRoot()).width+=1,Common.defer(function(){root.width-=1}))};function addRow(gui,newDom,liBefore){var li=document.createElement("li");return newDom&&li.appendChild(newDom),liBefore?gui.__ul.insertBefore(li,liBefore):gui.__ul.appendChild(li),gui.onResize(),li}function removeListeners(gui){dom.unbind(window,"resize",gui.__resizeHandler),gui.saveToLocalStorageIfPossible&&dom.unbind(window,"unload",gui.saveToLocalStorageIfPossible)}function markPresetModified(gui,modified){var opt=gui.__preset_select[gui.__preset_select.selectedIndex];opt.innerHTML=modified?opt.value+"*":opt.value}function recallSavedValue(gui,controller){var root=gui.getRoot(),matchedIndex=root.__rememberedObjects.indexOf(controller.object);if(-1!==matchedIndex){var controllerMap=root.__rememberedObjectIndecesToControllers[matchedIndex];if(void 0===controllerMap&&(controllerMap={},root.__rememberedObjectIndecesToControllers[matchedIndex]=controllerMap),controllerMap[controller.property]=controller,root.load&&root.load.remembered){var presetMap=root.load.remembered,preset=void 0;if(presetMap[gui.preset])preset=presetMap[gui.preset];else{if(!presetMap[DEFAULT_DEFAULT_PRESET_NAME])return;preset=presetMap[DEFAULT_DEFAULT_PRESET_NAME]}if(preset[matchedIndex]&&void 0!==preset[matchedIndex][controller.property]){var value=preset[matchedIndex][controller.property];controller.initialValue=value,controller.setValue(value)}}}}function _add(gui,object,property,params){if(void 0===object[property])throw new Error('Object "'+object+'" has no property "'+property+'"');var controller=void 0;if(params.color)controller=new ColorController(object,property);else{var factoryArgs=[object,property].concat(params.factoryArgs);controller=ControllerFactory.apply(gui,factoryArgs)}params.before instanceof Controller&&(params.before=params.before.__li),recallSavedValue(gui,controller),dom.addClass(controller.domElement,"c");var name=document.createElement("span");dom.addClass(name,"property-name"),name.innerHTML=controller.property;var container=document.createElement("div");container.appendChild(name),container.appendChild(controller.domElement);var li=addRow(gui,container,params.before);return dom.addClass(li,GUI.CLASS_CONTROLLER_ROW),controller instanceof ColorController?dom.addClass(li,"color"):dom.addClass(li,_typeof(controller.getValue())),function(gui,li,controller){if(controller.__li=li,controller.__gui=gui,Common.extend(controller,{options:function(_options){if(arguments.length>1){var nextSibling=controller.__li.nextElementSibling;return controller.remove(),_add(gui,controller.object,controller.property,{before:nextSibling,factoryArgs:[Common.toArray(arguments)]})}if(Common.isArray(_options)||Common.isObject(_options)){var _nextSibling=controller.__li.nextElementSibling;return controller.remove(),_add(gui,controller.object,controller.property,{before:_nextSibling,factoryArgs:[_options]})}},name:function(_name){return controller.__li.firstElementChild.firstElementChild.innerHTML=_name,controller},listen:function(){return controller.__gui.listen(controller),controller},remove:function(){return controller.__gui.remove(controller),controller}}),controller instanceof NumberControllerSlider){var box=new NumberControllerBox(controller.object,controller.property,{min:controller.__min,max:controller.__max,step:controller.__step});Common.each(["updateDisplay","onChange","onFinishChange","step"],function(method){var pc=controller[method],pb=box[method];controller[method]=box[method]=function(){var args=Array.prototype.slice.call(arguments);return pb.apply(box,args),pc.apply(controller,args)}}),dom.addClass(li,"has-slider"),controller.domElement.insertBefore(box.domElement,controller.domElement.firstElementChild)}else if(controller instanceof NumberControllerBox){var r=function(returned){if(Common.isNumber(controller.__min)&&Common.isNumber(controller.__max)){var oldName=controller.__li.firstElementChild.firstElementChild.innerHTML,wasListening=controller.__gui.__listening.indexOf(controller)>-1;controller.remove();var newController=_add(gui,controller.object,controller.property,{before:controller.__li.nextElementSibling,factoryArgs:[controller.__min,controller.__max,controller.__step]});return newController.name(oldName),wasListening&&newController.listen(),newController}return returned};controller.min=Common.compose(r,controller.min),controller.max=Common.compose(r,controller.max)}else controller instanceof BooleanController?(dom.bind(li,"click",function(){dom.fakeEvent(controller.__checkbox,"click")}),dom.bind(controller.__checkbox,"click",function(e){e.stopPropagation()})):controller instanceof FunctionController?(dom.bind(li,"click",function(){dom.fakeEvent(controller.__button,"click")}),dom.bind(li,"mouseover",function(){dom.addClass(controller.__button,"hover")}),dom.bind(li,"mouseout",function(){dom.removeClass(controller.__button,"hover")})):controller instanceof ColorController&&(dom.addClass(li,"color"),controller.updateDisplay=Common.compose(function(val){return li.style.borderLeftColor=controller.__color.toString(),val},controller.updateDisplay),controller.updateDisplay());controller.setValue=Common.compose(function(val){return gui.getRoot().__preset_select&&controller.isModified()&&markPresetModified(gui.getRoot(),!0),val},controller.setValue)}(gui,li,controller),gui.__controllers.push(controller),controller}function getLocalStorageHash(gui,key){return document.location.href+"."+key}function addPresetOption(gui,name,setSelected){var opt=document.createElement("option");opt.innerHTML=name,opt.value=name,gui.__preset_select.appendChild(opt),setSelected&&(gui.__preset_select.selectedIndex=gui.__preset_select.length-1)}function showHideExplain(gui,explain){explain.style.display=gui.useLocalStorage?"block":"none"}function addResizeHandle(gui){var pmouseX=void 0;function drag(e){return e.preventDefault(),gui.width+=pmouseX-e.clientX,gui.onResize(),pmouseX=e.clientX,!1}function dragStop(){dom.removeClass(gui.__closeButton,GUI.CLASS_DRAG),dom.unbind(window,"mousemove",drag),dom.unbind(window,"mouseup",dragStop)}function dragStart(e){return e.preventDefault(),pmouseX=e.clientX,dom.addClass(gui.__closeButton,GUI.CLASS_DRAG),dom.bind(window,"mousemove",drag),dom.bind(window,"mouseup",dragStop),!1}gui.__resize_handle=document.createElement("div"),Common.extend(gui.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"}),dom.bind(gui.__resize_handle,"mousedown",dragStart),dom.bind(gui.__closeButton,"mousedown",dragStart),gui.domElement.insertBefore(gui.__resize_handle,gui.domElement.firstElementChild)}function setWidth(gui,w){gui.domElement.style.width=w+"px",gui.__save_row&&gui.autoPlace&&(gui.__save_row.style.width=w+"px"),gui.__closeButton&&(gui.__closeButton.style.width=w+"px")}function getCurrentPreset(gui,useInitialValues){var toReturn={};return Common.each(gui.__rememberedObjects,function(val,index){var savedValues={},controllerMap=gui.__rememberedObjectIndecesToControllers[index];Common.each(controllerMap,function(controller,property){savedValues[property]=useInitialValues?controller.initialValue:controller.getValue()}),toReturn[index]=savedValues}),toReturn}GUI.toggleHide=function(){hide=!hide,Common.each(hideableGuis,function(gui){gui.domElement.style.display=hide?"none":""})},GUI.CLASS_AUTO_PLACE="a",GUI.CLASS_AUTO_PLACE_CONTAINER="ac",GUI.CLASS_MAIN="main",GUI.CLASS_CONTROLLER_ROW="cr",GUI.CLASS_TOO_TALL="taller-than-window",GUI.CLASS_CLOSED="closed",GUI.CLASS_CLOSE_BUTTON="close-button",GUI.CLASS_CLOSE_TOP="close-top",GUI.CLASS_CLOSE_BOTTOM="close-bottom",GUI.CLASS_DRAG="drag",GUI.DEFAULT_WIDTH=245,GUI.TEXT_CLOSED="Close Controls",GUI.TEXT_OPEN="Open Controls",GUI._keydownHandler=function(e){"text"===document.activeElement.type||72!==e.which&&72!==e.keyCode||GUI.toggleHide()},dom.bind(window,"keydown",GUI._keydownHandler,!1),Common.extend(GUI.prototype,{add:function(object,property){return _add(this,object,property,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(object,property){return _add(this,object,property,{color:!0})},remove:function(controller){this.__ul.removeChild(controller.__li),this.__controllers.splice(this.__controllers.indexOf(controller),1);var _this=this;Common.defer(function(){_this.onResize()})},destroy:function(){if(this.parent)throw new Error("Only the root GUI should be removed with .destroy(). For subfolders, use gui.removeFolder(folder) instead.");this.autoPlace&&autoPlaceContainer.removeChild(this.domElement);var _this=this;Common.each(this.__folders,function(subfolder){_this.removeFolder(subfolder)}),dom.unbind(window,"keydown",GUI._keydownHandler,!1),removeListeners(this)},addFolder:function(name){if(void 0!==this.__folders[name])throw new Error('You already have a folder in this GUI by the name "'+name+'"');var newGuiParams={name:name,parent:this};newGuiParams.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[name]&&(newGuiParams.closed=this.load.folders[name].closed,newGuiParams.load=this.load.folders[name]);var gui=new GUI(newGuiParams);this.__folders[name]=gui;var li=addRow(this,gui.domElement);return dom.addClass(li,"folder"),gui},removeFolder:function(folder){this.__ul.removeChild(folder.domElement.parentElement),delete this.__folders[folder.name],this.load&&this.load.folders&&this.load.folders[folder.name]&&delete this.load.folders[folder.name],removeListeners(folder);var _this=this;Common.each(folder.__folders,function(subfolder){folder.removeFolder(subfolder)}),Common.defer(function(){_this.onResize()})},open:function(){this.closed=!1},close:function(){this.closed=!0},onResize:function(){var root=this.getRoot();if(root.scrollable){var top=dom.getOffset(root.__ul).top,h=0;Common.each(root.__ul.childNodes,function(node){root.autoPlace&&node===root.__save_row||(h+=dom.getHeight(node))}),window.innerHeight-top-20<h?(dom.addClass(root.domElement,GUI.CLASS_TOO_TALL),root.__ul.style.height=window.innerHeight-top-20+"px"):(dom.removeClass(root.domElement,GUI.CLASS_TOO_TALL),root.__ul.style.height="auto")}root.__resize_handle&&Common.defer(function(){root.__resize_handle.style.height=root.__ul.offsetHeight+"px"}),root.__closeButton&&(root.__closeButton.style.width=root.width+"px")},onResizeDebounced:Common.debounce(function(){this.onResize()},50),remember:function(){if(Common.isUndefined(SAVE_DIALOGUE)&&((SAVE_DIALOGUE=new CenteredDiv).domElement.innerHTML='<div id="dg-save" class="dg dialogue">\n\n  Here\'s the new load parameter for your <code>GUI</code>\'s constructor:\n\n  <textarea id="dg-new-constructor"></textarea>\n\n  <div id="dg-save-locally">\n\n    <input id="dg-local-storage" type="checkbox"/> Automatically save\n    values to <code>localStorage</code> on exit.\n\n    <div id="dg-local-explain">The values saved to <code>localStorage</code> will\n      override those passed to <code>dat.GUI</code>\'s constructor. This makes it\n      easier to work incrementally, but <code>localStorage</code> is fragile,\n      and your friends may not see the same values you do.\n\n    </div>\n\n  </div>\n\n</div>'),this.parent)throw new Error("You can only call remember on a top level GUI.");var _this=this;Common.each(Array.prototype.slice.call(arguments),function(object){0===_this.__rememberedObjects.length&&function(gui){var div=gui.__save_row=document.createElement("li");dom.addClass(gui.domElement,"has-save"),gui.__ul.insertBefore(div,gui.__ul.firstChild),dom.addClass(div,"save-row");var gears=document.createElement("span");gears.innerHTML="&nbsp;",dom.addClass(gears,"button gears");var button=document.createElement("span");button.innerHTML="Save",dom.addClass(button,"button"),dom.addClass(button,"save");var button2=document.createElement("span");button2.innerHTML="New",dom.addClass(button2,"button"),dom.addClass(button2,"save-as");var button3=document.createElement("span");button3.innerHTML="Revert",dom.addClass(button3,"button"),dom.addClass(button3,"revert");var select=gui.__preset_select=document.createElement("select");if(gui.load&&gui.load.remembered?Common.each(gui.load.remembered,function(value,key){addPresetOption(gui,key,key===gui.preset)}):addPresetOption(gui,DEFAULT_DEFAULT_PRESET_NAME,!1),dom.bind(select,"change",function(){for(var index=0;index<gui.__preset_select.length;index++)gui.__preset_select[index].innerHTML=gui.__preset_select[index].value;gui.preset=this.value}),div.appendChild(select),div.appendChild(gears),div.appendChild(button),div.appendChild(button2),div.appendChild(button3),SUPPORTS_LOCAL_STORAGE){var explain=document.getElementById("dg-local-explain"),localStorageCheckBox=document.getElementById("dg-local-storage"),saveLocally=document.getElementById("dg-save-locally");saveLocally.style.display="block","true"===localStorage.getItem(getLocalStorageHash(0,"isLocal"))&&localStorageCheckBox.setAttribute("checked","checked"),showHideExplain(gui,explain),dom.bind(localStorageCheckBox,"change",function(){gui.useLocalStorage=!gui.useLocalStorage,showHideExplain(gui,explain)})}var newConstructorTextArea=document.getElementById("dg-new-constructor");dom.bind(newConstructorTextArea,"keydown",function(e){!e.metaKey||67!==e.which&&67!==e.keyCode||SAVE_DIALOGUE.hide()}),dom.bind(gears,"click",function(){newConstructorTextArea.innerHTML=JSON.stringify(gui.getSaveObject(),void 0,2),SAVE_DIALOGUE.show(),newConstructorTextArea.focus(),newConstructorTextArea.select()}),dom.bind(button,"click",function(){gui.save()}),dom.bind(button2,"click",function(){var presetName=prompt("Enter a new preset name.");presetName&&gui.saveAs(presetName)}),dom.bind(button3,"click",function(){gui.revert()})}(_this),-1===_this.__rememberedObjects.indexOf(object)&&_this.__rememberedObjects.push(object)}),this.autoPlace&&setWidth(this,this.width)},getRoot:function(){for(var gui=this;gui.parent;)gui=gui.parent;return gui},getSaveObject:function(){var toReturn=this.load;return toReturn.closed=this.closed,this.__rememberedObjects.length>0&&(toReturn.preset=this.preset,toReturn.remembered||(toReturn.remembered={}),toReturn.remembered[this.preset]=getCurrentPreset(this)),toReturn.folders={},Common.each(this.__folders,function(element,key){toReturn.folders[key]=element.getSaveObject()}),toReturn},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=getCurrentPreset(this),markPresetModified(this,!1),this.saveToLocalStorageIfPossible()},saveAs:function(presetName){this.load.remembered||(this.load.remembered={},this.load.remembered[DEFAULT_DEFAULT_PRESET_NAME]=getCurrentPreset(this,!0)),this.load.remembered[presetName]=getCurrentPreset(this),this.preset=presetName,addPresetOption(this,presetName,!0),this.saveToLocalStorageIfPossible()},revert:function(gui){Common.each(this.__controllers,function(controller){this.getRoot().load.remembered?recallSavedValue(gui||this.getRoot(),controller):controller.setValue(controller.initialValue),controller.__onFinishChange&&controller.__onFinishChange.call(controller,controller.getValue())},this),Common.each(this.__folders,function(folder){folder.revert(folder)}),gui||markPresetModified(this.getRoot(),!1)},listen:function(controller){var init=0===this.__listening.length;this.__listening.push(controller),init&&function updateDisplays(controllerArray){0!==controllerArray.length&&requestAnimationFrame$1.call(window,function(){updateDisplays(controllerArray)}),Common.each(controllerArray,function(c){c.updateDisplay()})}(this.__listening)},updateDisplay:function(){Common.each(this.__controllers,function(controller){controller.updateDisplay()}),Common.each(this.__folders,function(folder){folder.updateDisplay()})}});var color={Color:Color,math:ColorMath,interpret:interpret},controllers={Controller:Controller,BooleanController:BooleanController,OptionController:OptionController,StringController:StringController,NumberController:NumberController,NumberControllerBox:NumberControllerBox,NumberControllerSlider:NumberControllerSlider,FunctionController:FunctionController,ColorController:ColorController},dom$1={dom:dom},gui={GUI:GUI},GUI$1=GUI,index={color:color,controllers:controllers,dom:dom$1,gui:gui,GUI:GUI$1};exports.color=color,exports.controllers=controllers,exports.dom=dom$1,exports.gui=gui,exports.GUI=GUI$1,exports.default=index,Object.defineProperty(exports,"__esModule",{value:!0})}(exports)},"./node_modules/dat.gui/build/dat.gui.module.js":function(module,__webpack_exports__,__webpack_require__){"use strict";function colorToString(color,forceCSSHex){var colorFormat=color.__state.conversionName.toString(),r=Math.round(color.r),g=Math.round(color.g),b=Math.round(color.b),a=color.a,h=Math.round(color.h),s=color.s.toFixed(1),v=color.v.toFixed(1);if(forceCSSHex||"THREE_CHAR_HEX"===colorFormat||"SIX_CHAR_HEX"===colorFormat){for(var str=color.hex.toString(16);str.length<6;)str="0"+str;return"#"+str}return"CSS_RGB"===colorFormat?"rgb("+r+","+g+","+b+")":"CSS_RGBA"===colorFormat?"rgba("+r+","+g+","+b+","+a+")":"HEX"===colorFormat?"0x"+color.hex.toString(16):"RGB_ARRAY"===colorFormat?"["+r+","+g+","+b+"]":"RGBA_ARRAY"===colorFormat?"["+r+","+g+","+b+","+a+"]":"RGB_OBJ"===colorFormat?"{r:"+r+",g:"+g+",b:"+b+"}":"RGBA_OBJ"===colorFormat?"{r:"+r+",g:"+g+",b:"+b+",a:"+a+"}":"HSV_OBJ"===colorFormat?"{h:"+h+",s:"+s+",v:"+v+"}":"HSVA_OBJ"===colorFormat?"{h:"+h+",s:"+s+",v:"+v+",a:"+a+"}":"unknown format"}__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"color",function(){return color}),__webpack_require__.d(__webpack_exports__,"controllers",function(){return controllers}),__webpack_require__.d(__webpack_exports__,"dom",function(){return dom$1}),__webpack_require__.d(__webpack_exports__,"gui",function(){return gui}),__webpack_require__.d(__webpack_exports__,"GUI",function(){return GUI$1});var ARR_EACH=Array.prototype.forEach,ARR_SLICE=Array.prototype.slice,Common={BREAK:{},extend:function(target){return this.each(ARR_SLICE.call(arguments,1),function(obj){(this.isObject(obj)?Object.keys(obj):[]).forEach(function(key){this.isUndefined(obj[key])||(target[key]=obj[key])}.bind(this))},this),target},defaults:function(target){return this.each(ARR_SLICE.call(arguments,1),function(obj){(this.isObject(obj)?Object.keys(obj):[]).forEach(function(key){this.isUndefined(target[key])&&(target[key]=obj[key])}.bind(this))},this),target},compose:function(){var toCall=ARR_SLICE.call(arguments);return function(){for(var args=ARR_SLICE.call(arguments),i=toCall.length-1;i>=0;i--)args=[toCall[i].apply(this,args)];return args[0]}},each:function(obj,itr,scope){if(obj)if(ARR_EACH&&obj.forEach&&obj.forEach===ARR_EACH)obj.forEach(itr,scope);else if(obj.length===obj.length+0){var l,key=void 0;for(key=0,l=obj.length;key<l;key++)if(key in obj&&itr.call(scope,obj[key],key)===this.BREAK)return}else for(var _key in obj)if(itr.call(scope,obj[_key],_key)===this.BREAK)return},defer:function(fnc){setTimeout(fnc,0)},debounce:function(func,threshold,callImmediately){var timeout=void 0;return function(){var obj=this,args=arguments;var callNow=callImmediately||!timeout;clearTimeout(timeout),timeout=setTimeout(function(){timeout=null,callImmediately||func.apply(obj,args)},threshold),callNow&&func.apply(obj,args)}},toArray:function(obj){return obj.toArray?obj.toArray():ARR_SLICE.call(obj)},isUndefined:function(obj){return void 0===obj},isNull:function(obj){return null===obj},isNaN:function(_isNaN){function isNaN(_x){return _isNaN.apply(this,arguments)}return isNaN.toString=function(){return _isNaN.toString()},isNaN}(function(obj){return isNaN(obj)}),isArray:Array.isArray||function(obj){return obj.constructor===Array},isObject:function(obj){return obj===Object(obj)},isNumber:function(obj){return obj===obj+0},isString:function(obj){return obj===obj+""},isBoolean:function(obj){return!1===obj||!0===obj},isFunction:function(obj){return"[object Function]"===Object.prototype.toString.call(obj)}},INTERPRETATIONS=[{litmus:Common.isString,conversions:{THREE_CHAR_HEX:{read:function(original){var test=original.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null!==test&&{space:"HEX",hex:parseInt("0x"+test[1].toString()+test[1].toString()+test[2].toString()+test[2].toString()+test[3].toString()+test[3].toString(),0)}},write:colorToString},SIX_CHAR_HEX:{read:function(original){var test=original.match(/^#([A-F0-9]{6})$/i);return null!==test&&{space:"HEX",hex:parseInt("0x"+test[1].toString(),0)}},write:colorToString},CSS_RGB:{read:function(original){var test=original.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==test&&{space:"RGB",r:parseFloat(test[1]),g:parseFloat(test[2]),b:parseFloat(test[3])}},write:colorToString},CSS_RGBA:{read:function(original){var test=original.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==test&&{space:"RGB",r:parseFloat(test[1]),g:parseFloat(test[2]),b:parseFloat(test[3]),a:parseFloat(test[4])}},write:colorToString}}},{litmus:Common.isNumber,conversions:{HEX:{read:function(original){return{space:"HEX",hex:original,conversionName:"HEX"}},write:function(color){return color.hex}}}},{litmus:Common.isArray,conversions:{RGB_ARRAY:{read:function(original){return 3===original.length&&{space:"RGB",r:original[0],g:original[1],b:original[2]}},write:function(color){return[color.r,color.g,color.b]}},RGBA_ARRAY:{read:function(original){return 4===original.length&&{space:"RGB",r:original[0],g:original[1],b:original[2],a:original[3]}},write:function(color){return[color.r,color.g,color.b,color.a]}}}},{litmus:Common.isObject,conversions:{RGBA_OBJ:{read:function(original){return!!(Common.isNumber(original.r)&&Common.isNumber(original.g)&&Common.isNumber(original.b)&&Common.isNumber(original.a))&&{space:"RGB",r:original.r,g:original.g,b:original.b,a:original.a}},write:function(color){return{r:color.r,g:color.g,b:color.b,a:color.a}}},RGB_OBJ:{read:function(original){return!!(Common.isNumber(original.r)&&Common.isNumber(original.g)&&Common.isNumber(original.b))&&{space:"RGB",r:original.r,g:original.g,b:original.b}},write:function(color){return{r:color.r,g:color.g,b:color.b}}},HSVA_OBJ:{read:function(original){return!!(Common.isNumber(original.h)&&Common.isNumber(original.s)&&Common.isNumber(original.v)&&Common.isNumber(original.a))&&{space:"HSV",h:original.h,s:original.s,v:original.v,a:original.a}},write:function(color){return{h:color.h,s:color.s,v:color.v,a:color.a}}},HSV_OBJ:{read:function(original){return!!(Common.isNumber(original.h)&&Common.isNumber(original.s)&&Common.isNumber(original.v))&&{space:"HSV",h:original.h,s:original.s,v:original.v}},write:function(color){return{h:color.h,s:color.s,v:color.v}}}}}],result=void 0,toReturn=void 0,interpret=function(){toReturn=!1;var original=arguments.length>1?Common.toArray(arguments):arguments[0];return Common.each(INTERPRETATIONS,function(family){if(family.litmus(original))return Common.each(family.conversions,function(conversion,conversionName){if(result=conversion.read(original),!1===toReturn&&!1!==result)return toReturn=result,result.conversionName=conversionName,result.conversion=conversion,Common.BREAK}),Common.BREAK}),toReturn},tmpComponent=void 0,ColorMath={hsv_to_rgb:function(h,s,v){var hi=Math.floor(h/60)%6,f=h/60-Math.floor(h/60),p=v*(1-s),q=v*(1-f*s),t=v*(1-(1-f)*s),c=[[v,t,p],[q,v,p],[p,v,t],[p,q,v],[t,p,v],[v,p,q]][hi];return{r:255*c[0],g:255*c[1],b:255*c[2]}},rgb_to_hsv:function(r,g,b){var min=Math.min(r,g,b),max=Math.max(r,g,b),delta=max-min,h=void 0;return 0===max?{h:NaN,s:0,v:0}:(h=r===max?(g-b)/delta:g===max?2+(b-r)/delta:4+(r-g)/delta,(h/=6)<0&&(h+=1),{h:360*h,s:delta/max,v:max/255})},rgb_to_hex:function(r,g,b){var hex=this.hex_with_component(0,2,r);return hex=this.hex_with_component(hex,1,g),hex=this.hex_with_component(hex,0,b)},component_from_hex:function(hex,componentIndex){return hex>>8*componentIndex&255},hex_with_component:function(hex,componentIndex,value){return value<<(tmpComponent=8*componentIndex)|hex&~(255<<tmpComponent)}},_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},classCallCheck=function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")},createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),get=function get(object,property,receiver){null===object&&(object=Function.prototype);var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0===desc){var parent=Object.getPrototypeOf(object);return null===parent?void 0:get(parent,property,receiver)}if("value"in desc)return desc.value;var getter=desc.get;return void 0!==getter?getter.call(receiver):void 0},inherits=function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)},possibleConstructorReturn=function(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call},Color=function(){function Color(){if(classCallCheck(this,Color),this.__state=interpret.apply(this,arguments),!1===this.__state)throw new Error("Failed to interpret color arguments");this.__state.a=this.__state.a||1}return createClass(Color,[{key:"toString",value:function(){return colorToString(this)}},{key:"toHexString",value:function(){return colorToString(this,!0)}},{key:"toOriginal",value:function(){return this.__state.conversion.write(this)}}]),Color}();function defineRGBComponent(target,component,componentHexIndex){Object.defineProperty(target,component,{get:function(){return"RGB"===this.__state.space?this.__state[component]:(Color.recalculateRGB(this,component,componentHexIndex),this.__state[component])},set:function(v){"RGB"!==this.__state.space&&(Color.recalculateRGB(this,component,componentHexIndex),this.__state.space="RGB"),this.__state[component]=v}})}function defineHSVComponent(target,component){Object.defineProperty(target,component,{get:function(){return"HSV"===this.__state.space?this.__state[component]:(Color.recalculateHSV(this),this.__state[component])},set:function(v){"HSV"!==this.__state.space&&(Color.recalculateHSV(this),this.__state.space="HSV"),this.__state[component]=v}})}Color.recalculateRGB=function(color,component,componentHexIndex){if("HEX"===color.__state.space)color.__state[component]=ColorMath.component_from_hex(color.__state.hex,componentHexIndex);else{if("HSV"!==color.__state.space)throw new Error("Corrupted color state");Common.extend(color.__state,ColorMath.hsv_to_rgb(color.__state.h,color.__state.s,color.__state.v))}},Color.recalculateHSV=function(color){var result=ColorMath.rgb_to_hsv(color.r,color.g,color.b);Common.extend(color.__state,{s:result.s,v:result.v}),Common.isNaN(result.h)?Common.isUndefined(color.__state.h)&&(color.__state.h=0):color.__state.h=result.h},Color.COMPONENTS=["r","g","b","h","s","v","hex","a"],defineRGBComponent(Color.prototype,"r",2),defineRGBComponent(Color.prototype,"g",1),defineRGBComponent(Color.prototype,"b",0),defineHSVComponent(Color.prototype,"h"),defineHSVComponent(Color.prototype,"s"),defineHSVComponent(Color.prototype,"v"),Object.defineProperty(Color.prototype,"a",{get:function(){return this.__state.a},set:function(v){this.__state.a=v}}),Object.defineProperty(Color.prototype,"hex",{get:function(){return"HEX"!==!this.__state.space&&(this.__state.hex=ColorMath.rgb_to_hex(this.r,this.g,this.b)),this.__state.hex},set:function(v){this.__state.space="HEX",this.__state.hex=v}});var Controller=function(){function Controller(object,property){classCallCheck(this,Controller),this.initialValue=object[property],this.domElement=document.createElement("div"),this.object=object,this.property=property,this.__onChange=void 0,this.__onFinishChange=void 0}return createClass(Controller,[{key:"onChange",value:function(fnc){return this.__onChange=fnc,this}},{key:"onFinishChange",value:function(fnc){return this.__onFinishChange=fnc,this}},{key:"setValue",value:function(newValue){return this.object[this.property]=newValue,this.__onChange&&this.__onChange.call(this,newValue),this.updateDisplay(),this}},{key:"getValue",value:function(){return this.object[this.property]}},{key:"updateDisplay",value:function(){return this}},{key:"isModified",value:function(){return this.initialValue!==this.getValue()}}]),Controller}(),EVENT_MAP_INV={};Common.each({HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},function(v,k){Common.each(v,function(e){EVENT_MAP_INV[e]=k})});var CSS_VALUE_PIXELS=/(\d+(\.\d+)?)px/;function cssValueToPixels(val){if("0"===val||Common.isUndefined(val))return 0;var match=val.match(CSS_VALUE_PIXELS);return Common.isNull(match)?0:parseFloat(match[1])}var dom={makeSelectable:function(elem,selectable){void 0!==elem&&void 0!==elem.style&&(elem.onselectstart=selectable?function(){return!1}:function(){},elem.style.MozUserSelect=selectable?"auto":"none",elem.style.KhtmlUserSelect=selectable?"auto":"none",elem.unselectable=selectable?"on":"off")},makeFullscreen:function(elem,hor,vert){var vertical=vert,horizontal=hor;Common.isUndefined(horizontal)&&(horizontal=!0),Common.isUndefined(vertical)&&(vertical=!0),elem.style.position="absolute",horizontal&&(elem.style.left=0,elem.style.right=0),vertical&&(elem.style.top=0,elem.style.bottom=0)},fakeEvent:function(elem,eventType,pars,aux){var params=pars||{},className=EVENT_MAP_INV[eventType];if(!className)throw new Error("Event type "+eventType+" not supported.");var evt=document.createEvent(className);switch(className){case"MouseEvents":var clientX=params.x||params.clientX||0,clientY=params.y||params.clientY||0;evt.initMouseEvent(eventType,params.bubbles||!1,params.cancelable||!0,window,params.clickCount||1,0,0,clientX,clientY,!1,!1,!1,!1,0,null);break;case"KeyboardEvents":var init=evt.initKeyboardEvent||evt.initKeyEvent;Common.defaults(params,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),init(eventType,params.bubbles||!1,params.cancelable,window,params.ctrlKey,params.altKey,params.shiftKey,params.metaKey,params.keyCode,params.charCode);break;default:evt.initEvent(eventType,params.bubbles||!1,params.cancelable||!0)}Common.defaults(evt,aux),elem.dispatchEvent(evt)},bind:function(elem,event,func,newBool){var bool=newBool||!1;return elem.addEventListener?elem.addEventListener(event,func,bool):elem.attachEvent&&elem.attachEvent("on"+event,func),dom},unbind:function(elem,event,func,newBool){var bool=newBool||!1;return elem.removeEventListener?elem.removeEventListener(event,func,bool):elem.detachEvent&&elem.detachEvent("on"+event,func),dom},addClass:function(elem,className){if(void 0===elem.className)elem.className=className;else if(elem.className!==className){var classes=elem.className.split(/ +/);-1===classes.indexOf(className)&&(classes.push(className),elem.className=classes.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return dom},removeClass:function(elem,className){if(className)if(elem.className===className)elem.removeAttribute("class");else{var classes=elem.className.split(/ +/),index=classes.indexOf(className);-1!==index&&(classes.splice(index,1),elem.className=classes.join(" "))}else elem.className=void 0;return dom},hasClass:function(elem,className){return new RegExp("(?:^|\\s+)"+className+"(?:\\s+|$)").test(elem.className)||!1},getWidth:function(elem){var style=getComputedStyle(elem);return cssValueToPixels(style["border-left-width"])+cssValueToPixels(style["border-right-width"])+cssValueToPixels(style["padding-left"])+cssValueToPixels(style["padding-right"])+cssValueToPixels(style.width)},getHeight:function(elem){var style=getComputedStyle(elem);return cssValueToPixels(style["border-top-width"])+cssValueToPixels(style["border-bottom-width"])+cssValueToPixels(style["padding-top"])+cssValueToPixels(style["padding-bottom"])+cssValueToPixels(style.height)},getOffset:function(el){var elem=el,offset={left:0,top:0};if(elem.offsetParent)do{offset.left+=elem.offsetLeft,offset.top+=elem.offsetTop,elem=elem.offsetParent}while(elem);return offset},isActive:function(elem){return elem===document.activeElement&&(elem.type||elem.href)}},BooleanController=function(_Controller){function BooleanController(object,property){classCallCheck(this,BooleanController);var _this2=possibleConstructorReturn(this,(BooleanController.__proto__||Object.getPrototypeOf(BooleanController)).call(this,object,property)),_this=_this2;return _this2.__prev=_this2.getValue(),_this2.__checkbox=document.createElement("input"),_this2.__checkbox.setAttribute("type","checkbox"),dom.bind(_this2.__checkbox,"change",function(){_this.setValue(!_this.__prev)},!1),_this2.domElement.appendChild(_this2.__checkbox),_this2.updateDisplay(),_this2}return inherits(BooleanController,Controller),createClass(BooleanController,[{key:"setValue",value:function(v){var toReturn=get(BooleanController.prototype.__proto__||Object.getPrototypeOf(BooleanController.prototype),"setValue",this).call(this,v);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),toReturn}},{key:"updateDisplay",value:function(){return!0===this.getValue()?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0,this.__prev=!0):(this.__checkbox.checked=!1,this.__prev=!1),get(BooleanController.prototype.__proto__||Object.getPrototypeOf(BooleanController.prototype),"updateDisplay",this).call(this)}}]),BooleanController}(),OptionController=function(_Controller){function OptionController(object,property,opts){classCallCheck(this,OptionController);var _this2=possibleConstructorReturn(this,(OptionController.__proto__||Object.getPrototypeOf(OptionController)).call(this,object,property)),options=opts,_this=_this2;if(_this2.__select=document.createElement("select"),Common.isArray(options)){var map={};Common.each(options,function(element){map[element]=element}),options=map}return Common.each(options,function(value,key){var opt=document.createElement("option");opt.innerHTML=key,opt.setAttribute("value",value),_this.__select.appendChild(opt)}),_this2.updateDisplay(),dom.bind(_this2.__select,"change",function(){var desiredValue=this.options[this.selectedIndex].value;_this.setValue(desiredValue)}),_this2.domElement.appendChild(_this2.__select),_this2}return inherits(OptionController,Controller),createClass(OptionController,[{key:"setValue",value:function(v){var toReturn=get(OptionController.prototype.__proto__||Object.getPrototypeOf(OptionController.prototype),"setValue",this).call(this,v);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),toReturn}},{key:"updateDisplay",value:function(){return dom.isActive(this.__select)?this:(this.__select.value=this.getValue(),get(OptionController.prototype.__proto__||Object.getPrototypeOf(OptionController.prototype),"updateDisplay",this).call(this))}}]),OptionController}(),StringController=function(_Controller){function StringController(object,property){classCallCheck(this,StringController);var _this2=possibleConstructorReturn(this,(StringController.__proto__||Object.getPrototypeOf(StringController)).call(this,object,property)),_this=_this2;function onChange(){_this.setValue(_this.__input.value)}return _this2.__input=document.createElement("input"),_this2.__input.setAttribute("type","text"),dom.bind(_this2.__input,"keyup",onChange),dom.bind(_this2.__input,"change",onChange),dom.bind(_this2.__input,"blur",function(){_this.__onFinishChange&&_this.__onFinishChange.call(_this,_this.getValue())}),dom.bind(_this2.__input,"keydown",function(e){13===e.keyCode&&this.blur()}),_this2.updateDisplay(),_this2.domElement.appendChild(_this2.__input),_this2}return inherits(StringController,Controller),createClass(StringController,[{key:"updateDisplay",value:function(){return dom.isActive(this.__input)||(this.__input.value=this.getValue()),get(StringController.prototype.__proto__||Object.getPrototypeOf(StringController.prototype),"updateDisplay",this).call(this)}}]),StringController}();function numDecimals(x){var _x=x.toString();return _x.indexOf(".")>-1?_x.length-_x.indexOf(".")-1:0}var NumberController=function(_Controller){function NumberController(object,property,params){classCallCheck(this,NumberController);var _this=possibleConstructorReturn(this,(NumberController.__proto__||Object.getPrototypeOf(NumberController)).call(this,object,property)),_params=params||{};return _this.__min=_params.min,_this.__max=_params.max,_this.__step=_params.step,Common.isUndefined(_this.__step)?0===_this.initialValue?_this.__impliedStep=1:_this.__impliedStep=Math.pow(10,Math.floor(Math.log(Math.abs(_this.initialValue))/Math.LN10))/10:_this.__impliedStep=_this.__step,_this.__precision=numDecimals(_this.__impliedStep),_this}return inherits(NumberController,Controller),createClass(NumberController,[{key:"setValue",value:function(v){var _v=v;return void 0!==this.__min&&_v<this.__min?_v=this.__min:void 0!==this.__max&&_v>this.__max&&(_v=this.__max),void 0!==this.__step&&_v%this.__step!=0&&(_v=Math.round(_v/this.__step)*this.__step),get(NumberController.prototype.__proto__||Object.getPrototypeOf(NumberController.prototype),"setValue",this).call(this,_v)}},{key:"min",value:function(minValue){return this.__min=minValue,this}},{key:"max",value:function(maxValue){return this.__max=maxValue,this}},{key:"step",value:function(stepValue){return this.__step=stepValue,this.__impliedStep=stepValue,this.__precision=numDecimals(stepValue),this}}]),NumberController}();var NumberControllerBox=function(_NumberController){function NumberControllerBox(object,property,params){classCallCheck(this,NumberControllerBox);var _this2=possibleConstructorReturn(this,(NumberControllerBox.__proto__||Object.getPrototypeOf(NumberControllerBox)).call(this,object,property,params));_this2.__truncationSuspended=!1;var _this=_this2,prevY=void 0;function onFinish(){_this.__onFinishChange&&_this.__onFinishChange.call(_this,_this.getValue())}function onMouseDrag(e){var diff=prevY-e.clientY;_this.setValue(_this.getValue()+diff*_this.__impliedStep),prevY=e.clientY}function onMouseUp(){dom.unbind(window,"mousemove",onMouseDrag),dom.unbind(window,"mouseup",onMouseUp),onFinish()}return _this2.__input=document.createElement("input"),_this2.__input.setAttribute("type","text"),dom.bind(_this2.__input,"change",function(){var attempted=parseFloat(_this.__input.value);Common.isNaN(attempted)||_this.setValue(attempted)}),dom.bind(_this2.__input,"blur",function(){onFinish()}),dom.bind(_this2.__input,"mousedown",function(e){dom.bind(window,"mousemove",onMouseDrag),dom.bind(window,"mouseup",onMouseUp),prevY=e.clientY}),dom.bind(_this2.__input,"keydown",function(e){13===e.keyCode&&(_this.__truncationSuspended=!0,this.blur(),_this.__truncationSuspended=!1,onFinish())}),_this2.updateDisplay(),_this2.domElement.appendChild(_this2.__input),_this2}return inherits(NumberControllerBox,NumberController),createClass(NumberControllerBox,[{key:"updateDisplay",value:function(){var value,decimals,tenTo;return this.__input.value=this.__truncationSuspended?this.getValue():(value=this.getValue(),decimals=this.__precision,tenTo=Math.pow(10,decimals),Math.round(value*tenTo)/tenTo),get(NumberControllerBox.prototype.__proto__||Object.getPrototypeOf(NumberControllerBox.prototype),"updateDisplay",this).call(this)}}]),NumberControllerBox}();function map(v,i1,i2,o1,o2){return o1+(v-i1)/(i2-i1)*(o2-o1)}var NumberControllerSlider=function(_NumberController){function NumberControllerSlider(object,property,min,max,step){classCallCheck(this,NumberControllerSlider);var _this2=possibleConstructorReturn(this,(NumberControllerSlider.__proto__||Object.getPrototypeOf(NumberControllerSlider)).call(this,object,property,{min:min,max:max,step:step})),_this=_this2;function onMouseDrag(e){e.preventDefault();var bgRect=_this.__background.getBoundingClientRect();return _this.setValue(map(e.clientX,bgRect.left,bgRect.right,_this.__min,_this.__max)),!1}function onMouseUp(){dom.unbind(window,"mousemove",onMouseDrag),dom.unbind(window,"mouseup",onMouseUp),_this.__onFinishChange&&_this.__onFinishChange.call(_this,_this.getValue())}function onTouchMove(e){var clientX=e.touches[0].clientX,bgRect=_this.__background.getBoundingClientRect();_this.setValue(map(clientX,bgRect.left,bgRect.right,_this.__min,_this.__max))}function onTouchEnd(){dom.unbind(window,"touchmove",onTouchMove),dom.unbind(window,"touchend",onTouchEnd),_this.__onFinishChange&&_this.__onFinishChange.call(_this,_this.getValue())}return _this2.__background=document.createElement("div"),_this2.__foreground=document.createElement("div"),dom.bind(_this2.__background,"mousedown",function(e){document.activeElement.blur(),dom.bind(window,"mousemove",onMouseDrag),dom.bind(window,"mouseup",onMouseUp),onMouseDrag(e)}),dom.bind(_this2.__background,"touchstart",function(e){if(1!==e.touches.length)return;dom.bind(window,"touchmove",onTouchMove),dom.bind(window,"touchend",onTouchEnd),onTouchMove(e)}),dom.addClass(_this2.__background,"slider"),dom.addClass(_this2.__foreground,"slider-fg"),_this2.updateDisplay(),_this2.__background.appendChild(_this2.__foreground),_this2.domElement.appendChild(_this2.__background),_this2}return inherits(NumberControllerSlider,NumberController),createClass(NumberControllerSlider,[{key:"updateDisplay",value:function(){var pct=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=100*pct+"%",get(NumberControllerSlider.prototype.__proto__||Object.getPrototypeOf(NumberControllerSlider.prototype),"updateDisplay",this).call(this)}}]),NumberControllerSlider}(),FunctionController=function(_Controller){function FunctionController(object,property,text){classCallCheck(this,FunctionController);var _this2=possibleConstructorReturn(this,(FunctionController.__proto__||Object.getPrototypeOf(FunctionController)).call(this,object,property)),_this=_this2;return _this2.__button=document.createElement("div"),_this2.__button.innerHTML=void 0===text?"Fire":text,dom.bind(_this2.__button,"click",function(e){return e.preventDefault(),_this.fire(),!1}),dom.addClass(_this2.__button,"button"),_this2.domElement.appendChild(_this2.__button),_this2}return inherits(FunctionController,Controller),createClass(FunctionController,[{key:"fire",value:function(){this.__onChange&&this.__onChange.call(this),this.getValue().call(this.object),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue())}}]),FunctionController}(),ColorController=function(_Controller){function ColorController(object,property){classCallCheck(this,ColorController);var _this2=possibleConstructorReturn(this,(ColorController.__proto__||Object.getPrototypeOf(ColorController)).call(this,object,property));_this2.__color=new Color(_this2.getValue()),_this2.__temp=new Color(0);var _this=_this2;_this2.domElement=document.createElement("div"),dom.makeSelectable(_this2.domElement,!1),_this2.__selector=document.createElement("div"),_this2.__selector.className="selector",_this2.__saturation_field=document.createElement("div"),_this2.__saturation_field.className="saturation-field",_this2.__field_knob=document.createElement("div"),_this2.__field_knob.className="field-knob",_this2.__field_knob_border="2px solid ",_this2.__hue_knob=document.createElement("div"),_this2.__hue_knob.className="hue-knob",_this2.__hue_field=document.createElement("div"),_this2.__hue_field.className="hue-field",_this2.__input=document.createElement("input"),_this2.__input.type="text",_this2.__input_textShadow="0 1px 1px ",dom.bind(_this2.__input,"keydown",function(e){13===e.keyCode&&onBlur.call(this)}),dom.bind(_this2.__input,"blur",onBlur),dom.bind(_this2.__selector,"mousedown",function(){dom.addClass(this,"drag").bind(window,"mouseup",function(){dom.removeClass(_this.__selector,"drag")})}),dom.bind(_this2.__selector,"touchstart",function(){dom.addClass(this,"drag").bind(window,"touchend",function(){dom.removeClass(_this.__selector,"drag")})});var elem,valueField=document.createElement("div");function fieldDown(e){setSV(e),dom.bind(window,"mousemove",setSV),dom.bind(window,"touchmove",setSV),dom.bind(window,"mouseup",fieldUpSV),dom.bind(window,"touchend",fieldUpSV)}function fieldDownH(e){setH(e),dom.bind(window,"mousemove",setH),dom.bind(window,"touchmove",setH),dom.bind(window,"mouseup",fieldUpH),dom.bind(window,"touchend",fieldUpH)}function fieldUpSV(){dom.unbind(window,"mousemove",setSV),dom.unbind(window,"touchmove",setSV),dom.unbind(window,"mouseup",fieldUpSV),dom.unbind(window,"touchend",fieldUpSV),onFinish()}function fieldUpH(){dom.unbind(window,"mousemove",setH),dom.unbind(window,"touchmove",setH),dom.unbind(window,"mouseup",fieldUpH),dom.unbind(window,"touchend",fieldUpH),onFinish()}function onBlur(){var i=interpret(this.value);!1!==i?(_this.__color.__state=i,_this.setValue(_this.__color.toOriginal())):this.value=_this.__color.toString()}function onFinish(){_this.__onFinishChange&&_this.__onFinishChange.call(_this,_this.__color.toOriginal())}function setSV(e){-1===e.type.indexOf("touch")&&e.preventDefault();var fieldRect=_this.__saturation_field.getBoundingClientRect(),_ref=e.touches&&e.touches[0]||e,clientX=_ref.clientX,clientY=_ref.clientY,s=(clientX-fieldRect.left)/(fieldRect.right-fieldRect.left),v=1-(clientY-fieldRect.top)/(fieldRect.bottom-fieldRect.top);return v>1?v=1:v<0&&(v=0),s>1?s=1:s<0&&(s=0),_this.__color.v=v,_this.__color.s=s,_this.setValue(_this.__color.toOriginal()),!1}function setH(e){-1===e.type.indexOf("touch")&&e.preventDefault();var fieldRect=_this.__hue_field.getBoundingClientRect(),h=1-((e.touches&&e.touches[0]||e).clientY-fieldRect.top)/(fieldRect.bottom-fieldRect.top);return h>1?h=1:h<0&&(h=0),_this.__color.h=360*h,_this.setValue(_this.__color.toOriginal()),!1}return Common.extend(_this2.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),Common.extend(_this2.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:_this2.__field_knob_border+(_this2.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),Common.extend(_this2.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),Common.extend(_this2.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),Common.extend(valueField.style,{width:"100%",height:"100%",background:"none"}),linearGradient(valueField,"top","rgba(0,0,0,0)","#000"),Common.extend(_this2.__hue_field.style,{width:"15px",height:"100px",border:"1px solid #555",cursor:"ns-resize",position:"absolute",top:"3px",right:"3px"}),(elem=_this2.__hue_field).style.background="",elem.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",elem.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",elem.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",elem.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",elem.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",Common.extend(_this2.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:_this2.__input_textShadow+"rgba(0,0,0,0.7)"}),dom.bind(_this2.__saturation_field,"mousedown",fieldDown),dom.bind(_this2.__saturation_field,"touchstart",fieldDown),dom.bind(_this2.__field_knob,"mousedown",fieldDown),dom.bind(_this2.__field_knob,"touchstart",fieldDown),dom.bind(_this2.__hue_field,"mousedown",fieldDownH),dom.bind(_this2.__hue_field,"touchstart",fieldDownH),_this2.__saturation_field.appendChild(valueField),_this2.__selector.appendChild(_this2.__field_knob),_this2.__selector.appendChild(_this2.__saturation_field),_this2.__selector.appendChild(_this2.__hue_field),_this2.__hue_field.appendChild(_this2.__hue_knob),_this2.domElement.appendChild(_this2.__input),_this2.domElement.appendChild(_this2.__selector),_this2.updateDisplay(),_this2}return inherits(ColorController,Controller),createClass(ColorController,[{key:"updateDisplay",value:function(){var i=interpret(this.getValue());if(!1!==i){var mismatch=!1;Common.each(Color.COMPONENTS,function(component){if(!Common.isUndefined(i[component])&&!Common.isUndefined(this.__color.__state[component])&&i[component]!==this.__color.__state[component])return mismatch=!0,{}},this),mismatch&&Common.extend(this.__color.__state,i)}Common.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var flip=this.__color.v<.5||this.__color.s>.5?255:0,_flip=255-flip;Common.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toHexString(),border:this.__field_knob_border+"rgb("+flip+","+flip+","+flip+")"}),this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px",this.__temp.s=1,this.__temp.v=1,linearGradient(this.__saturation_field,"left","#fff",this.__temp.toHexString()),this.__input.value=this.__color.toString(),Common.extend(this.__input.style,{backgroundColor:this.__color.toHexString(),color:"rgb("+flip+","+flip+","+flip+")",textShadow:this.__input_textShadow+"rgba("+_flip+","+_flip+","+_flip+",.7)"})}}]),ColorController}(),vendors=["-moz-","-o-","-webkit-","-ms-",""];function linearGradient(elem,x,a,b){elem.style.background="",Common.each(vendors,function(vendor){elem.style.cssText+="background: "+vendor+"linear-gradient("+x+", "+a+" 0%, "+b+" 100%); "})}var css_inject=function(cssContent,indoc){var doc=indoc||document,injected=document.createElement("style");injected.type="text/css",injected.innerHTML=cssContent;var head=doc.getElementsByTagName("head")[0];try{head.appendChild(injected)}catch(e){}},ControllerFactory=function(object,property){var initialValue=object[property];return Common.isArray(arguments[2])||Common.isObject(arguments[2])?new OptionController(object,property,arguments[2]):Common.isNumber(initialValue)?Common.isNumber(arguments[2])&&Common.isNumber(arguments[3])?Common.isNumber(arguments[4])?new NumberControllerSlider(object,property,arguments[2],arguments[3],arguments[4]):new NumberControllerSlider(object,property,arguments[2],arguments[3]):Common.isNumber(arguments[4])?new NumberControllerBox(object,property,{min:arguments[2],max:arguments[3],step:arguments[4]}):new NumberControllerBox(object,property,{min:arguments[2],max:arguments[3]}):Common.isString(initialValue)?new StringController(object,property):Common.isFunction(initialValue)?new FunctionController(object,property,""):Common.isBoolean(initialValue)?new BooleanController(object,property):null};var requestAnimationFrame$1=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(callback){setTimeout(callback,1e3/60)},CenteredDiv=function(){function CenteredDiv(){classCallCheck(this,CenteredDiv),this.backgroundElement=document.createElement("div"),Common.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear",transition:"opacity 0.2s linear"}),dom.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),Common.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear",transition:"transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var _this=this;dom.bind(this.backgroundElement,"click",function(){_this.hide()})}return createClass(CenteredDiv,[{key:"show",value:function(){var _this=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),Common.defer(function(){_this.backgroundElement.style.opacity=1,_this.domElement.style.opacity=1,_this.domElement.style.webkitTransform="scale(1)"})}},{key:"hide",value:function(){var _this=this,hide=function hide(){_this.domElement.style.display="none",_this.backgroundElement.style.display="none",dom.unbind(_this.domElement,"webkitTransitionEnd",hide),dom.unbind(_this.domElement,"transitionend",hide),dom.unbind(_this.domElement,"oTransitionEnd",hide)};dom.bind(this.domElement,"webkitTransitionEnd",hide),dom.bind(this.domElement,"transitionend",hide),dom.bind(this.domElement,"oTransitionEnd",hide),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"}},{key:"layout",value:function(){this.domElement.style.left=window.innerWidth/2-dom.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-dom.getHeight(this.domElement)/2+"px"}}]),CenteredDiv}();css_inject(function(css){if(css&&"undefined"!=typeof window){var style=document.createElement("style");return style.setAttribute("type","text/css"),style.innerHTML=css,document.head.appendChild(style),css}}(".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear;border:0;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button.close-top{position:relative}.dg.main .close-button.close-bottom{position:absolute}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-y:visible}.dg.a.has-save>ul.close-top{margin-top:0}.dg.a.has-save>ul.close-bottom{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{top:0;z-index:1002}.dg.a .save-row.close-top{position:relative}.dg.a .save-row.close-bottom{position:fixed}.dg li{-webkit-transition:height .1s ease-out;-o-transition:height .1s ease-out;-moz-transition:height .1s ease-out;transition:height .1s ease-out;-webkit-transition:overflow .1s linear;-o-transition:overflow .1s linear;-moz-transition:overflow .1s linear;transition:overflow .1s linear}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px;overflow:hidden}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .c{float:left;width:60%;position:relative}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:7px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .cr.color{overflow:visible}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2FA1D6}.dg .cr.number input[type=text]{color:#2FA1D6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2FA1D6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}\n"));var DEFAULT_DEFAULT_PRESET_NAME="Default",SUPPORTS_LOCAL_STORAGE=function(){try{return!!window.localStorage}catch(e){return!1}}(),SAVE_DIALOGUE=void 0,autoPlaceVirgin=!0,autoPlaceContainer=void 0,hide=!1,hideableGuis=[],GUI=function GUI(pars){var _this=this,params=pars||{};this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),dom.addClass(this.domElement,"dg"),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],params=Common.defaults(params,{closeOnTop:!1,autoPlace:!0,width:GUI.DEFAULT_WIDTH}),params=Common.defaults(params,{resizable:params.autoPlace,hideable:params.autoPlace}),Common.isUndefined(params.load)?params.load={preset:DEFAULT_DEFAULT_PRESET_NAME}:params.preset&&(params.load.preset=params.preset),Common.isUndefined(params.parent)&&params.hideable&&hideableGuis.push(this),params.resizable=Common.isUndefined(params.parent)&&params.resizable,params.autoPlace&&Common.isUndefined(params.scrollable)&&(params.scrollable=!0);var root,useLocalStorage=SUPPORTS_LOCAL_STORAGE&&"true"===localStorage.getItem(getLocalStorageHash(this,"isLocal")),saveToLocalStorage=void 0,titleRow=void 0;if(Object.defineProperties(this,{parent:{get:function(){return params.parent}},scrollable:{get:function(){return params.scrollable}},autoPlace:{get:function(){return params.autoPlace}},closeOnTop:{get:function(){return params.closeOnTop}},preset:{get:function(){return _this.parent?_this.getRoot().preset:params.load.preset},set:function(v){_this.parent?_this.getRoot().preset=v:params.load.preset=v,function(gui){for(var index=0;index<gui.__preset_select.length;index++)gui.__preset_select[index].value===gui.preset&&(gui.__preset_select.selectedIndex=index)}(this),_this.revert()}},width:{get:function(){return params.width},set:function(v){params.width=v,setWidth(_this,v)}},name:{get:function(){return params.name},set:function(v){params.name=v,titleRow&&(titleRow.innerHTML=params.name)}},closed:{get:function(){return params.closed},set:function(v){params.closed=v,params.closed?dom.addClass(_this.__ul,GUI.CLASS_CLOSED):dom.removeClass(_this.__ul,GUI.CLASS_CLOSED),this.onResize(),_this.__closeButton&&(_this.__closeButton.innerHTML=v?GUI.TEXT_OPEN:GUI.TEXT_CLOSED)}},load:{get:function(){return params.load}},useLocalStorage:{get:function(){return useLocalStorage},set:function(bool){SUPPORTS_LOCAL_STORAGE&&(useLocalStorage=bool,bool?dom.bind(window,"unload",saveToLocalStorage):dom.unbind(window,"unload",saveToLocalStorage),localStorage.setItem(getLocalStorageHash(_this,"isLocal"),bool))}}}),Common.isUndefined(params.parent)){if(params.closed=!1,dom.addClass(this.domElement,GUI.CLASS_MAIN),dom.makeSelectable(this.domElement,!1),SUPPORTS_LOCAL_STORAGE&&useLocalStorage){_this.useLocalStorage=!0;var savedGui=localStorage.getItem(getLocalStorageHash(this,"gui"));savedGui&&(params.load=JSON.parse(savedGui))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=GUI.TEXT_CLOSED,dom.addClass(this.__closeButton,GUI.CLASS_CLOSE_BUTTON),params.closeOnTop?(dom.addClass(this.__closeButton,GUI.CLASS_CLOSE_TOP),this.domElement.insertBefore(this.__closeButton,this.domElement.childNodes[0])):(dom.addClass(this.__closeButton,GUI.CLASS_CLOSE_BOTTOM),this.domElement.appendChild(this.__closeButton)),dom.bind(this.__closeButton,"click",function(){_this.closed=!_this.closed})}else{void 0===params.closed&&(params.closed=!0);var titleRowName=document.createTextNode(params.name);dom.addClass(titleRowName,"controller-name"),titleRow=addRow(_this,titleRowName);dom.addClass(this.__ul,GUI.CLASS_CLOSED),dom.addClass(titleRow,"title"),dom.bind(titleRow,"click",function(e){return e.preventDefault(),_this.closed=!_this.closed,!1}),params.closed||(this.closed=!1)}params.autoPlace&&(Common.isUndefined(params.parent)&&(autoPlaceVirgin&&(autoPlaceContainer=document.createElement("div"),dom.addClass(autoPlaceContainer,"dg"),dom.addClass(autoPlaceContainer,GUI.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(autoPlaceContainer),autoPlaceVirgin=!1),autoPlaceContainer.appendChild(this.domElement),dom.addClass(this.domElement,GUI.CLASS_AUTO_PLACE)),this.parent||setWidth(_this,params.width)),this.__resizeHandler=function(){_this.onResizeDebounced()},dom.bind(window,"resize",this.__resizeHandler),dom.bind(this.__ul,"webkitTransitionEnd",this.__resizeHandler),dom.bind(this.__ul,"transitionend",this.__resizeHandler),dom.bind(this.__ul,"oTransitionEnd",this.__resizeHandler),this.onResize(),params.resizable&&addResizeHandle(this),saveToLocalStorage=function(){SUPPORTS_LOCAL_STORAGE&&"true"===localStorage.getItem(getLocalStorageHash(_this,"isLocal"))&&localStorage.setItem(getLocalStorageHash(_this,"gui"),JSON.stringify(_this.getSaveObject()))},this.saveToLocalStorageIfPossible=saveToLocalStorage,params.parent||((root=_this.getRoot()).width+=1,Common.defer(function(){root.width-=1}))};function addRow(gui,newDom,liBefore){var li=document.createElement("li");return newDom&&li.appendChild(newDom),liBefore?gui.__ul.insertBefore(li,liBefore):gui.__ul.appendChild(li),gui.onResize(),li}function removeListeners(gui){dom.unbind(window,"resize",gui.__resizeHandler),gui.saveToLocalStorageIfPossible&&dom.unbind(window,"unload",gui.saveToLocalStorageIfPossible)}function markPresetModified(gui,modified){var opt=gui.__preset_select[gui.__preset_select.selectedIndex];opt.innerHTML=modified?opt.value+"*":opt.value}function recallSavedValue(gui,controller){var root=gui.getRoot(),matchedIndex=root.__rememberedObjects.indexOf(controller.object);if(-1!==matchedIndex){var controllerMap=root.__rememberedObjectIndecesToControllers[matchedIndex];if(void 0===controllerMap&&(controllerMap={},root.__rememberedObjectIndecesToControllers[matchedIndex]=controllerMap),controllerMap[controller.property]=controller,root.load&&root.load.remembered){var presetMap=root.load.remembered,preset=void 0;if(presetMap[gui.preset])preset=presetMap[gui.preset];else{if(!presetMap[DEFAULT_DEFAULT_PRESET_NAME])return;preset=presetMap[DEFAULT_DEFAULT_PRESET_NAME]}if(preset[matchedIndex]&&void 0!==preset[matchedIndex][controller.property]){var value=preset[matchedIndex][controller.property];controller.initialValue=value,controller.setValue(value)}}}}function _add(gui,object,property,params){if(void 0===object[property])throw new Error('Object "'+object+'" has no property "'+property+'"');var controller=void 0;if(params.color)controller=new ColorController(object,property);else{var factoryArgs=[object,property].concat(params.factoryArgs);controller=ControllerFactory.apply(gui,factoryArgs)}params.before instanceof Controller&&(params.before=params.before.__li),recallSavedValue(gui,controller),dom.addClass(controller.domElement,"c");var name=document.createElement("span");dom.addClass(name,"property-name"),name.innerHTML=controller.property;var container=document.createElement("div");container.appendChild(name),container.appendChild(controller.domElement);var li=addRow(gui,container,params.before);return dom.addClass(li,GUI.CLASS_CONTROLLER_ROW),controller instanceof ColorController?dom.addClass(li,"color"):dom.addClass(li,_typeof(controller.getValue())),function(gui,li,controller){if(controller.__li=li,controller.__gui=gui,Common.extend(controller,{options:function(_options){if(arguments.length>1){var nextSibling=controller.__li.nextElementSibling;return controller.remove(),_add(gui,controller.object,controller.property,{before:nextSibling,factoryArgs:[Common.toArray(arguments)]})}if(Common.isArray(_options)||Common.isObject(_options)){var _nextSibling=controller.__li.nextElementSibling;return controller.remove(),_add(gui,controller.object,controller.property,{before:_nextSibling,factoryArgs:[_options]})}},name:function(_name){return controller.__li.firstElementChild.firstElementChild.innerHTML=_name,controller},listen:function(){return controller.__gui.listen(controller),controller},remove:function(){return controller.__gui.remove(controller),controller}}),controller instanceof NumberControllerSlider){var box=new NumberControllerBox(controller.object,controller.property,{min:controller.__min,max:controller.__max,step:controller.__step});Common.each(["updateDisplay","onChange","onFinishChange","step"],function(method){var pc=controller[method],pb=box[method];controller[method]=box[method]=function(){var args=Array.prototype.slice.call(arguments);return pb.apply(box,args),pc.apply(controller,args)}}),dom.addClass(li,"has-slider"),controller.domElement.insertBefore(box.domElement,controller.domElement.firstElementChild)}else if(controller instanceof NumberControllerBox){var r=function(returned){if(Common.isNumber(controller.__min)&&Common.isNumber(controller.__max)){var oldName=controller.__li.firstElementChild.firstElementChild.innerHTML,wasListening=controller.__gui.__listening.indexOf(controller)>-1;controller.remove();var newController=_add(gui,controller.object,controller.property,{before:controller.__li.nextElementSibling,factoryArgs:[controller.__min,controller.__max,controller.__step]});return newController.name(oldName),wasListening&&newController.listen(),newController}return returned};controller.min=Common.compose(r,controller.min),controller.max=Common.compose(r,controller.max)}else controller instanceof BooleanController?(dom.bind(li,"click",function(){dom.fakeEvent(controller.__checkbox,"click")}),dom.bind(controller.__checkbox,"click",function(e){e.stopPropagation()})):controller instanceof FunctionController?(dom.bind(li,"click",function(){dom.fakeEvent(controller.__button,"click")}),dom.bind(li,"mouseover",function(){dom.addClass(controller.__button,"hover")}),dom.bind(li,"mouseout",function(){dom.removeClass(controller.__button,"hover")})):controller instanceof ColorController&&(dom.addClass(li,"color"),controller.updateDisplay=Common.compose(function(val){return li.style.borderLeftColor=controller.__color.toString(),val},controller.updateDisplay),controller.updateDisplay());controller.setValue=Common.compose(function(val){return gui.getRoot().__preset_select&&controller.isModified()&&markPresetModified(gui.getRoot(),!0),val},controller.setValue)}(gui,li,controller),gui.__controllers.push(controller),controller}function getLocalStorageHash(gui,key){return document.location.href+"."+key}function addPresetOption(gui,name,setSelected){var opt=document.createElement("option");opt.innerHTML=name,opt.value=name,gui.__preset_select.appendChild(opt),setSelected&&(gui.__preset_select.selectedIndex=gui.__preset_select.length-1)}function showHideExplain(gui,explain){explain.style.display=gui.useLocalStorage?"block":"none"}function addResizeHandle(gui){var pmouseX=void 0;function drag(e){return e.preventDefault(),gui.width+=pmouseX-e.clientX,gui.onResize(),pmouseX=e.clientX,!1}function dragStop(){dom.removeClass(gui.__closeButton,GUI.CLASS_DRAG),dom.unbind(window,"mousemove",drag),dom.unbind(window,"mouseup",dragStop)}function dragStart(e){return e.preventDefault(),pmouseX=e.clientX,dom.addClass(gui.__closeButton,GUI.CLASS_DRAG),dom.bind(window,"mousemove",drag),dom.bind(window,"mouseup",dragStop),!1}gui.__resize_handle=document.createElement("div"),Common.extend(gui.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"}),dom.bind(gui.__resize_handle,"mousedown",dragStart),dom.bind(gui.__closeButton,"mousedown",dragStart),gui.domElement.insertBefore(gui.__resize_handle,gui.domElement.firstElementChild)}function setWidth(gui,w){gui.domElement.style.width=w+"px",gui.__save_row&&gui.autoPlace&&(gui.__save_row.style.width=w+"px"),gui.__closeButton&&(gui.__closeButton.style.width=w+"px")}function getCurrentPreset(gui,useInitialValues){var toReturn={};return Common.each(gui.__rememberedObjects,function(val,index){var savedValues={},controllerMap=gui.__rememberedObjectIndecesToControllers[index];Common.each(controllerMap,function(controller,property){savedValues[property]=useInitialValues?controller.initialValue:controller.getValue()}),toReturn[index]=savedValues}),toReturn}GUI.toggleHide=function(){hide=!hide,Common.each(hideableGuis,function(gui){gui.domElement.style.display=hide?"none":""})},GUI.CLASS_AUTO_PLACE="a",GUI.CLASS_AUTO_PLACE_CONTAINER="ac",GUI.CLASS_MAIN="main",GUI.CLASS_CONTROLLER_ROW="cr",GUI.CLASS_TOO_TALL="taller-than-window",GUI.CLASS_CLOSED="closed",GUI.CLASS_CLOSE_BUTTON="close-button",GUI.CLASS_CLOSE_TOP="close-top",GUI.CLASS_CLOSE_BOTTOM="close-bottom",GUI.CLASS_DRAG="drag",GUI.DEFAULT_WIDTH=245,GUI.TEXT_CLOSED="Close Controls",GUI.TEXT_OPEN="Open Controls",GUI._keydownHandler=function(e){"text"===document.activeElement.type||72!==e.which&&72!==e.keyCode||GUI.toggleHide()},dom.bind(window,"keydown",GUI._keydownHandler,!1),Common.extend(GUI.prototype,{add:function(object,property){return _add(this,object,property,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(object,property){return _add(this,object,property,{color:!0})},remove:function(controller){this.__ul.removeChild(controller.__li),this.__controllers.splice(this.__controllers.indexOf(controller),1);var _this=this;Common.defer(function(){_this.onResize()})},destroy:function(){if(this.parent)throw new Error("Only the root GUI should be removed with .destroy(). For subfolders, use gui.removeFolder(folder) instead.");this.autoPlace&&autoPlaceContainer.removeChild(this.domElement);var _this=this;Common.each(this.__folders,function(subfolder){_this.removeFolder(subfolder)}),dom.unbind(window,"keydown",GUI._keydownHandler,!1),removeListeners(this)},addFolder:function(name){if(void 0!==this.__folders[name])throw new Error('You already have a folder in this GUI by the name "'+name+'"');var newGuiParams={name:name,parent:this};newGuiParams.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[name]&&(newGuiParams.closed=this.load.folders[name].closed,newGuiParams.load=this.load.folders[name]);var gui=new GUI(newGuiParams);this.__folders[name]=gui;var li=addRow(this,gui.domElement);return dom.addClass(li,"folder"),gui},removeFolder:function(folder){this.__ul.removeChild(folder.domElement.parentElement),delete this.__folders[folder.name],this.load&&this.load.folders&&this.load.folders[folder.name]&&delete this.load.folders[folder.name],removeListeners(folder);var _this=this;Common.each(folder.__folders,function(subfolder){folder.removeFolder(subfolder)}),Common.defer(function(){_this.onResize()})},open:function(){this.closed=!1},close:function(){this.closed=!0},onResize:function(){var root=this.getRoot();if(root.scrollable){var top=dom.getOffset(root.__ul).top,h=0;Common.each(root.__ul.childNodes,function(node){root.autoPlace&&node===root.__save_row||(h+=dom.getHeight(node))}),window.innerHeight-top-20<h?(dom.addClass(root.domElement,GUI.CLASS_TOO_TALL),root.__ul.style.height=window.innerHeight-top-20+"px"):(dom.removeClass(root.domElement,GUI.CLASS_TOO_TALL),root.__ul.style.height="auto")}root.__resize_handle&&Common.defer(function(){root.__resize_handle.style.height=root.__ul.offsetHeight+"px"}),root.__closeButton&&(root.__closeButton.style.width=root.width+"px")},onResizeDebounced:Common.debounce(function(){this.onResize()},50),remember:function(){if(Common.isUndefined(SAVE_DIALOGUE)&&((SAVE_DIALOGUE=new CenteredDiv).domElement.innerHTML='<div id="dg-save" class="dg dialogue">\n\n  Here\'s the new load parameter for your <code>GUI</code>\'s constructor:\n\n  <textarea id="dg-new-constructor"></textarea>\n\n  <div id="dg-save-locally">\n\n    <input id="dg-local-storage" type="checkbox"/> Automatically save\n    values to <code>localStorage</code> on exit.\n\n    <div id="dg-local-explain">The values saved to <code>localStorage</code> will\n      override those passed to <code>dat.GUI</code>\'s constructor. This makes it\n      easier to work incrementally, but <code>localStorage</code> is fragile,\n      and your friends may not see the same values you do.\n\n    </div>\n\n  </div>\n\n</div>'),this.parent)throw new Error("You can only call remember on a top level GUI.");var _this=this;Common.each(Array.prototype.slice.call(arguments),function(object){0===_this.__rememberedObjects.length&&function(gui){var div=gui.__save_row=document.createElement("li");dom.addClass(gui.domElement,"has-save"),gui.__ul.insertBefore(div,gui.__ul.firstChild),dom.addClass(div,"save-row");var gears=document.createElement("span");gears.innerHTML="&nbsp;",dom.addClass(gears,"button gears");var button=document.createElement("span");button.innerHTML="Save",dom.addClass(button,"button"),dom.addClass(button,"save");var button2=document.createElement("span");button2.innerHTML="New",dom.addClass(button2,"button"),dom.addClass(button2,"save-as");var button3=document.createElement("span");button3.innerHTML="Revert",dom.addClass(button3,"button"),dom.addClass(button3,"revert");var select=gui.__preset_select=document.createElement("select");gui.load&&gui.load.remembered?Common.each(gui.load.remembered,function(value,key){addPresetOption(gui,key,key===gui.preset)}):addPresetOption(gui,DEFAULT_DEFAULT_PRESET_NAME,!1);if(dom.bind(select,"change",function(){for(var index=0;index<gui.__preset_select.length;index++)gui.__preset_select[index].innerHTML=gui.__preset_select[index].value;gui.preset=this.value}),div.appendChild(select),div.appendChild(gears),div.appendChild(button),div.appendChild(button2),div.appendChild(button3),SUPPORTS_LOCAL_STORAGE){var explain=document.getElementById("dg-local-explain"),localStorageCheckBox=document.getElementById("dg-local-storage"),saveLocally=document.getElementById("dg-save-locally");saveLocally.style.display="block","true"===localStorage.getItem(getLocalStorageHash(gui,"isLocal"))&&localStorageCheckBox.setAttribute("checked","checked"),showHideExplain(gui,explain),dom.bind(localStorageCheckBox,"change",function(){gui.useLocalStorage=!gui.useLocalStorage,showHideExplain(gui,explain)})}var newConstructorTextArea=document.getElementById("dg-new-constructor");dom.bind(newConstructorTextArea,"keydown",function(e){!e.metaKey||67!==e.which&&67!==e.keyCode||SAVE_DIALOGUE.hide()}),dom.bind(gears,"click",function(){newConstructorTextArea.innerHTML=JSON.stringify(gui.getSaveObject(),void 0,2),SAVE_DIALOGUE.show(),newConstructorTextArea.focus(),newConstructorTextArea.select()}),dom.bind(button,"click",function(){gui.save()}),dom.bind(button2,"click",function(){var presetName=prompt("Enter a new preset name.");presetName&&gui.saveAs(presetName)}),dom.bind(button3,"click",function(){gui.revert()})}(_this),-1===_this.__rememberedObjects.indexOf(object)&&_this.__rememberedObjects.push(object)}),this.autoPlace&&setWidth(this,this.width)},getRoot:function(){for(var gui=this;gui.parent;)gui=gui.parent;return gui},getSaveObject:function(){var toReturn=this.load;return toReturn.closed=this.closed,this.__rememberedObjects.length>0&&(toReturn.preset=this.preset,toReturn.remembered||(toReturn.remembered={}),toReturn.remembered[this.preset]=getCurrentPreset(this)),toReturn.folders={},Common.each(this.__folders,function(element,key){toReturn.folders[key]=element.getSaveObject()}),toReturn},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=getCurrentPreset(this),markPresetModified(this,!1),this.saveToLocalStorageIfPossible()},saveAs:function(presetName){this.load.remembered||(this.load.remembered={},this.load.remembered[DEFAULT_DEFAULT_PRESET_NAME]=getCurrentPreset(this,!0)),this.load.remembered[presetName]=getCurrentPreset(this),this.preset=presetName,addPresetOption(this,presetName,!0),this.saveToLocalStorageIfPossible()},revert:function(gui){Common.each(this.__controllers,function(controller){this.getRoot().load.remembered?recallSavedValue(gui||this.getRoot(),controller):controller.setValue(controller.initialValue),controller.__onFinishChange&&controller.__onFinishChange.call(controller,controller.getValue())},this),Common.each(this.__folders,function(folder){folder.revert(folder)}),gui||markPresetModified(this.getRoot(),!1)},listen:function(controller){var init=0===this.__listening.length;this.__listening.push(controller),init&&function updateDisplays(controllerArray){0!==controllerArray.length&&requestAnimationFrame$1.call(window,function(){updateDisplays(controllerArray)});Common.each(controllerArray,function(c){c.updateDisplay()})}(this.__listening)},updateDisplay:function(){Common.each(this.__controllers,function(controller){controller.updateDisplay()}),Common.each(this.__folders,function(folder){folder.updateDisplay()})}});var color={Color:Color,math:ColorMath,interpret:interpret},controllers={Controller:Controller,BooleanController:BooleanController,OptionController:OptionController,StringController:StringController,NumberController:NumberController,NumberControllerBox:NumberControllerBox,NumberControllerSlider:NumberControllerSlider,FunctionController:FunctionController,ColorController:ColorController},dom$1={dom:dom},gui={GUI:GUI},GUI$1=GUI,index={color:color,controllers:controllers,dom:dom$1,gui:gui,GUI:GUI$1};__webpack_exports__.default=index},"./node_modules/fastclick/lib/fastclick.js":function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_RESULT__;!function(){"use strict";function FastClick(layer,options){var oldOnClick;if(options=options||{},this.trackingClick=!1,this.trackingClickStart=0,this.targetElement=null,this.touchStartX=0,this.touchStartY=0,this.lastTouchIdentifier=0,this.touchBoundary=options.touchBoundary||10,this.layer=layer,this.tapDelay=options.tapDelay||200,this.tapTimeout=options.tapTimeout||700,!FastClick.notNeeded(layer)){for(var methods=["onMouse","onClick","onTouchStart","onTouchMove","onTouchEnd","onTouchCancel"],i=0,l=methods.length;i<l;i++)this[methods[i]]=bind(this[methods[i]],this);deviceIsAndroid&&(layer.addEventListener("mouseover",this.onMouse,!0),layer.addEventListener("mousedown",this.onMouse,!0),layer.addEventListener("mouseup",this.onMouse,!0)),layer.addEventListener("click",this.onClick,!0),layer.addEventListener("touchstart",this.onTouchStart,!1),layer.addEventListener("touchmove",this.onTouchMove,!1),layer.addEventListener("touchend",this.onTouchEnd,!1),layer.addEventListener("touchcancel",this.onTouchCancel,!1),Event.prototype.stopImmediatePropagation||(layer.removeEventListener=function(type,callback,capture){var rmv=Node.prototype.removeEventListener;"click"===type?rmv.call(layer,type,callback.hijacked||callback,capture):rmv.call(layer,type,callback,capture)},layer.addEventListener=function(type,callback,capture){var adv=Node.prototype.addEventListener;"click"===type?adv.call(layer,type,callback.hijacked||(callback.hijacked=function(event){event.propagationStopped||callback(event)}),capture):adv.call(layer,type,callback,capture)}),"function"==typeof layer.onclick&&(oldOnClick=layer.onclick,layer.addEventListener("click",function(event){oldOnClick(event)},!1),layer.onclick=null)}function bind(method,context){return function(){return method.apply(context,arguments)}}}var deviceIsWindowsPhone=navigator.userAgent.indexOf("Windows Phone")>=0,deviceIsAndroid=navigator.userAgent.indexOf("Android")>0&&!deviceIsWindowsPhone,deviceIsIOS=/iP(ad|hone|od)/.test(navigator.userAgent)&&!deviceIsWindowsPhone,deviceIsIOS4=deviceIsIOS&&/OS 4_\d(_\d)?/.test(navigator.userAgent),deviceIsIOSWithBadTarget=deviceIsIOS&&/OS [6-7]_\d/.test(navigator.userAgent),deviceIsBlackBerry10=navigator.userAgent.indexOf("BB10")>0;FastClick.prototype.needsClick=function(target){switch(target.nodeName.toLowerCase()){case"button":case"select":case"textarea":if(target.disabled)return!0;break;case"input":if(deviceIsIOS&&"file"===target.type||target.disabled)return!0;break;case"label":case"iframe":case"video":return!0}return/\bneedsclick\b/.test(target.className)},FastClick.prototype.needsFocus=function(target){switch(target.nodeName.toLowerCase()){case"textarea":return!0;case"select":return!deviceIsAndroid;case"input":switch(target.type){case"button":case"checkbox":case"file":case"image":case"radio":case"submit":return!1}return!target.disabled&&!target.readOnly;default:return/\bneedsfocus\b/.test(target.className)}},FastClick.prototype.sendClick=function(targetElement,event){var clickEvent,touch;document.activeElement&&document.activeElement!==targetElement&&document.activeElement.blur(),touch=event.changedTouches[0],(clickEvent=document.createEvent("MouseEvents")).initMouseEvent(this.determineEventType(targetElement),!0,!0,window,1,touch.screenX,touch.screenY,touch.clientX,touch.clientY,!1,!1,!1,!1,0,null),clickEvent.forwardedTouchEvent=!0,targetElement.dispatchEvent(clickEvent)},FastClick.prototype.determineEventType=function(targetElement){return deviceIsAndroid&&"select"===targetElement.tagName.toLowerCase()?"mousedown":"click"},FastClick.prototype.focus=function(targetElement){var length;deviceIsIOS&&targetElement.setSelectionRange&&0!==targetElement.type.indexOf("date")&&"time"!==targetElement.type&&"month"!==targetElement.type?(length=targetElement.value.length,targetElement.setSelectionRange(length,length)):targetElement.focus()},FastClick.prototype.updateScrollParent=function(targetElement){var scrollParent,parentElement;if(!(scrollParent=targetElement.fastClickScrollParent)||!scrollParent.contains(targetElement)){parentElement=targetElement;do{if(parentElement.scrollHeight>parentElement.offsetHeight){scrollParent=parentElement,targetElement.fastClickScrollParent=parentElement;break}parentElement=parentElement.parentElement}while(parentElement)}scrollParent&&(scrollParent.fastClickLastScrollTop=scrollParent.scrollTop)},FastClick.prototype.getTargetElementFromEventTarget=function(eventTarget){return eventTarget.nodeType===Node.TEXT_NODE?eventTarget.parentNode:eventTarget},FastClick.prototype.onTouchStart=function(event){var targetElement,touch,selection;if(event.targetTouches.length>1)return!0;if(targetElement=this.getTargetElementFromEventTarget(event.target),touch=event.targetTouches[0],deviceIsIOS){if((selection=window.getSelection()).rangeCount&&!selection.isCollapsed)return!0;if(!deviceIsIOS4){if(touch.identifier&&touch.identifier===this.lastTouchIdentifier)return event.preventDefault(),!1;this.lastTouchIdentifier=touch.identifier,this.updateScrollParent(targetElement)}}return this.trackingClick=!0,this.trackingClickStart=event.timeStamp,this.targetElement=targetElement,this.touchStartX=touch.pageX,this.touchStartY=touch.pageY,event.timeStamp-this.lastClickTime<this.tapDelay&&event.preventDefault(),!0},FastClick.prototype.touchHasMoved=function(event){var touch=event.changedTouches[0],boundary=this.touchBoundary;return Math.abs(touch.pageX-this.touchStartX)>boundary||Math.abs(touch.pageY-this.touchStartY)>boundary},FastClick.prototype.onTouchMove=function(event){return!this.trackingClick||((this.targetElement!==this.getTargetElementFromEventTarget(event.target)||this.touchHasMoved(event))&&(this.trackingClick=!1,this.targetElement=null),!0)},FastClick.prototype.findControl=function(labelElement){return void 0!==labelElement.control?labelElement.control:labelElement.htmlFor?document.getElementById(labelElement.htmlFor):labelElement.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea")},FastClick.prototype.onTouchEnd=function(event){var forElement,trackingClickStart,targetTagName,scrollParent,touch,targetElement=this.targetElement;if(!this.trackingClick)return!0;if(event.timeStamp-this.lastClickTime<this.tapDelay)return this.cancelNextClick=!0,!0;if(event.timeStamp-this.trackingClickStart>this.tapTimeout)return!0;if(this.cancelNextClick=!1,this.lastClickTime=event.timeStamp,trackingClickStart=this.trackingClickStart,this.trackingClick=!1,this.trackingClickStart=0,deviceIsIOSWithBadTarget&&(touch=event.changedTouches[0],(targetElement=document.elementFromPoint(touch.pageX-window.pageXOffset,touch.pageY-window.pageYOffset)||targetElement).fastClickScrollParent=this.targetElement.fastClickScrollParent),"label"===(targetTagName=targetElement.tagName.toLowerCase())){if(forElement=this.findControl(targetElement)){if(this.focus(targetElement),deviceIsAndroid)return!1;targetElement=forElement}}else if(this.needsFocus(targetElement))return event.timeStamp-trackingClickStart>100||deviceIsIOS&&window.top!==window&&"input"===targetTagName?(this.targetElement=null,!1):(this.focus(targetElement),this.sendClick(targetElement,event),deviceIsIOS&&"select"===targetTagName||(this.targetElement=null,event.preventDefault()),!1);return!(!deviceIsIOS||deviceIsIOS4||!(scrollParent=targetElement.fastClickScrollParent)||scrollParent.fastClickLastScrollTop===scrollParent.scrollTop)||(this.needsClick(targetElement)||(event.preventDefault(),this.sendClick(targetElement,event)),!1)},FastClick.prototype.onTouchCancel=function(){this.trackingClick=!1,this.targetElement=null},FastClick.prototype.onMouse=function(event){return!this.targetElement||(!!event.forwardedTouchEvent||(!event.cancelable||(!(!this.needsClick(this.targetElement)||this.cancelNextClick)||(event.stopImmediatePropagation?event.stopImmediatePropagation():event.propagationStopped=!0,event.stopPropagation(),event.preventDefault(),!1))))},FastClick.prototype.onClick=function(event){var permitted;return this.trackingClick?(this.targetElement=null,this.trackingClick=!1,!0):"submit"===event.target.type&&0===event.detail||((permitted=this.onMouse(event))||(this.targetElement=null),permitted)},FastClick.prototype.destroy=function(){var layer=this.layer;deviceIsAndroid&&(layer.removeEventListener("mouseover",this.onMouse,!0),layer.removeEventListener("mousedown",this.onMouse,!0),layer.removeEventListener("mouseup",this.onMouse,!0)),layer.removeEventListener("click",this.onClick,!0),layer.removeEventListener("touchstart",this.onTouchStart,!1),layer.removeEventListener("touchmove",this.onTouchMove,!1),layer.removeEventListener("touchend",this.onTouchEnd,!1),layer.removeEventListener("touchcancel",this.onTouchCancel,!1)},FastClick.notNeeded=function(layer){var metaViewport,chromeVersion,blackberryVersion;if(void 0===window.ontouchstart)return!0;if(chromeVersion=+(/Chrome\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1]){if(!deviceIsAndroid)return!0;if(metaViewport=document.querySelector("meta[name=viewport]")){if(-1!==metaViewport.content.indexOf("user-scalable=no"))return!0;if(chromeVersion>31&&document.documentElement.scrollWidth<=window.outerWidth)return!0}}if(deviceIsBlackBerry10&&(blackberryVersion=navigator.userAgent.match(/Version\/([0-9]*)\.([0-9]*)/))[1]>=10&&blackberryVersion[2]>=3&&(metaViewport=document.querySelector("meta[name=viewport]"))){if(-1!==metaViewport.content.indexOf("user-scalable=no"))return!0;if(document.documentElement.scrollWidth<=window.outerWidth)return!0}return"none"===layer.style.msTouchAction||"manipulation"===layer.style.touchAction||(!!(+(/Firefox\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1]>=27&&(metaViewport=document.querySelector("meta[name=viewport]"))&&(-1!==metaViewport.content.indexOf("user-scalable=no")||document.documentElement.scrollWidth<=window.outerWidth))||("none"===layer.style.touchAction||"manipulation"===layer.style.touchAction))},FastClick.attach=function(layer,options){return new FastClick(layer,options)},void 0===(__WEBPACK_AMD_DEFINE_RESULT__=function(){return FastClick}.call(exports,__webpack_require__,exports,module))||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)}()},"./node_modules/fs.realpath/index.js":function(module,exports,__webpack_require__){(function(process){module.exports=realpath,realpath.realpath=realpath,realpath.sync=realpathSync,realpath.realpathSync=realpathSync,realpath.monkeypatch=function(){fs.realpath=realpath,fs.realpathSync=realpathSync},realpath.unmonkeypatch=function(){fs.realpath=origRealpath,fs.realpathSync=origRealpathSync};var fs=__webpack_require__("./lib/js/fs.js"),origRealpath=fs.realpath,origRealpathSync=fs.realpathSync,version=process.version,ok=/^v[0-5]\./.test(version),old=__webpack_require__("./node_modules/fs.realpath/old.js");function newError(er){return er&&"realpath"===er.syscall&&("ELOOP"===er.code||"ENOMEM"===er.code||"ENAMETOOLONG"===er.code)}function realpath(p,cache,cb){if(ok)return origRealpath(p,cache,cb);"function"==typeof cache&&(cb=cache,cache=null),origRealpath(p,cache,function(er,result){newError(er)?old.realpath(p,cache,cb):cb(er,result)})}function realpathSync(p,cache){if(ok)return origRealpathSync(p,cache);try{return origRealpathSync(p,cache)}catch(er){if(newError(er))return old.realpathSync(p,cache);throw er}}}).call(this,__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/node_modules/process/browser.js?55cf"))},"./node_modules/fs.realpath/old.js":function(module,exports,__webpack_require__){(function(process){var pathModule=__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/node_modules/path-browserify/index.js"),isWindows="win32"===process.platform,fs=__webpack_require__("./lib/js/fs.js"),DEBUG=process.env.NODE_DEBUG&&/fs/.test(process.env.NODE_DEBUG);function maybeCallback(cb){return"function"==typeof cb?cb:function(){var callback;if(DEBUG){var backtrace=new Error;callback=function(err){err&&(backtrace.message=err.message,missingCallback(err=backtrace))}}else callback=missingCallback;return callback;function missingCallback(err){if(err){if(process.throwDeprecation)throw err;if(!process.noDeprecation){var msg="fs: missing callback "+(err.stack||err.message);process.traceDeprecation?console.trace(msg):console.error(msg)}}}}()}pathModule.normalize;if(isWindows)var nextPartRe=/(.*?)(?:[\/\\]+|$)/g;else nextPartRe=/(.*?)(?:[\/]+|$)/g;if(isWindows)var splitRootRe=/^(?:[a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/][^\\\/]+)?[\\\/]*/;else splitRootRe=/^[\/]*/;exports.realpathSync=function(p,cache){if(p=pathModule.resolve(p),cache&&Object.prototype.hasOwnProperty.call(cache,p))return cache[p];var pos,current,base,previous,original=p,seenLinks={},knownHard={};function start(){var m=splitRootRe.exec(p);pos=m[0].length,current=m[0],base=m[0],previous="",isWindows&&!knownHard[base]&&(fs.lstatSync(base),knownHard[base]=!0)}for(start();pos<p.length;){nextPartRe.lastIndex=pos;var result=nextPartRe.exec(p);if(previous=current,current+=result[0],base=previous+result[1],pos=nextPartRe.lastIndex,!(knownHard[base]||cache&&cache[base]===base)){var resolvedLink;if(cache&&Object.prototype.hasOwnProperty.call(cache,base))resolvedLink=cache[base];else{var stat=fs.lstatSync(base);if(!stat.isSymbolicLink()){knownHard[base]=!0,cache&&(cache[base]=base);continue}var linkTarget=null;if(!isWindows){var id=stat.dev.toString(32)+":"+stat.ino.toString(32);seenLinks.hasOwnProperty(id)&&(linkTarget=seenLinks[id])}null===linkTarget&&(fs.statSync(base),linkTarget=fs.readlinkSync(base)),resolvedLink=pathModule.resolve(previous,linkTarget),cache&&(cache[base]=resolvedLink),isWindows||(seenLinks[id]=linkTarget)}p=pathModule.resolve(resolvedLink,p.slice(pos)),start()}}return cache&&(cache[original]=p),p},exports.realpath=function(p,cache,cb){if("function"!=typeof cb&&(cb=maybeCallback(cache),cache=null),p=pathModule.resolve(p),cache&&Object.prototype.hasOwnProperty.call(cache,p))return process.nextTick(cb.bind(null,null,cache[p]));var pos,current,base,previous,original=p,seenLinks={},knownHard={};function start(){var m=splitRootRe.exec(p);pos=m[0].length,current=m[0],base=m[0],previous="",isWindows&&!knownHard[base]?fs.lstat(base,function(err){if(err)return cb(err);knownHard[base]=!0,LOOP()}):process.nextTick(LOOP)}function LOOP(){if(pos>=p.length)return cache&&(cache[original]=p),cb(null,p);nextPartRe.lastIndex=pos;var result=nextPartRe.exec(p);return previous=current,current+=result[0],base=previous+result[1],pos=nextPartRe.lastIndex,knownHard[base]||cache&&cache[base]===base?process.nextTick(LOOP):cache&&Object.prototype.hasOwnProperty.call(cache,base)?gotResolvedLink(cache[base]):fs.lstat(base,gotStat)}function gotStat(err,stat){if(err)return cb(err);if(!stat.isSymbolicLink())return knownHard[base]=!0,cache&&(cache[base]=base),process.nextTick(LOOP);if(!isWindows){var id=stat.dev.toString(32)+":"+stat.ino.toString(32);if(seenLinks.hasOwnProperty(id))return gotTarget(null,seenLinks[id],base)}fs.stat(base,function(err){if(err)return cb(err);fs.readlink(base,function(err,target){isWindows||(seenLinks[id]=target),gotTarget(err,target)})})}function gotTarget(err,target,base){if(err)return cb(err);var resolvedLink=pathModule.resolve(previous,target);cache&&(cache[base]=resolvedLink),gotResolvedLink(resolvedLink)}function gotResolvedLink(resolvedLink){p=pathModule.resolve(resolvedLink,p.slice(pos)),start()}start()}}).call(this,__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/node_modules/process/browser.js?55cf"))},"./node_modules/glob/common.js":function(module,exports,__webpack_require__){(function(process){function ownProp(obj,field){return Object.prototype.hasOwnProperty.call(obj,field)}exports.alphasort=alphasort,exports.alphasorti=alphasorti,exports.setopts=function(self,pattern,options){options||(options={});if(options.matchBase&&-1===pattern.indexOf("/")){if(options.noglobstar)throw new Error("base matching requires globstar");pattern="**/"+pattern}self.silent=!!options.silent,self.pattern=pattern,self.strict=!1!==options.strict,self.realpath=!!options.realpath,self.realpathCache=options.realpathCache||Object.create(null),self.follow=!!options.follow,self.dot=!!options.dot,self.mark=!!options.mark,self.nodir=!!options.nodir,self.nodir&&(self.mark=!0);self.sync=!!options.sync,self.nounique=!!options.nounique,self.nonull=!!options.nonull,self.nosort=!!options.nosort,self.nocase=!!options.nocase,self.stat=!!options.stat,self.noprocess=!!options.noprocess,self.absolute=!!options.absolute,self.maxLength=options.maxLength||1/0,self.cache=options.cache||Object.create(null),self.statCache=options.statCache||Object.create(null),self.symlinks=options.symlinks||Object.create(null),function(self,options){self.ignore=options.ignore||[],Array.isArray(self.ignore)||(self.ignore=[self.ignore]);self.ignore.length&&(self.ignore=self.ignore.map(ignoreMap))}(self,options),self.changedCwd=!1;var cwd=process.cwd();ownProp(options,"cwd")?(self.cwd=path.resolve(options.cwd),self.changedCwd=self.cwd!==cwd):self.cwd=cwd;self.root=options.root||path.resolve(self.cwd,"/"),self.root=path.resolve(self.root),"win32"===process.platform&&(self.root=self.root.replace(/\\/g,"/"));self.cwdAbs=isAbsolute(self.cwd)?self.cwd:makeAbs(self,self.cwd),"win32"===process.platform&&(self.cwdAbs=self.cwdAbs.replace(/\\/g,"/"));self.nomount=!!options.nomount,options.nonegate=!0,options.nocomment=!0,self.minimatch=new Minimatch(pattern,options),self.options=self.minimatch.options},exports.ownProp=ownProp,exports.makeAbs=makeAbs,exports.finish=function(self){for(var nou=self.nounique,all=nou?[]:Object.create(null),i=0,l=self.matches.length;i<l;i++){var matches=self.matches[i];if(matches&&0!==Object.keys(matches).length){var m=Object.keys(matches);nou?all.push.apply(all,m):m.forEach(function(m){all[m]=!0})}else if(self.nonull){var literal=self.minimatch.globSet[i];nou?all.push(literal):all[literal]=!0}}nou||(all=Object.keys(all));self.nosort||(all=all.sort(self.nocase?alphasorti:alphasort));if(self.mark){for(var i=0;i<all.length;i++)all[i]=self._mark(all[i]);self.nodir&&(all=all.filter(function(e){var notDir=!/\/$/.test(e),c=self.cache[e]||self.cache[makeAbs(self,e)];return notDir&&c&&(notDir="DIR"!==c&&!Array.isArray(c)),notDir}))}self.ignore.length&&(all=all.filter(function(m){return!isIgnored(self,m)}));self.found=all},exports.mark=function(self,p){var abs=makeAbs(self,p),c=self.cache[abs],m=p;if(c){var isDir="DIR"===c||Array.isArray(c),slash="/"===p.slice(-1);if(isDir&&!slash?m+="/":!isDir&&slash&&(m=m.slice(0,-1)),m!==p){var mabs=makeAbs(self,m);self.statCache[mabs]=self.statCache[abs],self.cache[mabs]=self.cache[abs]}}return m},exports.isIgnored=isIgnored,exports.childrenIgnored=function(self,path){return!!self.ignore.length&&self.ignore.some(function(item){return!(!item.gmatcher||!item.gmatcher.match(path))})};var path=__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/node_modules/path-browserify/index.js"),minimatch=__webpack_require__("./node_modules/minimatch/minimatch.js"),isAbsolute=__webpack_require__("./node_modules/path-is-absolute/index.js"),Minimatch=minimatch.Minimatch;function alphasorti(a,b){return a.toLowerCase().localeCompare(b.toLowerCase())}function alphasort(a,b){return a.localeCompare(b)}function ignoreMap(pattern){var gmatcher=null;if("/**"===pattern.slice(-3)){var gpattern=pattern.replace(/(\/\*\*)+$/,"");gmatcher=new Minimatch(gpattern,{dot:!0})}return{matcher:new Minimatch(pattern,{dot:!0}),gmatcher:gmatcher}}function makeAbs(self,f){var abs=f;return abs="/"===f.charAt(0)?path.join(self.root,f):isAbsolute(f)||""===f?f:self.changedCwd?path.resolve(self.cwd,f):path.resolve(f),"win32"===process.platform&&(abs=abs.replace(/\\/g,"/")),abs}function isIgnored(self,path){return!!self.ignore.length&&self.ignore.some(function(item){return item.matcher.match(path)||!(!item.gmatcher||!item.gmatcher.match(path))})}}).call(this,__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/node_modules/process/browser.js?55cf"))},"./node_modules/glob/glob.js":function(module,exports,__webpack_require__){(function(process){module.exports=glob;var fs=__webpack_require__("./lib/js/fs.js"),rp=__webpack_require__("./node_modules/fs.realpath/index.js"),minimatch=__webpack_require__("./node_modules/minimatch/minimatch.js"),inherits=(minimatch.Minimatch,__webpack_require__("./node_modules/inherits/inherits_browser.js")),EE=__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/node_modules/events/events.js").EventEmitter,path=__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/node_modules/path-browserify/index.js"),assert=__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/node_modules/assert/assert.js"),isAbsolute=__webpack_require__("./node_modules/path-is-absolute/index.js"),globSync=__webpack_require__("./node_modules/glob/sync.js"),common=__webpack_require__("./node_modules/glob/common.js"),setopts=(common.alphasort,common.alphasorti,common.setopts),ownProp=common.ownProp,inflight=__webpack_require__("./node_modules/inflight/inflight.js"),childrenIgnored=(__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/node_modules/util/util.js"),common.childrenIgnored),isIgnored=common.isIgnored,once=__webpack_require__("./node_modules/once/once.js");function glob(pattern,options,cb){if("function"==typeof options&&(cb=options,options={}),options||(options={}),options.sync){if(cb)throw new TypeError("callback provided to sync glob");return globSync(pattern,options)}return new Glob(pattern,options,cb)}glob.sync=globSync;var GlobSync=glob.GlobSync=globSync.GlobSync;function Glob(pattern,options,cb){if("function"==typeof options&&(cb=options,options=null),options&&options.sync){if(cb)throw new TypeError("callback provided to sync glob");return new GlobSync(pattern,options)}if(!(this instanceof Glob))return new Glob(pattern,options,cb);setopts(this,pattern,options),this._didRealPath=!1;var n=this.minimatch.set.length;this.matches=new Array(n),"function"==typeof cb&&(cb=once(cb),this.on("error",cb),this.on("end",function(matches){cb(null,matches)}));var self=this;if(this._processing=0,this._emitQueue=[],this._processQueue=[],this.paused=!1,this.noprocess)return this;if(0===n)return done();for(var sync=!0,i=0;i<n;i++)this._process(this.minimatch.set[i],i,!1,done);function done(){--self._processing,self._processing<=0&&(sync?process.nextTick(function(){self._finish()}):self._finish())}sync=!1}glob.glob=glob,glob.hasMagic=function(pattern,options_){var options=function(origin,add){if(null===add||"object"!=typeof add)return origin;for(var keys=Object.keys(add),i=keys.length;i--;)origin[keys[i]]=add[keys[i]];return origin}({},options_);options.noprocess=!0;var set=new Glob(pattern,options).minimatch.set;if(!pattern)return!1;if(set.length>1)return!0;for(var j=0;j<set[0].length;j++)if("string"!=typeof set[0][j])return!0;return!1},glob.Glob=Glob,inherits(Glob,EE),Glob.prototype._finish=function(){if(assert(this instanceof Glob),!this.aborted){if(this.realpath&&!this._didRealpath)return this._realpath();common.finish(this),this.emit("end",this.found)}},Glob.prototype._realpath=function(){if(!this._didRealpath){this._didRealpath=!0;var n=this.matches.length;if(0===n)return this._finish();for(var self=this,i=0;i<this.matches.length;i++)this._realpathSet(i,next)}function next(){0==--n&&self._finish()}},Glob.prototype._realpathSet=function(index,cb){var matchset=this.matches[index];if(!matchset)return cb();var found=Object.keys(matchset),self=this,n=found.length;if(0===n)return cb();var set=this.matches[index]=Object.create(null);found.forEach(function(p,i){p=self._makeAbs(p),rp.realpath(p,self.realpathCache,function(er,real){er?"stat"===er.syscall?set[p]=!0:self.emit("error",er):set[real]=!0,0==--n&&(self.matches[index]=set,cb())})})},Glob.prototype._mark=function(p){return common.mark(this,p)},Glob.prototype._makeAbs=function(f){return common.makeAbs(this,f)},Glob.prototype.abort=function(){this.aborted=!0,this.emit("abort")},Glob.prototype.pause=function(){this.paused||(this.paused=!0,this.emit("pause"))},Glob.prototype.resume=function(){if(this.paused){if(this.emit("resume"),this.paused=!1,this._emitQueue.length){var eq=this._emitQueue.slice(0);this._emitQueue.length=0;for(var i=0;i<eq.length;i++){var e=eq[i];this._emitMatch(e[0],e[1])}}if(this._processQueue.length){var pq=this._processQueue.slice(0);this._processQueue.length=0;for(i=0;i<pq.length;i++){var p=pq[i];this._processing--,this._process(p[0],p[1],p[2],p[3])}}}},Glob.prototype._process=function(pattern,index,inGlobStar,cb){if(assert(this instanceof Glob),assert("function"==typeof cb),!this.aborted)if(this._processing++,this.paused)this._processQueue.push([pattern,index,inGlobStar,cb]);else{for(var prefix,n=0;"string"==typeof pattern[n];)n++;switch(n){case pattern.length:return void this._processSimple(pattern.join("/"),index,cb);case 0:prefix=null;break;default:prefix=pattern.slice(0,n).join("/")}var read,remain=pattern.slice(n);null===prefix?read=".":isAbsolute(prefix)||isAbsolute(pattern.join("/"))?(prefix&&isAbsolute(prefix)||(prefix="/"+prefix),read=prefix):read=prefix;var abs=this._makeAbs(read);if(childrenIgnored(this,read))return cb();remain[0]===minimatch.GLOBSTAR?this._processGlobStar(prefix,read,abs,remain,index,inGlobStar,cb):this._processReaddir(prefix,read,abs,remain,index,inGlobStar,cb)}},Glob.prototype._processReaddir=function(prefix,read,abs,remain,index,inGlobStar,cb){var self=this;this._readdir(abs,inGlobStar,function(er,entries){return self._processReaddir2(prefix,read,abs,remain,index,inGlobStar,entries,cb)})},Glob.prototype._processReaddir2=function(prefix,read,abs,remain,index,inGlobStar,entries,cb){if(!entries)return cb();for(var pn=remain[0],negate=!!this.minimatch.negate,rawGlob=pn._glob,dotOk=this.dot||"."===rawGlob.charAt(0),matchedEntries=[],i=0;i<entries.length;i++){if("."!==(e=entries[i]).charAt(0)||dotOk)(negate&&!prefix?!e.match(pn):e.match(pn))&&matchedEntries.push(e)}var len=matchedEntries.length;if(0===len)return cb();if(1===remain.length&&!this.mark&&!this.stat){this.matches[index]||(this.matches[index]=Object.create(null));for(i=0;i<len;i++){var e=matchedEntries[i];prefix&&(e="/"!==prefix?prefix+"/"+e:prefix+e),"/"!==e.charAt(0)||this.nomount||(e=path.join(this.root,e)),this._emitMatch(index,e)}return cb()}remain.shift();for(i=0;i<len;i++){e=matchedEntries[i];prefix&&(e="/"!==prefix?prefix+"/"+e:prefix+e),this._process([e].concat(remain),index,inGlobStar,cb)}cb()},Glob.prototype._emitMatch=function(index,e){if(!this.aborted&&!isIgnored(this,e))if(this.paused)this._emitQueue.push([index,e]);else{var abs=isAbsolute(e)?e:this._makeAbs(e);if(this.mark&&(e=this._mark(e)),this.absolute&&(e=abs),!this.matches[index][e]){if(this.nodir){var c=this.cache[abs];if("DIR"===c||Array.isArray(c))return}this.matches[index][e]=!0;var st=this.statCache[abs];st&&this.emit("stat",e,st),this.emit("match",e)}}},Glob.prototype._readdirInGlobStar=function(abs,cb){if(!this.aborted){if(this.follow)return this._readdir(abs,!1,cb);var self=this,lstatcb=inflight("lstat\0"+abs,function(er,lstat){if(er&&"ENOENT"===er.code)return cb();var isSym=lstat&&lstat.isSymbolicLink();self.symlinks[abs]=isSym,isSym||!lstat||lstat.isDirectory()?self._readdir(abs,!1,cb):(self.cache[abs]="FILE",cb())});lstatcb&&fs.lstat(abs,lstatcb)}},Glob.prototype._readdir=function(abs,inGlobStar,cb){if(!this.aborted&&(cb=inflight("readdir\0"+abs+"\0"+inGlobStar,cb))){if(inGlobStar&&!ownProp(this.symlinks,abs))return this._readdirInGlobStar(abs,cb);if(ownProp(this.cache,abs)){var c=this.cache[abs];if(!c||"FILE"===c)return cb();if(Array.isArray(c))return cb(null,c)}fs.readdir(abs,function(self,abs,cb){return function(er,entries){er?self._readdirError(abs,er,cb):self._readdirEntries(abs,entries,cb)}}(this,abs,cb))}},Glob.prototype._readdirEntries=function(abs,entries,cb){if(!this.aborted){if(!this.mark&&!this.stat)for(var i=0;i<entries.length;i++){var e=entries[i];e="/"===abs?abs+e:abs+"/"+e,this.cache[e]=!0}return this.cache[abs]=entries,cb(null,entries)}},Glob.prototype._readdirError=function(f,er,cb){if(!this.aborted){switch(er.code){case"ENOTSUP":case"ENOTDIR":var abs=this._makeAbs(f);if(this.cache[abs]="FILE",abs===this.cwdAbs){var error=new Error(er.code+" invalid cwd "+this.cwd);error.path=this.cwd,error.code=er.code,this.emit("error",error),this.abort()}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(f)]=!1;break;default:this.cache[this._makeAbs(f)]=!1,this.strict&&(this.emit("error",er),this.abort()),this.silent||console.error("glob error",er)}return cb()}},Glob.prototype._processGlobStar=function(prefix,read,abs,remain,index,inGlobStar,cb){var self=this;this._readdir(abs,inGlobStar,function(er,entries){self._processGlobStar2(prefix,read,abs,remain,index,inGlobStar,entries,cb)})},Glob.prototype._processGlobStar2=function(prefix,read,abs,remain,index,inGlobStar,entries,cb){if(!entries)return cb();var remainWithoutGlobStar=remain.slice(1),gspref=prefix?[prefix]:[],noGlobStar=gspref.concat(remainWithoutGlobStar);this._process(noGlobStar,index,!1,cb);var isSym=this.symlinks[abs],len=entries.length;if(isSym&&inGlobStar)return cb();for(var i=0;i<len;i++){if("."!==entries[i].charAt(0)||this.dot){var instead=gspref.concat(entries[i],remainWithoutGlobStar);this._process(instead,index,!0,cb);var below=gspref.concat(entries[i],remain);this._process(below,index,!0,cb)}}cb()},Glob.prototype._processSimple=function(prefix,index,cb){var self=this;this._stat(prefix,function(er,exists){self._processSimple2(prefix,index,er,exists,cb)})},Glob.prototype._processSimple2=function(prefix,index,er,exists,cb){if(this.matches[index]||(this.matches[index]=Object.create(null)),!exists)return cb();if(prefix&&isAbsolute(prefix)&&!this.nomount){var trail=/[\/\\]$/.test(prefix);"/"===prefix.charAt(0)?prefix=path.join(this.root,prefix):(prefix=path.resolve(this.root,prefix),trail&&(prefix+="/"))}"win32"===process.platform&&(prefix=prefix.replace(/\\/g,"/")),this._emitMatch(index,prefix),cb()},Glob.prototype._stat=function(f,cb){var abs=this._makeAbs(f),needDir="/"===f.slice(-1);if(f.length>this.maxLength)return cb();if(!this.stat&&ownProp(this.cache,abs)){var c=this.cache[abs];if(Array.isArray(c)&&(c="DIR"),!needDir||"DIR"===c)return cb(null,c);if(needDir&&"FILE"===c)return cb()}var stat=this.statCache[abs];if(void 0!==stat){if(!1===stat)return cb(null,stat);var type=stat.isDirectory()?"DIR":"FILE";return needDir&&"FILE"===type?cb():cb(null,type,stat)}var self=this,statcb=inflight("stat\0"+abs,function(er,lstat){if(lstat&&lstat.isSymbolicLink())return fs.stat(abs,function(er,stat){er?self._stat2(f,abs,null,lstat,cb):self._stat2(f,abs,er,stat,cb)});self._stat2(f,abs,er,lstat,cb)});statcb&&fs.lstat(abs,statcb)},Glob.prototype._stat2=function(f,abs,er,stat,cb){if(er&&("ENOENT"===er.code||"ENOTDIR"===er.code))return this.statCache[abs]=!1,cb();var needDir="/"===f.slice(-1);if(this.statCache[abs]=stat,"/"===abs.slice(-1)&&stat&&!stat.isDirectory())return cb(null,!1,stat);var c=!0;return stat&&(c=stat.isDirectory()?"DIR":"FILE"),this.cache[abs]=this.cache[abs]||c,needDir&&"FILE"===c?cb():cb(null,c,stat)}}).call(this,__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/node_modules/process/browser.js?55cf"))},"./node_modules/glob/sync.js":function(module,exports,__webpack_require__){(function(process){module.exports=globSync,globSync.GlobSync=GlobSync;var fs=__webpack_require__("./lib/js/fs.js"),rp=__webpack_require__("./node_modules/fs.realpath/index.js"),minimatch=__webpack_require__("./node_modules/minimatch/minimatch.js"),path=(minimatch.Minimatch,__webpack_require__("./node_modules/glob/glob.js").Glob,__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/node_modules/util/util.js"),__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/node_modules/path-browserify/index.js")),assert=__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/node_modules/assert/assert.js"),isAbsolute=__webpack_require__("./node_modules/path-is-absolute/index.js"),common=__webpack_require__("./node_modules/glob/common.js"),setopts=(common.alphasort,common.alphasorti,common.setopts),ownProp=common.ownProp,childrenIgnored=common.childrenIgnored,isIgnored=common.isIgnored;function globSync(pattern,options){if("function"==typeof options||3===arguments.length)throw new TypeError("callback provided to sync glob\nSee: https://github.com/isaacs/node-glob/issues/167");return new GlobSync(pattern,options).found}function GlobSync(pattern,options){if(!pattern)throw new Error("must provide pattern");if("function"==typeof options||3===arguments.length)throw new TypeError("callback provided to sync glob\nSee: https://github.com/isaacs/node-glob/issues/167");if(!(this instanceof GlobSync))return new GlobSync(pattern,options);if(setopts(this,pattern,options),this.noprocess)return this;var n=this.minimatch.set.length;this.matches=new Array(n);for(var i=0;i<n;i++)this._process(this.minimatch.set[i],i,!1);this._finish()}GlobSync.prototype._finish=function(){if(assert(this instanceof GlobSync),this.realpath){var self=this;this.matches.forEach(function(matchset,index){var set=self.matches[index]=Object.create(null);for(var p in matchset)try{p=self._makeAbs(p),set[rp.realpathSync(p,self.realpathCache)]=!0}catch(er){if("stat"!==er.syscall)throw er;set[self._makeAbs(p)]=!0}})}common.finish(this)},GlobSync.prototype._process=function(pattern,index,inGlobStar){assert(this instanceof GlobSync);for(var prefix,n=0;"string"==typeof pattern[n];)n++;switch(n){case pattern.length:return void this._processSimple(pattern.join("/"),index);case 0:prefix=null;break;default:prefix=pattern.slice(0,n).join("/")}var read,remain=pattern.slice(n);null===prefix?read=".":isAbsolute(prefix)||isAbsolute(pattern.join("/"))?(prefix&&isAbsolute(prefix)||(prefix="/"+prefix),read=prefix):read=prefix;var abs=this._makeAbs(read);childrenIgnored(this,read)||(remain[0]===minimatch.GLOBSTAR?this._processGlobStar(prefix,read,abs,remain,index,inGlobStar):this._processReaddir(prefix,read,abs,remain,index,inGlobStar))},GlobSync.prototype._processReaddir=function(prefix,read,abs,remain,index,inGlobStar){var entries=this._readdir(abs,inGlobStar);if(entries){for(var pn=remain[0],negate=!!this.minimatch.negate,rawGlob=pn._glob,dotOk=this.dot||"."===rawGlob.charAt(0),matchedEntries=[],i=0;i<entries.length;i++){if("."!==(e=entries[i]).charAt(0)||dotOk)(negate&&!prefix?!e.match(pn):e.match(pn))&&matchedEntries.push(e)}var len=matchedEntries.length;if(0!==len)if(1!==remain.length||this.mark||this.stat){remain.shift();for(i=0;i<len;i++){var newPattern;e=matchedEntries[i];newPattern=prefix?[prefix,e]:[e],this._process(newPattern.concat(remain),index,inGlobStar)}}else{this.matches[index]||(this.matches[index]=Object.create(null));for(var i=0;i<len;i++){var e=matchedEntries[i];prefix&&(e="/"!==prefix.slice(-1)?prefix+"/"+e:prefix+e),"/"!==e.charAt(0)||this.nomount||(e=path.join(this.root,e)),this._emitMatch(index,e)}}}},GlobSync.prototype._emitMatch=function(index,e){if(!isIgnored(this,e)){var abs=this._makeAbs(e);if(this.mark&&(e=this._mark(e)),this.absolute&&(e=abs),!this.matches[index][e]){if(this.nodir){var c=this.cache[abs];if("DIR"===c||Array.isArray(c))return}this.matches[index][e]=!0,this.stat&&this._stat(e)}}},GlobSync.prototype._readdirInGlobStar=function(abs){if(this.follow)return this._readdir(abs,!1);var entries,lstat;try{lstat=fs.lstatSync(abs)}catch(er){if("ENOENT"===er.code)return null}var isSym=lstat&&lstat.isSymbolicLink();return this.symlinks[abs]=isSym,isSym||!lstat||lstat.isDirectory()?entries=this._readdir(abs,!1):this.cache[abs]="FILE",entries},GlobSync.prototype._readdir=function(abs,inGlobStar){if(inGlobStar&&!ownProp(this.symlinks,abs))return this._readdirInGlobStar(abs);if(ownProp(this.cache,abs)){var c=this.cache[abs];if(!c||"FILE"===c)return null;if(Array.isArray(c))return c}try{return this._readdirEntries(abs,fs.readdirSync(abs))}catch(er){return this._readdirError(abs,er),null}},GlobSync.prototype._readdirEntries=function(abs,entries){if(!this.mark&&!this.stat)for(var i=0;i<entries.length;i++){var e=entries[i];e="/"===abs?abs+e:abs+"/"+e,this.cache[e]=!0}return this.cache[abs]=entries,entries},GlobSync.prototype._readdirError=function(f,er){switch(er.code){case"ENOTSUP":case"ENOTDIR":var abs=this._makeAbs(f);if(this.cache[abs]="FILE",abs===this.cwdAbs){var error=new Error(er.code+" invalid cwd "+this.cwd);throw error.path=this.cwd,error.code=er.code,error}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(f)]=!1;break;default:if(this.cache[this._makeAbs(f)]=!1,this.strict)throw er;this.silent||console.error("glob error",er)}},GlobSync.prototype._processGlobStar=function(prefix,read,abs,remain,index,inGlobStar){var entries=this._readdir(abs,inGlobStar);if(entries){var remainWithoutGlobStar=remain.slice(1),gspref=prefix?[prefix]:[],noGlobStar=gspref.concat(remainWithoutGlobStar);this._process(noGlobStar,index,!1);var len=entries.length;if(!this.symlinks[abs]||!inGlobStar)for(var i=0;i<len;i++){if("."!==entries[i].charAt(0)||this.dot){var instead=gspref.concat(entries[i],remainWithoutGlobStar);this._process(instead,index,!0);var below=gspref.concat(entries[i],remain);this._process(below,index,!0)}}}},GlobSync.prototype._processSimple=function(prefix,index){var exists=this._stat(prefix);if(this.matches[index]||(this.matches[index]=Object.create(null)),exists){if(prefix&&isAbsolute(prefix)&&!this.nomount){var trail=/[\/\\]$/.test(prefix);"/"===prefix.charAt(0)?prefix=path.join(this.root,prefix):(prefix=path.resolve(this.root,prefix),trail&&(prefix+="/"))}"win32"===process.platform&&(prefix=prefix.replace(/\\/g,"/")),this._emitMatch(index,prefix)}},GlobSync.prototype._stat=function(f){var abs=this._makeAbs(f),needDir="/"===f.slice(-1);if(f.length>this.maxLength)return!1;if(!this.stat&&ownProp(this.cache,abs)){var c=this.cache[abs];if(Array.isArray(c)&&(c="DIR"),!needDir||"DIR"===c)return c;if(needDir&&"FILE"===c)return!1}var stat=this.statCache[abs];if(!stat){var lstat;try{lstat=fs.lstatSync(abs)}catch(er){if(er&&("ENOENT"===er.code||"ENOTDIR"===er.code))return this.statCache[abs]=!1,!1}if(lstat&&lstat.isSymbolicLink())try{stat=fs.statSync(abs)}catch(er){stat=lstat}else stat=lstat}this.statCache[abs]=stat;c=!0;return stat&&(c=stat.isDirectory()?"DIR":"FILE"),this.cache[abs]=this.cache[abs]||c,(!needDir||"FILE"!==c)&&c},GlobSync.prototype._mark=function(p){return common.mark(this,p)},GlobSync.prototype._makeAbs=function(f){return common.makeAbs(this,f)}}).call(this,__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/node_modules/process/browser.js?55cf"))},"./node_modules/idb-keyval/dist/idb-keyval.mjs":function(__webpack_module__,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"Store",function(){return Store}),__webpack_require__.d(__webpack_exports__,"get",function(){return get}),__webpack_require__.d(__webpack_exports__,"set",function(){return set}),__webpack_require__.d(__webpack_exports__,"del",function(){return del}),__webpack_require__.d(__webpack_exports__,"clear",function(){return clear}),__webpack_require__.d(__webpack_exports__,"keys",function(){return keys});class Store{constructor(dbName="keyval-store",storeName="keyval"){this.storeName=storeName,this._dbp=new Promise((resolve,reject)=>{const openreq=indexedDB.open(dbName,1);openreq.onerror=(()=>reject(openreq.error)),openreq.onsuccess=(()=>resolve(openreq.result)),openreq.onupgradeneeded=(()=>{openreq.result.createObjectStore(storeName)})})}_withIDBStore(type,callback){return this._dbp.then(db=>new Promise((resolve,reject)=>{const transaction=db.transaction(this.storeName,type);transaction.oncomplete=(()=>resolve()),transaction.onabort=transaction.onerror=(()=>reject(transaction.error)),callback(transaction.objectStore(this.storeName))}))}}let store;function getDefaultStore(){return store||(store=new Store),store}function get(key,store=getDefaultStore()){let req;return store._withIDBStore("readonly",store=>{req=store.get(key)}).then(()=>req.result)}function set(key,value,store=getDefaultStore()){return store._withIDBStore("readwrite",store=>{store.put(value,key)})}function del(key,store=getDefaultStore()){return store._withIDBStore("readwrite",store=>{store.delete(key)})}function clear(store=getDefaultStore()){return store._withIDBStore("readwrite",store=>{store.clear()})}function keys(store=getDefaultStore()){const keys=[];return store._withIDBStore("readonly",store=>{(store.openKeyCursor||store.openCursor).call(store).onsuccess=function(){this.result&&(keys.push(this.result.key),this.result.continue())}}).then(()=>keys)}},"./node_modules/ieee754/index.js":function(module,exports){exports.read=function(buffer,offset,isLE,mLen,nBytes){var e,m,eLen=8*nBytes-mLen-1,eMax=(1<<eLen)-1,eBias=eMax>>1,nBits=-7,i=isLE?nBytes-1:0,d=isLE?-1:1,s=buffer[offset+i];for(i+=d,e=s&(1<<-nBits)-1,s>>=-nBits,nBits+=eLen;nBits>0;e=256*e+buffer[offset+i],i+=d,nBits-=8);for(m=e&(1<<-nBits)-1,e>>=-nBits,nBits+=mLen;nBits>0;m=256*m+buffer[offset+i],i+=d,nBits-=8);if(0===e)e=1-eBias;else{if(e===eMax)return m?NaN:1/0*(s?-1:1);m+=Math.pow(2,mLen),e-=eBias}return(s?-1:1)*m*Math.pow(2,e-mLen)},exports.write=function(buffer,value,offset,isLE,mLen,nBytes){var e,m,c,eLen=8*nBytes-mLen-1,eMax=(1<<eLen)-1,eBias=eMax>>1,rt=23===mLen?Math.pow(2,-24)-Math.pow(2,-77):0,i=isLE?0:nBytes-1,d=isLE?1:-1,s=value<0||0===value&&1/value<0?1:0;for(value=Math.abs(value),isNaN(value)||value===1/0?(m=isNaN(value)?1:0,e=eMax):(e=Math.floor(Math.log(value)/Math.LN2),value*(c=Math.pow(2,-e))<1&&(e--,c*=2),(value+=e+eBias>=1?rt/c:rt*Math.pow(2,1-eBias))*c>=2&&(e++,c/=2),e+eBias>=eMax?(m=0,e=eMax):e+eBias>=1?(m=(value*c-1)*Math.pow(2,mLen),e+=eBias):(m=value*Math.pow(2,eBias-1)*Math.pow(2,mLen),e=0));mLen>=8;buffer[offset+i]=255&m,i+=d,m/=256,mLen-=8);for(e=e<<mLen|m,eLen+=mLen;eLen>0;buffer[offset+i]=255&e,i+=d,e/=256,eLen-=8);buffer[offset+i-d]|=128*s}},"./node_modules/inflight/inflight.js":function(module,exports,__webpack_require__){(function(process){var wrappy=__webpack_require__("./node_modules/wrappy/wrappy.js"),reqs=Object.create(null),once=__webpack_require__("./node_modules/once/once.js");module.exports=wrappy(function(key,cb){return reqs[key]?(reqs[key].push(cb),null):(reqs[key]=[cb],function(key){return once(function RES(){var cbs=reqs[key],len=cbs.length,args=function(args){for(var length=args.length,array=[],i=0;i<length;i++)array[i]=args[i];return array}(arguments);try{for(var i=0;i<len;i++)cbs[i].apply(null,args)}finally{cbs.length>len?(cbs.splice(0,len),process.nextTick(function(){RES.apply(null,args)})):delete reqs[key]}})}(key))})}).call(this,__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/node_modules/process/browser.js?55cf"))},"./node_modules/inherits/inherits_browser.js":function(module,exports){"function"==typeof Object.create?module.exports=function(ctor,superCtor){ctor.super_=superCtor,ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:!1,writable:!0,configurable:!0}})}:module.exports=function(ctor,superCtor){ctor.super_=superCtor;var TempCtor=function(){};TempCtor.prototype=superCtor.prototype,ctor.prototype=new TempCtor,ctor.prototype.constructor=ctor}},"./node_modules/iobuffer/IOBuffer.js":function(module,exports,__webpack_require__){"use strict";(function(Buffer){const utf8=__webpack_require__("./node_modules/utf8/utf8.js"),defaultByteLength=8192,charArray=[];module.exports=class{constructor(data,options){options=options||{};var dataIsGiven=!1;void 0===data&&(data=defaultByteLength),"number"==typeof data?data=new ArrayBuffer(data):(dataIsGiven=!0,this._lastWrittenByte=data.byteLength);const offset=options.offset?options.offset>>>0:0;let byteLength=data.byteLength-offset,dvOffset=offset;data.buffer&&(data.byteLength!==data.buffer.byteLength&&(dvOffset=data.byteOffset+offset),data=data.buffer),this._lastWrittenByte=dataIsGiven?byteLength:0,this.buffer=data,this.length=byteLength,this.byteLength=byteLength,this.byteOffset=dvOffset,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,dvOffset,byteLength),this._mark=0,this._marks=[]}available(byteLength){return void 0===byteLength&&(byteLength=1),this.offset+byteLength<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(n){return void 0===n&&(n=1),this.offset+=n,this}seek(offset){return this.offset=offset,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const offset=this._marks.pop();if(void 0===offset)throw new Error("Mark stack empty");return this.seek(offset),this}rewind(){return this.offset=0,this}ensureAvailable(byteLength){if(void 0===byteLength&&(byteLength=1),!this.available(byteLength)){const newLength=2*(this.offset+byteLength),newArray=new Uint8Array(newLength);newArray.set(new Uint8Array(this.buffer)),this.buffer=newArray.buffer,this.length=this.byteLength=newLength,this._data=new DataView(this.buffer)}return this}readBoolean(){return 0!==this.readUint8()}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(n){void 0===n&&(n=1);for(var bytes=new Uint8Array(n),i=0;i<n;i++)bytes[i]=this.readByte();return bytes}readInt16(){var value=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,value}readUint16(){var value=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,value}readInt32(){var value=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,value}readUint32(){var value=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,value}readFloat32(){var value=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,value}readFloat64(){var value=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,value}readChar(){return String.fromCharCode(this.readInt8())}readChars(n){void 0===n&&(n=1),charArray.length=n;for(var i=0;i<n;i++)charArray[i]=this.readChar();return charArray.join("")}readUtf8(n){void 0===n&&(n=1);const bString=this.readChars(n);return utf8.decode(bString)}writeBoolean(value){return this.writeUint8(value?255:0),this}writeInt8(value){return this.ensureAvailable(1),this._data.setInt8(this.offset++,value),this._updateLastWrittenByte(),this}writeUint8(value){return this.ensureAvailable(1),this._data.setUint8(this.offset++,value),this._updateLastWrittenByte(),this}writeByte(value){return this.writeUint8(value)}writeBytes(bytes){this.ensureAvailable(bytes.length);for(var i=0;i<bytes.length;i++)this._data.setUint8(this.offset++,bytes[i]);return this._updateLastWrittenByte(),this}writeInt16(value){return this.ensureAvailable(2),this._data.setInt16(this.offset,value,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(value){return this.ensureAvailable(2),this._data.setUint16(this.offset,value,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(value){return this.ensureAvailable(4),this._data.setInt32(this.offset,value,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(value){return this.ensureAvailable(4),this._data.setUint32(this.offset,value,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(value){return this.ensureAvailable(4),this._data.setFloat32(this.offset,value,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(value){return this.ensureAvailable(8),this._data.setFloat64(this.offset,value,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(str){return this.writeUint8(str.charCodeAt(0))}writeChars(str){for(var i=0;i<str.length;i++)this.writeUint8(str.charCodeAt(i));return this}writeUtf8(str){const bString=utf8.encode(str);return this.writeChars(bString)}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this._lastWrittenByte)}getBuffer(){return void 0!==Buffer?Buffer.from(this.toArray()):this.toArray()}_updateLastWrittenByte(){this.offset>this._lastWrittenByte&&(this._lastWrittenByte=this.offset)}}}).call(this,__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/node_modules/buffer/index.js?c412").Buffer)},"./node_modules/isarray/index.js":function(module,exports){var toString={}.toString;module.exports=Array.isArray||function(arr){return"[object Array]"==toString.call(arr)}},"./node_modules/jstree/dist/jstree.js":function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;!function(factory){"use strict";__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__("jquery")],void 0===(__WEBPACK_AMD_DEFINE_RESULT__="function"==typeof(__WEBPACK_AMD_DEFINE_FACTORY__=function($,undefined){if($.jstree)return;var instance_counter=0,ccp_node=!1,ccp_mode=!1,ccp_inst=!1,themes_loaded=[],src=$("script:last").attr("src"),document=window.document;$.jstree={version:"3.3.7",defaults:{plugins:[]},plugins:{},path:src&&-1!==src.indexOf("/")?src.replace(/\/[^\/]+$/,""):"",idregex:/[\\:&!^|()\[\]<>@*'+~#";.,=\- \/${}%?`]/g,root:"#"},$.jstree.create=function(el,options){var tmp=new $.jstree.core(++instance_counter),opt=options;return options=$.extend(!0,{},$.jstree.defaults,options),opt&&opt.plugins&&(options.plugins=opt.plugins),$.each(options.plugins,function(i,k){"core"!==i&&(tmp=tmp.plugin(k,options[k]))}),$(el).data("jstree",tmp),tmp.init(el,options),tmp},$.jstree.destroy=function(){$(".jstree:jstree").jstree("destroy"),$(document).off(".jstree")},$.jstree.core=function(id){this._id=id,this._cnt=0,this._wrk=null,this._data={core:{themes:{name:!1,dots:!1,icons:!1,ellipsis:!1},selected:[],last_error:{},working:!1,worker_queue:[],focused:null}}},$.jstree.reference=function(needle){var tmp=null,obj=null;if(!needle||!needle.id||needle.tagName&&needle.nodeType||(needle=needle.id),!obj||!obj.length)try{obj=$(needle)}catch(ignore){}if(!obj||!obj.length)try{obj=$("#"+needle.replace($.jstree.idregex,"\\$&"))}catch(ignore){}return obj&&obj.length&&(obj=obj.closest(".jstree")).length&&(obj=obj.data("jstree"))?tmp=obj:$(".jstree").each(function(){var inst=$(this).data("jstree");if(inst&&inst._model.data[needle])return tmp=inst,!1}),tmp},$.fn.jstree=function(arg){var is_method="string"==typeof arg,args=Array.prototype.slice.call(arguments,1),result=null;return!(!0===arg&&!this.length)&&(this.each(function(){var instance=$.jstree.reference(this),method=is_method&&instance?instance[arg]:null;if(result=is_method&&method?method.apply(instance,args):null,instance||is_method||arg!==undefined&&!$.isPlainObject(arg)||$.jstree.create(this,arg),(instance&&!is_method||!0===arg)&&(result=instance||!1),null!==result&&result!==undefined)return!1}),null!==result&&result!==undefined?result:this)},$.expr.pseudos.jstree=$.expr.createPseudo(function(search){return function(a){return $(a).hasClass("jstree")&&$(a).data("jstree")!==undefined}}),$.jstree.defaults.core={data:!1,strings:!1,check_callback:!1,error:$.noop,animation:200,multiple:!0,themes:{name:!1,url:!1,dir:!1,dots:!0,icons:!0,ellipsis:!1,stripes:!1,variant:!1,responsive:!1},expand_selected_onload:!0,worker:!0,force_text:!1,dblclick_toggle:!0,loaded_state:!1,restore_focus:!0,keyboard:{"ctrl-space":function(e){e.type="click",$(e.currentTarget).trigger(e)},enter:function(e){e.type="click",$(e.currentTarget).trigger(e)},left:function(e){if(e.preventDefault(),this.is_open(e.currentTarget))this.close_node(e.currentTarget);else{var o=this.get_parent(e.currentTarget);o&&o.id!==$.jstree.root&&this.get_node(o,!0).children(".jstree-anchor").focus()}},up:function(e){e.preventDefault();var o=this.get_prev_dom(e.currentTarget);o&&o.length&&o.children(".jstree-anchor").focus()},right:function(e){if(e.preventDefault(),this.is_closed(e.currentTarget))this.open_node(e.currentTarget,function(o){this.get_node(o,!0).children(".jstree-anchor").focus()});else if(this.is_open(e.currentTarget)){var o=this.get_node(e.currentTarget,!0).children(".jstree-children")[0];o&&$(this._firstChild(o)).children(".jstree-anchor").focus()}},down:function(e){e.preventDefault();var o=this.get_next_dom(e.currentTarget);o&&o.length&&o.children(".jstree-anchor").focus()},"*":function(e){this.open_all()},home:function(e){e.preventDefault();var o=this._firstChild(this.get_container_ul()[0]);o&&$(o).children(".jstree-anchor").filter(":visible").focus()},end:function(e){e.preventDefault(),this.element.find(".jstree-anchor").filter(":visible").last().focus()},f2:function(e){e.preventDefault(),this.edit(e.currentTarget)}}},$.jstree.core.prototype={plugin:function(deco,opts){var Child=$.jstree.plugins[deco];return Child?(this._data[deco]={},Child.prototype=this,new Child(opts,this)):this},init:function(el,options){this._model={data:{},changed:[],force_full_redraw:!1,redraw_timeout:!1,default_state:{loaded:!0,opened:!1,selected:!1,disabled:!1}},this._model.data[$.jstree.root]={id:$.jstree.root,parent:null,parents:[],children:[],children_d:[],state:{loaded:!1}},this.element=$(el).addClass("jstree jstree-"+this._id),this.settings=options,this._data.core.ready=!1,this._data.core.loaded=!1,this._data.core.rtl="rtl"===this.element.css("direction"),this.element[this._data.core.rtl?"addClass":"removeClass"]("jstree-rtl"),this.element.attr("role","tree"),this.settings.core.multiple&&this.element.attr("aria-multiselectable",!0),this.element.attr("tabindex")||this.element.attr("tabindex","0"),this.bind(),this.trigger("init"),this._data.core.original_container_html=this.element.find(" > ul > li").clone(!0),this._data.core.original_container_html.find("li").addBack().contents().filter(function(){return 3===this.nodeType&&(!this.nodeValue||/^\s+$/.test(this.nodeValue))}).remove(),this.element.html("<ul class='jstree-container-ul jstree-children' role='group'><li id='j"+this._id+"_loading' class='jstree-initial-node jstree-loading jstree-leaf jstree-last' role='tree-item'><i class='jstree-icon jstree-ocl'></i><a class='jstree-anchor' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>"+this.get_string("Loading ...")+"</a></li></ul>"),this.element.attr("aria-activedescendant","j"+this._id+"_loading"),this._data.core.li_height=this.get_container_ul().children("li").first().outerHeight()||24,this._data.core.node=this._create_prototype_node(),this.trigger("loading"),this.load_node($.jstree.root)},destroy:function(keep_html){if(this.trigger("destroy"),this._wrk)try{window.URL.revokeObjectURL(this._wrk),this._wrk=null}catch(ignore){}keep_html||this.element.empty(),this.teardown()},_create_prototype_node:function(){var _temp1,_temp2,_node=document.createElement("LI");return _node.setAttribute("role","treeitem"),(_temp1=document.createElement("I")).className="jstree-icon jstree-ocl",_temp1.setAttribute("role","presentation"),_node.appendChild(_temp1),(_temp1=document.createElement("A")).className="jstree-anchor",_temp1.setAttribute("href","#"),_temp1.setAttribute("tabindex","-1"),(_temp2=document.createElement("I")).className="jstree-icon jstree-themeicon",_temp2.setAttribute("role","presentation"),_temp1.appendChild(_temp2),_node.appendChild(_temp1),_temp1=_temp2=null,_node},_kbevent_to_func:function(e){var parts=[];e.ctrlKey&&parts.push("ctrl"),e.altKey&&parts.push("alt"),e.shiftKey&&parts.push("shift"),parts.push({8:"Backspace",9:"Tab",13:"Return",19:"Pause",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"Print",45:"Insert",46:"Delete",96:"Numpad0",97:"Numpad1",98:"Numpad2",99:"Numpad3",100:"Numpad4",101:"Numpad5",102:"Numpad6",103:"Numpad7",104:"Numpad8",105:"Numpad9","-13":"NumpadEnter",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"Numlock",145:"Scrolllock",16:"Shift",17:"Ctrl",18:"Alt",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",59:";",61:"=",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",107:"+",109:"-",110:".",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",111:"/",106:"*",173:"-"}[e.which]||e.which),parts=parts.sort().join("-").toLowerCase();var i,tmp,kb=this.settings.core.keyboard;for(i in kb)if(kb.hasOwnProperty(i)&&("-"!==(tmp=i)&&"+"!==tmp&&(tmp=(tmp=tmp.replace("--","-MINUS").replace("+-","-MINUS").replace("++","-PLUS").replace("-+","-PLUS")).split(/-|\+/).sort().join("-").replace("MINUS","-").replace("PLUS","+").toLowerCase()),tmp===parts))return kb[i];return null},teardown:function(){this.unbind(),this.element.removeClass("jstree").removeData("jstree").find("[class^='jstree']").addBack().attr("class",function(){return this.className.replace(/jstree[^ ]*|$/gi,"")}),this.element=null},bind:function(){var word="",tout=null,was_click=0;this.element.on("dblclick.jstree",function(e){if(e.target.tagName&&"input"===e.target.tagName.toLowerCase())return!0;if(document.selection&&document.selection.empty)document.selection.empty();else if(window.getSelection){var sel=window.getSelection();try{sel.removeAllRanges(),sel.collapse()}catch(ignore){}}}).on("mousedown.jstree",$.proxy(function(e){e.target===this.element[0]&&(e.preventDefault(),was_click=+new Date)},this)).on("mousedown.jstree",".jstree-ocl",function(e){e.preventDefault()}).on("click.jstree",".jstree-ocl",$.proxy(function(e){this.toggle_node(e.target)},this)).on("dblclick.jstree",".jstree-anchor",$.proxy(function(e){if(e.target.tagName&&"input"===e.target.tagName.toLowerCase())return!0;this.settings.core.dblclick_toggle&&this.toggle_node(e.target)},this)).on("click.jstree",".jstree-anchor",$.proxy(function(e){e.preventDefault(),e.currentTarget!==document.activeElement&&$(e.currentTarget).focus(),this.activate_node(e.currentTarget,e)},this)).on("keydown.jstree",".jstree-anchor",$.proxy(function(e){if(e.target.tagName&&"input"===e.target.tagName.toLowerCase())return!0;this._data.core.rtl&&(37===e.which?e.which=39:39===e.which&&(e.which=37));var f=this._kbevent_to_func(e);if(f){var r=f.call(this,e);if(!1===r||!0===r)return r}},this)).on("load_node.jstree",$.proxy(function(e,data){data.status&&(data.node.id!==$.jstree.root||this._data.core.loaded||(this._data.core.loaded=!0,this._firstChild(this.get_container_ul()[0])&&this.element.attr("aria-activedescendant",this._firstChild(this.get_container_ul()[0]).id),this.trigger("loaded")),this._data.core.ready||setTimeout($.proxy(function(){if(this.element&&!this.get_container_ul().find(".jstree-loading").length){if(this._data.core.ready=!0,this._data.core.selected.length){if(this.settings.core.expand_selected_onload){var i,j,tmp=[];for(i=0,j=this._data.core.selected.length;i<j;i++)tmp=tmp.concat(this._model.data[this._data.core.selected[i]].parents);for(tmp=$.vakata.array_unique(tmp),i=0,j=tmp.length;i<j;i++)this.open_node(tmp[i],!1,0)}this.trigger("changed",{action:"ready",selected:this._data.core.selected})}this.trigger("ready")}},this),0))},this)).on("keypress.jstree",$.proxy(function(e){if(e.target.tagName&&"input"===e.target.tagName.toLowerCase())return!0;tout&&clearTimeout(tout),tout=setTimeout(function(){word=""},500);var chr=String.fromCharCode(e.which).toLowerCase(),col=this.element.find(".jstree-anchor").filter(":visible"),ind=col.index(document.activeElement)||0,end=!1;if((word+=chr).length>1){if(col.slice(ind).each($.proxy(function(i,v){if(0===$(v).text().toLowerCase().indexOf(word))return $(v).focus(),end=!0,!1},this)),end)return;if(col.slice(0,ind).each($.proxy(function(i,v){if(0===$(v).text().toLowerCase().indexOf(word))return $(v).focus(),end=!0,!1},this)),end)return}if(new RegExp("^"+chr.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")+"+$").test(word)){if(col.slice(ind+1).each($.proxy(function(i,v){if($(v).text().toLowerCase().charAt(0)===chr)return $(v).focus(),end=!0,!1},this)),end)return;if(col.slice(0,ind+1).each($.proxy(function(i,v){if($(v).text().toLowerCase().charAt(0)===chr)return $(v).focus(),end=!0,!1},this)),end)return}},this)).on("init.jstree",$.proxy(function(){var s=this.settings.core.themes;this._data.core.themes.dots=s.dots,this._data.core.themes.stripes=s.stripes,this._data.core.themes.icons=s.icons,this._data.core.themes.ellipsis=s.ellipsis,this.set_theme(s.name||"default",s.url),this.set_theme_variant(s.variant)},this)).on("loading.jstree",$.proxy(function(){this[this._data.core.themes.dots?"show_dots":"hide_dots"](),this[this._data.core.themes.icons?"show_icons":"hide_icons"](),this[this._data.core.themes.stripes?"show_stripes":"hide_stripes"](),this[this._data.core.themes.ellipsis?"show_ellipsis":"hide_ellipsis"]()},this)).on("blur.jstree",".jstree-anchor",$.proxy(function(e){this._data.core.focused=null,$(e.currentTarget).filter(".jstree-hovered").mouseleave(),this.element.attr("tabindex","0")},this)).on("focus.jstree",".jstree-anchor",$.proxy(function(e){var tmp=this.get_node(e.currentTarget);tmp&&tmp.id&&(this._data.core.focused=tmp.id),this.element.find(".jstree-hovered").not(e.currentTarget).mouseleave(),$(e.currentTarget).mouseenter(),this.element.attr("tabindex","-1")},this)).on("focus.jstree",$.proxy(function(){if(+new Date-was_click>500&&!this._data.core.focused&&this.settings.core.restore_focus){was_click=0;var act=this.get_node(this.element.attr("aria-activedescendant"),!0);act&&act.find("> .jstree-anchor").focus()}},this)).on("mouseenter.jstree",".jstree-anchor",$.proxy(function(e){this.hover_node(e.currentTarget)},this)).on("mouseleave.jstree",".jstree-anchor",$.proxy(function(e){this.dehover_node(e.currentTarget)},this))},unbind:function(){this.element.off(".jstree"),$(document).off(".jstree-"+this._id)},trigger:function(ev,data){data||(data={}),data.instance=this,this.element.triggerHandler(ev.replace(".jstree","")+".jstree",data)},get_container:function(){return this.element},get_container_ul:function(){return this.element.children(".jstree-children").first()},get_string:function(key){var a=this.settings.core.strings;return $.isFunction(a)?a.call(this,key):a&&a[key]?a[key]:key},_firstChild:function(dom){for(dom=dom?dom.firstChild:null;null!==dom&&1!==dom.nodeType;)dom=dom.nextSibling;return dom},_nextSibling:function(dom){for(dom=dom?dom.nextSibling:null;null!==dom&&1!==dom.nodeType;)dom=dom.nextSibling;return dom},_previousSibling:function(dom){for(dom=dom?dom.previousSibling:null;null!==dom&&1!==dom.nodeType;)dom=dom.previousSibling;return dom},get_node:function(obj,as_dom){var dom;obj&&obj.id&&(obj=obj.id),obj instanceof jQuery&&obj.length&&obj[0].id&&(obj=obj[0].id);try{if(this._model.data[obj])obj=this._model.data[obj];else if("string"==typeof obj&&this._model.data[obj.replace(/^#/,"")])obj=this._model.data[obj.replace(/^#/,"")];else if("string"==typeof obj&&(dom=$("#"+obj.replace($.jstree.idregex,"\\$&"),this.element)).length&&this._model.data[dom.closest(".jstree-node").attr("id")])obj=this._model.data[dom.closest(".jstree-node").attr("id")];else if((dom=this.element.find(obj)).length&&this._model.data[dom.closest(".jstree-node").attr("id")])obj=this._model.data[dom.closest(".jstree-node").attr("id")];else{if(!(dom=this.element.find(obj)).length||!dom.hasClass("jstree"))return!1;obj=this._model.data[$.jstree.root]}return as_dom&&(obj=obj.id===$.jstree.root?this.element:$("#"+obj.id.replace($.jstree.idregex,"\\$&"),this.element)),obj}catch(ex){return!1}},get_path:function(obj,glue,ids){if(!(obj=obj.parents?obj:this.get_node(obj))||obj.id===$.jstree.root||!obj.parents)return!1;var i,j,p=[];for(p.push(ids?obj.id:obj.text),i=0,j=obj.parents.length;i<j;i++)p.push(ids?obj.parents[i]:this.get_text(obj.parents[i]));return p=p.reverse().slice(1),glue?p.join(glue):p},get_next_dom:function(obj,strict){var tmp;if((obj=this.get_node(obj,!0))[0]===this.element[0]){for(tmp=this._firstChild(this.get_container_ul()[0]);tmp&&0===tmp.offsetHeight;)tmp=this._nextSibling(tmp);return!!tmp&&$(tmp)}if(!obj||!obj.length)return!1;if(strict){tmp=obj[0];do{tmp=this._nextSibling(tmp)}while(tmp&&0===tmp.offsetHeight);return!!tmp&&$(tmp)}if(obj.hasClass("jstree-open")){for(tmp=this._firstChild(obj.children(".jstree-children")[0]);tmp&&0===tmp.offsetHeight;)tmp=this._nextSibling(tmp);if(null!==tmp)return $(tmp)}tmp=obj[0];do{tmp=this._nextSibling(tmp)}while(tmp&&0===tmp.offsetHeight);return null!==tmp?$(tmp):obj.parentsUntil(".jstree",".jstree-node").nextAll(".jstree-node:visible").first()},get_prev_dom:function(obj,strict){var tmp;if((obj=this.get_node(obj,!0))[0]===this.element[0]){for(tmp=this.get_container_ul()[0].lastChild;tmp&&0===tmp.offsetHeight;)tmp=this._previousSibling(tmp);return!!tmp&&$(tmp)}if(!obj||!obj.length)return!1;if(strict){tmp=obj[0];do{tmp=this._previousSibling(tmp)}while(tmp&&0===tmp.offsetHeight);return!!tmp&&$(tmp)}tmp=obj[0];do{tmp=this._previousSibling(tmp)}while(tmp&&0===tmp.offsetHeight);if(null!==tmp){for(obj=$(tmp);obj.hasClass("jstree-open");)obj=obj.children(".jstree-children").first().children(".jstree-node:visible:last");return obj}return!(!(tmp=obj[0].parentNode.parentNode)||!tmp.className||-1===tmp.className.indexOf("jstree-node"))&&$(tmp)},get_parent:function(obj){return!(!(obj=this.get_node(obj))||obj.id===$.jstree.root)&&obj.parent},get_children_dom:function(obj){return(obj=this.get_node(obj,!0))[0]===this.element[0]?this.get_container_ul().children(".jstree-node"):!(!obj||!obj.length)&&obj.children(".jstree-children").children(".jstree-node")},is_parent:function(obj){return(obj=this.get_node(obj))&&(!1===obj.state.loaded||obj.children.length>0)},is_loaded:function(obj){return(obj=this.get_node(obj))&&obj.state.loaded},is_loading:function(obj){return(obj=this.get_node(obj))&&obj.state&&obj.state.loading},is_open:function(obj){return(obj=this.get_node(obj))&&obj.state.opened},is_closed:function(obj){return(obj=this.get_node(obj))&&this.is_parent(obj)&&!obj.state.opened},is_leaf:function(obj){return!this.is_parent(obj)},load_node:function(obj,callback){var k,l,i,j,c;if($.isArray(obj))return this._load_nodes(obj.slice(),callback),!0;if(!(obj=this.get_node(obj)))return callback&&callback.call(this,obj,!1),!1;if(obj.state.loaded){for(obj.state.loaded=!1,i=0,j=obj.parents.length;i<j;i++)this._model.data[obj.parents[i]].children_d=$.vakata.array_filter(this._model.data[obj.parents[i]].children_d,function(v){return-1===$.inArray(v,obj.children_d)});for(k=0,l=obj.children_d.length;k<l;k++)this._model.data[obj.children_d[k]].state.selected&&(c=!0),delete this._model.data[obj.children_d[k]];c&&(this._data.core.selected=$.vakata.array_filter(this._data.core.selected,function(v){return-1===$.inArray(v,obj.children_d)})),obj.children=[],obj.children_d=[],c&&this.trigger("changed",{action:"load_node",node:obj,selected:this._data.core.selected})}return obj.state.failed=!1,obj.state.loading=!0,this.get_node(obj,!0).addClass("jstree-loading").attr("aria-busy",!0),this._load_node(obj,$.proxy(function(status){(obj=this._model.data[obj.id]).state.loading=!1,obj.state.loaded=status,obj.state.failed=!obj.state.loaded;var dom=this.get_node(obj,!0),i=0,j=0,m=this._model.data,has_children=!1;for(i=0,j=obj.children.length;i<j;i++)if(m[obj.children[i]]&&!m[obj.children[i]].state.hidden){has_children=!0;break}obj.state.loaded&&dom&&dom.length&&(dom.removeClass("jstree-closed jstree-open jstree-leaf"),has_children?"#"!==obj.id&&dom.addClass(obj.state.opened?"jstree-open":"jstree-closed"):dom.addClass("jstree-leaf")),dom.removeClass("jstree-loading").attr("aria-busy",!1),this.trigger("load_node",{node:obj,status:status}),callback&&callback.call(this,obj,status)},this)),!0},_load_nodes:function(nodes,callback,is_callback,force_reload){var i,j,r=!0,c=function(){this._load_nodes(nodes,callback,!0)},m=this._model.data,tmp=[];for(i=0,j=nodes.length;i<j;i++)m[nodes[i]]&&(!m[nodes[i]].state.loaded&&!m[nodes[i]].state.failed||!is_callback&&force_reload)&&(this.is_loading(nodes[i])||this.load_node(nodes[i],c),r=!1);if(r){for(i=0,j=nodes.length;i<j;i++)m[nodes[i]]&&m[nodes[i]].state.loaded&&tmp.push(nodes[i]);callback&&!callback.done&&(callback.call(this,tmp),callback.done=!0)}},load_all:function(obj,callback){if(obj||(obj=$.jstree.root),!(obj=this.get_node(obj)))return!1;var i,j,to_load=[],m=this._model.data,c=m[obj.id].children_d;for(obj.state&&!obj.state.loaded&&to_load.push(obj.id),i=0,j=c.length;i<j;i++)m[c[i]]&&m[c[i]].state&&!m[c[i]].state.loaded&&to_load.push(c[i]);to_load.length?this._load_nodes(to_load,function(){this.load_all(obj,callback)}):(callback&&callback.call(this,obj),this.trigger("load_all",{node:obj}))},_load_node:function(obj,callback){var t,s=this.settings.core.data,notTextOrCommentNode=function(){return 3!==this.nodeType&&8!==this.nodeType};return s?$.isFunction(s)?s.call(this,obj,$.proxy(function(d){!1===d?callback.call(this,!1):this["string"==typeof d?"_append_html_data":"_append_json_data"](obj,"string"==typeof d?$($.parseHTML(d)).filter(notTextOrCommentNode):d,function(status){callback.call(this,status)})},this)):"object"==typeof s?s.url?(s=$.extend(!0,{},s),$.isFunction(s.url)&&(s.url=s.url.call(this,obj)),$.isFunction(s.data)&&(s.data=s.data.call(this,obj)),$.ajax(s).done($.proxy(function(d,t,x){var type=x.getResponseHeader("Content-Type");return type&&-1!==type.indexOf("json")||"object"==typeof d?this._append_json_data(obj,d,function(status){callback.call(this,status)}):type&&-1!==type.indexOf("html")||"string"==typeof d?this._append_html_data(obj,$($.parseHTML(d)).filter(notTextOrCommentNode),function(status){callback.call(this,status)}):(this._data.core.last_error={error:"ajax",plugin:"core",id:"core_04",reason:"Could not load node",data:JSON.stringify({id:obj.id,xhr:x})},this.settings.core.error.call(this,this._data.core.last_error),callback.call(this,!1))},this)).fail($.proxy(function(f){this._data.core.last_error={error:"ajax",plugin:"core",id:"core_04",reason:"Could not load node",data:JSON.stringify({id:obj.id,xhr:f})},callback.call(this,!1),this.settings.core.error.call(this,this._data.core.last_error)},this))):(t=$.isArray(s)?$.extend(!0,[],s):$.isPlainObject(s)?$.extend(!0,{},s):s,obj.id===$.jstree.root?this._append_json_data(obj,t,function(status){callback.call(this,status)}):(this._data.core.last_error={error:"nodata",plugin:"core",id:"core_05",reason:"Could not load node",data:JSON.stringify({id:obj.id})},this.settings.core.error.call(this,this._data.core.last_error),callback.call(this,!1))):"string"==typeof s?obj.id===$.jstree.root?this._append_html_data(obj,$($.parseHTML(s)).filter(notTextOrCommentNode),function(status){callback.call(this,status)}):(this._data.core.last_error={error:"nodata",plugin:"core",id:"core_06",reason:"Could not load node",data:JSON.stringify({id:obj.id})},this.settings.core.error.call(this,this._data.core.last_error),callback.call(this,!1)):callback.call(this,!1):obj.id===$.jstree.root?this._append_html_data(obj,this._data.core.original_container_html.clone(!0),function(status){callback.call(this,status)}):callback.call(this,!1)},_node_changed:function(obj){(obj=this.get_node(obj))&&-1===$.inArray(obj.id,this._model.changed)&&this._model.changed.push(obj.id)},_append_html_data:function(dom,data,cb){(dom=this.get_node(dom)).children=[],dom.children_d=[];var tmp,i,j,dat=data.is("ul")?data.children():data,par=dom.id,chd=[],dpc=[],m=this._model.data,p=m[par],s=this._data.core.selected.length;for(dat.each($.proxy(function(i,v){(tmp=this._parse_model_from_html($(v),par,p.parents.concat()))&&(chd.push(tmp),dpc.push(tmp),m[tmp].children_d.length&&(dpc=dpc.concat(m[tmp].children_d)))},this)),p.children=chd,p.children_d=dpc,i=0,j=p.parents.length;i<j;i++)m[p.parents[i]].children_d=m[p.parents[i]].children_d.concat(dpc);this.trigger("model",{nodes:dpc,parent:par}),par!==$.jstree.root?(this._node_changed(par),this.redraw()):(this.get_container_ul().children(".jstree-initial-node").remove(),this.redraw(!0)),this._data.core.selected.length!==s&&this.trigger("changed",{action:"model",selected:this._data.core.selected}),cb.call(this,!0)},_append_json_data:function(dom,data,cb,force_processing){if(null!==this.element){(dom=this.get_node(dom)).children=[],dom.children_d=[],data.d&&"string"==typeof(data=data.d)&&(data=JSON.parse(data)),$.isArray(data)||(data=[data]);var w=null,args={df:this._model.default_state,dat:data,par:dom.id,m:this._model.data,t_id:this._id,t_cnt:this._cnt,sel:this._data.core.selected},func=function(data,undefined){data.data&&(data=data.data);var tmp,i,j,rslt,dat=data.dat,par=data.par,chd=[],dpc=[],add=[],df=data.df,t_id=data.t_id,t_cnt=data.t_cnt,m=data.m,p=m[par],sel=data.sel,parse_flat=function(d,p,ps){ps=ps?ps.concat():[],p&&ps.unshift(p);var i,j,c,e,tid=d.id.toString(),tmp={id:tid,text:d.text||"",icon:d.icon===undefined||d.icon,parent:p,parents:ps,children:d.children||[],children_d:d.children_d||[],data:d.data,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(i in df)df.hasOwnProperty(i)&&(tmp.state[i]=df[i]);if(d&&d.data&&d.data.jstree&&d.data.jstree.icon&&(tmp.icon=d.data.jstree.icon),tmp.icon!==undefined&&null!==tmp.icon&&""!==tmp.icon||(tmp.icon=!0),d&&d.data&&(tmp.data=d.data,d.data.jstree))for(i in d.data.jstree)d.data.jstree.hasOwnProperty(i)&&(tmp.state[i]=d.data.jstree[i]);if(d&&"object"==typeof d.state)for(i in d.state)d.state.hasOwnProperty(i)&&(tmp.state[i]=d.state[i]);if(d&&"object"==typeof d.li_attr)for(i in d.li_attr)d.li_attr.hasOwnProperty(i)&&(tmp.li_attr[i]=d.li_attr[i]);if(tmp.li_attr.id||(tmp.li_attr.id=tid),d&&"object"==typeof d.a_attr)for(i in d.a_attr)d.a_attr.hasOwnProperty(i)&&(tmp.a_attr[i]=d.a_attr[i]);for(d&&d.children&&!0===d.children&&(tmp.state.loaded=!1,tmp.children=[],tmp.children_d=[]),m[tmp.id]=tmp,i=0,j=tmp.children.length;i<j;i++)c=parse_flat(m[tmp.children[i]],tmp.id,ps),e=m[c],tmp.children_d.push(c),e.children_d.length&&(tmp.children_d=tmp.children_d.concat(e.children_d));return delete d.data,delete d.children,m[tmp.id].original=d,tmp.state.selected&&add.push(tmp.id),tmp.id},parse_nest=function(d,p,ps){ps=ps?ps.concat():[],p&&ps.unshift(p);var i,j,c,e,tmp,tid=!1;do{tid="j"+t_id+"_"+ ++t_cnt}while(m[tid]);for(i in tmp={id:!1,text:"string"==typeof d?d:"",icon:"object"!=typeof d||d.icon===undefined||d.icon,parent:p,parents:ps,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1},df)df.hasOwnProperty(i)&&(tmp.state[i]=df[i]);if(d&&d.id&&(tmp.id=d.id.toString()),d&&d.text&&(tmp.text=d.text),d&&d.data&&d.data.jstree&&d.data.jstree.icon&&(tmp.icon=d.data.jstree.icon),tmp.icon!==undefined&&null!==tmp.icon&&""!==tmp.icon||(tmp.icon=!0),d&&d.data&&(tmp.data=d.data,d.data.jstree))for(i in d.data.jstree)d.data.jstree.hasOwnProperty(i)&&(tmp.state[i]=d.data.jstree[i]);if(d&&"object"==typeof d.state)for(i in d.state)d.state.hasOwnProperty(i)&&(tmp.state[i]=d.state[i]);if(d&&"object"==typeof d.li_attr)for(i in d.li_attr)d.li_attr.hasOwnProperty(i)&&(tmp.li_attr[i]=d.li_attr[i]);if(tmp.li_attr.id&&!tmp.id&&(tmp.id=tmp.li_attr.id.toString()),tmp.id||(tmp.id=tid),tmp.li_attr.id||(tmp.li_attr.id=tmp.id),d&&"object"==typeof d.a_attr)for(i in d.a_attr)d.a_attr.hasOwnProperty(i)&&(tmp.a_attr[i]=d.a_attr[i]);if(d&&d.children&&d.children.length){for(i=0,j=d.children.length;i<j;i++)c=parse_nest(d.children[i],tmp.id,ps),e=m[c],tmp.children.push(c),e.children_d.length&&(tmp.children_d=tmp.children_d.concat(e.children_d));tmp.children_d=tmp.children_d.concat(tmp.children)}return d&&d.children&&!0===d.children&&(tmp.state.loaded=!1,tmp.children=[],tmp.children_d=[]),delete d.data,delete d.children,tmp.original=d,m[tmp.id]=tmp,tmp.state.selected&&add.push(tmp.id),tmp.id};if(dat.length&&dat[0].id!==undefined&&dat[0].parent!==undefined){for(i=0,j=dat.length;i<j;i++)dat[i].children||(dat[i].children=[]),dat[i].state||(dat[i].state={}),m[dat[i].id.toString()]=dat[i];for(i=0,j=dat.length;i<j;i++)m[dat[i].parent.toString()]?(m[dat[i].parent.toString()].children.push(dat[i].id.toString()),p.children_d.push(dat[i].id.toString())):(this._data.core.last_error={error:"parse",plugin:"core",id:"core_07",reason:"Node with invalid parent",data:JSON.stringify({id:dat[i].id.toString(),parent:dat[i].parent.toString()})},this.settings.core.error.call(this,this._data.core.last_error));for(i=0,j=p.children.length;i<j;i++)tmp=parse_flat(m[p.children[i]],par,p.parents.concat()),dpc.push(tmp),m[tmp].children_d.length&&(dpc=dpc.concat(m[tmp].children_d));for(i=0,j=p.parents.length;i<j;i++)m[p.parents[i]].children_d=m[p.parents[i]].children_d.concat(dpc);rslt={cnt:t_cnt,mod:m,sel:sel,par:par,dpc:dpc,add:add}}else{for(i=0,j=dat.length;i<j;i++)(tmp=parse_nest(dat[i],par,p.parents.concat()))&&(chd.push(tmp),dpc.push(tmp),m[tmp].children_d.length&&(dpc=dpc.concat(m[tmp].children_d)));for(p.children=chd,p.children_d=dpc,i=0,j=p.parents.length;i<j;i++)m[p.parents[i]].children_d=m[p.parents[i]].children_d.concat(dpc);rslt={cnt:t_cnt,mod:m,sel:sel,par:par,dpc:dpc,add:add}}if("undefined"!=typeof window&&void 0!==window.document)return rslt;postMessage(rslt)},rslt=function(rslt,worker){if(null!==this.element){this._cnt=rslt.cnt;var i,m=this._model.data;for(i in m)m.hasOwnProperty(i)&&m[i].state&&m[i].state.loading&&rslt.mod[i]&&(rslt.mod[i].state.loading=!0);if(this._model.data=rslt.mod,worker){var j,a=rslt.add,r=rslt.sel,s=this._data.core.selected.slice();if(m=this._model.data,r.length!==s.length||$.vakata.array_unique(r.concat(s)).length!==r.length){for(i=0,j=r.length;i<j;i++)-1===$.inArray(r[i],a)&&-1===$.inArray(r[i],s)&&(m[r[i]].state.selected=!1);for(i=0,j=s.length;i<j;i++)-1===$.inArray(s[i],r)&&(m[s[i]].state.selected=!0)}}rslt.add.length&&(this._data.core.selected=this._data.core.selected.concat(rslt.add)),this.trigger("model",{nodes:rslt.dpc,parent:rslt.par}),rslt.par!==$.jstree.root?(this._node_changed(rslt.par),this.redraw()):this.redraw(!0),rslt.add.length&&this.trigger("changed",{action:"model",selected:this._data.core.selected}),cb.call(this,!0)}};if(this.settings.core.worker&&window.Blob&&window.URL&&window.Worker)try{null===this._wrk&&(this._wrk=window.URL.createObjectURL(new window.Blob(["self.onmessage = "+func.toString()],{type:"text/javascript"}))),!this._data.core.working||force_processing?(this._data.core.working=!0,(w=new window.Worker(this._wrk)).onmessage=$.proxy(function(e){rslt.call(this,e.data,!0);try{w.terminate(),w=null}catch(ignore){}this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1},this),args.par?w.postMessage(args):this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1):this._data.core.worker_queue.push([dom,data,cb,!0])}catch(e){rslt.call(this,func(args),!1),this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1}else rslt.call(this,func(args),!1)}},_parse_model_from_html:function(d,p,ps){ps=ps?[].concat(ps):[],p&&ps.unshift(p);var c,e,i,tmp,tid,m=this._model.data,data={id:!1,text:!1,icon:!0,parent:p,parents:ps,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(i in this._model.default_state)this._model.default_state.hasOwnProperty(i)&&(data.state[i]=this._model.default_state[i]);if(tmp=$.vakata.attributes(d,!0),$.each(tmp,function(i,v){if(!(v=$.trim(v)).length)return!0;data.li_attr[i]=v,"id"===i&&(data.id=v.toString())}),(tmp=d.children("a").first()).length&&(tmp=$.vakata.attributes(tmp,!0),$.each(tmp,function(i,v){(v=$.trim(v)).length&&(data.a_attr[i]=v)})),(tmp=d.children("a").first().length?d.children("a").first().clone():d.clone()).children("ins, i, ul").remove(),tmp=tmp.html(),tmp=$("<div />").html(tmp),data.text=this.settings.core.force_text?tmp.text():tmp.html(),tmp=d.data(),data.data=tmp?$.extend(!0,{},tmp):null,data.state.opened=d.hasClass("jstree-open"),data.state.selected=d.children("a").hasClass("jstree-clicked"),data.state.disabled=d.children("a").hasClass("jstree-disabled"),data.data&&data.data.jstree)for(i in data.data.jstree)data.data.jstree.hasOwnProperty(i)&&(data.state[i]=data.data.jstree[i]);(tmp=d.children("a").children(".jstree-themeicon")).length&&(data.icon=!tmp.hasClass("jstree-themeicon-hidden")&&tmp.attr("rel")),data.state.icon!==undefined&&(data.icon=data.state.icon),data.icon!==undefined&&null!==data.icon&&""!==data.icon||(data.icon=!0),tmp=d.children("ul").children("li");do{tid="j"+this._id+"_"+ ++this._cnt}while(m[tid]);return data.id=data.li_attr.id?data.li_attr.id.toString():tid,tmp.length?(tmp.each($.proxy(function(i,v){c=this._parse_model_from_html($(v),data.id,ps),e=this._model.data[c],data.children.push(c),e.children_d.length&&(data.children_d=data.children_d.concat(e.children_d))},this)),data.children_d=data.children_d.concat(data.children)):d.hasClass("jstree-closed")&&(data.state.loaded=!1),data.li_attr.class&&(data.li_attr.class=data.li_attr.class.replace("jstree-closed","").replace("jstree-open","")),data.a_attr.class&&(data.a_attr.class=data.a_attr.class.replace("jstree-clicked","").replace("jstree-disabled","")),m[data.id]=data,data.state.selected&&this._data.core.selected.push(data.id),data.id},_parse_model_from_flat_json:function(d,p,ps){ps=ps?ps.concat():[],p&&ps.unshift(p);var i,j,c,e,tid=d.id.toString(),m=this._model.data,df=this._model.default_state,tmp={id:tid,text:d.text||"",icon:d.icon===undefined||d.icon,parent:p,parents:ps,children:d.children||[],children_d:d.children_d||[],data:d.data,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(i in df)df.hasOwnProperty(i)&&(tmp.state[i]=df[i]);if(d&&d.data&&d.data.jstree&&d.data.jstree.icon&&(tmp.icon=d.data.jstree.icon),tmp.icon!==undefined&&null!==tmp.icon&&""!==tmp.icon||(tmp.icon=!0),d&&d.data&&(tmp.data=d.data,d.data.jstree))for(i in d.data.jstree)d.data.jstree.hasOwnProperty(i)&&(tmp.state[i]=d.data.jstree[i]);if(d&&"object"==typeof d.state)for(i in d.state)d.state.hasOwnProperty(i)&&(tmp.state[i]=d.state[i]);if(d&&"object"==typeof d.li_attr)for(i in d.li_attr)d.li_attr.hasOwnProperty(i)&&(tmp.li_attr[i]=d.li_attr[i]);if(tmp.li_attr.id||(tmp.li_attr.id=tid),d&&"object"==typeof d.a_attr)for(i in d.a_attr)d.a_attr.hasOwnProperty(i)&&(tmp.a_attr[i]=d.a_attr[i]);for(d&&d.children&&!0===d.children&&(tmp.state.loaded=!1,tmp.children=[],tmp.children_d=[]),m[tmp.id]=tmp,i=0,j=tmp.children.length;i<j;i++)c=this._parse_model_from_flat_json(m[tmp.children[i]],tmp.id,ps),e=m[c],tmp.children_d.push(c),e.children_d.length&&(tmp.children_d=tmp.children_d.concat(e.children_d));return delete d.data,delete d.children,m[tmp.id].original=d,tmp.state.selected&&this._data.core.selected.push(tmp.id),tmp.id},_parse_model_from_json:function(d,p,ps){ps=ps?ps.concat():[],p&&ps.unshift(p);var i,j,c,e,tmp,tid=!1,m=this._model.data,df=this._model.default_state;do{tid="j"+this._id+"_"+ ++this._cnt}while(m[tid]);for(i in tmp={id:!1,text:"string"==typeof d?d:"",icon:"object"!=typeof d||d.icon===undefined||d.icon,parent:p,parents:ps,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1},df)df.hasOwnProperty(i)&&(tmp.state[i]=df[i]);if(d&&d.id&&(tmp.id=d.id.toString()),d&&d.text&&(tmp.text=d.text),d&&d.data&&d.data.jstree&&d.data.jstree.icon&&(tmp.icon=d.data.jstree.icon),tmp.icon!==undefined&&null!==tmp.icon&&""!==tmp.icon||(tmp.icon=!0),d&&d.data&&(tmp.data=d.data,d.data.jstree))for(i in d.data.jstree)d.data.jstree.hasOwnProperty(i)&&(tmp.state[i]=d.data.jstree[i]);if(d&&"object"==typeof d.state)for(i in d.state)d.state.hasOwnProperty(i)&&(tmp.state[i]=d.state[i]);if(d&&"object"==typeof d.li_attr)for(i in d.li_attr)d.li_attr.hasOwnProperty(i)&&(tmp.li_attr[i]=d.li_attr[i]);if(tmp.li_attr.id&&!tmp.id&&(tmp.id=tmp.li_attr.id.toString()),tmp.id||(tmp.id=tid),tmp.li_attr.id||(tmp.li_attr.id=tmp.id),d&&"object"==typeof d.a_attr)for(i in d.a_attr)d.a_attr.hasOwnProperty(i)&&(tmp.a_attr[i]=d.a_attr[i]);if(d&&d.children&&d.children.length){for(i=0,j=d.children.length;i<j;i++)c=this._parse_model_from_json(d.children[i],tmp.id,ps),e=m[c],tmp.children.push(c),e.children_d.length&&(tmp.children_d=tmp.children_d.concat(e.children_d));tmp.children_d=tmp.children_d.concat(tmp.children)}return d&&d.children&&!0===d.children&&(tmp.state.loaded=!1,tmp.children=[],tmp.children_d=[]),delete d.data,delete d.children,tmp.original=d,m[tmp.id]=tmp,tmp.state.selected&&this._data.core.selected.push(tmp.id),tmp.id},_redraw:function(){var tmp,i,j,nodes=this._model.force_full_redraw?this._model.data[$.jstree.root].children.concat([]):this._model.changed.concat([]),f=document.createElement("UL"),fe=this._data.core.focused;for(i=0,j=nodes.length;i<j;i++)(tmp=this.redraw_node(nodes[i],!0,this._model.force_full_redraw))&&this._model.force_full_redraw&&f.appendChild(tmp);this._model.force_full_redraw&&(f.className=this.get_container_ul()[0].className,f.setAttribute("role","group"),this.element.empty().append(f)),null!==fe&&this.settings.core.restore_focus&&((tmp=this.get_node(fe,!0))&&tmp.length&&tmp.children(".jstree-anchor")[0]!==document.activeElement?tmp.children(".jstree-anchor").focus():this._data.core.focused=null),this._model.force_full_redraw=!1,this._model.changed=[],this.trigger("redraw",{nodes:nodes})},redraw:function(full){full&&(this._model.force_full_redraw=!0),this._redraw()},draw_children:function(node){var obj=this.get_node(node),i=!1,j=!1,k=!1,d=document;if(!obj)return!1;if(obj.id===$.jstree.root)return this.redraw(!0);if(!(node=this.get_node(node,!0))||!node.length)return!1;if(node.children(".jstree-children").remove(),node=node[0],obj.children.length&&obj.state.loaded){for((k=d.createElement("UL")).setAttribute("role","group"),k.className="jstree-children",i=0,j=obj.children.length;i<j;i++)k.appendChild(this.redraw_node(obj.children[i],!0,!0));node.appendChild(k)}},redraw_node:function(node,deep,is_callback,force_render){var obj=this.get_node(node),par=!1,ind=!1,old=!1,i=!1,j=!1,k=!1,c="",d=document,m=this._model.data,f=!1,tmp=null,t=0,l=0,has_children=!1,last_sibling=!1;if(!obj)return!1;if(obj.id===$.jstree.root)return this.redraw(!0);if(deep=deep||0===obj.children.length,node=document.querySelector?this.element[0].querySelector("#"+(-1!=="0123456789".indexOf(obj.id[0])?"\\3"+obj.id[0]+" "+obj.id.substr(1).replace($.jstree.idregex,"\\$&"):obj.id.replace($.jstree.idregex,"\\$&"))):document.getElementById(obj.id))node=$(node),is_callback||((par=node.parent().parent()[0])===this.element[0]&&(par=null),ind=node.index()),deep||!obj.children.length||node.children(".jstree-children").length||(deep=!0),deep||(old=node.children(".jstree-children")[0]),f=node.children(".jstree-anchor")[0]===document.activeElement,node.remove();else if(deep=!0,!is_callback){if(!(null===(par=obj.parent!==$.jstree.root?$("#"+obj.parent.replace($.jstree.idregex,"\\$&"),this.element)[0]:null)||par&&m[obj.parent].state.opened))return!1;ind=$.inArray(obj.id,null===par?m[$.jstree.root].children:m[obj.parent].children)}for(i in node=this._data.core.node.cloneNode(!0),c="jstree-node ",obj.li_attr)if(obj.li_attr.hasOwnProperty(i)){if("id"===i)continue;"class"!==i?node.setAttribute(i,obj.li_attr[i]):c+=obj.li_attr[i]}for(obj.a_attr.id||(obj.a_attr.id=obj.id+"_anchor"),node.setAttribute("aria-selected",!!obj.state.selected),node.setAttribute("aria-level",obj.parents.length),node.setAttribute("aria-labelledby",obj.a_attr.id),obj.state.disabled&&node.setAttribute("aria-disabled",!0),i=0,j=obj.children.length;i<j;i++)if(!m[obj.children[i]].state.hidden){has_children=!0;break}if(null!==obj.parent&&m[obj.parent]&&!obj.state.hidden&&(i=$.inArray(obj.id,m[obj.parent].children),last_sibling=obj.id,-1!==i))for(i++,j=m[obj.parent].children.length;i<j&&(m[m[obj.parent].children[i]].state.hidden||(last_sibling=m[obj.parent].children[i]),last_sibling===obj.id);i++);for(j in obj.state.hidden&&(c+=" jstree-hidden"),obj.state.loading&&(c+=" jstree-loading"),obj.state.loaded&&!has_children?c+=" jstree-leaf":(c+=obj.state.opened&&obj.state.loaded?" jstree-open":" jstree-closed",node.setAttribute("aria-expanded",obj.state.opened&&obj.state.loaded)),last_sibling===obj.id&&(c+=" jstree-last"),node.id=obj.id,node.className=c,c=(obj.state.selected?" jstree-clicked":"")+(obj.state.disabled?" jstree-disabled":""),obj.a_attr)if(obj.a_attr.hasOwnProperty(j)){if("href"===j&&"#"===obj.a_attr[j])continue;"class"!==j?node.childNodes[1].setAttribute(j,obj.a_attr[j]):c+=" "+obj.a_attr[j]}if(c.length&&(node.childNodes[1].className="jstree-anchor "+c),(obj.icon&&!0!==obj.icon||!1===obj.icon)&&(!1===obj.icon?node.childNodes[1].childNodes[0].className+=" jstree-themeicon-hidden":-1===obj.icon.indexOf("/")&&-1===obj.icon.indexOf(".")?node.childNodes[1].childNodes[0].className+=" "+obj.icon+" jstree-themeicon-custom":(node.childNodes[1].childNodes[0].style.backgroundImage='url("'+obj.icon+'")',node.childNodes[1].childNodes[0].style.backgroundPosition="center center",node.childNodes[1].childNodes[0].style.backgroundSize="auto",node.childNodes[1].childNodes[0].className+=" jstree-themeicon-custom")),this.settings.core.force_text?node.childNodes[1].appendChild(d.createTextNode(obj.text)):node.childNodes[1].innerHTML+=obj.text,deep&&obj.children.length&&(obj.state.opened||force_render)&&obj.state.loaded){for((k=d.createElement("UL")).setAttribute("role","group"),k.className="jstree-children",i=0,j=obj.children.length;i<j;i++)k.appendChild(this.redraw_node(obj.children[i],deep,!0));node.appendChild(k)}if(old&&node.appendChild(old),!is_callback){for(par||(par=this.element[0]),i=0,j=par.childNodes.length;i<j;i++)if(par.childNodes[i]&&par.childNodes[i].className&&-1!==par.childNodes[i].className.indexOf("jstree-children")){tmp=par.childNodes[i];break}tmp||((tmp=d.createElement("UL")).setAttribute("role","group"),tmp.className="jstree-children",par.appendChild(tmp)),ind<(par=tmp).childNodes.length?par.insertBefore(node,par.childNodes[ind]):par.appendChild(node),f&&(t=this.element[0].scrollTop,l=this.element[0].scrollLeft,node.childNodes[1].focus(),this.element[0].scrollTop=t,this.element[0].scrollLeft=l)}return obj.state.opened&&!obj.state.loaded&&(obj.state.opened=!1,setTimeout($.proxy(function(){this.open_node(obj.id,!1,0)},this),0)),node},open_node:function(obj,callback,animation){var t1,t2,d,t;if($.isArray(obj)){for(obj=obj.slice(),t1=0,t2=obj.length;t1<t2;t1++)this.open_node(obj[t1],callback,animation);return!0}return!(!(obj=this.get_node(obj))||obj.id===$.jstree.root)&&(animation=animation===undefined?this.settings.core.animation:animation,this.is_closed(obj)?this.is_loaded(obj)?(d=this.get_node(obj,!0),t=this,d.length&&(animation&&d.children(".jstree-children").length&&d.children(".jstree-children").stop(!0,!0),obj.children.length&&!this._firstChild(d.children(".jstree-children")[0])&&this.draw_children(obj),animation?(this.trigger("before_open",{node:obj}),d.children(".jstree-children").css("display","none").end().removeClass("jstree-closed").addClass("jstree-open").attr("aria-expanded",!0).children(".jstree-children").stop(!0,!0).slideDown(animation,function(){this.style.display="",t.element&&t.trigger("after_open",{node:obj})})):(this.trigger("before_open",{node:obj}),d[0].className=d[0].className.replace("jstree-closed","jstree-open"),d[0].setAttribute("aria-expanded",!0))),obj.state.opened=!0,callback&&callback.call(this,obj,!0),d.length||this.trigger("before_open",{node:obj}),this.trigger("open_node",{node:obj}),animation&&d.length||this.trigger("after_open",{node:obj}),!0):this.is_loading(obj)?setTimeout($.proxy(function(){this.open_node(obj,callback,animation)},this),500):void this.load_node(obj,function(o,ok){return ok?this.open_node(o,callback,animation):!!callback&&callback.call(this,o,!1)}):(callback&&callback.call(this,obj,!1),!1))},_open_to:function(obj){if(!(obj=this.get_node(obj))||obj.id===$.jstree.root)return!1;var i,j,p=obj.parents;for(i=0,j=p.length;i<j;i+=1)i!==$.jstree.root&&this.open_node(p[i],!1,0);return $("#"+obj.id.replace($.jstree.idregex,"\\$&"),this.element)},close_node:function(obj,animation){var t1,t2,t,d;if($.isArray(obj)){for(obj=obj.slice(),t1=0,t2=obj.length;t1<t2;t1++)this.close_node(obj[t1],animation);return!0}return!(!(obj=this.get_node(obj))||obj.id===$.jstree.root)&&(!this.is_closed(obj)&&(animation=animation===undefined?this.settings.core.animation:animation,t=this,d=this.get_node(obj,!0),obj.state.opened=!1,this.trigger("close_node",{node:obj}),void(d.length?animation?d.children(".jstree-children").attr("style","display:block !important").end().removeClass("jstree-open").addClass("jstree-closed").attr("aria-expanded",!1).children(".jstree-children").stop(!0,!0).slideUp(animation,function(){this.style.display="",d.children(".jstree-children").remove(),t.element&&t.trigger("after_close",{node:obj})}):(d[0].className=d[0].className.replace("jstree-open","jstree-closed"),d.attr("aria-expanded",!1).children(".jstree-children").remove(),this.trigger("after_close",{node:obj})):this.trigger("after_close",{node:obj}))))},toggle_node:function(obj){var t1,t2;if($.isArray(obj)){for(obj=obj.slice(),t1=0,t2=obj.length;t1<t2;t1++)this.toggle_node(obj[t1]);return!0}return this.is_closed(obj)?this.open_node(obj):this.is_open(obj)?this.close_node(obj):void 0},open_all:function(obj,animation,original_obj){if(obj||(obj=$.jstree.root),!(obj=this.get_node(obj)))return!1;var i,j,_this,dom=obj.id===$.jstree.root?this.get_container_ul():this.get_node(obj,!0);if(!dom.length){for(i=0,j=obj.children_d.length;i<j;i++)this.is_closed(this._model.data[obj.children_d[i]])&&(this._model.data[obj.children_d[i]].state.opened=!0);return this.trigger("open_all",{node:obj})}original_obj=original_obj||dom,_this=this,(dom=this.is_closed(obj)?dom.find(".jstree-closed").addBack():dom.find(".jstree-closed")).each(function(){_this.open_node(this,function(node,status){status&&this.is_parent(node)&&this.open_all(node,animation,original_obj)},animation||0)}),0===original_obj.find(".jstree-closed").length&&this.trigger("open_all",{node:this.get_node(original_obj)})},close_all:function(obj,animation){if(obj||(obj=$.jstree.root),!(obj=this.get_node(obj)))return!1;var i,j,dom=obj.id===$.jstree.root?this.get_container_ul():this.get_node(obj,!0),_this=this;for(dom.length&&(dom=this.is_open(obj)?dom.find(".jstree-open").addBack():dom.find(".jstree-open"),$(dom.get().reverse()).each(function(){_this.close_node(this,animation||0)})),i=0,j=obj.children_d.length;i<j;i++)this._model.data[obj.children_d[i]].state.opened=!1;this.trigger("close_all",{node:obj})},is_disabled:function(obj){return(obj=this.get_node(obj))&&obj.state&&obj.state.disabled},enable_node:function(obj){var t1,t2;if($.isArray(obj)){for(obj=obj.slice(),t1=0,t2=obj.length;t1<t2;t1++)this.enable_node(obj[t1]);return!0}if(!(obj=this.get_node(obj))||obj.id===$.jstree.root)return!1;obj.state.disabled=!1,this.get_node(obj,!0).children(".jstree-anchor").removeClass("jstree-disabled").attr("aria-disabled",!1),this.trigger("enable_node",{node:obj})},disable_node:function(obj){var t1,t2;if($.isArray(obj)){for(obj=obj.slice(),t1=0,t2=obj.length;t1<t2;t1++)this.disable_node(obj[t1]);return!0}if(!(obj=this.get_node(obj))||obj.id===$.jstree.root)return!1;obj.state.disabled=!0,this.get_node(obj,!0).children(".jstree-anchor").addClass("jstree-disabled").attr("aria-disabled",!0),this.trigger("disable_node",{node:obj})},is_hidden:function(obj){return!0===(obj=this.get_node(obj)).state.hidden},hide_node:function(obj,skip_redraw){var t1,t2;if($.isArray(obj)){for(obj=obj.slice(),t1=0,t2=obj.length;t1<t2;t1++)this.hide_node(obj[t1],!0);return skip_redraw||this.redraw(),!0}if(!(obj=this.get_node(obj))||obj.id===$.jstree.root)return!1;obj.state.hidden||(obj.state.hidden=!0,this._node_changed(obj.parent),skip_redraw||this.redraw(),this.trigger("hide_node",{node:obj}))},show_node:function(obj,skip_redraw){var t1,t2;if($.isArray(obj)){for(obj=obj.slice(),t1=0,t2=obj.length;t1<t2;t1++)this.show_node(obj[t1],!0);return skip_redraw||this.redraw(),!0}if(!(obj=this.get_node(obj))||obj.id===$.jstree.root)return!1;obj.state.hidden&&(obj.state.hidden=!1,this._node_changed(obj.parent),skip_redraw||this.redraw(),this.trigger("show_node",{node:obj}))},hide_all:function(skip_redraw){var i,m=this._model.data,ids=[];for(i in m)m.hasOwnProperty(i)&&i!==$.jstree.root&&!m[i].state.hidden&&(m[i].state.hidden=!0,ids.push(i));return this._model.force_full_redraw=!0,skip_redraw||this.redraw(),this.trigger("hide_all",{nodes:ids}),ids},show_all:function(skip_redraw){var i,m=this._model.data,ids=[];for(i in m)m.hasOwnProperty(i)&&i!==$.jstree.root&&m[i].state.hidden&&(m[i].state.hidden=!1,ids.push(i));return this._model.force_full_redraw=!0,skip_redraw||this.redraw(),this.trigger("show_all",{nodes:ids}),ids},activate_node:function(obj,e){if(this.is_disabled(obj))return!1;if(e&&"object"==typeof e||(e={}),this._data.core.last_clicked=this._data.core.last_clicked&&this._data.core.last_clicked.id!==undefined?this.get_node(this._data.core.last_clicked.id):null,this._data.core.last_clicked&&!this._data.core.last_clicked.state.selected&&(this._data.core.last_clicked=null),!this._data.core.last_clicked&&this._data.core.selected.length&&(this._data.core.last_clicked=this.get_node(this._data.core.selected[this._data.core.selected.length-1])),this.settings.core.multiple&&(e.metaKey||e.ctrlKey||e.shiftKey)&&(!e.shiftKey||this._data.core.last_clicked&&this.get_parent(obj)&&this.get_parent(obj)===this._data.core.last_clicked.parent))if(e.shiftKey){var i,j,o=this.get_node(obj).id,l=this._data.core.last_clicked.id,p=this.get_node(this._data.core.last_clicked.parent).children,c=!1;for(i=0,j=p.length;i<j;i+=1)p[i]===o&&(c=!c),p[i]===l&&(c=!c),this.is_disabled(p[i])||!c&&p[i]!==o&&p[i]!==l?this.deselect_node(p[i],!0,e):this.is_hidden(p[i])||this.select_node(p[i],!0,!1,e);this.trigger("changed",{action:"select_node",node:this.get_node(obj),selected:this._data.core.selected,event:e})}else this.is_selected(obj)?this.deselect_node(obj,!1,e):this.select_node(obj,!1,!1,e);else!this.settings.core.multiple&&(e.metaKey||e.ctrlKey||e.shiftKey)&&this.is_selected(obj)?this.deselect_node(obj,!1,e):(this.deselect_all(!0),this.select_node(obj,!1,!1,e),this._data.core.last_clicked=this.get_node(obj));this.trigger("activate_node",{node:this.get_node(obj),event:e})},hover_node:function(obj){if(!(obj=this.get_node(obj,!0))||!obj.length||obj.children(".jstree-hovered").length)return!1;var o=this.element.find(".jstree-hovered"),t=this.element;o&&o.length&&this.dehover_node(o),obj.children(".jstree-anchor").addClass("jstree-hovered"),this.trigger("hover_node",{node:this.get_node(obj)}),setTimeout(function(){t.attr("aria-activedescendant",obj[0].id)},0)},dehover_node:function(obj){if(!(obj=this.get_node(obj,!0))||!obj.length||!obj.children(".jstree-hovered").length)return!1;obj.children(".jstree-anchor").removeClass("jstree-hovered"),this.trigger("dehover_node",{node:this.get_node(obj)})},select_node:function(obj,supress_event,prevent_open,e){var dom,t1,t2;if($.isArray(obj)){for(obj=obj.slice(),t1=0,t2=obj.length;t1<t2;t1++)this.select_node(obj[t1],supress_event,prevent_open,e);return!0}if(!(obj=this.get_node(obj))||obj.id===$.jstree.root)return!1;dom=this.get_node(obj,!0),obj.state.selected||(obj.state.selected=!0,this._data.core.selected.push(obj.id),prevent_open||(dom=this._open_to(obj)),dom&&dom.length&&dom.attr("aria-selected",!0).children(".jstree-anchor").addClass("jstree-clicked"),this.trigger("select_node",{node:obj,selected:this._data.core.selected,event:e}),supress_event||this.trigger("changed",{action:"select_node",node:obj,selected:this._data.core.selected,event:e}))},deselect_node:function(obj,supress_event,e){var t1,t2,dom;if($.isArray(obj)){for(obj=obj.slice(),t1=0,t2=obj.length;t1<t2;t1++)this.deselect_node(obj[t1],supress_event,e);return!0}if(!(obj=this.get_node(obj))||obj.id===$.jstree.root)return!1;dom=this.get_node(obj,!0),obj.state.selected&&(obj.state.selected=!1,this._data.core.selected=$.vakata.array_remove_item(this._data.core.selected,obj.id),dom.length&&dom.attr("aria-selected",!1).children(".jstree-anchor").removeClass("jstree-clicked"),this.trigger("deselect_node",{node:obj,selected:this._data.core.selected,event:e}),supress_event||this.trigger("changed",{action:"deselect_node",node:obj,selected:this._data.core.selected,event:e}))},select_all:function(supress_event){var i,j,tmp=this._data.core.selected.concat([]);for(this._data.core.selected=this._model.data[$.jstree.root].children_d.concat(),i=0,j=this._data.core.selected.length;i<j;i++)this._model.data[this._data.core.selected[i]]&&(this._model.data[this._data.core.selected[i]].state.selected=!0);this.redraw(!0),this.trigger("select_all",{selected:this._data.core.selected}),supress_event||this.trigger("changed",{action:"select_all",selected:this._data.core.selected,old_selection:tmp})},deselect_all:function(supress_event){var i,j,tmp=this._data.core.selected.concat([]);for(i=0,j=this._data.core.selected.length;i<j;i++)this._model.data[this._data.core.selected[i]]&&(this._model.data[this._data.core.selected[i]].state.selected=!1);this._data.core.selected=[],this.element.find(".jstree-clicked").removeClass("jstree-clicked").parent().attr("aria-selected",!1),this.trigger("deselect_all",{selected:this._data.core.selected,node:tmp}),supress_event||this.trigger("changed",{action:"deselect_all",selected:this._data.core.selected,old_selection:tmp})},is_selected:function(obj){return!(!(obj=this.get_node(obj))||obj.id===$.jstree.root)&&obj.state.selected},get_selected:function(full){return full?$.map(this._data.core.selected,$.proxy(function(i){return this.get_node(i)},this)):this._data.core.selected.slice()},get_top_selected:function(full){var i,j,k,l,tmp=this.get_selected(!0),obj={};for(i=0,j=tmp.length;i<j;i++)obj[tmp[i].id]=tmp[i];for(i=0,j=tmp.length;i<j;i++)for(k=0,l=tmp[i].children_d.length;k<l;k++)obj[tmp[i].children_d[k]]&&delete obj[tmp[i].children_d[k]];for(i in tmp=[],obj)obj.hasOwnProperty(i)&&tmp.push(i);return full?$.map(tmp,$.proxy(function(i){return this.get_node(i)},this)):tmp},get_bottom_selected:function(full){var i,j,tmp=this.get_selected(!0),obj=[];for(i=0,j=tmp.length;i<j;i++)tmp[i].children.length||obj.push(tmp[i].id);return full?$.map(obj,$.proxy(function(i){return this.get_node(i)},this)):obj},get_state:function(){var i,state={core:{open:[],loaded:[],scroll:{left:this.element.scrollLeft(),top:this.element.scrollTop()},selected:[]}};for(i in this._model.data)this._model.data.hasOwnProperty(i)&&i!==$.jstree.root&&(this._model.data[i].state.loaded&&this.settings.core.loaded_state&&state.core.loaded.push(i),this._model.data[i].state.opened&&state.core.open.push(i),this._model.data[i].state.selected&&state.core.selected.push(i));return state},set_state:function(state,callback){if(state){if(state.core&&state.core.selected&&state.core.initial_selection===undefined&&(state.core.initial_selection=this._data.core.selected.concat([]).sort().join(",")),state.core){var _this,i;if(state.core.loaded)return this.settings.core.loaded_state&&$.isArray(state.core.loaded)&&state.core.loaded.length?this._load_nodes(state.core.loaded,function(nodes){delete state.core.loaded,this.set_state(state,callback)}):(delete state.core.loaded,this.set_state(state,callback)),!1;if(state.core.open)return $.isArray(state.core.open)&&state.core.open.length?this._load_nodes(state.core.open,function(nodes){this.open_node(nodes,!1,0),delete state.core.open,this.set_state(state,callback)}):(delete state.core.open,this.set_state(state,callback)),!1;if(state.core.scroll)return state.core.scroll&&state.core.scroll.left!==undefined&&this.element.scrollLeft(state.core.scroll.left),state.core.scroll&&state.core.scroll.top!==undefined&&this.element.scrollTop(state.core.scroll.top),delete state.core.scroll,this.set_state(state,callback),!1;if(state.core.selected)return _this=this,state.core.initial_selection!==undefined&&state.core.initial_selection!==this._data.core.selected.concat([]).sort().join(",")||(this.deselect_all(),$.each(state.core.selected,function(i,v){_this.select_node(v,!1,!0)})),delete state.core.initial_selection,delete state.core.selected,this.set_state(state,callback),!1;for(i in state)state.hasOwnProperty(i)&&"core"!==i&&-1===$.inArray(i,this.settings.plugins)&&delete state[i];if($.isEmptyObject(state.core))return delete state.core,this.set_state(state,callback),!1}return!$.isEmptyObject(state)||(state=null,callback&&callback.call(this),this.trigger("set_state"),!1)}return!1},refresh:function(skip_loading,forget_state){this._data.core.state=!0===forget_state?{}:this.get_state(),forget_state&&$.isFunction(forget_state)&&(this._data.core.state=forget_state.call(this,this._data.core.state)),this._cnt=0,this._model.data={},this._model.data[$.jstree.root]={id:$.jstree.root,parent:null,parents:[],children:[],children_d:[],state:{loaded:!1}},this._data.core.selected=[],this._data.core.last_clicked=null,this._data.core.focused=null;var c=this.get_container_ul()[0].className;skip_loading||(this.element.html("<ul class='"+c+"' role='group'><li class='jstree-initial-node jstree-loading jstree-leaf jstree-last' role='treeitem' id='j"+this._id+"_loading'><i class='jstree-icon jstree-ocl'></i><a class='jstree-anchor' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>"+this.get_string("Loading ...")+"</a></li></ul>"),this.element.attr("aria-activedescendant","j"+this._id+"_loading")),this.load_node($.jstree.root,function(o,s){s&&(this.get_container_ul()[0].className=c,this._firstChild(this.get_container_ul()[0])&&this.element.attr("aria-activedescendant",this._firstChild(this.get_container_ul()[0]).id),this.set_state($.extend(!0,{},this._data.core.state),function(){this.trigger("refresh")})),this._data.core.state=null})},refresh_node:function(obj){if(!(obj=this.get_node(obj))||obj.id===$.jstree.root)return!1;var opened=[],to_load=[],s=this._data.core.selected.concat([]);to_load.push(obj.id),!0===obj.state.opened&&opened.push(obj.id),this.get_node(obj,!0).find(".jstree-open").each(function(){to_load.push(this.id),opened.push(this.id)}),this._load_nodes(to_load,$.proxy(function(nodes){this.open_node(opened,!1,0),this.select_node(s),this.trigger("refresh_node",{node:obj,nodes:nodes})},this),!1,!0)},set_id:function(obj,id){if(!(obj=this.get_node(obj))||obj.id===$.jstree.root)return!1;var i,j,m=this._model.data,old=obj.id;for(id=id.toString(),m[obj.parent].children[$.inArray(obj.id,m[obj.parent].children)]=id,i=0,j=obj.parents.length;i<j;i++)m[obj.parents[i]].children_d[$.inArray(obj.id,m[obj.parents[i]].children_d)]=id;for(i=0,j=obj.children.length;i<j;i++)m[obj.children[i]].parent=id;for(i=0,j=obj.children_d.length;i<j;i++)m[obj.children_d[i]].parents[$.inArray(obj.id,m[obj.children_d[i]].parents)]=id;return-1!==(i=$.inArray(obj.id,this._data.core.selected))&&(this._data.core.selected[i]=id),(i=this.get_node(obj.id,!0))&&(i.attr("id",id),this.element.attr("aria-activedescendant")===obj.id&&this.element.attr("aria-activedescendant",id)),delete m[obj.id],obj.id=id,obj.li_attr.id=id,m[id]=obj,this.trigger("set_id",{node:obj,new:obj.id,old:old}),!0},get_text:function(obj){return!(!(obj=this.get_node(obj))||obj.id===$.jstree.root)&&obj.text},set_text:function(obj,val){var t1,t2;if($.isArray(obj)){for(obj=obj.slice(),t1=0,t2=obj.length;t1<t2;t1++)this.set_text(obj[t1],val);return!0}return!(!(obj=this.get_node(obj))||obj.id===$.jstree.root)&&(obj.text=val,this.get_node(obj,!0).length&&this.redraw_node(obj.id),this.trigger("set_text",{obj:obj,text:val}),!0)},get_json:function(obj,options,flat){if(!(obj=this.get_node(obj||$.jstree.root)))return!1;options&&options.flat&&!flat&&(flat=[]);var i,j,tmp={id:obj.id,text:obj.text,icon:this.get_icon(obj),li_attr:$.extend(!0,{},obj.li_attr),a_attr:$.extend(!0,{},obj.a_attr),state:{},data:(!options||!options.no_data)&&$.extend(!0,$.isArray(obj.data)?[]:{},obj.data)};if(options&&options.flat?tmp.parent=obj.parent:tmp.children=[],options&&options.no_state)delete tmp.state;else for(i in obj.state)obj.state.hasOwnProperty(i)&&(tmp.state[i]=obj.state[i]);if(options&&options.no_li_attr&&delete tmp.li_attr,options&&options.no_a_attr&&delete tmp.a_attr,options&&options.no_id&&(delete tmp.id,tmp.li_attr&&tmp.li_attr.id&&delete tmp.li_attr.id,tmp.a_attr&&tmp.a_attr.id&&delete tmp.a_attr.id),options&&options.flat&&obj.id!==$.jstree.root&&flat.push(tmp),!options||!options.no_children)for(i=0,j=obj.children.length;i<j;i++)options&&options.flat?this.get_json(obj.children[i],options,flat):tmp.children.push(this.get_json(obj.children[i],options));return options&&options.flat?flat:obj.id===$.jstree.root?tmp.children:tmp},create_node:function(par,node,pos,callback,is_loaded){if(null===par&&(par=$.jstree.root),!(par=this.get_node(par)))return!1;if(!(pos=pos===undefined?"last":pos).toString().match(/^(before|after)$/)&&!is_loaded&&!this.is_loaded(par))return this.load_node(par,function(){this.create_node(par,node,pos,callback,!0)});var tmp,dpc,i,j;switch(node||(node={text:this.get_string("New node")}),(node="string"==typeof node?{text:node}:$.extend(!0,{},node)).text===undefined&&(node.text=this.get_string("New node")),par.id===$.jstree.root&&("before"===pos&&(pos="first"),"after"===pos&&(pos="last")),pos){case"before":tmp=this.get_node(par.parent),pos=$.inArray(par.id,tmp.children),par=tmp;break;case"after":tmp=this.get_node(par.parent),pos=$.inArray(par.id,tmp.children)+1,par=tmp;break;case"inside":case"first":pos=0;break;case"last":pos=par.children.length;break;default:pos||(pos=0)}if(pos>par.children.length&&(pos=par.children.length),node.id||(node.id=!0),!this.check("create_node",node,par,pos))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(!0===node.id&&delete node.id,!(node=this._parse_model_from_json(node,par.id,par.parents.concat())))return!1;for(tmp=this.get_node(node),(dpc=[]).push(node),dpc=dpc.concat(tmp.children_d),this.trigger("model",{nodes:dpc,parent:par.id}),par.children_d=par.children_d.concat(dpc),i=0,j=par.parents.length;i<j;i++)this._model.data[par.parents[i]].children_d=this._model.data[par.parents[i]].children_d.concat(dpc);for(node=tmp,tmp=[],i=0,j=par.children.length;i<j;i++)tmp[i>=pos?i+1:i]=par.children[i];return tmp[pos]=node.id,par.children=tmp,this.redraw_node(par,!0),this.trigger("create_node",{node:this.get_node(node),parent:par.id,position:pos}),callback&&callback.call(this,this.get_node(node)),node.id},rename_node:function(obj,val){var t1,t2,old;if($.isArray(obj)){for(obj=obj.slice(),t1=0,t2=obj.length;t1<t2;t1++)this.rename_node(obj[t1],val);return!0}return!(!(obj=this.get_node(obj))||obj.id===$.jstree.root)&&(old=obj.text,this.check("rename_node",obj,this.get_parent(obj),val)?(this.set_text(obj,val),this.trigger("rename_node",{node:obj,text:val,old:old}),!0):(this.settings.core.error.call(this,this._data.core.last_error),!1))},delete_node:function(obj){var t1,t2,par,pos,tmp,i,j,k,l,c,top,lft;if($.isArray(obj)){for(obj=obj.slice(),t1=0,t2=obj.length;t1<t2;t1++)this.delete_node(obj[t1]);return!0}if(!(obj=this.get_node(obj))||obj.id===$.jstree.root)return!1;if(par=this.get_node(obj.parent),pos=$.inArray(obj.id,par.children),c=!1,!this.check("delete_node",obj,par,pos))return this.settings.core.error.call(this,this._data.core.last_error),!1;for(-1!==pos&&(par.children=$.vakata.array_remove(par.children,pos)),(tmp=obj.children_d.concat([])).push(obj.id),i=0,j=obj.parents.length;i<j;i++)this._model.data[obj.parents[i]].children_d=$.vakata.array_filter(this._model.data[obj.parents[i]].children_d,function(v){return-1===$.inArray(v,tmp)});for(k=0,l=tmp.length;k<l;k++)if(this._model.data[tmp[k]].state.selected){c=!0;break}for(c&&(this._data.core.selected=$.vakata.array_filter(this._data.core.selected,function(v){return-1===$.inArray(v,tmp)})),this.trigger("delete_node",{node:obj,parent:par.id}),c&&this.trigger("changed",{action:"delete_node",node:obj,selected:this._data.core.selected,parent:par.id}),k=0,l=tmp.length;k<l;k++)delete this._model.data[tmp[k]];return-1!==$.inArray(this._data.core.focused,tmp)&&(this._data.core.focused=null,top=this.element[0].scrollTop,lft=this.element[0].scrollLeft,par.id===$.jstree.root?this._model.data[$.jstree.root].children[0]&&this.get_node(this._model.data[$.jstree.root].children[0],!0).children(".jstree-anchor").focus():this.get_node(par,!0).children(".jstree-anchor").focus(),this.element[0].scrollTop=top,this.element[0].scrollLeft=lft),this.redraw_node(par,!0),!0},check:function(chk,obj,par,pos,more){obj=obj&&obj.id?obj:this.get_node(obj),par=par&&par.id?par:this.get_node(par);var tmp=chk.match(/^move_node|copy_node|create_node$/i)?par:obj,chc=this.settings.core.check_callback;return"move_node"!==chk&&"copy_node"!==chk||more&&more.is_multi||obj.id!==par.id&&("move_node"!==chk||$.inArray(obj.id,par.children)!==pos)&&-1===$.inArray(par.id,obj.children_d)?(tmp&&tmp.data&&(tmp=tmp.data),tmp&&tmp.functions&&(!1===tmp.functions[chk]||!0===tmp.functions[chk])?(!1===tmp.functions[chk]&&(this._data.core.last_error={error:"check",plugin:"core",id:"core_02",reason:"Node data prevents function: "+chk,data:JSON.stringify({chk:chk,pos:pos,obj:!(!obj||!obj.id)&&obj.id,par:!(!par||!par.id)&&par.id})}),tmp.functions[chk]):!(!1===chc||$.isFunction(chc)&&!1===chc.call(this,chk,obj,par,pos,more)||chc&&!1===chc[chk])||(this._data.core.last_error={error:"check",plugin:"core",id:"core_03",reason:"User config for core.check_callback prevents function: "+chk,data:JSON.stringify({chk:chk,pos:pos,obj:!(!obj||!obj.id)&&obj.id,par:!(!par||!par.id)&&par.id})},!1)):(this._data.core.last_error={error:"check",plugin:"core",id:"core_01",reason:"Moving parent inside child",data:JSON.stringify({chk:chk,pos:pos,obj:!(!obj||!obj.id)&&obj.id,par:!(!par||!par.id)&&par.id})},!1)},last_error:function(){return this._data.core.last_error},move_node:function(obj,par,pos,callback,is_loaded,skip_redraw,origin){var t1,t2,old_par,old_pos,new_par,old_ins,is_multi,dpc,tmp,i,j,k,l,p;if(par=this.get_node(par),pos=pos===undefined?0:pos,!par)return!1;if(!pos.toString().match(/^(before|after)$/)&&!is_loaded&&!this.is_loaded(par))return this.load_node(par,function(){this.move_node(obj,par,pos,callback,!0,!1,origin)});if($.isArray(obj)){if(1!==obj.length){for(t1=0,t2=obj.length;t1<t2;t1++)(tmp=this.move_node(obj[t1],par,pos,callback,is_loaded,!1,origin))&&(par=tmp,pos="after");return this.redraw(),!0}obj=obj[0]}if(!(obj=obj&&obj.id?obj:this.get_node(obj))||obj.id===$.jstree.root)return!1;if(old_par=(obj.parent||$.jstree.root).toString(),new_par=pos.toString().match(/^(before|after)$/)&&par.id!==$.jstree.root?this.get_node(par.parent):par,old_ins=origin||(this._model.data[obj.id]?this:$.jstree.reference(obj.id)),is_multi=!old_ins||!old_ins._id||this._id!==old_ins._id,old_pos=old_ins&&old_ins._id&&old_par&&old_ins._model.data[old_par]&&old_ins._model.data[old_par].children?$.inArray(obj.id,old_ins._model.data[old_par].children):-1,old_ins&&old_ins._id&&(obj=old_ins._model.data[obj.id]),is_multi)return!!(tmp=this.copy_node(obj,par,pos,callback,is_loaded,!1,origin))&&(old_ins&&old_ins.delete_node(obj),tmp);switch(par.id===$.jstree.root&&("before"===pos&&(pos="first"),"after"===pos&&(pos="last")),pos){case"before":pos=$.inArray(par.id,new_par.children);break;case"after":pos=$.inArray(par.id,new_par.children)+1;break;case"inside":case"first":pos=0;break;case"last":pos=new_par.children.length;break;default:pos||(pos=0)}if(pos>new_par.children.length&&(pos=new_par.children.length),!this.check("move_node",obj,new_par,pos,{core:!0,origin:origin,is_multi:old_ins&&old_ins._id&&old_ins._id!==this._id,is_foreign:!old_ins||!old_ins._id}))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(obj.parent===new_par.id){for(dpc=new_par.children.concat(),-1!==(tmp=$.inArray(obj.id,dpc))&&(dpc=$.vakata.array_remove(dpc,tmp),pos>tmp&&pos--),tmp=[],i=0,j=dpc.length;i<j;i++)tmp[i>=pos?i+1:i]=dpc[i];tmp[pos]=obj.id,new_par.children=tmp,this._node_changed(new_par.id),this.redraw(new_par.id===$.jstree.root)}else{for((tmp=obj.children_d.concat()).push(obj.id),i=0,j=obj.parents.length;i<j;i++){for(dpc=[],p=old_ins._model.data[obj.parents[i]].children_d,k=0,l=p.length;k<l;k++)-1===$.inArray(p[k],tmp)&&dpc.push(p[k]);old_ins._model.data[obj.parents[i]].children_d=dpc}for(old_ins._model.data[old_par].children=$.vakata.array_remove_item(old_ins._model.data[old_par].children,obj.id),i=0,j=new_par.parents.length;i<j;i++)this._model.data[new_par.parents[i]].children_d=this._model.data[new_par.parents[i]].children_d.concat(tmp);for(dpc=[],i=0,j=new_par.children.length;i<j;i++)dpc[i>=pos?i+1:i]=new_par.children[i];for(dpc[pos]=obj.id,new_par.children=dpc,new_par.children_d.push(obj.id),new_par.children_d=new_par.children_d.concat(obj.children_d),obj.parent=new_par.id,(tmp=new_par.parents.concat()).unshift(new_par.id),p=obj.parents.length,obj.parents=tmp,tmp=tmp.concat(),i=0,j=obj.children_d.length;i<j;i++)this._model.data[obj.children_d[i]].parents=this._model.data[obj.children_d[i]].parents.slice(0,-1*p),Array.prototype.push.apply(this._model.data[obj.children_d[i]].parents,tmp);old_par!==$.jstree.root&&new_par.id!==$.jstree.root||(this._model.force_full_redraw=!0),this._model.force_full_redraw||(this._node_changed(old_par),this._node_changed(new_par.id)),skip_redraw||this.redraw()}return callback&&callback.call(this,obj,new_par,pos),this.trigger("move_node",{node:obj,parent:new_par.id,position:pos,old_parent:old_par,old_position:old_pos,is_multi:old_ins&&old_ins._id&&old_ins._id!==this._id,is_foreign:!old_ins||!old_ins._id,old_instance:old_ins,new_instance:this}),obj.id},copy_node:function(obj,par,pos,callback,is_loaded,skip_redraw,origin){var t1,t2,dpc,tmp,i,j,node,old_par,new_par,old_ins;if(par=this.get_node(par),pos=pos===undefined?0:pos,!par)return!1;if(!pos.toString().match(/^(before|after)$/)&&!is_loaded&&!this.is_loaded(par))return this.load_node(par,function(){this.copy_node(obj,par,pos,callback,!0,!1,origin)});if($.isArray(obj)){if(1!==obj.length){for(t1=0,t2=obj.length;t1<t2;t1++)(tmp=this.copy_node(obj[t1],par,pos,callback,is_loaded,!0,origin))&&(par=tmp,pos="after");return this.redraw(),!0}obj=obj[0]}if(!(obj=obj&&obj.id?obj:this.get_node(obj))||obj.id===$.jstree.root)return!1;switch(old_par=(obj.parent||$.jstree.root).toString(),new_par=pos.toString().match(/^(before|after)$/)&&par.id!==$.jstree.root?this.get_node(par.parent):par,old_ins=origin||(this._model.data[obj.id]?this:$.jstree.reference(obj.id)),!old_ins||!old_ins._id||this._id!==old_ins._id,old_ins&&old_ins._id&&(obj=old_ins._model.data[obj.id]),par.id===$.jstree.root&&("before"===pos&&(pos="first"),"after"===pos&&(pos="last")),pos){case"before":pos=$.inArray(par.id,new_par.children);break;case"after":pos=$.inArray(par.id,new_par.children)+1;break;case"inside":case"first":pos=0;break;case"last":pos=new_par.children.length;break;default:pos||(pos=0)}if(pos>new_par.children.length&&(pos=new_par.children.length),!this.check("copy_node",obj,new_par,pos,{core:!0,origin:origin,is_multi:old_ins&&old_ins._id&&old_ins._id!==this._id,is_foreign:!old_ins||!old_ins._id}))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(!(node=old_ins?old_ins.get_json(obj,{no_id:!0,no_data:!0,no_state:!0}):obj))return!1;if(!0===node.id&&delete node.id,!(node=this._parse_model_from_json(node,new_par.id,new_par.parents.concat())))return!1;for(tmp=this.get_node(node),obj&&obj.state&&!1===obj.state.loaded&&(tmp.state.loaded=!1),(dpc=[]).push(node),dpc=dpc.concat(tmp.children_d),this.trigger("model",{nodes:dpc,parent:new_par.id}),i=0,j=new_par.parents.length;i<j;i++)this._model.data[new_par.parents[i]].children_d=this._model.data[new_par.parents[i]].children_d.concat(dpc);for(dpc=[],i=0,j=new_par.children.length;i<j;i++)dpc[i>=pos?i+1:i]=new_par.children[i];return dpc[pos]=tmp.id,new_par.children=dpc,new_par.children_d.push(tmp.id),new_par.children_d=new_par.children_d.concat(tmp.children_d),new_par.id===$.jstree.root&&(this._model.force_full_redraw=!0),this._model.force_full_redraw||this._node_changed(new_par.id),skip_redraw||this.redraw(new_par.id===$.jstree.root),callback&&callback.call(this,tmp,new_par,pos),this.trigger("copy_node",{node:tmp,original:obj,parent:new_par.id,position:pos,old_parent:old_par,old_position:old_ins&&old_ins._id&&old_par&&old_ins._model.data[old_par]&&old_ins._model.data[old_par].children?$.inArray(obj.id,old_ins._model.data[old_par].children):-1,is_multi:old_ins&&old_ins._id&&old_ins._id!==this._id,is_foreign:!old_ins||!old_ins._id,old_instance:old_ins,new_instance:this}),tmp.id},cut:function(obj){if(obj||(obj=this._data.core.selected.concat()),$.isArray(obj)||(obj=[obj]),!obj.length)return!1;var o,t1,t2,tmp=[];for(t1=0,t2=obj.length;t1<t2;t1++)(o=this.get_node(obj[t1]))&&o.id&&o.id!==$.jstree.root&&tmp.push(o);if(!tmp.length)return!1;ccp_node=tmp,ccp_inst=this,ccp_mode="move_node",this.trigger("cut",{node:obj})},copy:function(obj){if(obj||(obj=this._data.core.selected.concat()),$.isArray(obj)||(obj=[obj]),!obj.length)return!1;var o,t1,t2,tmp=[];for(t1=0,t2=obj.length;t1<t2;t1++)(o=this.get_node(obj[t1]))&&o.id&&o.id!==$.jstree.root&&tmp.push(o);if(!tmp.length)return!1;ccp_node=tmp,ccp_inst=this,ccp_mode="copy_node",this.trigger("copy",{node:obj})},get_buffer:function(){return{mode:ccp_mode,node:ccp_node,inst:ccp_inst}},can_paste:function(){return!1!==ccp_mode&&!1!==ccp_node},paste:function(obj,pos){if(!((obj=this.get_node(obj))&&ccp_mode&&ccp_mode.match(/^(copy_node|move_node)$/)&&ccp_node))return!1;this[ccp_mode](ccp_node,obj,pos,!1,!1,!1,ccp_inst)&&this.trigger("paste",{parent:obj.id,node:ccp_node,mode:ccp_mode}),ccp_node=!1,ccp_mode=!1,ccp_inst=!1},clear_buffer:function(){ccp_node=!1,ccp_mode=!1,ccp_inst=!1,this.trigger("clear_buffer")},edit:function(obj,default_text,callback){var rtl,w,a,s,t,h1,h2,fn,tmp,cancel=!1;return!!(obj=this.get_node(obj))&&(this.check("edit",obj,this.get_parent(obj))?(tmp=obj,default_text="string"==typeof default_text?default_text:obj.text,this.set_text(obj,""),obj=this._open_to(obj),tmp.text=default_text,rtl=this._data.core.rtl,w=this.element.width(),this._data.core.focused=tmp.id,a=obj.children(".jstree-anchor").focus(),s=$("<span>"),t=default_text,h1=$("<div />",{css:{position:"absolute",top:"-200px",left:rtl?"0px":"-1000px",visibility:"hidden"}}).appendTo(document.body),h2=$("<input />",{value:t,class:"jstree-rename-input",css:{padding:"0",border:"1px solid silver","box-sizing":"border-box",display:"inline-block",height:this._data.core.li_height+"px",lineHeight:this._data.core.li_height+"px",width:"150px"},blur:$.proxy(function(e){e.stopImmediatePropagation(),e.preventDefault();var nv,i=s.children(".jstree-rename-input"),v=i.val(),f=this.settings.core.force_text;""===v&&(v=t),h1.remove(),s.replaceWith(a),s.remove(),t=f?t:$("<div></div>").append($.parseHTML(t)).html(),obj=this.get_node(obj),this.set_text(obj,t),(nv=!!this.rename_node(obj,f?$("<div></div>").text(v).text():$("<div></div>").append($.parseHTML(v)).html()))||this.set_text(obj,t),this._data.core.focused=tmp.id,setTimeout($.proxy(function(){var node=this.get_node(tmp.id,!0);node.length&&(this._data.core.focused=tmp.id,node.children(".jstree-anchor").focus())},this),0),callback&&callback.call(this,tmp,nv,cancel),h2=null},this),keydown:function(e){var key=e.which;27===key&&(cancel=!0,this.value=t),27!==key&&13!==key&&37!==key&&38!==key&&39!==key&&40!==key&&32!==key||e.stopImmediatePropagation(),27!==key&&13!==key||(e.preventDefault(),this.blur())},click:function(e){e.stopImmediatePropagation()},mousedown:function(e){e.stopImmediatePropagation()},keyup:function(e){h2.width(Math.min(h1.text("pW"+this.value).width(),w))},keypress:function(e){if(13===e.which)return!1}}),fn={fontFamily:a.css("fontFamily")||"",fontSize:a.css("fontSize")||"",fontWeight:a.css("fontWeight")||"",fontStyle:a.css("fontStyle")||"",fontStretch:a.css("fontStretch")||"",fontVariant:a.css("fontVariant")||"",letterSpacing:a.css("letterSpacing")||"",wordSpacing:a.css("wordSpacing")||""},s.attr("class",a.attr("class")).append(a.contents().clone()).append(h2),a.replaceWith(s),h1.css(fn),h2.css(fn).width(Math.min(h1.text("pW"+h2[0].value).width(),w))[0].select(),void $(document).one("mousedown.jstree touchstart.jstree dnd_start.vakata",function(e){h2&&e.target!==h2&&$(h2).blur()})):(this.settings.core.error.call(this,this._data.core.last_error),!1))},set_theme:function(theme_name,theme_url){if(!theme_name)return!1;if(!0===theme_url){var dir=this.settings.core.themes.dir;dir||(dir=$.jstree.path+"/themes"),theme_url=dir+"/"+theme_name+"/style.css"}theme_url&&-1===$.inArray(theme_url,themes_loaded)&&($("head").append('<link rel="stylesheet" href="'+theme_url+'" type="text/css" />'),themes_loaded.push(theme_url)),this._data.core.themes.name&&this.element.removeClass("jstree-"+this._data.core.themes.name),this._data.core.themes.name=theme_name,this.element.addClass("jstree-"+theme_name),this.element[this.settings.core.themes.responsive?"addClass":"removeClass"]("jstree-"+theme_name+"-responsive"),this.trigger("set_theme",{theme:theme_name})},get_theme:function(){return this._data.core.themes.name},set_theme_variant:function(variant_name){this._data.core.themes.variant&&this.element.removeClass("jstree-"+this._data.core.themes.name+"-"+this._data.core.themes.variant),this._data.core.themes.variant=variant_name,variant_name&&this.element.addClass("jstree-"+this._data.core.themes.name+"-"+this._data.core.themes.variant)},get_theme_variant:function(){return this._data.core.themes.variant},show_stripes:function(){this._data.core.themes.stripes=!0,this.get_container_ul().addClass("jstree-striped"),this.trigger("show_stripes")},hide_stripes:function(){this._data.core.themes.stripes=!1,this.get_container_ul().removeClass("jstree-striped"),this.trigger("hide_stripes")},toggle_stripes:function(){this._data.core.themes.stripes?this.hide_stripes():this.show_stripes()},show_dots:function(){this._data.core.themes.dots=!0,this.get_container_ul().removeClass("jstree-no-dots"),this.trigger("show_dots")},hide_dots:function(){this._data.core.themes.dots=!1,this.get_container_ul().addClass("jstree-no-dots"),this.trigger("hide_dots")},toggle_dots:function(){this._data.core.themes.dots?this.hide_dots():this.show_dots()},show_icons:function(){this._data.core.themes.icons=!0,this.get_container_ul().removeClass("jstree-no-icons"),this.trigger("show_icons")},hide_icons:function(){this._data.core.themes.icons=!1,this.get_container_ul().addClass("jstree-no-icons"),this.trigger("hide_icons")},toggle_icons:function(){this._data.core.themes.icons?this.hide_icons():this.show_icons()},show_ellipsis:function(){this._data.core.themes.ellipsis=!0,this.get_container_ul().addClass("jstree-ellipsis"),this.trigger("show_ellipsis")},hide_ellipsis:function(){this._data.core.themes.ellipsis=!1,this.get_container_ul().removeClass("jstree-ellipsis"),this.trigger("hide_ellipsis")},toggle_ellipsis:function(){this._data.core.themes.ellipsis?this.hide_ellipsis():this.show_ellipsis()},set_icon:function(obj,icon){var t1,t2,dom,old;if($.isArray(obj)){for(obj=obj.slice(),t1=0,t2=obj.length;t1<t2;t1++)this.set_icon(obj[t1],icon);return!0}return!(!(obj=this.get_node(obj))||obj.id===$.jstree.root)&&(old=obj.icon,obj.icon=!0===icon||null===icon||icon===undefined||""===icon||icon,dom=this.get_node(obj,!0).children(".jstree-anchor").children(".jstree-themeicon"),!1===icon?(dom.removeClass("jstree-themeicon-custom "+old).css("background","").removeAttr("rel"),this.hide_icon(obj)):!0===icon||null===icon||icon===undefined||""===icon?(dom.removeClass("jstree-themeicon-custom "+old).css("background","").removeAttr("rel"),!1===old&&this.show_icon(obj)):-1===icon.indexOf("/")&&-1===icon.indexOf(".")?(dom.removeClass(old).css("background",""),dom.addClass(icon+" jstree-themeicon-custom").attr("rel",icon),!1===old&&this.show_icon(obj)):(dom.removeClass(old).css("background",""),dom.addClass("jstree-themeicon-custom").css("background","url('"+icon+"') center center no-repeat").attr("rel",icon),!1===old&&this.show_icon(obj)),!0)},get_icon:function(obj){return!(!(obj=this.get_node(obj))||obj.id===$.jstree.root)&&obj.icon},hide_icon:function(obj){var t1,t2;if($.isArray(obj)){for(obj=obj.slice(),t1=0,t2=obj.length;t1<t2;t1++)this.hide_icon(obj[t1]);return!0}return!(!(obj=this.get_node(obj))||obj===$.jstree.root)&&(obj.icon=!1,this.get_node(obj,!0).children(".jstree-anchor").children(".jstree-themeicon").addClass("jstree-themeicon-hidden"),!0)},show_icon:function(obj){var t1,t2,dom;if($.isArray(obj)){for(obj=obj.slice(),t1=0,t2=obj.length;t1<t2;t1++)this.show_icon(obj[t1]);return!0}return!(!(obj=this.get_node(obj))||obj===$.jstree.root)&&(dom=this.get_node(obj,!0),obj.icon=!dom.length||dom.children(".jstree-anchor").children(".jstree-themeicon").attr("rel"),obj.icon||(obj.icon=!0),dom.children(".jstree-anchor").children(".jstree-themeicon").removeClass("jstree-themeicon-hidden"),!0)}},$.vakata={},$.vakata.attributes=function(node,with_values){node=$(node)[0];var attr=with_values?{}:[];return node&&node.attributes&&$.each(node.attributes,function(i,v){-1===$.inArray(v.name.toLowerCase(),["style","contenteditable","hasfocus","tabindex"])&&null!==v.value&&""!==$.trim(v.value)&&(with_values?attr[v.name]=v.value:attr.push(v.name))}),attr},$.vakata.array_unique=function(array){var i,l,a=[],o={};for(i=0,l=array.length;i<l;i++)o[array[i]]===undefined&&(a.push(array[i]),o[array[i]]=!0);return a},$.vakata.array_remove=function(array,from){return array.splice(from,1),array},$.vakata.array_remove_item=function(array,item){var tmp=$.inArray(item,array);return-1!==tmp?$.vakata.array_remove(array,tmp):array},$.vakata.array_filter=function(c,a,b,d,e){if(c.filter)return c.filter(a,b);for(e in d=[],c)~~e+""==e+""&&e>=0&&a.call(b,c[e],+e,c)&&d.push(c[e]);return d},$.jstree.plugins.changed=function(options,parent){var last=[];this.trigger=function(ev,data){var i,j;if(data||(data={}),"changed"===ev.replace(".jstree","")){data.changed={selected:[],deselected:[]};var tmp={};for(i=0,j=last.length;i<j;i++)tmp[last[i]]=1;for(i=0,j=data.selected.length;i<j;i++)tmp[data.selected[i]]?tmp[data.selected[i]]=2:data.changed.selected.push(data.selected[i]);for(i=0,j=last.length;i<j;i++)1===tmp[last[i]]&&data.changed.deselected.push(last[i]);last=data.selected.slice()}parent.trigger.call(this,ev,data)},this.refresh=function(skip_loading,forget_state){return last=[],parent.refresh.apply(this,arguments)}};var drg,elm,_i=document.createElement("I");_i.className="jstree-icon jstree-checkbox",_i.setAttribute("role","presentation"),$.jstree.defaults.checkbox={visible:!0,three_state:!0,whole_node:!0,keep_selected_style:!0,cascade:"",tie_selection:!0,cascade_to_disabled:!0,cascade_to_hidden:!0},$.jstree.plugins.checkbox=function(options,parent){this.bind=function(){parent.bind.call(this),this._data.checkbox.uto=!1,this._data.checkbox.selected=[],this.settings.checkbox.three_state&&(this.settings.checkbox.cascade="up+down+undetermined"),this.element.on("init.jstree",$.proxy(function(){this._data.checkbox.visible=this.settings.checkbox.visible,this.settings.checkbox.keep_selected_style||this.element.addClass("jstree-checkbox-no-clicked"),this.settings.checkbox.tie_selection&&this.element.addClass("jstree-checkbox-selection")},this)).on("loading.jstree",$.proxy(function(){this[this._data.checkbox.visible?"show_checkboxes":"hide_checkboxes"]()},this)),-1!==this.settings.checkbox.cascade.indexOf("undetermined")&&this.element.on("changed.jstree uncheck_node.jstree check_node.jstree uncheck_all.jstree check_all.jstree move_node.jstree copy_node.jstree redraw.jstree open_node.jstree",$.proxy(function(){this._data.checkbox.uto&&clearTimeout(this._data.checkbox.uto),this._data.checkbox.uto=setTimeout($.proxy(this._undetermined,this),50)},this)),this.settings.checkbox.tie_selection||this.element.on("model.jstree",$.proxy(function(e,data){var i,j,m=this._model.data,dpc=(m[data.parent],data.nodes);for(i=0,j=dpc.length;i<j;i++)m[dpc[i]].state.checked=m[dpc[i]].state.checked||m[dpc[i]].original&&m[dpc[i]].original.state&&m[dpc[i]].original.state.checked,m[dpc[i]].state.checked&&this._data.checkbox.selected.push(dpc[i])},this)),-1===this.settings.checkbox.cascade.indexOf("up")&&-1===this.settings.checkbox.cascade.indexOf("down")||this.element.on("model.jstree",$.proxy(function(e,data){var c,i,j,k,l,tmp,m=this._model.data,p=m[data.parent],dpc=data.nodes,chd=[],s=this.settings.checkbox.cascade,t=this.settings.checkbox.tie_selection;if(-1!==s.indexOf("down"))if(p.state[t?"selected":"checked"]){for(i=0,j=dpc.length;i<j;i++)m[dpc[i]].state[t?"selected":"checked"]=!0;this._data[t?"core":"checkbox"].selected=this._data[t?"core":"checkbox"].selected.concat(dpc)}else for(i=0,j=dpc.length;i<j;i++)if(m[dpc[i]].state[t?"selected":"checked"]){for(k=0,l=m[dpc[i]].children_d.length;k<l;k++)m[m[dpc[i]].children_d[k]].state[t?"selected":"checked"]=!0;this._data[t?"core":"checkbox"].selected=this._data[t?"core":"checkbox"].selected.concat(m[dpc[i]].children_d)}if(-1!==s.indexOf("up")){for(i=0,j=p.children_d.length;i<j;i++)m[p.children_d[i]].children.length||chd.push(m[p.children_d[i]].parent);for(chd=$.vakata.array_unique(chd),k=0,l=chd.length;k<l;k++)for(p=m[chd[k]];p&&p.id!==$.jstree.root;){for(c=0,i=0,j=p.children.length;i<j;i++)c+=m[p.children[i]].state[t?"selected":"checked"];if(c!==j)break;p.state[t?"selected":"checked"]=!0,this._data[t?"core":"checkbox"].selected.push(p.id),(tmp=this.get_node(p,!0))&&tmp.length&&tmp.attr("aria-selected",!0).children(".jstree-anchor").addClass(t?"jstree-clicked":"jstree-checked"),p=this.get_node(p.parent)}}this._data[t?"core":"checkbox"].selected=$.vakata.array_unique(this._data[t?"core":"checkbox"].selected)},this)).on(this.settings.checkbox.tie_selection?"select_node.jstree":"check_node.jstree",$.proxy(function(e,data){var i,j,c,tmp,obj=data.node,m=this._model.data,par=this.get_node(obj.parent),s=this.settings.checkbox.cascade,t=this.settings.checkbox.tie_selection,sel={},cur=this._data[t?"core":"checkbox"].selected;for(i=0,j=cur.length;i<j;i++)sel[cur[i]]=!0;if(-1!==s.indexOf("down")){var selectedIds=this._cascade_new_checked_state(obj.id,!0),temp=obj.children_d.concat(obj.id);for(i=0,j=temp.length;i<j;i++)selectedIds.indexOf(temp[i])>-1?sel[temp[i]]=!0:delete sel[temp[i]]}if(-1!==s.indexOf("up"))for(;par&&par.id!==$.jstree.root;){for(c=0,i=0,j=par.children.length;i<j;i++)c+=m[par.children[i]].state[t?"selected":"checked"];if(c!==j)break;par.state[t?"selected":"checked"]=!0,sel[par.id]=!0,(tmp=this.get_node(par,!0))&&tmp.length&&tmp.attr("aria-selected",!0).children(".jstree-anchor").addClass(t?"jstree-clicked":"jstree-checked"),par=this.get_node(par.parent)}for(i in cur=[],sel)sel.hasOwnProperty(i)&&cur.push(i);this._data[t?"core":"checkbox"].selected=cur},this)).on(this.settings.checkbox.tie_selection?"deselect_all.jstree":"uncheck_all.jstree",$.proxy(function(e,data){var i,j,tmp,obj=this.get_node($.jstree.root),m=this._model.data;for(i=0,j=obj.children_d.length;i<j;i++)(tmp=m[obj.children_d[i]])&&tmp.original&&tmp.original.state&&tmp.original.state.undetermined&&(tmp.original.state.undetermined=!1)},this)).on(this.settings.checkbox.tie_selection?"deselect_node.jstree":"uncheck_node.jstree",$.proxy(function(e,data){var i,j,tmp,obj=data.node,s=(this.get_node(obj,!0),this.settings.checkbox.cascade),t=this.settings.checkbox.tie_selection,cur=this._data[t?"core":"checkbox"].selected,allIds=obj.children_d.concat(obj.id);if(-1!==s.indexOf("down")){var selectedIds=this._cascade_new_checked_state(obj.id,!1);cur=cur.filter(function(id){return-1===allIds.indexOf(id)||selectedIds.indexOf(id)>-1})}if(-1!==s.indexOf("up")&&-1===cur.indexOf(obj.id)){for(i=0,j=obj.parents.length;i<j;i++)(tmp=this._model.data[obj.parents[i]]).state[t?"selected":"checked"]=!1,tmp&&tmp.original&&tmp.original.state&&tmp.original.state.undetermined&&(tmp.original.state.undetermined=!1),(tmp=this.get_node(obj.parents[i],!0))&&tmp.length&&tmp.attr("aria-selected",!1).children(".jstree-anchor").removeClass(t?"jstree-clicked":"jstree-checked");cur=cur.filter(function(id){return-1===obj.parents.indexOf(id)})}this._data[t?"core":"checkbox"].selected=cur},this)),-1!==this.settings.checkbox.cascade.indexOf("up")&&this.element.on("delete_node.jstree",$.proxy(function(e,data){for(var i,j,c,tmp,p=this.get_node(data.parent),m=this._model.data,t=this.settings.checkbox.tie_selection;p&&p.id!==$.jstree.root&&!p.state[t?"selected":"checked"];){for(c=0,i=0,j=p.children.length;i<j;i++)c+=m[p.children[i]].state[t?"selected":"checked"];if(!(j>0&&c===j))break;p.state[t?"selected":"checked"]=!0,this._data[t?"core":"checkbox"].selected.push(p.id),(tmp=this.get_node(p,!0))&&tmp.length&&tmp.attr("aria-selected",!0).children(".jstree-anchor").addClass(t?"jstree-clicked":"jstree-checked"),p=this.get_node(p.parent)}},this)).on("move_node.jstree",$.proxy(function(e,data){var p,c,i,j,tmp,is_multi=data.is_multi,old_par=data.old_parent,new_par=this.get_node(data.parent),m=this._model.data,t=this.settings.checkbox.tie_selection;if(!is_multi)for(p=this.get_node(old_par);p&&p.id!==$.jstree.root&&!p.state[t?"selected":"checked"];){for(c=0,i=0,j=p.children.length;i<j;i++)c+=m[p.children[i]].state[t?"selected":"checked"];if(!(j>0&&c===j))break;p.state[t?"selected":"checked"]=!0,this._data[t?"core":"checkbox"].selected.push(p.id),(tmp=this.get_node(p,!0))&&tmp.length&&tmp.attr("aria-selected",!0).children(".jstree-anchor").addClass(t?"jstree-clicked":"jstree-checked"),p=this.get_node(p.parent)}for(p=new_par;p&&p.id!==$.jstree.root;){for(c=0,i=0,j=p.children.length;i<j;i++)c+=m[p.children[i]].state[t?"selected":"checked"];if(c===j)p.state[t?"selected":"checked"]||(p.state[t?"selected":"checked"]=!0,this._data[t?"core":"checkbox"].selected.push(p.id),(tmp=this.get_node(p,!0))&&tmp.length&&tmp.attr("aria-selected",!0).children(".jstree-anchor").addClass(t?"jstree-clicked":"jstree-checked"));else{if(!p.state[t?"selected":"checked"])break;p.state[t?"selected":"checked"]=!1,this._data[t?"core":"checkbox"].selected=$.vakata.array_remove_item(this._data[t?"core":"checkbox"].selected,p.id),(tmp=this.get_node(p,!0))&&tmp.length&&tmp.attr("aria-selected",!1).children(".jstree-anchor").removeClass(t?"jstree-clicked":"jstree-checked")}p=this.get_node(p.parent)}},this))},this.get_undetermined=function(full){if(-1===this.settings.checkbox.cascade.indexOf("undetermined"))return[];var i,j,k,l,o={},m=this._model.data,t=this.settings.checkbox.tie_selection,s=this._data[t?"core":"checkbox"].selected,p=[],tt=this,r=[];for(i=0,j=s.length;i<j;i++)if(m[s[i]]&&m[s[i]].parents)for(k=0,l=m[s[i]].parents.length;k<l&&o[m[s[i]].parents[k]]===undefined;k++)m[s[i]].parents[k]!==$.jstree.root&&(o[m[s[i]].parents[k]]=!0,p.push(m[s[i]].parents[k]));for(this.element.find(".jstree-closed").not(":has(.jstree-children)").each(function(){var tmp2,tmp=tt.get_node(this);if(tmp)if(tmp.state.loaded){for(i=0,j=tmp.children_d.length;i<j;i++)if(!(tmp2=m[tmp.children_d[i]]).state.loaded&&tmp2.original&&tmp2.original.state&&tmp2.original.state.undetermined&&!0===tmp2.original.state.undetermined)for(o[tmp2.id]===undefined&&tmp2.id!==$.jstree.root&&(o[tmp2.id]=!0,p.push(tmp2.id)),k=0,l=tmp2.parents.length;k<l;k++)o[tmp2.parents[k]]===undefined&&tmp2.parents[k]!==$.jstree.root&&(o[tmp2.parents[k]]=!0,p.push(tmp2.parents[k]))}else if(tmp.original&&tmp.original.state&&tmp.original.state.undetermined&&!0===tmp.original.state.undetermined)for(o[tmp.id]===undefined&&tmp.id!==$.jstree.root&&(o[tmp.id]=!0,p.push(tmp.id)),k=0,l=tmp.parents.length;k<l;k++)o[tmp.parents[k]]===undefined&&tmp.parents[k]!==$.jstree.root&&(o[tmp.parents[k]]=!0,p.push(tmp.parents[k]))}),i=0,j=p.length;i<j;i++)m[p[i]].state[t?"selected":"checked"]||r.push(full?m[p[i]]:p[i]);return r},this._undetermined=function(){if(null!==this.element){var i,j,s,p=this.get_undetermined(!1);for(this.element.find(".jstree-undetermined").removeClass("jstree-undetermined"),i=0,j=p.length;i<j;i++)(s=this.get_node(p[i],!0))&&s.length&&s.children(".jstree-anchor").children(".jstree-checkbox").addClass("jstree-undetermined")}},this.redraw_node=function(obj,deep,is_callback,force_render){if(obj=parent.redraw_node.apply(this,arguments)){var i,j,tmp=null,icon=null;for(i=0,j=obj.childNodes.length;i<j;i++)if(obj.childNodes[i]&&obj.childNodes[i].className&&-1!==obj.childNodes[i].className.indexOf("jstree-anchor")){tmp=obj.childNodes[i];break}tmp&&(!this.settings.checkbox.tie_selection&&this._model.data[obj.id].state.checked&&(tmp.className+=" jstree-checked"),icon=_i.cloneNode(!1),this._model.data[obj.id].state.checkbox_disabled&&(icon.className+=" jstree-checkbox-disabled"),tmp.insertBefore(icon,tmp.childNodes[0]))}return is_callback||-1===this.settings.checkbox.cascade.indexOf("undetermined")||(this._data.checkbox.uto&&clearTimeout(this._data.checkbox.uto),this._data.checkbox.uto=setTimeout($.proxy(this._undetermined,this),50)),obj},this.show_checkboxes=function(){this._data.core.themes.checkboxes=!0,this.get_container_ul().removeClass("jstree-no-checkboxes")},this.hide_checkboxes=function(){this._data.core.themes.checkboxes=!1,this.get_container_ul().addClass("jstree-no-checkboxes")},this.toggle_checkboxes=function(){this._data.core.themes.checkboxes?this.hide_checkboxes():this.show_checkboxes()},this.is_undetermined=function(obj){obj=this.get_node(obj);var i,j,s=this.settings.checkbox.cascade,t=this.settings.checkbox.tie_selection,d=this._data[t?"core":"checkbox"].selected,m=this._model.data;if(!obj||!0===obj.state[t?"selected":"checked"]||-1===s.indexOf("undetermined")||-1===s.indexOf("down")&&-1===s.indexOf("up"))return!1;if(!obj.state.loaded&&!0===obj.original.state.undetermined)return!0;for(i=0,j=obj.children_d.length;i<j;i++)if(-1!==$.inArray(obj.children_d[i],d)||!m[obj.children_d[i]].state.loaded&&m[obj.children_d[i]].original.state.undetermined)return!0;return!1},this.disable_checkbox=function(obj){var t1,t2,dom;if($.isArray(obj)){for(obj=obj.slice(),t1=0,t2=obj.length;t1<t2;t1++)this.disable_checkbox(obj[t1]);return!0}if(!(obj=this.get_node(obj))||obj.id===$.jstree.root)return!1;dom=this.get_node(obj,!0),obj.state.checkbox_disabled||(obj.state.checkbox_disabled=!0,dom&&dom.length&&dom.children(".jstree-anchor").children(".jstree-checkbox").addClass("jstree-checkbox-disabled"),this.trigger("disable_checkbox",{node:obj}))},this.enable_checkbox=function(obj){var t1,t2,dom;if($.isArray(obj)){for(obj=obj.slice(),t1=0,t2=obj.length;t1<t2;t1++)this.enable_checkbox(obj[t1]);return!0}if(!(obj=this.get_node(obj))||obj.id===$.jstree.root)return!1;dom=this.get_node(obj,!0),obj.state.checkbox_disabled&&(obj.state.checkbox_disabled=!1,dom&&dom.length&&dom.children(".jstree-anchor").children(".jstree-checkbox").removeClass("jstree-checkbox-disabled"),this.trigger("enable_checkbox",{node:obj}))},this.activate_node=function(obj,e){return!$(e.target).hasClass("jstree-checkbox-disabled")&&(this.settings.checkbox.tie_selection&&(this.settings.checkbox.whole_node||$(e.target).hasClass("jstree-checkbox"))&&(e.ctrlKey=!0),this.settings.checkbox.tie_selection||!this.settings.checkbox.whole_node&&!$(e.target).hasClass("jstree-checkbox")?parent.activate_node.call(this,obj,e):!this.is_disabled(obj)&&(this.is_checked(obj)?this.uncheck_node(obj,e):this.check_node(obj,e),void this.trigger("activate_node",{node:this.get_node(obj)})))},this._cascade_new_checked_state=function(id,checkedState){var i,j,selectedChildIds,t=this.settings.checkbox.tie_selection,node=this._model.data[id],selectedNodeIds=[],selectedChildrenIds=[];if(!this.settings.checkbox.cascade_to_disabled&&node.state.disabled||!this.settings.checkbox.cascade_to_hidden&&node.state.hidden)selectedChildIds=this.get_checked_descendants(id),node.state[t?"selected":"checked"]&&selectedChildIds.push(node.id),selectedNodeIds=selectedNodeIds.concat(selectedChildIds);else{if(node.children)for(i=0,j=node.children.length;i<j;i++){var childId=node.children[i];selectedChildIds=this._cascade_new_checked_state(childId,checkedState),selectedNodeIds=selectedNodeIds.concat(selectedChildIds),selectedChildIds.indexOf(childId)>-1&&selectedChildrenIds.push(childId)}var dom=this.get_node(node,!0),undetermined=selectedChildrenIds.length>0&&selectedChildrenIds.length<node.children.length;node.original&&node.original.state&&node.original.state.undetermined&&(node.original.state.undetermined=undetermined),undetermined?(node.state[t?"selected":"checked"]=!1,dom.attr("aria-selected",!1).children(".jstree-anchor").removeClass(t?"jstree-clicked":"jstree-checked")):checkedState&&selectedChildrenIds.length===node.children.length?(node.state[t?"selected":"checked"]=checkedState,selectedNodeIds.push(node.id),dom.attr("aria-selected",!0).children(".jstree-anchor").addClass(t?"jstree-clicked":"jstree-checked")):(node.state[t?"selected":"checked"]=!1,dom.attr("aria-selected",!1).children(".jstree-anchor").removeClass(t?"jstree-clicked":"jstree-checked"))}return selectedNodeIds},this.get_checked_descendants=function(id){var self=this,t=self.settings.checkbox.tie_selection,node=self._model.data[id];return node.children_d.filter(function(_id){return self._model.data[_id].state[t?"selected":"checked"]})},this.check_node=function(obj,e){if(this.settings.checkbox.tie_selection)return this.select_node(obj,!1,!0,e);var dom,t1,t2;if($.isArray(obj)){for(obj=obj.slice(),t1=0,t2=obj.length;t1<t2;t1++)this.check_node(obj[t1],e);return!0}if(!(obj=this.get_node(obj))||obj.id===$.jstree.root)return!1;dom=this.get_node(obj,!0),obj.state.checked||(obj.state.checked=!0,this._data.checkbox.selected.push(obj.id),dom&&dom.length&&dom.children(".jstree-anchor").addClass("jstree-checked"),this.trigger("check_node",{node:obj,selected:this._data.checkbox.selected,event:e}))},this.uncheck_node=function(obj,e){if(this.settings.checkbox.tie_selection)return this.deselect_node(obj,!1,e);var t1,t2,dom;if($.isArray(obj)){for(obj=obj.slice(),t1=0,t2=obj.length;t1<t2;t1++)this.uncheck_node(obj[t1],e);return!0}if(!(obj=this.get_node(obj))||obj.id===$.jstree.root)return!1;dom=this.get_node(obj,!0),obj.state.checked&&(obj.state.checked=!1,this._data.checkbox.selected=$.vakata.array_remove_item(this._data.checkbox.selected,obj.id),dom.length&&dom.children(".jstree-anchor").removeClass("jstree-checked"),this.trigger("uncheck_node",{node:obj,selected:this._data.checkbox.selected,event:e}))},this.check_all=function(){if(this.settings.checkbox.tie_selection)return this.select_all();var i,j;this._data.checkbox.selected.concat([]);for(this._data.checkbox.selected=this._model.data[$.jstree.root].children_d.concat(),i=0,j=this._data.checkbox.selected.length;i<j;i++)this._model.data[this._data.checkbox.selected[i]]&&(this._model.data[this._data.checkbox.selected[i]].state.checked=!0);this.redraw(!0),this.trigger("check_all",{selected:this._data.checkbox.selected})},this.uncheck_all=function(){if(this.settings.checkbox.tie_selection)return this.deselect_all();var i,j,tmp=this._data.checkbox.selected.concat([]);for(i=0,j=this._data.checkbox.selected.length;i<j;i++)this._model.data[this._data.checkbox.selected[i]]&&(this._model.data[this._data.checkbox.selected[i]].state.checked=!1);this._data.checkbox.selected=[],this.element.find(".jstree-checked").removeClass("jstree-checked"),this.trigger("uncheck_all",{selected:this._data.checkbox.selected,node:tmp})},this.is_checked=function(obj){return this.settings.checkbox.tie_selection?this.is_selected(obj):!(!(obj=this.get_node(obj))||obj.id===$.jstree.root)&&obj.state.checked},this.get_checked=function(full){return this.settings.checkbox.tie_selection?this.get_selected(full):full?$.map(this._data.checkbox.selected,$.proxy(function(i){return this.get_node(i)},this)):this._data.checkbox.selected},this.get_top_checked=function(full){if(this.settings.checkbox.tie_selection)return this.get_top_selected(full);var i,j,k,l,tmp=this.get_checked(!0),obj={};for(i=0,j=tmp.length;i<j;i++)obj[tmp[i].id]=tmp[i];for(i=0,j=tmp.length;i<j;i++)for(k=0,l=tmp[i].children_d.length;k<l;k++)obj[tmp[i].children_d[k]]&&delete obj[tmp[i].children_d[k]];for(i in tmp=[],obj)obj.hasOwnProperty(i)&&tmp.push(i);return full?$.map(tmp,$.proxy(function(i){return this.get_node(i)},this)):tmp},this.get_bottom_checked=function(full){if(this.settings.checkbox.tie_selection)return this.get_bottom_selected(full);var i,j,tmp=this.get_checked(!0),obj=[];for(i=0,j=tmp.length;i<j;i++)tmp[i].children.length||obj.push(tmp[i].id);return full?$.map(obj,$.proxy(function(i){return this.get_node(i)},this)):obj},this.load_node=function(obj,callback){var k,l,tmp;if(!$.isArray(obj)&&!this.settings.checkbox.tie_selection&&(tmp=this.get_node(obj))&&tmp.state.loaded)for(k=0,l=tmp.children_d.length;k<l;k++)this._model.data[tmp.children_d[k]].state.checked&&(!0,this._data.checkbox.selected=$.vakata.array_remove_item(this._data.checkbox.selected,tmp.children_d[k]));return parent.load_node.apply(this,arguments)},this.get_state=function(){var state=parent.get_state.apply(this,arguments);return this.settings.checkbox.tie_selection?state:(state.checkbox=this._data.checkbox.selected.slice(),state)},this.set_state=function(state,callback){var res=parent.set_state.apply(this,arguments);if(res&&state.checkbox){if(!this.settings.checkbox.tie_selection){this.uncheck_all();var _this=this;$.each(state.checkbox,function(i,v){_this.check_node(v)})}return delete state.checkbox,this.set_state(state,callback),!1}return res},this.refresh=function(skip_loading,forget_state){return this.settings.checkbox.tie_selection&&(this._data.checkbox.selected=[]),parent.refresh.apply(this,arguments)}},$.jstree.defaults.conditionalselect=function(){return!0},$.jstree.plugins.conditionalselect=function(options,parent){this.activate_node=function(obj,e){if(this.settings.conditionalselect.call(this,this.get_node(obj),e))return parent.activate_node.call(this,obj,e)}},$.jstree.defaults.contextmenu={select_node:!0,show_at_node:!0,items:function(o,cb){return{create:{separator_before:!1,separator_after:!0,_disabled:!1,label:"Create",action:function(data){var inst=$.jstree.reference(data.reference),obj=inst.get_node(data.reference);inst.create_node(obj,{},"last",function(new_node){try{inst.edit(new_node)}catch(ex){setTimeout(function(){inst.edit(new_node)},0)}})}},rename:{separator_before:!1,separator_after:!1,_disabled:!1,label:"Rename",action:function(data){var inst=$.jstree.reference(data.reference),obj=inst.get_node(data.reference);inst.edit(obj)}},remove:{separator_before:!1,icon:!1,separator_after:!1,_disabled:!1,label:"Delete",action:function(data){var inst=$.jstree.reference(data.reference),obj=inst.get_node(data.reference);inst.is_selected(obj)?inst.delete_node(inst.get_selected()):inst.delete_node(obj)}},ccp:{separator_before:!0,icon:!1,separator_after:!1,label:"Edit",action:!1,submenu:{cut:{separator_before:!1,separator_after:!1,label:"Cut",action:function(data){var inst=$.jstree.reference(data.reference),obj=inst.get_node(data.reference);inst.is_selected(obj)?inst.cut(inst.get_top_selected()):inst.cut(obj)}},copy:{separator_before:!1,icon:!1,separator_after:!1,label:"Copy",action:function(data){var inst=$.jstree.reference(data.reference),obj=inst.get_node(data.reference);inst.is_selected(obj)?inst.copy(inst.get_top_selected()):inst.copy(obj)}},paste:{separator_before:!1,icon:!1,_disabled:function(data){return!$.jstree.reference(data.reference).can_paste()},separator_after:!1,label:"Paste",action:function(data){var inst=$.jstree.reference(data.reference),obj=inst.get_node(data.reference);inst.paste(obj)}}}}}}},$.jstree.plugins.contextmenu=function(options,parent){this.bind=function(){parent.bind.call(this);var ex,ey,last_ts=0,cto=null;this.element.on("init.jstree loading.jstree ready.jstree",$.proxy(function(){this.get_container_ul().addClass("jstree-contextmenu")},this)).on("contextmenu.jstree",".jstree-anchor",$.proxy(function(e,data){"input"!==e.target.tagName.toLowerCase()&&(e.preventDefault(),last_ts=e.ctrlKey?+new Date:0,(data||cto)&&(last_ts=+new Date+1e4),cto&&clearTimeout(cto),this.is_loading(e.currentTarget)||this.show_contextmenu(e.currentTarget,e.pageX,e.pageY,e))},this)).on("click.jstree",".jstree-anchor",$.proxy(function(e){this._data.contextmenu.visible&&(!last_ts||+new Date-last_ts>250)&&$.vakata.context.hide(),last_ts=0},this)).on("touchstart.jstree",".jstree-anchor",function(e){e.originalEvent&&e.originalEvent.changedTouches&&e.originalEvent.changedTouches[0]&&(ex=e.originalEvent.changedTouches[0].clientX,ey=e.originalEvent.changedTouches[0].clientY,cto=setTimeout(function(){$(e.currentTarget).trigger("contextmenu",!0)},750))}).on("touchmove.vakata.jstree",function(e){cto&&e.originalEvent&&e.originalEvent.changedTouches&&e.originalEvent.changedTouches[0]&&(Math.abs(ex-e.originalEvent.changedTouches[0].clientX)>10||Math.abs(ey-e.originalEvent.changedTouches[0].clientY)>10)&&(clearTimeout(cto),$.vakata.context.hide())}).on("touchend.vakata.jstree",function(e){cto&&clearTimeout(cto)}),$(document).on("context_hide.vakata.jstree",$.proxy(function(e,data){this._data.contextmenu.visible=!1,$(data.reference).removeClass("jstree-context")},this))},this.teardown=function(){this._data.contextmenu.visible&&$.vakata.context.hide(),parent.teardown.call(this)},this.show_contextmenu=function(obj,x,y,e){if(!(obj=this.get_node(obj))||obj.id===$.jstree.root)return!1;var s=this.settings.contextmenu,d=this.get_node(obj,!0),a=d.children(".jstree-anchor"),o=!1,i=!1;(s.show_at_node||x===undefined||y===undefined)&&(o=a.offset(),x=o.left,y=o.top+this._data.core.li_height),this.settings.contextmenu.select_node&&!this.is_selected(obj)&&this.activate_node(obj,e),i=s.items,$.isFunction(i)&&(i=i.call(this,obj,$.proxy(function(i){this._show_contextmenu(obj,x,y,i)},this))),$.isPlainObject(i)&&this._show_contextmenu(obj,x,y,i)},this._show_contextmenu=function(obj,x,y,i){var d=this.get_node(obj,!0),a=d.children(".jstree-anchor");$(document).one("context_show.vakata.jstree",$.proxy(function(e,data){var cls="jstree-contextmenu jstree-"+this.get_theme()+"-contextmenu";$(data.element).addClass(cls),a.addClass("jstree-context")},this)),this._data.contextmenu.visible=!0,$.vakata.context.show(a,{x:x,y:y},i),this.trigger("show_contextmenu",{node:obj,x:x,y:y})}},function($){var right_to_left=!1,vakata_context={element:!1,reference:!1,position_x:0,position_y:0,items:[],html:"",is_visible:!1};$.vakata.context={settings:{hide_onmouseleave:0,icons:!0},_trigger:function(event_name){$(document).triggerHandler("context_"+event_name+".vakata",{reference:vakata_context.reference,element:vakata_context.element,position:{x:vakata_context.position_x,y:vakata_context.position_y}})},_execute:function(i){return!(!(i=vakata_context.items[i])||i._disabled&&(!$.isFunction(i._disabled)||i._disabled({item:i,reference:vakata_context.reference,element:vakata_context.element}))||!i.action)&&i.action.call(null,{item:i,reference:vakata_context.reference,element:vakata_context.element,position:{x:vakata_context.position_x,y:vakata_context.position_y}})},_parse:function(o,is_callback){if(!o)return!1;is_callback||(vakata_context.html="",vakata_context.items=[]);var tmp,str="",sep=!1;return is_callback&&(str+="<ul>"),$.each(o,function(i,val){if(!val)return!0;vakata_context.items.push(val),!sep&&val.separator_before&&(str+="<li class='vakata-context-separator'><a href='#' "+($.vakata.context.settings.icons?"":'style="margin-left:0px;"')+">&#160;</a></li>"),sep=!1,str+="<li class='"+(val._class||"")+(!0===val._disabled||$.isFunction(val._disabled)&&val._disabled({item:val,reference:vakata_context.reference,element:vakata_context.element})?" vakata-contextmenu-disabled ":"")+"' "+(val.shortcut?" data-shortcut='"+val.shortcut+"' ":"")+">",str+="<a href='#' rel='"+(vakata_context.items.length-1)+"' "+(val.title?"title='"+val.title+"'":"")+">",$.vakata.context.settings.icons&&(str+="<i ",val.icon&&(-1!==val.icon.indexOf("/")||-1!==val.icon.indexOf(".")?str+=" style='background:url(\""+val.icon+"\") center center no-repeat' ":str+=" class='"+val.icon+"' "),str+="></i><span class='vakata-contextmenu-sep'>&#160;</span>"),str+=($.isFunction(val.label)?val.label({item:i,reference:vakata_context.reference,element:vakata_context.element}):val.label)+(val.shortcut?' <span class="vakata-contextmenu-shortcut vakata-contextmenu-shortcut-'+val.shortcut+'">'+(val.shortcut_label||"")+"</span>":"")+"</a>",val.submenu&&(tmp=$.vakata.context._parse(val.submenu,!0))&&(str+=tmp),str+="</li>",val.separator_after&&(str+="<li class='vakata-context-separator'><a href='#' "+($.vakata.context.settings.icons?"":'style="margin-left:0px;"')+">&#160;</a></li>",sep=!0)}),str=str.replace(/<li class\='vakata-context-separator'\><\/li\>$/,""),is_callback&&(str+="</ul>"),is_callback||(vakata_context.html=str,$.vakata.context._trigger("parse")),str.length>10&&str},_show_submenu:function(o){if((o=$(o)).length&&o.children("ul").length){var e=o.children("ul"),xl=o.offset().left,x=xl+o.outerWidth(),y=o.offset().top,w=e.width(),h=e.height(),dw=$(window).width()+$(window).scrollLeft(),dh=$(window).height()+$(window).scrollTop();right_to_left?o[x-(w+10+o.outerWidth())<0?"addClass":"removeClass"]("vakata-context-left"):o[x+w>dw&&xl>dw-x?"addClass":"removeClass"]("vakata-context-right"),y+h+10>dh&&e.css("bottom","-1px"),o.hasClass("vakata-context-right")?xl<w&&e.css("margin-right",xl-w):dw-x<w&&e.css("margin-left",dw-x-w),e.show()}},show:function(reference,position,data){var o,e,x,y,w,h,dw,dh;switch(vakata_context.element&&vakata_context.element.length&&vakata_context.element.width(""),!0){case!position&&!reference:return!1;case!!position&&!!reference:vakata_context.reference=reference,vakata_context.position_x=position.x,vakata_context.position_y=position.y;break;case!position&&!!reference:vakata_context.reference=reference,o=reference.offset(),vakata_context.position_x=o.left+reference.outerHeight(),vakata_context.position_y=o.top;break;case!!position&&!reference:vakata_context.position_x=position.x,vakata_context.position_y=position.y}reference&&!data&&$(reference).data("vakata_contextmenu")&&(data=$(reference).data("vakata_contextmenu")),$.vakata.context._parse(data)&&vakata_context.element.html(vakata_context.html),vakata_context.items.length&&(vakata_context.element.appendTo(document.body),e=vakata_context.element,x=vakata_context.position_x,y=vakata_context.position_y,w=e.width(),h=e.height(),dw=$(window).width()+$(window).scrollLeft(),dh=$(window).height()+$(window).scrollTop(),right_to_left&&(x-=e.outerWidth()-$(reference).outerWidth())<$(window).scrollLeft()+20&&(x=$(window).scrollLeft()+20),x+w+20>dw&&(x=dw-(w+20)),y+h+20>dh&&(y=dh-(h+20)),vakata_context.element.css({left:x,top:y}).show().find("a").first().focus().parent().addClass("vakata-context-hover"),vakata_context.is_visible=!0,$.vakata.context._trigger("show"))},hide:function(){vakata_context.is_visible&&(vakata_context.element.hide().find("ul").hide().end().find(":focus").blur().end().detach(),vakata_context.is_visible=!1,$.vakata.context._trigger("hide"))}},$(function(){right_to_left="rtl"===$(document.body).css("direction");var to=!1;vakata_context.element=$("<ul class='vakata-context'></ul>"),vakata_context.element.on("mouseenter","li",function(e){e.stopImmediatePropagation(),$.contains(this,e.relatedTarget)||(to&&clearTimeout(to),vakata_context.element.find(".vakata-context-hover").removeClass("vakata-context-hover").end(),$(this).siblings().find("ul").hide().end().end().parentsUntil(".vakata-context","li").addBack().addClass("vakata-context-hover"),$.vakata.context._show_submenu(this))}).on("mouseleave","li",function(e){$.contains(this,e.relatedTarget)||$(this).find(".vakata-context-hover").addBack().removeClass("vakata-context-hover")}).on("mouseleave",function(e){$(this).find(".vakata-context-hover").removeClass("vakata-context-hover"),$.vakata.context.settings.hide_onmouseleave&&(to=setTimeout(function(){$.vakata.context.hide()},$.vakata.context.settings.hide_onmouseleave))}).on("click","a",function(e){e.preventDefault(),$(this).blur().parent().hasClass("vakata-context-disabled")||!1===$.vakata.context._execute($(this).attr("rel"))||$.vakata.context.hide()}).on("keydown","a",function(e){var o=null;switch(e.which){case 13:case 32:e.type="click",e.preventDefault(),$(e.currentTarget).trigger(e);break;case 37:vakata_context.is_visible&&(vakata_context.element.find(".vakata-context-hover").last().closest("li").first().find("ul").hide().find(".vakata-context-hover").removeClass("vakata-context-hover").end().end().children("a").focus(),e.stopImmediatePropagation(),e.preventDefault());break;case 38:vakata_context.is_visible&&((o=vakata_context.element.find("ul:visible").addBack().last().children(".vakata-context-hover").removeClass("vakata-context-hover").prevAll("li:not(.vakata-context-separator)").first()).length||(o=vakata_context.element.find("ul:visible").addBack().last().children("li:not(.vakata-context-separator)").last()),o.addClass("vakata-context-hover").children("a").focus(),e.stopImmediatePropagation(),e.preventDefault());break;case 39:vakata_context.is_visible&&(vakata_context.element.find(".vakata-context-hover").last().children("ul").show().children("li:not(.vakata-context-separator)").removeClass("vakata-context-hover").first().addClass("vakata-context-hover").children("a").focus(),e.stopImmediatePropagation(),e.preventDefault());break;case 40:vakata_context.is_visible&&((o=vakata_context.element.find("ul:visible").addBack().last().children(".vakata-context-hover").removeClass("vakata-context-hover").nextAll("li:not(.vakata-context-separator)").first()).length||(o=vakata_context.element.find("ul:visible").addBack().last().children("li:not(.vakata-context-separator)").first()),o.addClass("vakata-context-hover").children("a").focus(),e.stopImmediatePropagation(),e.preventDefault());break;case 27:$.vakata.context.hide(),e.preventDefault()}}).on("keydown",function(e){e.preventDefault();var a=vakata_context.element.find(".vakata-contextmenu-shortcut-"+e.which).parent();a.parent().not(".vakata-context-disabled")&&a.click()}),$(document).on("mousedown.vakata.jstree",function(e){vakata_context.is_visible&&vakata_context.element[0]!==e.target&&!$.contains(vakata_context.element[0],e.target)&&$.vakata.context.hide()}).on("context_show.vakata.jstree",function(e,data){vakata_context.element.find("li:has(ul)").children("a").addClass("vakata-context-parent"),right_to_left&&vakata_context.element.addClass("vakata-context-rtl").css("direction","rtl"),vakata_context.element.find("ul").hide().end()})})}($),$.jstree.defaults.dnd={copy:!0,open_timeout:500,is_draggable:!0,check_while_dragging:!0,always_copy:!1,inside_pos:0,drag_selection:!0,touch:!0,large_drop_target:!1,large_drag_target:!1,use_html5:!1},$.jstree.plugins.dnd=function(options,parent){this.init=function(el,options){parent.init.call(this,el,options),this.settings.dnd.use_html5=this.settings.dnd.use_html5&&"draggable"in document.createElement("span")},this.bind=function(){parent.bind.call(this),this.element.on(this.settings.dnd.use_html5?"dragstart.jstree":"mousedown.jstree touchstart.jstree",this.settings.dnd.large_drag_target?".jstree-node":".jstree-anchor",$.proxy(function(e){if(this.settings.dnd.large_drag_target&&$(e.target).closest(".jstree-node")[0]!==e.currentTarget)return!0;if("touchstart"===e.type&&(!this.settings.dnd.touch||"selected"===this.settings.dnd.touch&&!$(e.currentTarget).closest(".jstree-node").children(".jstree-anchor").hasClass("jstree-clicked")))return!0;var obj=this.get_node(e.target),mlt=this.is_selected(obj)&&this.settings.dnd.drag_selection?this.get_top_selected().length:1,txt=mlt>1?mlt+" "+this.get_string("nodes"):this.get_text(e.currentTarget);if(this.settings.core.force_text&&(txt=$.vakata.html.escape(txt)),obj&&obj.id&&obj.id!==$.jstree.root&&(1===e.which||"touchstart"===e.type||"dragstart"===e.type)&&(!0===this.settings.dnd.is_draggable||$.isFunction(this.settings.dnd.is_draggable)&&this.settings.dnd.is_draggable.call(this,mlt>1?this.get_top_selected(!0):[obj],e))){if(drg={jstree:!0,origin:this,obj:this.get_node(obj,!0),nodes:mlt>1?this.get_top_selected():[obj.id]},elm=e.currentTarget,!this.settings.dnd.use_html5)return this.element.trigger("mousedown.jstree"),$.vakata.dnd.start(e,drg,'<div id="jstree-dnd" class="jstree-'+this.get_theme()+" jstree-"+this.get_theme()+"-"+this.get_theme_variant()+" "+(this.settings.core.themes.responsive?" jstree-dnd-responsive":"")+'"><i class="jstree-icon jstree-er"></i>'+txt+'<ins class="jstree-copy" style="display:none;">+</ins></div>');$.vakata.dnd._trigger("start",e,{helper:$(),element:elm,data:drg})}},this)),this.settings.dnd.use_html5&&this.element.on("dragover.jstree",function(e){return e.preventDefault(),$.vakata.dnd._trigger("move",e,{helper:$(),element:elm,data:drg}),!1}).on("drop.jstree",$.proxy(function(e){return e.preventDefault(),$.vakata.dnd._trigger("stop",e,{helper:$(),element:elm,data:drg}),!1},this))},this.redraw_node=function(obj,deep,callback,force_render){if((obj=parent.redraw_node.apply(this,arguments))&&this.settings.dnd.use_html5)if(this.settings.dnd.large_drag_target)obj.setAttribute("draggable",!0);else{var i,j,tmp=null;for(i=0,j=obj.childNodes.length;i<j;i++)if(obj.childNodes[i]&&obj.childNodes[i].className&&-1!==obj.childNodes[i].className.indexOf("jstree-anchor")){tmp=obj.childNodes[i];break}tmp&&tmp.setAttribute("draggable",!0)}return obj}},$(function(){var lastmv=!1,laster=!1,lastev=!1,opento=!1,marker=$('<div id="jstree-marker">&#160;</div>').hide();$(document).on("dragover.vakata.jstree",function(e){elm&&$.vakata.dnd._trigger("move",e,{helper:$(),element:elm,data:drg})}).on("drop.vakata.jstree",function(e){elm&&($.vakata.dnd._trigger("stop",e,{helper:$(),element:elm,data:drg}),elm=null,drg=null)}).on("dnd_start.vakata.jstree",function(e,data){lastmv=!1,lastev=!1,data&&data.data&&data.data.jstree&&marker.appendTo(document.body)}).on("dnd_move.vakata.jstree",function(e,data){var isDifferentNode=data.event.target!==lastev.target;if(opento&&(data.event&&"dragover"===data.event.type&&!isDifferentNode||clearTimeout(opento)),data&&data.data&&data.data.jstree&&(!data.event.target.id||"jstree-marker"!==data.event.target.id)){lastev=data.event;var l,t,h,p,i,o,ok,t1,t2,op,ps,pr,ip,tm,is_copy,pn,ins=$.jstree.reference(data.event.target),ref=!1,off=!1,rel=!1;if(ins&&ins._data&&ins._data.dnd)if(marker.attr("class","jstree-"+ins.get_theme()+(ins.settings.core.themes.responsive?" jstree-dnd-responsive":"")),is_copy=data.data.origin&&(data.data.origin.settings.dnd.always_copy||data.data.origin.settings.dnd.copy&&(data.event.metaKey||data.event.ctrlKey)),data.helper.children().attr("class","jstree-"+ins.get_theme()+" jstree-"+ins.get_theme()+"-"+ins.get_theme_variant()+" "+(ins.settings.core.themes.responsive?" jstree-dnd-responsive":"")).find(".jstree-copy").first()[is_copy?"show":"hide"](),data.event.target!==ins.element[0]&&data.event.target!==ins.get_container_ul()[0]||0!==ins.get_container_ul().children().length){if((ref=ins.settings.dnd.large_drop_target?$(data.event.target).closest(".jstree-node").children(".jstree-anchor"):$(data.event.target).closest(".jstree-anchor"))&&ref.length&&ref.parent().is(".jstree-closed, .jstree-open, .jstree-leaf")&&(off=ref.offset(),rel=(data.event.pageY!==undefined?data.event.pageY:data.event.originalEvent.pageY)-off.top,h=ref.outerHeight(),o=rel<h/3?["b","i","a"]:rel>h-h/3?["a","i","b"]:rel>h/2?["i","a","b"]:["i","b","a"],$.each(o,function(j,v){switch(v){case"b":l=off.left-6,t=off.top,p=ins.get_parent(ref),i=ref.parent().index();break;case"i":ip=ins.settings.dnd.inside_pos,tm=ins.get_node(ref.parent()),l=off.left-2,t=off.top+h/2+1,p=tm.id,i="first"===ip?0:"last"===ip?tm.children.length:Math.min(ip,tm.children.length);break;case"a":l=off.left-6,t=off.top+h,p=ins.get_parent(ref),i=ref.parent().index()+1}for(ok=!0,t1=0,t2=data.data.nodes.length;t1<t2;t1++)if(op=data.data.origin&&(data.data.origin.settings.dnd.always_copy||data.data.origin.settings.dnd.copy&&(data.event.metaKey||data.event.ctrlKey))?"copy_node":"move_node",ps=i,"move_node"===op&&"a"===v&&data.data.origin&&data.data.origin===ins&&p===ins.get_parent(data.data.nodes[t1])&&(pr=ins.get_node(p),ps>$.inArray(data.data.nodes[t1],pr.children)&&(ps-=1)),!(ok=ok&&(ins&&ins.settings&&ins.settings.dnd&&!1===ins.settings.dnd.check_while_dragging||ins.check(op,data.data.origin&&data.data.origin!==ins?data.data.origin.get_node(data.data.nodes[t1]):data.data.nodes[t1],p,ps,{dnd:!0,ref:ins.get_node(ref.parent()),pos:v,origin:data.data.origin,is_multi:data.data.origin&&data.data.origin!==ins,is_foreign:!data.data.origin})))){ins&&ins.last_error&&(laster=ins.last_error());break}var x,z;if("i"===v&&ref.parent().is(".jstree-closed")&&ins.settings.dnd.open_timeout&&(data.event&&"dragover"===data.event.type&&!isDifferentNode||(opento&&clearTimeout(opento),opento=setTimeout((x=ins,z=ref,function(){x.open_node(z)}),ins.settings.dnd.open_timeout))),ok)return(pn=ins.get_node(p,!0)).hasClass(".jstree-dnd-parent")||($(".jstree-dnd-parent").removeClass("jstree-dnd-parent"),pn.addClass("jstree-dnd-parent")),lastmv={ins:ins,par:p,pos:"i"!==v||"last"!==ip||0!==i||ins.is_loaded(tm)?i:"last"},marker.css({left:l+"px",top:t+"px"}).show(),data.helper.find(".jstree-icon").first().removeClass("jstree-er").addClass("jstree-ok"),data.event.originalEvent&&data.event.originalEvent.dataTransfer&&(data.event.originalEvent.dataTransfer.dropEffect=is_copy?"copy":"move"),laster={},o=!0,!1}),!0===o))return}else{for(ok=!0,t1=0,t2=data.data.nodes.length;t1<t2&&(ok=ok&&ins.check(data.data.origin&&(data.data.origin.settings.dnd.always_copy||data.data.origin.settings.dnd.copy&&(data.event.metaKey||data.event.ctrlKey))?"copy_node":"move_node",data.data.origin&&data.data.origin!==ins?data.data.origin.get_node(data.data.nodes[t1]):data.data.nodes[t1],$.jstree.root,"last",{dnd:!0,ref:ins.get_node($.jstree.root),pos:"i",origin:data.data.origin,is_multi:data.data.origin&&data.data.origin!==ins,is_foreign:!data.data.origin}));t1++);if(ok)return lastmv={ins:ins,par:$.jstree.root,pos:"last"},marker.hide(),data.helper.find(".jstree-icon").first().removeClass("jstree-er").addClass("jstree-ok"),void(data.event.originalEvent&&data.event.originalEvent.dataTransfer&&(data.event.originalEvent.dataTransfer.dropEffect=is_copy?"copy":"move"))}$(".jstree-dnd-parent").removeClass("jstree-dnd-parent"),lastmv=!1,data.helper.find(".jstree-icon").removeClass("jstree-ok").addClass("jstree-er"),data.event.originalEvent&&data.event.originalEvent.dataTransfer,marker.hide()}}).on("dnd_scroll.vakata.jstree",function(e,data){data&&data.data&&data.data.jstree&&(marker.hide(),lastmv=!1,lastev=!1,data.helper.find(".jstree-icon").first().removeClass("jstree-ok").addClass("jstree-er"))}).on("dnd_stop.vakata.jstree",function(e,data){if($(".jstree-dnd-parent").removeClass("jstree-dnd-parent"),opento&&clearTimeout(opento),data&&data.data&&data.data.jstree){marker.hide().detach();var i,j,nodes=[];if(lastmv){for(i=0,j=data.data.nodes.length;i<j;i++)nodes[i]=data.data.origin?data.data.origin.get_node(data.data.nodes[i]):data.data.nodes[i];lastmv.ins[data.data.origin&&(data.data.origin.settings.dnd.always_copy||data.data.origin.settings.dnd.copy&&(data.event.metaKey||data.event.ctrlKey))?"copy_node":"move_node"](nodes,lastmv.par,lastmv.pos,!1,!1,!1,data.data.origin)}else(i=$(data.event.target).closest(".jstree")).length&&laster&&laster.error&&"check"===laster.error&&(i=i.jstree(!0))&&i.settings.core.error.call(this,laster);lastev=!1,lastmv=!1}}).on("keyup.jstree keydown.jstree",function(e,data){(data=$.vakata.dnd._get())&&data.data&&data.data.jstree&&("keyup"===e.type&&27===e.which?(opento&&clearTimeout(opento),lastmv=!1,laster=!1,lastev=!1,opento=!1,marker.hide().detach(),$.vakata.dnd._clean()):(data.helper.find(".jstree-copy").first()[data.data.origin&&(data.data.origin.settings.dnd.always_copy||data.data.origin.settings.dnd.copy&&(e.metaKey||e.ctrlKey))?"show":"hide"](),lastev&&(lastev.metaKey=e.metaKey,lastev.ctrlKey=e.ctrlKey,$.vakata.dnd._trigger("move",lastev))))})}),function($){$.vakata.html={div:$("<div />"),escape:function(str){return $.vakata.html.div.text(str).html()},strip:function(str){return $.vakata.html.div.empty().append($.parseHTML(str)).text()}};var vakata_dnd={element:!1,target:!1,is_down:!1,is_drag:!1,helper:!1,helper_w:0,data:!1,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:!1,scroll_i:!1,is_touch:!1};$.vakata.dnd={settings:{scroll_speed:10,scroll_proximity:20,helper_left:5,helper_top:10,threshold:5,threshold_touch:10},_trigger:function(event_name,e,data){data===undefined&&(data=$.vakata.dnd._get()),data.event=e,$(document).triggerHandler("dnd_"+event_name+".vakata",data)},_get:function(){return{data:vakata_dnd.data,element:vakata_dnd.element,helper:vakata_dnd.helper}},_clean:function(){vakata_dnd.helper&&vakata_dnd.helper.remove(),vakata_dnd.scroll_i&&(clearInterval(vakata_dnd.scroll_i),vakata_dnd.scroll_i=!1),vakata_dnd={element:!1,target:!1,is_down:!1,is_drag:!1,helper:!1,helper_w:0,data:!1,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:!1,scroll_i:!1,is_touch:!1},$(document).off("mousemove.vakata.jstree touchmove.vakata.jstree",$.vakata.dnd.drag),$(document).off("mouseup.vakata.jstree touchend.vakata.jstree",$.vakata.dnd.stop)},_scroll:function(init_only){if(!vakata_dnd.scroll_e||!vakata_dnd.scroll_l&&!vakata_dnd.scroll_t)return vakata_dnd.scroll_i&&(clearInterval(vakata_dnd.scroll_i),vakata_dnd.scroll_i=!1),!1;if(!vakata_dnd.scroll_i)return vakata_dnd.scroll_i=setInterval($.vakata.dnd._scroll,100),!1;if(!0===init_only)return!1;var i=vakata_dnd.scroll_e.scrollTop(),j=vakata_dnd.scroll_e.scrollLeft();vakata_dnd.scroll_e.scrollTop(i+vakata_dnd.scroll_t*$.vakata.dnd.settings.scroll_speed),vakata_dnd.scroll_e.scrollLeft(j+vakata_dnd.scroll_l*$.vakata.dnd.settings.scroll_speed),i===vakata_dnd.scroll_e.scrollTop()&&j===vakata_dnd.scroll_e.scrollLeft()||$.vakata.dnd._trigger("scroll",vakata_dnd.scroll_e)},start:function(e,data,html){"touchstart"===e.type&&e.originalEvent&&e.originalEvent.changedTouches&&e.originalEvent.changedTouches[0]&&(e.pageX=e.originalEvent.changedTouches[0].pageX,e.pageY=e.originalEvent.changedTouches[0].pageY,e.target=document.elementFromPoint(e.originalEvent.changedTouches[0].pageX-window.pageXOffset,e.originalEvent.changedTouches[0].pageY-window.pageYOffset)),vakata_dnd.is_drag&&$.vakata.dnd.stop({});try{e.currentTarget.unselectable="on",e.currentTarget.onselectstart=function(){return!1},e.currentTarget.style&&(e.currentTarget.style.touchAction="none",e.currentTarget.style.msTouchAction="none",e.currentTarget.style.MozUserSelect="none")}catch(ignore){}return vakata_dnd.init_x=e.pageX,vakata_dnd.init_y=e.pageY,vakata_dnd.data=data,vakata_dnd.is_down=!0,vakata_dnd.element=e.currentTarget,vakata_dnd.target=e.target,vakata_dnd.is_touch="touchstart"===e.type,!1!==html&&(vakata_dnd.helper=$("<div id='vakata-dnd'></div>").html(html).css({display:"block",margin:"0",padding:"0",position:"absolute",top:"-2000px",lineHeight:"16px",zIndex:"10000"})),$(document).on("mousemove.vakata.jstree touchmove.vakata.jstree",$.vakata.dnd.drag),$(document).on("mouseup.vakata.jstree touchend.vakata.jstree",$.vakata.dnd.stop),!1},drag:function(e){if("touchmove"===e.type&&e.originalEvent&&e.originalEvent.changedTouches&&e.originalEvent.changedTouches[0]&&(e.pageX=e.originalEvent.changedTouches[0].pageX,e.pageY=e.originalEvent.changedTouches[0].pageY,e.target=document.elementFromPoint(e.originalEvent.changedTouches[0].pageX-window.pageXOffset,e.originalEvent.changedTouches[0].pageY-window.pageYOffset)),vakata_dnd.is_down){if(!vakata_dnd.is_drag){if(!(Math.abs(e.pageX-vakata_dnd.init_x)>(vakata_dnd.is_touch?$.vakata.dnd.settings.threshold_touch:$.vakata.dnd.settings.threshold)||Math.abs(e.pageY-vakata_dnd.init_y)>(vakata_dnd.is_touch?$.vakata.dnd.settings.threshold_touch:$.vakata.dnd.settings.threshold)))return;vakata_dnd.helper&&(vakata_dnd.helper.appendTo(document.body),vakata_dnd.helper_w=vakata_dnd.helper.outerWidth()),vakata_dnd.is_drag=!0,$(vakata_dnd.target).one("click.vakata",!1),$.vakata.dnd._trigger("start",e)}var d=!1,w=!1,dh=!1,wh=!1,dw=!1,ww=!1,dt=!1,dl=!1,ht=!1,hl=!1;return vakata_dnd.scroll_t=0,vakata_dnd.scroll_l=0,vakata_dnd.scroll_e=!1,$($(e.target).parentsUntil("body").addBack().get().reverse()).filter(function(){return/^auto|scroll$/.test($(this).css("overflow"))&&(this.scrollHeight>this.offsetHeight||this.scrollWidth>this.offsetWidth)}).each(function(){var t=$(this),o=t.offset();if(this.scrollHeight>this.offsetHeight&&(o.top+t.height()-e.pageY<$.vakata.dnd.settings.scroll_proximity&&(vakata_dnd.scroll_t=1),e.pageY-o.top<$.vakata.dnd.settings.scroll_proximity&&(vakata_dnd.scroll_t=-1)),this.scrollWidth>this.offsetWidth&&(o.left+t.width()-e.pageX<$.vakata.dnd.settings.scroll_proximity&&(vakata_dnd.scroll_l=1),e.pageX-o.left<$.vakata.dnd.settings.scroll_proximity&&(vakata_dnd.scroll_l=-1)),vakata_dnd.scroll_t||vakata_dnd.scroll_l)return vakata_dnd.scroll_e=$(this),!1}),vakata_dnd.scroll_e||(d=$(document),w=$(window),dh=d.height(),wh=w.height(),dw=d.width(),ww=w.width(),dt=d.scrollTop(),dl=d.scrollLeft(),dh>wh&&e.pageY-dt<$.vakata.dnd.settings.scroll_proximity&&(vakata_dnd.scroll_t=-1),dh>wh&&wh-(e.pageY-dt)<$.vakata.dnd.settings.scroll_proximity&&(vakata_dnd.scroll_t=1),dw>ww&&e.pageX-dl<$.vakata.dnd.settings.scroll_proximity&&(vakata_dnd.scroll_l=-1),dw>ww&&ww-(e.pageX-dl)<$.vakata.dnd.settings.scroll_proximity&&(vakata_dnd.scroll_l=1),(vakata_dnd.scroll_t||vakata_dnd.scroll_l)&&(vakata_dnd.scroll_e=d)),vakata_dnd.scroll_e&&$.vakata.dnd._scroll(!0),vakata_dnd.helper&&(ht=parseInt(e.pageY+$.vakata.dnd.settings.helper_top,10),hl=parseInt(e.pageX+$.vakata.dnd.settings.helper_left,10),dh&&ht+25>dh&&(ht=dh-50),dw&&hl+vakata_dnd.helper_w>dw&&(hl=dw-(vakata_dnd.helper_w+2)),vakata_dnd.helper.css({left:hl+"px",top:ht+"px"})),$.vakata.dnd._trigger("move",e),!1}},stop:function(e){if("touchend"===e.type&&e.originalEvent&&e.originalEvent.changedTouches&&e.originalEvent.changedTouches[0]&&(e.pageX=e.originalEvent.changedTouches[0].pageX,e.pageY=e.originalEvent.changedTouches[0].pageY,e.target=document.elementFromPoint(e.originalEvent.changedTouches[0].pageX-window.pageXOffset,e.originalEvent.changedTouches[0].pageY-window.pageYOffset)),vakata_dnd.is_drag)e.target!==vakata_dnd.target&&$(vakata_dnd.target).off("click.vakata"),$.vakata.dnd._trigger("stop",e);else if("touchend"===e.type&&e.target===vakata_dnd.target){var to=setTimeout(function(){$(e.target).click()},100);$(e.target).one("click",function(){to&&clearTimeout(to)})}return $.vakata.dnd._clean(),!1}}}($),$.jstree.defaults.massload=null,$.jstree.plugins.massload=function(options,parent){this.init=function(el,options){this._data.massload={},parent.init.call(this,el,options)},this._load_nodes=function(nodes,callback,is_callback,force_reload){var i,j,dom,s=this.settings.massload,toLoad=(JSON.stringify(nodes),[]),m=this._model.data;if(!is_callback){for(i=0,j=nodes.length;i<j;i++)m[nodes[i]]&&(m[nodes[i]].state.loaded||m[nodes[i]].state.failed)&&!force_reload||(toLoad.push(nodes[i]),(dom=this.get_node(nodes[i],!0))&&dom.length&&dom.addClass("jstree-loading").attr("aria-busy",!0));if(this._data.massload={},toLoad.length){if($.isFunction(s))return s.call(this,toLoad,$.proxy(function(data){var i,j;if(data)for(i in data)data.hasOwnProperty(i)&&(this._data.massload[i]=data[i]);for(i=0,j=nodes.length;i<j;i++)(dom=this.get_node(nodes[i],!0))&&dom.length&&dom.removeClass("jstree-loading").attr("aria-busy",!1);parent._load_nodes.call(this,nodes,callback,is_callback,force_reload)},this));if("object"==typeof s&&s&&s.url)return s=$.extend(!0,{},s),$.isFunction(s.url)&&(s.url=s.url.call(this,toLoad)),$.isFunction(s.data)&&(s.data=s.data.call(this,toLoad)),$.ajax(s).done($.proxy(function(data,t,x){var i,j;if(data)for(i in data)data.hasOwnProperty(i)&&(this._data.massload[i]=data[i]);for(i=0,j=nodes.length;i<j;i++)(dom=this.get_node(nodes[i],!0))&&dom.length&&dom.removeClass("jstree-loading").attr("aria-busy",!1);parent._load_nodes.call(this,nodes,callback,is_callback,force_reload)},this)).fail($.proxy(function(f){parent._load_nodes.call(this,nodes,callback,is_callback,force_reload)},this))}}return parent._load_nodes.call(this,nodes,callback,is_callback,force_reload)},this._load_node=function(obj,callback){var dom,data=this._data.massload[obj.id],rslt=null;return data?(rslt=this["string"==typeof data?"_append_html_data":"_append_json_data"](obj,"string"==typeof data?$($.parseHTML(data)).filter(function(){return 3!==this.nodeType}):data,function(status){callback.call(this,status)}),(dom=this.get_node(obj.id,!0))&&dom.length&&dom.removeClass("jstree-loading").attr("aria-busy",!1),delete this._data.massload[obj.id],rslt):parent._load_node.call(this,obj,callback)}},$.jstree.defaults.search={ajax:!1,fuzzy:!1,case_sensitive:!1,show_only_matches:!1,show_only_matches_children:!1,close_opened_onclear:!0,search_leaves_only:!1,search_callback:!1},$.jstree.plugins.search=function(options,parent){this.bind=function(){parent.bind.call(this),this._data.search.str="",this._data.search.dom=$(),this._data.search.res=[],this._data.search.opn=[],this._data.search.som=!1,this._data.search.smc=!1,this._data.search.hdn=[],this.element.on("search.jstree",$.proxy(function(e,data){if(this._data.search.som&&data.res.length){var i,j,k,l,m=this._model.data,p=[];for(i=0,j=data.res.length;i<j;i++)if(m[data.res[i]]&&!m[data.res[i]].state.hidden&&(p.push(data.res[i]),p=p.concat(m[data.res[i]].parents),this._data.search.smc))for(k=0,l=m[data.res[i]].children_d.length;k<l;k++)m[m[data.res[i]].children_d[k]]&&!m[m[data.res[i]].children_d[k]].state.hidden&&p.push(m[data.res[i]].children_d[k]);p=$.vakata.array_remove_item($.vakata.array_unique(p),$.jstree.root),this._data.search.hdn=this.hide_all(!0),this.show_node(p,!0),this.redraw(!0)}},this)).on("clear_search.jstree",$.proxy(function(e,data){this._data.search.som&&data.res.length&&(this.show_node(this._data.search.hdn,!0),this.redraw(!0))},this))},this.search=function(str,skip_async,show_only_matches,inside,append,show_only_matches_children){if(!1===str||""===$.trim(str.toString()))return this.clear_search();inside=(inside=this.get_node(inside))&&inside.id?inside.id:null,str=str.toString();var i,j,s=this.settings.search,a=!!s.ajax&&s.ajax,m=this._model.data,f=null,r=[],p=[];if(this._data.search.res.length&&!append&&this.clear_search(),show_only_matches===undefined&&(show_only_matches=s.show_only_matches),show_only_matches_children===undefined&&(show_only_matches_children=s.show_only_matches_children),!skip_async&&!1!==a)return $.isFunction(a)?a.call(this,str,$.proxy(function(d){d&&d.d&&(d=d.d),this._load_nodes($.isArray(d)?$.vakata.array_unique(d):[],function(){this.search(str,!0,show_only_matches,inside,append,show_only_matches_children)})},this),inside):((a=$.extend({},a)).data||(a.data={}),a.data.str=str,inside&&(a.data.inside=inside),this._data.search.lastRequest&&this._data.search.lastRequest.abort(),this._data.search.lastRequest=$.ajax(a).fail($.proxy(function(){this._data.core.last_error={error:"ajax",plugin:"search",id:"search_01",reason:"Could not load search parents",data:JSON.stringify(a)},this.settings.core.error.call(this,this._data.core.last_error)},this)).done($.proxy(function(d){d&&d.d&&(d=d.d),this._load_nodes($.isArray(d)?$.vakata.array_unique(d):[],function(){this.search(str,!0,show_only_matches,inside,append,show_only_matches_children)})},this)),this._data.search.lastRequest);if(append||(this._data.search.str=str,this._data.search.dom=$(),this._data.search.res=[],this._data.search.opn=[],this._data.search.som=show_only_matches,this._data.search.smc=show_only_matches_children),f=new $.vakata.search(str,!0,{caseSensitive:s.case_sensitive,fuzzy:s.fuzzy}),$.each(m[inside||$.jstree.root].children_d,function(ii,i){var v=m[i];v.text&&!v.state.hidden&&(!s.search_leaves_only||v.state.loaded&&0===v.children.length)&&(s.search_callback&&s.search_callback.call(this,str,v)||!s.search_callback&&f.search(v.text).isMatch)&&(r.push(i),p=p.concat(v.parents))}),r.length){for(p=$.vakata.array_unique(p),i=0,j=p.length;i<j;i++)p[i]!==$.jstree.root&&m[p[i]]&&!0===this.open_node(p[i],null,0)&&this._data.search.opn.push(p[i]);append?(this._data.search.dom=this._data.search.dom.add($(this.element[0].querySelectorAll("#"+$.map(r,function(v){return-1!=="0123456789".indexOf(v[0])?"\\3"+v[0]+" "+v.substr(1).replace($.jstree.idregex,"\\$&"):v.replace($.jstree.idregex,"\\$&")}).join(", #")))),this._data.search.res=$.vakata.array_unique(this._data.search.res.concat(r))):(this._data.search.dom=$(this.element[0].querySelectorAll("#"+$.map(r,function(v){return-1!=="0123456789".indexOf(v[0])?"\\3"+v[0]+" "+v.substr(1).replace($.jstree.idregex,"\\$&"):v.replace($.jstree.idregex,"\\$&")}).join(", #"))),this._data.search.res=r),this._data.search.dom.children(".jstree-anchor").addClass("jstree-search")}this.trigger("search",{nodes:this._data.search.dom,str:str,res:this._data.search.res,show_only_matches:show_only_matches})},this.clear_search=function(){this.settings.search.close_opened_onclear&&this.close_node(this._data.search.opn,0),this.trigger("clear_search",{nodes:this._data.search.dom,str:this._data.search.str,res:this._data.search.res}),this._data.search.res.length&&(this._data.search.dom=$(this.element[0].querySelectorAll("#"+$.map(this._data.search.res,function(v){return-1!=="0123456789".indexOf(v[0])?"\\3"+v[0]+" "+v.substr(1).replace($.jstree.idregex,"\\$&"):v.replace($.jstree.idregex,"\\$&")}).join(", #"))),this._data.search.dom.children(".jstree-anchor").removeClass("jstree-search")),this._data.search.str="",this._data.search.res=[],this._data.search.opn=[],this._data.search.dom=$()},this.redraw_node=function(obj,deep,callback,force_render){if((obj=parent.redraw_node.apply(this,arguments))&&-1!==$.inArray(obj.id,this._data.search.res)){var i,j,tmp=null;for(i=0,j=obj.childNodes.length;i<j;i++)if(obj.childNodes[i]&&obj.childNodes[i].className&&-1!==obj.childNodes[i].className.indexOf("jstree-anchor")){tmp=obj.childNodes[i];break}tmp&&(tmp.className+=" jstree-search")}return obj}},function($){$.vakata.search=function(pattern,txt,options){options=options||{},!1!==(options=$.extend({},$.vakata.search.defaults,options)).fuzzy&&(options.fuzzy=!0),pattern=options.caseSensitive?pattern:pattern.toLowerCase();var matchmask,pattern_alphabet,match_bitapScore,search,MATCH_LOCATION=options.location,MATCH_DISTANCE=options.distance,MATCH_THRESHOLD=options.threshold,patternLen=pattern.length;return patternLen>32&&(options.fuzzy=!1),options.fuzzy&&(matchmask=1<<patternLen-1,pattern_alphabet=function(){var mask={},i=0;for(i=0;i<patternLen;i++)mask[pattern.charAt(i)]=0;for(i=0;i<patternLen;i++)mask[pattern.charAt(i)]|=1<<patternLen-i-1;return mask}(),match_bitapScore=function(e,x){var accuracy=e/patternLen,proximity=Math.abs(MATCH_LOCATION-x);return MATCH_DISTANCE?accuracy+proximity/MATCH_DISTANCE:proximity?1:accuracy}),search=function(text){if(text=options.caseSensitive?text:text.toLowerCase(),pattern===text||-1!==text.indexOf(pattern))return{isMatch:!0,score:0};if(!options.fuzzy)return{isMatch:!1,score:1};var i,j,binMin,binMid,lastRd,start,finish,rd,charMatch,textLen=text.length,scoreThreshold=MATCH_THRESHOLD,bestLoc=text.indexOf(pattern,MATCH_LOCATION),binMax=patternLen+textLen,score=1,locations=[];for(-1!==bestLoc&&(scoreThreshold=Math.min(match_bitapScore(0,bestLoc),scoreThreshold),-1!==(bestLoc=text.lastIndexOf(pattern,MATCH_LOCATION+patternLen))&&(scoreThreshold=Math.min(match_bitapScore(0,bestLoc),scoreThreshold))),bestLoc=-1,i=0;i<patternLen;i++){for(binMin=0,binMid=binMax;binMin<binMid;)match_bitapScore(i,MATCH_LOCATION+binMid)<=scoreThreshold?binMin=binMid:binMax=binMid,binMid=Math.floor((binMax-binMin)/2+binMin);for(binMax=binMid,start=Math.max(1,MATCH_LOCATION-binMid+1),finish=Math.min(MATCH_LOCATION+binMid,textLen)+patternLen,(rd=new Array(finish+2))[finish+1]=(1<<i)-1,j=finish;j>=start;j--)if(charMatch=pattern_alphabet[text.charAt(j-1)],rd[j]=0===i?(rd[j+1]<<1|1)&charMatch:(rd[j+1]<<1|1)&charMatch|(lastRd[j+1]|lastRd[j])<<1|1|lastRd[j+1],rd[j]&matchmask&&(score=match_bitapScore(i,j-1))<=scoreThreshold){if(scoreThreshold=score,bestLoc=j-1,locations.push(bestLoc),!(bestLoc>MATCH_LOCATION))break;start=Math.max(1,2*MATCH_LOCATION-bestLoc)}if(match_bitapScore(i+1,MATCH_LOCATION)>scoreThreshold)break;lastRd=rd}return{isMatch:bestLoc>=0,score:score}},!0===txt?{search:search}:search(txt)},$.vakata.search.defaults={location:0,distance:100,threshold:.6,fuzzy:!1,caseSensitive:!1}}($),$.jstree.defaults.sort=function(a,b){return this.get_text(a)>this.get_text(b)?1:-1},$.jstree.plugins.sort=function(options,parent){this.bind=function(){parent.bind.call(this),this.element.on("model.jstree",$.proxy(function(e,data){this.sort(data.parent,!0)},this)).on("rename_node.jstree create_node.jstree",$.proxy(function(e,data){this.sort(data.parent||data.node.parent,!1),this.redraw_node(data.parent||data.node.parent,!0)},this)).on("move_node.jstree copy_node.jstree",$.proxy(function(e,data){this.sort(data.parent,!1),this.redraw_node(data.parent,!0)},this))},this.sort=function(obj,deep){var i,j;if((obj=this.get_node(obj))&&obj.children&&obj.children.length&&(obj.children.sort($.proxy(this.settings.sort,this)),deep))for(i=0,j=obj.children_d.length;i<j;i++)this.sort(obj.children_d[i],!1)}};var to=!1;$.jstree.defaults.state={key:"jstree",events:"changed.jstree open_node.jstree close_node.jstree check_node.jstree uncheck_node.jstree",ttl:!1,filter:!1,preserve_loaded:!1},$.jstree.plugins.state=function(options,parent){this.bind=function(){parent.bind.call(this);var bind=$.proxy(function(){this.element.on(this.settings.state.events,$.proxy(function(){to&&clearTimeout(to),to=setTimeout($.proxy(function(){this.save_state()},this),100)},this)),this.trigger("state_ready")},this);this.element.on("ready.jstree",$.proxy(function(e,data){this.element.one("restore_state.jstree",bind),this.restore_state()||bind()},this))},this.save_state=function(){var tm=this.get_state();this.settings.state.preserve_loaded||delete tm.core.loaded;var st={state:tm,ttl:this.settings.state.ttl,sec:+new Date};$.vakata.storage.set(this.settings.state.key,JSON.stringify(st))},this.restore_state=function(){var k=$.vakata.storage.get(this.settings.state.key);if(k)try{k=JSON.parse(k)}catch(ex){return!1}return!(k&&k.ttl&&k.sec&&+new Date-k.sec>k.ttl)&&(k&&k.state&&(k=k.state),k&&$.isFunction(this.settings.state.filter)&&(k=this.settings.state.filter.call(this,k)),!!k&&(this.settings.state.preserve_loaded||delete k.core.loaded,this.element.one("set_state.jstree",function(e,data){data.instance.trigger("restore_state",{state:$.extend(!0,{},k)})}),this.set_state(k),!0))},this.clear_state=function(){return $.vakata.storage.del(this.settings.state.key)}},function($,undefined){$.vakata.storage={set:function(key,val){return window.localStorage.setItem(key,val)},get:function(key){return window.localStorage.getItem(key)},del:function(key){return window.localStorage.removeItem(key)}}}($),$.jstree.defaults.types={default:{}},$.jstree.defaults.types[$.jstree.root]={},$.jstree.plugins.types=function(options,parent){this.init=function(el,options){var i,j;if(options&&options.types&&options.types.default)for(i in options.types)if("default"!==i&&i!==$.jstree.root&&options.types.hasOwnProperty(i))for(j in options.types.default)options.types.default.hasOwnProperty(j)&&options.types[i][j]===undefined&&(options.types[i][j]=options.types.default[j]);parent.init.call(this,el,options),this._model.data[$.jstree.root].type=$.jstree.root},this.refresh=function(skip_loading,forget_state){parent.refresh.call(this,skip_loading,forget_state),this._model.data[$.jstree.root].type=$.jstree.root},this.bind=function(){this.element.on("model.jstree",$.proxy(function(e,data){var i,j,k,m=this._model.data,dpc=data.nodes,t=this.settings.types,c="default";for(i=0,j=dpc.length;i<j;i++){if(c="default",m[dpc[i]].original&&m[dpc[i]].original.type&&t[m[dpc[i]].original.type]&&(c=m[dpc[i]].original.type),m[dpc[i]].data&&m[dpc[i]].data.jstree&&m[dpc[i]].data.jstree.type&&t[m[dpc[i]].data.jstree.type]&&(c=m[dpc[i]].data.jstree.type),m[dpc[i]].type=c,!0===m[dpc[i]].icon&&t[c].icon!==undefined&&(m[dpc[i]].icon=t[c].icon),t[c].li_attr!==undefined&&"object"==typeof t[c].li_attr)for(k in t[c].li_attr)if(t[c].li_attr.hasOwnProperty(k)){if("id"===k)continue;m[dpc[i]].li_attr[k]===undefined?m[dpc[i]].li_attr[k]=t[c].li_attr[k]:"class"===k&&(m[dpc[i]].li_attr.class=t[c].li_attr.class+" "+m[dpc[i]].li_attr.class)}if(t[c].a_attr!==undefined&&"object"==typeof t[c].a_attr)for(k in t[c].a_attr)if(t[c].a_attr.hasOwnProperty(k)){if("id"===k)continue;m[dpc[i]].a_attr[k]===undefined?m[dpc[i]].a_attr[k]=t[c].a_attr[k]:"href"===k&&"#"===m[dpc[i]].a_attr[k]?m[dpc[i]].a_attr.href=t[c].a_attr.href:"class"===k&&(m[dpc[i]].a_attr.class=t[c].a_attr.class+" "+m[dpc[i]].a_attr.class)}}m[$.jstree.root].type=$.jstree.root},this)),parent.bind.call(this)},this.get_json=function(obj,options,flat){var i,j,m=this._model.data,opt=options?$.extend(!0,{},options,{no_id:!1}):{},tmp=parent.get_json.call(this,obj,opt,flat);if(!1===tmp)return!1;if($.isArray(tmp))for(i=0,j=tmp.length;i<j;i++)tmp[i].type=tmp[i].id&&m[tmp[i].id]&&m[tmp[i].id].type?m[tmp[i].id].type:"default",options&&options.no_id&&(delete tmp[i].id,tmp[i].li_attr&&tmp[i].li_attr.id&&delete tmp[i].li_attr.id,tmp[i].a_attr&&tmp[i].a_attr.id&&delete tmp[i].a_attr.id);else tmp.type=tmp.id&&m[tmp.id]&&m[tmp.id].type?m[tmp.id].type:"default",options&&options.no_id&&(tmp=this._delete_ids(tmp));return tmp},this._delete_ids=function(tmp){if($.isArray(tmp)){for(var i=0,j=tmp.length;i<j;i++)tmp[i]=this._delete_ids(tmp[i]);return tmp}return delete tmp.id,tmp.li_attr&&tmp.li_attr.id&&delete tmp.li_attr.id,tmp.a_attr&&tmp.a_attr.id&&delete tmp.a_attr.id,tmp.children&&$.isArray(tmp.children)&&(tmp.children=this._delete_ids(tmp.children)),tmp},this.check=function(chk,obj,par,pos,more){if(!1===parent.check.call(this,chk,obj,par,pos,more))return!1;obj=obj&&obj.id?obj:this.get_node(obj),par=par&&par.id?par:this.get_node(par);var tmp,d,i,j,m=obj&&obj.id?more&&more.origin?more.origin:$.jstree.reference(obj.id):null;switch(m=m&&m._model&&m._model.data?m._model.data:null,chk){case"create_node":case"move_node":case"copy_node":if("move_node"!==chk||-1===$.inArray(obj.id,par.children)){if((tmp=this.get_rules(par)).max_children!==undefined&&-1!==tmp.max_children&&tmp.max_children===par.children.length)return this._data.core.last_error={error:"check",plugin:"types",id:"types_01",reason:"max_children prevents function: "+chk,data:JSON.stringify({chk:chk,pos:pos,obj:!(!obj||!obj.id)&&obj.id,par:!(!par||!par.id)&&par.id})},!1;if(tmp.valid_children!==undefined&&-1!==tmp.valid_children&&-1===$.inArray(obj.type||"default",tmp.valid_children))return this._data.core.last_error={error:"check",plugin:"types",id:"types_02",reason:"valid_children prevents function: "+chk,data:JSON.stringify({chk:chk,pos:pos,obj:!(!obj||!obj.id)&&obj.id,par:!(!par||!par.id)&&par.id})},!1;if(m&&obj.children_d&&obj.parents){for(d=0,i=0,j=obj.children_d.length;i<j;i++)d=Math.max(d,m[obj.children_d[i]].parents.length);d=d-obj.parents.length+1}(d<=0||d===undefined)&&(d=1);do{if(tmp.max_depth!==undefined&&-1!==tmp.max_depth&&tmp.max_depth<d)return this._data.core.last_error={error:"check",plugin:"types",id:"types_03",reason:"max_depth prevents function: "+chk,data:JSON.stringify({chk:chk,pos:pos,obj:!(!obj||!obj.id)&&obj.id,par:!(!par||!par.id)&&par.id})},!1;par=this.get_node(par.parent),tmp=this.get_rules(par),d++}while(par)}}return!0},this.get_rules=function(obj){if(!(obj=this.get_node(obj)))return!1;var tmp=this.get_type(obj,!0);return tmp.max_depth===undefined&&(tmp.max_depth=-1),tmp.max_children===undefined&&(tmp.max_children=-1),tmp.valid_children===undefined&&(tmp.valid_children=-1),tmp},this.get_type=function(obj,rules){return!!(obj=this.get_node(obj))&&(rules?$.extend({type:obj.type},this.settings.types[obj.type]):obj.type)},this.set_type=function(obj,type){var t,t1,t2,old_type,old_icon,k,d,a,m=this._model.data;if($.isArray(obj)){for(obj=obj.slice(),t1=0,t2=obj.length;t1<t2;t1++)this.set_type(obj[t1],type);return!0}if(t=this.settings.types,obj=this.get_node(obj),!t[type]||!obj)return!1;if((d=this.get_node(obj,!0))&&d.length&&(a=d.children(".jstree-anchor")),old_type=obj.type,old_icon=this.get_icon(obj),obj.type=type,(!0===old_icon||!t[old_type]||t[old_type].icon!==undefined&&old_icon===t[old_type].icon)&&this.set_icon(obj,t[type].icon===undefined||t[type].icon),t[old_type]&&t[old_type].li_attr!==undefined&&"object"==typeof t[old_type].li_attr)for(k in t[old_type].li_attr)if(t[old_type].li_attr.hasOwnProperty(k)){if("id"===k)continue;"class"===k?(m[obj.id].li_attr.class=(m[obj.id].li_attr.class||"").replace(t[old_type].li_attr[k],""),d&&d.removeClass(t[old_type].li_attr[k])):m[obj.id].li_attr[k]===t[old_type].li_attr[k]&&(m[obj.id].li_attr[k]=null,d&&d.removeAttr(k))}if(t[old_type]&&t[old_type].a_attr!==undefined&&"object"==typeof t[old_type].a_attr)for(k in t[old_type].a_attr)if(t[old_type].a_attr.hasOwnProperty(k)){if("id"===k)continue;"class"===k?(m[obj.id].a_attr.class=(m[obj.id].a_attr.class||"").replace(t[old_type].a_attr[k],""),a&&a.removeClass(t[old_type].a_attr[k])):m[obj.id].a_attr[k]===t[old_type].a_attr[k]&&("href"===k?(m[obj.id].a_attr[k]="#",a&&a.attr("href","#")):(delete m[obj.id].a_attr[k],a&&a.removeAttr(k)))}if(t[type].li_attr!==undefined&&"object"==typeof t[type].li_attr)for(k in t[type].li_attr)if(t[type].li_attr.hasOwnProperty(k)){if("id"===k)continue;m[obj.id].li_attr[k]===undefined?(m[obj.id].li_attr[k]=t[type].li_attr[k],d&&("class"===k?d.addClass(t[type].li_attr[k]):d.attr(k,t[type].li_attr[k]))):"class"===k&&(m[obj.id].li_attr.class=t[type].li_attr[k]+" "+m[obj.id].li_attr.class,d&&d.addClass(t[type].li_attr[k]))}if(t[type].a_attr!==undefined&&"object"==typeof t[type].a_attr)for(k in t[type].a_attr)if(t[type].a_attr.hasOwnProperty(k)){if("id"===k)continue;m[obj.id].a_attr[k]===undefined?(m[obj.id].a_attr[k]=t[type].a_attr[k],a&&("class"===k?a.addClass(t[type].a_attr[k]):a.attr(k,t[type].a_attr[k]))):"href"===k&&"#"===m[obj.id].a_attr[k]?(m[obj.id].a_attr.href=t[type].a_attr.href,a&&a.attr("href",t[type].a_attr.href)):"class"===k&&(m[obj.id].a_attr.class=t[type].a_attr.class+" "+m[obj.id].a_attr.class,a&&a.addClass(t[type].a_attr[k]))}return!0}},$.jstree.defaults.unique={case_sensitive:!1,trim_whitespace:!1,duplicate:function(name,counter){return name+" ("+counter+")"}},$.jstree.plugins.unique=function(options,parent){this.check=function(chk,obj,par,pos,more){if(!1===parent.check.call(this,chk,obj,par,pos,more))return!1;if(obj=obj&&obj.id?obj:this.get_node(obj),!(par=par&&par.id?par:this.get_node(par))||!par.children)return!0;var i,j,t,n="rename_node"===chk?pos:obj.text,c=[],s=this.settings.unique.case_sensitive,w=this.settings.unique.trim_whitespace,m=this._model.data;for(i=0,j=par.children.length;i<j;i++)t=m[par.children[i]].text,s||(t=t.toLowerCase()),w&&(t=t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")),c.push(t);switch(s||(n=n.toLowerCase()),w&&(n=n.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")),chk){case"delete_node":return!0;case"rename_node":return t=obj.text||"",s||(t=t.toLowerCase()),w&&(t=t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")),(i=-1===$.inArray(n,c)||obj.text&&t===n)||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_01",reason:"Child with name "+n+" already exists. Preventing: "+chk,data:JSON.stringify({chk:chk,pos:pos,obj:!(!obj||!obj.id)&&obj.id,par:!(!par||!par.id)&&par.id})}),i;case"create_node":return(i=-1===$.inArray(n,c))||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_04",reason:"Child with name "+n+" already exists. Preventing: "+chk,data:JSON.stringify({chk:chk,pos:pos,obj:!(!obj||!obj.id)&&obj.id,par:!(!par||!par.id)&&par.id})}),i;case"copy_node":return(i=-1===$.inArray(n,c))||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_02",reason:"Child with name "+n+" already exists. Preventing: "+chk,data:JSON.stringify({chk:chk,pos:pos,obj:!(!obj||!obj.id)&&obj.id,par:!(!par||!par.id)&&par.id})}),i;case"move_node":return(i=obj.parent===par.id&&(!more||!more.is_multi)||-1===$.inArray(n,c))||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_03",reason:"Child with name "+n+" already exists. Preventing: "+chk,data:JSON.stringify({chk:chk,pos:pos,obj:!(!obj||!obj.id)&&obj.id,par:!(!par||!par.id)&&par.id})}),i}return!0},this.create_node=function(par,node,pos,callback,is_loaded){if(!node||node.text===undefined){if(null===par&&(par=$.jstree.root),!(par=this.get_node(par)))return parent.create_node.call(this,par,node,pos,callback,is_loaded);if(!(pos=pos===undefined?"last":pos).toString().match(/^(before|after)$/)&&!is_loaded&&!this.is_loaded(par))return parent.create_node.call(this,par,node,pos,callback,is_loaded);node||(node={});var tmp,n,dpc,i,j,t,m=this._model.data,s=this.settings.unique.case_sensitive,w=this.settings.unique.trim_whitespace,cb=this.settings.unique.duplicate;for(n=tmp=this.get_string("New node"),dpc=[],i=0,j=par.children.length;i<j;i++)t=m[par.children[i]].text,s||(t=t.toLowerCase()),w&&(t=t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")),dpc.push(t);for(i=1,t=n,s||(t=t.toLowerCase()),w&&(t=t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""));-1!==$.inArray(t,dpc);)n=cb.call(this,tmp,++i).toString(),t=n,s||(t=t.toLowerCase()),w&&(t=t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""));node.text=n}return parent.create_node.call(this,par,node,pos,callback,is_loaded)}};var div=document.createElement("DIV");if(div.setAttribute("unselectable","on"),div.setAttribute("role","presentation"),div.className="jstree-wholerow",div.innerHTML="&#160;",$.jstree.plugins.wholerow=function(options,parent){this.bind=function(){parent.bind.call(this),this.element.on("ready.jstree set_state.jstree",$.proxy(function(){this.hide_dots()},this)).on("init.jstree loading.jstree ready.jstree",$.proxy(function(){this.get_container_ul().addClass("jstree-wholerow-ul")},this)).on("deselect_all.jstree",$.proxy(function(e,data){this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked")},this)).on("changed.jstree",$.proxy(function(e,data){this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked");var i,j,tmp=!1;for(i=0,j=data.selected.length;i<j;i++)(tmp=this.get_node(data.selected[i],!0))&&tmp.length&&tmp.children(".jstree-wholerow").addClass("jstree-wholerow-clicked")},this)).on("open_node.jstree",$.proxy(function(e,data){this.get_node(data.node,!0).find(".jstree-clicked").parent().children(".jstree-wholerow").addClass("jstree-wholerow-clicked")},this)).on("hover_node.jstree dehover_node.jstree",$.proxy(function(e,data){"hover_node"===e.type&&this.is_disabled(data.node)||this.get_node(data.node,!0).children(".jstree-wholerow")["hover_node"===e.type?"addClass":"removeClass"]("jstree-wholerow-hovered")},this)).on("contextmenu.jstree",".jstree-wholerow",$.proxy(function(e){if(this._data.contextmenu){e.preventDefault();var tmp=$.Event("contextmenu",{metaKey:e.metaKey,ctrlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey,pageX:e.pageX,pageY:e.pageY});$(e.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(tmp)}},this)).on("click.jstree",".jstree-wholerow",function(e){e.stopImmediatePropagation();var tmp=$.Event("click",{metaKey:e.metaKey,ctrlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey});$(e.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(tmp).focus()}).on("dblclick.jstree",".jstree-wholerow",function(e){e.stopImmediatePropagation();var tmp=$.Event("dblclick",{metaKey:e.metaKey,ctrlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey});$(e.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(tmp).focus()}).on("click.jstree",".jstree-leaf > .jstree-ocl",$.proxy(function(e){e.stopImmediatePropagation();var tmp=$.Event("click",{metaKey:e.metaKey,ctrlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey});$(e.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(tmp).focus()},this)).on("mouseover.jstree",".jstree-wholerow, .jstree-icon",$.proxy(function(e){return e.stopImmediatePropagation(),this.is_disabled(e.currentTarget)||this.hover_node(e.currentTarget),!1},this)).on("mouseleave.jstree",".jstree-node",$.proxy(function(e){this.dehover_node(e.currentTarget)},this))},this.teardown=function(){this.settings.wholerow&&this.element.find(".jstree-wholerow").remove(),parent.teardown.call(this)},this.redraw_node=function(obj,deep,callback,force_render){if(obj=parent.redraw_node.apply(this,arguments)){var tmp=div.cloneNode(!0);-1!==$.inArray(obj.id,this._data.core.selected)&&(tmp.className+=" jstree-wholerow-clicked"),this._data.core.focused&&this._data.core.focused===obj.id&&(tmp.className+=" jstree-wholerow-hovered"),obj.insertBefore(tmp,obj.childNodes[0])}return obj}},window.customElements&&Object&&Object.create){var proto=Object.create(HTMLElement.prototype);proto.createdCallback=function(){var i,c={core:{},plugins:[]};for(i in $.jstree.plugins)$.jstree.plugins.hasOwnProperty(i)&&this.attributes[i]&&(c.plugins.push(i),this.getAttribute(i)&&JSON.parse(this.getAttribute(i))&&(c[i]=JSON.parse(this.getAttribute(i))));for(i in $.jstree.defaults.core)$.jstree.defaults.core.hasOwnProperty(i)&&this.attributes[i]&&(c.core[i]=JSON.parse(this.getAttribute(i))||this.getAttribute(i));$(this).jstree(c)};try{window.customElements.define("vakata-jstree",function(){},{prototype:proto})}catch(ignore){}}})?__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__):__WEBPACK_AMD_DEFINE_FACTORY__)||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)}()},"./node_modules/localforage/dist/localforage.js":function(module,exports,__webpack_require__){(function(global){var require;module.exports=function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return require(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n||e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(_dereq_,module,exports){(function(global){"use strict";var scheduleDrain,draining,Mutation=global.MutationObserver||global.WebKitMutationObserver;if(Mutation){var called=0,observer=new Mutation(nextTick),element=global.document.createTextNode("");observer.observe(element,{characterData:!0}),scheduleDrain=function(){element.data=called=++called%2}}else if(global.setImmediate||void 0===global.MessageChannel)scheduleDrain="document"in global&&"onreadystatechange"in global.document.createElement("script")?function(){var scriptEl=global.document.createElement("script");scriptEl.onreadystatechange=function(){nextTick(),scriptEl.onreadystatechange=null,scriptEl.parentNode.removeChild(scriptEl),scriptEl=null},global.document.documentElement.appendChild(scriptEl)}:function(){setTimeout(nextTick,0)};else{var channel=new global.MessageChannel;channel.port1.onmessage=nextTick,scheduleDrain=function(){channel.port2.postMessage(0)}}var queue=[];function nextTick(){var i,oldQueue;draining=!0;for(var len=queue.length;len;){for(oldQueue=queue,queue=[],i=-1;++i<len;)oldQueue[i]();len=queue.length}draining=!1}module.exports=function(task){1!==queue.push(task)||draining||scheduleDrain()}}).call(this,void 0!==global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(_dereq_,module,exports){"use strict";var immediate=_dereq_(1);function INTERNAL(){}var handlers={},REJECTED=["REJECTED"],FULFILLED=["FULFILLED"],PENDING=["PENDING"];function Promise(resolver){if("function"!=typeof resolver)throw new TypeError("resolver must be a function");this.state=PENDING,this.queue=[],this.outcome=void 0,resolver!==INTERNAL&&safelyResolveThenable(this,resolver)}function QueueItem(promise,onFulfilled,onRejected){this.promise=promise,"function"==typeof onFulfilled&&(this.onFulfilled=onFulfilled,this.callFulfilled=this.otherCallFulfilled),"function"==typeof onRejected&&(this.onRejected=onRejected,this.callRejected=this.otherCallRejected)}function unwrap(promise,func,value){immediate(function(){var returnValue;try{returnValue=func(value)}catch(e){return handlers.reject(promise,e)}returnValue===promise?handlers.reject(promise,new TypeError("Cannot resolve promise with itself")):handlers.resolve(promise,returnValue)})}function getThen(obj){var then=obj&&obj.then;if(obj&&("object"==typeof obj||"function"==typeof obj)&&"function"==typeof then)return function(){then.apply(obj,arguments)}}function safelyResolveThenable(self,thenable){var called=!1;function onError(value){called||(called=!0,handlers.reject(self,value))}function onSuccess(value){called||(called=!0,handlers.resolve(self,value))}var result=tryCatch(function(){thenable(onSuccess,onError)});"error"===result.status&&onError(result.value)}function tryCatch(func,value){var out={};try{out.value=func(value),out.status="success"}catch(e){out.status="error",out.value=e}return out}module.exports=Promise,Promise.prototype.catch=function(onRejected){return this.then(null,onRejected)},Promise.prototype.then=function(onFulfilled,onRejected){if("function"!=typeof onFulfilled&&this.state===FULFILLED||"function"!=typeof onRejected&&this.state===REJECTED)return this;var promise=new this.constructor(INTERNAL);if(this.state!==PENDING){var resolver=this.state===FULFILLED?onFulfilled:onRejected;unwrap(promise,resolver,this.outcome)}else this.queue.push(new QueueItem(promise,onFulfilled,onRejected));return promise},QueueItem.prototype.callFulfilled=function(value){handlers.resolve(this.promise,value)},QueueItem.prototype.otherCallFulfilled=function(value){unwrap(this.promise,this.onFulfilled,value)},QueueItem.prototype.callRejected=function(value){handlers.reject(this.promise,value)},QueueItem.prototype.otherCallRejected=function(value){unwrap(this.promise,this.onRejected,value)},handlers.resolve=function(self,value){var result=tryCatch(getThen,value);if("error"===result.status)return handlers.reject(self,result.value);var thenable=result.value;if(thenable)safelyResolveThenable(self,thenable);else{self.state=FULFILLED,self.outcome=value;for(var i=-1,len=self.queue.length;++i<len;)self.queue[i].callFulfilled(value)}return self},handlers.reject=function(self,error){self.state=REJECTED,self.outcome=error;for(var i=-1,len=self.queue.length;++i<len;)self.queue[i].callRejected(error);return self},Promise.resolve=function(value){return value instanceof this?value:handlers.resolve(new this(INTERNAL),value)},Promise.reject=function(reason){var promise=new this(INTERNAL);return handlers.reject(promise,reason)},Promise.all=function(iterable){var self=this;if("[object Array]"!==Object.prototype.toString.call(iterable))return this.reject(new TypeError("must be an array"));var len=iterable.length,called=!1;if(!len)return this.resolve([]);for(var values=new Array(len),resolved=0,i=-1,promise=new this(INTERNAL);++i<len;)allResolver(iterable[i],i);return promise;function allResolver(value,i){self.resolve(value).then(function(outValue){values[i]=outValue,++resolved!==len||called||(called=!0,handlers.resolve(promise,values))},function(error){called||(called=!0,handlers.reject(promise,error))})}},Promise.race=function(iterable){var self=this;if("[object Array]"!==Object.prototype.toString.call(iterable))return this.reject(new TypeError("must be an array"));var len=iterable.length,called=!1;if(!len)return this.resolve([]);for(var value,i=-1,promise=new this(INTERNAL);++i<len;)value=iterable[i],self.resolve(value).then(function(response){called||(called=!0,handlers.resolve(promise,response))},function(error){called||(called=!0,handlers.reject(promise,error))});return promise}},{1:1}],3:[function(_dereq_,module,exports){(function(global){"use strict";"function"!=typeof global.Promise&&(global.Promise=_dereq_(2))}).call(this,void 0!==global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(_dereq_,module,exports){"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},idb=function(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(e){return}}();function createBlob(parts,properties){parts=parts||[],properties=properties||{};try{return new Blob(parts,properties)}catch(e){if("TypeError"!==e.name)throw e;for(var Builder="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,builder=new Builder,i=0;i<parts.length;i+=1)builder.append(parts[i]);return builder.getBlob(properties.type)}}"undefined"==typeof Promise&&_dereq_(3);var Promise$1=Promise;function executeCallback(promise,callback){callback&&promise.then(function(result){callback(null,result)},function(error){callback(error)})}function executeTwoCallbacks(promise,callback,errorCallback){"function"==typeof callback&&promise.then(callback),"function"==typeof errorCallback&&promise.catch(errorCallback)}function normalizeKey(key){return"string"!=typeof key&&(console.warn(key+" used as a key, but it is not a string."),key=String(key)),key}function getCallback(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}var DETECT_BLOB_SUPPORT_STORE="local-forage-detect-blob-support",supportsBlobs=void 0,dbContexts={},toString=Object.prototype.toString,READ_ONLY="readonly",READ_WRITE="readwrite";function _checkBlobSupport(idb){return"boolean"==typeof supportsBlobs?Promise$1.resolve(supportsBlobs):function(idb){return new Promise$1(function(resolve){var txn=idb.transaction(DETECT_BLOB_SUPPORT_STORE,READ_WRITE),blob=createBlob([""]);txn.objectStore(DETECT_BLOB_SUPPORT_STORE).put(blob,"key"),txn.onabort=function(e){e.preventDefault(),e.stopPropagation(),resolve(!1)},txn.oncomplete=function(){var matchedChrome=navigator.userAgent.match(/Chrome\/(\d+)/),matchedEdge=navigator.userAgent.match(/Edge\//);resolve(matchedEdge||!matchedChrome||parseInt(matchedChrome[1],10)>=43)}}).catch(function(){return!1})}(idb).then(function(value){return supportsBlobs=value})}function _deferReadiness(dbInfo){var dbContext=dbContexts[dbInfo.name],deferredOperation={};deferredOperation.promise=new Promise$1(function(resolve,reject){deferredOperation.resolve=resolve,deferredOperation.reject=reject}),dbContext.deferredOperations.push(deferredOperation),dbContext.dbReady?dbContext.dbReady=dbContext.dbReady.then(function(){return deferredOperation.promise}):dbContext.dbReady=deferredOperation.promise}function _advanceReadiness(dbInfo){var dbContext=dbContexts[dbInfo.name],deferredOperation=dbContext.deferredOperations.pop();if(deferredOperation)return deferredOperation.resolve(),deferredOperation.promise}function _rejectReadiness(dbInfo,err){var dbContext=dbContexts[dbInfo.name],deferredOperation=dbContext.deferredOperations.pop();if(deferredOperation)return deferredOperation.reject(err),deferredOperation.promise}function _getConnection(dbInfo,upgradeNeeded){return new Promise$1(function(resolve,reject){if(dbContexts[dbInfo.name]=dbContexts[dbInfo.name]||{forages:[],db:null,dbReady:null,deferredOperations:[]},dbInfo.db){if(!upgradeNeeded)return resolve(dbInfo.db);_deferReadiness(dbInfo),dbInfo.db.close()}var dbArgs=[dbInfo.name];upgradeNeeded&&dbArgs.push(dbInfo.version);var openreq=idb.open.apply(idb,dbArgs);upgradeNeeded&&(openreq.onupgradeneeded=function(e){var db=openreq.result;try{db.createObjectStore(dbInfo.storeName),e.oldVersion<=1&&db.createObjectStore(DETECT_BLOB_SUPPORT_STORE)}catch(ex){if("ConstraintError"!==ex.name)throw ex;console.warn('The database "'+dbInfo.name+'" has been upgraded from version '+e.oldVersion+" to version "+e.newVersion+', but the storage "'+dbInfo.storeName+'" already exists.')}}),openreq.onerror=function(e){e.preventDefault(),reject(openreq.error)},openreq.onsuccess=function(){resolve(openreq.result),_advanceReadiness(dbInfo)}})}function _getOriginalConnection(dbInfo){return _getConnection(dbInfo,!1)}function _getUpgradedConnection(dbInfo){return _getConnection(dbInfo,!0)}function _isUpgradeNeeded(dbInfo,defaultVersion){if(!dbInfo.db)return!0;var isNewStore=!dbInfo.db.objectStoreNames.contains(dbInfo.storeName),isDowngrade=dbInfo.version<dbInfo.db.version,isUpgrade=dbInfo.version>dbInfo.db.version;if(isDowngrade&&(dbInfo.version!==defaultVersion&&console.warn('The database "'+dbInfo.name+"\" can't be downgraded from version "+dbInfo.db.version+" to version "+dbInfo.version+"."),dbInfo.version=dbInfo.db.version),isUpgrade||isNewStore){if(isNewStore){var incVersion=dbInfo.db.version+1;incVersion>dbInfo.version&&(dbInfo.version=incVersion)}return!0}return!1}function _decodeBlob(encodedBlob){var arrayBuff=function(bin){for(var length=bin.length,buf=new ArrayBuffer(length),arr=new Uint8Array(buf),i=0;i<length;i++)arr[i]=bin.charCodeAt(i);return buf}(atob(encodedBlob.data));return createBlob([arrayBuff],{type:encodedBlob.type})}function _isEncodedBlob(value){return value&&value.__local_forage_encoded_blob}function _fullyReady(callback){var self=this,promise=self._initReady().then(function(){var dbContext=dbContexts[self._dbInfo.name];if(dbContext&&dbContext.dbReady)return dbContext.dbReady});return executeTwoCallbacks(promise,callback,callback),promise}function createTransaction(dbInfo,mode,callback,retries){void 0===retries&&(retries=1);try{var tx=dbInfo.db.transaction(dbInfo.storeName,mode);callback(null,tx)}catch(err){if(retries>0&&(!dbInfo.db||"InvalidStateError"===err.name||"NotFoundError"===err.name))return Promise$1.resolve().then(function(){if(!dbInfo.db||"NotFoundError"===err.name&&!dbInfo.db.objectStoreNames.contains(dbInfo.storeName)&&dbInfo.version<=dbInfo.db.version)return dbInfo.db&&(dbInfo.version=dbInfo.db.version+1),_getUpgradedConnection(dbInfo)}).then(function(){return function(dbInfo){_deferReadiness(dbInfo);for(var dbContext=dbContexts[dbInfo.name],forages=dbContext.forages,i=0;i<forages.length;i++){var forage=forages[i];forage._dbInfo.db&&(forage._dbInfo.db.close(),forage._dbInfo.db=null)}return dbInfo.db=null,_getOriginalConnection(dbInfo).then(function(db){return dbInfo.db=db,_isUpgradeNeeded(dbInfo)?_getUpgradedConnection(dbInfo):db}).then(function(db){dbInfo.db=dbContext.db=db;for(var i=0;i<forages.length;i++)forages[i]._dbInfo.db=db}).catch(function(err){throw _rejectReadiness(dbInfo,err),err})}(dbInfo).then(function(){createTransaction(dbInfo,mode,callback,retries-1)})}).catch(callback);callback(err)}}var asyncStorage={_driver:"asyncStorage",_initStorage:function(options){var self=this,dbInfo={db:null};if(options)for(var i in options)dbInfo[i]=options[i];var dbContext=dbContexts[dbInfo.name];dbContext||(dbContext={forages:[],db:null,dbReady:null,deferredOperations:[]},dbContexts[dbInfo.name]=dbContext),dbContext.forages.push(self),self._initReady||(self._initReady=self.ready,self.ready=_fullyReady);var initPromises=[];function ignoreErrors(){return Promise$1.resolve()}for(var j=0;j<dbContext.forages.length;j++){var forage=dbContext.forages[j];forage!==self&&initPromises.push(forage._initReady().catch(ignoreErrors))}var forages=dbContext.forages.slice(0);return Promise$1.all(initPromises).then(function(){return dbInfo.db=dbContext.db,_getOriginalConnection(dbInfo)}).then(function(db){return dbInfo.db=db,_isUpgradeNeeded(dbInfo,self._defaultConfig.version)?_getUpgradedConnection(dbInfo):db}).then(function(db){dbInfo.db=dbContext.db=db,self._dbInfo=dbInfo;for(var k=0;k<forages.length;k++){var forage=forages[k];forage!==self&&(forage._dbInfo.db=dbInfo.db,forage._dbInfo.version=dbInfo.version)}})},_support:function(){try{if(!idb)return!1;var isSafari="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),hasFetch="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!isSafari||hasFetch)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(e){return!1}}(),iterate:function(iterator,callback){var self=this,promise=new Promise$1(function(resolve,reject){self.ready().then(function(){createTransaction(self._dbInfo,READ_ONLY,function(err,transaction){if(err)return reject(err);try{var store=transaction.objectStore(self._dbInfo.storeName),req=store.openCursor(),iterationNumber=1;req.onsuccess=function(){var cursor=req.result;if(cursor){var value=cursor.value;_isEncodedBlob(value)&&(value=_decodeBlob(value));var result=iterator(value,cursor.key,iterationNumber++);void 0!==result?resolve(result):cursor.continue()}else resolve()},req.onerror=function(){reject(req.error)}}catch(e){reject(e)}})}).catch(reject)});return executeCallback(promise,callback),promise},getItem:function(key,callback){var self=this;key=normalizeKey(key);var promise=new Promise$1(function(resolve,reject){self.ready().then(function(){createTransaction(self._dbInfo,READ_ONLY,function(err,transaction){if(err)return reject(err);try{var store=transaction.objectStore(self._dbInfo.storeName),req=store.get(key);req.onsuccess=function(){var value=req.result;void 0===value&&(value=null),_isEncodedBlob(value)&&(value=_decodeBlob(value)),resolve(value)},req.onerror=function(){reject(req.error)}}catch(e){reject(e)}})}).catch(reject)});return executeCallback(promise,callback),promise},setItem:function(key,value,callback){var self=this;key=normalizeKey(key);var promise=new Promise$1(function(resolve,reject){var dbInfo;self.ready().then(function(){return dbInfo=self._dbInfo,"[object Blob]"===toString.call(value)?_checkBlobSupport(dbInfo.db).then(function(blobSupport){return blobSupport?value:(blob=value,new Promise$1(function(resolve,reject){var reader=new FileReader;reader.onerror=reject,reader.onloadend=function(e){var base64=btoa(e.target.result||"");resolve({__local_forage_encoded_blob:!0,data:base64,type:blob.type})},reader.readAsBinaryString(blob)}));var blob}):value}).then(function(value){createTransaction(self._dbInfo,READ_WRITE,function(err,transaction){if(err)return reject(err);try{var store=transaction.objectStore(self._dbInfo.storeName);null===value&&(value=void 0);var req=store.put(value,key);transaction.oncomplete=function(){void 0===value&&(value=null),resolve(value)},transaction.onabort=transaction.onerror=function(){var err=req.error?req.error:req.transaction.error;reject(err)}}catch(e){reject(e)}})}).catch(reject)});return executeCallback(promise,callback),promise},removeItem:function(key,callback){var self=this;key=normalizeKey(key);var promise=new Promise$1(function(resolve,reject){self.ready().then(function(){createTransaction(self._dbInfo,READ_WRITE,function(err,transaction){if(err)return reject(err);try{var store=transaction.objectStore(self._dbInfo.storeName),req=store.delete(key);transaction.oncomplete=function(){resolve()},transaction.onerror=function(){reject(req.error)},transaction.onabort=function(){var err=req.error?req.error:req.transaction.error;reject(err)}}catch(e){reject(e)}})}).catch(reject)});return executeCallback(promise,callback),promise},clear:function(callback){var self=this,promise=new Promise$1(function(resolve,reject){self.ready().then(function(){createTransaction(self._dbInfo,READ_WRITE,function(err,transaction){if(err)return reject(err);try{var store=transaction.objectStore(self._dbInfo.storeName),req=store.clear();transaction.oncomplete=function(){resolve()},transaction.onabort=transaction.onerror=function(){var err=req.error?req.error:req.transaction.error;reject(err)}}catch(e){reject(e)}})}).catch(reject)});return executeCallback(promise,callback),promise},length:function(callback){var self=this,promise=new Promise$1(function(resolve,reject){self.ready().then(function(){createTransaction(self._dbInfo,READ_ONLY,function(err,transaction){if(err)return reject(err);try{var store=transaction.objectStore(self._dbInfo.storeName),req=store.count();req.onsuccess=function(){resolve(req.result)},req.onerror=function(){reject(req.error)}}catch(e){reject(e)}})}).catch(reject)});return executeCallback(promise,callback),promise},key:function(n,callback){var self=this,promise=new Promise$1(function(resolve,reject){n<0?resolve(null):self.ready().then(function(){createTransaction(self._dbInfo,READ_ONLY,function(err,transaction){if(err)return reject(err);try{var store=transaction.objectStore(self._dbInfo.storeName),advanced=!1,req=store.openCursor();req.onsuccess=function(){var cursor=req.result;cursor?0===n?resolve(cursor.key):advanced?resolve(cursor.key):(advanced=!0,cursor.advance(n)):resolve(null)},req.onerror=function(){reject(req.error)}}catch(e){reject(e)}})}).catch(reject)});return executeCallback(promise,callback),promise},keys:function(callback){var self=this,promise=new Promise$1(function(resolve,reject){self.ready().then(function(){createTransaction(self._dbInfo,READ_ONLY,function(err,transaction){if(err)return reject(err);try{var store=transaction.objectStore(self._dbInfo.storeName),req=store.openCursor(),keys=[];req.onsuccess=function(){var cursor=req.result;cursor?(keys.push(cursor.key),cursor.continue()):resolve(keys)},req.onerror=function(){reject(req.error)}}catch(e){reject(e)}})}).catch(reject)});return executeCallback(promise,callback),promise},dropInstance:function(options,callback){callback=getCallback.apply(this,arguments);var promise,currentConfig=this.config();if((options="function"!=typeof options&&options||{}).name||(options.name=options.name||currentConfig.name,options.storeName=options.storeName||currentConfig.storeName),options.name){var isCurrentDb=options.name===currentConfig.name&&this._dbInfo.db,dbPromise=isCurrentDb?Promise$1.resolve(this._dbInfo.db):_getOriginalConnection(options).then(function(db){var dbContext=dbContexts[options.name],forages=dbContext.forages;dbContext.db=db;for(var i=0;i<forages.length;i++)forages[i]._dbInfo.db=db;return db});promise=options.storeName?dbPromise.then(function(db){if(db.objectStoreNames.contains(options.storeName)){var newVersion=db.version+1;_deferReadiness(options);var dbContext=dbContexts[options.name],forages=dbContext.forages;db.close();for(var i=0;i<forages.length;i++){var forage=forages[i];forage._dbInfo.db=null,forage._dbInfo.version=newVersion}var dropObjectPromise=new Promise$1(function(resolve,reject){var req=idb.open(options.name,newVersion);req.onerror=function(err){var db=req.result;db.close(),reject(err)},req.onupgradeneeded=function(){var db=req.result;db.deleteObjectStore(options.storeName)},req.onsuccess=function(){var db=req.result;db.close(),resolve(db)}});return dropObjectPromise.then(function(db){dbContext.db=db;for(var j=0;j<forages.length;j++){var _forage2=forages[j];_forage2._dbInfo.db=db,_advanceReadiness(_forage2._dbInfo)}}).catch(function(err){throw(_rejectReadiness(options,err)||Promise$1.resolve()).catch(function(){}),err})}}):dbPromise.then(function(db){_deferReadiness(options);var dbContext=dbContexts[options.name],forages=dbContext.forages;db.close();for(var i=0;i<forages.length;i++){var forage=forages[i];forage._dbInfo.db=null}var dropDBPromise=new Promise$1(function(resolve,reject){var req=idb.deleteDatabase(options.name);req.onerror=req.onblocked=function(err){var db=req.result;db&&db.close(),reject(err)},req.onsuccess=function(){var db=req.result;db&&db.close(),resolve(db)}});return dropDBPromise.then(function(db){dbContext.db=db;for(var i=0;i<forages.length;i++){var _forage=forages[i];_advanceReadiness(_forage._dbInfo)}}).catch(function(err){throw(_rejectReadiness(options,err)||Promise$1.resolve()).catch(function(){}),err})})}else promise=Promise$1.reject("Invalid arguments");return executeCallback(promise,callback),promise}},BASE_CHARS="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",BLOB_TYPE_PREFIX="~~local_forage_type~",BLOB_TYPE_PREFIX_REGEX=/^~~local_forage_type~([^~]+)~/,SERIALIZED_MARKER="__lfsc__:",SERIALIZED_MARKER_LENGTH=SERIALIZED_MARKER.length,TYPE_ARRAYBUFFER="arbf",TYPE_BLOB="blob",TYPE_INT8ARRAY="si08",TYPE_UINT8ARRAY="ui08",TYPE_UINT8CLAMPEDARRAY="uic8",TYPE_INT16ARRAY="si16",TYPE_INT32ARRAY="si32",TYPE_UINT16ARRAY="ur16",TYPE_UINT32ARRAY="ui32",TYPE_FLOAT32ARRAY="fl32",TYPE_FLOAT64ARRAY="fl64",TYPE_SERIALIZED_MARKER_LENGTH=SERIALIZED_MARKER_LENGTH+TYPE_ARRAYBUFFER.length,toString$1=Object.prototype.toString;function stringToBuffer(serializedString){var i,encoded1,encoded2,encoded3,encoded4,bufferLength=.75*serializedString.length,len=serializedString.length,p=0;"="===serializedString[serializedString.length-1]&&(bufferLength--,"="===serializedString[serializedString.length-2]&&bufferLength--);var buffer=new ArrayBuffer(bufferLength),bytes=new Uint8Array(buffer);for(i=0;i<len;i+=4)encoded1=BASE_CHARS.indexOf(serializedString[i]),encoded2=BASE_CHARS.indexOf(serializedString[i+1]),encoded3=BASE_CHARS.indexOf(serializedString[i+2]),encoded4=BASE_CHARS.indexOf(serializedString[i+3]),bytes[p++]=encoded1<<2|encoded2>>4,bytes[p++]=(15&encoded2)<<4|encoded3>>2,bytes[p++]=(3&encoded3)<<6|63&encoded4;return buffer}function bufferToString(buffer){var i,bytes=new Uint8Array(buffer),base64String="";for(i=0;i<bytes.length;i+=3)base64String+=BASE_CHARS[bytes[i]>>2],base64String+=BASE_CHARS[(3&bytes[i])<<4|bytes[i+1]>>4],base64String+=BASE_CHARS[(15&bytes[i+1])<<2|bytes[i+2]>>6],base64String+=BASE_CHARS[63&bytes[i+2]];return bytes.length%3==2?base64String=base64String.substring(0,base64String.length-1)+"=":bytes.length%3==1&&(base64String=base64String.substring(0,base64String.length-2)+"=="),base64String}var localforageSerializer={serialize:function(value,callback){var valueType="";if(value&&(valueType=toString$1.call(value)),value&&("[object ArrayBuffer]"===valueType||value.buffer&&"[object ArrayBuffer]"===toString$1.call(value.buffer))){var buffer,marker=SERIALIZED_MARKER;value instanceof ArrayBuffer?(buffer=value,marker+=TYPE_ARRAYBUFFER):(buffer=value.buffer,"[object Int8Array]"===valueType?marker+=TYPE_INT8ARRAY:"[object Uint8Array]"===valueType?marker+=TYPE_UINT8ARRAY:"[object Uint8ClampedArray]"===valueType?marker+=TYPE_UINT8CLAMPEDARRAY:"[object Int16Array]"===valueType?marker+=TYPE_INT16ARRAY:"[object Uint16Array]"===valueType?marker+=TYPE_UINT16ARRAY:"[object Int32Array]"===valueType?marker+=TYPE_INT32ARRAY:"[object Uint32Array]"===valueType?marker+=TYPE_UINT32ARRAY:"[object Float32Array]"===valueType?marker+=TYPE_FLOAT32ARRAY:"[object Float64Array]"===valueType?marker+=TYPE_FLOAT64ARRAY:callback(new Error("Failed to get type for BinaryArray"))),callback(marker+bufferToString(buffer))}else if("[object Blob]"===valueType){var fileReader=new FileReader;fileReader.onload=function(){var str=BLOB_TYPE_PREFIX+value.type+"~"+bufferToString(this.result);callback(SERIALIZED_MARKER+TYPE_BLOB+str)},fileReader.readAsArrayBuffer(value)}else try{callback(JSON.stringify(value))}catch(e){console.error("Couldn't convert value into a JSON string: ",value),callback(null,e)}},deserialize:function(value){if(value.substring(0,SERIALIZED_MARKER_LENGTH)!==SERIALIZED_MARKER)return JSON.parse(value);var blobType,serializedString=value.substring(TYPE_SERIALIZED_MARKER_LENGTH),type=value.substring(SERIALIZED_MARKER_LENGTH,TYPE_SERIALIZED_MARKER_LENGTH);if(type===TYPE_BLOB&&BLOB_TYPE_PREFIX_REGEX.test(serializedString)){var matcher=serializedString.match(BLOB_TYPE_PREFIX_REGEX);blobType=matcher[1],serializedString=serializedString.substring(matcher[0].length)}var buffer=stringToBuffer(serializedString);switch(type){case TYPE_ARRAYBUFFER:return buffer;case TYPE_BLOB:return createBlob([buffer],{type:blobType});case TYPE_INT8ARRAY:return new Int8Array(buffer);case TYPE_UINT8ARRAY:return new Uint8Array(buffer);case TYPE_UINT8CLAMPEDARRAY:return new Uint8ClampedArray(buffer);case TYPE_INT16ARRAY:return new Int16Array(buffer);case TYPE_UINT16ARRAY:return new Uint16Array(buffer);case TYPE_INT32ARRAY:return new Int32Array(buffer);case TYPE_UINT32ARRAY:return new Uint32Array(buffer);case TYPE_FLOAT32ARRAY:return new Float32Array(buffer);case TYPE_FLOAT64ARRAY:return new Float64Array(buffer);default:throw new Error("Unkown type: "+type)}},stringToBuffer:stringToBuffer,bufferToString:bufferToString};function createDbTable(t,dbInfo,callback,errorCallback){t.executeSql("CREATE TABLE IF NOT EXISTS "+dbInfo.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],callback,errorCallback)}function tryExecuteSql(t,dbInfo,sqlStatement,args,callback,errorCallback){t.executeSql(sqlStatement,args,callback,function(t,error){error.code===error.SYNTAX_ERR?t.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[dbInfo.storeName],function(t,results){results.rows.length?errorCallback(t,error):createDbTable(t,dbInfo,function(){t.executeSql(sqlStatement,args,callback,errorCallback)},errorCallback)},errorCallback):errorCallback(t,error)},errorCallback)}var webSQLStorage={_driver:"webSQLStorage",_initStorage:function(options){var self=this,dbInfo={db:null};if(options)for(var i in options)dbInfo[i]="string"!=typeof options[i]?options[i].toString():options[i];var dbInfoPromise=new Promise$1(function(resolve,reject){try{dbInfo.db=openDatabase(dbInfo.name,String(dbInfo.version),dbInfo.description,dbInfo.size)}catch(e){return reject(e)}dbInfo.db.transaction(function(t){createDbTable(t,dbInfo,function(){self._dbInfo=dbInfo,resolve()},function(t,error){reject(error)})},reject)});return dbInfo.serializer=localforageSerializer,dbInfoPromise},_support:"function"==typeof openDatabase,iterate:function(iterator,callback){var self=this,promise=new Promise$1(function(resolve,reject){self.ready().then(function(){var dbInfo=self._dbInfo;dbInfo.db.transaction(function(t){tryExecuteSql(t,dbInfo,"SELECT * FROM "+dbInfo.storeName,[],function(t,results){for(var rows=results.rows,length=rows.length,i=0;i<length;i++){var item=rows.item(i),result=item.value;if(result&&(result=dbInfo.serializer.deserialize(result)),void 0!==(result=iterator(result,item.key,i+1)))return void resolve(result)}resolve()},function(t,error){reject(error)})})}).catch(reject)});return executeCallback(promise,callback),promise},getItem:function(key,callback){var self=this;key=normalizeKey(key);var promise=new Promise$1(function(resolve,reject){self.ready().then(function(){var dbInfo=self._dbInfo;dbInfo.db.transaction(function(t){tryExecuteSql(t,dbInfo,"SELECT * FROM "+dbInfo.storeName+" WHERE key = ? LIMIT 1",[key],function(t,results){var result=results.rows.length?results.rows.item(0).value:null;result&&(result=dbInfo.serializer.deserialize(result)),resolve(result)},function(t,error){reject(error)})})}).catch(reject)});return executeCallback(promise,callback),promise},setItem:function(key,value,callback){return function _setItem(key,value,callback,retriesLeft){var self=this;key=normalizeKey(key);var promise=new Promise$1(function(resolve,reject){self.ready().then(function(){void 0===value&&(value=null);var originalValue=value,dbInfo=self._dbInfo;dbInfo.serializer.serialize(value,function(value,error){error?reject(error):dbInfo.db.transaction(function(t){tryExecuteSql(t,dbInfo,"INSERT OR REPLACE INTO "+dbInfo.storeName+" (key, value) VALUES (?, ?)",[key,value],function(){resolve(originalValue)},function(t,error){reject(error)})},function(sqlError){if(sqlError.code===sqlError.QUOTA_ERR){if(retriesLeft>0)return void resolve(_setItem.apply(self,[key,originalValue,callback,retriesLeft-1]));reject(sqlError)}})})}).catch(reject)});return executeCallback(promise,callback),promise}.apply(this,[key,value,callback,1])},removeItem:function(key,callback){var self=this;key=normalizeKey(key);var promise=new Promise$1(function(resolve,reject){self.ready().then(function(){var dbInfo=self._dbInfo;dbInfo.db.transaction(function(t){tryExecuteSql(t,dbInfo,"DELETE FROM "+dbInfo.storeName+" WHERE key = ?",[key],function(){resolve()},function(t,error){reject(error)})})}).catch(reject)});return executeCallback(promise,callback),promise},clear:function(callback){var self=this,promise=new Promise$1(function(resolve,reject){self.ready().then(function(){var dbInfo=self._dbInfo;dbInfo.db.transaction(function(t){tryExecuteSql(t,dbInfo,"DELETE FROM "+dbInfo.storeName,[],function(){resolve()},function(t,error){reject(error)})})}).catch(reject)});return executeCallback(promise,callback),promise},length:function(callback){var self=this,promise=new Promise$1(function(resolve,reject){self.ready().then(function(){var dbInfo=self._dbInfo;dbInfo.db.transaction(function(t){tryExecuteSql(t,dbInfo,"SELECT COUNT(key) as c FROM "+dbInfo.storeName,[],function(t,results){var result=results.rows.item(0).c;resolve(result)},function(t,error){reject(error)})})}).catch(reject)});return executeCallback(promise,callback),promise},key:function(n,callback){var self=this,promise=new Promise$1(function(resolve,reject){self.ready().then(function(){var dbInfo=self._dbInfo;dbInfo.db.transaction(function(t){tryExecuteSql(t,dbInfo,"SELECT key FROM "+dbInfo.storeName+" WHERE id = ? LIMIT 1",[n+1],function(t,results){var result=results.rows.length?results.rows.item(0).key:null;resolve(result)},function(t,error){reject(error)})})}).catch(reject)});return executeCallback(promise,callback),promise},keys:function(callback){var self=this,promise=new Promise$1(function(resolve,reject){self.ready().then(function(){var dbInfo=self._dbInfo;dbInfo.db.transaction(function(t){tryExecuteSql(t,dbInfo,"SELECT key FROM "+dbInfo.storeName,[],function(t,results){for(var keys=[],i=0;i<results.rows.length;i++)keys.push(results.rows.item(i).key);resolve(keys)},function(t,error){reject(error)})})}).catch(reject)});return executeCallback(promise,callback),promise},dropInstance:function(options,callback){callback=getCallback.apply(this,arguments);var currentConfig=this.config();(options="function"!=typeof options&&options||{}).name||(options.name=options.name||currentConfig.name,options.storeName=options.storeName||currentConfig.storeName);var promise,self=this;return executeCallback(promise=options.name?new Promise$1(function(resolve){var db;db=options.name===currentConfig.name?self._dbInfo.db:openDatabase(options.name,"","",0),options.storeName?resolve({db:db,storeNames:[options.storeName]}):resolve(function(db){return new Promise$1(function(resolve,reject){db.transaction(function(t){t.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(t,results){for(var storeNames=[],i=0;i<results.rows.length;i++)storeNames.push(results.rows.item(i).name);resolve({db:db,storeNames:storeNames})},function(t,error){reject(error)})},function(sqlError){reject(sqlError)})})}(db))}).then(function(operationInfo){return new Promise$1(function(resolve,reject){operationInfo.db.transaction(function(t){function dropTable(storeName){return new Promise$1(function(resolve,reject){t.executeSql("DROP TABLE IF EXISTS "+storeName,[],function(){resolve()},function(t,error){reject(error)})})}for(var operations=[],i=0,len=operationInfo.storeNames.length;i<len;i++)operations.push(dropTable(operationInfo.storeNames[i]));Promise$1.all(operations).then(function(){resolve()}).catch(function(e){reject(e)})},function(sqlError){reject(sqlError)})})}):Promise$1.reject("Invalid arguments"),callback),promise}};function _getKeyPrefix(options,defaultConfig){var keyPrefix=options.name+"/";return options.storeName!==defaultConfig.storeName&&(keyPrefix+=options.storeName+"/"),keyPrefix}function _isLocalStorageUsable(){return!function(){try{return localStorage.setItem("_localforage_support_test",!0),localStorage.removeItem("_localforage_support_test"),!1}catch(e){return!0}}()||localStorage.length>0}var localStorageWrapper={_driver:"localStorageWrapper",_initStorage:function(options){var dbInfo={};if(options)for(var i in options)dbInfo[i]=options[i];return dbInfo.keyPrefix=_getKeyPrefix(options,this._defaultConfig),_isLocalStorageUsable()?(this._dbInfo=dbInfo,dbInfo.serializer=localforageSerializer,Promise$1.resolve()):Promise$1.reject()},_support:function(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(e){return!1}}(),iterate:function(iterator,callback){var self=this,promise=self.ready().then(function(){for(var dbInfo=self._dbInfo,keyPrefix=dbInfo.keyPrefix,keyPrefixLength=keyPrefix.length,length=localStorage.length,iterationNumber=1,i=0;i<length;i++){var key=localStorage.key(i);if(0===key.indexOf(keyPrefix)){var value=localStorage.getItem(key);if(value&&(value=dbInfo.serializer.deserialize(value)),void 0!==(value=iterator(value,key.substring(keyPrefixLength),iterationNumber++)))return value}}});return executeCallback(promise,callback),promise},getItem:function(key,callback){var self=this;key=normalizeKey(key);var promise=self.ready().then(function(){var dbInfo=self._dbInfo,result=localStorage.getItem(dbInfo.keyPrefix+key);return result&&(result=dbInfo.serializer.deserialize(result)),result});return executeCallback(promise,callback),promise},setItem:function(key,value,callback){var self=this;key=normalizeKey(key);var promise=self.ready().then(function(){void 0===value&&(value=null);var originalValue=value;return new Promise$1(function(resolve,reject){var dbInfo=self._dbInfo;dbInfo.serializer.serialize(value,function(value,error){if(error)reject(error);else try{localStorage.setItem(dbInfo.keyPrefix+key,value),resolve(originalValue)}catch(e){"QuotaExceededError"!==e.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==e.name||reject(e),reject(e)}})})});return executeCallback(promise,callback),promise},removeItem:function(key,callback){var self=this;key=normalizeKey(key);var promise=self.ready().then(function(){var dbInfo=self._dbInfo;localStorage.removeItem(dbInfo.keyPrefix+key)});return executeCallback(promise,callback),promise},clear:function(callback){var self=this,promise=self.ready().then(function(){for(var keyPrefix=self._dbInfo.keyPrefix,i=localStorage.length-1;i>=0;i--){var key=localStorage.key(i);0===key.indexOf(keyPrefix)&&localStorage.removeItem(key)}});return executeCallback(promise,callback),promise},length:function(callback){var promise=this.keys().then(function(keys){return keys.length});return executeCallback(promise,callback),promise},key:function(n,callback){var self=this,promise=self.ready().then(function(){var result,dbInfo=self._dbInfo;try{result=localStorage.key(n)}catch(error){result=null}return result&&(result=result.substring(dbInfo.keyPrefix.length)),result});return executeCallback(promise,callback),promise},keys:function(callback){var self=this,promise=self.ready().then(function(){for(var dbInfo=self._dbInfo,length=localStorage.length,keys=[],i=0;i<length;i++){var itemKey=localStorage.key(i);0===itemKey.indexOf(dbInfo.keyPrefix)&&keys.push(itemKey.substring(dbInfo.keyPrefix.length))}return keys});return executeCallback(promise,callback),promise},dropInstance:function(options,callback){if(callback=getCallback.apply(this,arguments),!(options="function"!=typeof options&&options||{}).name){var currentConfig=this.config();options.name=options.name||currentConfig.name,options.storeName=options.storeName||currentConfig.storeName}var promise,self=this;return executeCallback(promise=options.name?new Promise$1(function(resolve){options.storeName?resolve(_getKeyPrefix(options,self._defaultConfig)):resolve(options.name+"/")}).then(function(keyPrefix){for(var i=localStorage.length-1;i>=0;i--){var key=localStorage.key(i);0===key.indexOf(keyPrefix)&&localStorage.removeItem(key)}}):Promise$1.reject("Invalid arguments"),callback),promise}},includes=function(array,searchElement){for(var len=array.length,i=0;i<len;){if((x=array[i])===(y=searchElement)||"number"==typeof x&&"number"==typeof y&&isNaN(x)&&isNaN(y))return!0;i++}var x,y;return!1},isArray=Array.isArray||function(arg){return"[object Array]"===Object.prototype.toString.call(arg)},DefinedDrivers={},DriverSupport={},DefaultDrivers={INDEXEDDB:asyncStorage,WEBSQL:webSQLStorage,LOCALSTORAGE:localStorageWrapper},DefaultDriverOrder=[DefaultDrivers.INDEXEDDB._driver,DefaultDrivers.WEBSQL._driver,DefaultDrivers.LOCALSTORAGE._driver],OptionalDriverMethods=["dropInstance"],LibraryMethods=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(OptionalDriverMethods),DefaultConfig={description:"",driver:DefaultDriverOrder.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function callWhenReady(localForageInstance,libraryMethod){localForageInstance[libraryMethod]=function(){var _args=arguments;return localForageInstance.ready().then(function(){return localForageInstance[libraryMethod].apply(localForageInstance,_args)})}}function extend(){for(var i=1;i<arguments.length;i++){var arg=arguments[i];if(arg)for(var _key in arg)arg.hasOwnProperty(_key)&&(isArray(arg[_key])?arguments[0][_key]=arg[_key].slice():arguments[0][_key]=arg[_key])}return arguments[0]}var LocalForage=function(){function LocalForage(options){for(var driverTypeKey in function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,LocalForage),DefaultDrivers)if(DefaultDrivers.hasOwnProperty(driverTypeKey)){var driver=DefaultDrivers[driverTypeKey],driverName=driver._driver;this[driverTypeKey]=driverName,DefinedDrivers[driverName]||this.defineDriver(driver)}this._defaultConfig=extend({},DefaultConfig),this._config=extend({},this._defaultConfig,options),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return LocalForage.prototype.config=function(options){if("object"===(void 0===options?"undefined":_typeof(options))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var i in options){if("storeName"===i&&(options[i]=options[i].replace(/\W/g,"_")),"version"===i&&"number"!=typeof options[i])return new Error("Database version must be a number.");this._config[i]=options[i]}return!("driver"in options&&options.driver)||this.setDriver(this._config.driver)}return"string"==typeof options?this._config[options]:this._config},LocalForage.prototype.defineDriver=function(driverObject,callback,errorCallback){var promise=new Promise$1(function(resolve,reject){try{var driverName=driverObject._driver,complianceError=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!driverObject._driver)return void reject(complianceError);for(var driverMethods=LibraryMethods.concat("_initStorage"),i=0,len=driverMethods.length;i<len;i++){var driverMethodName=driverMethods[i],isRequired=!includes(OptionalDriverMethods,driverMethodName);if((isRequired||driverObject[driverMethodName])&&"function"!=typeof driverObject[driverMethodName])return void reject(complianceError)}!function(){for(var methodNotImplementedFactory=function(methodName){return function(){var error=new Error("Method "+methodName+" is not implemented by the current driver"),promise=Promise$1.reject(error);return executeCallback(promise,arguments[arguments.length-1]),promise}},_i=0,_len=OptionalDriverMethods.length;_i<_len;_i++){var optionalDriverMethod=OptionalDriverMethods[_i];driverObject[optionalDriverMethod]||(driverObject[optionalDriverMethod]=methodNotImplementedFactory(optionalDriverMethod))}}();var setDriverSupport=function(support){DefinedDrivers[driverName]&&console.info("Redefining LocalForage driver: "+driverName),DefinedDrivers[driverName]=driverObject,DriverSupport[driverName]=support,resolve()};"_support"in driverObject?driverObject._support&&"function"==typeof driverObject._support?driverObject._support().then(setDriverSupport,reject):setDriverSupport(!!driverObject._support):setDriverSupport(!0)}catch(e){reject(e)}});return executeTwoCallbacks(promise,callback,errorCallback),promise},LocalForage.prototype.driver=function(){return this._driver||null},LocalForage.prototype.getDriver=function(driverName,callback,errorCallback){var getDriverPromise=DefinedDrivers[driverName]?Promise$1.resolve(DefinedDrivers[driverName]):Promise$1.reject(new Error("Driver not found."));return executeTwoCallbacks(getDriverPromise,callback,errorCallback),getDriverPromise},LocalForage.prototype.getSerializer=function(callback){var serializerPromise=Promise$1.resolve(localforageSerializer);return executeTwoCallbacks(serializerPromise,callback),serializerPromise},LocalForage.prototype.ready=function(callback){var self=this,promise=self._driverSet.then(function(){return null===self._ready&&(self._ready=self._initDriver()),self._ready});return executeTwoCallbacks(promise,callback,callback),promise},LocalForage.prototype.setDriver=function(drivers,callback,errorCallback){var self=this;isArray(drivers)||(drivers=[drivers]);var supportedDrivers=this._getSupportedDrivers(drivers);function setDriverToConfig(){self._config.driver=self.driver()}function extendSelfWithDriver(driver){return self._extend(driver),setDriverToConfig(),self._ready=self._initStorage(self._config),self._ready}var oldDriverSetDone=null!==this._driverSet?this._driverSet.catch(function(){return Promise$1.resolve()}):Promise$1.resolve();return this._driverSet=oldDriverSetDone.then(function(){var driverName=supportedDrivers[0];return self._dbInfo=null,self._ready=null,self.getDriver(driverName).then(function(driver){self._driver=driver._driver,setDriverToConfig(),self._wrapLibraryMethodsWithReady(),self._initDriver=function(supportedDrivers){return function(){var currentDriverIndex=0;return function driverPromiseLoop(){for(;currentDriverIndex<supportedDrivers.length;){var driverName=supportedDrivers[currentDriverIndex];return currentDriverIndex++,self._dbInfo=null,self._ready=null,self.getDriver(driverName).then(extendSelfWithDriver).catch(driverPromiseLoop)}setDriverToConfig();var error=new Error("No available storage method found.");return self._driverSet=Promise$1.reject(error),self._driverSet}()}}(supportedDrivers)})}).catch(function(){setDriverToConfig();var error=new Error("No available storage method found.");return self._driverSet=Promise$1.reject(error),self._driverSet}),executeTwoCallbacks(this._driverSet,callback,errorCallback),this._driverSet},LocalForage.prototype.supports=function(driverName){return!!DriverSupport[driverName]},LocalForage.prototype._extend=function(libraryMethodsAndProperties){extend(this,libraryMethodsAndProperties)},LocalForage.prototype._getSupportedDrivers=function(drivers){for(var supportedDrivers=[],i=0,len=drivers.length;i<len;i++){var driverName=drivers[i];this.supports(driverName)&&supportedDrivers.push(driverName)}return supportedDrivers},LocalForage.prototype._wrapLibraryMethodsWithReady=function(){for(var i=0,len=LibraryMethods.length;i<len;i++)callWhenReady(this,LibraryMethods[i])},LocalForage.prototype.createInstance=function(options){return new LocalForage(options)},LocalForage}(),localforage_js=new LocalForage;module.exports=localforage_js},{3:3}]},{},[4])(4)}).call(this,__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/buildin/global.js?8fce"))},"./node_modules/minimatch/minimatch.js":function(module,exports,__webpack_require__){module.exports=minimatch,minimatch.Minimatch=Minimatch;var path={sep:"/"};try{path=__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/node_modules/path-browserify/index.js")}catch(er){}var GLOBSTAR=minimatch.GLOBSTAR=Minimatch.GLOBSTAR={},expand=__webpack_require__("./node_modules/brace-expansion/index.js"),plTypes={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},qmark="[^/]",star=qmark+"*?",twoStarDot="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",twoStarNoDot="(?:(?!(?:\\/|^)\\.).)*?",reSpecials="().*{}+?[]^$\\!".split("").reduce(function(set,c){return set[c]=!0,set},{});var slashSplit=/\/+/;function ext(a,b){a=a||{},b=b||{};var t={};return Object.keys(b).forEach(function(k){t[k]=b[k]}),Object.keys(a).forEach(function(k){t[k]=a[k]}),t}function minimatch(p,pattern,options){if("string"!=typeof pattern)throw new TypeError("glob pattern string required");return options||(options={}),!(!options.nocomment&&"#"===pattern.charAt(0))&&(""===pattern.trim()?""===p:new Minimatch(pattern,options).match(p))}function Minimatch(pattern,options){if(!(this instanceof Minimatch))return new Minimatch(pattern,options);if("string"!=typeof pattern)throw new TypeError("glob pattern string required");options||(options={}),pattern=pattern.trim(),"/"!==path.sep&&(pattern=pattern.split(path.sep).join("/")),this.options=options,this.set=[],this.pattern=pattern,this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.make()}function braceExpand(pattern,options){if(options||(options=this instanceof Minimatch?this.options:{}),void 0===(pattern=void 0===pattern?this.pattern:pattern))throw new TypeError("undefined pattern");return options.nobrace||!pattern.match(/\{.*\}/)?[pattern]:expand(pattern)}minimatch.filter=function(pattern,options){return options=options||{},function(p,i,list){return minimatch(p,pattern,options)}},minimatch.defaults=function(def){if(!def||!Object.keys(def).length)return minimatch;var orig=minimatch,m=function(p,pattern,options){return orig.minimatch(p,pattern,ext(def,options))};return m.Minimatch=function(pattern,options){return new orig.Minimatch(pattern,ext(def,options))},m},Minimatch.defaults=function(def){return def&&Object.keys(def).length?minimatch.defaults(def).Minimatch:Minimatch},Minimatch.prototype.debug=function(){},Minimatch.prototype.make=function(){if(this._made)return;var pattern=this.pattern,options=this.options;if(!options.nocomment&&"#"===pattern.charAt(0))return void(this.comment=!0);if(!pattern)return void(this.empty=!0);this.parseNegate();var set=this.globSet=this.braceExpand();options.debug&&(this.debug=console.error);this.debug(this.pattern,set),set=this.globParts=set.map(function(s){return s.split(slashSplit)}),this.debug(this.pattern,set),set=set.map(function(s,si,set){return s.map(this.parse,this)},this),this.debug(this.pattern,set),set=set.filter(function(s){return-1===s.indexOf(!1)}),this.debug(this.pattern,set),this.set=set},Minimatch.prototype.parseNegate=function(){var pattern=this.pattern,negate=!1,negateOffset=0;if(this.options.nonegate)return;for(var i=0,l=pattern.length;i<l&&"!"===pattern.charAt(i);i++)negate=!negate,negateOffset++;negateOffset&&(this.pattern=pattern.substr(negateOffset));this.negate=negate},minimatch.braceExpand=function(pattern,options){return braceExpand(pattern,options)},Minimatch.prototype.braceExpand=braceExpand,Minimatch.prototype.parse=function(pattern,isSub){if(pattern.length>65536)throw new TypeError("pattern is too long");var options=this.options;if(!options.noglobstar&&"**"===pattern)return GLOBSTAR;if(""===pattern)return"";var stateChar,re="",hasMagic=!!options.nocase,escaping=!1,patternListStack=[],negativeLists=[],inClass=!1,reClassStart=-1,classStart=-1,patternStart="."===pattern.charAt(0)?"":options.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",self=this;function clearStateChar(){if(stateChar){switch(stateChar){case"*":re+=star,hasMagic=!0;break;case"?":re+=qmark,hasMagic=!0;break;default:re+="\\"+stateChar}self.debug("clearStateChar %j %j",stateChar,re),stateChar=!1}}for(var c,i=0,len=pattern.length;i<len&&(c=pattern.charAt(i));i++)if(this.debug("%s\t%s %s %j",pattern,i,re,c),escaping&&reSpecials[c])re+="\\"+c,escaping=!1;else switch(c){case"/":return!1;case"\\":clearStateChar(),escaping=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s\t%s %s %j <-- stateChar",pattern,i,re,c),inClass){this.debug("  in class"),"!"===c&&i===classStart+1&&(c="^"),re+=c;continue}self.debug("call clearStateChar %j",stateChar),clearStateChar(),stateChar=c,options.noext&&clearStateChar();continue;case"(":if(inClass){re+="(";continue}if(!stateChar){re+="\\(";continue}patternListStack.push({type:stateChar,start:i-1,reStart:re.length,open:plTypes[stateChar].open,close:plTypes[stateChar].close}),re+="!"===stateChar?"(?:(?!(?:":"(?:",this.debug("plType %j %j",stateChar,re),stateChar=!1;continue;case")":if(inClass||!patternListStack.length){re+="\\)";continue}clearStateChar(),hasMagic=!0;var pl=patternListStack.pop();re+=pl.close,"!"===pl.type&&negativeLists.push(pl),pl.reEnd=re.length;continue;case"|":if(inClass||!patternListStack.length||escaping){re+="\\|",escaping=!1;continue}clearStateChar(),re+="|";continue;case"[":if(clearStateChar(),inClass){re+="\\"+c;continue}inClass=!0,classStart=i,reClassStart=re.length,re+=c;continue;case"]":if(i===classStart+1||!inClass){re+="\\"+c,escaping=!1;continue}if(inClass){var cs=pattern.substring(classStart+1,i);try{RegExp("["+cs+"]")}catch(er){var sp=this.parse(cs,SUBPARSE);re=re.substr(0,reClassStart)+"\\["+sp[0]+"\\]",hasMagic=hasMagic||sp[1],inClass=!1;continue}}hasMagic=!0,inClass=!1,re+=c;continue;default:clearStateChar(),escaping?escaping=!1:!reSpecials[c]||"^"===c&&inClass||(re+="\\"),re+=c}inClass&&(cs=pattern.substr(classStart+1),sp=this.parse(cs,SUBPARSE),re=re.substr(0,reClassStart)+"\\["+sp[0],hasMagic=hasMagic||sp[1]);for(pl=patternListStack.pop();pl;pl=patternListStack.pop()){var tail=re.slice(pl.reStart+pl.open.length);this.debug("setting tail",re,pl),tail=tail.replace(/((?:\\{2}){0,64})(\\?)\|/g,function(_,$1,$2){return $2||($2="\\"),$1+$1+$2+"|"}),this.debug("tail=%j\n   %s",tail,tail,pl,re);var t="*"===pl.type?star:"?"===pl.type?qmark:"\\"+pl.type;hasMagic=!0,re=re.slice(0,pl.reStart)+t+"\\("+tail}clearStateChar(),escaping&&(re+="\\\\");var addPatternStart=!1;switch(re.charAt(0)){case".":case"[":case"(":addPatternStart=!0}for(var n=negativeLists.length-1;n>-1;n--){var nl=negativeLists[n],nlBefore=re.slice(0,nl.reStart),nlFirst=re.slice(nl.reStart,nl.reEnd-8),nlLast=re.slice(nl.reEnd-8,nl.reEnd),nlAfter=re.slice(nl.reEnd);nlLast+=nlAfter;var openParensBefore=nlBefore.split("(").length-1,cleanAfter=nlAfter;for(i=0;i<openParensBefore;i++)cleanAfter=cleanAfter.replace(/\)[+*?]?/,"");var dollar="";""===(nlAfter=cleanAfter)&&isSub!==SUBPARSE&&(dollar="$");var newRe=nlBefore+nlFirst+nlAfter+dollar+nlLast;re=newRe}""!==re&&hasMagic&&(re="(?=.)"+re);addPatternStart&&(re=patternStart+re);if(isSub===SUBPARSE)return[re,hasMagic];if(!hasMagic)return pattern.replace(/\\(.)/g,"$1");var flags=options.nocase?"i":"";try{var regExp=new RegExp("^"+re+"$",flags)}catch(er){return new RegExp("$.")}return regExp._glob=pattern,regExp._src=re,regExp};var SUBPARSE={};minimatch.makeRe=function(pattern,options){return new Minimatch(pattern,options||{}).makeRe()},Minimatch.prototype.makeRe=function(){if(this.regexp||!1===this.regexp)return this.regexp;var set=this.set;if(!set.length)return this.regexp=!1,this.regexp;var options=this.options,twoStar=options.noglobstar?star:options.dot?twoStarDot:twoStarNoDot,flags=options.nocase?"i":"",re=set.map(function(pattern){return pattern.map(function(p){return p===GLOBSTAR?twoStar:"string"==typeof p?p.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"):p._src}).join("\\/")}).join("|");re="^(?:"+re+")$",this.negate&&(re="^(?!"+re+").*$");try{this.regexp=new RegExp(re,flags)}catch(ex){this.regexp=!1}return this.regexp},minimatch.match=function(list,pattern,options){var mm=new Minimatch(pattern,options=options||{});return list=list.filter(function(f){return mm.match(f)}),mm.options.nonull&&!list.length&&list.push(pattern),list},Minimatch.prototype.match=function(f,partial){if(this.debug("match",f,this.pattern),this.comment)return!1;if(this.empty)return""===f;if("/"===f&&partial)return!0;var options=this.options;"/"!==path.sep&&(f=f.split(path.sep).join("/"));f=f.split(slashSplit),this.debug(this.pattern,"split",f);var filename,i,set=this.set;for(this.debug(this.pattern,"set",set),i=f.length-1;i>=0&&!(filename=f[i]);i--);for(i=0;i<set.length;i++){var pattern=set[i],file=f;options.matchBase&&1===pattern.length&&(file=[filename]);var hit=this.matchOne(file,pattern,partial);if(hit)return!!options.flipNegate||!this.negate}return!options.flipNegate&&this.negate},Minimatch.prototype.matchOne=function(file,pattern,partial){var options=this.options;this.debug("matchOne",{this:this,file:file,pattern:pattern}),this.debug("matchOne",file.length,pattern.length);for(var fi=0,pi=0,fl=file.length,pl=pattern.length;fi<fl&&pi<pl;fi++,pi++){this.debug("matchOne loop");var hit,p=pattern[pi],f=file[fi];if(this.debug(pattern,p,f),!1===p)return!1;if(p===GLOBSTAR){this.debug("GLOBSTAR",[pattern,p,f]);var fr=fi,pr=pi+1;if(pr===pl){for(this.debug("** at the end");fi<fl;fi++)if("."===file[fi]||".."===file[fi]||!options.dot&&"."===file[fi].charAt(0))return!1;return!0}for(;fr<fl;){var swallowee=file[fr];if(this.debug("\nglobstar while",file,fr,pattern,pr,swallowee),this.matchOne(file.slice(fr),pattern.slice(pr),partial))return this.debug("globstar found match!",fr,fl,swallowee),!0;if("."===swallowee||".."===swallowee||!options.dot&&"."===swallowee.charAt(0)){this.debug("dot detected!",file,fr,pattern,pr);break}this.debug("globstar swallow a segment, and continue"),fr++}return!(!partial||(this.debug("\n>>> no match, partial?",file,fr,pattern,pr),fr!==fl))}if("string"==typeof p?(hit=options.nocase?f.toLowerCase()===p.toLowerCase():f===p,this.debug("string match",p,f,hit)):(hit=f.match(p),this.debug("pattern match",p,f,hit)),!hit)return!1}if(fi===fl&&pi===pl)return!0;if(fi===fl)return partial;if(pi===pl)return fi===fl-1&&""===file[fi];throw new Error("wtf?")}},"./node_modules/moment/locale sync recursive ^\\.\\/.*$":function(module,exports,__webpack_require__){var map={"./af":"./node_modules/moment/locale/af.js","./af.js":"./node_modules/moment/locale/af.js","./ar":"./node_modules/moment/locale/ar.js","./ar-dz":"./node_modules/moment/locale/ar-dz.js","./ar-dz.js":"./node_modules/moment/locale/ar-dz.js","./ar-kw":"./node_modules/moment/locale/ar-kw.js","./ar-kw.js":"./node_modules/moment/locale/ar-kw.js","./ar-ly":"./node_modules/moment/locale/ar-ly.js","./ar-ly.js":"./node_modules/moment/locale/ar-ly.js","./ar-ma":"./node_modules/moment/locale/ar-ma.js","./ar-ma.js":"./node_modules/moment/locale/ar-ma.js","./ar-sa":"./node_modules/moment/locale/ar-sa.js","./ar-sa.js":"./node_modules/moment/locale/ar-sa.js","./ar-tn":"./node_modules/moment/locale/ar-tn.js","./ar-tn.js":"./node_modules/moment/locale/ar-tn.js","./ar.js":"./node_modules/moment/locale/ar.js","./az":"./node_modules/moment/locale/az.js","./az.js":"./node_modules/moment/locale/az.js","./be":"./node_modules/moment/locale/be.js","./be.js":"./node_modules/moment/locale/be.js","./bg":"./node_modules/moment/locale/bg.js","./bg.js":"./node_modules/moment/locale/bg.js","./bm":"./node_modules/moment/locale/bm.js","./bm.js":"./node_modules/moment/locale/bm.js","./bn":"./node_modules/moment/locale/bn.js","./bn.js":"./node_modules/moment/locale/bn.js","./bo":"./node_modules/moment/locale/bo.js","./bo.js":"./node_modules/moment/locale/bo.js","./br":"./node_modules/moment/locale/br.js","./br.js":"./node_modules/moment/locale/br.js","./bs":"./node_modules/moment/locale/bs.js","./bs.js":"./node_modules/moment/locale/bs.js","./ca":"./node_modules/moment/locale/ca.js","./ca.js":"./node_modules/moment/locale/ca.js","./cs":"./node_modules/moment/locale/cs.js","./cs.js":"./node_modules/moment/locale/cs.js","./cv":"./node_modules/moment/locale/cv.js","./cv.js":"./node_modules/moment/locale/cv.js","./cy":"./node_modules/moment/locale/cy.js","./cy.js":"./node_modules/moment/locale/cy.js","./da":"./node_modules/moment/locale/da.js","./da.js":"./node_modules/moment/locale/da.js","./de":"./node_modules/moment/locale/de.js","./de-at":"./node_modules/moment/locale/de-at.js","./de-at.js":"./node_modules/moment/locale/de-at.js","./de-ch":"./node_modules/moment/locale/de-ch.js","./de-ch.js":"./node_modules/moment/locale/de-ch.js","./de.js":"./node_modules/moment/locale/de.js","./dv":"./node_modules/moment/locale/dv.js","./dv.js":"./node_modules/moment/locale/dv.js","./el":"./node_modules/moment/locale/el.js","./el.js":"./node_modules/moment/locale/el.js","./en-au":"./node_modules/moment/locale/en-au.js","./en-au.js":"./node_modules/moment/locale/en-au.js","./en-ca":"./node_modules/moment/locale/en-ca.js","./en-ca.js":"./node_modules/moment/locale/en-ca.js","./en-gb":"./node_modules/moment/locale/en-gb.js","./en-gb.js":"./node_modules/moment/locale/en-gb.js","./en-ie":"./node_modules/moment/locale/en-ie.js","./en-ie.js":"./node_modules/moment/locale/en-ie.js","./en-il":"./node_modules/moment/locale/en-il.js","./en-il.js":"./node_modules/moment/locale/en-il.js","./en-nz":"./node_modules/moment/locale/en-nz.js","./en-nz.js":"./node_modules/moment/locale/en-nz.js","./eo":"./node_modules/moment/locale/eo.js","./eo.js":"./node_modules/moment/locale/eo.js","./es":"./node_modules/moment/locale/es.js","./es-do":"./node_modules/moment/locale/es-do.js","./es-do.js":"./node_modules/moment/locale/es-do.js","./es-us":"./node_modules/moment/locale/es-us.js","./es-us.js":"./node_modules/moment/locale/es-us.js","./es.js":"./node_modules/moment/locale/es.js","./et":"./node_modules/moment/locale/et.js","./et.js":"./node_modules/moment/locale/et.js","./eu":"./node_modules/moment/locale/eu.js","./eu.js":"./node_modules/moment/locale/eu.js","./fa":"./node_modules/moment/locale/fa.js","./fa.js":"./node_modules/moment/locale/fa.js","./fi":"./node_modules/moment/locale/fi.js","./fi.js":"./node_modules/moment/locale/fi.js","./fo":"./node_modules/moment/locale/fo.js","./fo.js":"./node_modules/moment/locale/fo.js","./fr":"./node_modules/moment/locale/fr.js","./fr-ca":"./node_modules/moment/locale/fr-ca.js","./fr-ca.js":"./node_modules/moment/locale/fr-ca.js","./fr-ch":"./node_modules/moment/locale/fr-ch.js","./fr-ch.js":"./node_modules/moment/locale/fr-ch.js","./fr.js":"./node_modules/moment/locale/fr.js","./fy":"./node_modules/moment/locale/fy.js","./fy.js":"./node_modules/moment/locale/fy.js","./gd":"./node_modules/moment/locale/gd.js","./gd.js":"./node_modules/moment/locale/gd.js","./gl":"./node_modules/moment/locale/gl.js","./gl.js":"./node_modules/moment/locale/gl.js","./gom-latn":"./node_modules/moment/locale/gom-latn.js","./gom-latn.js":"./node_modules/moment/locale/gom-latn.js","./gu":"./node_modules/moment/locale/gu.js","./gu.js":"./node_modules/moment/locale/gu.js","./he":"./node_modules/moment/locale/he.js","./he.js":"./node_modules/moment/locale/he.js","./hi":"./node_modules/moment/locale/hi.js","./hi.js":"./node_modules/moment/locale/hi.js","./hr":"./node_modules/moment/locale/hr.js","./hr.js":"./node_modules/moment/locale/hr.js","./hu":"./node_modules/moment/locale/hu.js","./hu.js":"./node_modules/moment/locale/hu.js","./hy-am":"./node_modules/moment/locale/hy-am.js","./hy-am.js":"./node_modules/moment/locale/hy-am.js","./id":"./node_modules/moment/locale/id.js","./id.js":"./node_modules/moment/locale/id.js","./is":"./node_modules/moment/locale/is.js","./is.js":"./node_modules/moment/locale/is.js","./it":"./node_modules/moment/locale/it.js","./it.js":"./node_modules/moment/locale/it.js","./ja":"./node_modules/moment/locale/ja.js","./ja.js":"./node_modules/moment/locale/ja.js","./jv":"./node_modules/moment/locale/jv.js","./jv.js":"./node_modules/moment/locale/jv.js","./ka":"./node_modules/moment/locale/ka.js","./ka.js":"./node_modules/moment/locale/ka.js","./kk":"./node_modules/moment/locale/kk.js","./kk.js":"./node_modules/moment/locale/kk.js","./km":"./node_modules/moment/locale/km.js","./km.js":"./node_modules/moment/locale/km.js","./kn":"./node_modules/moment/locale/kn.js","./kn.js":"./node_modules/moment/locale/kn.js","./ko":"./node_modules/moment/locale/ko.js","./ko.js":"./node_modules/moment/locale/ko.js","./ky":"./node_modules/moment/locale/ky.js","./ky.js":"./node_modules/moment/locale/ky.js","./lb":"./node_modules/moment/locale/lb.js","./lb.js":"./node_modules/moment/locale/lb.js","./lo":"./node_modules/moment/locale/lo.js","./lo.js":"./node_modules/moment/locale/lo.js","./lt":"./node_modules/moment/locale/lt.js","./lt.js":"./node_modules/moment/locale/lt.js","./lv":"./node_modules/moment/locale/lv.js","./lv.js":"./node_modules/moment/locale/lv.js","./me":"./node_modules/moment/locale/me.js","./me.js":"./node_modules/moment/locale/me.js","./mi":"./node_modules/moment/locale/mi.js","./mi.js":"./node_modules/moment/locale/mi.js","./mk":"./node_modules/moment/locale/mk.js","./mk.js":"./node_modules/moment/locale/mk.js","./ml":"./node_modules/moment/locale/ml.js","./ml.js":"./node_modules/moment/locale/ml.js","./mn":"./node_modules/moment/locale/mn.js","./mn.js":"./node_modules/moment/locale/mn.js","./mr":"./node_modules/moment/locale/mr.js","./mr.js":"./node_modules/moment/locale/mr.js","./ms":"./node_modules/moment/locale/ms.js","./ms-my":"./node_modules/moment/locale/ms-my.js","./ms-my.js":"./node_modules/moment/locale/ms-my.js","./ms.js":"./node_modules/moment/locale/ms.js","./mt":"./node_modules/moment/locale/mt.js","./mt.js":"./node_modules/moment/locale/mt.js","./my":"./node_modules/moment/locale/my.js","./my.js":"./node_modules/moment/locale/my.js","./nb":"./node_modules/moment/locale/nb.js","./nb.js":"./node_modules/moment/locale/nb.js","./ne":"./node_modules/moment/locale/ne.js","./ne.js":"./node_modules/moment/locale/ne.js","./nl":"./node_modules/moment/locale/nl.js","./nl-be":"./node_modules/moment/locale/nl-be.js","./nl-be.js":"./node_modules/moment/locale/nl-be.js","./nl.js":"./node_modules/moment/locale/nl.js","./nn":"./node_modules/moment/locale/nn.js","./nn.js":"./node_modules/moment/locale/nn.js","./pa-in":"./node_modules/moment/locale/pa-in.js","./pa-in.js":"./node_modules/moment/locale/pa-in.js","./pl":"./node_modules/moment/locale/pl.js","./pl.js":"./node_modules/moment/locale/pl.js","./pt":"./node_modules/moment/locale/pt.js","./pt-br":"./node_modules/moment/locale/pt-br.js","./pt-br.js":"./node_modules/moment/locale/pt-br.js","./pt.js":"./node_modules/moment/locale/pt.js","./ro":"./node_modules/moment/locale/ro.js","./ro.js":"./node_modules/moment/locale/ro.js","./ru":"./node_modules/moment/locale/ru.js","./ru.js":"./node_modules/moment/locale/ru.js","./sd":"./node_modules/moment/locale/sd.js","./sd.js":"./node_modules/moment/locale/sd.js","./se":"./node_modules/moment/locale/se.js","./se.js":"./node_modules/moment/locale/se.js","./si":"./node_modules/moment/locale/si.js","./si.js":"./node_modules/moment/locale/si.js","./sk":"./node_modules/moment/locale/sk.js","./sk.js":"./node_modules/moment/locale/sk.js","./sl":"./node_modules/moment/locale/sl.js","./sl.js":"./node_modules/moment/locale/sl.js","./sq":"./node_modules/moment/locale/sq.js","./sq.js":"./node_modules/moment/locale/sq.js","./sr":"./node_modules/moment/locale/sr.js","./sr-cyrl":"./node_modules/moment/locale/sr-cyrl.js","./sr-cyrl.js":"./node_modules/moment/locale/sr-cyrl.js","./sr.js":"./node_modules/moment/locale/sr.js","./ss":"./node_modules/moment/locale/ss.js","./ss.js":"./node_modules/moment/locale/ss.js","./sv":"./node_modules/moment/locale/sv.js","./sv.js":"./node_modules/moment/locale/sv.js","./sw":"./node_modules/moment/locale/sw.js","./sw.js":"./node_modules/moment/locale/sw.js","./ta":"./node_modules/moment/locale/ta.js","./ta.js":"./node_modules/moment/locale/ta.js","./te":"./node_modules/moment/locale/te.js","./te.js":"./node_modules/moment/locale/te.js","./tet":"./node_modules/moment/locale/tet.js","./tet.js":"./node_modules/moment/locale/tet.js","./tg":"./node_modules/moment/locale/tg.js","./tg.js":"./node_modules/moment/locale/tg.js","./th":"./node_modules/moment/locale/th.js","./th.js":"./node_modules/moment/locale/th.js","./tl-ph":"./node_modules/moment/locale/tl-ph.js","./tl-ph.js":"./node_modules/moment/locale/tl-ph.js","./tlh":"./node_modules/moment/locale/tlh.js","./tlh.js":"./node_modules/moment/locale/tlh.js","./tr":"./node_modules/moment/locale/tr.js","./tr.js":"./node_modules/moment/locale/tr.js","./tzl":"./node_modules/moment/locale/tzl.js","./tzl.js":"./node_modules/moment/locale/tzl.js","./tzm":"./node_modules/moment/locale/tzm.js","./tzm-latn":"./node_modules/moment/locale/tzm-latn.js","./tzm-latn.js":"./node_modules/moment/locale/tzm-latn.js","./tzm.js":"./node_modules/moment/locale/tzm.js","./ug-cn":"./node_modules/moment/locale/ug-cn.js","./ug-cn.js":"./node_modules/moment/locale/ug-cn.js","./uk":"./node_modules/moment/locale/uk.js","./uk.js":"./node_modules/moment/locale/uk.js","./ur":"./node_modules/moment/locale/ur.js","./ur.js":"./node_modules/moment/locale/ur.js","./uz":"./node_modules/moment/locale/uz.js","./uz-latn":"./node_modules/moment/locale/uz-latn.js","./uz-latn.js":"./node_modules/moment/locale/uz-latn.js","./uz.js":"./node_modules/moment/locale/uz.js","./vi":"./node_modules/moment/locale/vi.js","./vi.js":"./node_modules/moment/locale/vi.js","./x-pseudo":"./node_modules/moment/locale/x-pseudo.js","./x-pseudo.js":"./node_modules/moment/locale/x-pseudo.js","./yo":"./node_modules/moment/locale/yo.js","./yo.js":"./node_modules/moment/locale/yo.js","./zh-cn":"./node_modules/moment/locale/zh-cn.js","./zh-cn.js":"./node_modules/moment/locale/zh-cn.js","./zh-hk":"./node_modules/moment/locale/zh-hk.js","./zh-hk.js":"./node_modules/moment/locale/zh-hk.js","./zh-tw":"./node_modules/moment/locale/zh-tw.js","./zh-tw.js":"./node_modules/moment/locale/zh-tw.js"};function webpackContext(req){var id=webpackContextResolve(req);return __webpack_require__(id)}function webpackContextResolve(req){var id=map[req];if(!(id+1)){var e=new Error('Cannot find module "'+req+'".');throw e.code="MODULE_NOT_FOUND",e}return id}webpackContext.keys=function(){return Object.keys(map)},webpackContext.resolve=webpackContextResolve,module.exports=webpackContext,webpackContext.id="./node_modules/moment/locale sync recursive ^\\.\\/.*$"},"./node_modules/moment/locale/af.js":function(module,exports,__webpack_require__){!function(moment){"use strict";moment.defineLocale("af",{months:"Januarie_Februarie_Maart_April_Mei_Junie_Julie_Augustus_September_Oktober_November_Desember".split("_"),monthsShort:"Jan_Feb_Mrt_Apr_Mei_Jun_Jul_Aug_Sep_Okt_Nov_Des".split("_"),weekdays:"Sondag_Maandag_Dinsdag_Woensdag_Donderdag_Vrydag_Saterdag".split("_"),weekdaysShort:"Son_Maa_Din_Woe_Don_Vry_Sat".split("_"),weekdaysMin:"So_Ma_Di_Wo_Do_Vr_Sa".split("_"),meridiemParse:/vm|nm/i,isPM:function(input){return/^nm$/i.test(input)},meridiem:function(hours,minutes,isLower){return hours<12?isLower?"vm":"VM":isLower?"nm":"NM"},longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Vandag om] LT",nextDay:"[Mre om] LT",nextWeek:"dddd [om] LT",lastDay:"[Gister om] LT",lastWeek:"[Laas] dddd [om] LT",sameElse:"L"},relativeTime:{future:"oor %s",past:"%s gelede",s:"'n paar sekondes",ss:"%d sekondes",m:"'n minuut",mm:"%d minute",h:"'n uur",hh:"%d ure",d:"'n dag",dd:"%d dae",M:"'n maand",MM:"%d maande",y:"'n jaar",yy:"%d jaar"},dayOfMonthOrdinalParse:/\d{1,2}(ste|de)/,ordinal:function(number){return number+(1===number||8===number||number>=20?"ste":"de")},week:{dow:1,doy:4}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/ar-dz.js":function(module,exports,__webpack_require__){!function(moment){"use strict";moment.defineLocale("ar-dz",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[  ] LT",nextDay:"[  ] LT",nextWeek:"dddd [ ] LT",lastDay:"[  ] LT",lastWeek:"dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:"",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},week:{dow:0,doy:4}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/ar-kw.js":function(module,exports,__webpack_require__){!function(moment){"use strict";moment.defineLocale("ar-kw",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[  ] LT",nextDay:"[  ] LT",nextWeek:"dddd [ ] LT",lastDay:"[  ] LT",lastWeek:"dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:"",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},week:{dow:0,doy:12}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/ar-ly.js":function(module,exports,__webpack_require__){!function(moment){"use strict";var symbolMap={1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",0:"0"},pluralForm=function(n){return 0===n?0:1===n?1:2===n?2:n%100>=3&&n%100<=10?3:n%100>=11?4:5},plurals={s:["  "," ",["",""],"%d ","%d ","%d "],m:["  "," ",["",""],"%d ","%d ","%d "],h:["  "," ",["",""],"%d ","%d ","%d "],d:["  "," ",["",""],"%d ","%d ","%d "],M:["  "," ",["",""],"%d ","%d ","%d "],y:["  "," ",["",""],"%d ","%d ","%d "]},pluralize=function(u){return function(number,withoutSuffix,string,isFuture){var f=pluralForm(number),str=plurals[u][pluralForm(number)];return 2===f&&(str=str[withoutSuffix?0:1]),str.replace(/%d/i,number)}},months=["","","","","","","","","","","",""];moment.defineLocale("ar-ly",{months:months,monthsShort:months,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"D/M/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},meridiemParse:/|/,isPM:function(input){return""===input},meridiem:function(hour,minute,isLower){return hour<12?"":""},calendar:{sameDay:"[  ] LT",nextDay:"[  ] LT",nextWeek:"dddd [ ] LT",lastDay:"[  ] LT",lastWeek:"dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:pluralize("s"),ss:pluralize("s"),m:pluralize("m"),mm:pluralize("m"),h:pluralize("h"),hh:pluralize("h"),d:pluralize("d"),dd:pluralize("d"),M:pluralize("M"),MM:pluralize("M"),y:pluralize("y"),yy:pluralize("y")},preparse:function(string){return string.replace(//g,",")},postformat:function(string){return string.replace(/\d/g,function(match){return symbolMap[match]}).replace(/,/g,"")},week:{dow:6,doy:12}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/ar-ma.js":function(module,exports,__webpack_require__){!function(moment){"use strict";moment.defineLocale("ar-ma",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[  ] LT",nextDay:"[  ] LT",nextWeek:"dddd [ ] LT",lastDay:"[  ] LT",lastWeek:"dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:"",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},week:{dow:6,doy:12}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/ar-sa.js":function(module,exports,__webpack_require__){!function(moment){"use strict";var symbolMap={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},numberMap={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};moment.defineLocale("ar-sa",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},meridiemParse:/|/,isPM:function(input){return""===input},meridiem:function(hour,minute,isLower){return hour<12?"":""},calendar:{sameDay:"[  ] LT",nextDay:"[  ] LT",nextWeek:"dddd [ ] LT",lastDay:"[  ] LT",lastWeek:"dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:"",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},preparse:function(string){return string.replace(/[]/g,function(match){return numberMap[match]}).replace(//g,",")},postformat:function(string){return string.replace(/\d/g,function(match){return symbolMap[match]}).replace(/,/g,"")},week:{dow:0,doy:6}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/ar-tn.js":function(module,exports,__webpack_require__){!function(moment){"use strict";moment.defineLocale("ar-tn",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[  ] LT",nextDay:"[  ] LT",nextWeek:"dddd [ ] LT",lastDay:"[  ] LT",lastWeek:"dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:"",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},week:{dow:1,doy:4}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/ar.js":function(module,exports,__webpack_require__){!function(moment){"use strict";var symbolMap={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},numberMap={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"},pluralForm=function(n){return 0===n?0:1===n?1:2===n?2:n%100>=3&&n%100<=10?3:n%100>=11?4:5},plurals={s:["  "," ",["",""],"%d ","%d ","%d "],m:["  "," ",["",""],"%d ","%d ","%d "],h:["  "," ",["",""],"%d ","%d ","%d "],d:["  "," ",["",""],"%d ","%d ","%d "],M:["  "," ",["",""],"%d ","%d ","%d "],y:["  "," ",["",""],"%d ","%d ","%d "]},pluralize=function(u){return function(number,withoutSuffix,string,isFuture){var f=pluralForm(number),str=plurals[u][pluralForm(number)];return 2===f&&(str=str[withoutSuffix?0:1]),str.replace(/%d/i,number)}},months=["","","","","","","","","","","",""];moment.defineLocale("ar",{months:months,monthsShort:months,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"D/M/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},meridiemParse:/|/,isPM:function(input){return""===input},meridiem:function(hour,minute,isLower){return hour<12?"":""},calendar:{sameDay:"[  ] LT",nextDay:"[  ] LT",nextWeek:"dddd [ ] LT",lastDay:"[  ] LT",lastWeek:"dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:pluralize("s"),ss:pluralize("s"),m:pluralize("m"),mm:pluralize("m"),h:pluralize("h"),hh:pluralize("h"),d:pluralize("d"),dd:pluralize("d"),M:pluralize("M"),MM:pluralize("M"),y:pluralize("y"),yy:pluralize("y")},preparse:function(string){return string.replace(/[]/g,function(match){return numberMap[match]}).replace(//g,",")},postformat:function(string){return string.replace(/\d/g,function(match){return symbolMap[match]}).replace(/,/g,"")},week:{dow:6,doy:12}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/az.js":function(module,exports,__webpack_require__){!function(moment){"use strict";var suffixes={1:"-inci",5:"-inci",8:"-inci",70:"-inci",80:"-inci",2:"-nci",7:"-nci",20:"-nci",50:"-nci",3:"-nc",4:"-nc",100:"-nc",6:"-nc",9:"-uncu",10:"-uncu",30:"-uncu",60:"-nc",90:"-nc"};moment.defineLocale("az",{months:"yanvar_fevral_mart_aprel_may_iyun_iyul_avqust_sentyabr_oktyabr_noyabr_dekabr".split("_"),monthsShort:"yan_fev_mar_apr_may_iyn_iyl_avq_sen_okt_noy_dek".split("_"),weekdays:"Bazar_Bazar ertsi_rnb axam_rnb_Cm axam_Cm_nb".split("_"),weekdaysShort:"Baz_BzE_Ax_r_CAx_Cm_n".split("_"),weekdaysMin:"Bz_BE_A__CA_C_".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[bugn saat] LT",nextDay:"[sabah saat] LT",nextWeek:"[gln hft] dddd [saat] LT",lastDay:"[dnn] LT",lastWeek:"[ken hft] dddd [saat] LT",sameElse:"L"},relativeTime:{future:"%s sonra",past:"%s vvl",s:"birne saniyy",ss:"%d saniy",m:"bir dqiq",mm:"%d dqiq",h:"bir saat",hh:"%d saat",d:"bir gn",dd:"%d gn",M:"bir ay",MM:"%d ay",y:"bir il",yy:"%d il"},meridiemParse:/gec|shr|gndz|axam/,isPM:function(input){return/^(gndz|axam)$/.test(input)},meridiem:function(hour,minute,isLower){return hour<4?"gec":hour<12?"shr":hour<17?"gndz":"axam"},dayOfMonthOrdinalParse:/\d{1,2}-(nc|inci|nci|nc|nc|uncu)/,ordinal:function(number){if(0===number)return number+"-nc";var a=number%10,b=number%100-a,c=number>=100?100:null;return number+(suffixes[a]||suffixes[b]||suffixes[c])},week:{dow:1,doy:7}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/be.js":function(module,exports,__webpack_require__){!function(moment){"use strict";function relativeTimeWithPlural(number,withoutSuffix,key){var num,forms,format={ss:withoutSuffix?"__":"__",mm:withoutSuffix?"__":"__",hh:withoutSuffix?"__":"__",dd:"__",MM:"__",yy:"__"};return"m"===key?withoutSuffix?"":"":"h"===key?withoutSuffix?"":"":number+" "+(num=+number,forms=format[key].split("_"),num%10==1&&num%100!=11?forms[0]:num%10>=2&&num%10<=4&&(num%100<10||num%100>=20)?forms[1]:forms[2])}moment.defineLocale("be",{months:{format:"___________".split("_"),standalone:"___________".split("_")},monthsShort:"___________".split("_"),weekdays:{format:"______".split("_"),standalone:"______".split("_"),isFormat:/\[ ?[] ?(?:|)? ?\] ?dddd/},weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY .",LLL:"D MMMM YYYY ., HH:mm",LLLL:"dddd, D MMMM YYYY ., HH:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",lastDay:"[ ] LT",nextWeek:function(){return"[] dddd [] LT"},lastWeek:function(){switch(this.day()){case 0:case 3:case 5:case 6:return"[ ] dddd [] LT";case 1:case 2:case 4:return"[ ] dddd [] LT"}},sameElse:"L"},relativeTime:{future:" %s",past:"%s ",s:" ",m:relativeTimeWithPlural,mm:relativeTimeWithPlural,h:relativeTimeWithPlural,hh:relativeTimeWithPlural,d:"",dd:relativeTimeWithPlural,M:"",MM:relativeTimeWithPlural,y:"",yy:relativeTimeWithPlural},meridiemParse:/|||/,isPM:function(input){return/^(|)$/.test(input)},meridiem:function(hour,minute,isLower){return hour<4?"":hour<12?"":hour<17?"":""},dayOfMonthOrdinalParse:/\d{1,2}-(||)/,ordinal:function(number,period){switch(period){case"M":case"d":case"DDD":case"w":case"W":return number%10!=2&&number%10!=3||number%100==12||number%100==13?number+"-":number+"-";case"D":return number+"-";default:return number}},week:{dow:1,doy:7}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/bg.js":function(module,exports,__webpack_require__){!function(moment){"use strict";moment.defineLocale("bg",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"D.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY H:mm",LLLL:"dddd, D MMMM YYYY H:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[ ] LT",lastWeek:function(){switch(this.day()){case 0:case 3:case 6:return"[ ] dddd [] LT";case 1:case 2:case 4:case 5:return"[ ] dddd [] LT"}},sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:" ",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}-(|||||)/,ordinal:function(number){var lastDigit=number%10,last2Digits=number%100;return 0===number?number+"-":0===last2Digits?number+"-":last2Digits>10&&last2Digits<20?number+"-":1===lastDigit?number+"-":2===lastDigit?number+"-":7===lastDigit||8===lastDigit?number+"-":number+"-"},week:{dow:1,doy:7}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/bm.js":function(module,exports,__webpack_require__){!function(moment){"use strict";moment.defineLocale("bm",{months:"Zanwuyekalo_Fewuruyekalo_Marisikalo_Awirilikalo_Mkalo_Zuwnkalo_Zuluyekalo_Utikalo_Stanburukalo_kutburukalo_Nowanburukalo_Desanburukalo".split("_"),monthsShort:"Zan_Few_Mar_Awi_M_Zuw_Zul_Uti_St_ku_Now_Des".split("_"),weekdays:"Kari_Ntnn_Tarata_Araba_Alamisa_Juma_Sibiri".split("_"),weekdaysShort:"Kar_Nt_Tar_Ara_Ala_Jum_Sib".split("_"),weekdaysMin:"Ka_Nt_Ta_Ar_Al_Ju_Si".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"MMMM [tile] D [san] YYYY",LLL:"MMMM [tile] D [san] YYYY [lr] HH:mm",LLLL:"dddd MMMM [tile] D [san] YYYY [lr] HH:mm"},calendar:{sameDay:"[Bi lr] LT",nextDay:"[Sini lr] LT",nextWeek:"dddd [don lr] LT",lastDay:"[Kunu lr] LT",lastWeek:"dddd [tmnen lr] LT",sameElse:"L"},relativeTime:{future:"%s kn",past:"a b %s b",s:"sanga dama dama",ss:"sekondi %d",m:"miniti kelen",mm:"miniti %d",h:"lr kelen",hh:"lr %d",d:"tile kelen",dd:"tile %d",M:"kalo kelen",MM:"kalo %d",y:"san kelen",yy:"san %d"},week:{dow:1,doy:4}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/bn.js":function(module,exports,__webpack_require__){!function(moment){"use strict";var symbolMap={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},numberMap={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};moment.defineLocale("bn",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm ",LTS:"A h:mm:ss ",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm ",LLLL:"dddd, D MMMM YYYY, A h:mm "},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(string){return string.replace(/[]/g,function(match){return numberMap[match]})},postformat:function(string){return string.replace(/\d/g,function(match){return symbolMap[match]})},meridiemParse:/||||/,meridiemHour:function(hour,meridiem){return 12===hour&&(hour=0),""===meridiem&&hour>=4||""===meridiem&&hour<5||""===meridiem?hour+12:hour},meridiem:function(hour,minute,isLower){return hour<4?"":hour<10?"":hour<17?"":hour<20?"":""},week:{dow:0,doy:6}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/bo.js":function(module,exports,__webpack_require__){!function(moment){"use strict";var symbolMap={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},numberMap={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};moment.defineLocale("bo",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm",LTS:"A h:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm",LLLL:"dddd, D MMMM YYYY, A h:mm"},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"[], LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:"",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},preparse:function(string){return string.replace(/[]/g,function(match){return numberMap[match]})},postformat:function(string){return string.replace(/\d/g,function(match){return symbolMap[match]})},meridiemParse:/||||/,meridiemHour:function(hour,meridiem){return 12===hour&&(hour=0),""===meridiem&&hour>=4||""===meridiem&&hour<5||""===meridiem?hour+12:hour},meridiem:function(hour,minute,isLower){return hour<4?"":hour<10?"":hour<17?"":hour<20?"":""},week:{dow:0,doy:6}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/br.js":function(module,exports,__webpack_require__){!function(moment){"use strict";function relativeTimeWithMutation(number,withoutSuffix,key){return number+" "+function(text,number){return 2===number?function(text){var mutationTable={m:"v",b:"v",d:"z"};return void 0===mutationTable[text.charAt(0)]?text:mutationTable[text.charAt(0)]+text.substring(1)}(text):text}({mm:"munutenn",MM:"miz",dd:"devezh"}[key],number)}moment.defineLocale("br",{months:"Genver_C'hwevrer_Meurzh_Ebrel_Mae_Mezheven_Gouere_Eost_Gwengolo_Here_Du_Kerzu".split("_"),monthsShort:"Gen_C'hwe_Meu_Ebr_Mae_Eve_Gou_Eos_Gwe_Her_Du_Ker".split("_"),weekdays:"Sul_Lun_Meurzh_Merc'her_Yaou_Gwener_Sadorn".split("_"),weekdaysShort:"Sul_Lun_Meu_Mer_Yao_Gwe_Sad".split("_"),weekdaysMin:"Su_Lu_Me_Mer_Ya_Gw_Sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"h[e]mm A",LTS:"h[e]mm:ss A",L:"DD/MM/YYYY",LL:"D [a viz] MMMM YYYY",LLL:"D [a viz] MMMM YYYY h[e]mm A",LLLL:"dddd, D [a viz] MMMM YYYY h[e]mm A"},calendar:{sameDay:"[Hiziv da] LT",nextDay:"[Warc'hoazh da] LT",nextWeek:"dddd [da] LT",lastDay:"[Dec'h da] LT",lastWeek:"dddd [paset da] LT",sameElse:"L"},relativeTime:{future:"a-benn %s",past:"%s 'zo",s:"un nebeud segondenno",ss:"%d eilenn",m:"ur vunutenn",mm:relativeTimeWithMutation,h:"un eur",hh:"%d eur",d:"un devezh",dd:relativeTimeWithMutation,M:"ur miz",MM:relativeTimeWithMutation,y:"ur bloaz",yy:function(number){switch(function lastNumber(number){return number>9?lastNumber(number%10):number}(number)){case 1:case 3:case 4:case 5:case 9:return number+" bloaz";default:return number+" vloaz"}}},dayOfMonthOrdinalParse:/\d{1,2}(a|vet)/,ordinal:function(number){var output=1===number?"a":"vet";return number+output},week:{dow:1,doy:4}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/bs.js":function(module,exports,__webpack_require__){!function(moment){"use strict";function translate(number,withoutSuffix,key){var result=number+" ";switch(key){case"ss":return result+=1===number?"sekunda":2===number||3===number||4===number?"sekunde":"sekundi";case"m":return withoutSuffix?"jedna minuta":"jedne minute";case"mm":return result+=1===number?"minuta":2===number||3===number||4===number?"minute":"minuta";case"h":return withoutSuffix?"jedan sat":"jednog sata";case"hh":return result+=1===number?"sat":2===number||3===number||4===number?"sata":"sati";case"dd":return result+=1===number?"dan":"dana";case"MM":return result+=1===number?"mjesec":2===number||3===number||4===number?"mjeseca":"mjeseci";case"yy":return result+=1===number?"godina":2===number||3===number||4===number?"godine":"godina"}}moment.defineLocale("bs",{months:"januar_februar_mart_april_maj_juni_juli_august_septembar_oktobar_novembar_decembar".split("_"),monthsShort:"jan._feb._mar._apr._maj._jun._jul._aug._sep._okt._nov._dec.".split("_"),monthsParseExact:!0,weekdays:"nedjelja_ponedjeljak_utorak_srijeda_etvrtak_petak_subota".split("_"),weekdaysShort:"ned._pon._uto._sri._et._pet._sub.".split("_"),weekdaysMin:"ne_po_ut_sr_e_pe_su".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},calendar:{sameDay:"[danas u] LT",nextDay:"[sutra u] LT",nextWeek:function(){switch(this.day()){case 0:return"[u] [nedjelju] [u] LT";case 3:return"[u] [srijedu] [u] LT";case 6:return"[u] [subotu] [u] LT";case 1:case 2:case 4:case 5:return"[u] dddd [u] LT"}},lastDay:"[juer u] LT",lastWeek:function(){switch(this.day()){case 0:case 3:return"[prolu] dddd [u] LT";case 6:return"[prole] [subote] [u] LT";case 1:case 2:case 4:case 5:return"[proli] dddd [u] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"prije %s",s:"par sekundi",ss:translate,m:translate,mm:translate,h:translate,hh:translate,d:"dan",dd:translate,M:"mjesec",MM:translate,y:"godinu",yy:translate},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/ca.js":function(module,exports,__webpack_require__){!function(moment){"use strict";moment.defineLocale("ca",{months:{standalone:"gener_febrer_mar_abril_maig_juny_juliol_agost_setembre_octubre_novembre_desembre".split("_"),format:"de gener_de febrer_de mar_d'abril_de maig_de juny_de juliol_d'agost_de setembre_d'octubre_de novembre_de desembre".split("_"),isFormat:/D[oD]?(\s)+MMMM/},monthsShort:"gen._febr._mar_abr._maig_juny_jul._ag._set._oct._nov._des.".split("_"),monthsParseExact:!0,weekdays:"diumenge_dilluns_dimarts_dimecres_dijous_divendres_dissabte".split("_"),weekdaysShort:"dg._dl._dt._dc._dj._dv._ds.".split("_"),weekdaysMin:"dg_dl_dt_dc_dj_dv_ds".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM [de] YYYY",ll:"D MMM YYYY",LLL:"D MMMM [de] YYYY [a les] H:mm",lll:"D MMM YYYY, H:mm",LLLL:"dddd D MMMM [de] YYYY [a les] H:mm",llll:"ddd D MMM YYYY, H:mm"},calendar:{sameDay:function(){return"[avui a "+(1!==this.hours()?"les":"la")+"] LT"},nextDay:function(){return"[dem a "+(1!==this.hours()?"les":"la")+"] LT"},nextWeek:function(){return"dddd [a "+(1!==this.hours()?"les":"la")+"] LT"},lastDay:function(){return"[ahir a "+(1!==this.hours()?"les":"la")+"] LT"},lastWeek:function(){return"[el] dddd [passat a "+(1!==this.hours()?"les":"la")+"] LT"},sameElse:"L"},relativeTime:{future:"d'aqu %s",past:"fa %s",s:"uns segons",ss:"%d segons",m:"un minut",mm:"%d minuts",h:"una hora",hh:"%d hores",d:"un dia",dd:"%d dies",M:"un mes",MM:"%d mesos",y:"un any",yy:"%d anys"},dayOfMonthOrdinalParse:/\d{1,2}(r|n|t||a)/,ordinal:function(number,period){var output=1===number?"r":2===number?"n":3===number?"r":4===number?"t":"";return"w"!==period&&"W"!==period||(output="a"),number+output},week:{dow:1,doy:4}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/cs.js":function(module,exports,__webpack_require__){!function(moment){"use strict";var months="leden_nor_bezen_duben_kvten_erven_ervenec_srpen_z_jen_listopad_prosinec".split("_"),monthsShort="led_no_be_dub_kv_vn_vc_srp_z_j_lis_pro".split("_");function plural(n){return n>1&&n<5&&1!=~~(n/10)}function translate(number,withoutSuffix,key,isFuture){var result=number+" ";switch(key){case"s":return withoutSuffix||isFuture?"pr sekund":"pr sekundami";case"ss":return withoutSuffix||isFuture?result+(plural(number)?"sekundy":"sekund"):result+"sekundami";case"m":return withoutSuffix?"minuta":isFuture?"minutu":"minutou";case"mm":return withoutSuffix||isFuture?result+(plural(number)?"minuty":"minut"):result+"minutami";case"h":return withoutSuffix?"hodina":isFuture?"hodinu":"hodinou";case"hh":return withoutSuffix||isFuture?result+(plural(number)?"hodiny":"hodin"):result+"hodinami";case"d":return withoutSuffix||isFuture?"den":"dnem";case"dd":return withoutSuffix||isFuture?result+(plural(number)?"dny":"dn"):result+"dny";case"M":return withoutSuffix||isFuture?"msc":"mscem";case"MM":return withoutSuffix||isFuture?result+(plural(number)?"msce":"msc"):result+"msci";case"y":return withoutSuffix||isFuture?"rok":"rokem";case"yy":return withoutSuffix||isFuture?result+(plural(number)?"roky":"let"):result+"lety"}}moment.defineLocale("cs",{months:months,monthsShort:monthsShort,monthsParse:function(months,monthsShort){var i,_monthsParse=[];for(i=0;i<12;i++)_monthsParse[i]=new RegExp("^"+months[i]+"$|^"+monthsShort[i]+"$","i");return _monthsParse}(months,monthsShort),shortMonthsParse:function(monthsShort){var i,_shortMonthsParse=[];for(i=0;i<12;i++)_shortMonthsParse[i]=new RegExp("^"+monthsShort[i]+"$","i");return _shortMonthsParse}(monthsShort),longMonthsParse:function(months){var i,_longMonthsParse=[];for(i=0;i<12;i++)_longMonthsParse[i]=new RegExp("^"+months[i]+"$","i");return _longMonthsParse}(months),weekdays:"nedle_pondl_ter_steda_tvrtek_ptek_sobota".split("_"),weekdaysShort:"ne_po_t_st_t_p_so".split("_"),weekdaysMin:"ne_po_t_st_t_p_so".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd D. MMMM YYYY H:mm",l:"D. M. YYYY"},calendar:{sameDay:"[dnes v] LT",nextDay:"[ztra v] LT",nextWeek:function(){switch(this.day()){case 0:return"[v nedli v] LT";case 1:case 2:return"[v] dddd [v] LT";case 3:return"[ve stedu v] LT";case 4:return"[ve tvrtek v] LT";case 5:return"[v ptek v] LT";case 6:return"[v sobotu v] LT"}},lastDay:"[vera v] LT",lastWeek:function(){switch(this.day()){case 0:return"[minulou nedli v] LT";case 1:case 2:return"[minul] dddd [v] LT";case 3:return"[minulou stedu v] LT";case 4:case 5:return"[minul] dddd [v] LT";case 6:return"[minulou sobotu v] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"ped %s",s:translate,ss:translate,m:translate,mm:translate,h:translate,hh:translate,d:translate,dd:translate,M:translate,MM:translate,y:translate,yy:translate},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/cv.js":function(module,exports,__webpack_require__){!function(moment){"use strict";moment.defineLocale("cv",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD-MM-YYYY",LL:"YYYY [] MMMM [] D[-]",LLL:"YYYY [] MMMM [] D[-], HH:mm",LLLL:"dddd, YYYY [] MMMM [] D[-], HH:mm"},calendar:{sameDay:"[] LT []",nextDay:"[] LT []",lastDay:"[] LT []",nextWeek:"[] dddd LT []",lastWeek:"[] dddd LT []",sameElse:"L"},relativeTime:{future:function(output){var affix=/$/i.exec(output)?"":/$/i.exec(output)?"":"";return output+affix},past:"%s ",s:"- ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}-/,ordinal:"%d-",week:{dow:1,doy:7}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/cy.js":function(module,exports,__webpack_require__){!function(moment){"use strict";moment.defineLocale("cy",{months:"Ionawr_Chwefror_Mawrth_Ebrill_Mai_Mehefin_Gorffennaf_Awst_Medi_Hydref_Tachwedd_Rhagfyr".split("_"),monthsShort:"Ion_Chwe_Maw_Ebr_Mai_Meh_Gor_Aws_Med_Hyd_Tach_Rhag".split("_"),weekdays:"Dydd Sul_Dydd Llun_Dydd Mawrth_Dydd Mercher_Dydd Iau_Dydd Gwener_Dydd Sadwrn".split("_"),weekdaysShort:"Sul_Llun_Maw_Mer_Iau_Gwe_Sad".split("_"),weekdaysMin:"Su_Ll_Ma_Me_Ia_Gw_Sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Heddiw am] LT",nextDay:"[Yfory am] LT",nextWeek:"dddd [am] LT",lastDay:"[Ddoe am] LT",lastWeek:"dddd [diwethaf am] LT",sameElse:"L"},relativeTime:{future:"mewn %s",past:"%s yn l",s:"ychydig eiliadau",ss:"%d eiliad",m:"munud",mm:"%d munud",h:"awr",hh:"%d awr",d:"diwrnod",dd:"%d diwrnod",M:"mis",MM:"%d mis",y:"blwyddyn",yy:"%d flynedd"},dayOfMonthOrdinalParse:/\d{1,2}(fed|ain|af|il|ydd|ed|eg)/,ordinal:function(number){var b=number,output="";return b>20?output=40===b||50===b||60===b||80===b||100===b?"fed":"ain":b>0&&(output=["","af","il","ydd","ydd","ed","ed","ed","fed","fed","fed","eg","fed","eg","eg","fed","eg","eg","fed","eg","fed"][b]),number+output},week:{dow:1,doy:4}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/da.js":function(module,exports,__webpack_require__){!function(moment){"use strict";moment.defineLocale("da",{months:"januar_februar_marts_april_maj_juni_juli_august_september_oktober_november_december".split("_"),monthsShort:"jan_feb_mar_apr_maj_jun_jul_aug_sep_okt_nov_dec".split("_"),weekdays:"sndag_mandag_tirsdag_onsdag_torsdag_fredag_lrdag".split("_"),weekdaysShort:"sn_man_tir_ons_tor_fre_lr".split("_"),weekdaysMin:"s_ma_ti_on_to_fr_l".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY HH:mm",LLLL:"dddd [d.] D. MMMM YYYY [kl.] HH:mm"},calendar:{sameDay:"[i dag kl.] LT",nextDay:"[i morgen kl.] LT",nextWeek:"p dddd [kl.] LT",lastDay:"[i gr kl.] LT",lastWeek:"[i] dddd[s kl.] LT",sameElse:"L"},relativeTime:{future:"om %s",past:"%s siden",s:"f sekunder",ss:"%d sekunder",m:"et minut",mm:"%d minutter",h:"en time",hh:"%d timer",d:"en dag",dd:"%d dage",M:"en mned",MM:"%d mneder",y:"et r",yy:"%d r"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/de-at.js":function(module,exports,__webpack_require__){!function(moment){"use strict";function processRelativeTime(number,withoutSuffix,key,isFuture){var format={m:["eine Minute","einer Minute"],h:["eine Stunde","einer Stunde"],d:["ein Tag","einem Tag"],dd:[number+" Tage",number+" Tagen"],M:["ein Monat","einem Monat"],MM:[number+" Monate",number+" Monaten"],y:["ein Jahr","einem Jahr"],yy:[number+" Jahre",number+" Jahren"]};return withoutSuffix?format[key][0]:format[key][1]}moment.defineLocale("de-at",{months:"Jnner_Februar_Mrz_April_Mai_Juni_Juli_August_September_Oktober_November_Dezember".split("_"),monthsShort:"Jn._Feb._Mrz_Apr._Mai_Juni_Juli_Aug._Sep._Okt._Nov._Dez.".split("_"),monthsParseExact:!0,weekdays:"Sonntag_Montag_Dienstag_Mittwoch_Donnerstag_Freitag_Samstag".split("_"),weekdaysShort:"So._Mo._Di._Mi._Do._Fr._Sa.".split("_"),weekdaysMin:"So_Mo_Di_Mi_Do_Fr_Sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY HH:mm",LLLL:"dddd, D. MMMM YYYY HH:mm"},calendar:{sameDay:"[heute um] LT [Uhr]",sameElse:"L",nextDay:"[morgen um] LT [Uhr]",nextWeek:"dddd [um] LT [Uhr]",lastDay:"[gestern um] LT [Uhr]",lastWeek:"[letzten] dddd [um] LT [Uhr]"},relativeTime:{future:"in %s",past:"vor %s",s:"ein paar Sekunden",ss:"%d Sekunden",m:processRelativeTime,mm:"%d Minuten",h:processRelativeTime,hh:"%d Stunden",d:processRelativeTime,dd:processRelativeTime,M:processRelativeTime,MM:processRelativeTime,y:processRelativeTime,yy:processRelativeTime},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/de-ch.js":function(module,exports,__webpack_require__){!function(moment){"use strict";function processRelativeTime(number,withoutSuffix,key,isFuture){var format={m:["eine Minute","einer Minute"],h:["eine Stunde","einer Stunde"],d:["ein Tag","einem Tag"],dd:[number+" Tage",number+" Tagen"],M:["ein Monat","einem Monat"],MM:[number+" Monate",number+" Monaten"],y:["ein Jahr","einem Jahr"],yy:[number+" Jahre",number+" Jahren"]};return withoutSuffix?format[key][0]:format[key][1]}moment.defineLocale("de-ch",{months:"Januar_Februar_Mrz_April_Mai_Juni_Juli_August_September_Oktober_November_Dezember".split("_"),monthsShort:"Jan._Feb._Mrz_Apr._Mai_Juni_Juli_Aug._Sep._Okt._Nov._Dez.".split("_"),monthsParseExact:!0,weekdays:"Sonntag_Montag_Dienstag_Mittwoch_Donnerstag_Freitag_Samstag".split("_"),weekdaysShort:"So_Mo_Di_Mi_Do_Fr_Sa".split("_"),weekdaysMin:"So_Mo_Di_Mi_Do_Fr_Sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY HH:mm",LLLL:"dddd, D. MMMM YYYY HH:mm"},calendar:{sameDay:"[heute um] LT [Uhr]",sameElse:"L",nextDay:"[morgen um] LT [Uhr]",nextWeek:"dddd [um] LT [Uhr]",lastDay:"[gestern um] LT [Uhr]",lastWeek:"[letzten] dddd [um] LT [Uhr]"},relativeTime:{future:"in %s",past:"vor %s",s:"ein paar Sekunden",ss:"%d Sekunden",m:processRelativeTime,mm:"%d Minuten",h:processRelativeTime,hh:"%d Stunden",d:processRelativeTime,dd:processRelativeTime,M:processRelativeTime,MM:processRelativeTime,y:processRelativeTime,yy:processRelativeTime},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/de.js":function(module,exports,__webpack_require__){!function(moment){"use strict";function processRelativeTime(number,withoutSuffix,key,isFuture){var format={m:["eine Minute","einer Minute"],h:["eine Stunde","einer Stunde"],d:["ein Tag","einem Tag"],dd:[number+" Tage",number+" Tagen"],M:["ein Monat","einem Monat"],MM:[number+" Monate",number+" Monaten"],y:["ein Jahr","einem Jahr"],yy:[number+" Jahre",number+" Jahren"]};return withoutSuffix?format[key][0]:format[key][1]}moment.defineLocale("de",{months:"Januar_Februar_Mrz_April_Mai_Juni_Juli_August_September_Oktober_November_Dezember".split("_"),monthsShort:"Jan._Feb._Mrz_Apr._Mai_Juni_Juli_Aug._Sep._Okt._Nov._Dez.".split("_"),monthsParseExact:!0,weekdays:"Sonntag_Montag_Dienstag_Mittwoch_Donnerstag_Freitag_Samstag".split("_"),weekdaysShort:"So._Mo._Di._Mi._Do._Fr._Sa.".split("_"),weekdaysMin:"So_Mo_Di_Mi_Do_Fr_Sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY HH:mm",LLLL:"dddd, D. MMMM YYYY HH:mm"},calendar:{sameDay:"[heute um] LT [Uhr]",sameElse:"L",nextDay:"[morgen um] LT [Uhr]",nextWeek:"dddd [um] LT [Uhr]",lastDay:"[gestern um] LT [Uhr]",lastWeek:"[letzten] dddd [um] LT [Uhr]"},relativeTime:{future:"in %s",past:"vor %s",s:"ein paar Sekunden",ss:"%d Sekunden",m:processRelativeTime,mm:"%d Minuten",h:processRelativeTime,hh:"%d Stunden",d:processRelativeTime,dd:processRelativeTime,M:processRelativeTime,MM:processRelativeTime,y:processRelativeTime,yy:processRelativeTime},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/dv.js":function(module,exports,__webpack_require__){!function(moment){"use strict";var months=["","","","","","","","","","","",""],weekdays=["","","","","","",""];moment.defineLocale("dv",{months:months,monthsShort:months,weekdays:weekdays,weekdaysShort:weekdays,weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"D/M/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},meridiemParse:/|/,isPM:function(input){return""===input},meridiem:function(hour,minute,isLower){return hour<12?"":""},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd LT",lastDay:"[] LT",lastWeek:"[] dddd LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:"",ss:"d% ",m:"",mm:" %d",h:"",hh:" %d",d:"",dd:" %d",M:"",MM:" %d",y:"",yy:" %d"},preparse:function(string){return string.replace(//g,",")},postformat:function(string){return string.replace(/,/g,"")},week:{dow:7,doy:12}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/el.js":function(module,exports,__webpack_require__){!function(moment){"use strict";moment.defineLocale("el",{monthsNominativeEl:"___________".split("_"),monthsGenitiveEl:"___________".split("_"),months:function(momentToFormat,format){return momentToFormat?"string"==typeof format&&/D/.test(format.substring(0,format.indexOf("MMMM")))?this._monthsGenitiveEl[momentToFormat.month()]:this._monthsNominativeEl[momentToFormat.month()]:this._monthsNominativeEl},monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),meridiem:function(hours,minutes,isLower){return hours>11?isLower?"":"":isLower?"":""},isPM:function(input){return""===(input+"").toLowerCase()[0]},meridiemParse:/[]\.??\.?/i,longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY h:mm A",LLLL:"dddd, D MMMM YYYY h:mm A"},calendarEl:{sameDay:"[ {}] LT",nextDay:"[ {}] LT",nextWeek:"dddd [{}] LT",lastDay:"[ {}] LT",lastWeek:function(){switch(this.day()){case 6:return"[ ] dddd [{}] LT";default:return"[ ] dddd [{}] LT"}},sameElse:"L"},calendar:function(key,mom){var input,output=this._calendarEl[key],hours=mom&&mom.hours();return((input=output)instanceof Function||"[object Function]"===Object.prototype.toString.call(input))&&(output=output.apply(mom)),output.replace("{}",hours%12==1?"":"")},relativeTime:{future:" %s",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/en-au.js":function(module,exports,__webpack_require__){!function(moment){"use strict";moment.defineLocale("en-au",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY h:mm A",LLLL:"dddd, D MMMM YYYY h:mm A"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},dayOfMonthOrdinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(number){var b=number%10,output=1==~~(number%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th";return number+output},week:{dow:1,doy:4}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/en-ca.js":function(module,exports,__webpack_require__){!function(moment){"use strict";moment.defineLocale("en-ca",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"YYYY-MM-DD",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},dayOfMonthOrdinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(number){var b=number%10,output=1==~~(number%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th";return number+output}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/en-gb.js":function(module,exports,__webpack_require__){!function(moment){"use strict";moment.defineLocale("en-gb",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},dayOfMonthOrdinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(number){var b=number%10,output=1==~~(number%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th";return number+output},week:{dow:1,doy:4}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/en-ie.js":function(module,exports,__webpack_require__){!function(moment){"use strict";moment.defineLocale("en-ie",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD-MM-YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},dayOfMonthOrdinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(number){var b=number%10,output=1==~~(number%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th";return number+output},week:{dow:1,doy:4}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/en-il.js":function(module,exports,__webpack_require__){!function(moment){"use strict";moment.defineLocale("en-il",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},dayOfMonthOrdinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(number){var b=number%10,output=1==~~(number%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th";return number+output}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/en-nz.js":function(module,exports,__webpack_require__){!function(moment){"use strict";moment.defineLocale("en-nz",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY h:mm A",LLLL:"dddd, D MMMM YYYY h:mm A"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},dayOfMonthOrdinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(number){var b=number%10,output=1==~~(number%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th";return number+output},week:{dow:1,doy:4}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/eo.js":function(module,exports,__webpack_require__){!function(moment){"use strict";moment.defineLocale("eo",{months:"januaro_februaro_marto_aprilo_majo_junio_julio_agusto_septembro_oktobro_novembro_decembro".split("_"),monthsShort:"jan_feb_mar_apr_maj_jun_jul_ag_sep_okt_nov_dec".split("_"),weekdays:"dimano_lundo_mardo_merkredo_ado_vendredo_sabato".split("_"),weekdaysShort:"dim_lun_mard_merk_a_ven_sab".split("_"),weekdaysMin:"di_lu_ma_me_a_ve_sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"D[-a de] MMMM, YYYY",LLL:"D[-a de] MMMM, YYYY HH:mm",LLLL:"dddd, [la] D[-a de] MMMM, YYYY HH:mm"},meridiemParse:/[ap]\.t\.m/i,isPM:function(input){return"p"===input.charAt(0).toLowerCase()},meridiem:function(hours,minutes,isLower){return hours>11?isLower?"p.t.m.":"P.T.M.":isLower?"a.t.m.":"A.T.M."},calendar:{sameDay:"[Hodia je] LT",nextDay:"[Morga je] LT",nextWeek:"dddd [je] LT",lastDay:"[Hiera je] LT",lastWeek:"[pasinta] dddd [je] LT",sameElse:"L"},relativeTime:{future:"post %s",past:"anta %s",s:"sekundoj",ss:"%d sekundoj",m:"minuto",mm:"%d minutoj",h:"horo",hh:"%d horoj",d:"tago",dd:"%d tagoj",M:"monato",MM:"%d monatoj",y:"jaro",yy:"%d jaroj"},dayOfMonthOrdinalParse:/\d{1,2}a/,ordinal:"%da",week:{dow:1,doy:7}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/es-do.js":function(module,exports,__webpack_require__){!function(moment){"use strict";var monthsShortDot="ene._feb._mar._abr._may._jun._jul._ago._sep._oct._nov._dic.".split("_"),monthsShort="ene_feb_mar_abr_may_jun_jul_ago_sep_oct_nov_dic".split("_"),monthsParse=[/^ene/i,/^feb/i,/^mar/i,/^abr/i,/^may/i,/^jun/i,/^jul/i,/^ago/i,/^sep/i,/^oct/i,/^nov/i,/^dic/i],monthsRegex=/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre|ene\.?|feb\.?|mar\.?|abr\.?|may\.?|jun\.?|jul\.?|ago\.?|sep\.?|oct\.?|nov\.?|dic\.?)/i;moment.defineLocale("es-do",{months:"enero_febrero_marzo_abril_mayo_junio_julio_agosto_septiembre_octubre_noviembre_diciembre".split("_"),monthsShort:function(m,format){return m?/-MMM-/.test(format)?monthsShort[m.month()]:monthsShortDot[m.month()]:monthsShortDot},monthsRegex:monthsRegex,monthsShortRegex:monthsRegex,monthsStrictRegex:/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre)/i,monthsShortStrictRegex:/^(ene\.?|feb\.?|mar\.?|abr\.?|may\.?|jun\.?|jul\.?|ago\.?|sep\.?|oct\.?|nov\.?|dic\.?)/i,monthsParse:monthsParse,longMonthsParse:monthsParse,shortMonthsParse:monthsParse,weekdays:"domingo_lunes_martes_mircoles_jueves_viernes_sbado".split("_"),weekdaysShort:"dom._lun._mar._mi._jue._vie._sb.".split("_"),weekdaysMin:"do_lu_ma_mi_ju_vi_s".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY h:mm A",LLLL:"dddd, D [de] MMMM [de] YYYY h:mm A"},calendar:{sameDay:function(){return"[hoy a la"+(1!==this.hours()?"s":"")+"] LT"},nextDay:function(){return"[maana a la"+(1!==this.hours()?"s":"")+"] LT"},nextWeek:function(){return"dddd [a la"+(1!==this.hours()?"s":"")+"] LT"},lastDay:function(){return"[ayer a la"+(1!==this.hours()?"s":"")+"] LT"},lastWeek:function(){return"[el] dddd [pasado a la"+(1!==this.hours()?"s":"")+"] LT"},sameElse:"L"},relativeTime:{future:"en %s",past:"hace %s",s:"unos segundos",ss:"%d segundos",m:"un minuto",mm:"%d minutos",h:"una hora",hh:"%d horas",d:"un da",dd:"%d das",M:"un mes",MM:"%d meses",y:"un ao",yy:"%d aos"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/es-us.js":function(module,exports,__webpack_require__){!function(moment){"use strict";var monthsShortDot="ene._feb._mar._abr._may._jun._jul._ago._sep._oct._nov._dic.".split("_"),monthsShort="ene_feb_mar_abr_may_jun_jul_ago_sep_oct_nov_dic".split("_");moment.defineLocale("es-us",{months:"enero_febrero_marzo_abril_mayo_junio_julio_agosto_septiembre_octubre_noviembre_diciembre".split("_"),monthsShort:function(m,format){return m?/-MMM-/.test(format)?monthsShort[m.month()]:monthsShortDot[m.month()]:monthsShortDot},monthsParseExact:!0,weekdays:"domingo_lunes_martes_mircoles_jueves_viernes_sbado".split("_"),weekdaysShort:"dom._lun._mar._mi._jue._vie._sb.".split("_"),weekdaysMin:"do_lu_ma_mi_ju_vi_s".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"MM/DD/YYYY",LL:"MMMM [de] D [de] YYYY",LLL:"MMMM [de] D [de] YYYY h:mm A",LLLL:"dddd, MMMM [de] D [de] YYYY h:mm A"},calendar:{sameDay:function(){return"[hoy a la"+(1!==this.hours()?"s":"")+"] LT"},nextDay:function(){return"[maana a la"+(1!==this.hours()?"s":"")+"] LT"},nextWeek:function(){return"dddd [a la"+(1!==this.hours()?"s":"")+"] LT"},lastDay:function(){return"[ayer a la"+(1!==this.hours()?"s":"")+"] LT"},lastWeek:function(){return"[el] dddd [pasado a la"+(1!==this.hours()?"s":"")+"] LT"},sameElse:"L"},relativeTime:{future:"en %s",past:"hace %s",s:"unos segundos",ss:"%d segundos",m:"un minuto",mm:"%d minutos",h:"una hora",hh:"%d horas",d:"un da",dd:"%d das",M:"un mes",MM:"%d meses",y:"un ao",yy:"%d aos"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:0,doy:6}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/es.js":function(module,exports,__webpack_require__){!function(moment){"use strict";var monthsShortDot="ene._feb._mar._abr._may._jun._jul._ago._sep._oct._nov._dic.".split("_"),monthsShort="ene_feb_mar_abr_may_jun_jul_ago_sep_oct_nov_dic".split("_"),monthsParse=[/^ene/i,/^feb/i,/^mar/i,/^abr/i,/^may/i,/^jun/i,/^jul/i,/^ago/i,/^sep/i,/^oct/i,/^nov/i,/^dic/i],monthsRegex=/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre|ene\.?|feb\.?|mar\.?|abr\.?|may\.?|jun\.?|jul\.?|ago\.?|sep\.?|oct\.?|nov\.?|dic\.?)/i;moment.defineLocale("es",{months:"enero_febrero_marzo_abril_mayo_junio_julio_agosto_septiembre_octubre_noviembre_diciembre".split("_"),monthsShort:function(m,format){return m?/-MMM-/.test(format)?monthsShort[m.month()]:monthsShortDot[m.month()]:monthsShortDot},monthsRegex:monthsRegex,monthsShortRegex:monthsRegex,monthsStrictRegex:/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre)/i,monthsShortStrictRegex:/^(ene\.?|feb\.?|mar\.?|abr\.?|may\.?|jun\.?|jul\.?|ago\.?|sep\.?|oct\.?|nov\.?|dic\.?)/i,monthsParse:monthsParse,longMonthsParse:monthsParse,shortMonthsParse:monthsParse,weekdays:"domingo_lunes_martes_mircoles_jueves_viernes_sbado".split("_"),weekdaysShort:"dom._lun._mar._mi._jue._vie._sb.".split("_"),weekdaysMin:"do_lu_ma_mi_ju_vi_s".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY H:mm",LLLL:"dddd, D [de] MMMM [de] YYYY H:mm"},calendar:{sameDay:function(){return"[hoy a la"+(1!==this.hours()?"s":"")+"] LT"},nextDay:function(){return"[maana a la"+(1!==this.hours()?"s":"")+"] LT"},nextWeek:function(){return"dddd [a la"+(1!==this.hours()?"s":"")+"] LT"},lastDay:function(){return"[ayer a la"+(1!==this.hours()?"s":"")+"] LT"},lastWeek:function(){return"[el] dddd [pasado a la"+(1!==this.hours()?"s":"")+"] LT"},sameElse:"L"},relativeTime:{future:"en %s",past:"hace %s",s:"unos segundos",ss:"%d segundos",m:"un minuto",mm:"%d minutos",h:"una hora",hh:"%d horas",d:"un da",dd:"%d das",M:"un mes",MM:"%d meses",y:"un ao",yy:"%d aos"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/et.js":function(module,exports,__webpack_require__){!function(moment){"use strict";function processRelativeTime(number,withoutSuffix,key,isFuture){var format={s:["mne sekundi","mni sekund","paar sekundit"],ss:[number+"sekundi",number+"sekundit"],m:["he minuti","ks minut"],mm:[number+" minuti",number+" minutit"],h:["he tunni","tund aega","ks tund"],hh:[number+" tunni",number+" tundi"],d:["he peva","ks pev"],M:["kuu aja","kuu aega","ks kuu"],MM:[number+" kuu",number+" kuud"],y:["he aasta","aasta","ks aasta"],yy:[number+" aasta",number+" aastat"]};return withoutSuffix?format[key][2]?format[key][2]:format[key][1]:isFuture?format[key][0]:format[key][1]}moment.defineLocale("et",{months:"jaanuar_veebruar_mrts_aprill_mai_juuni_juuli_august_september_oktoober_november_detsember".split("_"),monthsShort:"jaan_veebr_mrts_apr_mai_juuni_juuli_aug_sept_okt_nov_dets".split("_"),weekdays:"phapev_esmaspev_teisipev_kolmapev_neljapev_reede_laupev".split("_"),weekdaysShort:"P_E_T_K_N_R_L".split("_"),weekdaysMin:"P_E_T_K_N_R_L".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},calendar:{sameDay:"[Tna,] LT",nextDay:"[Homme,] LT",nextWeek:"[Jrgmine] dddd LT",lastDay:"[Eile,] LT",lastWeek:"[Eelmine] dddd LT",sameElse:"L"},relativeTime:{future:"%s prast",past:"%s tagasi",s:processRelativeTime,ss:processRelativeTime,m:processRelativeTime,mm:processRelativeTime,h:processRelativeTime,hh:processRelativeTime,d:processRelativeTime,dd:"%d peva",M:processRelativeTime,MM:processRelativeTime,y:processRelativeTime,yy:processRelativeTime},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/eu.js":function(module,exports,__webpack_require__){!function(moment){"use strict";moment.defineLocale("eu",{months:"urtarrila_otsaila_martxoa_apirila_maiatza_ekaina_uztaila_abuztua_iraila_urria_azaroa_abendua".split("_"),monthsShort:"urt._ots._mar._api._mai._eka._uzt._abu._ira._urr._aza._abe.".split("_"),monthsParseExact:!0,weekdays:"igandea_astelehena_asteartea_asteazkena_osteguna_ostirala_larunbata".split("_"),weekdaysShort:"ig._al._ar._az._og._ol._lr.".split("_"),weekdaysMin:"ig_al_ar_az_og_ol_lr".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"YYYY[ko] MMMM[ren] D[a]",LLL:"YYYY[ko] MMMM[ren] D[a] HH:mm",LLLL:"dddd, YYYY[ko] MMMM[ren] D[a] HH:mm",l:"YYYY-M-D",ll:"YYYY[ko] MMM D[a]",lll:"YYYY[ko] MMM D[a] HH:mm",llll:"ddd, YYYY[ko] MMM D[a] HH:mm"},calendar:{sameDay:"[gaur] LT[etan]",nextDay:"[bihar] LT[etan]",nextWeek:"dddd LT[etan]",lastDay:"[atzo] LT[etan]",lastWeek:"[aurreko] dddd LT[etan]",sameElse:"L"},relativeTime:{future:"%s barru",past:"duela %s",s:"segundo batzuk",ss:"%d segundo",m:"minutu bat",mm:"%d minutu",h:"ordu bat",hh:"%d ordu",d:"egun bat",dd:"%d egun",M:"hilabete bat",MM:"%d hilabete",y:"urte bat",yy:"%d urte"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/fa.js":function(module,exports,__webpack_require__){!function(moment){"use strict";var symbolMap={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},numberMap={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};moment.defineLocale("fa",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},meridiemParse:/  |  /,isPM:function(input){return/  /.test(input)},meridiem:function(hour,minute,isLower){return hour<12?"  ":"  "},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[ ] LT",lastWeek:"dddd [] [] LT",sameElse:"L"},relativeTime:{future:" %s",past:"%s ",s:" ",ss:" d%",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(string){return string.replace(/[-]/g,function(match){return numberMap[match]}).replace(//g,",")},postformat:function(string){return string.replace(/\d/g,function(match){return symbolMap[match]}).replace(/,/g,"")},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:6,doy:12}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/fi.js":function(module,exports,__webpack_require__){!function(moment){"use strict";var numbersPast="nolla yksi kaksi kolme nelj viisi kuusi seitsemn kahdeksan yhdeksn".split(" "),numbersFuture=["nolla","yhden","kahden","kolmen","neljn","viiden","kuuden",numbersPast[7],numbersPast[8],numbersPast[9]];function translate(number,withoutSuffix,key,isFuture){var result="";switch(key){case"s":return isFuture?"muutaman sekunnin":"muutama sekunti";case"ss":return isFuture?"sekunnin":"sekuntia";case"m":return isFuture?"minuutin":"minuutti";case"mm":result=isFuture?"minuutin":"minuuttia";break;case"h":return isFuture?"tunnin":"tunti";case"hh":result=isFuture?"tunnin":"tuntia";break;case"d":return isFuture?"pivn":"piv";case"dd":result=isFuture?"pivn":"piv";break;case"M":return isFuture?"kuukauden":"kuukausi";case"MM":result=isFuture?"kuukauden":"kuukautta";break;case"y":return isFuture?"vuoden":"vuosi";case"yy":result=isFuture?"vuoden":"vuotta"}return result=function(number,isFuture){return number<10?isFuture?numbersFuture[number]:numbersPast[number]:number}(number,isFuture)+" "+result}moment.defineLocale("fi",{months:"tammikuu_helmikuu_maaliskuu_huhtikuu_toukokuu_keskuu_heinkuu_elokuu_syyskuu_lokakuu_marraskuu_joulukuu".split("_"),monthsShort:"tammi_helmi_maalis_huhti_touko_kes_hein_elo_syys_loka_marras_joulu".split("_"),weekdays:"sunnuntai_maanantai_tiistai_keskiviikko_torstai_perjantai_lauantai".split("_"),weekdaysShort:"su_ma_ti_ke_to_pe_la".split("_"),weekdaysMin:"su_ma_ti_ke_to_pe_la".split("_"),longDateFormat:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD.MM.YYYY",LL:"Do MMMM[ta] YYYY",LLL:"Do MMMM[ta] YYYY, [klo] HH.mm",LLLL:"dddd, Do MMMM[ta] YYYY, [klo] HH.mm",l:"D.M.YYYY",ll:"Do MMM YYYY",lll:"Do MMM YYYY, [klo] HH.mm",llll:"ddd, Do MMM YYYY, [klo] HH.mm"},calendar:{sameDay:"[tnn] [klo] LT",nextDay:"[huomenna] [klo] LT",nextWeek:"dddd [klo] LT",lastDay:"[eilen] [klo] LT",lastWeek:"[viime] dddd[na] [klo] LT",sameElse:"L"},relativeTime:{future:"%s pst",past:"%s sitten",s:translate,ss:translate,m:translate,mm:translate,h:translate,hh:translate,d:translate,dd:translate,M:translate,MM:translate,y:translate,yy:translate},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/fo.js":function(module,exports,__webpack_require__){!function(moment){"use strict";moment.defineLocale("fo",{months:"januar_februar_mars_aprl_mai_juni_juli_august_september_oktober_november_desember".split("_"),monthsShort:"jan_feb_mar_apr_mai_jun_jul_aug_sep_okt_nov_des".split("_"),weekdays:"sunnudagur_mnadagur_tsdagur_mikudagur_hsdagur_frggjadagur_leygardagur".split("_"),weekdaysShort:"sun_mn_ts_mik_hs_fr_ley".split("_"),weekdaysMin:"su_m_t_mi_h_fr_le".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D. MMMM, YYYY HH:mm"},calendar:{sameDay:"[ dag kl.] LT",nextDay:"[ morgin kl.] LT",nextWeek:"dddd [kl.] LT",lastDay:"[ gjr kl.] LT",lastWeek:"[sstu] dddd [kl] LT",sameElse:"L"},relativeTime:{future:"um %s",past:"%s sani",s:"f sekund",ss:"%d sekundir",m:"ein minutt",mm:"%d minuttir",h:"ein tmi",hh:"%d tmar",d:"ein dagur",dd:"%d dagar",M:"ein mnai",MM:"%d mnair",y:"eitt r",yy:"%d r"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/fr-ca.js":function(module,exports,__webpack_require__){!function(moment){"use strict";moment.defineLocale("fr-ca",{months:"janvier_fvrier_mars_avril_mai_juin_juillet_aot_septembre_octobre_novembre_dcembre".split("_"),monthsShort:"janv._fvr._mars_avr._mai_juin_juil._aot_sept._oct._nov._dc.".split("_"),monthsParseExact:!0,weekdays:"dimanche_lundi_mardi_mercredi_jeudi_vendredi_samedi".split("_"),weekdaysShort:"dim._lun._mar._mer._jeu._ven._sam.".split("_"),weekdaysMin:"di_lu_ma_me_je_ve_sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[Aujourdhui ] LT",nextDay:"[Demain ] LT",nextWeek:"dddd [] LT",lastDay:"[Hier ] LT",lastWeek:"dddd [dernier ] LT",sameElse:"L"},relativeTime:{future:"dans %s",past:"il y a %s",s:"quelques secondes",ss:"%d secondes",m:"une minute",mm:"%d minutes",h:"une heure",hh:"%d heures",d:"un jour",dd:"%d jours",M:"un mois",MM:"%d mois",y:"un an",yy:"%d ans"},dayOfMonthOrdinalParse:/\d{1,2}(er|e)/,ordinal:function(number,period){switch(period){default:case"M":case"Q":case"D":case"DDD":case"d":return number+(1===number?"er":"e");case"w":case"W":return number+(1===number?"re":"e")}}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/fr-ch.js":function(module,exports,__webpack_require__){!function(moment){"use strict";moment.defineLocale("fr-ch",{months:"janvier_fvrier_mars_avril_mai_juin_juillet_aot_septembre_octobre_novembre_dcembre".split("_"),monthsShort:"janv._fvr._mars_avr._mai_juin_juil._aot_sept._oct._nov._dc.".split("_"),monthsParseExact:!0,weekdays:"dimanche_lundi_mardi_mercredi_jeudi_vendredi_samedi".split("_"),weekdaysShort:"dim._lun._mar._mer._jeu._ven._sam.".split("_"),weekdaysMin:"di_lu_ma_me_je_ve_sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[Aujourdhui ] LT",nextDay:"[Demain ] LT",nextWeek:"dddd [] LT",lastDay:"[Hier ] LT",lastWeek:"dddd [dernier ] LT",sameElse:"L"},relativeTime:{future:"dans %s",past:"il y a %s",s:"quelques secondes",ss:"%d secondes",m:"une minute",mm:"%d minutes",h:"une heure",hh:"%d heures",d:"un jour",dd:"%d jours",M:"un mois",MM:"%d mois",y:"un an",yy:"%d ans"},dayOfMonthOrdinalParse:/\d{1,2}(er|e)/,ordinal:function(number,period){switch(period){default:case"M":case"Q":case"D":case"DDD":case"d":return number+(1===number?"er":"e");case"w":case"W":return number+(1===number?"re":"e")}},week:{dow:1,doy:4}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/fr.js":function(module,exports,__webpack_require__){!function(moment){"use strict";moment.defineLocale("fr",{months:"janvier_fvrier_mars_avril_mai_juin_juillet_aot_septembre_octobre_novembre_dcembre".split("_"),monthsShort:"janv._fvr._mars_avr._mai_juin_juil._aot_sept._oct._nov._dc.".split("_"),monthsParseExact:!0,weekdays:"dimanche_lundi_mardi_mercredi_jeudi_vendredi_samedi".split("_"),weekdaysShort:"dim._lun._mar._mer._jeu._ven._sam.".split("_"),weekdaysMin:"di_lu_ma_me_je_ve_sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[Aujourdhui ] LT",nextDay:"[Demain ] LT",nextWeek:"dddd [] LT",lastDay:"[Hier ] LT",lastWeek:"dddd [dernier ] LT",sameElse:"L"},relativeTime:{future:"dans %s",past:"il y a %s",s:"quelques secondes",ss:"%d secondes",m:"une minute",mm:"%d minutes",h:"une heure",hh:"%d heures",d:"un jour",dd:"%d jours",M:"un mois",MM:"%d mois",y:"un an",yy:"%d ans"},dayOfMonthOrdinalParse:/\d{1,2}(er|)/,ordinal:function(number,period){switch(period){case"D":return number+(1===number?"er":"");default:case"M":case"Q":case"DDD":case"d":return number+(1===number?"er":"e");case"w":case"W":return number+(1===number?"re":"e")}},week:{dow:1,doy:4}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/fy.js":function(module,exports,__webpack_require__){!function(moment){"use strict";var monthsShortWithDots="jan._feb._mrt._apr._mai_jun._jul._aug._sep._okt._nov._des.".split("_"),monthsShortWithoutDots="jan_feb_mrt_apr_mai_jun_jul_aug_sep_okt_nov_des".split("_");moment.defineLocale("fy",{months:"jannewaris_febrewaris_maart_april_maaie_juny_july_augustus_septimber_oktober_novimber_desimber".split("_"),monthsShort:function(m,format){return m?/-MMM-/.test(format)?monthsShortWithoutDots[m.month()]:monthsShortWithDots[m.month()]:monthsShortWithDots},monthsParseExact:!0,weekdays:"snein_moandei_tiisdei_woansdei_tongersdei_freed_sneon".split("_"),weekdaysShort:"si._mo._ti._wo._to._fr._so.".split("_"),weekdaysMin:"Si_Mo_Ti_Wo_To_Fr_So".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD-MM-YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[hjoed om] LT",nextDay:"[moarn om] LT",nextWeek:"dddd [om] LT",lastDay:"[juster om] LT",lastWeek:"[frne] dddd [om] LT",sameElse:"L"},relativeTime:{future:"oer %s",past:"%s lyn",s:"in pear sekonden",ss:"%d sekonden",m:"ien mint",mm:"%d minuten",h:"ien oere",hh:"%d oeren",d:"ien dei",dd:"%d dagen",M:"ien moanne",MM:"%d moannen",y:"ien jier",yy:"%d jierren"},dayOfMonthOrdinalParse:/\d{1,2}(ste|de)/,ordinal:function(number){return number+(1===number||8===number||number>=20?"ste":"de")},week:{dow:1,doy:4}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/gd.js":function(module,exports,__webpack_require__){!function(moment){"use strict";moment.defineLocale("gd",{months:["Am Faoilleach","An Gearran","Am Mrt","An Giblean","An Citean","An t-gmhios","An t-Iuchar","An Lnastal","An t-Sultain","An Dmhair","An t-Samhain","An Dbhlachd"],monthsShort:["Faoi","Gear","Mrt","Gibl","Cit","gmh","Iuch","Ln","Sult","Dmh","Samh","Dbh"],monthsParseExact:!0,weekdays:["Didmhnaich","Diluain","Dimirt","Diciadain","Diardaoin","Dihaoine","Disathairne"],weekdaysShort:["Did","Dil","Dim","Dic","Dia","Dih","Dis"],weekdaysMin:["D","Lu","M","Ci","Ar","Ha","Sa"],longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[An-diugh aig] LT",nextDay:"[A-mireach aig] LT",nextWeek:"dddd [aig] LT",lastDay:"[An-d aig] LT",lastWeek:"dddd [seo chaidh] [aig] LT",sameElse:"L"},relativeTime:{future:"ann an %s",past:"bho chionn %s",s:"beagan diogan",ss:"%d diogan",m:"mionaid",mm:"%d mionaidean",h:"uair",hh:"%d uairean",d:"latha",dd:"%d latha",M:"mos",MM:"%d mosan",y:"bliadhna",yy:"%d bliadhna"},dayOfMonthOrdinalParse:/\d{1,2}(d|na|mh)/,ordinal:function(number){var output=1===number?"d":number%10==2?"na":"mh";return number+output},week:{dow:1,doy:4}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/gl.js":function(module,exports,__webpack_require__){!function(moment){"use strict";moment.defineLocale("gl",{months:"xaneiro_febreiro_marzo_abril_maio_xuo_xullo_agosto_setembro_outubro_novembro_decembro".split("_"),monthsShort:"xan._feb._mar._abr._mai._xu._xul._ago._set._out._nov._dec.".split("_"),monthsParseExact:!0,weekdays:"domingo_luns_martes_mrcores_xoves_venres_sbado".split("_"),weekdaysShort:"dom._lun._mar._mr._xov._ven._sb.".split("_"),weekdaysMin:"do_lu_ma_m_xo_ve_s".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY H:mm",LLLL:"dddd, D [de] MMMM [de] YYYY H:mm"},calendar:{sameDay:function(){return"[hoxe "+(1!==this.hours()?"s":"")+"] LT"},nextDay:function(){return"[ma "+(1!==this.hours()?"s":"")+"] LT"},nextWeek:function(){return"dddd ["+(1!==this.hours()?"s":"a")+"] LT"},lastDay:function(){return"[onte "+(1!==this.hours()?"":"a")+"] LT"},lastWeek:function(){return"[o] dddd [pasado "+(1!==this.hours()?"s":"a")+"] LT"},sameElse:"L"},relativeTime:{future:function(str){return 0===str.indexOf("un")?"n"+str:"en "+str},past:"hai %s",s:"uns segundos",ss:"%d segundos",m:"un minuto",mm:"%d minutos",h:"unha hora",hh:"%d horas",d:"un da",dd:"%d das",M:"un mes",MM:"%d meses",y:"un ano",yy:"%d anos"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/gom-latn.js":function(module,exports,__webpack_require__){!function(moment){"use strict";function processRelativeTime(number,withoutSuffix,key,isFuture){var format={s:["thodde secondanim","thodde second"],ss:[number+" secondanim",number+" second"],m:["eka mintan","ek minute"],mm:[number+" mintanim",number+" mintam"],h:["eka horan","ek hor"],hh:[number+" horanim",number+" horam"],d:["eka disan","ek dis"],dd:[number+" disanim",number+" dis"],M:["eka mhoinean","ek mhoino"],MM:[number+" mhoineanim",number+" mhoine"],y:["eka vorsan","ek voros"],yy:[number+" vorsanim",number+" vorsam"]};return withoutSuffix?format[key][0]:format[key][1]}moment.defineLocale("gom-latn",{months:"Janer_Febrer_Mars_Abril_Mai_Jun_Julai_Agost_Setembr_Otubr_Novembr_Dezembr".split("_"),monthsShort:"Jan._Feb._Mars_Abr._Mai_Jun_Jul._Ago._Set._Otu._Nov._Dez.".split("_"),monthsParseExact:!0,weekdays:"Aitar_Somar_Mongllar_Budvar_Brestar_Sukrar_Son'var".split("_"),weekdaysShort:"Ait._Som._Mon._Bud._Bre._Suk._Son.".split("_"),weekdaysMin:"Ai_Sm_Mo_Bu_Br_Su_Sn".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"A h:mm [vazta]",LTS:"A h:mm:ss [vazta]",L:"DD-MM-YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY A h:mm [vazta]",LLLL:"dddd, MMMM[achea] Do, YYYY, A h:mm [vazta]",llll:"ddd, D MMM YYYY, A h:mm [vazta]"},calendar:{sameDay:"[Aiz] LT",nextDay:"[Faleam] LT",nextWeek:"[Ieta to] dddd[,] LT",lastDay:"[Kal] LT",lastWeek:"[Fatlo] dddd[,] LT",sameElse:"L"},relativeTime:{future:"%s",past:"%s adim",s:processRelativeTime,ss:processRelativeTime,m:processRelativeTime,mm:processRelativeTime,h:processRelativeTime,hh:processRelativeTime,d:processRelativeTime,dd:processRelativeTime,M:processRelativeTime,MM:processRelativeTime,y:processRelativeTime,yy:processRelativeTime},dayOfMonthOrdinalParse:/\d{1,2}(er)/,ordinal:function(number,period){switch(period){case"D":return number+"er";default:case"M":case"Q":case"DDD":case"d":case"w":case"W":return number}},week:{dow:1,doy:4},meridiemParse:/rati|sokalli|donparam|sanje/,meridiemHour:function(hour,meridiem){return 12===hour&&(hour=0),"rati"===meridiem?hour<4?hour:hour+12:"sokalli"===meridiem?hour:"donparam"===meridiem?hour>12?hour:hour+12:"sanje"===meridiem?hour+12:void 0},meridiem:function(hour,minute,isLower){return hour<4?"rati":hour<12?"sokalli":hour<16?"donparam":hour<20?"sanje":"rati"}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/gu.js":function(module,exports,__webpack_require__){!function(moment){"use strict";var symbolMap={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},numberMap={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};moment.defineLocale("gu",{months:"___________".split("_"),monthsShort:"._.__.___._._._._._.".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm ",LTS:"A h:mm:ss ",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm ",LLLL:"dddd, D MMMM YYYY, A h:mm "},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(string){return string.replace(/[]/g,function(match){return numberMap[match]})},postformat:function(string){return string.replace(/\d/g,function(match){return symbolMap[match]})},meridiemParse:/|||/,meridiemHour:function(hour,meridiem){return 12===hour&&(hour=0),""===meridiem?hour<4?hour:hour+12:""===meridiem?hour:""===meridiem?hour>=10?hour:hour+12:""===meridiem?hour+12:void 0},meridiem:function(hour,minute,isLower){return hour<4?"":hour<10?"":hour<17?"":hour<20?"":""},week:{dow:0,doy:6}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/he.js":function(module,exports,__webpack_require__){!function(moment){"use strict";moment.defineLocale("he",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D []MMMM YYYY",LLL:"D []MMMM YYYY HH:mm",LLLL:"dddd, D []MMMM YYYY HH:mm",l:"D/M/YYYY",ll:"D MMM YYYY",lll:"D MMM YYYY HH:mm",llll:"ddd, D MMM YYYY HH:mm"},calendar:{sameDay:"[ ]LT",nextDay:"[ ]LT",nextWeek:"dddd [] LT",lastDay:"[ ]LT",lastWeek:"[] dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:" ",ss:"%d ",m:"",mm:"%d ",h:"",hh:function(number){return 2===number?"":number+" "},d:"",dd:function(number){return 2===number?"":number+" "},M:"",MM:function(number){return 2===number?"":number+" "},y:"",yy:function(number){return 2===number?"":number%10==0&&10!==number?number+" ":number+" "}},meridiemParse:/"|"| | | ||/i,isPM:function(input){return/^("| |)$/.test(input)},meridiem:function(hour,minute,isLower){return hour<5?" ":hour<10?"":hour<12?isLower?'"':" ":hour<18?isLower?'"':" ":""}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/hi.js":function(module,exports,__webpack_require__){!function(moment){"use strict";var symbolMap={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},numberMap={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};moment.defineLocale("hi",{months:"___________".split("_"),monthsShort:"._.__.___._._._._._.".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm ",LTS:"A h:mm:ss ",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm ",LLLL:"dddd, D MMMM YYYY, A h:mm "},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:"  ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(string){return string.replace(/[]/g,function(match){return numberMap[match]})},postformat:function(string){return string.replace(/\d/g,function(match){return symbolMap[match]})},meridiemParse:/|||/,meridiemHour:function(hour,meridiem){return 12===hour&&(hour=0),""===meridiem?hour<4?hour:hour+12:""===meridiem?hour:""===meridiem?hour>=10?hour:hour+12:""===meridiem?hour+12:void 0},meridiem:function(hour,minute,isLower){return hour<4?"":hour<10?"":hour<17?"":hour<20?"":""},week:{dow:0,doy:6}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/hr.js":function(module,exports,__webpack_require__){!function(moment){"use strict";function translate(number,withoutSuffix,key){var result=number+" ";switch(key){case"ss":return result+=1===number?"sekunda":2===number||3===number||4===number?"sekunde":"sekundi";case"m":return withoutSuffix?"jedna minuta":"jedne minute";case"mm":return result+=1===number?"minuta":2===number||3===number||4===number?"minute":"minuta";case"h":return withoutSuffix?"jedan sat":"jednog sata";case"hh":return result+=1===number?"sat":2===number||3===number||4===number?"sata":"sati";case"dd":return result+=1===number?"dan":"dana";case"MM":return result+=1===number?"mjesec":2===number||3===number||4===number?"mjeseca":"mjeseci";case"yy":return result+=1===number?"godina":2===number||3===number||4===number?"godine":"godina"}}moment.defineLocale("hr",{months:{format:"sijenja_veljae_oujka_travnja_svibnja_lipnja_srpnja_kolovoza_rujna_listopada_studenoga_prosinca".split("_"),standalone:"sijeanj_veljaa_oujak_travanj_svibanj_lipanj_srpanj_kolovoz_rujan_listopad_studeni_prosinac".split("_")},monthsShort:"sij._velj._ou._tra._svi._lip._srp._kol._ruj._lis._stu._pro.".split("_"),monthsParseExact:!0,weekdays:"nedjelja_ponedjeljak_utorak_srijeda_etvrtak_petak_subota".split("_"),weekdaysShort:"ned._pon._uto._sri._et._pet._sub.".split("_"),weekdaysMin:"ne_po_ut_sr_e_pe_su".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},calendar:{sameDay:"[danas u] LT",nextDay:"[sutra u] LT",nextWeek:function(){switch(this.day()){case 0:return"[u] [nedjelju] [u] LT";case 3:return"[u] [srijedu] [u] LT";case 6:return"[u] [subotu] [u] LT";case 1:case 2:case 4:case 5:return"[u] dddd [u] LT"}},lastDay:"[juer u] LT",lastWeek:function(){switch(this.day()){case 0:case 3:return"[prolu] dddd [u] LT";case 6:return"[prole] [subote] [u] LT";case 1:case 2:case 4:case 5:return"[proli] dddd [u] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"prije %s",s:"par sekundi",ss:translate,m:translate,mm:translate,h:translate,hh:translate,d:"dan",dd:translate,M:"mjesec",MM:translate,y:"godinu",yy:translate},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/hu.js":function(module,exports,__webpack_require__){!function(moment){"use strict";var weekEndings="vasrnap htfn kedden szerdn cstrtkn pnteken szombaton".split(" ");function translate(number,withoutSuffix,key,isFuture){var num=number;switch(key){case"s":return isFuture||withoutSuffix?"nhny msodperc":"nhny msodperce";case"ss":return num+(isFuture||withoutSuffix)?" msodperc":" msodperce";case"m":return"egy"+(isFuture||withoutSuffix?" perc":" perce");case"mm":return num+(isFuture||withoutSuffix?" perc":" perce");case"h":return"egy"+(isFuture||withoutSuffix?" ra":" rja");case"hh":return num+(isFuture||withoutSuffix?" ra":" rja");case"d":return"egy"+(isFuture||withoutSuffix?" nap":" napja");case"dd":return num+(isFuture||withoutSuffix?" nap":" napja");case"M":return"egy"+(isFuture||withoutSuffix?" hnap":" hnapja");case"MM":return num+(isFuture||withoutSuffix?" hnap":" hnapja");case"y":return"egy"+(isFuture||withoutSuffix?" v":" ve");case"yy":return num+(isFuture||withoutSuffix?" v":" ve")}return""}function week(isFuture){return(isFuture?"":"[mlt] ")+"["+weekEndings[this.day()]+"] LT[-kor]"}moment.defineLocale("hu",{months:"janur_februr_mrcius_prilis_mjus_jnius_jlius_augusztus_szeptember_oktber_november_december".split("_"),monthsShort:"jan_feb_mrc_pr_mj_jn_jl_aug_szept_okt_nov_dec".split("_"),weekdays:"vasrnap_htf_kedd_szerda_cstrtk_pntek_szombat".split("_"),weekdaysShort:"vas_ht_kedd_sze_cst_pn_szo".split("_"),weekdaysMin:"v_h_k_sze_cs_p_szo".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"YYYY.MM.DD.",LL:"YYYY. MMMM D.",LLL:"YYYY. MMMM D. H:mm",LLLL:"YYYY. MMMM D., dddd H:mm"},meridiemParse:/de|du/i,isPM:function(input){return"u"===input.charAt(1).toLowerCase()},meridiem:function(hours,minutes,isLower){return hours<12?!0===isLower?"de":"DE":!0===isLower?"du":"DU"},calendar:{sameDay:"[ma] LT[-kor]",nextDay:"[holnap] LT[-kor]",nextWeek:function(){return week.call(this,!0)},lastDay:"[tegnap] LT[-kor]",lastWeek:function(){return week.call(this,!1)},sameElse:"L"},relativeTime:{future:"%s mlva",past:"%s",s:translate,ss:translate,m:translate,mm:translate,h:translate,hh:translate,d:translate,dd:translate,M:translate,MM:translate,y:translate,yy:translate},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/hy-am.js":function(module,exports,__webpack_require__){!function(moment){"use strict";moment.defineLocale("hy-am",{months:{format:"___________".split("_"),standalone:"___________".split("_")},monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY .",LLL:"D MMMM YYYY ., HH:mm",LLLL:"dddd, D MMMM YYYY ., HH:mm"},calendar:{sameDay:"[] LT",nextDay:"[] LT",lastDay:"[] LT",nextWeek:function(){return"dddd [ ] LT"},lastWeek:function(){return"[] dddd [ ] LT"},sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:"  ",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},meridiemParse:/|||/,isPM:function(input){return/^(|)$/.test(input)},meridiem:function(hour){return hour<4?"":hour<12?"":hour<17?"":""},dayOfMonthOrdinalParse:/\d{1,2}|\d{1,2}-(|)/,ordinal:function(number,period){switch(period){case"DDD":case"w":case"W":case"DDDo":return 1===number?number+"-":number+"-";default:return number}},week:{dow:1,doy:7}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/id.js":function(module,exports,__webpack_require__){!function(moment){"use strict";moment.defineLocale("id",{months:"Januari_Februari_Maret_April_Mei_Juni_Juli_Agustus_September_Oktober_November_Desember".split("_"),monthsShort:"Jan_Feb_Mar_Apr_Mei_Jun_Jul_Agt_Sep_Okt_Nov_Des".split("_"),weekdays:"Minggu_Senin_Selasa_Rabu_Kamis_Jumat_Sabtu".split("_"),weekdaysShort:"Min_Sen_Sel_Rab_Kam_Jum_Sab".split("_"),weekdaysMin:"Mg_Sn_Sl_Rb_Km_Jm_Sb".split("_"),longDateFormat:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [pukul] HH.mm",LLLL:"dddd, D MMMM YYYY [pukul] HH.mm"},meridiemParse:/pagi|siang|sore|malam/,meridiemHour:function(hour,meridiem){return 12===hour&&(hour=0),"pagi"===meridiem?hour:"siang"===meridiem?hour>=11?hour:hour+12:"sore"===meridiem||"malam"===meridiem?hour+12:void 0},meridiem:function(hours,minutes,isLower){return hours<11?"pagi":hours<15?"siang":hours<19?"sore":"malam"},calendar:{sameDay:"[Hari ini pukul] LT",nextDay:"[Besok pukul] LT",nextWeek:"dddd [pukul] LT",lastDay:"[Kemarin pukul] LT",lastWeek:"dddd [lalu pukul] LT",sameElse:"L"},relativeTime:{future:"dalam %s",past:"%s yang lalu",s:"beberapa detik",ss:"%d detik",m:"semenit",mm:"%d menit",h:"sejam",hh:"%d jam",d:"sehari",dd:"%d hari",M:"sebulan",MM:"%d bulan",y:"setahun",yy:"%d tahun"},week:{dow:1,doy:7}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/is.js":function(module,exports,__webpack_require__){!function(moment){"use strict";function plural(n){return n%100==11||n%10!=1}function translate(number,withoutSuffix,key,isFuture){var result=number+" ";switch(key){case"s":return withoutSuffix||isFuture?"nokkrar sekndur":"nokkrum sekndum";case"ss":return plural(number)?result+(withoutSuffix||isFuture?"sekndur":"sekndum"):result+"seknda";case"m":return withoutSuffix?"mnta":"mntu";case"mm":return plural(number)?result+(withoutSuffix||isFuture?"mntur":"mntum"):withoutSuffix?result+"mnta":result+"mntu";case"hh":return plural(number)?result+(withoutSuffix||isFuture?"klukkustundir":"klukkustundum"):result+"klukkustund";case"d":return withoutSuffix?"dagur":isFuture?"dag":"degi";case"dd":return plural(number)?withoutSuffix?result+"dagar":result+(isFuture?"daga":"dgum"):withoutSuffix?result+"dagur":result+(isFuture?"dag":"degi");case"M":return withoutSuffix?"mnuur":isFuture?"mnu":"mnui";case"MM":return plural(number)?withoutSuffix?result+"mnuir":result+(isFuture?"mnui":"mnuum"):withoutSuffix?result+"mnuur":result+(isFuture?"mnu":"mnui");case"y":return withoutSuffix||isFuture?"r":"ri";case"yy":return plural(number)?result+(withoutSuffix||isFuture?"r":"rum"):result+(withoutSuffix||isFuture?"r":"ri")}}moment.defineLocale("is",{months:"janar_febrar_mars_aprl_ma_jn_jl_gst_september_oktber_nvember_desember".split("_"),monthsShort:"jan_feb_mar_apr_ma_jn_jl_g_sep_okt_nv_des".split("_"),weekdays:"sunnudagur_mnudagur_rijudagur_mivikudagur_fimmtudagur_fstudagur_laugardagur".split("_"),weekdaysShort:"sun_mn_ri_mi_fim_fs_lau".split("_"),weekdaysMin:"Su_M_r_Mi_Fi_F_La".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY [kl.] H:mm",LLLL:"dddd, D. MMMM YYYY [kl.] H:mm"},calendar:{sameDay:"[ dag kl.] LT",nextDay:"[ morgun kl.] LT",nextWeek:"dddd [kl.] LT",lastDay:"[ gr kl.] LT",lastWeek:"[sasta] dddd [kl.] LT",sameElse:"L"},relativeTime:{future:"eftir %s",past:"fyrir %s san",s:translate,ss:translate,m:translate,mm:translate,h:"klukkustund",hh:translate,d:translate,dd:translate,M:translate,MM:translate,y:translate,yy:translate},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/it.js":function(module,exports,__webpack_require__){!function(moment){"use strict";moment.defineLocale("it",{months:"gennaio_febbraio_marzo_aprile_maggio_giugno_luglio_agosto_settembre_ottobre_novembre_dicembre".split("_"),monthsShort:"gen_feb_mar_apr_mag_giu_lug_ago_set_ott_nov_dic".split("_"),weekdays:"domenica_luned_marted_mercoled_gioved_venerd_sabato".split("_"),weekdaysShort:"dom_lun_mar_mer_gio_ven_sab".split("_"),weekdaysMin:"do_lu_ma_me_gi_ve_sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[Oggi alle] LT",nextDay:"[Domani alle] LT",nextWeek:"dddd [alle] LT",lastDay:"[Ieri alle] LT",lastWeek:function(){switch(this.day()){case 0:return"[la scorsa] dddd [alle] LT";default:return"[lo scorso] dddd [alle] LT"}},sameElse:"L"},relativeTime:{future:function(s){return(/^[0-9].+$/.test(s)?"tra":"in")+" "+s},past:"%s fa",s:"alcuni secondi",ss:"%d secondi",m:"un minuto",mm:"%d minuti",h:"un'ora",hh:"%d ore",d:"un giorno",dd:"%d giorni",M:"un mese",MM:"%d mesi",y:"un anno",yy:"%d anni"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/ja.js":function(module,exports,__webpack_require__){!function(moment){"use strict";moment.defineLocale("ja",{months:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),monthsShort:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYYMD",LLL:"YYYYMD HH:mm",LLLL:"YYYYMD dddd HH:mm",l:"YYYY/MM/DD",ll:"YYYYMD",lll:"YYYYMD HH:mm",llll:"YYYYMD(ddd) HH:mm"},meridiemParse:/|/i,isPM:function(input){return""===input},meridiem:function(hour,minute,isLower){return hour<12?"":""},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:function(now){return now.week()<this.week()?"[]dddd LT":"dddd LT"},lastDay:"[] LT",lastWeek:function(now){return this.week()<now.week()?"[]dddd LT":"dddd LT"},sameElse:"L"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:function(number,period){switch(period){case"d":case"D":case"DDD":return number+"";default:return number}},relativeTime:{future:"%s",past:"%s",s:"",ss:"%d",m:"1",mm:"%d",h:"1",hh:"%d",d:"1",dd:"%d",M:"1",MM:"%d",y:"1",yy:"%d"}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/jv.js":function(module,exports,__webpack_require__){!function(moment){"use strict";moment.defineLocale("jv",{months:"Januari_Februari_Maret_April_Mei_Juni_Juli_Agustus_September_Oktober_Nopember_Desember".split("_"),monthsShort:"Jan_Feb_Mar_Apr_Mei_Jun_Jul_Ags_Sep_Okt_Nop_Des".split("_"),weekdays:"Minggu_Senen_Seloso_Rebu_Kemis_Jemuwah_Septu".split("_"),weekdaysShort:"Min_Sen_Sel_Reb_Kem_Jem_Sep".split("_"),weekdaysMin:"Mg_Sn_Sl_Rb_Km_Jm_Sp".split("_"),longDateFormat:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [pukul] HH.mm",LLLL:"dddd, D MMMM YYYY [pukul] HH.mm"},meridiemParse:/enjing|siyang|sonten|ndalu/,meridiemHour:function(hour,meridiem){return 12===hour&&(hour=0),"enjing"===meridiem?hour:"siyang"===meridiem?hour>=11?hour:hour+12:"sonten"===meridiem||"ndalu"===meridiem?hour+12:void 0},meridiem:function(hours,minutes,isLower){return hours<11?"enjing":hours<15?"siyang":hours<19?"sonten":"ndalu"},calendar:{sameDay:"[Dinten puniko pukul] LT",nextDay:"[Mbenjang pukul] LT",nextWeek:"dddd [pukul] LT",lastDay:"[Kala wingi pukul] LT",lastWeek:"dddd [kepengker pukul] LT",sameElse:"L"},relativeTime:{future:"wonten ing %s",past:"%s ingkang kepengker",s:"sawetawis detik",ss:"%d detik",m:"setunggal menit",mm:"%d menit",h:"setunggal jam",hh:"%d jam",d:"sedinten",dd:"%d dinten",M:"sewulan",MM:"%d wulan",y:"setaun",yy:"%d taun"},week:{dow:1,doy:7}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/ka.js":function(module,exports,__webpack_require__){!function(moment){"use strict";moment.defineLocale("ka",{months:{standalone:"___________".split("_"),format:"___________".split("_")},monthsShort:"___________".split("_"),weekdays:{standalone:"______".split("_"),format:"______".split("_"),isFormat:/(|)/},weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY h:mm A",LLLL:"dddd, D MMMM YYYY h:mm A"},calendar:{sameDay:"[] LT[-]",nextDay:"[] LT[-]",lastDay:"[] LT[-]",nextWeek:"[] dddd LT[-]",lastWeek:"[] dddd LT-",sameElse:"L"},relativeTime:{future:function(s){return/(|||)/.test(s)?s.replace(/$/,""):s+""},past:function(s){return/(||||)/.test(s)?s.replace(/(|)$/," ")://.test(s)?s.replace(/$/," "):void 0},s:" ",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},dayOfMonthOrdinalParse:/0|1-|-\d{1,2}|\d{1,2}-/,ordinal:function(number){return 0===number?number:1===number?number+"-":number<20||number<=100&&number%20==0||number%100==0?"-"+number:number+"-"},week:{dow:1,doy:7}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/kk.js":function(module,exports,__webpack_require__){!function(moment){"use strict";var suffixes={0:"-",1:"-",2:"-",3:"-",4:"-",5:"-",6:"-",7:"-",8:"-",9:"-",10:"-",20:"-",30:"-",40:"-",50:"-",60:"-",70:"-",80:"-",90:"-",100:"-"};moment.defineLocale("kk",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[ ] LT",lastWeek:"[ ] dddd [] LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}-(|)/,ordinal:function(number){var a=number%10,b=number>=100?100:null;return number+(suffixes[number]||suffixes[a]||suffixes[b])},week:{dow:1,doy:7}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/km.js":function(module,exports,__webpack_require__){!function(moment){"use strict";var symbolMap={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},numberMap={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};moment.defineLocale("km",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},meridiemParse:/|/,isPM:function(input){return""===input},meridiem:function(hour,minute,isLower){return hour<12?"":""},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[ ] LT",lastWeek:"dddd [] [] LT",sameElse:"L"},relativeTime:{future:"%s",past:"%s",s:"",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",preparse:function(string){return string.replace(/[]/g,function(match){return numberMap[match]})},postformat:function(string){return string.replace(/\d/g,function(match){return symbolMap[match]})},week:{dow:1,doy:4}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/kn.js":function(module,exports,__webpack_require__){!function(moment){"use strict";var symbolMap={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},numberMap={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};moment.defineLocale("kn",{months:"___________".split("_"),monthsShort:"___________".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm",LTS:"A h:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm",LLLL:"dddd, D MMMM YYYY, A h:mm"},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(string){return string.replace(/[]/g,function(match){return numberMap[match]})},postformat:function(string){return string.replace(/\d/g,function(match){return symbolMap[match]})},meridiemParse:/|||/,meridiemHour:function(hour,meridiem){return 12===hour&&(hour=0),""===meridiem?hour<4?hour:hour+12:""===meridiem?hour:""===meridiem?hour>=10?hour:hour+12:""===meridiem?hour+12:void 0},meridiem:function(hour,minute,isLower){return hour<4?"":hour<10?"":hour<17?"":hour<20?"":""},dayOfMonthOrdinalParse:/\d{1,2}()/,ordinal:function(number){return number+""},week:{dow:0,doy:6}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/ko.js":function(module,exports,__webpack_require__){!function(moment){"use strict";moment.defineLocale("ko",{months:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),monthsShort:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm",LTS:"A h:mm:ss",L:"YYYY.MM.DD.",LL:"YYYY MMMM D",LLL:"YYYY MMMM D A h:mm",LLLL:"YYYY MMMM D dddd A h:mm",l:"YYYY.MM.DD.",ll:"YYYY MMMM D",lll:"YYYY MMMM D A h:mm",llll:"YYYY MMMM D dddd A h:mm"},calendar:{sameDay:" LT",nextDay:" LT",nextWeek:"dddd LT",lastDay:" LT",lastWeek:" dddd LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d",m:"1",mm:"%d",h:" ",hh:"%d",d:"",dd:"%d",M:" ",MM:"%d",y:" ",yy:"%d"},dayOfMonthOrdinalParse:/\d{1,2}(||)/,ordinal:function(number,period){switch(period){case"d":case"D":case"DDD":return number+"";case"M":return number+"";case"w":case"W":return number+"";default:return number}},meridiemParse:/|/,isPM:function(token){return""===token},meridiem:function(hour,minute,isUpper){return hour<12?"":""}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/ky.js":function(module,exports,__webpack_require__){!function(moment){"use strict";var suffixes={0:"-",1:"-",2:"-",3:"-",4:"-",5:"-",6:"-",7:"-",8:"-",9:"-",10:"-",20:"-",30:"-",40:"-",50:"-",60:"-",70:"-",80:"-",90:"-",100:"-"};moment.defineLocale("ky",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[ ] LT",lastWeek:"[ ] dddd [] [] LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}-(|||)/,ordinal:function(number){var a=number%10,b=number>=100?100:null;return number+(suffixes[number]||suffixes[a]||suffixes[b])},week:{dow:1,doy:7}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/lb.js":function(module,exports,__webpack_require__){!function(moment){"use strict";function processRelativeTime(number,withoutSuffix,key,isFuture){var format={m:["eng Minutt","enger Minutt"],h:["eng Stonn","enger Stonn"],d:["een Dag","engem Dag"],M:["ee Mount","engem Mount"],y:["ee Joer","engem Joer"]};return withoutSuffix?format[key][0]:format[key][1]}function eifelerRegelAppliesToNumber(number){if(number=parseInt(number,10),isNaN(number))return!1;if(number<0)return!0;if(number<10)return 4<=number&&number<=7;if(number<100){var lastDigit=number%10,firstDigit=number/10;return eifelerRegelAppliesToNumber(0===lastDigit?firstDigit:lastDigit)}if(number<1e4){for(;number>=10;)number/=10;return eifelerRegelAppliesToNumber(number)}return eifelerRegelAppliesToNumber(number/=1e3)}moment.defineLocale("lb",{months:"Januar_Februar_Merz_Abrll_Mee_Juni_Juli_August_September_Oktober_November_Dezember".split("_"),monthsShort:"Jan._Febr._Mrz._Abr._Mee_Jun._Jul._Aug._Sept._Okt._Nov._Dez.".split("_"),monthsParseExact:!0,weekdays:"Sonndeg_Mindeg_Dnschdeg_Mttwoch_Donneschdeg_Freideg_Samschdeg".split("_"),weekdaysShort:"So._M._D._M._Do._Fr._Sa.".split("_"),weekdaysMin:"So_M_D_M_Do_Fr_Sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm [Auer]",LTS:"H:mm:ss [Auer]",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm [Auer]",LLLL:"dddd, D. MMMM YYYY H:mm [Auer]"},calendar:{sameDay:"[Haut um] LT",sameElse:"L",nextDay:"[Muer um] LT",nextWeek:"dddd [um] LT",lastDay:"[Gschter um] LT",lastWeek:function(){switch(this.day()){case 2:case 4:return"[Leschten] dddd [um] LT";default:return"[Leschte] dddd [um] LT"}}},relativeTime:{future:function(string){return eifelerRegelAppliesToNumber(string.substr(0,string.indexOf(" ")))?"a "+string:"an "+string},past:function(string){return eifelerRegelAppliesToNumber(string.substr(0,string.indexOf(" ")))?"viru "+string:"virun "+string},s:"e puer Sekonnen",ss:"%d Sekonnen",m:processRelativeTime,mm:"%d Minutten",h:processRelativeTime,hh:"%d Stonnen",d:processRelativeTime,dd:"%d Deeg",M:processRelativeTime,MM:"%d Mint",y:processRelativeTime,yy:"%d Joer"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/lo.js":function(module,exports,__webpack_require__){!function(moment){"use strict";moment.defineLocale("lo",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},meridiemParse:/|/,isPM:function(input){return""===input},meridiem:function(hour,minute,isLower){return hour<12?"":""},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"[]dddd[] LT",lastDay:"[] LT",lastWeek:"[]dddd[] LT",sameElse:"L"},relativeTime:{future:" %s",past:"%s",s:"",ss:"%d ",m:"1 ",mm:"%d ",h:"1 ",hh:"%d ",d:"1 ",dd:"%d ",M:"1 ",MM:"%d ",y:"1 ",yy:"%d "},dayOfMonthOrdinalParse:/()\d{1,2}/,ordinal:function(number){return""+number}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/lt.js":function(module,exports,__webpack_require__){!function(moment){"use strict";var units={ss:"sekund_sekundi_sekundes",m:"minut_minuts_minut",mm:"minuts_minui_minutes",h:"valanda_valandos_valand",hh:"valandos_valand_valandas",d:"diena_dienos_dien",dd:"dienos_dien_dienas",M:"mnuo_mnesio_mnes",MM:"mnesiai_mnesi_mnesius",y:"metai_met_metus",yy:"metai_met_metus"};function translateSingular(number,withoutSuffix,key,isFuture){return withoutSuffix?forms(key)[0]:isFuture?forms(key)[1]:forms(key)[2]}function special(number){return number%10==0||number>10&&number<20}function forms(key){return units[key].split("_")}function translate(number,withoutSuffix,key,isFuture){var result=number+" ";return 1===number?result+translateSingular(0,withoutSuffix,key[0],isFuture):withoutSuffix?result+(special(number)?forms(key)[1]:forms(key)[0]):isFuture?result+forms(key)[1]:result+(special(number)?forms(key)[1]:forms(key)[2])}moment.defineLocale("lt",{months:{format:"sausio_vasario_kovo_balandio_gegus_birelio_liepos_rugpjio_rugsjo_spalio_lapkriio_gruodio".split("_"),standalone:"sausis_vasaris_kovas_balandis_gegu_birelis_liepa_rugpjtis_rugsjis_spalis_lapkritis_gruodis".split("_"),isFormat:/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?|MMMM?(\[[^\[\]]*\]|\s)+D[oD]?/},monthsShort:"sau_vas_kov_bal_geg_bir_lie_rgp_rgs_spa_lap_grd".split("_"),weekdays:{format:"sekmadien_pirmadien_antradien_treiadien_ketvirtadien_penktadien_etadien".split("_"),standalone:"sekmadienis_pirmadienis_antradienis_treiadienis_ketvirtadienis_penktadienis_etadienis".split("_"),isFormat:/dddd HH:mm/},weekdaysShort:"Sek_Pir_Ant_Tre_Ket_Pen_e".split("_"),weekdaysMin:"S_P_A_T_K_Pn_".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"YYYY [m.] MMMM D [d.]",LLL:"YYYY [m.] MMMM D [d.], HH:mm [val.]",LLLL:"YYYY [m.] MMMM D [d.], dddd, HH:mm [val.]",l:"YYYY-MM-DD",ll:"YYYY [m.] MMMM D [d.]",lll:"YYYY [m.] MMMM D [d.], HH:mm [val.]",llll:"YYYY [m.] MMMM D [d.], ddd, HH:mm [val.]"},calendar:{sameDay:"[iandien] LT",nextDay:"[Rytoj] LT",nextWeek:"dddd LT",lastDay:"[Vakar] LT",lastWeek:"[Prajus] dddd LT",sameElse:"L"},relativeTime:{future:"po %s",past:"prie %s",s:function(number,withoutSuffix,key,isFuture){return withoutSuffix?"kelios sekunds":isFuture?"keli sekundi":"kelias sekundes"},ss:translate,m:translateSingular,mm:translate,h:translateSingular,hh:translate,d:translateSingular,dd:translate,M:translateSingular,MM:translate,y:translateSingular,yy:translate},dayOfMonthOrdinalParse:/\d{1,2}-oji/,ordinal:function(number){return number+"-oji"},week:{dow:1,doy:4}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/lv.js":function(module,exports,__webpack_require__){!function(moment){"use strict";var units={ss:"sekundes_sekundm_sekunde_sekundes".split("_"),m:"mintes_mintm_minte_mintes".split("_"),mm:"mintes_mintm_minte_mintes".split("_"),h:"stundas_stundm_stunda_stundas".split("_"),hh:"stundas_stundm_stunda_stundas".split("_"),d:"dienas_dienm_diena_dienas".split("_"),dd:"dienas_dienm_diena_dienas".split("_"),M:"mnea_mneiem_mnesis_mnei".split("_"),MM:"mnea_mneiem_mnesis_mnei".split("_"),y:"gada_gadiem_gads_gadi".split("_"),yy:"gada_gadiem_gads_gadi".split("_")};function format(forms,number,withoutSuffix){return withoutSuffix?number%10==1&&number%100!=11?forms[2]:forms[3]:number%10==1&&number%100!=11?forms[0]:forms[1]}function relativeTimeWithPlural(number,withoutSuffix,key){return number+" "+format(units[key],number,withoutSuffix)}function relativeTimeWithSingular(number,withoutSuffix,key){return format(units[key],number,withoutSuffix)}moment.defineLocale("lv",{months:"janvris_februris_marts_aprlis_maijs_jnijs_jlijs_augusts_septembris_oktobris_novembris_decembris".split("_"),monthsShort:"jan_feb_mar_apr_mai_jn_jl_aug_sep_okt_nov_dec".split("_"),weekdays:"svtdiena_pirmdiena_otrdiena_trediena_ceturtdiena_piektdiena_sestdiena".split("_"),weekdaysShort:"Sv_P_O_T_C_Pk_S".split("_"),weekdaysMin:"Sv_P_O_T_C_Pk_S".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY.",LL:"YYYY. [gada] D. MMMM",LLL:"YYYY. [gada] D. MMMM, HH:mm",LLLL:"YYYY. [gada] D. MMMM, dddd, HH:mm"},calendar:{sameDay:"[odien pulksten] LT",nextDay:"[Rt pulksten] LT",nextWeek:"dddd [pulksten] LT",lastDay:"[Vakar pulksten] LT",lastWeek:"[Pagju] dddd [pulksten] LT",sameElse:"L"},relativeTime:{future:"pc %s",past:"pirms %s",s:function(number,withoutSuffix){return withoutSuffix?"daas sekundes":"dam sekundm"},ss:relativeTimeWithPlural,m:relativeTimeWithSingular,mm:relativeTimeWithPlural,h:relativeTimeWithSingular,hh:relativeTimeWithPlural,d:relativeTimeWithSingular,dd:relativeTimeWithPlural,M:relativeTimeWithSingular,MM:relativeTimeWithPlural,y:relativeTimeWithSingular,yy:relativeTimeWithPlural},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/me.js":function(module,exports,__webpack_require__){!function(moment){"use strict";var translator={words:{ss:["sekund","sekunda","sekundi"],m:["jedan minut","jednog minuta"],mm:["minut","minuta","minuta"],h:["jedan sat","jednog sata"],hh:["sat","sata","sati"],dd:["dan","dana","dana"],MM:["mjesec","mjeseca","mjeseci"],yy:["godina","godine","godina"]},correctGrammaticalCase:function(number,wordKey){return 1===number?wordKey[0]:number>=2&&number<=4?wordKey[1]:wordKey[2]},translate:function(number,withoutSuffix,key){var wordKey=translator.words[key];return 1===key.length?withoutSuffix?wordKey[0]:wordKey[1]:number+" "+translator.correctGrammaticalCase(number,wordKey)}};moment.defineLocale("me",{months:"januar_februar_mart_april_maj_jun_jul_avgust_septembar_oktobar_novembar_decembar".split("_"),monthsShort:"jan._feb._mar._apr._maj_jun_jul_avg._sep._okt._nov._dec.".split("_"),monthsParseExact:!0,weekdays:"nedjelja_ponedjeljak_utorak_srijeda_etvrtak_petak_subota".split("_"),weekdaysShort:"ned._pon._uto._sri._et._pet._sub.".split("_"),weekdaysMin:"ne_po_ut_sr_e_pe_su".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},calendar:{sameDay:"[danas u] LT",nextDay:"[sjutra u] LT",nextWeek:function(){switch(this.day()){case 0:return"[u] [nedjelju] [u] LT";case 3:return"[u] [srijedu] [u] LT";case 6:return"[u] [subotu] [u] LT";case 1:case 2:case 4:case 5:return"[u] dddd [u] LT"}},lastDay:"[jue u] LT",lastWeek:function(){return["[prole] [nedjelje] [u] LT","[prolog] [ponedjeljka] [u] LT","[prolog] [utorka] [u] LT","[prole] [srijede] [u] LT","[prolog] [etvrtka] [u] LT","[prolog] [petka] [u] LT","[prole] [subote] [u] LT"][this.day()]},sameElse:"L"},relativeTime:{future:"za %s",past:"prije %s",s:"nekoliko sekundi",ss:translator.translate,m:translator.translate,mm:translator.translate,h:translator.translate,hh:translator.translate,d:"dan",dd:translator.translate,M:"mjesec",MM:translator.translate,y:"godinu",yy:translator.translate},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/mi.js":function(module,exports,__webpack_require__){!function(moment){"use strict";moment.defineLocale("mi",{months:"Kohi-tte_Hui-tanguru_Pout-te-rangi_Paenga-whwh_Haratua_Pipiri_Hngoingoi_Here-turi-kk_Mahuru_Whiringa--nuku_Whiringa--rangi_Hakihea".split("_"),monthsShort:"Kohi_Hui_Pou_Pae_Hara_Pipi_Hngoi_Here_Mahu_Whi-nu_Whi-ra_Haki".split("_"),monthsRegex:/(?:['a-z\u0101\u014D\u016B]+\-?){1,3}/i,monthsStrictRegex:/(?:['a-z\u0101\u014D\u016B]+\-?){1,3}/i,monthsShortRegex:/(?:['a-z\u0101\u014D\u016B]+\-?){1,3}/i,monthsShortStrictRegex:/(?:['a-z\u0101\u014D\u016B]+\-?){1,2}/i,weekdays:"Rtapu_Mane_Trei_Wenerei_Tite_Paraire_Htarei".split("_"),weekdaysShort:"Ta_Ma_T_We_Ti_Pa_H".split("_"),weekdaysMin:"Ta_Ma_T_We_Ti_Pa_H".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [i] HH:mm",LLLL:"dddd, D MMMM YYYY [i] HH:mm"},calendar:{sameDay:"[i teie mahana, i] LT",nextDay:"[apopo i] LT",nextWeek:"dddd [i] LT",lastDay:"[inanahi i] LT",lastWeek:"dddd [whakamutunga i] LT",sameElse:"L"},relativeTime:{future:"i roto i %s",past:"%s i mua",s:"te hkona ruarua",ss:"%d hkona",m:"he meneti",mm:"%d meneti",h:"te haora",hh:"%d haora",d:"he ra",dd:"%d ra",M:"he marama",MM:"%d marama",y:"he tau",yy:"%d tau"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/mk.js":function(module,exports,__webpack_require__){!function(moment){"use strict";moment.defineLocale("mk",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"e_o_____a".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"D.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY H:mm",LLLL:"dddd, D MMMM YYYY H:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"[] dddd [] LT",lastDay:"[ ] LT",lastWeek:function(){switch(this.day()){case 0:case 3:case 6:return"[] dddd [] LT";case 1:case 2:case 4:case 5:return"[] dddd [] LT"}},sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:" ",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}-(|||||)/,ordinal:function(number){var lastDigit=number%10,last2Digits=number%100;return 0===number?number+"-":0===last2Digits?number+"-":last2Digits>10&&last2Digits<20?number+"-":1===lastDigit?number+"-":2===lastDigit?number+"-":7===lastDigit||8===lastDigit?number+"-":number+"-"},week:{dow:1,doy:7}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/ml.js":function(module,exports,__webpack_require__){!function(moment){"use strict";moment.defineLocale("ml",{months:"___________".split("_"),monthsShort:"._._._.___._._._._._.".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm -",LTS:"A h:mm:ss -",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm -",LLLL:"dddd, D MMMM YYYY, A h:mm -"},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},meridiemParse:/|| ||/i,meridiemHour:function(hour,meridiem){return 12===hour&&(hour=0),""===meridiem&&hour>=4||" "===meridiem||""===meridiem?hour+12:hour},meridiem:function(hour,minute,isLower){return hour<4?"":hour<12?"":hour<17?" ":hour<20?"":""}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/mn.js":function(module,exports,__webpack_require__){!function(moment){"use strict";function translate(number,withoutSuffix,key,isFuture){switch(key){case"s":return withoutSuffix?" ":" ";case"ss":return number+(withoutSuffix?" ":" ");case"m":case"mm":return number+(withoutSuffix?" ":" ");case"h":case"hh":return number+(withoutSuffix?" ":" ");case"d":case"dd":return number+(withoutSuffix?" ":" ");case"M":case"MM":return number+(withoutSuffix?" ":" ");case"y":case"yy":return number+(withoutSuffix?" ":" ");default:return number}}moment.defineLocale("mn",{months:" _ _ _ _ _ _ _ _ _ _  _  ".split("_"),monthsShort:"1 _2 _3 _4 _5 _6 _7 _8 _9 _10 _11 _12 ".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"YYYY  MMMM D",LLL:"YYYY  MMMM D HH:mm",LLLL:"dddd, YYYY  MMMM D HH:mm"},meridiemParse:/|/i,isPM:function(input){return""===input},meridiem:function(hour,minute,isLower){return hour<12?"":""},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"[] dddd LT",lastDay:"[] LT",lastWeek:"[] dddd LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:translate,ss:translate,m:translate,mm:translate,h:translate,hh:translate,d:translate,dd:translate,M:translate,MM:translate,y:translate,yy:translate},dayOfMonthOrdinalParse:/\d{1,2} /,ordinal:function(number,period){switch(period){case"d":case"D":case"DDD":return number+" ";default:return number}}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/mr.js":function(module,exports,__webpack_require__){!function(moment){"use strict";var symbolMap={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},numberMap={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};function relativeTimeMr(number,withoutSuffix,string,isFuture){var output="";if(withoutSuffix)switch(string){case"s":output=" ";break;case"ss":output="%d ";break;case"m":output=" ";break;case"mm":output="%d ";break;case"h":output=" ";break;case"hh":output="%d ";break;case"d":output=" ";break;case"dd":output="%d ";break;case"M":output=" ";break;case"MM":output="%d ";break;case"y":output=" ";break;case"yy":output="%d "}else switch(string){case"s":output=" ";break;case"ss":output="%d ";break;case"m":output=" ";break;case"mm":output="%d ";break;case"h":output=" ";break;case"hh":output="%d ";break;case"d":output=" ";break;case"dd":output="%d ";break;case"M":output=" ";break;case"MM":output="%d ";break;case"y":output=" ";break;case"yy":output="%d "}return output.replace(/%d/i,number)}moment.defineLocale("mr",{months:"___________".split("_"),monthsShort:"._._._._._._._._._._._.".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm ",LTS:"A h:mm:ss ",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm ",LLLL:"dddd, D MMMM YYYY, A h:mm "},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s",past:"%s",s:relativeTimeMr,ss:relativeTimeMr,m:relativeTimeMr,mm:relativeTimeMr,h:relativeTimeMr,hh:relativeTimeMr,d:relativeTimeMr,dd:relativeTimeMr,M:relativeTimeMr,MM:relativeTimeMr,y:relativeTimeMr,yy:relativeTimeMr},preparse:function(string){return string.replace(/[]/g,function(match){return numberMap[match]})},postformat:function(string){return string.replace(/\d/g,function(match){return symbolMap[match]})},meridiemParse:/|||/,meridiemHour:function(hour,meridiem){return 12===hour&&(hour=0),""===meridiem?hour<4?hour:hour+12:""===meridiem?hour:""===meridiem?hour>=10?hour:hour+12:""===meridiem?hour+12:void 0},meridiem:function(hour,minute,isLower){return hour<4?"":hour<10?"":hour<17?"":hour<20?"":""},week:{dow:0,doy:6}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/ms-my.js":function(module,exports,__webpack_require__){!function(moment){"use strict";moment.defineLocale("ms-my",{months:"Januari_Februari_Mac_April_Mei_Jun_Julai_Ogos_September_Oktober_November_Disember".split("_"),monthsShort:"Jan_Feb_Mac_Apr_Mei_Jun_Jul_Ogs_Sep_Okt_Nov_Dis".split("_"),weekdays:"Ahad_Isnin_Selasa_Rabu_Khamis_Jumaat_Sabtu".split("_"),weekdaysShort:"Ahd_Isn_Sel_Rab_Kha_Jum_Sab".split("_"),weekdaysMin:"Ah_Is_Sl_Rb_Km_Jm_Sb".split("_"),longDateFormat:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [pukul] HH.mm",LLLL:"dddd, D MMMM YYYY [pukul] HH.mm"},meridiemParse:/pagi|tengahari|petang|malam/,meridiemHour:function(hour,meridiem){return 12===hour&&(hour=0),"pagi"===meridiem?hour:"tengahari"===meridiem?hour>=11?hour:hour+12:"petang"===meridiem||"malam"===meridiem?hour+12:void 0},meridiem:function(hours,minutes,isLower){return hours<11?"pagi":hours<15?"tengahari":hours<19?"petang":"malam"},calendar:{sameDay:"[Hari ini pukul] LT",nextDay:"[Esok pukul] LT",nextWeek:"dddd [pukul] LT",lastDay:"[Kelmarin pukul] LT",lastWeek:"dddd [lepas pukul] LT",sameElse:"L"},relativeTime:{future:"dalam %s",past:"%s yang lepas",s:"beberapa saat",ss:"%d saat",m:"seminit",mm:"%d minit",h:"sejam",hh:"%d jam",d:"sehari",dd:"%d hari",M:"sebulan",MM:"%d bulan",y:"setahun",yy:"%d tahun"},week:{dow:1,doy:7}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/ms.js":function(module,exports,__webpack_require__){!function(moment){"use strict";moment.defineLocale("ms",{months:"Januari_Februari_Mac_April_Mei_Jun_Julai_Ogos_September_Oktober_November_Disember".split("_"),monthsShort:"Jan_Feb_Mac_Apr_Mei_Jun_Jul_Ogs_Sep_Okt_Nov_Dis".split("_"),weekdays:"Ahad_Isnin_Selasa_Rabu_Khamis_Jumaat_Sabtu".split("_"),weekdaysShort:"Ahd_Isn_Sel_Rab_Kha_Jum_Sab".split("_"),weekdaysMin:"Ah_Is_Sl_Rb_Km_Jm_Sb".split("_"),longDateFormat:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [pukul] HH.mm",LLLL:"dddd, D MMMM YYYY [pukul] HH.mm"},meridiemParse:/pagi|tengahari|petang|malam/,meridiemHour:function(hour,meridiem){return 12===hour&&(hour=0),"pagi"===meridiem?hour:"tengahari"===meridiem?hour>=11?hour:hour+12:"petang"===meridiem||"malam"===meridiem?hour+12:void 0},meridiem:function(hours,minutes,isLower){return hours<11?"pagi":hours<15?"tengahari":hours<19?"petang":"malam"},calendar:{sameDay:"[Hari ini pukul] LT",nextDay:"[Esok pukul] LT",nextWeek:"dddd [pukul] LT",lastDay:"[Kelmarin pukul] LT",lastWeek:"dddd [lepas pukul] LT",sameElse:"L"},relativeTime:{future:"dalam %s",past:"%s yang lepas",s:"beberapa saat",ss:"%d saat",m:"seminit",mm:"%d minit",h:"sejam",hh:"%d jam",d:"sehari",dd:"%d hari",M:"sebulan",MM:"%d bulan",y:"setahun",yy:"%d tahun"},week:{dow:1,doy:7}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/mt.js":function(module,exports,__webpack_require__){!function(moment){"use strict";moment.defineLocale("mt",{months:"Jannar_Frar_Marzu_April_Mejju_unju_Lulju_Awwissu_Settembru_Ottubru_Novembru_Diembru".split("_"),monthsShort:"Jan_Fra_Mar_Apr_Mej_un_Lul_Aww_Set_Ott_Nov_Di".split("_"),weekdays:"Il-add_It-Tnejn_It-Tlieta_L-Erbga_Il-amis_Il-imga_Is-Sibt".split("_"),weekdaysShort:"ad_Tne_Tli_Erb_am_im_Sib".split("_"),weekdaysMin:"a_Tn_Tl_Er_a_i_Si".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Illum fil-]LT",nextDay:"[Gada fil-]LT",nextWeek:"dddd [fil-]LT",lastDay:"[Il-biera fil-]LT",lastWeek:"dddd [li gadda] [fil-]LT",sameElse:"L"},relativeTime:{future:"f %s",past:"%s ilu",s:"ftit sekondi",ss:"%d sekondi",m:"minuta",mm:"%d minuti",h:"siega",hh:"%d siegat",d:"urnata",dd:"%d ranet",M:"xahar",MM:"%d xhur",y:"sena",yy:"%d sni"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/my.js":function(module,exports,__webpack_require__){!function(moment){"use strict";var symbolMap={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},numberMap={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};moment.defineLocale("my",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[.] LT []",nextDay:"[] LT []",nextWeek:"dddd LT []",lastDay:"[.] LT []",lastWeek:"[] dddd LT []",sameElse:"L"},relativeTime:{future:" %s ",past:" %s ",s:".",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},preparse:function(string){return string.replace(/[]/g,function(match){return numberMap[match]})},postformat:function(string){return string.replace(/\d/g,function(match){return symbolMap[match]})},week:{dow:1,doy:4}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/nb.js":function(module,exports,__webpack_require__){!function(moment){"use strict";moment.defineLocale("nb",{months:"januar_februar_mars_april_mai_juni_juli_august_september_oktober_november_desember".split("_"),monthsShort:"jan._feb._mars_april_mai_juni_juli_aug._sep._okt._nov._des.".split("_"),monthsParseExact:!0,weekdays:"sndag_mandag_tirsdag_onsdag_torsdag_fredag_lrdag".split("_"),weekdaysShort:"s._ma._ti._on._to._fr._l.".split("_"),weekdaysMin:"s_ma_ti_on_to_fr_l".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY [kl.] HH:mm",LLLL:"dddd D. MMMM YYYY [kl.] HH:mm"},calendar:{sameDay:"[i dag kl.] LT",nextDay:"[i morgen kl.] LT",nextWeek:"dddd [kl.] LT",lastDay:"[i gr kl.] LT",lastWeek:"[forrige] dddd [kl.] LT",sameElse:"L"},relativeTime:{future:"om %s",past:"%s siden",s:"noen sekunder",ss:"%d sekunder",m:"ett minutt",mm:"%d minutter",h:"en time",hh:"%d timer",d:"en dag",dd:"%d dager",M:"en mned",MM:"%d mneder",y:"ett r",yy:"%d r"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/ne.js":function(module,exports,__webpack_require__){!function(moment){"use strict";var symbolMap={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},numberMap={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};moment.defineLocale("ne",{months:"___________".split("_"),monthsShort:"._.__.___._._._._._.".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"._._._._._._.".split("_"),weekdaysMin:"._._._._._._.".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"A h:mm ",LTS:"A h:mm:ss ",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm ",LLLL:"dddd, D MMMM YYYY, A h:mm "},preparse:function(string){return string.replace(/[]/g,function(match){return numberMap[match]})},postformat:function(string){return string.replace(/\d/g,function(match){return symbolMap[match]})},meridiemParse:/|||/,meridiemHour:function(hour,meridiem){return 12===hour&&(hour=0),""===meridiem?hour<4?hour:hour+12:""===meridiem?hour:""===meridiem?hour>=10?hour:hour+12:""===meridiem?hour+12:void 0},meridiem:function(hour,minute,isLower){return hour<3?"":hour<12?"":hour<16?"":hour<20?"":""},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"[] dddd[,] LT",lastDay:"[] LT",lastWeek:"[] dddd[,] LT",sameElse:"L"},relativeTime:{future:"%s",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},week:{dow:0,doy:6}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/nl-be.js":function(module,exports,__webpack_require__){!function(moment){"use strict";var monthsShortWithDots="jan._feb._mrt._apr._mei_jun._jul._aug._sep._okt._nov._dec.".split("_"),monthsShortWithoutDots="jan_feb_mrt_apr_mei_jun_jul_aug_sep_okt_nov_dec".split("_"),monthsParse=[/^jan/i,/^feb/i,/^maart|mrt.?$/i,/^apr/i,/^mei$/i,/^jun[i.]?$/i,/^jul[i.]?$/i,/^aug/i,/^sep/i,/^okt/i,/^nov/i,/^dec/i],monthsRegex=/^(januari|februari|maart|april|mei|april|ju[nl]i|augustus|september|oktober|november|december|jan\.?|feb\.?|mrt\.?|apr\.?|ju[nl]\.?|aug\.?|sep\.?|okt\.?|nov\.?|dec\.?)/i;moment.defineLocale("nl-be",{months:"januari_februari_maart_april_mei_juni_juli_augustus_september_oktober_november_december".split("_"),monthsShort:function(m,format){return m?/-MMM-/.test(format)?monthsShortWithoutDots[m.month()]:monthsShortWithDots[m.month()]:monthsShortWithDots},monthsRegex:monthsRegex,monthsShortRegex:monthsRegex,monthsStrictRegex:/^(januari|februari|maart|mei|ju[nl]i|april|augustus|september|oktober|november|december)/i,monthsShortStrictRegex:/^(jan\.?|feb\.?|mrt\.?|apr\.?|mei|ju[nl]\.?|aug\.?|sep\.?|okt\.?|nov\.?|dec\.?)/i,monthsParse:monthsParse,longMonthsParse:monthsParse,shortMonthsParse:monthsParse,weekdays:"zondag_maandag_dinsdag_woensdag_donderdag_vrijdag_zaterdag".split("_"),weekdaysShort:"zo._ma._di._wo._do._vr._za.".split("_"),weekdaysMin:"zo_ma_di_wo_do_vr_za".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[vandaag om] LT",nextDay:"[morgen om] LT",nextWeek:"dddd [om] LT",lastDay:"[gisteren om] LT",lastWeek:"[afgelopen] dddd [om] LT",sameElse:"L"},relativeTime:{future:"over %s",past:"%s geleden",s:"een paar seconden",ss:"%d seconden",m:"n minuut",mm:"%d minuten",h:"n uur",hh:"%d uur",d:"n dag",dd:"%d dagen",M:"n maand",MM:"%d maanden",y:"n jaar",yy:"%d jaar"},dayOfMonthOrdinalParse:/\d{1,2}(ste|de)/,ordinal:function(number){return number+(1===number||8===number||number>=20?"ste":"de")},week:{dow:1,doy:4}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/nl.js":function(module,exports,__webpack_require__){!function(moment){"use strict";var monthsShortWithDots="jan._feb._mrt._apr._mei_jun._jul._aug._sep._okt._nov._dec.".split("_"),monthsShortWithoutDots="jan_feb_mrt_apr_mei_jun_jul_aug_sep_okt_nov_dec".split("_"),monthsParse=[/^jan/i,/^feb/i,/^maart|mrt.?$/i,/^apr/i,/^mei$/i,/^jun[i.]?$/i,/^jul[i.]?$/i,/^aug/i,/^sep/i,/^okt/i,/^nov/i,/^dec/i],monthsRegex=/^(januari|februari|maart|april|mei|april|ju[nl]i|augustus|september|oktober|november|december|jan\.?|feb\.?|mrt\.?|apr\.?|ju[nl]\.?|aug\.?|sep\.?|okt\.?|nov\.?|dec\.?)/i;moment.defineLocale("nl",{months:"januari_februari_maart_april_mei_juni_juli_augustus_september_oktober_november_december".split("_"),monthsShort:function(m,format){return m?/-MMM-/.test(format)?monthsShortWithoutDots[m.month()]:monthsShortWithDots[m.month()]:monthsShortWithDots},monthsRegex:monthsRegex,monthsShortRegex:monthsRegex,monthsStrictRegex:/^(januari|februari|maart|mei|ju[nl]i|april|augustus|september|oktober|november|december)/i,monthsShortStrictRegex:/^(jan\.?|feb\.?|mrt\.?|apr\.?|mei|ju[nl]\.?|aug\.?|sep\.?|okt\.?|nov\.?|dec\.?)/i,monthsParse:monthsParse,longMonthsParse:monthsParse,shortMonthsParse:monthsParse,weekdays:"zondag_maandag_dinsdag_woensdag_donderdag_vrijdag_zaterdag".split("_"),weekdaysShort:"zo._ma._di._wo._do._vr._za.".split("_"),weekdaysMin:"zo_ma_di_wo_do_vr_za".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD-MM-YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[vandaag om] LT",nextDay:"[morgen om] LT",nextWeek:"dddd [om] LT",lastDay:"[gisteren om] LT",lastWeek:"[afgelopen] dddd [om] LT",sameElse:"L"},relativeTime:{future:"over %s",past:"%s geleden",s:"een paar seconden",ss:"%d seconden",m:"n minuut",mm:"%d minuten",h:"n uur",hh:"%d uur",d:"n dag",dd:"%d dagen",M:"n maand",MM:"%d maanden",y:"n jaar",yy:"%d jaar"},dayOfMonthOrdinalParse:/\d{1,2}(ste|de)/,ordinal:function(number){return number+(1===number||8===number||number>=20?"ste":"de")},week:{dow:1,doy:4}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/nn.js":function(module,exports,__webpack_require__){!function(moment){"use strict";moment.defineLocale("nn",{months:"januar_februar_mars_april_mai_juni_juli_august_september_oktober_november_desember".split("_"),monthsShort:"jan_feb_mar_apr_mai_jun_jul_aug_sep_okt_nov_des".split("_"),weekdays:"sundag_mndag_tysdag_onsdag_torsdag_fredag_laurdag".split("_"),weekdaysShort:"sun_mn_tys_ons_tor_fre_lau".split("_"),weekdaysMin:"su_m_ty_on_to_fr_l".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY [kl.] H:mm",LLLL:"dddd D. MMMM YYYY [kl.] HH:mm"},calendar:{sameDay:"[I dag klokka] LT",nextDay:"[I morgon klokka] LT",nextWeek:"dddd [klokka] LT",lastDay:"[I gr klokka] LT",lastWeek:"[Fregande] dddd [klokka] LT",sameElse:"L"},relativeTime:{future:"om %s",past:"%s sidan",s:"nokre sekund",ss:"%d sekund",m:"eit minutt",mm:"%d minutt",h:"ein time",hh:"%d timar",d:"ein dag",dd:"%d dagar",M:"ein mnad",MM:"%d mnader",y:"eit r",yy:"%d r"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/pa-in.js":function(module,exports,__webpack_require__){!function(moment){"use strict";var symbolMap={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},numberMap={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};moment.defineLocale("pa-in",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm ",LTS:"A h:mm:ss ",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm ",LLLL:"dddd, D MMMM YYYY, A h:mm "},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(string){return string.replace(/[]/g,function(match){return numberMap[match]})},postformat:function(string){return string.replace(/\d/g,function(match){return symbolMap[match]})},meridiemParse:/|||/,meridiemHour:function(hour,meridiem){return 12===hour&&(hour=0),""===meridiem?hour<4?hour:hour+12:""===meridiem?hour:""===meridiem?hour>=10?hour:hour+12:""===meridiem?hour+12:void 0},meridiem:function(hour,minute,isLower){return hour<4?"":hour<10?"":hour<17?"":hour<20?"":""},week:{dow:0,doy:6}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/pl.js":function(module,exports,__webpack_require__){!function(moment){"use strict";var monthsNominative="stycze_luty_marzec_kwiecie_maj_czerwiec_lipiec_sierpie_wrzesie_padziernik_listopad_grudzie".split("_"),monthsSubjective="stycznia_lutego_marca_kwietnia_maja_czerwca_lipca_sierpnia_wrzenia_padziernika_listopada_grudnia".split("_");function plural(n){return n%10<5&&n%10>1&&~~(n/10)%10!=1}function translate(number,withoutSuffix,key){var result=number+" ";switch(key){case"ss":return result+(plural(number)?"sekundy":"sekund");case"m":return withoutSuffix?"minuta":"minut";case"mm":return result+(plural(number)?"minuty":"minut");case"h":return withoutSuffix?"godzina":"godzin";case"hh":return result+(plural(number)?"godziny":"godzin");case"MM":return result+(plural(number)?"miesice":"miesicy");case"yy":return result+(plural(number)?"lata":"lat")}}moment.defineLocale("pl",{months:function(momentToFormat,format){return momentToFormat?""===format?"("+monthsSubjective[momentToFormat.month()]+"|"+monthsNominative[momentToFormat.month()]+")":/D MMMM/.test(format)?monthsSubjective[momentToFormat.month()]:monthsNominative[momentToFormat.month()]:monthsNominative},monthsShort:"sty_lut_mar_kwi_maj_cze_lip_sie_wrz_pa_lis_gru".split("_"),weekdays:"niedziela_poniedziaek_wtorek_roda_czwartek_pitek_sobota".split("_"),weekdaysShort:"ndz_pon_wt_r_czw_pt_sob".split("_"),weekdaysMin:"Nd_Pn_Wt_r_Cz_Pt_So".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Dzi o] LT",nextDay:"[Jutro o] LT",nextWeek:function(){switch(this.day()){case 0:return"[W niedziel o] LT";case 2:return"[We wtorek o] LT";case 3:return"[W rod o] LT";case 6:return"[W sobot o] LT";default:return"[W] dddd [o] LT"}},lastDay:"[Wczoraj o] LT",lastWeek:function(){switch(this.day()){case 0:return"[W zesz niedziel o] LT";case 3:return"[W zesz rod o] LT";case 6:return"[W zesz sobot o] LT";default:return"[W zeszy] dddd [o] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"%s temu",s:"kilka sekund",ss:translate,m:translate,mm:translate,h:translate,hh:translate,d:"1 dzie",dd:"%d dni",M:"miesic",MM:translate,y:"rok",yy:translate},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/pt-br.js":function(module,exports,__webpack_require__){!function(moment){"use strict";moment.defineLocale("pt-br",{months:"janeiro_fevereiro_maro_abril_maio_junho_julho_agosto_setembro_outubro_novembro_dezembro".split("_"),monthsShort:"jan_fev_mar_abr_mai_jun_jul_ago_set_out_nov_dez".split("_"),weekdays:"Domingo_Segunda-feira_Tera-feira_Quarta-feira_Quinta-feira_Sexta-feira_Sbado".split("_"),weekdaysShort:"Dom_Seg_Ter_Qua_Qui_Sex_Sb".split("_"),weekdaysMin:"Do_2_3_4_5_6_S".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY [s] HH:mm",LLLL:"dddd, D [de] MMMM [de] YYYY [s] HH:mm"},calendar:{sameDay:"[Hoje s] LT",nextDay:"[Amanh s] LT",nextWeek:"dddd [s] LT",lastDay:"[Ontem s] LT",lastWeek:function(){return 0===this.day()||6===this.day()?"[ltimo] dddd [s] LT":"[ltima] dddd [s] LT"},sameElse:"L"},relativeTime:{future:"em %s",past:"h %s",s:"poucos segundos",ss:"%d segundos",m:"um minuto",mm:"%d minutos",h:"uma hora",hh:"%d horas",d:"um dia",dd:"%d dias",M:"um ms",MM:"%d meses",y:"um ano",yy:"%d anos"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d"})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/pt.js":function(module,exports,__webpack_require__){!function(moment){"use strict";moment.defineLocale("pt",{months:"janeiro_fevereiro_maro_abril_maio_junho_julho_agosto_setembro_outubro_novembro_dezembro".split("_"),monthsShort:"jan_fev_mar_abr_mai_jun_jul_ago_set_out_nov_dez".split("_"),weekdays:"Domingo_Segunda-feira_Tera-feira_Quarta-feira_Quinta-feira_Sexta-feira_Sbado".split("_"),weekdaysShort:"Dom_Seg_Ter_Qua_Qui_Sex_Sb".split("_"),weekdaysMin:"Do_2_3_4_5_6_S".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY HH:mm",LLLL:"dddd, D [de] MMMM [de] YYYY HH:mm"},calendar:{sameDay:"[Hoje s] LT",nextDay:"[Amanh s] LT",nextWeek:"dddd [s] LT",lastDay:"[Ontem s] LT",lastWeek:function(){return 0===this.day()||6===this.day()?"[ltimo] dddd [s] LT":"[ltima] dddd [s] LT"},sameElse:"L"},relativeTime:{future:"em %s",past:"h %s",s:"segundos",ss:"%d segundos",m:"um minuto",mm:"%d minutos",h:"uma hora",hh:"%d horas",d:"um dia",dd:"%d dias",M:"um ms",MM:"%d meses",y:"um ano",yy:"%d anos"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/ro.js":function(module,exports,__webpack_require__){!function(moment){"use strict";function relativeTimeWithPlural(number,withoutSuffix,key){var separator=" ";return(number%100>=20||number>=100&&number%100==0)&&(separator=" de "),number+separator+{ss:"secunde",mm:"minute",hh:"ore",dd:"zile",MM:"luni",yy:"ani"}[key]}moment.defineLocale("ro",{months:"ianuarie_februarie_martie_aprilie_mai_iunie_iulie_august_septembrie_octombrie_noiembrie_decembrie".split("_"),monthsShort:"ian._febr._mart._apr._mai_iun._iul._aug._sept._oct._nov._dec.".split("_"),monthsParseExact:!0,weekdays:"duminic_luni_mari_miercuri_joi_vineri_smbt".split("_"),weekdaysShort:"Dum_Lun_Mar_Mie_Joi_Vin_Sm".split("_"),weekdaysMin:"Du_Lu_Ma_Mi_Jo_Vi_S".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY H:mm",LLLL:"dddd, D MMMM YYYY H:mm"},calendar:{sameDay:"[azi la] LT",nextDay:"[mine la] LT",nextWeek:"dddd [la] LT",lastDay:"[ieri la] LT",lastWeek:"[fosta] dddd [la] LT",sameElse:"L"},relativeTime:{future:"peste %s",past:"%s n urm",s:"cteva secunde",ss:relativeTimeWithPlural,m:"un minut",mm:relativeTimeWithPlural,h:"o or",hh:relativeTimeWithPlural,d:"o zi",dd:relativeTimeWithPlural,M:"o lun",MM:relativeTimeWithPlural,y:"un an",yy:relativeTimeWithPlural},week:{dow:1,doy:7}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/ru.js":function(module,exports,__webpack_require__){!function(moment){"use strict";function relativeTimeWithPlural(number,withoutSuffix,key){var num,forms,format={ss:withoutSuffix?"__":"__",mm:withoutSuffix?"__":"__",hh:"__",dd:"__",MM:"__",yy:"__"};return"m"===key?withoutSuffix?"":"":number+" "+(num=+number,forms=format[key].split("_"),num%10==1&&num%100!=11?forms[0]:num%10>=2&&num%10<=4&&(num%100<10||num%100>=20)?forms[1]:forms[2])}var monthsParse=[/^/i,/^/i,/^/i,/^/i,/^[]/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i];moment.defineLocale("ru",{months:{format:"___________".split("_"),standalone:"___________".split("_")},monthsShort:{format:"._._._.____._._._._.".split("_"),standalone:"._.__.____._._._._.".split("_")},weekdays:{standalone:"______".split("_"),format:"______".split("_"),isFormat:/\[ ?[] ?(?:||)? ?\] ?dddd/},weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),monthsParse:monthsParse,longMonthsParse:monthsParse,shortMonthsParse:monthsParse,monthsRegex:/^([]|\.?|[]|?\.?|?|\.?|[]|\.?|[]|[]|\.?|[]|\.?|?|\.?|[]|?\.?|[]|\.?|[]|?\.?|[]|\.?)/i,monthsShortRegex:/^([]|\.?|[]|?\.?|?|\.?|[]|\.?|[]|[]|\.?|[]|\.?|?|\.?|[]|?\.?|[]|\.?|[]|?\.?|[]|\.?)/i,monthsStrictRegex:/^([]|[]|?|[]|[]|[]|[]|?|[]|[]|[]|[])/i,monthsShortStrictRegex:/^(\.|?\.|[.]|\.|[]|[.]|[.]|\.|?\.|\.|?\.|\.)/i,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY .",LLL:"D MMMM YYYY ., H:mm",LLLL:"dddd, D MMMM YYYY ., H:mm"},calendar:{sameDay:"[, ] LT",nextDay:"[, ] LT",lastDay:"[, ] LT",nextWeek:function(now){if(now.week()===this.week())return 2===this.day()?"[] dddd, [] LT":"[] dddd, [] LT";switch(this.day()){case 0:return"[ ] dddd, [] LT";case 1:case 2:case 4:return"[ ] dddd, [] LT";case 3:case 5:case 6:return"[ ] dddd, [] LT"}},lastWeek:function(now){if(now.week()===this.week())return 2===this.day()?"[] dddd, [] LT":"[] dddd, [] LT";switch(this.day()){case 0:return"[ ] dddd, [] LT";case 1:case 2:case 4:return"[ ] dddd, [] LT";case 3:case 5:case 6:return"[ ] dddd, [] LT"}},sameElse:"L"},relativeTime:{future:" %s",past:"%s ",s:" ",ss:relativeTimeWithPlural,m:relativeTimeWithPlural,mm:relativeTimeWithPlural,h:"",hh:relativeTimeWithPlural,d:"",dd:relativeTimeWithPlural,M:"",MM:relativeTimeWithPlural,y:"",yy:relativeTimeWithPlural},meridiemParse:/|||/i,isPM:function(input){return/^(|)$/.test(input)},meridiem:function(hour,minute,isLower){return hour<4?"":hour<12?"":hour<17?"":""},dayOfMonthOrdinalParse:/\d{1,2}-(||)/,ordinal:function(number,period){switch(period){case"M":case"d":case"DDD":return number+"-";case"D":return number+"-";case"w":case"W":return number+"-";default:return number}},week:{dow:1,doy:4}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/sd.js":function(module,exports,__webpack_require__){!function(moment){"use strict";var months=["","","","","","","","","","","",""],days=["","","","","","",""];moment.defineLocale("sd",{months:months,monthsShort:months,weekdays:days,weekdaysShort:days,weekdaysMin:days,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},meridiemParse:/|/,isPM:function(input){return""===input},meridiem:function(hour,minute,isLower){return hour<12?"":""},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd [  ] LT",lastDay:"[] LT",lastWeek:"[ ] dddd [] LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(string){return string.replace(//g,",")},postformat:function(string){return string.replace(/,/g,"")},week:{dow:1,doy:4}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/se.js":function(module,exports,__webpack_require__){!function(moment){"use strict";moment.defineLocale("se",{months:"oajagemnnu_guovvamnnu_njukamnnu_cuoomnnu_miessemnnu_geassemnnu_suoidnemnnu_borgemnnu_akamnnu_golggotmnnu_skbmamnnu_juovlamnnu".split("_"),monthsShort:"oj_guov_njuk_cuo_mies_geas_suoi_borg_ak_golg_skb_juov".split("_"),weekdays:"sotnabeaivi_vuossrga_maebrga_gaskavahkku_duorastat_bearjadat_lvvardat".split("_"),weekdaysShort:"sotn_vuos_ma_gask_duor_bear_lv".split("_"),weekdaysMin:"s_v_m_g_d_b_L".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"MMMM D. [b.] YYYY",LLL:"MMMM D. [b.] YYYY [ti.] HH:mm",LLLL:"dddd, MMMM D. [b.] YYYY [ti.] HH:mm"},calendar:{sameDay:"[otne ti] LT",nextDay:"[ihttin ti] LT",nextWeek:"dddd [ti] LT",lastDay:"[ikte ti] LT",lastWeek:"[ovddit] dddd [ti] LT",sameElse:"L"},relativeTime:{future:"%s geaes",past:"mait %s",s:"moadde sekunddat",ss:"%d sekunddat",m:"okta minuhta",mm:"%d minuhtat",h:"okta diimmu",hh:"%d diimmut",d:"okta beaivi",dd:"%d beaivvit",M:"okta mnnu",MM:"%d mnut",y:"okta jahki",yy:"%d jagit"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/si.js":function(module,exports,__webpack_require__){!function(moment){"use strict";moment.defineLocale("si",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"a h:mm",LTS:"a h:mm:ss",L:"YYYY/MM/DD",LL:"YYYY MMMM D",LLL:"YYYY MMMM D, a h:mm",LLLL:"YYYY MMMM D [] dddd, a h:mm:ss"},calendar:{sameDay:"[] LT[]",nextDay:"[] LT[]",nextWeek:"dddd LT[]",lastDay:"[] LT[]",lastWeek:"[] dddd LT[]",sameElse:"L"},relativeTime:{future:"%s",past:"%s ",s:" ",ss:" %d",m:"",mm:" %d",h:"",hh:" %d",d:"",dd:" %d",M:"",MM:" %d",y:"",yy:" %d"},dayOfMonthOrdinalParse:/\d{1,2} /,ordinal:function(number){return number+" "},meridiemParse:/ | |.|../,isPM:function(input){return".."===input||" "===input},meridiem:function(hours,minutes,isLower){return hours>11?isLower?"..":" ":isLower?"..":" "}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/sk.js":function(module,exports,__webpack_require__){!function(moment){"use strict";var months="janur_februr_marec_aprl_mj_jn_jl_august_september_oktber_november_december".split("_"),monthsShort="jan_feb_mar_apr_mj_jn_jl_aug_sep_okt_nov_dec".split("_");function plural(n){return n>1&&n<5}function translate(number,withoutSuffix,key,isFuture){var result=number+" ";switch(key){case"s":return withoutSuffix||isFuture?"pr seknd":"pr sekundami";case"ss":return withoutSuffix||isFuture?result+(plural(number)?"sekundy":"seknd"):result+"sekundami";case"m":return withoutSuffix?"minta":isFuture?"mintu":"mintou";case"mm":return withoutSuffix||isFuture?result+(plural(number)?"minty":"mint"):result+"mintami";case"h":return withoutSuffix?"hodina":isFuture?"hodinu":"hodinou";case"hh":return withoutSuffix||isFuture?result+(plural(number)?"hodiny":"hodn"):result+"hodinami";case"d":return withoutSuffix||isFuture?"de":"dom";case"dd":return withoutSuffix||isFuture?result+(plural(number)?"dni":"dn"):result+"dami";case"M":return withoutSuffix||isFuture?"mesiac":"mesiacom";case"MM":return withoutSuffix||isFuture?result+(plural(number)?"mesiace":"mesiacov"):result+"mesiacmi";case"y":return withoutSuffix||isFuture?"rok":"rokom";case"yy":return withoutSuffix||isFuture?result+(plural(number)?"roky":"rokov"):result+"rokmi"}}moment.defineLocale("sk",{months:months,monthsShort:monthsShort,weekdays:"nedea_pondelok_utorok_streda_tvrtok_piatok_sobota".split("_"),weekdaysShort:"ne_po_ut_st_t_pi_so".split("_"),weekdaysMin:"ne_po_ut_st_t_pi_so".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd D. MMMM YYYY H:mm"},calendar:{sameDay:"[dnes o] LT",nextDay:"[zajtra o] LT",nextWeek:function(){switch(this.day()){case 0:return"[v nedeu o] LT";case 1:case 2:return"[v] dddd [o] LT";case 3:return"[v stredu o] LT";case 4:return"[vo tvrtok o] LT";case 5:return"[v piatok o] LT";case 6:return"[v sobotu o] LT"}},lastDay:"[vera o] LT",lastWeek:function(){switch(this.day()){case 0:return"[minul nedeu o] LT";case 1:case 2:return"[minul] dddd [o] LT";case 3:return"[minul stredu o] LT";case 4:case 5:return"[minul] dddd [o] LT";case 6:return"[minul sobotu o] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"pred %s",s:translate,ss:translate,m:translate,mm:translate,h:translate,hh:translate,d:translate,dd:translate,M:translate,MM:translate,y:translate,yy:translate},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/sl.js":function(module,exports,__webpack_require__){!function(moment){"use strict";function processRelativeTime(number,withoutSuffix,key,isFuture){var result=number+" ";switch(key){case"s":return withoutSuffix||isFuture?"nekaj sekund":"nekaj sekundami";case"ss":return result+=1===number?withoutSuffix?"sekundo":"sekundi":2===number?withoutSuffix||isFuture?"sekundi":"sekundah":number<5?withoutSuffix||isFuture?"sekunde":"sekundah":"sekund";case"m":return withoutSuffix?"ena minuta":"eno minuto";case"mm":return result+=1===number?withoutSuffix?"minuta":"minuto":2===number?withoutSuffix||isFuture?"minuti":"minutama":number<5?withoutSuffix||isFuture?"minute":"minutami":withoutSuffix||isFuture?"minut":"minutami";case"h":return withoutSuffix?"ena ura":"eno uro";case"hh":return result+=1===number?withoutSuffix?"ura":"uro":2===number?withoutSuffix||isFuture?"uri":"urama":number<5?withoutSuffix||isFuture?"ure":"urami":withoutSuffix||isFuture?"ur":"urami";case"d":return withoutSuffix||isFuture?"en dan":"enim dnem";case"dd":return result+=1===number?withoutSuffix||isFuture?"dan":"dnem":2===number?withoutSuffix||isFuture?"dni":"dnevoma":withoutSuffix||isFuture?"dni":"dnevi";case"M":return withoutSuffix||isFuture?"en mesec":"enim mesecem";case"MM":return result+=1===number?withoutSuffix||isFuture?"mesec":"mesecem":2===number?withoutSuffix||isFuture?"meseca":"mesecema":number<5?withoutSuffix||isFuture?"mesece":"meseci":withoutSuffix||isFuture?"mesecev":"meseci";case"y":return withoutSuffix||isFuture?"eno leto":"enim letom";case"yy":return result+=1===number?withoutSuffix||isFuture?"leto":"letom":2===number?withoutSuffix||isFuture?"leti":"letoma":number<5?withoutSuffix||isFuture?"leta":"leti":withoutSuffix||isFuture?"let":"leti"}}moment.defineLocale("sl",{months:"januar_februar_marec_april_maj_junij_julij_avgust_september_oktober_november_december".split("_"),monthsShort:"jan._feb._mar._apr._maj._jun._jul._avg._sep._okt._nov._dec.".split("_"),monthsParseExact:!0,weekdays:"nedelja_ponedeljek_torek_sreda_etrtek_petek_sobota".split("_"),weekdaysShort:"ned._pon._tor._sre._et._pet._sob.".split("_"),weekdaysMin:"ne_po_to_sr_e_pe_so".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},calendar:{sameDay:"[danes ob] LT",nextDay:"[jutri ob] LT",nextWeek:function(){switch(this.day()){case 0:return"[v] [nedeljo] [ob] LT";case 3:return"[v] [sredo] [ob] LT";case 6:return"[v] [soboto] [ob] LT";case 1:case 2:case 4:case 5:return"[v] dddd [ob] LT"}},lastDay:"[veraj ob] LT",lastWeek:function(){switch(this.day()){case 0:return"[prejnjo] [nedeljo] [ob] LT";case 3:return"[prejnjo] [sredo] [ob] LT";case 6:return"[prejnjo] [soboto] [ob] LT";case 1:case 2:case 4:case 5:return"[prejnji] dddd [ob] LT"}},sameElse:"L"},relativeTime:{future:"ez %s",past:"pred %s",s:processRelativeTime,ss:processRelativeTime,m:processRelativeTime,mm:processRelativeTime,h:processRelativeTime,hh:processRelativeTime,d:processRelativeTime,dd:processRelativeTime,M:processRelativeTime,MM:processRelativeTime,y:processRelativeTime,yy:processRelativeTime},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/sq.js":function(module,exports,__webpack_require__){!function(moment){"use strict";moment.defineLocale("sq",{months:"Janar_Shkurt_Mars_Prill_Maj_Qershor_Korrik_Gusht_Shtator_Tetor_Nntor_Dhjetor".split("_"),monthsShort:"Jan_Shk_Mar_Pri_Maj_Qer_Kor_Gus_Sht_Tet_Nn_Dhj".split("_"),weekdays:"E Diel_E Hn_E Mart_E Mrkur_E Enjte_E Premte_E Shtun".split("_"),weekdaysShort:"Die_Hn_Mar_Mr_Enj_Pre_Sht".split("_"),weekdaysMin:"D_H_Ma_M_E_P_Sh".split("_"),weekdaysParseExact:!0,meridiemParse:/PD|MD/,isPM:function(input){return"M"===input.charAt(0)},meridiem:function(hours,minutes,isLower){return hours<12?"PD":"MD"},longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Sot n] LT",nextDay:"[Nesr n] LT",nextWeek:"dddd [n] LT",lastDay:"[Dje n] LT",lastWeek:"dddd [e kaluar n] LT",sameElse:"L"},relativeTime:{future:"n %s",past:"%s m par",s:"disa sekonda",ss:"%d sekonda",m:"nj minut",mm:"%d minuta",h:"nj or",hh:"%d or",d:"nj dit",dd:"%d dit",M:"nj muaj",MM:"%d muaj",y:"nj vit",yy:"%d vite"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/sr-cyrl.js":function(module,exports,__webpack_require__){!function(moment){"use strict";var translator={words:{ss:["","",""],m:[" "," "],mm:["","",""],h:[" "," "],hh:["","",""],dd:["","",""],MM:["","",""],yy:["","",""]},correctGrammaticalCase:function(number,wordKey){return 1===number?wordKey[0]:number>=2&&number<=4?wordKey[1]:wordKey[2]},translate:function(number,withoutSuffix,key){var wordKey=translator.words[key];return 1===key.length?withoutSuffix?wordKey[0]:wordKey[1]:number+" "+translator.correctGrammaticalCase(number,wordKey)}};moment.defineLocale("sr-cyrl",{months:"___________".split("_"),monthsShort:"._._._.____._._._._.".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"._._._._._._.".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:function(){switch(this.day()){case 0:return"[] [] [] LT";case 3:return"[] [] [] LT";case 6:return"[] [] [] LT";case 1:case 2:case 4:case 5:return"[] dddd [] LT"}},lastDay:"[ ] LT",lastWeek:function(){return["[] [] [] LT","[] [] [] LT","[] [] [] LT","[] [] [] LT","[] [] [] LT","[] [] [] LT","[] [] [] LT"][this.day()]},sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:" ",ss:translator.translate,m:translator.translate,mm:translator.translate,h:translator.translate,hh:translator.translate,d:"",dd:translator.translate,M:"",MM:translator.translate,y:"",yy:translator.translate},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/sr.js":function(module,exports,__webpack_require__){!function(moment){"use strict";var translator={words:{ss:["sekunda","sekunde","sekundi"],m:["jedan minut","jedne minute"],mm:["minut","minute","minuta"],h:["jedan sat","jednog sata"],hh:["sat","sata","sati"],dd:["dan","dana","dana"],MM:["mesec","meseca","meseci"],yy:["godina","godine","godina"]},correctGrammaticalCase:function(number,wordKey){return 1===number?wordKey[0]:number>=2&&number<=4?wordKey[1]:wordKey[2]},translate:function(number,withoutSuffix,key){var wordKey=translator.words[key];return 1===key.length?withoutSuffix?wordKey[0]:wordKey[1]:number+" "+translator.correctGrammaticalCase(number,wordKey)}};moment.defineLocale("sr",{months:"januar_februar_mart_april_maj_jun_jul_avgust_septembar_oktobar_novembar_decembar".split("_"),monthsShort:"jan._feb._mar._apr._maj_jun_jul_avg._sep._okt._nov._dec.".split("_"),monthsParseExact:!0,weekdays:"nedelja_ponedeljak_utorak_sreda_etvrtak_petak_subota".split("_"),weekdaysShort:"ned._pon._uto._sre._et._pet._sub.".split("_"),weekdaysMin:"ne_po_ut_sr_e_pe_su".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},calendar:{sameDay:"[danas u] LT",nextDay:"[sutra u] LT",nextWeek:function(){switch(this.day()){case 0:return"[u] [nedelju] [u] LT";case 3:return"[u] [sredu] [u] LT";case 6:return"[u] [subotu] [u] LT";case 1:case 2:case 4:case 5:return"[u] dddd [u] LT"}},lastDay:"[jue u] LT",lastWeek:function(){return["[prole] [nedelje] [u] LT","[prolog] [ponedeljka] [u] LT","[prolog] [utorka] [u] LT","[prole] [srede] [u] LT","[prolog] [etvrtka] [u] LT","[prolog] [petka] [u] LT","[prole] [subote] [u] LT"][this.day()]},sameElse:"L"},relativeTime:{future:"za %s",past:"pre %s",s:"nekoliko sekundi",ss:translator.translate,m:translator.translate,mm:translator.translate,h:translator.translate,hh:translator.translate,d:"dan",dd:translator.translate,M:"mesec",MM:translator.translate,y:"godinu",yy:translator.translate},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/ss.js":function(module,exports,__webpack_require__){!function(moment){"use strict";moment.defineLocale("ss",{months:"Bhimbidvwane_Indlovana_Indlov'lenkhulu_Mabasa_Inkhwekhweti_Inhlaba_Kholwane_Ingci_Inyoni_Imphala_Lweti_Ingongoni".split("_"),monthsShort:"Bhi_Ina_Inu_Mab_Ink_Inh_Kho_Igc_Iny_Imp_Lwe_Igo".split("_"),weekdays:"Lisontfo_Umsombuluko_Lesibili_Lesitsatfu_Lesine_Lesihlanu_Umgcibelo".split("_"),weekdaysShort:"Lis_Umb_Lsb_Les_Lsi_Lsh_Umg".split("_"),weekdaysMin:"Li_Us_Lb_Lt_Ls_Lh_Ug".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY h:mm A",LLLL:"dddd, D MMMM YYYY h:mm A"},calendar:{sameDay:"[Namuhla nga] LT",nextDay:"[Kusasa nga] LT",nextWeek:"dddd [nga] LT",lastDay:"[Itolo nga] LT",lastWeek:"dddd [leliphelile] [nga] LT",sameElse:"L"},relativeTime:{future:"nga %s",past:"wenteka nga %s",s:"emizuzwana lomcane",ss:"%d mzuzwana",m:"umzuzu",mm:"%d emizuzu",h:"lihora",hh:"%d emahora",d:"lilanga",dd:"%d emalanga",M:"inyanga",MM:"%d tinyanga",y:"umnyaka",yy:"%d iminyaka"},meridiemParse:/ekuseni|emini|entsambama|ebusuku/,meridiem:function(hours,minutes,isLower){return hours<11?"ekuseni":hours<15?"emini":hours<19?"entsambama":"ebusuku"},meridiemHour:function(hour,meridiem){return 12===hour&&(hour=0),"ekuseni"===meridiem?hour:"emini"===meridiem?hour>=11?hour:hour+12:"entsambama"===meridiem||"ebusuku"===meridiem?0===hour?0:hour+12:void 0},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/sv.js":function(module,exports,__webpack_require__){!function(moment){"use strict";moment.defineLocale("sv",{months:"januari_februari_mars_april_maj_juni_juli_augusti_september_oktober_november_december".split("_"),monthsShort:"jan_feb_mar_apr_maj_jun_jul_aug_sep_okt_nov_dec".split("_"),weekdays:"sndag_mndag_tisdag_onsdag_torsdag_fredag_lrdag".split("_"),weekdaysShort:"sn_mn_tis_ons_tor_fre_lr".split("_"),weekdaysMin:"s_m_ti_on_to_fr_l".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [kl.] HH:mm",LLLL:"dddd D MMMM YYYY [kl.] HH:mm",lll:"D MMM YYYY HH:mm",llll:"ddd D MMM YYYY HH:mm"},calendar:{sameDay:"[Idag] LT",nextDay:"[Imorgon] LT",lastDay:"[Igr] LT",nextWeek:"[P] dddd LT",lastWeek:"[I] dddd[s] LT",sameElse:"L"},relativeTime:{future:"om %s",past:"fr %s sedan",s:"ngra sekunder",ss:"%d sekunder",m:"en minut",mm:"%d minuter",h:"en timme",hh:"%d timmar",d:"en dag",dd:"%d dagar",M:"en mnad",MM:"%d mnader",y:"ett r",yy:"%d r"},dayOfMonthOrdinalParse:/\d{1,2}(e|a)/,ordinal:function(number){var b=number%10,output=1==~~(number%100/10)?"e":1===b?"a":2===b?"a":"e";return number+output},week:{dow:1,doy:4}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/sw.js":function(module,exports,__webpack_require__){!function(moment){"use strict";moment.defineLocale("sw",{months:"Januari_Februari_Machi_Aprili_Mei_Juni_Julai_Agosti_Septemba_Oktoba_Novemba_Desemba".split("_"),monthsShort:"Jan_Feb_Mac_Apr_Mei_Jun_Jul_Ago_Sep_Okt_Nov_Des".split("_"),weekdays:"Jumapili_Jumatatu_Jumanne_Jumatano_Alhamisi_Ijumaa_Jumamosi".split("_"),weekdaysShort:"Jpl_Jtat_Jnne_Jtan_Alh_Ijm_Jmos".split("_"),weekdaysMin:"J2_J3_J4_J5_Al_Ij_J1".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[leo saa] LT",nextDay:"[kesho saa] LT",nextWeek:"[wiki ijayo] dddd [saat] LT",lastDay:"[jana] LT",lastWeek:"[wiki iliyopita] dddd [saat] LT",sameElse:"L"},relativeTime:{future:"%s baadaye",past:"tokea %s",s:"hivi punde",ss:"sekunde %d",m:"dakika moja",mm:"dakika %d",h:"saa limoja",hh:"masaa %d",d:"siku moja",dd:"masiku %d",M:"mwezi mmoja",MM:"miezi %d",y:"mwaka mmoja",yy:"miaka %d"},week:{dow:1,doy:7}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/ta.js":function(module,exports,__webpack_require__){!function(moment){"use strict";var symbolMap={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},numberMap={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};moment.defineLocale("ta",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, HH:mm",LLLL:"dddd, D MMMM YYYY, HH:mm"},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[ ] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:"  ",ss:"%d ",m:" ",mm:"%d ",h:"  ",hh:"%d  ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:function(number){return number+""},preparse:function(string){return string.replace(/[]/g,function(match){return numberMap[match]})},postformat:function(string){return string.replace(/\d/g,function(match){return symbolMap[match]})},meridiemParse:/|||||/,meridiem:function(hour,minute,isLower){return hour<2?" ":hour<6?" ":hour<10?" ":hour<14?" ":hour<18?" ":hour<22?" ":" "},meridiemHour:function(hour,meridiem){return 12===hour&&(hour=0),""===meridiem?hour<2?hour:hour+12:""===meridiem||""===meridiem?hour:""===meridiem&&hour>=10?hour:hour+12},week:{dow:0,doy:6}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/te.js":function(module,exports,__webpack_require__){!function(moment){"use strict";moment.defineLocale("te",{months:"___________".split("_"),monthsShort:"._.__.____._._._._.".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm",LTS:"A h:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm",LLLL:"dddd, D MMMM YYYY, A h:mm"},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",meridiemParse:/|||/,meridiemHour:function(hour,meridiem){return 12===hour&&(hour=0),""===meridiem?hour<4?hour:hour+12:""===meridiem?hour:""===meridiem?hour>=10?hour:hour+12:""===meridiem?hour+12:void 0},meridiem:function(hour,minute,isLower){return hour<4?"":hour<10?"":hour<17?"":hour<20?"":""},week:{dow:0,doy:6}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/tet.js":function(module,exports,__webpack_require__){!function(moment){"use strict";moment.defineLocale("tet",{months:"Janeiru_Fevereiru_Marsu_Abril_Maiu_Juu_Jullu_Agustu_Setembru_Outubru_Novembru_Dezembru".split("_"),monthsShort:"Jan_Fev_Mar_Abr_Mai_Jun_Jul_Ago_Set_Out_Nov_Dez".split("_"),weekdays:"Domingu_Segunda_Tersa_Kuarta_Kinta_Sesta_Sabadu".split("_"),weekdaysShort:"Dom_Seg_Ters_Kua_Kint_Sest_Sab".split("_"),weekdaysMin:"Do_Seg_Te_Ku_Ki_Ses_Sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Ohin iha] LT",nextDay:"[Aban iha] LT",nextWeek:"dddd [iha] LT",lastDay:"[Horiseik iha] LT",lastWeek:"dddd [semana kotuk] [iha] LT",sameElse:"L"},relativeTime:{future:"iha %s",past:"%s liuba",s:"minutu balun",ss:"minutu %d",m:"minutu ida",mm:"minutu %d",h:"oras ida",hh:"oras %d",d:"loron ida",dd:"loron %d",M:"fulan ida",MM:"fulan %d",y:"tinan ida",yy:"tinan %d"},dayOfMonthOrdinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(number){var b=number%10,output=1==~~(number%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th";return number+output},week:{dow:1,doy:4}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/tg.js":function(module,exports,__webpack_require__){!function(moment){"use strict";var suffixes={0:"-",1:"-",2:"-",3:"-",4:"-",5:"-",6:"-",7:"-",8:"-",9:"-",10:"-",12:"-",13:"-",20:"-",30:"-",40:"-",50:"-",60:"-",70:"-",80:"-",90:"-",100:"-"};moment.defineLocale("tg",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",lastDay:"[ ] LT",nextWeek:"dddd[] [  ] LT",lastWeek:"dddd[] [  ] LT",sameElse:"L"},relativeTime:{future:" %s",past:"%s ",s:" ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},meridiemParse:/|||/,meridiemHour:function(hour,meridiem){return 12===hour&&(hour=0),""===meridiem?hour<4?hour:hour+12:""===meridiem?hour:""===meridiem?hour>=11?hour:hour+12:""===meridiem?hour+12:void 0},meridiem:function(hour,minute,isLower){return hour<4?"":hour<11?"":hour<16?"":hour<19?"":""},dayOfMonthOrdinalParse:/\d{1,2}-(|)/,ordinal:function(number){var a=number%10,b=number>=100?100:null;return number+(suffixes[number]||suffixes[a]||suffixes[b])},week:{dow:1,doy:7}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/th.js":function(module,exports,__webpack_require__){!function(moment){"use strict";moment.defineLocale("th",{months:"___________".split("_"),monthsShort:".._.._.._.._.._.._.._.._.._.._.._..".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"._._._._._._.".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY  H:mm",LLLL:"dddd D MMMM YYYY  H:mm"},meridiemParse:/|/,isPM:function(input){return""===input},meridiem:function(hour,minute,isLower){return hour<12?"":""},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd[ ] LT",lastDay:"[ ] LT",lastWeek:"[]dddd[ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:"%s",s:"",ss:"%d ",m:"1 ",mm:"%d ",h:"1 ",hh:"%d ",d:"1 ",dd:"%d ",M:"1 ",MM:"%d ",y:"1 ",yy:"%d "}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/tl-ph.js":function(module,exports,__webpack_require__){!function(moment){"use strict";moment.defineLocale("tl-ph",{months:"Enero_Pebrero_Marso_Abril_Mayo_Hunyo_Hulyo_Agosto_Setyembre_Oktubre_Nobyembre_Disyembre".split("_"),monthsShort:"Ene_Peb_Mar_Abr_May_Hun_Hul_Ago_Set_Okt_Nob_Dis".split("_"),weekdays:"Linggo_Lunes_Martes_Miyerkules_Huwebes_Biyernes_Sabado".split("_"),weekdaysShort:"Lin_Lun_Mar_Miy_Huw_Biy_Sab".split("_"),weekdaysMin:"Li_Lu_Ma_Mi_Hu_Bi_Sab".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"MM/D/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY HH:mm",LLLL:"dddd, MMMM DD, YYYY HH:mm"},calendar:{sameDay:"LT [ngayong araw]",nextDay:"[Bukas ng] LT",nextWeek:"LT [sa susunod na] dddd",lastDay:"LT [kahapon]",lastWeek:"LT [noong nakaraang] dddd",sameElse:"L"},relativeTime:{future:"sa loob ng %s",past:"%s ang nakalipas",s:"ilang segundo",ss:"%d segundo",m:"isang minuto",mm:"%d minuto",h:"isang oras",hh:"%d oras",d:"isang araw",dd:"%d araw",M:"isang buwan",MM:"%d buwan",y:"isang taon",yy:"%d taon"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:function(number){return number},week:{dow:1,doy:4}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/tlh.js":function(module,exports,__webpack_require__){!function(moment){"use strict";var numbersNouns="pagh_wa_cha_wej_loS_vagh_jav_Soch_chorgh_Hut".split("_");function translate(number,withoutSuffix,string,isFuture){var numberNoun=function(number){var hundred=Math.floor(number%1e3/100),ten=Math.floor(number%100/10),one=number%10,word="";return hundred>0&&(word+=numbersNouns[hundred]+"vatlh"),ten>0&&(word+=(""!==word?" ":"")+numbersNouns[ten]+"maH"),one>0&&(word+=(""!==word?" ":"")+numbersNouns[one]),""===word?"pagh":word}(number);switch(string){case"ss":return numberNoun+" lup";case"mm":return numberNoun+" tup";case"hh":return numberNoun+" rep";case"dd":return numberNoun+" jaj";case"MM":return numberNoun+" jar";case"yy":return numberNoun+" DIS"}}moment.defineLocale("tlh",{months:"tera jar wa_tera jar cha_tera jar wej_tera jar loS_tera jar vagh_tera jar jav_tera jar Soch_tera jar chorgh_tera jar Hut_tera jar wamaH_tera jar wamaH wa_tera jar wamaH cha".split("_"),monthsShort:"jar wa_jar cha_jar wej_jar loS_jar vagh_jar jav_jar Soch_jar chorgh_jar Hut_jar wamaH_jar wamaH wa_jar wamaH cha".split("_"),monthsParseExact:!0,weekdays:"lojmItjaj_DaSjaj_povjaj_ghItlhjaj_loghjaj_buqjaj_ghInjaj".split("_"),weekdaysShort:"lojmItjaj_DaSjaj_povjaj_ghItlhjaj_loghjaj_buqjaj_ghInjaj".split("_"),weekdaysMin:"lojmItjaj_DaSjaj_povjaj_ghItlhjaj_loghjaj_buqjaj_ghInjaj".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[DaHjaj] LT",nextDay:"[waleS] LT",nextWeek:"LLL",lastDay:"[waHu] LT",lastWeek:"LLL",sameElse:"L"},relativeTime:{future:function(output){var time=output;return time=-1!==output.indexOf("jaj")?time.slice(0,-3)+"leS":-1!==output.indexOf("jar")?time.slice(0,-3)+"waQ":-1!==output.indexOf("DIS")?time.slice(0,-3)+"nem":time+" pIq"},past:function(output){var time=output;return time=-1!==output.indexOf("jaj")?time.slice(0,-3)+"Hu":-1!==output.indexOf("jar")?time.slice(0,-3)+"wen":-1!==output.indexOf("DIS")?time.slice(0,-3)+"ben":time+" ret"},s:"puS lup",ss:translate,m:"wa tup",mm:translate,h:"wa rep",hh:translate,d:"wa jaj",dd:translate,M:"wa jar",MM:translate,y:"wa DIS",yy:translate},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/tr.js":function(module,exports,__webpack_require__){!function(moment){"use strict";var suffixes={1:"'inci",5:"'inci",8:"'inci",70:"'inci",80:"'inci",2:"'nci",7:"'nci",20:"'nci",50:"'nci",3:"'nc",4:"'nc",100:"'nc",6:"'nc",9:"'uncu",10:"'uncu",30:"'uncu",60:"'nc",90:"'nc"};moment.defineLocale("tr",{months:"Ocak_ubat_Mart_Nisan_Mays_Haziran_Temmuz_Austos_Eyll_Ekim_Kasm_Aralk".split("_"),monthsShort:"Oca_ub_Mar_Nis_May_Haz_Tem_Au_Eyl_Eki_Kas_Ara".split("_"),weekdays:"Pazar_Pazartesi_Sal_aramba_Perembe_Cuma_Cumartesi".split("_"),weekdaysShort:"Paz_Pts_Sal_ar_Per_Cum_Cts".split("_"),weekdaysMin:"Pz_Pt_Sa_a_Pe_Cu_Ct".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[bugn saat] LT",nextDay:"[yarn saat] LT",nextWeek:"[gelecek] dddd [saat] LT",lastDay:"[dn] LT",lastWeek:"[geen] dddd [saat] LT",sameElse:"L"},relativeTime:{future:"%s sonra",past:"%s nce",s:"birka saniye",ss:"%d saniye",m:"bir dakika",mm:"%d dakika",h:"bir saat",hh:"%d saat",d:"bir gn",dd:"%d gn",M:"bir ay",MM:"%d ay",y:"bir yl",yy:"%d yl"},ordinal:function(number,period){switch(period){case"d":case"D":case"Do":case"DD":return number;default:if(0===number)return number+"'nc";var a=number%10,b=number%100-a,c=number>=100?100:null;return number+(suffixes[a]||suffixes[b]||suffixes[c])}},week:{dow:1,doy:7}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/tzl.js":function(module,exports,__webpack_require__){!function(moment){"use strict";function processRelativeTime(number,withoutSuffix,key,isFuture){var format={s:["viensas secunds","'iensas secunds"],ss:[number+" secunds",number+" secunds"],m:["'n mut","'iens mut"],mm:[number+" muts",number+" muts"],h:["'n ora","'iensa ora"],hh:[number+" oras",number+" oras"],d:["'n ziua","'iensa ziua"],dd:[number+" ziuas",number+" ziuas"],M:["'n mes","'iens mes"],MM:[number+" mesen",number+" mesen"],y:["'n ar","'iens ar"],yy:[number+" ars",number+" ars"]};return isFuture?format[key][0]:withoutSuffix?format[key][0]:format[key][1]}moment.defineLocale("tzl",{months:"Januar_Fevraglh_Mar_Avru_Mai_Gn_Julia_Guscht_Setemvar_Listopts_Noemvar_Zecemvar".split("_"),monthsShort:"Jan_Fev_Mar_Avr_Mai_Gn_Jul_Gus_Set_Lis_Noe_Zec".split("_"),weekdays:"Sladi_Lnei_Maitzi_Mrcuri_Xhadi_Vineri_Sturi".split("_"),weekdaysShort:"Sl_Ln_Mai_Mr_Xh_Vi_St".split("_"),weekdaysMin:"S_L_Ma_M_Xh_Vi_S".split("_"),longDateFormat:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD.MM.YYYY",LL:"D. MMMM [dallas] YYYY",LLL:"D. MMMM [dallas] YYYY HH.mm",LLLL:"dddd, [li] D. MMMM [dallas] YYYY HH.mm"},meridiemParse:/d\'o|d\'a/i,isPM:function(input){return"d'o"===input.toLowerCase()},meridiem:function(hours,minutes,isLower){return hours>11?isLower?"d'o":"D'O":isLower?"d'a":"D'A"},calendar:{sameDay:"[oxhi ] LT",nextDay:"[dem ] LT",nextWeek:"dddd [] LT",lastDay:"[ieiri ] LT",lastWeek:"[sr el] dddd [lasteu ] LT",sameElse:"L"},relativeTime:{future:"osprei %s",past:"ja%s",s:processRelativeTime,ss:processRelativeTime,m:processRelativeTime,mm:processRelativeTime,h:processRelativeTime,hh:processRelativeTime,d:processRelativeTime,dd:processRelativeTime,M:processRelativeTime,MM:processRelativeTime,y:processRelativeTime,yy:processRelativeTime},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/tzm-latn.js":function(module,exports,__webpack_require__){!function(moment){"use strict";moment.defineLocale("tzm-latn",{months:"innayr_brayr_mars_ibrir_mayyw_ywnyw_ywlywz_wt_wtanbir_ktwbr_nwwanbir_dwjnbir".split("_"),monthsShort:"innayr_brayr_mars_ibrir_mayyw_ywnyw_ywlywz_wt_wtanbir_ktwbr_nwwanbir_dwjnbir".split("_"),weekdays:"asamas_aynas_asinas_akras_akwas_asimwas_asiyas".split("_"),weekdaysShort:"asamas_aynas_asinas_akras_akwas_asimwas_asiyas".split("_"),weekdaysMin:"asamas_aynas_asinas_akras_akwas_asimwas_asiyas".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[asdkh g] LT",nextDay:"[aska g] LT",nextWeek:"dddd [g] LT",lastDay:"[assant g] LT",lastWeek:"dddd [g] LT",sameElse:"L"},relativeTime:{future:"dadkh s yan %s",past:"yan %s",s:"imik",ss:"%d imik",m:"minu",mm:"%d minu",h:"saa",hh:"%d tassain",d:"ass",dd:"%d ossan",M:"ayowr",MM:"%d iyyirn",y:"asgas",yy:"%d isgasn"},week:{dow:6,doy:12}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/tzm.js":function(module,exports,__webpack_require__){!function(moment){"use strict";moment.defineLocale("tzm",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[ ] LT",lastWeek:"dddd [] LT",sameElse:"L"},relativeTime:{future:"   %s",past:" %s",s:"",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d o",M:"o",MM:"%d ",y:"",yy:"%d "},week:{dow:6,doy:12}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/ug-cn.js":function(module,exports,__webpack_require__){!function(moment){"use strict";moment.defineLocale("ug-cn",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"YYYY-M-D-",LLL:"YYYY-M-D- HH:mm",LLLL:"dddd YYYY-M-D- HH:mm"},meridiemParse:/ || || |/,meridiemHour:function(hour,meridiem){return 12===hour&&(hour=0)," "===meridiem||""===meridiem||" "===meridiem?hour:" "===meridiem||""===meridiem?hour+12:hour>=11?hour:hour+12},meridiem:function(hour,minute,isLower){var hm=100*hour+minute;return hm<600?" ":hm<900?"":hm<1130?" ":hm<1230?"":hm<1800?" ":""},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"[] dddd [] LT",lastDay:"[] LT",lastWeek:"[] dddd [] LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}(-|-|-)/,ordinal:function(number,period){switch(period){case"d":case"D":case"DDD":return number+"-";case"w":case"W":return number+"-";default:return number}},preparse:function(string){return string.replace(//g,",")},postformat:function(string){return string.replace(/,/g,"")},week:{dow:1,doy:7}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/uk.js":function(module,exports,__webpack_require__){!function(moment){"use strict";function relativeTimeWithPlural(number,withoutSuffix,key){var num,forms,format={ss:withoutSuffix?"__":"__",mm:withoutSuffix?"__":"__",hh:withoutSuffix?"__":"__",dd:"__",MM:"__",yy:"__"};return"m"===key?withoutSuffix?"":"":"h"===key?withoutSuffix?"":"":number+" "+(num=+number,forms=format[key].split("_"),num%10==1&&num%100!=11?forms[0]:num%10>=2&&num%10<=4&&(num%100<10||num%100>=20)?forms[1]:forms[2])}function processHoursFunction(str){return function(){return str+""+(11===this.hours()?"":"")+"] LT"}}moment.defineLocale("uk",{months:{format:"___________".split("_"),standalone:"___________".split("_")},monthsShort:"___________".split("_"),weekdays:function(m,format){var weekdays={nominative:"______".split("_"),accusative:"______".split("_"),genitive:"______".split("_")};if(!m)return weekdays.nominative;var nounCase=/(\[[]\]) ?dddd/.test(format)?"accusative":/\[?(?:|)? ?\] ?dddd/.test(format)?"genitive":"nominative";return weekdays[nounCase][m.day()]},weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY .",LLL:"D MMMM YYYY ., HH:mm",LLLL:"dddd, D MMMM YYYY ., HH:mm"},calendar:{sameDay:processHoursFunction("[ "),nextDay:processHoursFunction("[ "),lastDay:processHoursFunction("[ "),nextWeek:processHoursFunction("[] dddd ["),lastWeek:function(){switch(this.day()){case 0:case 3:case 5:case 6:return processHoursFunction("[] dddd [").call(this);case 1:case 2:case 4:return processHoursFunction("[] dddd [").call(this)}},sameElse:"L"},relativeTime:{future:" %s",past:"%s ",s:" ",ss:relativeTimeWithPlural,m:relativeTimeWithPlural,mm:relativeTimeWithPlural,h:"",hh:relativeTimeWithPlural,d:"",dd:relativeTimeWithPlural,M:"",MM:relativeTimeWithPlural,y:"",yy:relativeTimeWithPlural},meridiemParse:/|||/,isPM:function(input){return/^(|)$/.test(input)},meridiem:function(hour,minute,isLower){return hour<4?"":hour<12?"":hour<17?"":""},dayOfMonthOrdinalParse:/\d{1,2}-(|)/,ordinal:function(number,period){switch(period){case"M":case"d":case"DDD":case"w":case"W":return number+"-";case"D":return number+"-";default:return number}},week:{dow:1,doy:7}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/ur.js":function(module,exports,__webpack_require__){!function(moment){"use strict";var months=["","","","","","","","","","","",""],days=["","","","","","",""];moment.defineLocale("ur",{months:months,monthsShort:months,weekdays:days,weekdaysShort:days,weekdaysMin:days,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},meridiemParse:/|/,isPM:function(input){return""===input},meridiem:function(hour,minute,isLower){return hour<12?"":""},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[  ] LT",lastWeek:"[] dddd [] LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(string){return string.replace(//g,",")},postformat:function(string){return string.replace(/,/g,"")},week:{dow:1,doy:4}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/uz-latn.js":function(module,exports,__webpack_require__){!function(moment){"use strict";moment.defineLocale("uz-latn",{months:"Yanvar_Fevral_Mart_Aprel_May_Iyun_Iyul_Avgust_Sentabr_Oktabr_Noyabr_Dekabr".split("_"),monthsShort:"Yan_Fev_Mar_Apr_May_Iyun_Iyul_Avg_Sen_Okt_Noy_Dek".split("_"),weekdays:"Yakshanba_Dushanba_Seshanba_Chorshanba_Payshanba_Juma_Shanba".split("_"),weekdaysShort:"Yak_Dush_Sesh_Chor_Pay_Jum_Shan".split("_"),weekdaysMin:"Ya_Du_Se_Cho_Pa_Ju_Sha".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"D MMMM YYYY, dddd HH:mm"},calendar:{sameDay:"[Bugun soat] LT [da]",nextDay:"[Ertaga] LT [da]",nextWeek:"dddd [kuni soat] LT [da]",lastDay:"[Kecha soat] LT [da]",lastWeek:"[O'tgan] dddd [kuni soat] LT [da]",sameElse:"L"},relativeTime:{future:"Yaqin %s ichida",past:"Bir necha %s oldin",s:"soniya",ss:"%d soniya",m:"bir daqiqa",mm:"%d daqiqa",h:"bir soat",hh:"%d soat",d:"bir kun",dd:"%d kun",M:"bir oy",MM:"%d oy",y:"bir yil",yy:"%d yil"},week:{dow:1,doy:7}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/uz.js":function(module,exports,__webpack_require__){!function(moment){"use strict";moment.defineLocale("uz",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"D MMMM YYYY, dddd HH:mm"},calendar:{sameDay:"[ ] LT []",nextDay:"[] LT []",nextWeek:"dddd [ ] LT []",lastDay:"[ ] LT []",lastWeek:"[] dddd [ ] LT []",sameElse:"L"},relativeTime:{future:" %s ",past:"  %s ",s:"",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},week:{dow:1,doy:7}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/vi.js":function(module,exports,__webpack_require__){!function(moment){"use strict";moment.defineLocale("vi",{months:"thng 1_thng 2_thng 3_thng 4_thng 5_thng 6_thng 7_thng 8_thng 9_thng 10_thng 11_thng 12".split("_"),monthsShort:"Th01_Th02_Th03_Th04_Th05_Th06_Th07_Th08_Th09_Th10_Th11_Th12".split("_"),monthsParseExact:!0,weekdays:"ch nht_th hai_th ba_th t_th nm_th su_th by".split("_"),weekdaysShort:"CN_T2_T3_T4_T5_T6_T7".split("_"),weekdaysMin:"CN_T2_T3_T4_T5_T6_T7".split("_"),weekdaysParseExact:!0,meridiemParse:/sa|ch/i,isPM:function(input){return/^ch$/i.test(input)},meridiem:function(hours,minutes,isLower){return hours<12?isLower?"sa":"SA":isLower?"ch":"CH"},longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM [nm] YYYY",LLL:"D MMMM [nm] YYYY HH:mm",LLLL:"dddd, D MMMM [nm] YYYY HH:mm",l:"DD/M/YYYY",ll:"D MMM YYYY",lll:"D MMM YYYY HH:mm",llll:"ddd, D MMM YYYY HH:mm"},calendar:{sameDay:"[Hm nay lc] LT",nextDay:"[Ngy mai lc] LT",nextWeek:"dddd [tun ti lc] LT",lastDay:"[Hm qua lc] LT",lastWeek:"dddd [tun ri lc] LT",sameElse:"L"},relativeTime:{future:"%s ti",past:"%s trc",s:"vi giy",ss:"%d giy",m:"mt pht",mm:"%d pht",h:"mt gi",hh:"%d gi",d:"mt ngy",dd:"%d ngy",M:"mt thng",MM:"%d thng",y:"mt nm",yy:"%d nm"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:function(number){return number},week:{dow:1,doy:4}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/x-pseudo.js":function(module,exports,__webpack_require__){!function(moment){"use strict";moment.defineLocale("x-pseudo",{months:"J~~r_F~br~r_~Mrc~h_p~rl_~M_~J~_Jl~_~gst~_Sp~tmb~r_~ctb~r_~vm~br_~Dc~mbr".split("_"),monthsShort:"J~_~Fb_~Mr_~pr_~M_~J_~Jl_~g_~Sp_~ct_~v_~Dc".split("_"),monthsParseExact:!0,weekdays:"S~d~_M~d~_T~sd~_Wd~sd~_T~hrs~d_~Frd~_S~tr~d".split("_"),weekdaysShort:"S~_~M_~T_~Wd_~Th_~Fr_~St".split("_"),weekdaysMin:"S~_M~_T_~W_T~h_Fr~_S".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[T~d~ t] LT",nextDay:"[T~m~rr~w t] LT",nextWeek:"dddd [t] LT",lastDay:"[~st~rd~ t] LT",lastWeek:"[L~st] dddd [t] LT",sameElse:"L"},relativeTime:{future:"~ %s",past:"%s ~g",s:" ~fw ~sc~ds",ss:"%d s~c~ds",m:" ~m~t",mm:"%d m~~ts",h:"~ h~r",hh:"%d h~rs",d:" ~d",dd:"%d d~s",M:" ~m~th",MM:"%d m~t~hs",y:" ~r",yy:"%d ~rs"},dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(number){var b=number%10,output=1==~~(number%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th";return number+output},week:{dow:1,doy:4}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/yo.js":function(module,exports,__webpack_require__){!function(moment){"use strict";moment.defineLocale("yo",{months:"Sr_Erele_rna_Igbe_Ebibi_Okudu_Agmo_Ogun_Owewe_wara_Belu_p".split("_"),monthsShort:"Sr_Erl_rn_Igb_Ebi_Oku_Ag_Ogu_Owe_wa_Bel_p".split("_"),weekdays:"Aiku_Aje_Isgun_jru_jb_ti_Abamta".split("_"),weekdaysShort:"Aik_Aje_Is_jr_jb_ti_Aba".split("_"),weekdaysMin:"Ai_Aj_Is_r_b_t_Ab".split("_"),longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY h:mm A",LLLL:"dddd, D MMMM YYYY h:mm A"},calendar:{sameDay:"[Oni ni] LT",nextDay:"[la ni] LT",nextWeek:"dddd [s ton'b] [ni] LT",lastDay:"[Ana ni] LT",lastWeek:"dddd [s tol] [ni] LT",sameElse:"L"},relativeTime:{future:"ni %s",past:"%s kja",s:"isju aaya die",ss:"aaya %d",m:"isju kan",mm:"isju %d",h:"wakati kan",hh:"wakati %d",d:"j kan",dd:"j %d",M:"osu kan",MM:"osu %d",y:"dun kan",yy:"dun %d"},dayOfMonthOrdinalParse:/j\s\d{1,2}/,ordinal:"j %d",week:{dow:1,doy:4}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/zh-cn.js":function(module,exports,__webpack_require__){!function(moment){"use strict";moment.defineLocale("zh-cn",{months:"___________".split("_"),monthsShort:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYYMD",LLL:"YYYYMDAhmm",LLLL:"YYYYMDddddAhmm",l:"YYYY/M/D",ll:"YYYYMD",lll:"YYYYMD HH:mm",llll:"YYYYMDdddd HH:mm"},meridiemParse:/|||||/,meridiemHour:function(hour,meridiem){return 12===hour&&(hour=0),""===meridiem||""===meridiem||""===meridiem?hour:""===meridiem||""===meridiem?hour+12:hour>=11?hour:hour+12},meridiem:function(hour,minute,isLower){var hm=100*hour+minute;return hm<600?"":hm<900?"":hm<1130?"":hm<1230?"":hm<1800?"":""},calendar:{sameDay:"[]LT",nextDay:"[]LT",nextWeek:"[]ddddLT",lastDay:"[]LT",lastWeek:"[]ddddLT",sameElse:"L"},dayOfMonthOrdinalParse:/\d{1,2}(||)/,ordinal:function(number,period){switch(period){case"d":case"D":case"DDD":return number+"";case"M":return number+"";case"w":case"W":return number+"";default:return number}},relativeTime:{future:"%s",past:"%s",s:"",ss:"%d ",m:"1 ",mm:"%d ",h:"1 ",hh:"%d ",d:"1 ",dd:"%d ",M:"1 ",MM:"%d ",y:"1 ",yy:"%d "},week:{dow:1,doy:4}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/zh-hk.js":function(module,exports,__webpack_require__){!function(moment){"use strict";moment.defineLocale("zh-hk",{months:"___________".split("_"),monthsShort:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYYMD",LLL:"YYYYMD HH:mm",LLLL:"YYYYMDdddd HH:mm",l:"YYYY/M/D",ll:"YYYYMD",lll:"YYYYMD HH:mm",llll:"YYYYMDdddd HH:mm"},meridiemParse:/|||||/,meridiemHour:function(hour,meridiem){return 12===hour&&(hour=0),""===meridiem||""===meridiem||""===meridiem?hour:""===meridiem?hour>=11?hour:hour+12:""===meridiem||""===meridiem?hour+12:void 0},meridiem:function(hour,minute,isLower){var hm=100*hour+minute;return hm<600?"":hm<900?"":hm<1130?"":hm<1230?"":hm<1800?"":""},calendar:{sameDay:"[]LT",nextDay:"[]LT",nextWeek:"[]ddddLT",lastDay:"[]LT",lastWeek:"[]ddddLT",sameElse:"L"},dayOfMonthOrdinalParse:/\d{1,2}(||)/,ordinal:function(number,period){switch(period){case"d":case"D":case"DDD":return number+"";case"M":return number+"";case"w":case"W":return number+"";default:return number}},relativeTime:{future:"%s",past:"%s",s:"",ss:"%d ",m:"1 ",mm:"%d ",h:"1 ",hh:"%d ",d:"1 ",dd:"%d ",M:"1 ",MM:"%d ",y:"1 ",yy:"%d "}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/locale/zh-tw.js":function(module,exports,__webpack_require__){!function(moment){"use strict";moment.defineLocale("zh-tw",{months:"___________".split("_"),monthsShort:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYYMD",LLL:"YYYYMD HH:mm",LLLL:"YYYYMDdddd HH:mm",l:"YYYY/M/D",ll:"YYYYMD",lll:"YYYYMD HH:mm",llll:"YYYYMDdddd HH:mm"},meridiemParse:/|||||/,meridiemHour:function(hour,meridiem){return 12===hour&&(hour=0),""===meridiem||""===meridiem||""===meridiem?hour:""===meridiem?hour>=11?hour:hour+12:""===meridiem||""===meridiem?hour+12:void 0},meridiem:function(hour,minute,isLower){var hm=100*hour+minute;return hm<600?"":hm<900?"":hm<1130?"":hm<1230?"":hm<1800?"":""},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"[]dddd LT",lastDay:"[] LT",lastWeek:"[]dddd LT",sameElse:"L"},dayOfMonthOrdinalParse:/\d{1,2}(||)/,ordinal:function(number,period){switch(period){case"d":case"D":case"DDD":return number+"";case"M":return number+"";case"w":case"W":return number+"";default:return number}},relativeTime:{future:"%s",past:"%s",s:"",ss:"%d ",m:"1 ",mm:"%d ",h:"1 ",hh:"%d ",d:"1 ",dd:"%d ",M:"1 ",MM:"%d ",y:"1 ",yy:"%d "}})}(__webpack_require__("./node_modules/moment/moment.js"))},"./node_modules/moment/moment.js":function(module,exports,__webpack_require__){(function(module){module.exports=function(){"use strict";var hookCallback,some;function hooks(){return hookCallback.apply(null,arguments)}function isArray(input){return input instanceof Array||"[object Array]"===Object.prototype.toString.call(input)}function isObject(input){return null!=input&&"[object Object]"===Object.prototype.toString.call(input)}function isUndefined(input){return void 0===input}function isNumber(input){return"number"==typeof input||"[object Number]"===Object.prototype.toString.call(input)}function isDate(input){return input instanceof Date||"[object Date]"===Object.prototype.toString.call(input)}function map(arr,fn){var i,res=[];for(i=0;i<arr.length;++i)res.push(fn(arr[i],i));return res}function hasOwnProp(a,b){return Object.prototype.hasOwnProperty.call(a,b)}function extend(a,b){for(var i in b)hasOwnProp(b,i)&&(a[i]=b[i]);return hasOwnProp(b,"toString")&&(a.toString=b.toString),hasOwnProp(b,"valueOf")&&(a.valueOf=b.valueOf),a}function createUTC(input,format,locale,strict){return createLocalOrUTC(input,format,locale,strict,!0).utc()}function getParsingFlags(m){return null==m._pf&&(m._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null,rfc2822:!1,weekdayMismatch:!1}),m._pf}function isValid(m){if(null==m._isValid){var flags=getParsingFlags(m),parsedParts=some.call(flags.parsedDateParts,function(i){return null!=i}),isNowValid=!isNaN(m._d.getTime())&&flags.overflow<0&&!flags.empty&&!flags.invalidMonth&&!flags.invalidWeekday&&!flags.weekdayMismatch&&!flags.nullInput&&!flags.invalidFormat&&!flags.userInvalidated&&(!flags.meridiem||flags.meridiem&&parsedParts);if(m._strict&&(isNowValid=isNowValid&&0===flags.charsLeftOver&&0===flags.unusedTokens.length&&void 0===flags.bigHour),null!=Object.isFrozen&&Object.isFrozen(m))return isNowValid;m._isValid=isNowValid}return m._isValid}function createInvalid(flags){var m=createUTC(NaN);return null!=flags?extend(getParsingFlags(m),flags):getParsingFlags(m).userInvalidated=!0,m}some=Array.prototype.some?Array.prototype.some:function(fun){for(var t=Object(this),len=t.length>>>0,i=0;i<len;i++)if(i in t&&fun.call(this,t[i],i,t))return!0;return!1};var momentProperties=hooks.momentProperties=[];function copyConfig(to,from){var i,prop,val;if(isUndefined(from._isAMomentObject)||(to._isAMomentObject=from._isAMomentObject),isUndefined(from._i)||(to._i=from._i),isUndefined(from._f)||(to._f=from._f),isUndefined(from._l)||(to._l=from._l),isUndefined(from._strict)||(to._strict=from._strict),isUndefined(from._tzm)||(to._tzm=from._tzm),isUndefined(from._isUTC)||(to._isUTC=from._isUTC),isUndefined(from._offset)||(to._offset=from._offset),isUndefined(from._pf)||(to._pf=getParsingFlags(from)),isUndefined(from._locale)||(to._locale=from._locale),momentProperties.length>0)for(i=0;i<momentProperties.length;i++)prop=momentProperties[i],isUndefined(val=from[prop])||(to[prop]=val);return to}var updateInProgress=!1;function Moment(config){copyConfig(this,config),this._d=new Date(null!=config._d?config._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===updateInProgress&&(updateInProgress=!0,hooks.updateOffset(this),updateInProgress=!1)}function isMoment(obj){return obj instanceof Moment||null!=obj&&null!=obj._isAMomentObject}function absFloor(number){return number<0?Math.ceil(number)||0:Math.floor(number)}function toInt(argumentForCoercion){var coercedNumber=+argumentForCoercion,value=0;return 0!==coercedNumber&&isFinite(coercedNumber)&&(value=absFloor(coercedNumber)),value}function compareArrays(array1,array2,dontConvert){var i,len=Math.min(array1.length,array2.length),lengthDiff=Math.abs(array1.length-array2.length),diffs=0;for(i=0;i<len;i++)(dontConvert&&array1[i]!==array2[i]||!dontConvert&&toInt(array1[i])!==toInt(array2[i]))&&diffs++;return diffs+lengthDiff}function warn(msg){!1===hooks.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+msg)}function deprecate(msg,fn){var firstTime=!0;return extend(function(){if(null!=hooks.deprecationHandler&&hooks.deprecationHandler(null,msg),firstTime){for(var arg,args=[],i=0;i<arguments.length;i++){if(arg="","object"==typeof arguments[i]){for(var key in arg+="\n["+i+"] ",arguments[0])arg+=key+": "+arguments[0][key]+", ";arg=arg.slice(0,-2)}else arg=arguments[i];args.push(arg)}warn(msg+"\nArguments: "+Array.prototype.slice.call(args).join("")+"\n"+(new Error).stack),firstTime=!1}return fn.apply(this,arguments)},fn)}var keys,deprecations={};function deprecateSimple(name,msg){null!=hooks.deprecationHandler&&hooks.deprecationHandler(name,msg),deprecations[name]||(warn(msg),deprecations[name]=!0)}function isFunction(input){return input instanceof Function||"[object Function]"===Object.prototype.toString.call(input)}function mergeConfigs(parentConfig,childConfig){var prop,res=extend({},parentConfig);for(prop in childConfig)hasOwnProp(childConfig,prop)&&(isObject(parentConfig[prop])&&isObject(childConfig[prop])?(res[prop]={},extend(res[prop],parentConfig[prop]),extend(res[prop],childConfig[prop])):null!=childConfig[prop]?res[prop]=childConfig[prop]:delete res[prop]);for(prop in parentConfig)hasOwnProp(parentConfig,prop)&&!hasOwnProp(childConfig,prop)&&isObject(parentConfig[prop])&&(res[prop]=extend({},res[prop]));return res}function Locale(config){null!=config&&this.set(config)}hooks.suppressDeprecationWarnings=!1,hooks.deprecationHandler=null,keys=Object.keys?Object.keys:function(obj){var i,res=[];for(i in obj)hasOwnProp(obj,i)&&res.push(i);return res};var aliases={};function addUnitAlias(unit,shorthand){var lowerCase=unit.toLowerCase();aliases[lowerCase]=aliases[lowerCase+"s"]=aliases[shorthand]=unit}function normalizeUnits(units){return"string"==typeof units?aliases[units]||aliases[units.toLowerCase()]:void 0}function normalizeObjectUnits(inputObject){var normalizedProp,prop,normalizedInput={};for(prop in inputObject)hasOwnProp(inputObject,prop)&&(normalizedProp=normalizeUnits(prop))&&(normalizedInput[normalizedProp]=inputObject[prop]);return normalizedInput}var priorities={};function addUnitPriority(unit,priority){priorities[unit]=priority}function zeroFill(number,targetLength,forceSign){var absNumber=""+Math.abs(number),zerosToFill=targetLength-absNumber.length,sign=number>=0;return(sign?forceSign?"+":"":"-")+Math.pow(10,Math.max(0,zerosToFill)).toString().substr(1)+absNumber}var formattingTokens=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,localFormattingTokens=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,formatFunctions={},formatTokenFunctions={};function addFormatToken(token,padded,ordinal,callback){var func=callback;"string"==typeof callback&&(func=function(){return this[callback]()}),token&&(formatTokenFunctions[token]=func),padded&&(formatTokenFunctions[padded[0]]=function(){return zeroFill(func.apply(this,arguments),padded[1],padded[2])}),ordinal&&(formatTokenFunctions[ordinal]=function(){return this.localeData().ordinal(func.apply(this,arguments),token)})}function formatMoment(m,format){return m.isValid()?(format=expandFormat(format,m.localeData()),formatFunctions[format]=formatFunctions[format]||function(format){var i,length,input,array=format.match(formattingTokens);for(i=0,length=array.length;i<length;i++)formatTokenFunctions[array[i]]?array[i]=formatTokenFunctions[array[i]]:array[i]=(input=array[i]).match(/\[[\s\S]/)?input.replace(/^\[|\]$/g,""):input.replace(/\\/g,"");return function(mom){var i,output="";for(i=0;i<length;i++)output+=isFunction(array[i])?array[i].call(mom,format):array[i];return output}}(format),formatFunctions[format](m)):m.localeData().invalidDate()}function expandFormat(format,locale){var i=5;function replaceLongDateFormatTokens(input){return locale.longDateFormat(input)||input}for(localFormattingTokens.lastIndex=0;i>=0&&localFormattingTokens.test(format);)format=format.replace(localFormattingTokens,replaceLongDateFormatTokens),localFormattingTokens.lastIndex=0,i-=1;return format}var match1=/\d/,match2=/\d\d/,match3=/\d{3}/,match4=/\d{4}/,match6=/[+-]?\d{6}/,match1to2=/\d\d?/,match3to4=/\d\d\d\d?/,match5to6=/\d\d\d\d\d\d?/,match1to3=/\d{1,3}/,match1to4=/\d{1,4}/,match1to6=/[+-]?\d{1,6}/,matchUnsigned=/\d+/,matchSigned=/[+-]?\d+/,matchOffset=/Z|[+-]\d\d:?\d\d/gi,matchShortOffset=/Z|[+-]\d\d(?::?\d\d)?/gi,matchWord=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,regexes={};function addRegexToken(token,regex,strictRegex){regexes[token]=isFunction(regex)?regex:function(isStrict,localeData){return isStrict&&strictRegex?strictRegex:regex}}function getParseRegexForToken(token,config){return hasOwnProp(regexes,token)?regexes[token](config._strict,config._locale):new RegExp(regexEscape(token.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(matched,p1,p2,p3,p4){return p1||p2||p3||p4})))}function regexEscape(s){return s.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var tokens={};function addParseToken(token,callback){var i,func=callback;for("string"==typeof token&&(token=[token]),isNumber(callback)&&(func=function(input,array){array[callback]=toInt(input)}),i=0;i<token.length;i++)tokens[token[i]]=func}function addWeekParseToken(token,callback){addParseToken(token,function(input,array,config,token){config._w=config._w||{},callback(input,config._w,config,token)})}function addTimeToArrayFromToken(token,input,config){null!=input&&hasOwnProp(tokens,token)&&tokens[token](input,config._a,config,token)}var YEAR=0,MONTH=1,DATE=2,HOUR=3,MINUTE=4,SECOND=5,MILLISECOND=6,WEEK=7,WEEKDAY=8;function daysInYear(year){return isLeapYear(year)?366:365}function isLeapYear(year){return year%4==0&&year%100!=0||year%400==0}addFormatToken("Y",0,0,function(){var y=this.year();return y<=9999?""+y:"+"+y}),addFormatToken(0,["YY",2],0,function(){return this.year()%100}),addFormatToken(0,["YYYY",4],0,"year"),addFormatToken(0,["YYYYY",5],0,"year"),addFormatToken(0,["YYYYYY",6,!0],0,"year"),addUnitAlias("year","y"),addUnitPriority("year",1),addRegexToken("Y",matchSigned),addRegexToken("YY",match1to2,match2),addRegexToken("YYYY",match1to4,match4),addRegexToken("YYYYY",match1to6,match6),addRegexToken("YYYYYY",match1to6,match6),addParseToken(["YYYYY","YYYYYY"],YEAR),addParseToken("YYYY",function(input,array){array[YEAR]=2===input.length?hooks.parseTwoDigitYear(input):toInt(input)}),addParseToken("YY",function(input,array){array[YEAR]=hooks.parseTwoDigitYear(input)}),addParseToken("Y",function(input,array){array[YEAR]=parseInt(input,10)}),hooks.parseTwoDigitYear=function(input){return toInt(input)+(toInt(input)>68?1900:2e3)};var indexOf,getSetYear=makeGetSet("FullYear",!0);function makeGetSet(unit,keepTime){return function(value){return null!=value?(set$1(this,unit,value),hooks.updateOffset(this,keepTime),this):get(this,unit)}}function get(mom,unit){return mom.isValid()?mom._d["get"+(mom._isUTC?"UTC":"")+unit]():NaN}function set$1(mom,unit,value){mom.isValid()&&!isNaN(value)&&("FullYear"===unit&&isLeapYear(mom.year())&&1===mom.month()&&29===mom.date()?mom._d["set"+(mom._isUTC?"UTC":"")+unit](value,mom.month(),daysInMonth(value,mom.month())):mom._d["set"+(mom._isUTC?"UTC":"")+unit](value))}function daysInMonth(year,month){if(isNaN(year)||isNaN(month))return NaN;var x,modMonth=(month%(x=12)+x)%x;return year+=(month-modMonth)/12,1===modMonth?isLeapYear(year)?29:28:31-modMonth%7%2}indexOf=Array.prototype.indexOf?Array.prototype.indexOf:function(o){var i;for(i=0;i<this.length;++i)if(this[i]===o)return i;return-1},addFormatToken("M",["MM",2],"Mo",function(){return this.month()+1}),addFormatToken("MMM",0,0,function(format){return this.localeData().monthsShort(this,format)}),addFormatToken("MMMM",0,0,function(format){return this.localeData().months(this,format)}),addUnitAlias("month","M"),addUnitPriority("month",8),addRegexToken("M",match1to2),addRegexToken("MM",match1to2,match2),addRegexToken("MMM",function(isStrict,locale){return locale.monthsShortRegex(isStrict)}),addRegexToken("MMMM",function(isStrict,locale){return locale.monthsRegex(isStrict)}),addParseToken(["M","MM"],function(input,array){array[MONTH]=toInt(input)-1}),addParseToken(["MMM","MMMM"],function(input,array,config,token){var month=config._locale.monthsParse(input,token,config._strict);null!=month?array[MONTH]=month:getParsingFlags(config).invalidMonth=input});var MONTHS_IN_FORMAT=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,defaultLocaleMonths="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),defaultLocaleMonthsShort="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_");function setMonth(mom,value){var dayOfMonth;if(!mom.isValid())return mom;if("string"==typeof value)if(/^\d+$/.test(value))value=toInt(value);else if(!isNumber(value=mom.localeData().monthsParse(value)))return mom;return dayOfMonth=Math.min(mom.date(),daysInMonth(mom.year(),value)),mom._d["set"+(mom._isUTC?"UTC":"")+"Month"](value,dayOfMonth),mom}function getSetMonth(value){return null!=value?(setMonth(this,value),hooks.updateOffset(this,!0),this):get(this,"Month")}var defaultMonthsShortRegex=matchWord,defaultMonthsRegex=matchWord;function computeMonthsParse(){function cmpLenRev(a,b){return b.length-a.length}var i,mom,shortPieces=[],longPieces=[],mixedPieces=[];for(i=0;i<12;i++)mom=createUTC([2e3,i]),shortPieces.push(this.monthsShort(mom,"")),longPieces.push(this.months(mom,"")),mixedPieces.push(this.months(mom,"")),mixedPieces.push(this.monthsShort(mom,""));for(shortPieces.sort(cmpLenRev),longPieces.sort(cmpLenRev),mixedPieces.sort(cmpLenRev),i=0;i<12;i++)shortPieces[i]=regexEscape(shortPieces[i]),longPieces[i]=regexEscape(longPieces[i]);for(i=0;i<24;i++)mixedPieces[i]=regexEscape(mixedPieces[i]);this._monthsRegex=new RegExp("^("+mixedPieces.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+longPieces.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+shortPieces.join("|")+")","i")}function createUTCDate(y){var date=new Date(Date.UTC.apply(null,arguments));return y<100&&y>=0&&isFinite(date.getUTCFullYear())&&date.setUTCFullYear(y),date}function firstWeekOffset(year,dow,doy){var fwd=7+dow-doy,fwdlw=(7+createUTCDate(year,0,fwd).getUTCDay()-dow)%7;return-fwdlw+fwd-1}function dayOfYearFromWeeks(year,week,weekday,dow,doy){var resYear,resDayOfYear,localWeekday=(7+weekday-dow)%7,weekOffset=firstWeekOffset(year,dow,doy),dayOfYear=1+7*(week-1)+localWeekday+weekOffset;return dayOfYear<=0?resDayOfYear=daysInYear(resYear=year-1)+dayOfYear:dayOfYear>daysInYear(year)?(resYear=year+1,resDayOfYear=dayOfYear-daysInYear(year)):(resYear=year,resDayOfYear=dayOfYear),{year:resYear,dayOfYear:resDayOfYear}}function weekOfYear(mom,dow,doy){var resWeek,resYear,weekOffset=firstWeekOffset(mom.year(),dow,doy),week=Math.floor((mom.dayOfYear()-weekOffset-1)/7)+1;return week<1?(resYear=mom.year()-1,resWeek=week+weeksInYear(resYear,dow,doy)):week>weeksInYear(mom.year(),dow,doy)?(resWeek=week-weeksInYear(mom.year(),dow,doy),resYear=mom.year()+1):(resYear=mom.year(),resWeek=week),{week:resWeek,year:resYear}}function weeksInYear(year,dow,doy){var weekOffset=firstWeekOffset(year,dow,doy),weekOffsetNext=firstWeekOffset(year+1,dow,doy);return(daysInYear(year)-weekOffset+weekOffsetNext)/7}addFormatToken("w",["ww",2],"wo","week"),addFormatToken("W",["WW",2],"Wo","isoWeek"),addUnitAlias("week","w"),addUnitAlias("isoWeek","W"),addUnitPriority("week",5),addUnitPriority("isoWeek",5),addRegexToken("w",match1to2),addRegexToken("ww",match1to2,match2),addRegexToken("W",match1to2),addRegexToken("WW",match1to2,match2),addWeekParseToken(["w","ww","W","WW"],function(input,week,config,token){week[token.substr(0,1)]=toInt(input)}),addFormatToken("d",0,"do","day"),addFormatToken("dd",0,0,function(format){return this.localeData().weekdaysMin(this,format)}),addFormatToken("ddd",0,0,function(format){return this.localeData().weekdaysShort(this,format)}),addFormatToken("dddd",0,0,function(format){return this.localeData().weekdays(this,format)}),addFormatToken("e",0,0,"weekday"),addFormatToken("E",0,0,"isoWeekday"),addUnitAlias("day","d"),addUnitAlias("weekday","e"),addUnitAlias("isoWeekday","E"),addUnitPriority("day",11),addUnitPriority("weekday",11),addUnitPriority("isoWeekday",11),addRegexToken("d",match1to2),addRegexToken("e",match1to2),addRegexToken("E",match1to2),addRegexToken("dd",function(isStrict,locale){return locale.weekdaysMinRegex(isStrict)}),addRegexToken("ddd",function(isStrict,locale){return locale.weekdaysShortRegex(isStrict)}),addRegexToken("dddd",function(isStrict,locale){return locale.weekdaysRegex(isStrict)}),addWeekParseToken(["dd","ddd","dddd"],function(input,week,config,token){var weekday=config._locale.weekdaysParse(input,token,config._strict);null!=weekday?week.d=weekday:getParsingFlags(config).invalidWeekday=input}),addWeekParseToken(["d","e","E"],function(input,week,config,token){week[token]=toInt(input)});var defaultLocaleWeekdays="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),defaultLocaleWeekdaysShort="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),defaultLocaleWeekdaysMin="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),defaultWeekdaysRegex=matchWord,defaultWeekdaysShortRegex=matchWord,defaultWeekdaysMinRegex=matchWord;function computeWeekdaysParse(){function cmpLenRev(a,b){return b.length-a.length}var i,mom,minp,shortp,longp,minPieces=[],shortPieces=[],longPieces=[],mixedPieces=[];for(i=0;i<7;i++)mom=createUTC([2e3,1]).day(i),minp=this.weekdaysMin(mom,""),shortp=this.weekdaysShort(mom,""),longp=this.weekdays(mom,""),minPieces.push(minp),shortPieces.push(shortp),longPieces.push(longp),mixedPieces.push(minp),mixedPieces.push(shortp),mixedPieces.push(longp);for(minPieces.sort(cmpLenRev),shortPieces.sort(cmpLenRev),longPieces.sort(cmpLenRev),mixedPieces.sort(cmpLenRev),i=0;i<7;i++)shortPieces[i]=regexEscape(shortPieces[i]),longPieces[i]=regexEscape(longPieces[i]),mixedPieces[i]=regexEscape(mixedPieces[i]);this._weekdaysRegex=new RegExp("^("+mixedPieces.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+longPieces.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+shortPieces.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+minPieces.join("|")+")","i")}function hFormat(){return this.hours()%12||12}function meridiem(token,lowercase){addFormatToken(token,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),lowercase)})}function matchMeridiem(isStrict,locale){return locale._meridiemParse}addFormatToken("H",["HH",2],0,"hour"),addFormatToken("h",["hh",2],0,hFormat),addFormatToken("k",["kk",2],0,function(){return this.hours()||24}),addFormatToken("hmm",0,0,function(){return""+hFormat.apply(this)+zeroFill(this.minutes(),2)}),addFormatToken("hmmss",0,0,function(){return""+hFormat.apply(this)+zeroFill(this.minutes(),2)+zeroFill(this.seconds(),2)}),addFormatToken("Hmm",0,0,function(){return""+this.hours()+zeroFill(this.minutes(),2)}),addFormatToken("Hmmss",0,0,function(){return""+this.hours()+zeroFill(this.minutes(),2)+zeroFill(this.seconds(),2)}),meridiem("a",!0),meridiem("A",!1),addUnitAlias("hour","h"),addUnitPriority("hour",13),addRegexToken("a",matchMeridiem),addRegexToken("A",matchMeridiem),addRegexToken("H",match1to2),addRegexToken("h",match1to2),addRegexToken("k",match1to2),addRegexToken("HH",match1to2,match2),addRegexToken("hh",match1to2,match2),addRegexToken("kk",match1to2,match2),addRegexToken("hmm",match3to4),addRegexToken("hmmss",match5to6),addRegexToken("Hmm",match3to4),addRegexToken("Hmmss",match5to6),addParseToken(["H","HH"],HOUR),addParseToken(["k","kk"],function(input,array,config){var kInput=toInt(input);array[HOUR]=24===kInput?0:kInput}),addParseToken(["a","A"],function(input,array,config){config._isPm=config._locale.isPM(input),config._meridiem=input}),addParseToken(["h","hh"],function(input,array,config){array[HOUR]=toInt(input),getParsingFlags(config).bigHour=!0}),addParseToken("hmm",function(input,array,config){var pos=input.length-2;array[HOUR]=toInt(input.substr(0,pos)),array[MINUTE]=toInt(input.substr(pos)),getParsingFlags(config).bigHour=!0}),addParseToken("hmmss",function(input,array,config){var pos1=input.length-4,pos2=input.length-2;array[HOUR]=toInt(input.substr(0,pos1)),array[MINUTE]=toInt(input.substr(pos1,2)),array[SECOND]=toInt(input.substr(pos2)),getParsingFlags(config).bigHour=!0}),addParseToken("Hmm",function(input,array,config){var pos=input.length-2;array[HOUR]=toInt(input.substr(0,pos)),array[MINUTE]=toInt(input.substr(pos))}),addParseToken("Hmmss",function(input,array,config){var pos1=input.length-4,pos2=input.length-2;array[HOUR]=toInt(input.substr(0,pos1)),array[MINUTE]=toInt(input.substr(pos1,2)),array[SECOND]=toInt(input.substr(pos2))});var globalLocale,getSetHour=makeGetSet("Hours",!0),baseConfig={calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},longDateFormat:{LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},invalidDate:"Invalid date",ordinal:"%d",dayOfMonthOrdinalParse:/\d{1,2}/,relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},months:defaultLocaleMonths,monthsShort:defaultLocaleMonthsShort,week:{dow:0,doy:6},weekdays:defaultLocaleWeekdays,weekdaysMin:defaultLocaleWeekdaysMin,weekdaysShort:defaultLocaleWeekdaysShort,meridiemParse:/[ap]\.?m?\.?/i},locales={},localeFamilies={};function normalizeLocale(key){return key?key.toLowerCase().replace("_","-"):key}function loadLocale(name){var oldLocale=null;if(!locales[name]&&void 0!==module&&module&&module.exports)try{oldLocale=globalLocale._abbr,__webpack_require__("./node_modules/moment/locale sync recursive ^\\.\\/.*$")("./"+name),getSetGlobalLocale(oldLocale)}catch(e){}return locales[name]}function getSetGlobalLocale(key,values){var data;return key&&((data=isUndefined(values)?getLocale(key):defineLocale(key,values))?globalLocale=data:"undefined"!=typeof console&&console.warn&&console.warn("Locale "+key+" not found. Did you forget to load it?")),globalLocale._abbr}function defineLocale(name,config){if(null!==config){var locale,parentConfig=baseConfig;if(config.abbr=name,null!=locales[name])deprecateSimple("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),parentConfig=locales[name]._config;else if(null!=config.parentLocale)if(null!=locales[config.parentLocale])parentConfig=locales[config.parentLocale]._config;else{if(null==(locale=loadLocale(config.parentLocale)))return localeFamilies[config.parentLocale]||(localeFamilies[config.parentLocale]=[]),localeFamilies[config.parentLocale].push({name:name,config:config}),null;parentConfig=locale._config}return locales[name]=new Locale(mergeConfigs(parentConfig,config)),localeFamilies[name]&&localeFamilies[name].forEach(function(x){defineLocale(x.name,x.config)}),getSetGlobalLocale(name),locales[name]}return delete locales[name],null}function getLocale(key){var locale;if(key&&key._locale&&key._locale._abbr&&(key=key._locale._abbr),!key)return globalLocale;if(!isArray(key)){if(locale=loadLocale(key))return locale;key=[key]}return function(names){for(var j,next,locale,split,i=0;i<names.length;){for(split=normalizeLocale(names[i]).split("-"),j=split.length,next=(next=normalizeLocale(names[i+1]))?next.split("-"):null;j>0;){if(locale=loadLocale(split.slice(0,j).join("-")))return locale;if(next&&next.length>=j&&compareArrays(split,next,!0)>=j-1)break;j--}i++}return globalLocale}(key)}function checkOverflow(m){var overflow,a=m._a;return a&&-2===getParsingFlags(m).overflow&&(overflow=a[MONTH]<0||a[MONTH]>11?MONTH:a[DATE]<1||a[DATE]>daysInMonth(a[YEAR],a[MONTH])?DATE:a[HOUR]<0||a[HOUR]>24||24===a[HOUR]&&(0!==a[MINUTE]||0!==a[SECOND]||0!==a[MILLISECOND])?HOUR:a[MINUTE]<0||a[MINUTE]>59?MINUTE:a[SECOND]<0||a[SECOND]>59?SECOND:a[MILLISECOND]<0||a[MILLISECOND]>999?MILLISECOND:-1,getParsingFlags(m)._overflowDayOfYear&&(overflow<YEAR||overflow>DATE)&&(overflow=DATE),getParsingFlags(m)._overflowWeeks&&-1===overflow&&(overflow=WEEK),getParsingFlags(m)._overflowWeekday&&-1===overflow&&(overflow=WEEKDAY),getParsingFlags(m).overflow=overflow),m}function defaults(a,b,c){return null!=a?a:null!=b?b:c}function configFromArray(config){var i,date,currentDate,expectedWeekday,yearToUse,input=[];if(!config._d){for(currentDate=function(config){var nowValue=new Date(hooks.now());return config._useUTC?[nowValue.getUTCFullYear(),nowValue.getUTCMonth(),nowValue.getUTCDate()]:[nowValue.getFullYear(),nowValue.getMonth(),nowValue.getDate()]}(config),config._w&&null==config._a[DATE]&&null==config._a[MONTH]&&function(config){var w,weekYear,week,weekday,dow,doy,temp,weekdayOverflow;if(null!=(w=config._w).GG||null!=w.W||null!=w.E)dow=1,doy=4,weekYear=defaults(w.GG,config._a[YEAR],weekOfYear(createLocal(),1,4).year),week=defaults(w.W,1),((weekday=defaults(w.E,1))<1||weekday>7)&&(weekdayOverflow=!0);else{dow=config._locale._week.dow,doy=config._locale._week.doy;var curWeek=weekOfYear(createLocal(),dow,doy);weekYear=defaults(w.gg,config._a[YEAR],curWeek.year),week=defaults(w.w,curWeek.week),null!=w.d?((weekday=w.d)<0||weekday>6)&&(weekdayOverflow=!0):null!=w.e?(weekday=w.e+dow,(w.e<0||w.e>6)&&(weekdayOverflow=!0)):weekday=dow}week<1||week>weeksInYear(weekYear,dow,doy)?getParsingFlags(config)._overflowWeeks=!0:null!=weekdayOverflow?getParsingFlags(config)._overflowWeekday=!0:(temp=dayOfYearFromWeeks(weekYear,week,weekday,dow,doy),config._a[YEAR]=temp.year,config._dayOfYear=temp.dayOfYear)}(config),null!=config._dayOfYear&&(yearToUse=defaults(config._a[YEAR],currentDate[YEAR]),(config._dayOfYear>daysInYear(yearToUse)||0===config._dayOfYear)&&(getParsingFlags(config)._overflowDayOfYear=!0),date=createUTCDate(yearToUse,0,config._dayOfYear),config._a[MONTH]=date.getUTCMonth(),config._a[DATE]=date.getUTCDate()),i=0;i<3&&null==config._a[i];++i)config._a[i]=input[i]=currentDate[i];for(;i<7;i++)config._a[i]=input[i]=null==config._a[i]?2===i?1:0:config._a[i];24===config._a[HOUR]&&0===config._a[MINUTE]&&0===config._a[SECOND]&&0===config._a[MILLISECOND]&&(config._nextDay=!0,config._a[HOUR]=0),config._d=(config._useUTC?createUTCDate:function(y,m,d,h,M,s,ms){var date=new Date(y,m,d,h,M,s,ms);return y<100&&y>=0&&isFinite(date.getFullYear())&&date.setFullYear(y),date}).apply(null,input),expectedWeekday=config._useUTC?config._d.getUTCDay():config._d.getDay(),null!=config._tzm&&config._d.setUTCMinutes(config._d.getUTCMinutes()-config._tzm),config._nextDay&&(config._a[HOUR]=24),config._w&&void 0!==config._w.d&&config._w.d!==expectedWeekday&&(getParsingFlags(config).weekdayMismatch=!0)}}var extendedIsoRegex=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,basicIsoRegex=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,tzRegex=/Z|[+-]\d\d(?::?\d\d)?/,isoDates=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],isoTimes=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],aspNetJsonRegex=/^\/?Date\((\-?\d+)/i;function configFromISO(config){var i,l,allowTime,dateFormat,timeFormat,tzFormat,string=config._i,match=extendedIsoRegex.exec(string)||basicIsoRegex.exec(string);if(match){for(getParsingFlags(config).iso=!0,i=0,l=isoDates.length;i<l;i++)if(isoDates[i][1].exec(match[1])){dateFormat=isoDates[i][0],allowTime=!1!==isoDates[i][2];break}if(null==dateFormat)return void(config._isValid=!1);if(match[3]){for(i=0,l=isoTimes.length;i<l;i++)if(isoTimes[i][1].exec(match[3])){timeFormat=(match[2]||" ")+isoTimes[i][0];break}if(null==timeFormat)return void(config._isValid=!1)}if(!allowTime&&null!=timeFormat)return void(config._isValid=!1);if(match[4]){if(!tzRegex.exec(match[4]))return void(config._isValid=!1);tzFormat="Z"}config._f=dateFormat+(timeFormat||"")+(tzFormat||""),configFromStringAndFormat(config)}else config._isValid=!1}var rfc2822=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/;function extractFromRFC2822Strings(yearStr,monthStr,dayStr,hourStr,minuteStr,secondStr){var result=[function(yearStr){var year=parseInt(yearStr,10);return year<=49?2e3+year:year<=999?1900+year:year}(yearStr),defaultLocaleMonthsShort.indexOf(monthStr),parseInt(dayStr,10),parseInt(hourStr,10),parseInt(minuteStr,10)];return secondStr&&result.push(parseInt(secondStr,10)),result}var obsOffsets={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function configFromRFC2822(config){var match=rfc2822.exec(config._i.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim());if(match){var parsedArray=extractFromRFC2822Strings(match[4],match[3],match[2],match[5],match[6],match[7]);if(!function(weekdayStr,parsedInput,config){if(weekdayStr){var weekdayProvided=defaultLocaleWeekdaysShort.indexOf(weekdayStr),weekdayActual=new Date(parsedInput[0],parsedInput[1],parsedInput[2]).getDay();if(weekdayProvided!==weekdayActual)return getParsingFlags(config).weekdayMismatch=!0,config._isValid=!1,!1}return!0}(match[1],parsedArray,config))return;config._a=parsedArray,config._tzm=function(obsOffset,militaryOffset,numOffset){if(obsOffset)return obsOffsets[obsOffset];if(militaryOffset)return 0;var hm=parseInt(numOffset,10),m=hm%100,h=(hm-m)/100;return 60*h+m}(match[8],match[9],match[10]),config._d=createUTCDate.apply(null,config._a),config._d.setUTCMinutes(config._d.getUTCMinutes()-config._tzm),getParsingFlags(config).rfc2822=!0}else config._isValid=!1}function configFromStringAndFormat(config){if(config._f!==hooks.ISO_8601)if(config._f!==hooks.RFC_2822){config._a=[],getParsingFlags(config).empty=!0;var i,parsedInput,tokens,token,skipped,string=""+config._i,stringLength=string.length,totalParsedInputLength=0;for(tokens=expandFormat(config._f,config._locale).match(formattingTokens)||[],i=0;i<tokens.length;i++)token=tokens[i],(parsedInput=(string.match(getParseRegexForToken(token,config))||[])[0])&&((skipped=string.substr(0,string.indexOf(parsedInput))).length>0&&getParsingFlags(config).unusedInput.push(skipped),string=string.slice(string.indexOf(parsedInput)+parsedInput.length),totalParsedInputLength+=parsedInput.length),formatTokenFunctions[token]?(parsedInput?getParsingFlags(config).empty=!1:getParsingFlags(config).unusedTokens.push(token),addTimeToArrayFromToken(token,parsedInput,config)):config._strict&&!parsedInput&&getParsingFlags(config).unusedTokens.push(token);getParsingFlags(config).charsLeftOver=stringLength-totalParsedInputLength,string.length>0&&getParsingFlags(config).unusedInput.push(string),config._a[HOUR]<=12&&!0===getParsingFlags(config).bigHour&&config._a[HOUR]>0&&(getParsingFlags(config).bigHour=void 0),getParsingFlags(config).parsedDateParts=config._a.slice(0),getParsingFlags(config).meridiem=config._meridiem,config._a[HOUR]=(locale=config._locale,hour=config._a[HOUR],null==(meridiem=config._meridiem)?hour:null!=locale.meridiemHour?locale.meridiemHour(hour,meridiem):null!=locale.isPM?((isPm=locale.isPM(meridiem))&&hour<12&&(hour+=12),isPm||12!==hour||(hour=0),hour):hour),configFromArray(config),checkOverflow(config)}else configFromRFC2822(config);else configFromISO(config);var locale,hour,meridiem,isPm}function prepareConfig(config){var input=config._i,format=config._f;return config._locale=config._locale||getLocale(config._l),null===input||void 0===format&&""===input?createInvalid({nullInput:!0}):("string"==typeof input&&(config._i=input=config._locale.preparse(input)),isMoment(input)?new Moment(checkOverflow(input)):(isDate(input)?config._d=input:isArray(format)?function(config){var tempConfig,bestMoment,scoreToBeat,i,currentScore;if(0===config._f.length)return getParsingFlags(config).invalidFormat=!0,void(config._d=new Date(NaN));for(i=0;i<config._f.length;i++)currentScore=0,tempConfig=copyConfig({},config),null!=config._useUTC&&(tempConfig._useUTC=config._useUTC),tempConfig._f=config._f[i],configFromStringAndFormat(tempConfig),isValid(tempConfig)&&(currentScore+=getParsingFlags(tempConfig).charsLeftOver,currentScore+=10*getParsingFlags(tempConfig).unusedTokens.length,getParsingFlags(tempConfig).score=currentScore,(null==scoreToBeat||currentScore<scoreToBeat)&&(scoreToBeat=currentScore,bestMoment=tempConfig));extend(config,bestMoment||tempConfig)}(config):format?configFromStringAndFormat(config):function(config){var input=config._i;isUndefined(input)?config._d=new Date(hooks.now()):isDate(input)?config._d=new Date(input.valueOf()):"string"==typeof input?function(config){var matched=aspNetJsonRegex.exec(config._i);null===matched?(configFromISO(config),!1===config._isValid&&(delete config._isValid,configFromRFC2822(config),!1===config._isValid&&(delete config._isValid,hooks.createFromInputFallback(config)))):config._d=new Date(+matched[1])}(config):isArray(input)?(config._a=map(input.slice(0),function(obj){return parseInt(obj,10)}),configFromArray(config)):isObject(input)?function(config){if(!config._d){var i=normalizeObjectUnits(config._i);config._a=map([i.year,i.month,i.day||i.date,i.hour,i.minute,i.second,i.millisecond],function(obj){return obj&&parseInt(obj,10)}),configFromArray(config)}}(config):isNumber(input)?config._d=new Date(input):hooks.createFromInputFallback(config)}(config),isValid(config)||(config._d=null),config))}function createLocalOrUTC(input,format,locale,strict,isUTC){var res,c={};return!0!==locale&&!1!==locale||(strict=locale,locale=void 0),(isObject(input)&&function(obj){if(Object.getOwnPropertyNames)return 0===Object.getOwnPropertyNames(obj).length;var k;for(k in obj)if(obj.hasOwnProperty(k))return!1;return!0}(input)||isArray(input)&&0===input.length)&&(input=void 0),c._isAMomentObject=!0,c._useUTC=c._isUTC=isUTC,c._l=locale,c._i=input,c._f=format,c._strict=strict,(res=new Moment(checkOverflow(prepareConfig(c))))._nextDay&&(res.add(1,"d"),res._nextDay=void 0),res}function createLocal(input,format,locale,strict){return createLocalOrUTC(input,format,locale,strict,!1)}hooks.createFromInputFallback=deprecate("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(config){config._d=new Date(config._i+(config._useUTC?" UTC":""))}),hooks.ISO_8601=function(){},hooks.RFC_2822=function(){};var prototypeMin=deprecate("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var other=createLocal.apply(null,arguments);return this.isValid()&&other.isValid()?other<this?this:other:createInvalid()}),prototypeMax=deprecate("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var other=createLocal.apply(null,arguments);return this.isValid()&&other.isValid()?other>this?this:other:createInvalid()});function pickBy(fn,moments){var res,i;if(1===moments.length&&isArray(moments[0])&&(moments=moments[0]),!moments.length)return createLocal();for(res=moments[0],i=1;i<moments.length;++i)moments[i].isValid()&&!moments[i][fn](res)||(res=moments[i]);return res}var ordering=["year","quarter","month","week","day","hour","minute","second","millisecond"];function Duration(duration){var normalizedInput=normalizeObjectUnits(duration),years=normalizedInput.year||0,quarters=normalizedInput.quarter||0,months=normalizedInput.month||0,weeks=normalizedInput.week||0,days=normalizedInput.day||0,hours=normalizedInput.hour||0,minutes=normalizedInput.minute||0,seconds=normalizedInput.second||0,milliseconds=normalizedInput.millisecond||0;this._isValid=function(m){for(var key in m)if(-1===indexOf.call(ordering,key)||null!=m[key]&&isNaN(m[key]))return!1;for(var unitHasDecimal=!1,i=0;i<ordering.length;++i)if(m[ordering[i]]){if(unitHasDecimal)return!1;parseFloat(m[ordering[i]])!==toInt(m[ordering[i]])&&(unitHasDecimal=!0)}return!0}(normalizedInput),this._milliseconds=+milliseconds+1e3*seconds+6e4*minutes+1e3*hours*60*60,this._days=+days+7*weeks,this._months=+months+3*quarters+12*years,this._data={},this._locale=getLocale(),this._bubble()}function isDuration(obj){return obj instanceof Duration}function absRound(number){return number<0?-1*Math.round(-1*number):Math.round(number)}function offset(token,separator){addFormatToken(token,0,0,function(){var offset=this.utcOffset(),sign="+";return offset<0&&(offset=-offset,sign="-"),sign+zeroFill(~~(offset/60),2)+separator+zeroFill(~~offset%60,2)})}offset("Z",":"),offset("ZZ",""),addRegexToken("Z",matchShortOffset),addRegexToken("ZZ",matchShortOffset),addParseToken(["Z","ZZ"],function(input,array,config){config._useUTC=!0,config._tzm=offsetFromString(matchShortOffset,input)});var chunkOffset=/([\+\-]|\d\d)/gi;function offsetFromString(matcher,string){var matches=(string||"").match(matcher);if(null===matches)return null;var chunk=matches[matches.length-1]||[],parts=(chunk+"").match(chunkOffset)||["-",0,0],minutes=60*parts[1]+toInt(parts[2]);return 0===minutes?0:"+"===parts[0]?minutes:-minutes}function cloneWithOffset(input,model){var res,diff;return model._isUTC?(res=model.clone(),diff=(isMoment(input)||isDate(input)?input.valueOf():createLocal(input).valueOf())-res.valueOf(),res._d.setTime(res._d.valueOf()+diff),hooks.updateOffset(res,!1),res):createLocal(input).local()}function getDateOffset(m){return 15*-Math.round(m._d.getTimezoneOffset()/15)}function isUtc(){return!!this.isValid()&&this._isUTC&&0===this._offset}hooks.updateOffset=function(){};var aspNetRegex=/^(\-|\+)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/,isoRegex=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function createDuration(input,key){var sign,ret,diffRes,base,other,res,duration=input,match=null;return isDuration(input)?duration={ms:input._milliseconds,d:input._days,M:input._months}:isNumber(input)?(duration={},key?duration[key]=input:duration.milliseconds=input):(match=aspNetRegex.exec(input))?(sign="-"===match[1]?-1:1,duration={y:0,d:toInt(match[DATE])*sign,h:toInt(match[HOUR])*sign,m:toInt(match[MINUTE])*sign,s:toInt(match[SECOND])*sign,ms:toInt(absRound(1e3*match[MILLISECOND]))*sign}):(match=isoRegex.exec(input))?(sign="-"===match[1]?-1:(match[1],1),duration={y:parseIso(match[2],sign),M:parseIso(match[3],sign),w:parseIso(match[4],sign),d:parseIso(match[5],sign),h:parseIso(match[6],sign),m:parseIso(match[7],sign),s:parseIso(match[8],sign)}):null==duration?duration={}:"object"==typeof duration&&("from"in duration||"to"in duration)&&(base=createLocal(duration.from),other=createLocal(duration.to),diffRes=base.isValid()&&other.isValid()?(other=cloneWithOffset(other,base),base.isBefore(other)?res=positiveMomentsDifference(base,other):((res=positiveMomentsDifference(other,base)).milliseconds=-res.milliseconds,res.months=-res.months),res):{milliseconds:0,months:0},(duration={}).ms=diffRes.milliseconds,duration.M=diffRes.months),ret=new Duration(duration),isDuration(input)&&hasOwnProp(input,"_locale")&&(ret._locale=input._locale),ret}function parseIso(inp,sign){var res=inp&&parseFloat(inp.replace(",","."));return(isNaN(res)?0:res)*sign}function positiveMomentsDifference(base,other){var res={milliseconds:0,months:0};return res.months=other.month()-base.month()+12*(other.year()-base.year()),base.clone().add(res.months,"M").isAfter(other)&&--res.months,res.milliseconds=+other-+base.clone().add(res.months,"M"),res}function createAdder(direction,name){return function(val,period){var tmp;return null===period||isNaN(+period)||(deprecateSimple(name,"moment()."+name+"(period, number) is deprecated. Please use moment()."+name+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),tmp=val,val=period,period=tmp),addSubtract(this,createDuration(val="string"==typeof val?+val:val,period),direction),this}}function addSubtract(mom,duration,isAdding,updateOffset){var milliseconds=duration._milliseconds,days=absRound(duration._days),months=absRound(duration._months);mom.isValid()&&(updateOffset=null==updateOffset||updateOffset,months&&setMonth(mom,get(mom,"Month")+months*isAdding),days&&set$1(mom,"Date",get(mom,"Date")+days*isAdding),milliseconds&&mom._d.setTime(mom._d.valueOf()+milliseconds*isAdding),updateOffset&&hooks.updateOffset(mom,days||months))}createDuration.fn=Duration.prototype,createDuration.invalid=function(){return createDuration(NaN)};var add=createAdder(1,"add"),subtract=createAdder(-1,"subtract");function monthDiff(a,b){var anchor2,adjust,wholeMonthDiff=12*(b.year()-a.year())+(b.month()-a.month()),anchor=a.clone().add(wholeMonthDiff,"months");return b-anchor<0?(anchor2=a.clone().add(wholeMonthDiff-1,"months"),adjust=(b-anchor)/(anchor-anchor2)):(anchor2=a.clone().add(wholeMonthDiff+1,"months"),adjust=(b-anchor)/(anchor2-anchor)),-(wholeMonthDiff+adjust)||0}function locale(key){var newLocaleData;return void 0===key?this._locale._abbr:(null!=(newLocaleData=getLocale(key))&&(this._locale=newLocaleData),this)}hooks.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",hooks.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var lang=deprecate("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(key){return void 0===key?this.localeData():this.locale(key)});function localeData(){return this._locale}function addWeekYearFormatToken(token,getter){addFormatToken(0,[token,token.length],0,getter)}function getSetWeekYearHelper(input,week,weekday,dow,doy){var weeksTarget;return null==input?weekOfYear(this,dow,doy).year:(weeksTarget=weeksInYear(input,dow,doy),week>weeksTarget&&(week=weeksTarget),function(weekYear,week,weekday,dow,doy){var dayOfYearData=dayOfYearFromWeeks(weekYear,week,weekday,dow,doy),date=createUTCDate(dayOfYearData.year,0,dayOfYearData.dayOfYear);return this.year(date.getUTCFullYear()),this.month(date.getUTCMonth()),this.date(date.getUTCDate()),this}.call(this,input,week,weekday,dow,doy))}addFormatToken(0,["gg",2],0,function(){return this.weekYear()%100}),addFormatToken(0,["GG",2],0,function(){return this.isoWeekYear()%100}),addWeekYearFormatToken("gggg","weekYear"),addWeekYearFormatToken("ggggg","weekYear"),addWeekYearFormatToken("GGGG","isoWeekYear"),addWeekYearFormatToken("GGGGG","isoWeekYear"),addUnitAlias("weekYear","gg"),addUnitAlias("isoWeekYear","GG"),addUnitPriority("weekYear",1),addUnitPriority("isoWeekYear",1),addRegexToken("G",matchSigned),addRegexToken("g",matchSigned),addRegexToken("GG",match1to2,match2),addRegexToken("gg",match1to2,match2),addRegexToken("GGGG",match1to4,match4),addRegexToken("gggg",match1to4,match4),addRegexToken("GGGGG",match1to6,match6),addRegexToken("ggggg",match1to6,match6),addWeekParseToken(["gggg","ggggg","GGGG","GGGGG"],function(input,week,config,token){week[token.substr(0,2)]=toInt(input)}),addWeekParseToken(["gg","GG"],function(input,week,config,token){week[token]=hooks.parseTwoDigitYear(input)}),addFormatToken("Q",0,"Qo","quarter"),addUnitAlias("quarter","Q"),addUnitPriority("quarter",7),addRegexToken("Q",match1),addParseToken("Q",function(input,array){array[MONTH]=3*(toInt(input)-1)}),addFormatToken("D",["DD",2],"Do","date"),addUnitAlias("date","D"),addUnitPriority("date",9),addRegexToken("D",match1to2),addRegexToken("DD",match1to2,match2),addRegexToken("Do",function(isStrict,locale){return isStrict?locale._dayOfMonthOrdinalParse||locale._ordinalParse:locale._dayOfMonthOrdinalParseLenient}),addParseToken(["D","DD"],DATE),addParseToken("Do",function(input,array){array[DATE]=toInt(input.match(match1to2)[0])});var getSetDayOfMonth=makeGetSet("Date",!0);addFormatToken("DDD",["DDDD",3],"DDDo","dayOfYear"),addUnitAlias("dayOfYear","DDD"),addUnitPriority("dayOfYear",4),addRegexToken("DDD",match1to3),addRegexToken("DDDD",match3),addParseToken(["DDD","DDDD"],function(input,array,config){config._dayOfYear=toInt(input)}),addFormatToken("m",["mm",2],0,"minute"),addUnitAlias("minute","m"),addUnitPriority("minute",14),addRegexToken("m",match1to2),addRegexToken("mm",match1to2,match2),addParseToken(["m","mm"],MINUTE);var getSetMinute=makeGetSet("Minutes",!1);addFormatToken("s",["ss",2],0,"second"),addUnitAlias("second","s"),addUnitPriority("second",15),addRegexToken("s",match1to2),addRegexToken("ss",match1to2,match2),addParseToken(["s","ss"],SECOND);var token,getSetSecond=makeGetSet("Seconds",!1);for(addFormatToken("S",0,0,function(){return~~(this.millisecond()/100)}),addFormatToken(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),addFormatToken(0,["SSS",3],0,"millisecond"),addFormatToken(0,["SSSS",4],0,function(){return 10*this.millisecond()}),addFormatToken(0,["SSSSS",5],0,function(){return 100*this.millisecond()}),addFormatToken(0,["SSSSSS",6],0,function(){return 1e3*this.millisecond()}),addFormatToken(0,["SSSSSSS",7],0,function(){return 1e4*this.millisecond()}),addFormatToken(0,["SSSSSSSS",8],0,function(){return 1e5*this.millisecond()}),addFormatToken(0,["SSSSSSSSS",9],0,function(){return 1e6*this.millisecond()}),addUnitAlias("millisecond","ms"),addUnitPriority("millisecond",16),addRegexToken("S",match1to3,match1),addRegexToken("SS",match1to3,match2),addRegexToken("SSS",match1to3,match3),token="SSSS";token.length<=9;token+="S")addRegexToken(token,matchUnsigned);function parseMs(input,array){array[MILLISECOND]=toInt(1e3*("0."+input))}for(token="S";token.length<=9;token+="S")addParseToken(token,parseMs);var getSetMillisecond=makeGetSet("Milliseconds",!1);addFormatToken("z",0,0,"zoneAbbr"),addFormatToken("zz",0,0,"zoneName");var proto=Moment.prototype;function preParsePostFormat(string){return string}proto.add=add,proto.calendar=function(time,formats){var now=time||createLocal(),sod=cloneWithOffset(now,this).startOf("day"),format=hooks.calendarFormat(this,sod)||"sameElse",output=formats&&(isFunction(formats[format])?formats[format].call(this,now):formats[format]);return this.format(output||this.localeData().calendar(format,this,createLocal(now)))},proto.clone=function(){return new Moment(this)},proto.diff=function(input,units,asFloat){var that,zoneDelta,output;if(!this.isValid())return NaN;if(!(that=cloneWithOffset(input,this)).isValid())return NaN;switch(zoneDelta=6e4*(that.utcOffset()-this.utcOffset()),units=normalizeUnits(units)){case"year":output=monthDiff(this,that)/12;break;case"month":output=monthDiff(this,that);break;case"quarter":output=monthDiff(this,that)/3;break;case"second":output=(this-that)/1e3;break;case"minute":output=(this-that)/6e4;break;case"hour":output=(this-that)/36e5;break;case"day":output=(this-that-zoneDelta)/864e5;break;case"week":output=(this-that-zoneDelta)/6048e5;break;default:output=this-that}return asFloat?output:absFloor(output)},proto.endOf=function(units){return void 0===(units=normalizeUnits(units))||"millisecond"===units?this:("date"===units&&(units="day"),this.startOf(units).add(1,"isoWeek"===units?"week":units).subtract(1,"ms"))},proto.format=function(inputString){inputString||(inputString=this.isUtc()?hooks.defaultFormatUtc:hooks.defaultFormat);var output=formatMoment(this,inputString);return this.localeData().postformat(output)},proto.from=function(time,withoutSuffix){return this.isValid()&&(isMoment(time)&&time.isValid()||createLocal(time).isValid())?createDuration({to:this,from:time}).locale(this.locale()).humanize(!withoutSuffix):this.localeData().invalidDate()},proto.fromNow=function(withoutSuffix){return this.from(createLocal(),withoutSuffix)},proto.to=function(time,withoutSuffix){return this.isValid()&&(isMoment(time)&&time.isValid()||createLocal(time).isValid())?createDuration({from:this,to:time}).locale(this.locale()).humanize(!withoutSuffix):this.localeData().invalidDate()},proto.toNow=function(withoutSuffix){return this.to(createLocal(),withoutSuffix)},proto.get=function(units){return isFunction(this[units=normalizeUnits(units)])?this[units]():this},proto.invalidAt=function(){return getParsingFlags(this).overflow},proto.isAfter=function(input,units){var localInput=isMoment(input)?input:createLocal(input);return!(!this.isValid()||!localInput.isValid())&&("millisecond"===(units=normalizeUnits(isUndefined(units)?"millisecond":units))?this.valueOf()>localInput.valueOf():localInput.valueOf()<this.clone().startOf(units).valueOf())},proto.isBefore=function(input,units){var localInput=isMoment(input)?input:createLocal(input);return!(!this.isValid()||!localInput.isValid())&&("millisecond"===(units=normalizeUnits(isUndefined(units)?"millisecond":units))?this.valueOf()<localInput.valueOf():this.clone().endOf(units).valueOf()<localInput.valueOf())},proto.isBetween=function(from,to,units,inclusivity){return("("===(inclusivity=inclusivity||"()")[0]?this.isAfter(from,units):!this.isBefore(from,units))&&(")"===inclusivity[1]?this.isBefore(to,units):!this.isAfter(to,units))},proto.isSame=function(input,units){var inputMs,localInput=isMoment(input)?input:createLocal(input);return!(!this.isValid()||!localInput.isValid())&&("millisecond"===(units=normalizeUnits(units||"millisecond"))?this.valueOf()===localInput.valueOf():(inputMs=localInput.valueOf(),this.clone().startOf(units).valueOf()<=inputMs&&inputMs<=this.clone().endOf(units).valueOf()))},proto.isSameOrAfter=function(input,units){return this.isSame(input,units)||this.isAfter(input,units)},proto.isSameOrBefore=function(input,units){return this.isSame(input,units)||this.isBefore(input,units)},proto.isValid=function(){return isValid(this)},proto.lang=lang,proto.locale=locale,proto.localeData=localeData,proto.max=prototypeMax,proto.min=prototypeMin,proto.parsingFlags=function(){return extend({},getParsingFlags(this))},proto.set=function(units,value){if("object"==typeof units)for(var prioritized=function(unitsObj){var units=[];for(var u in unitsObj)units.push({unit:u,priority:priorities[u]});return units.sort(function(a,b){return a.priority-b.priority}),units}(units=normalizeObjectUnits(units)),i=0;i<prioritized.length;i++)this[prioritized[i].unit](units[prioritized[i].unit]);else if(isFunction(this[units=normalizeUnits(units)]))return this[units](value);return this},proto.startOf=function(units){switch(units=normalizeUnits(units)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":case"date":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===units&&this.weekday(0),"isoWeek"===units&&this.isoWeekday(1),"quarter"===units&&this.month(3*Math.floor(this.month()/3)),this},proto.subtract=subtract,proto.toArray=function(){var m=this;return[m.year(),m.month(),m.date(),m.hour(),m.minute(),m.second(),m.millisecond()]},proto.toObject=function(){var m=this;return{years:m.year(),months:m.month(),date:m.date(),hours:m.hours(),minutes:m.minutes(),seconds:m.seconds(),milliseconds:m.milliseconds()}},proto.toDate=function(){return new Date(this.valueOf())},proto.toISOString=function(keepOffset){if(!this.isValid())return null;var utc=!0!==keepOffset,m=utc?this.clone().utc():this;return m.year()<0||m.year()>9999?formatMoment(m,utc?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):isFunction(Date.prototype.toISOString)?utc?this.toDate().toISOString():new Date(this.valueOf()+60*this.utcOffset()*1e3).toISOString().replace("Z",formatMoment(m,"Z")):formatMoment(m,utc?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")},proto.inspect=function(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var func="moment",zone="";this.isLocal()||(func=0===this.utcOffset()?"moment.utc":"moment.parseZone",zone="Z");var prefix="["+func+'("]',year=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",suffix=zone+'[")]';return this.format(prefix+year+"-MM-DD[T]HH:mm:ss.SSS"+suffix)},proto.toJSON=function(){return this.isValid()?this.toISOString():null},proto.toString=function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},proto.unix=function(){return Math.floor(this.valueOf()/1e3)},proto.valueOf=function(){return this._d.valueOf()-6e4*(this._offset||0)},proto.creationData=function(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}},proto.year=getSetYear,proto.isLeapYear=function(){return isLeapYear(this.year())},proto.weekYear=function(input){return getSetWeekYearHelper.call(this,input,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)},proto.isoWeekYear=function(input){return getSetWeekYearHelper.call(this,input,this.isoWeek(),this.isoWeekday(),1,4)},proto.quarter=proto.quarters=function(input){return null==input?Math.ceil((this.month()+1)/3):this.month(3*(input-1)+this.month()%3)},proto.month=getSetMonth,proto.daysInMonth=function(){return daysInMonth(this.year(),this.month())},proto.week=proto.weeks=function(input){var week=this.localeData().week(this);return null==input?week:this.add(7*(input-week),"d")},proto.isoWeek=proto.isoWeeks=function(input){var week=weekOfYear(this,1,4).week;return null==input?week:this.add(7*(input-week),"d")},proto.weeksInYear=function(){var weekInfo=this.localeData()._week;return weeksInYear(this.year(),weekInfo.dow,weekInfo.doy)},proto.isoWeeksInYear=function(){return weeksInYear(this.year(),1,4)},proto.date=getSetDayOfMonth,proto.day=proto.days=function(input){if(!this.isValid())return null!=input?this:NaN;var day=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=input?(input=function(input,locale){return"string"!=typeof input?input:isNaN(input)?"number"==typeof(input=locale.weekdaysParse(input))?input:null:parseInt(input,10)}(input,this.localeData()),this.add(input-day,"d")):day},proto.weekday=function(input){if(!this.isValid())return null!=input?this:NaN;var weekday=(this.day()+7-this.localeData()._week.dow)%7;return null==input?weekday:this.add(input-weekday,"d")},proto.isoWeekday=function(input){if(!this.isValid())return null!=input?this:NaN;if(null!=input){var weekday=function(input,locale){return"string"==typeof input?locale.weekdaysParse(input)%7||7:isNaN(input)?null:input}(input,this.localeData());return this.day(this.day()%7?weekday:weekday-7)}return this.day()||7},proto.dayOfYear=function(input){var dayOfYear=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==input?dayOfYear:this.add(input-dayOfYear,"d")},proto.hour=proto.hours=getSetHour,proto.minute=proto.minutes=getSetMinute,proto.second=proto.seconds=getSetSecond,proto.millisecond=proto.milliseconds=getSetMillisecond,proto.utcOffset=function(input,keepLocalTime,keepMinutes){var localAdjust,offset=this._offset||0;if(!this.isValid())return null!=input?this:NaN;if(null!=input){if("string"==typeof input){if(null===(input=offsetFromString(matchShortOffset,input)))return this}else Math.abs(input)<16&&!keepMinutes&&(input*=60);return!this._isUTC&&keepLocalTime&&(localAdjust=getDateOffset(this)),this._offset=input,this._isUTC=!0,null!=localAdjust&&this.add(localAdjust,"m"),offset!==input&&(!keepLocalTime||this._changeInProgress?addSubtract(this,createDuration(input-offset,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,hooks.updateOffset(this,!0),this._changeInProgress=null)),this}return this._isUTC?offset:getDateOffset(this)},proto.utc=function(keepLocalTime){return this.utcOffset(0,keepLocalTime)},proto.local=function(keepLocalTime){return this._isUTC&&(this.utcOffset(0,keepLocalTime),this._isUTC=!1,keepLocalTime&&this.subtract(getDateOffset(this),"m")),this},proto.parseZone=function(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"==typeof this._i){var tZone=offsetFromString(matchOffset,this._i);null!=tZone?this.utcOffset(tZone):this.utcOffset(0,!0)}return this},proto.hasAlignedHourOffset=function(input){return!!this.isValid()&&(input=input?createLocal(input).utcOffset():0,(this.utcOffset()-input)%60==0)},proto.isDST=function(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()},proto.isLocal=function(){return!!this.isValid()&&!this._isUTC},proto.isUtcOffset=function(){return!!this.isValid()&&this._isUTC},proto.isUtc=isUtc,proto.isUTC=isUtc,proto.zoneAbbr=function(){return this._isUTC?"UTC":""},proto.zoneName=function(){return this._isUTC?"Coordinated Universal Time":""},proto.dates=deprecate("dates accessor is deprecated. Use date instead.",getSetDayOfMonth),proto.months=deprecate("months accessor is deprecated. Use month instead",getSetMonth),proto.years=deprecate("years accessor is deprecated. Use year instead",getSetYear),proto.zone=deprecate("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",function(input,keepLocalTime){return null!=input?("string"!=typeof input&&(input=-input),this.utcOffset(input,keepLocalTime),this):-this.utcOffset()}),proto.isDSTShifted=deprecate("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",function(){if(!isUndefined(this._isDSTShifted))return this._isDSTShifted;var c={};if(copyConfig(c,this),(c=prepareConfig(c))._a){var other=c._isUTC?createUTC(c._a):createLocal(c._a);this._isDSTShifted=this.isValid()&&compareArrays(c._a,other.toArray())>0}else this._isDSTShifted=!1;return this._isDSTShifted});var proto$1=Locale.prototype;function get$1(format,index,field,setter){var locale=getLocale(),utc=createUTC().set(setter,index);return locale[field](utc,format)}function listMonthsImpl(format,index,field){if(isNumber(format)&&(index=format,format=void 0),format=format||"",null!=index)return get$1(format,index,field,"month");var i,out=[];for(i=0;i<12;i++)out[i]=get$1(format,i,field,"month");return out}function listWeekdaysImpl(localeSorted,format,index,field){"boolean"==typeof localeSorted?(isNumber(format)&&(index=format,format=void 0),format=format||""):(index=format=localeSorted,localeSorted=!1,isNumber(format)&&(index=format,format=void 0),format=format||"");var i,locale=getLocale(),shift=localeSorted?locale._week.dow:0;if(null!=index)return get$1(format,(index+shift)%7,field,"day");var out=[];for(i=0;i<7;i++)out[i]=get$1(format,(i+shift)%7,field,"day");return out}proto$1.calendar=function(key,mom,now){var output=this._calendar[key]||this._calendar.sameElse;return isFunction(output)?output.call(mom,now):output},proto$1.longDateFormat=function(key){var format=this._longDateFormat[key],formatUpper=this._longDateFormat[key.toUpperCase()];return format||!formatUpper?format:(this._longDateFormat[key]=formatUpper.replace(/MMMM|MM|DD|dddd/g,function(val){return val.slice(1)}),this._longDateFormat[key])},proto$1.invalidDate=function(){return this._invalidDate},proto$1.ordinal=function(number){return this._ordinal.replace("%d",number)},proto$1.preparse=preParsePostFormat,proto$1.postformat=preParsePostFormat,proto$1.relativeTime=function(number,withoutSuffix,string,isFuture){var output=this._relativeTime[string];return isFunction(output)?output(number,withoutSuffix,string,isFuture):output.replace(/%d/i,number)},proto$1.pastFuture=function(diff,output){var format=this._relativeTime[diff>0?"future":"past"];return isFunction(format)?format(output):format.replace(/%s/i,output)},proto$1.set=function(config){var prop,i;for(i in config)isFunction(prop=config[i])?this[i]=prop:this["_"+i]=prop;this._config=config,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)},proto$1.months=function(m,format){return m?isArray(this._months)?this._months[m.month()]:this._months[(this._months.isFormat||MONTHS_IN_FORMAT).test(format)?"format":"standalone"][m.month()]:isArray(this._months)?this._months:this._months.standalone},proto$1.monthsShort=function(m,format){return m?isArray(this._monthsShort)?this._monthsShort[m.month()]:this._monthsShort[MONTHS_IN_FORMAT.test(format)?"format":"standalone"][m.month()]:isArray(this._monthsShort)?this._monthsShort:this._monthsShort.standalone},proto$1.monthsParse=function(monthName,format,strict){var i,mom,regex;if(this._monthsParseExact)return function(monthName,format,strict){var i,ii,mom,llc=monthName.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],i=0;i<12;++i)mom=createUTC([2e3,i]),this._shortMonthsParse[i]=this.monthsShort(mom,"").toLocaleLowerCase(),this._longMonthsParse[i]=this.months(mom,"").toLocaleLowerCase();return strict?"MMM"===format?-1!==(ii=indexOf.call(this._shortMonthsParse,llc))?ii:null:-1!==(ii=indexOf.call(this._longMonthsParse,llc))?ii:null:"MMM"===format?-1!==(ii=indexOf.call(this._shortMonthsParse,llc))?ii:-1!==(ii=indexOf.call(this._longMonthsParse,llc))?ii:null:-1!==(ii=indexOf.call(this._longMonthsParse,llc))?ii:-1!==(ii=indexOf.call(this._shortMonthsParse,llc))?ii:null}.call(this,monthName,format,strict);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),i=0;i<12;i++){if(mom=createUTC([2e3,i]),strict&&!this._longMonthsParse[i]&&(this._longMonthsParse[i]=new RegExp("^"+this.months(mom,"").replace(".","")+"$","i"),this._shortMonthsParse[i]=new RegExp("^"+this.monthsShort(mom,"").replace(".","")+"$","i")),strict||this._monthsParse[i]||(regex="^"+this.months(mom,"")+"|^"+this.monthsShort(mom,""),this._monthsParse[i]=new RegExp(regex.replace(".",""),"i")),strict&&"MMMM"===format&&this._longMonthsParse[i].test(monthName))return i;if(strict&&"MMM"===format&&this._shortMonthsParse[i].test(monthName))return i;if(!strict&&this._monthsParse[i].test(monthName))return i}},proto$1.monthsRegex=function(isStrict){return this._monthsParseExact?(hasOwnProp(this,"_monthsRegex")||computeMonthsParse.call(this),isStrict?this._monthsStrictRegex:this._monthsRegex):(hasOwnProp(this,"_monthsRegex")||(this._monthsRegex=defaultMonthsRegex),this._monthsStrictRegex&&isStrict?this._monthsStrictRegex:this._monthsRegex)},proto$1.monthsShortRegex=function(isStrict){return this._monthsParseExact?(hasOwnProp(this,"_monthsRegex")||computeMonthsParse.call(this),isStrict?this._monthsShortStrictRegex:this._monthsShortRegex):(hasOwnProp(this,"_monthsShortRegex")||(this._monthsShortRegex=defaultMonthsShortRegex),this._monthsShortStrictRegex&&isStrict?this._monthsShortStrictRegex:this._monthsShortRegex)},proto$1.week=function(mom){return weekOfYear(mom,this._week.dow,this._week.doy).week},proto$1.firstDayOfYear=function(){return this._week.doy},proto$1.firstDayOfWeek=function(){return this._week.dow},proto$1.weekdays=function(m,format){return m?isArray(this._weekdays)?this._weekdays[m.day()]:this._weekdays[this._weekdays.isFormat.test(format)?"format":"standalone"][m.day()]:isArray(this._weekdays)?this._weekdays:this._weekdays.standalone},proto$1.weekdaysMin=function(m){return m?this._weekdaysMin[m.day()]:this._weekdaysMin},proto$1.weekdaysShort=function(m){return m?this._weekdaysShort[m.day()]:this._weekdaysShort},proto$1.weekdaysParse=function(weekdayName,format,strict){var i,mom,regex;if(this._weekdaysParseExact)return function(weekdayName,format,strict){var i,ii,mom,llc=weekdayName.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],i=0;i<7;++i)mom=createUTC([2e3,1]).day(i),this._minWeekdaysParse[i]=this.weekdaysMin(mom,"").toLocaleLowerCase(),this._shortWeekdaysParse[i]=this.weekdaysShort(mom,"").toLocaleLowerCase(),this._weekdaysParse[i]=this.weekdays(mom,"").toLocaleLowerCase();return strict?"dddd"===format?-1!==(ii=indexOf.call(this._weekdaysParse,llc))?ii:null:"ddd"===format?-1!==(ii=indexOf.call(this._shortWeekdaysParse,llc))?ii:null:-1!==(ii=indexOf.call(this._minWeekdaysParse,llc))?ii:null:"dddd"===format?-1!==(ii=indexOf.call(this._weekdaysParse,llc))?ii:-1!==(ii=indexOf.call(this._shortWeekdaysParse,llc))?ii:-1!==(ii=indexOf.call(this._minWeekdaysParse,llc))?ii:null:"ddd"===format?-1!==(ii=indexOf.call(this._shortWeekdaysParse,llc))?ii:-1!==(ii=indexOf.call(this._weekdaysParse,llc))?ii:-1!==(ii=indexOf.call(this._minWeekdaysParse,llc))?ii:null:-1!==(ii=indexOf.call(this._minWeekdaysParse,llc))?ii:-1!==(ii=indexOf.call(this._weekdaysParse,llc))?ii:-1!==(ii=indexOf.call(this._shortWeekdaysParse,llc))?ii:null}.call(this,weekdayName,format,strict);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),i=0;i<7;i++){if(mom=createUTC([2e3,1]).day(i),strict&&!this._fullWeekdaysParse[i]&&(this._fullWeekdaysParse[i]=new RegExp("^"+this.weekdays(mom,"").replace(".",".?")+"$","i"),this._shortWeekdaysParse[i]=new RegExp("^"+this.weekdaysShort(mom,"").replace(".",".?")+"$","i"),this._minWeekdaysParse[i]=new RegExp("^"+this.weekdaysMin(mom,"").replace(".",".?")+"$","i")),this._weekdaysParse[i]||(regex="^"+this.weekdays(mom,"")+"|^"+this.weekdaysShort(mom,"")+"|^"+this.weekdaysMin(mom,""),this._weekdaysParse[i]=new RegExp(regex.replace(".",""),"i")),strict&&"dddd"===format&&this._fullWeekdaysParse[i].test(weekdayName))return i;if(strict&&"ddd"===format&&this._shortWeekdaysParse[i].test(weekdayName))return i;if(strict&&"dd"===format&&this._minWeekdaysParse[i].test(weekdayName))return i;if(!strict&&this._weekdaysParse[i].test(weekdayName))return i}},proto$1.weekdaysRegex=function(isStrict){return this._weekdaysParseExact?(hasOwnProp(this,"_weekdaysRegex")||computeWeekdaysParse.call(this),isStrict?this._weekdaysStrictRegex:this._weekdaysRegex):(hasOwnProp(this,"_weekdaysRegex")||(this._weekdaysRegex=defaultWeekdaysRegex),this._weekdaysStrictRegex&&isStrict?this._weekdaysStrictRegex:this._weekdaysRegex)},proto$1.weekdaysShortRegex=function(isStrict){return this._weekdaysParseExact?(hasOwnProp(this,"_weekdaysRegex")||computeWeekdaysParse.call(this),isStrict?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(hasOwnProp(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=defaultWeekdaysShortRegex),this._weekdaysShortStrictRegex&&isStrict?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)},proto$1.weekdaysMinRegex=function(isStrict){return this._weekdaysParseExact?(hasOwnProp(this,"_weekdaysRegex")||computeWeekdaysParse.call(this),isStrict?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(hasOwnProp(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=defaultWeekdaysMinRegex),this._weekdaysMinStrictRegex&&isStrict?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)},proto$1.isPM=function(input){return"p"===(input+"").toLowerCase().charAt(0)},proto$1.meridiem=function(hours,minutes,isLower){return hours>11?isLower?"pm":"PM":isLower?"am":"AM"},getSetGlobalLocale("en",{dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(number){var b=number%10,output=1===toInt(number%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th";return number+output}}),hooks.lang=deprecate("moment.lang is deprecated. Use moment.locale instead.",getSetGlobalLocale),hooks.langData=deprecate("moment.langData is deprecated. Use moment.localeData instead.",getLocale);var mathAbs=Math.abs;function addSubtract$1(duration,input,value,direction){var other=createDuration(input,value);return duration._milliseconds+=direction*other._milliseconds,duration._days+=direction*other._days,duration._months+=direction*other._months,duration._bubble()}function absCeil(number){return number<0?Math.floor(number):Math.ceil(number)}function daysToMonths(days){return 4800*days/146097}function monthsToDays(months){return 146097*months/4800}function makeAs(alias){return function(){return this.as(alias)}}var asMilliseconds=makeAs("ms"),asSeconds=makeAs("s"),asMinutes=makeAs("m"),asHours=makeAs("h"),asDays=makeAs("d"),asWeeks=makeAs("w"),asMonths=makeAs("M"),asYears=makeAs("y");function makeGetter(name){return function(){return this.isValid()?this._data[name]:NaN}}var milliseconds=makeGetter("milliseconds"),seconds=makeGetter("seconds"),minutes=makeGetter("minutes"),hours=makeGetter("hours"),days=makeGetter("days"),months=makeGetter("months"),years=makeGetter("years"),round=Math.round,thresholds={ss:44,s:45,m:45,h:22,d:26,M:11},abs$1=Math.abs;function sign(x){return(x>0)-(x<0)||+x}function toISOString$1(){if(!this.isValid())return this.localeData().invalidDate();var minutes,hours,seconds=abs$1(this._milliseconds)/1e3,days=abs$1(this._days),months=abs$1(this._months);minutes=absFloor(seconds/60),hours=absFloor(minutes/60),seconds%=60,minutes%=60;var Y=absFloor(months/12),M=months%=12,D=days,h=hours,m=minutes,s=seconds?seconds.toFixed(3).replace(/\.?0+$/,""):"",total=this.asSeconds();if(!total)return"P0D";var totalSign=total<0?"-":"",ymSign=sign(this._months)!==sign(total)?"-":"",daysSign=sign(this._days)!==sign(total)?"-":"",hmsSign=sign(this._milliseconds)!==sign(total)?"-":"";return totalSign+"P"+(Y?ymSign+Y+"Y":"")+(M?ymSign+M+"M":"")+(D?daysSign+D+"D":"")+(h||m||s?"T":"")+(h?hmsSign+h+"H":"")+(m?hmsSign+m+"M":"")+(s?hmsSign+s+"S":"")}var proto$2=Duration.prototype;return proto$2.isValid=function(){return this._isValid},proto$2.abs=function(){var data=this._data;return this._milliseconds=mathAbs(this._milliseconds),this._days=mathAbs(this._days),this._months=mathAbs(this._months),data.milliseconds=mathAbs(data.milliseconds),data.seconds=mathAbs(data.seconds),data.minutes=mathAbs(data.minutes),data.hours=mathAbs(data.hours),data.months=mathAbs(data.months),data.years=mathAbs(data.years),this},proto$2.add=function(input,value){return addSubtract$1(this,input,value,1)},proto$2.subtract=function(input,value){return addSubtract$1(this,input,value,-1)},proto$2.as=function(units){if(!this.isValid())return NaN;var days,months,milliseconds=this._milliseconds;if("month"===(units=normalizeUnits(units))||"year"===units)return days=this._days+milliseconds/864e5,months=this._months+daysToMonths(days),"month"===units?months:months/12;switch(days=this._days+Math.round(monthsToDays(this._months)),units){case"week":return days/7+milliseconds/6048e5;case"day":return days+milliseconds/864e5;case"hour":return 24*days+milliseconds/36e5;case"minute":return 1440*days+milliseconds/6e4;case"second":return 86400*days+milliseconds/1e3;case"millisecond":return Math.floor(864e5*days)+milliseconds;default:throw new Error("Unknown unit "+units)}},proto$2.asMilliseconds=asMilliseconds,proto$2.asSeconds=asSeconds,proto$2.asMinutes=asMinutes,proto$2.asHours=asHours,proto$2.asDays=asDays,proto$2.asWeeks=asWeeks,proto$2.asMonths=asMonths,proto$2.asYears=asYears,proto$2.valueOf=function(){return this.isValid()?this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*toInt(this._months/12):NaN},proto$2._bubble=function(){var seconds,minutes,hours,years,monthsFromDays,milliseconds=this._milliseconds,days=this._days,months=this._months,data=this._data;return milliseconds>=0&&days>=0&&months>=0||milliseconds<=0&&days<=0&&months<=0||(milliseconds+=864e5*absCeil(monthsToDays(months)+days),days=0,months=0),data.milliseconds=milliseconds%1e3,seconds=absFloor(milliseconds/1e3),data.seconds=seconds%60,minutes=absFloor(seconds/60),data.minutes=minutes%60,hours=absFloor(minutes/60),data.hours=hours%24,days+=absFloor(hours/24),monthsFromDays=absFloor(daysToMonths(days)),months+=monthsFromDays,days-=absCeil(monthsToDays(monthsFromDays)),years=absFloor(months/12),months%=12,data.days=days,data.months=months,data.years=years,this},proto$2.clone=function(){return createDuration(this)},proto$2.get=function(units){return units=normalizeUnits(units),this.isValid()?this[units+"s"]():NaN},proto$2.milliseconds=milliseconds,proto$2.seconds=seconds,proto$2.minutes=minutes,proto$2.hours=hours,proto$2.days=days,proto$2.weeks=function(){return absFloor(this.days()/7)},proto$2.months=months,proto$2.years=years,proto$2.humanize=function(withSuffix){if(!this.isValid())return this.localeData().invalidDate();var locale=this.localeData(),output=function(posNegDuration,withoutSuffix,locale){var duration=createDuration(posNegDuration).abs(),seconds=round(duration.as("s")),minutes=round(duration.as("m")),hours=round(duration.as("h")),days=round(duration.as("d")),months=round(duration.as("M")),years=round(duration.as("y")),a=seconds<=thresholds.ss&&["s",seconds]||seconds<thresholds.s&&["ss",seconds]||minutes<=1&&["m"]||minutes<thresholds.m&&["mm",minutes]||hours<=1&&["h"]||hours<thresholds.h&&["hh",hours]||days<=1&&["d"]||days<thresholds.d&&["dd",days]||months<=1&&["M"]||months<thresholds.M&&["MM",months]||years<=1&&["y"]||["yy",years];return a[2]=withoutSuffix,a[3]=+posNegDuration>0,a[4]=locale,function(string,number,withoutSuffix,isFuture,locale){return locale.relativeTime(number||1,!!withoutSuffix,string,isFuture)}.apply(null,a)}(this,!withSuffix,locale);return withSuffix&&(output=locale.pastFuture(+this,output)),locale.postformat(output)},proto$2.toISOString=toISOString$1,proto$2.toString=toISOString$1,proto$2.toJSON=toISOString$1,proto$2.locale=locale,proto$2.localeData=localeData,proto$2.toIsoString=deprecate("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",toISOString$1),proto$2.lang=lang,addFormatToken("X",0,0,"unix"),addFormatToken("x",0,0,"valueOf"),addRegexToken("x",matchSigned),addRegexToken("X",/[+-]?\d+(\.\d{1,3})?/),addParseToken("X",function(input,array,config){config._d=new Date(1e3*parseFloat(input,10))}),addParseToken("x",function(input,array,config){config._d=new Date(toInt(input))}),hooks.version="2.22.1",hookCallback=createLocal,hooks.fn=proto,hooks.min=function(){return pickBy("isBefore",[].slice.call(arguments,0))},hooks.max=function(){return pickBy("isAfter",[].slice.call(arguments,0))},hooks.now=function(){return Date.now?Date.now():+new Date},hooks.utc=createUTC,hooks.unix=function(input){return createLocal(1e3*input)},hooks.months=function(format,index){return listMonthsImpl(format,index,"months")},hooks.isDate=isDate,hooks.locale=getSetGlobalLocale,hooks.invalid=createInvalid,hooks.duration=createDuration,hooks.isMoment=isMoment,hooks.weekdays=function(localeSorted,format,index){return listWeekdaysImpl(localeSorted,format,index,"weekdays")},hooks.parseZone=function(){return createLocal.apply(null,arguments).parseZone()},hooks.localeData=getLocale,hooks.isDuration=isDuration,hooks.monthsShort=function(format,index){return listMonthsImpl(format,index,"monthsShort")},hooks.weekdaysMin=function(localeSorted,format,index){return listWeekdaysImpl(localeSorted,format,index,"weekdaysMin")},hooks.defineLocale=defineLocale,hooks.updateLocale=function(name,config){if(null!=config){var locale,tmpLocale,parentConfig=baseConfig;null!=(tmpLocale=loadLocale(name))&&(parentConfig=tmpLocale._config),config=mergeConfigs(parentConfig,config),(locale=new Locale(config)).parentLocale=locales[name],locales[name]=locale,getSetGlobalLocale(name)}else null!=locales[name]&&(null!=locales[name].parentLocale?locales[name]=locales[name].parentLocale:null!=locales[name]&&delete locales[name]);return locales[name]},hooks.locales=function(){return keys(locales)},hooks.weekdaysShort=function(localeSorted,format,index){return listWeekdaysImpl(localeSorted,format,index,"weekdaysShort")},hooks.normalizeUnits=normalizeUnits,hooks.relativeTimeRounding=function(roundingFunction){return void 0===roundingFunction?round:"function"==typeof roundingFunction&&(round=roundingFunction,!0)},hooks.relativeTimeThreshold=function(threshold,limit){return void 0!==thresholds[threshold]&&(void 0===limit?thresholds[threshold]:(thresholds[threshold]=limit,"s"===threshold&&(thresholds.ss=limit-1),!0))},hooks.calendarFormat=function(myMoment,now){var diff=myMoment.diff(now,"days",!0);return diff<-6?"sameElse":diff<-1?"lastWeek":diff<0?"lastDay":diff<1?"sameDay":diff<2?"nextDay":diff<7?"nextWeek":"sameElse"},hooks.prototype=proto,hooks.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"YYYY-[W]WW",MONTH:"YYYY-MM"},hooks}()}).call(this,__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/buildin/module.js")(module))},"./node_modules/numeric/numeric-1.2.6.js":function(module,exports,__webpack_require__){"use strict";(function(global){var numeric=exports;void 0!==global&&(global.numeric=numeric),numeric.version="1.2.6",numeric.bench=function(f,interval){var t1,n,i;for(void 0===interval&&(interval=15),n=.5,t1=new Date;;){for(i=n*=2;i>3;i-=4)f(),f(),f(),f();for(;i>0;)f(),i--;if(new Date-t1>interval)break}for(i=n;i>3;i-=4)f(),f(),f(),f();for(;i>0;)f(),i--;return 1e3*(3*n-1)/(new Date-t1)},numeric._myIndexOf=function(w){var k,n=this.length;for(k=0;k<n;++k)if(this[k]===w)return k;return-1},numeric.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:numeric._myIndexOf,numeric.Function=Function,numeric.precision=4,numeric.largeArray=50,numeric.prettyPrint=function(x){var ret=[];return function foo(x){var k;if(void 0===x)return ret.push(Array(numeric.precision+8).join(" ")),!1;if("string"==typeof x)return ret.push('"'+x+'"'),!1;if("boolean"==typeof x)return ret.push(x.toString()),!1;if("number"==typeof x){var a=function fmtnum(x){if(0===x)return"0";if(isNaN(x))return"NaN";if(x<0)return"-"+fmtnum(-x);if(isFinite(x)){var scale=Math.floor(Math.log(x)/Math.log(10)),normalized=x/Math.pow(10,scale),basic=normalized.toPrecision(numeric.precision);return 10===parseFloat(basic)&&(scale++,basic=(normalized=1).toPrecision(numeric.precision)),parseFloat(basic).toString()+"e"+scale.toString()}return"Infinity"}(x),b=x.toPrecision(numeric.precision),c=parseFloat(x.toString()).toString(),d=[a,b,c,parseFloat(b).toString(),parseFloat(c).toString()];for(k=1;k<d.length;k++)d[k].length<a.length&&(a=d[k]);return ret.push(Array(numeric.precision+8-a.length).join(" ")+a),!1}if(null===x)return ret.push("null"),!1;if("function"==typeof x){ret.push(x.toString());var flag=!1;for(k in x)x.hasOwnProperty(k)&&(flag?ret.push(",\n"):ret.push("\n{"),flag=!0,ret.push(k),ret.push(": \n"),foo(x[k]));return flag&&ret.push("}\n"),!0}if(x instanceof Array){if(x.length>numeric.largeArray)return ret.push("...Large Array..."),!0;for(flag=!1,ret.push("["),k=0;k<x.length;k++)k>0&&(ret.push(","),flag&&ret.push("\n ")),flag=foo(x[k]);return ret.push("]"),!0}ret.push("{");flag=!1;for(k in x)x.hasOwnProperty(k)&&(flag&&ret.push(",\n"),flag=!0,ret.push(k),ret.push(": \n"),foo(x[k]));return ret.push("}"),!0}(x),ret.join("")},numeric.parseDate=function(d){return function foo(d){if("string"==typeof d)return Date.parse(d.replace(/-/g,"/"));if(!(d instanceof Array))throw new Error("parseDate: parameter must be arrays of strings");var k,ret=[];for(k=0;k<d.length;k++)ret[k]=foo(d[k]);return ret}(d)},numeric.parseFloat=function(d){return function foo(d){if("string"==typeof d)return parseFloat(d);if(!(d instanceof Array))throw new Error("parseFloat: parameter must be arrays of strings");var k,ret=[];for(k=0;k<d.length;k++)ret[k]=foo(d[k]);return ret}(d)},numeric.parseCSV=function(t){var j,k,n,foo=t.split("\n"),ret=[],pat=/(([^'",]*)|('[^']*')|("[^"]*")),/g,patnum=/^\s*(([+-]?[0-9]+(\.[0-9]*)?(e[+-]?[0-9]+)?)|([+-]?[0-9]*(\.[0-9]+)?(e[+-]?[0-9]+)?))\s*$/,count=0;for(k=0;k<foo.length;k++){var baz,bar=(foo[k]+",").match(pat);if(bar.length>0){for(ret[count]=[],j=0;j<bar.length;j++)baz=(n=bar[j]).substr(0,n.length-1),patnum.test(baz)?ret[count][j]=parseFloat(baz):ret[count][j]=baz;count++}}return ret},numeric.toCSV=function(A){var i,j,m,row,ret,s=numeric.dim(A);for(m=s[0],s[1],ret=[],i=0;i<m;i++){for(row=[],j=0;j<m;j++)row[j]=A[i][j].toString();ret[i]=row.join(", ")}return ret.join("\n")+"\n"},numeric.getURL=function(url){var client=new XMLHttpRequest;return client.open("GET",url,!1),client.send(),client},numeric.imageURL=function(img){function crc32Array(a,from,to){void 0===from&&(from=0),void 0===to&&(to=a.length);var i,table=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],crc=-1;a.length;for(i=from;i<to;i++)crc=crc>>>8^table[255&(crc^a[i])];return-1^crc}var s1,s2,k,length,a,b,i,j,adler32,crc32,h=img[0].length,w=img[0][0].length,stream=[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,w>>24&255,w>>16&255,w>>8&255,255&w,h>>24&255,h>>16&255,h>>8&255,255&h,8,2,0,0,0,-1,-2,-3,-4,-5,-6,-7,-8,73,68,65,84,8,29];for(crc32=crc32Array(stream,12,29),stream[29]=crc32>>24&255,stream[30]=crc32>>16&255,stream[31]=crc32>>8&255,stream[32]=255&crc32,s1=1,s2=0,i=0;i<h;i++){for(i<h-1?stream.push(0):stream.push(1),a=3*w+1+(0===i)&255,b=3*w+1+(0===i)>>8&255,stream.push(a),stream.push(b),stream.push(255&~a),stream.push(255&~b),0===i&&stream.push(0),j=0;j<w;j++)for(k=0;k<3;k++)s2=(s2+(s1=(s1+(a=(a=img[k][i][j])>255?255:a<0?0:Math.round(a)))%65521))%65521,stream.push(a);stream.push(0)}return adler32=(s2<<16)+s1,stream.push(adler32>>24&255),stream.push(adler32>>16&255),stream.push(adler32>>8&255),stream.push(255&adler32),length=stream.length-41,stream[33]=length>>24&255,stream[34]=length>>16&255,stream[35]=length>>8&255,stream[36]=255&length,crc32=crc32Array(stream,37),stream.push(crc32>>24&255),stream.push(crc32>>16&255),stream.push(crc32>>8&255),stream.push(255&crc32),stream.push(0),stream.push(0),stream.push(0),stream.push(0),stream.push(73),stream.push(69),stream.push(78),stream.push(68),stream.push(174),stream.push(66),stream.push(96),stream.push(130),"data:image/png;base64,"+function(A){var i,x,y,z,q,r,s,n=A.length,key="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",ret="";for(i=0;i<n;i+=3)q=((3&(x=A[i]))<<4)+((y=A[i+1])>>4),r=((15&y)<<2)+((z=A[i+2])>>6),s=63&z,i+1>=n?r=s=64:i+2>=n&&(s=64),ret+=key.charAt(x>>2)+key.charAt(q)+key.charAt(r)+key.charAt(s);return ret}(stream)},numeric._dim=function(x){for(var ret=[];"object"==typeof x;)ret.push(x.length),x=x[0];return ret},numeric.dim=function(x){var y;return"object"==typeof x?"object"==typeof(y=x[0])?"object"==typeof y[0]?numeric._dim(x):[x.length,y.length]:[x.length]:[]},numeric.mapreduce=function(body,init){return Function("x","accum","_s","_k",'if(typeof accum === "undefined") accum = '+init+';\nif(typeof x === "number") { var xi = x; '+body+'; return accum; }\nif(typeof _s === "undefined") _s = numeric.dim(x);\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i,xi;\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) {\n        accum = arguments.callee(x[i],accum,_s,_k+1);\n    }    return accum;\n}\nfor(i=_n-1;i>=1;i-=2) { \n    xi = x[i];\n    '+body+";\n    xi = x[i-1];\n    "+body+";\n}\nif(i === 0) {\n    xi = x[i];\n    "+body+"\n}\nreturn accum;")},numeric.mapreduce2=function(body,setup){return Function("x","var n = x.length;\nvar i,xi;\n"+setup+";\nfor(i=n-1;i!==-1;--i) { \n    xi = x[i];\n    "+body+";\n}\nreturn accum;")},numeric.same=function same(x,y){var i,n;if(!(x instanceof Array&&y instanceof Array))return!1;if((n=x.length)!==y.length)return!1;for(i=0;i<n;i++)if(x[i]!==y[i]){if("object"!=typeof x[i])return!1;if(!same(x[i],y[i]))return!1}return!0},numeric.rep=function(s,v,k){void 0===k&&(k=0);var i,n=s[k],ret=Array(n);if(k===s.length-1){for(i=n-2;i>=0;i-=2)ret[i+1]=v,ret[i]=v;return-1===i&&(ret[0]=v),ret}for(i=n-1;i>=0;i--)ret[i]=numeric.rep(s,v,k+1);return ret},numeric.dotMMsmall=function(x,y){var i,j,k,p,q,r,ret,foo,bar,woo,i0;for(p=x.length,q=y.length,r=y[0].length,ret=Array(p),i=p-1;i>=0;i--){for(foo=Array(r),bar=x[i],k=r-1;k>=0;k--){for(woo=bar[q-1]*y[q-1][k],j=q-2;j>=1;j-=2)i0=j-1,woo+=bar[j]*y[j][k]+bar[i0]*y[i0][k];0===j&&(woo+=bar[0]*y[0][k]),foo[k]=woo}ret[i]=foo}return ret},numeric._getCol=function(A,j,x){var i;for(i=A.length-1;i>0;--i)x[i]=A[i][j],x[--i]=A[i][j];0===i&&(x[0]=A[0][j])},numeric.dotMMbig=function(x,y){var xj,i,j,gc=numeric._getCol,p=y.length,v=Array(p),m=x.length,n=y[0].length,A=new Array(m),VV=numeric.dotVV;for(--p,i=--m;-1!==i;--i)A[i]=Array(n);for(i=--n;-1!==i;--i)for(gc(y,i,v),j=m;-1!==j;--j)0,xj=x[j],A[j][i]=VV(xj,v);return A},numeric.dotMV=function(x,y){var i,p=x.length,ret=(y.length,Array(p)),dotVV=numeric.dotVV;for(i=p-1;i>=0;i--)ret[i]=dotVV(x[i],y);return ret},numeric.dotVM=function(x,y){var j,k,p,q,ret,woo,i0;for(p=x.length,q=y[0].length,ret=Array(q),k=q-1;k>=0;k--){for(woo=x[p-1]*y[p-1][k],j=p-2;j>=1;j-=2)i0=j-1,woo+=x[j]*y[j][k]+x[i0]*y[i0][k];0===j&&(woo+=x[0]*y[0][k]),ret[k]=woo}return ret},numeric.dotVV=function(x,y){var i,i1,n=x.length,ret=x[n-1]*y[n-1];for(i=n-2;i>=1;i-=2)i1=i-1,ret+=x[i]*y[i]+x[i1]*y[i1];return 0===i&&(ret+=x[0]*y[0]),ret},numeric.dot=function(x,y){var d=numeric.dim;switch(1e3*d(x).length+d(y).length){case 2002:return y.length<10?numeric.dotMMsmall(x,y):numeric.dotMMbig(x,y);case 2001:return numeric.dotMV(x,y);case 1002:return numeric.dotVM(x,y);case 1001:return numeric.dotVV(x,y);case 1e3:return numeric.mulVS(x,y);case 1:return numeric.mulSV(x,y);case 0:return x*y;default:throw new Error("numeric.dot only works on vectors and matrices")}},numeric.diag=function(d){var i,i1,j,Ai,n=d.length,A=Array(n);for(i=n-1;i>=0;i--){for(Ai=Array(n),i1=i+2,j=n-1;j>=i1;j-=2)Ai[j]=0,Ai[j-1]=0;for(j>i&&(Ai[j]=0),Ai[i]=d[i],j=i-1;j>=1;j-=2)Ai[j]=0,Ai[j-1]=0;0===j&&(Ai[0]=0),A[i]=Ai}return A},numeric.getDiag=function(A){var i,n=Math.min(A.length,A[0].length),ret=Array(n);for(i=n-1;i>=1;--i)ret[i]=A[i][i],ret[--i]=A[i][i];return 0===i&&(ret[0]=A[0][0]),ret},numeric.identity=function(n){return numeric.diag(numeric.rep([n],1))},numeric.pointwise=function(params,body,setup){void 0===setup&&(setup="");var k,p,fun=[],avec=/\[i\]$/,thevec="",haveret=!1;for(k=0;k<params.length;k++)avec.test(params[k])?thevec=p=params[k].substring(0,params[k].length-3):p=params[k],"ret"===p&&(haveret=!0),fun.push(p);return fun[params.length]="_s",fun[params.length+1]="_k",fun[params.length+2]='if(typeof _s === "undefined") _s = numeric.dim('+thevec+');\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i'+(haveret?"":", ret = Array(_n)")+";\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee("+params.join(",")+",_s,_k+1);\n    return ret;\n}\n"+setup+"\nfor(i=_n-1;i!==-1;--i) {\n    "+body+"\n}\nreturn ret;",Function.apply(null,fun)},numeric.pointwise2=function(params,body,setup){void 0===setup&&(setup="");var k,p,fun=[],avec=/\[i\]$/,thevec="",haveret=!1;for(k=0;k<params.length;k++)avec.test(params[k])?thevec=p=params[k].substring(0,params[k].length-3):p=params[k],"ret"===p&&(haveret=!0),fun.push(p);return fun[params.length]="var _n = "+thevec+".length;\nvar i"+(haveret?"":", ret = Array(_n)")+";\n"+setup+"\nfor(i=_n-1;i!==-1;--i) {\n"+body+"\n}\nreturn ret;",Function.apply(null,fun)},numeric._biforeach=function _biforeach(x,y,s,k,f){var i;if(k!==s.length-1)for(i=s[k]-1;i>=0;i--)_biforeach("object"==typeof x?x[i]:x,"object"==typeof y?y[i]:y,s,k+1,f);else f(x,y)},numeric._biforeach2=function _biforeach2(x,y,s,k,f){if(k===s.length-1)return f(x,y);var i,n=s[k],ret=Array(n);for(i=n-1;i>=0;--i)ret[i]=_biforeach2("object"==typeof x?x[i]:x,"object"==typeof y?y[i]:y,s,k+1,f);return ret},numeric._foreach=function _foreach(x,s,k,f){var i;if(k!==s.length-1)for(i=s[k]-1;i>=0;i--)_foreach(x[i],s,k+1,f);else f(x)},numeric._foreach2=function _foreach2(x,s,k,f){if(k===s.length-1)return f(x);var i,n=s[k],ret=Array(n);for(i=n-1;i>=0;i--)ret[i]=_foreach2(x[i],s,k+1,f);return ret},numeric.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"},numeric.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",bandeq:"&=",boreq:"|=",bxoreq:"^="},numeric.mathfuns=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","isNaN","isFinite"],numeric.mathfuns2=["atan2","pow","max","min"],numeric.ops1={neg:"-",not:"!",bnot:"~",clone:""},numeric.mapreducers={any:["if(xi) return true;","var accum = false;"],all:["if(!xi) return false;","var accum = true;"],sum:["accum += xi;","var accum = 0;"],prod:["accum *= xi;","var accum = 1;"],norm2Squared:["accum += xi*xi;","var accum = 0;"],norminf:["accum = max(accum,abs(xi));","var accum = 0, max = Math.max, abs = Math.abs;"],norm1:["accum += abs(xi)","var accum = 0, abs = Math.abs;"],sup:["accum = max(accum,xi);","var accum = -Infinity, max = Math.max;"],inf:["accum = min(accum,xi);","var accum = Infinity, min = Math.min;"]},function(){var i,o;for(i=0;i<numeric.mathfuns2.length;++i)o=numeric.mathfuns2[i],numeric.ops2[o]=o;for(i in numeric.ops2)if(numeric.ops2.hasOwnProperty(i)){o=numeric.ops2[i];var code,codeeq,setup="";-1!==numeric.myIndexOf.call(numeric.mathfuns2,i)?(setup="var "+o+" = Math."+o+";\n",code=function(r,x,y){return r+" = "+o+"("+x+","+y+")"},codeeq=function(x,y){return x+" = "+o+"("+x+","+y+")"}):(code=function(r,x,y){return r+" = "+x+" "+o+" "+y},codeeq=numeric.opseq.hasOwnProperty(i+"eq")?function(x,y){return x+" "+o+"= "+y}:function(x,y){return x+" = "+x+" "+o+" "+y}),numeric[i+"VV"]=numeric.pointwise2(["x[i]","y[i]"],code("ret[i]","x[i]","y[i]"),setup),numeric[i+"SV"]=numeric.pointwise2(["x","y[i]"],code("ret[i]","x","y[i]"),setup),numeric[i+"VS"]=numeric.pointwise2(["x[i]","y"],code("ret[i]","x[i]","y"),setup),numeric[i]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar VV = numeric."+i+"VV, VS = numeric."+i+"VS, SV = numeric."+i+'SV;\nvar dim = numeric.dim;\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof x === "object") {\n      if(typeof y === "object") x = numeric._biforeach2(x,y,dim(x),0,VV);\n      else x = numeric._biforeach2(x,y,dim(x),0,VS);\n  } else if(typeof y === "object") x = numeric._biforeach2(x,y,dim(y),0,SV);\n  else '+codeeq("x","y")+"\n}\nreturn x;\n"),numeric[o]=numeric[i],numeric[i+"eqV"]=numeric.pointwise2(["ret[i]","x[i]"],codeeq("ret[i]","x[i]"),setup),numeric[i+"eqS"]=numeric.pointwise2(["ret[i]","x"],codeeq("ret[i]","x"),setup),numeric[i+"eq"]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar V = numeric."+i+"eqV, S = numeric."+i+'eqS\nvar s = numeric.dim(x);\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof y === "object") numeric._biforeach(x,y,s,0,V);\n  else numeric._biforeach(x,y,s,0,S);\n}\nreturn x;\n')}for(i=0;i<numeric.mathfuns2.length;++i)o=numeric.mathfuns2[i],delete numeric.ops2[o];for(i=0;i<numeric.mathfuns.length;++i)o=numeric.mathfuns[i],numeric.ops1[o]=o;for(i in numeric.ops1)numeric.ops1.hasOwnProperty(i)&&(setup="",o=numeric.ops1[i],-1!==numeric.myIndexOf.call(numeric.mathfuns,i)&&Math.hasOwnProperty(o)&&(setup="var "+o+" = Math."+o+";\n"),numeric[i+"eqV"]=numeric.pointwise2(["ret[i]"],"ret[i] = "+o+"(ret[i]);",setup),numeric[i+"eq"]=Function("x",'if(typeof x !== "object") return '+o+"x\nvar i;\nvar V = numeric."+i+"eqV;\nvar s = numeric.dim(x);\nnumeric._foreach(x,s,0,V);\nreturn x;\n"),numeric[i+"V"]=numeric.pointwise2(["x[i]"],"ret[i] = "+o+"(x[i]);",setup),numeric[i]=Function("x",'if(typeof x !== "object") return '+o+"(x)\nvar i;\nvar V = numeric."+i+"V;\nvar s = numeric.dim(x);\nreturn numeric._foreach2(x,s,0,V);\n"));for(i=0;i<numeric.mathfuns.length;++i)o=numeric.mathfuns[i],delete numeric.ops1[o];for(i in numeric.mapreducers)numeric.mapreducers.hasOwnProperty(i)&&(o=numeric.mapreducers[i],numeric[i+"V"]=numeric.mapreduce2(o[0],o[1]),numeric[i]=Function("x","s","k",o[1]+'if(typeof x !== "object") {    xi = x;\n'+o[0]+';\n    return accum;\n}if(typeof s === "undefined") s = numeric.dim(x);\nif(typeof k === "undefined") k = 0;\nif(k === s.length-1) return numeric.'+i+"V(x);\nvar xi;\nvar n = x.length, i;\nfor(i=n-1;i!==-1;--i) {\n   xi = arguments.callee(x[i]);\n"+o[0]+";\n}\nreturn accum;\n"))}(),numeric.truncVV=numeric.pointwise(["x[i]","y[i]"],"ret[i] = round(x[i]/y[i])*y[i];","var round = Math.round;"),numeric.truncVS=numeric.pointwise(["x[i]","y"],"ret[i] = round(x[i]/y)*y;","var round = Math.round;"),numeric.truncSV=numeric.pointwise(["x","y[i]"],"ret[i] = round(x/y[i])*y[i];","var round = Math.round;"),numeric.trunc=function(x,y){return"object"==typeof x?"object"==typeof y?numeric.truncVV(x,y):numeric.truncVS(x,y):"object"==typeof y?numeric.truncSV(x,y):Math.round(x/y)*y},numeric.inv=function(x){var Ai,Aj,Ii,Ij,i,j,k,s=numeric.dim(x),abs=Math.abs,m=s[0],n=s[1],A=numeric.clone(x),I=numeric.identity(m);for(j=0;j<n;++j){var i0=-1,v0=-1;for(i=j;i!==m;++i)(k=abs(A[i][j]))>v0&&(i0=i,v0=k);for(Aj=A[i0],A[i0]=A[j],A[j]=Aj,Ij=I[i0],I[i0]=I[j],I[j]=Ij,x=Aj[j],k=j;k!==n;++k)Aj[k]/=x;for(k=n-1;-1!==k;--k)Ij[k]/=x;for(i=m-1;-1!==i;--i)if(i!==j){for(Ai=A[i],Ii=I[i],x=Ai[j],k=j+1;k!==n;++k)Ai[k]-=Aj[k]*x;for(k=n-1;k>0;--k)Ii[k]-=Ij[k]*x,Ii[--k]-=Ij[k]*x;0===k&&(Ii[0]-=Ij[0]*x)}}return I},numeric.det=function(x){var s=numeric.dim(x);if(2!==s.length||s[0]!==s[1])throw new Error("numeric: det() only works on square matrices");var i,j,k,Aj,Ai,alpha,temp,k1,n=s[0],ret=1,A=numeric.clone(x);for(j=0;j<n-1;j++){for(k=j,i=j+1;i<n;i++)Math.abs(A[i][j])>Math.abs(A[k][j])&&(k=i);for(k!==j&&(temp=A[k],A[k]=A[j],A[j]=temp,ret*=-1),Aj=A[j],i=j+1;i<n;i++){for(alpha=(Ai=A[i])[j]/Aj[j],k=j+1;k<n-1;k+=2)k1=k+1,Ai[k]-=Aj[k]*alpha,Ai[k1]-=Aj[k1]*alpha;k!==n&&(Ai[k]-=Aj[k]*alpha)}if(0===Aj[j])return 0;ret*=Aj[j]}return ret*A[j][j]},numeric.transpose=function(x){var i,j,A0,A1,Bj,m=x.length,n=x[0].length,ret=Array(n);for(j=0;j<n;j++)ret[j]=Array(m);for(i=m-1;i>=1;i-=2){for(A1=x[i],A0=x[i-1],j=n-1;j>=1;--j)(Bj=ret[j])[i]=A1[j],Bj[i-1]=A0[j],(Bj=ret[--j])[i]=A1[j],Bj[i-1]=A0[j];0===j&&((Bj=ret[0])[i]=A1[0],Bj[i-1]=A0[0])}if(0===i){for(A0=x[0],j=n-1;j>=1;--j)ret[j][0]=A0[j],ret[--j][0]=A0[j];0===j&&(ret[0][0]=A0[0])}return ret},numeric.negtranspose=function(x){var i,j,A0,A1,Bj,m=x.length,n=x[0].length,ret=Array(n);for(j=0;j<n;j++)ret[j]=Array(m);for(i=m-1;i>=1;i-=2){for(A1=x[i],A0=x[i-1],j=n-1;j>=1;--j)(Bj=ret[j])[i]=-A1[j],Bj[i-1]=-A0[j],(Bj=ret[--j])[i]=-A1[j],Bj[i-1]=-A0[j];0===j&&((Bj=ret[0])[i]=-A1[0],Bj[i-1]=-A0[0])}if(0===i){for(A0=x[0],j=n-1;j>=1;--j)ret[j][0]=-A0[j],ret[--j][0]=-A0[j];0===j&&(ret[0][0]=-A0[0])}return ret},numeric._random=function _random(s,k){var i,rnd,n=s[k],ret=Array(n);if(k===s.length-1){for(rnd=Math.random,i=n-1;i>=1;i-=2)ret[i]=rnd(),ret[i-1]=rnd();return 0===i&&(ret[0]=rnd()),ret}for(i=n-1;i>=0;i--)ret[i]=_random(s,k+1);return ret},numeric.random=function(s){return numeric._random(s,0)},numeric.norm2=function(x){return Math.sqrt(numeric.norm2Squared(x))},numeric.linspace=function(a,b,n){if(void 0===n&&(n=Math.max(Math.round(b-a)+1,1)),n<2)return 1===n?[a]:[];var i,ret=Array(n);for(i=--n;i>=0;i--)ret[i]=(i*b+(n-i)*a)/n;return ret},numeric.getBlock=function(x,from,to){var s=numeric.dim(x);return function foo(x,k){var i,a=from[k],n=to[k]-a,ret=Array(n);if(k===s.length-1){for(i=n;i>=0;i--)ret[i]=x[i+a];return ret}for(i=n;i>=0;i--)ret[i]=foo(x[i+a],k+1);return ret}(x,0)},numeric.setBlock=function(x,from,to,B){var s=numeric.dim(x);return function foo(x,y,k){var i,a=from[k],n=to[k]-a;if(k===s.length-1)for(i=n;i>=0;i--)x[i+a]=y[i];for(i=n;i>=0;i--)foo(x[i+a],y[i],k+1)}(x,B,0),x},numeric.getRange=function(A,I,J){var i,j,Bi,AI,m=I.length,n=J.length,B=Array(m);for(i=m-1;-1!==i;--i)for(B[i]=Array(n),Bi=B[i],AI=A[I[i]],j=n-1;-1!==j;--j)Bi[j]=AI[J[j]];return B},numeric.blockMatrix=function(X){var s=numeric.dim(X);if(s.length<4)return numeric.blockMatrix([X]);var M,N,i,j,Xij,m=s[0],n=s[1];for(M=0,N=0,i=0;i<m;++i)M+=X[i][0].length;for(j=0;j<n;++j)N+=X[0][j][0].length;var Z=Array(M);for(i=0;i<M;++i)Z[i]=Array(N);var J,ZI,k,l,Xijk,I=0;for(i=0;i<m;++i){for(J=N,j=n-1;-1!==j;--j)for(J-=(Xij=X[i][j])[0].length,k=Xij.length-1;-1!==k;--k)for(Xijk=Xij[k],ZI=Z[I+k],l=Xijk.length-1;-1!==l;--l)ZI[J+l]=Xijk[l];I+=X[i][0].length}return Z},numeric.tensor=function(x,y){if("number"==typeof x||"number"==typeof y)return numeric.mul(x,y);var s1=numeric.dim(x),s2=numeric.dim(y);if(1!==s1.length||1!==s2.length)throw new Error("numeric: tensor product is only defined for vectors");var Ai,i,j,xi,m=s1[0],n=s2[0],A=Array(m);for(i=m-1;i>=0;i--){for(Ai=Array(n),xi=x[i],j=n-1;j>=3;--j)Ai[j]=xi*y[j],Ai[--j]=xi*y[j],Ai[--j]=xi*y[j],Ai[--j]=xi*y[j];for(;j>=0;)Ai[j]=xi*y[j],--j;A[i]=Ai}return A},numeric.T=function(x,y){this.x=x,this.y=y},numeric.t=function(x,y){return new numeric.T(x,y)},numeric.Tbinop=function(rr,rc,cr,cc,setup){var k;numeric.indexOf;if("string"!=typeof setup)for(k in setup="",numeric)numeric.hasOwnProperty(k)&&(rr.indexOf(k)>=0||rc.indexOf(k)>=0||cr.indexOf(k)>=0||cc.indexOf(k)>=0)&&k.length>1&&(setup+="var "+k+" = numeric."+k+";\n");return Function(["y"],"var x = this;\nif(!(y instanceof numeric.T)) { y = new numeric.T(y); }\n"+setup+"\nif(x.y) {  if(y.y) {    return new numeric.T("+cc+");\n  }\n  return new numeric.T("+cr+");\n}\nif(y.y) {\n  return new numeric.T("+rc+");\n}\nreturn new numeric.T("+rr+");\n")},numeric.T.prototype.add=numeric.Tbinop("add(x.x,y.x)","add(x.x,y.x),y.y","add(x.x,y.x),x.y","add(x.x,y.x),add(x.y,y.y)"),numeric.T.prototype.sub=numeric.Tbinop("sub(x.x,y.x)","sub(x.x,y.x),neg(y.y)","sub(x.x,y.x),x.y","sub(x.x,y.x),sub(x.y,y.y)"),numeric.T.prototype.mul=numeric.Tbinop("mul(x.x,y.x)","mul(x.x,y.x),mul(x.x,y.y)","mul(x.x,y.x),mul(x.y,y.x)","sub(mul(x.x,y.x),mul(x.y,y.y)),add(mul(x.x,y.y),mul(x.y,y.x))"),numeric.T.prototype.reciprocal=function(){var mul=numeric.mul,div=numeric.div;if(this.y){var d=numeric.add(mul(this.x,this.x),mul(this.y,this.y));return new numeric.T(div(this.x,d),div(numeric.neg(this.y),d))}return new T(div(1,this.x))},numeric.T.prototype.div=function(y){if(y instanceof numeric.T||(y=new numeric.T(y)),y.y)return this.mul(y.reciprocal());var div=numeric.div;return this.y?new numeric.T(div(this.x,y.x),div(this.y,y.x)):new numeric.T(div(this.x,y.x))},numeric.T.prototype.dot=numeric.Tbinop("dot(x.x,y.x)","dot(x.x,y.x),dot(x.x,y.y)","dot(x.x,y.x),dot(x.y,y.x)","sub(dot(x.x,y.x),dot(x.y,y.y)),add(dot(x.x,y.y),dot(x.y,y.x))"),numeric.T.prototype.transpose=function(){var t=numeric.transpose,x=this.x,y=this.y;return y?new numeric.T(t(x),t(y)):new numeric.T(t(x))},numeric.T.prototype.transjugate=function(){var t=numeric.transpose,x=this.x,y=this.y;return y?new numeric.T(t(x),numeric.negtranspose(y)):new numeric.T(t(x))},numeric.Tunop=function(r,c,s){return"string"!=typeof s&&(s=""),Function("var x = this;\n"+s+"\nif(x.y) {  "+c+";\n}\n"+r+";\n")},numeric.T.prototype.exp=numeric.Tunop("return new numeric.T(ex)","return new numeric.T(mul(cos(x.y),ex),mul(sin(x.y),ex))","var ex = numeric.exp(x.x), cos = numeric.cos, sin = numeric.sin, mul = numeric.mul;"),numeric.T.prototype.conj=numeric.Tunop("return new numeric.T(x.x);","return new numeric.T(x.x,numeric.neg(x.y));"),numeric.T.prototype.neg=numeric.Tunop("return new numeric.T(neg(x.x));","return new numeric.T(neg(x.x),neg(x.y));","var neg = numeric.neg;"),numeric.T.prototype.sin=numeric.Tunop("return new numeric.T(numeric.sin(x.x))","return x.exp().sub(x.neg().exp()).div(new numeric.T(0,2));"),numeric.T.prototype.cos=numeric.Tunop("return new numeric.T(numeric.cos(x.x))","return x.exp().add(x.neg().exp()).div(2);"),numeric.T.prototype.abs=numeric.Tunop("return new numeric.T(numeric.abs(x.x));","return new numeric.T(numeric.sqrt(numeric.add(mul(x.x,x.x),mul(x.y,x.y))));","var mul = numeric.mul;"),numeric.T.prototype.log=numeric.Tunop("return new numeric.T(numeric.log(x.x));","var theta = new numeric.T(numeric.atan2(x.y,x.x)), r = x.abs();\nreturn new numeric.T(numeric.log(r.x),theta.x);"),numeric.T.prototype.norm2=numeric.Tunop("return numeric.norm2(x.x);","var f = numeric.norm2Squared;\nreturn Math.sqrt(f(x.x)+f(x.y));"),numeric.T.prototype.inv=function(){var A=this;if(void 0===A.y)return new numeric.T(numeric.inv(A.x));var Aix,Aiy,Ajx,Ajy,Rix,Riy,Rjx,Rjy,i,j,k,d,d1,ax,ay,bx,by,temp,n=A.x.length,Rx=numeric.identity(n),Ry=numeric.rep([n,n],0),Ax=numeric.clone(A.x),Ay=numeric.clone(A.y);for(i=0;i<n;i++){for(d=(ax=Ax[i][i])*ax+(ay=Ay[i][i])*ay,k=i,j=i+1;j<n;j++)(d1=(ax=Ax[j][i])*ax+(ay=Ay[j][i])*ay)>d&&(k=j,d=d1);for(k!==i&&(temp=Ax[i],Ax[i]=Ax[k],Ax[k]=temp,temp=Ay[i],Ay[i]=Ay[k],Ay[k]=temp,temp=Rx[i],Rx[i]=Rx[k],Rx[k]=temp,temp=Ry[i],Ry[i]=Ry[k],Ry[k]=temp),Aix=Ax[i],Aiy=Ay[i],Rix=Rx[i],Riy=Ry[i],ax=Aix[i],ay=Aiy[i],j=i+1;j<n;j++)bx=Aix[j],by=Aiy[j],Aix[j]=(bx*ax+by*ay)/d,Aiy[j]=(by*ax-bx*ay)/d;for(j=0;j<n;j++)bx=Rix[j],by=Riy[j],Rix[j]=(bx*ax+by*ay)/d,Riy[j]=(by*ax-bx*ay)/d;for(j=i+1;j<n;j++){for(Ajx=Ax[j],Ajy=Ay[j],Rjx=Rx[j],Rjy=Ry[j],ax=Ajx[i],ay=Ajy[i],k=i+1;k<n;k++)bx=Aix[k],by=Aiy[k],Ajx[k]-=bx*ax-by*ay,Ajy[k]-=by*ax+bx*ay;for(k=0;k<n;k++)bx=Rix[k],by=Riy[k],Rjx[k]-=bx*ax-by*ay,Rjy[k]-=by*ax+bx*ay}}for(i=n-1;i>0;i--)for(Rix=Rx[i],Riy=Ry[i],j=i-1;j>=0;j--)for(Rjx=Rx[j],Rjy=Ry[j],ax=Ax[j][i],ay=Ay[j][i],k=n-1;k>=0;k--)bx=Rix[k],by=Riy[k],Rjx[k]-=ax*bx-ay*by,Rjy[k]-=ax*by+ay*bx;return new numeric.T(Rx,Ry)},numeric.T.prototype.get=function(i){var ik,x=this.x,y=this.y,k=0,n=i.length;if(y){for(;k<n;)x=x[ik=i[k]],y=y[ik],k++;return new numeric.T(x,y)}for(;k<n;)x=x[ik=i[k]],k++;return new numeric.T(x)},numeric.T.prototype.set=function(i,v){var ik,x=this.x,y=this.y,k=0,n=i.length,vx=v.x,vy=v.y;if(0===n)return vy?this.y=vy:y&&(this.y=void 0),this.x=x,this;if(vy){for(y||(y=numeric.rep(numeric.dim(x),0),this.y=y);k<n-1;)x=x[ik=i[k]],y=y[ik],k++;return x[ik=i[k]]=vx,y[ik]=vy,this}if(y){for(;k<n-1;)x=x[ik=i[k]],y=y[ik],k++;return x[ik=i[k]]=vx,vx instanceof Array?y[ik]=numeric.rep(numeric.dim(vx),0):y[ik]=0,this}for(;k<n-1;)x=x[ik=i[k]],k++;return x[ik=i[k]]=vx,this},numeric.T.prototype.getRows=function(i0,i1){var j,ry,n=i1-i0+1,rx=Array(n),x=this.x,y=this.y;for(j=i0;j<=i1;j++)rx[j-i0]=x[j];if(y){for(ry=Array(n),j=i0;j<=i1;j++)ry[j-i0]=y[j];return new numeric.T(rx,ry)}return new numeric.T(rx)},numeric.T.prototype.setRows=function(i0,i1,A){var j,rx=this.x,ry=this.y,x=A.x,y=A.y;for(j=i0;j<=i1;j++)rx[j]=x[j-i0];if(y)for(ry||(ry=numeric.rep(numeric.dim(rx),0),this.y=ry),j=i0;j<=i1;j++)ry[j]=y[j-i0];else if(ry)for(j=i0;j<=i1;j++)ry[j]=numeric.rep([x[j-i0].length],0);return this},numeric.T.prototype.getRow=function(k){var x=this.x,y=this.y;return y?new numeric.T(x[k],y[k]):new numeric.T(x[k])},numeric.T.prototype.setRow=function(i,v){var rx=this.x,ry=this.y,x=v.x,y=v.y;return rx[i]=x,y?(ry||(ry=numeric.rep(numeric.dim(rx),0),this.y=ry),ry[i]=y):ry&&(ry=numeric.rep([x.length],0)),this},numeric.T.prototype.getBlock=function(from,to){var x=this.x,y=this.y,b=numeric.getBlock;return y?new numeric.T(b(x,from,to),b(y,from,to)):new numeric.T(b(x,from,to))},numeric.T.prototype.setBlock=function(from,to,A){A instanceof numeric.T||(A=new numeric.T(A));var x=this.x,y=this.y,b=numeric.setBlock,Ax=A.x,Ay=A.y;if(Ay)return y||(this.y=numeric.rep(numeric.dim(this),0),y=this.y),b(x,from,to,Ax),b(y,from,to,Ay),this;b(x,from,to,Ax),y&&b(y,from,to,numeric.rep(numeric.dim(Ax),0))},numeric.T.rep=function(s,v){var T=numeric.T;v instanceof T||(v=new T(v));var x=v.x,y=v.y,r=numeric.rep;return y?new T(r(s,x),r(s,y)):new T(r(s,x))},numeric.T.diag=function(d){d instanceof numeric.T||(d=new numeric.T(d));var x=d.x,y=d.y,diag=numeric.diag;return y?new numeric.T(diag(x),diag(y)):new numeric.T(diag(x))},numeric.T.eig=function(){if(this.y)throw new Error("eig: not implemented for complex matrices.");return numeric.eig(this.x)},numeric.T.identity=function(n){return new numeric.T(numeric.identity(n))},numeric.T.prototype.getDiag=function(){var n=numeric,x=this.x,y=this.y;return y?new n.T(n.getDiag(x),n.getDiag(y)):new n.T(n.getDiag(x))},numeric.house=function(x){var v=numeric.clone(x),alpha=(x[0]>=0?1:-1)*numeric.norm2(x);v[0]+=alpha;var foo=numeric.norm2(v);if(0===foo)throw new Error("eig: internal error");return numeric.div(v,foo)},numeric.toUpperHessenberg=function(me){var s=numeric.dim(me);if(2!==s.length||s[0]!==s[1])throw new Error("numeric: toUpperHessenberg() only works on square matrices");var i,j,k,x,v,B,C,Ai,Ci,Qi,m=s[0],A=numeric.clone(me),Q=numeric.identity(m);for(j=0;j<m-2;j++){for(x=Array(m-j-1),i=j+1;i<m;i++)x[i-j-1]=A[i][j];if(numeric.norm2(x)>0){for(v=numeric.house(x),B=numeric.getBlock(A,[j+1,j],[m-1,m-1]),C=numeric.tensor(v,numeric.dot(v,B)),i=j+1;i<m;i++)for(Ai=A[i],Ci=C[i-j-1],k=j;k<m;k++)Ai[k]-=2*Ci[k-j];for(B=numeric.getBlock(A,[0,j+1],[m-1,m-1]),C=numeric.tensor(numeric.dot(B,v),v),i=0;i<m;i++)for(Ai=A[i],Ci=C[i],k=j+1;k<m;k++)Ai[k]-=2*Ci[k-j-1];for(B=Array(m-j-1),i=j+1;i<m;i++)B[i-j-1]=Q[i];for(C=numeric.tensor(v,numeric.dot(v,B)),i=j+1;i<m;i++)for(Qi=Q[i],Ci=C[i-j-1],k=0;k<m;k++)Qi[k]-=2*Ci[k]}}return{H:A,Q:Q}},numeric.epsilon=2.220446049250313e-16,numeric.QRFrancis=function(H,maxiter){void 0===maxiter&&(maxiter=1e4),H=numeric.clone(H);numeric.clone(H);var x,v,a,b,c,d,det,tr,Hloc,Qi,Hi,B,C,Ci,i,j,k,iter,m=numeric.dim(H)[0],Q=numeric.identity(m);if(m<3)return{Q:Q,B:[[0,m-1]]};var epsilon=numeric.epsilon;for(iter=0;iter<maxiter;iter++){for(j=0;j<m-1;j++)if(Math.abs(H[j+1][j])<epsilon*(Math.abs(H[j][j])+Math.abs(H[j+1][j+1]))){var QH1=numeric.QRFrancis(numeric.getBlock(H,[0,0],[j,j]),maxiter),QH2=numeric.QRFrancis(numeric.getBlock(H,[j+1,j+1],[m-1,m-1]),maxiter);for(B=Array(j+1),i=0;i<=j;i++)B[i]=Q[i];for(C=numeric.dot(QH1.Q,B),i=0;i<=j;i++)Q[i]=C[i];for(B=Array(m-j-1),i=j+1;i<m;i++)B[i-j-1]=Q[i];for(C=numeric.dot(QH2.Q,B),i=j+1;i<m;i++)Q[i]=C[i-j-1];return{Q:Q,B:QH1.B.concat(numeric.add(QH2.B,j+1))}}var s1,s2,J;if(a=H[m-2][m-2],b=H[m-2][m-1],c=H[m-1][m-2],tr=a+(d=H[m-1][m-1]),det=a*d-b*c,Hloc=numeric.getBlock(H,[0,0],[2,2]),tr*tr>=4*det)s1=.5*(tr+Math.sqrt(tr*tr-4*det)),s2=.5*(tr-Math.sqrt(tr*tr-4*det)),Hloc=numeric.add(numeric.sub(numeric.dot(Hloc,Hloc),numeric.mul(Hloc,s1+s2)),numeric.diag(numeric.rep([3],s1*s2)));else Hloc=numeric.add(numeric.sub(numeric.dot(Hloc,Hloc),numeric.mul(Hloc,tr)),numeric.diag(numeric.rep([3],det)));for(x=[Hloc[0][0],Hloc[1][0],Hloc[2][0]],v=numeric.house(x),B=[H[0],H[1],H[2]],C=numeric.tensor(v,numeric.dot(v,B)),i=0;i<3;i++)for(Hi=H[i],Ci=C[i],k=0;k<m;k++)Hi[k]-=2*Ci[k];for(B=numeric.getBlock(H,[0,0],[m-1,2]),C=numeric.tensor(numeric.dot(B,v),v),i=0;i<m;i++)for(Hi=H[i],Ci=C[i],k=0;k<3;k++)Hi[k]-=2*Ci[k];for(B=[Q[0],Q[1],Q[2]],C=numeric.tensor(v,numeric.dot(v,B)),i=0;i<3;i++)for(Qi=Q[i],Ci=C[i],k=0;k<m;k++)Qi[k]-=2*Ci[k];for(j=0;j<m-2;j++){for(k=j;k<=j+1;k++)if(Math.abs(H[k+1][k])<epsilon*(Math.abs(H[k][k])+Math.abs(H[k+1][k+1]))){QH1=numeric.QRFrancis(numeric.getBlock(H,[0,0],[k,k]),maxiter),QH2=numeric.QRFrancis(numeric.getBlock(H,[k+1,k+1],[m-1,m-1]),maxiter);for(B=Array(k+1),i=0;i<=k;i++)B[i]=Q[i];for(C=numeric.dot(QH1.Q,B),i=0;i<=k;i++)Q[i]=C[i];for(B=Array(m-k-1),i=k+1;i<m;i++)B[i-k-1]=Q[i];for(C=numeric.dot(QH2.Q,B),i=k+1;i<m;i++)Q[i]=C[i-k-1];return{Q:Q,B:QH1.B.concat(numeric.add(QH2.B,k+1))}}for(J=Math.min(m-1,j+3),x=Array(J-j),i=j+1;i<=J;i++)x[i-j-1]=H[i][j];for(v=numeric.house(x),B=numeric.getBlock(H,[j+1,j],[J,m-1]),C=numeric.tensor(v,numeric.dot(v,B)),i=j+1;i<=J;i++)for(Hi=H[i],Ci=C[i-j-1],k=j;k<m;k++)Hi[k]-=2*Ci[k-j];for(B=numeric.getBlock(H,[0,j+1],[m-1,J]),C=numeric.tensor(numeric.dot(B,v),v),i=0;i<m;i++)for(Hi=H[i],Ci=C[i],k=j+1;k<=J;k++)Hi[k]-=2*Ci[k-j-1];for(B=Array(J-j),i=j+1;i<=J;i++)B[i-j-1]=Q[i];for(C=numeric.tensor(v,numeric.dot(v,B)),i=j+1;i<=J;i++)for(Qi=Q[i],Ci=C[i-j-1],k=0;k<m;k++)Qi[k]-=2*Ci[k]}}throw new Error("numeric: eigenvalue iteration does not converge -- increase maxiter?")},numeric.eig=function(A,maxiter){var i,k,Q0,j,a,b,c,d,p1,disc,x,y,p,q,n1,n2,QH=numeric.toUpperHessenberg(A),QB=numeric.QRFrancis(QH.H,maxiter),T=numeric.T,n=A.length,B=QB.B,H=numeric.dot(QB.Q,numeric.dot(QH.H,numeric.transpose(QB.Q))),Q=new T(numeric.dot(QB.Q,QH.Q)),m=B.length,sqrt=Math.sqrt;for(k=0;k<m;k++)if((i=B[k][0])===B[k][1]);else{if(j=i+1,a=H[i][i],b=H[i][j],c=H[j][i],d=H[j][j],0===b&&0===c)continue;(disc=(p1=-a-d)*p1-4*(a*d-b*c))>=0?((n1=(a-(x=p1<0?-.5*(p1-sqrt(disc)):-.5*(p1+sqrt(disc))))*(a-x)+b*b)>(n2=c*c+(d-x)*(d-x))?(p=(a-x)/(n1=sqrt(n1)),q=b/n1):(p=c/(n2=sqrt(n2)),q=(d-x)/n2),Q0=new T([[q,-p],[p,q]]),Q.setRows(i,j,Q0.dot(Q.getRows(i,j)))):(x=-.5*p1,y=.5*sqrt(-disc),(n1=(a-x)*(a-x)+b*b)>(n2=c*c+(d-x)*(d-x))?(p=(a-x)/(n1=sqrt(n1+y*y)),q=b/n1,x=0,y/=n1):(p=c/(n2=sqrt(n2+y*y)),q=(d-x)/n2,x=y/n2,y=0),Q0=new T([[q,-p],[p,q]],[[x,y],[y,-x]]),Q.setRows(i,j,Q0.dot(Q.getRows(i,j))))}var R=Q.dot(A).dot(Q.transjugate()),E=(n=A.length,numeric.T.identity(n));for(j=0;j<n;j++)if(j>0)for(k=j-1;k>=0;k--){var Rk=R.get([k,k]),Rj=R.get([j,j]);numeric.neq(Rk.x,Rj.x)||numeric.neq(Rk.y,Rj.y)?(x=R.getRow(k).getBlock([k],[j-1]),y=E.getRow(j).getBlock([k],[j-1]),E.set([j,k],R.get([k,j]).neg().sub(x.dot(y)).div(Rk.sub(Rj)))):E.setRow(j,E.getRow(k))}for(j=0;j<n;j++)x=E.getRow(j),E.setRow(j,x.div(x.norm2()));return E=E.transpose(),E=Q.transjugate().dot(E),{lambda:R.getDiag(),E:E}},numeric.ccsSparse=function(A){var foo,i,j,m=A.length,counts=[];for(i=m-1;-1!==i;--i)for(j in foo=A[i]){for(j=parseInt(j);j>=counts.length;)counts[counts.length]=0;0!==foo[j]&&counts[j]++}var n=counts.length,Ai=Array(n+1);for(Ai[0]=0,i=0;i<n;++i)Ai[i+1]=Ai[i]+counts[i];var Aj=Array(Ai[n]),Av=Array(Ai[n]);for(i=m-1;-1!==i;--i)for(j in foo=A[i])0!==foo[j]&&(counts[j]--,Aj[Ai[j]+counts[j]]=i,Av[Ai[j]+counts[j]]=foo[j]);return[Ai,Aj,Av]},numeric.ccsFull=function(A){var i,j,j0,j1,Ai=A[0],Aj=A[1],Av=A[2],s=numeric.ccsDim(A),m=s[0],n=s[1],B=numeric.rep([m,n],0);for(i=0;i<n;i++)for(j0=Ai[i],j1=Ai[i+1],j=j0;j<j1;++j)B[Aj[j]][i]=Av[j];return B},numeric.ccsTSolve=function(A,b,x,bj,xj){var i,j,j0,j1,k,l,a,Ai=A[0],Aj=A[1],Av=A[2],m=Ai.length-1,max=Math.max,n=0;function dfs(j){var k;if(0===x[j]){for(x[j]=1,k=Ai[j];k<Ai[j+1];++k)dfs(Aj[k]);xj[n]=j,++n}}for(void 0===bj&&(x=numeric.rep([m],0)),void 0===bj&&(bj=numeric.linspace(0,x.length-1)),void 0===xj&&(xj=[]),i=bj.length-1;-1!==i;--i)dfs(bj[i]);for(xj.length=n,i=xj.length-1;-1!==i;--i)x[xj[i]]=0;for(i=bj.length-1;-1!==i;--i)j=bj[i],x[j]=b[j];for(i=xj.length-1;-1!==i;--i){for(j=xj[i],j0=Ai[j],j1=max(Ai[j+1],j0),k=j0;k!==j1;++k)if(Aj[k]===j){x[j]/=Av[k];break}for(a=x[j],k=j0;k!==j1;++k)(l=Aj[k])!==j&&(x[l]-=a*Av[k])}return x},numeric.ccsDFS=function(n){this.k=Array(n),this.k1=Array(n),this.j=Array(n)},numeric.ccsDFS.prototype.dfs=function(J,Ai,Aj,x,xj,Pinv){var foo,km,k11,m=0,n=xj.length,k=this.k,k1=this.k1,j=this.j;if(0===x[J])for(x[J]=1,j[0]=J,k[0]=km=Ai[J],k1[0]=k11=Ai[J+1];;)if(km>=k11){if(xj[n]=j[m],0===m)return;++n,km=k[--m],k11=k1[m]}else 0===x[foo=Pinv[Aj[km]]]?(x[foo]=1,k[m]=km,j[++m]=foo,km=Ai[foo],k1[m]=k11=Ai[foo+1]):++km},numeric.ccsLPSolve=function(A,B,x,xj,I,Pinv,dfs){var i,i0,i1,j,j0,j1,k,l,a,Ai=A[0],Aj=A[1],Av=A[2],Bi=(Ai.length,B[0]),Bj=B[1],Bv=B[2];for(i0=Bi[I],i1=Bi[I+1],xj.length=0,i=i0;i<i1;++i)dfs.dfs(Pinv[Bj[i]],Ai,Aj,x,xj,Pinv);for(i=xj.length-1;-1!==i;--i)x[xj[i]]=0;for(i=i0;i!==i1;++i)x[j=Pinv[Bj[i]]]=Bv[i];for(i=xj.length-1;-1!==i;--i){for(j0=Ai[j=xj[i]],j1=Ai[j+1],k=j0;k<j1;++k)if(Pinv[Aj[k]]===j){x[j]/=Av[k];break}for(a=x[j],k=j0;k<j1;++k)(l=Pinv[Aj[k]])!==j&&(x[l]-=a*Av[k])}return x},numeric.ccsLUP1=function(A,threshold){var i,j,k,a,e,c,d,m=A[0].length-1,L=[numeric.rep([m+1],0),[],[]],U=[numeric.rep([m+1],0),[],[]],Li=L[0],Lj=L[1],Lv=L[2],Ui=U[0],Uj=U[1],Uv=U[2],x=numeric.rep([m],0),xj=numeric.rep([m],0),sol=numeric.ccsLPSolve,abs=(Math.max,Math.abs),P=numeric.linspace(0,m-1),Pinv=numeric.linspace(0,m-1),dfs=new numeric.ccsDFS(m);for(void 0===threshold&&(threshold=1),i=0;i<m;++i){for(sol(L,A,x,xj,i,Pinv,dfs),a=-1,e=-1,j=xj.length-1;-1!==j;--j)(k=xj[j])<=i||(c=abs(x[k]))>a&&(e=k,a=c);for(abs(x[i])<threshold*a&&(j=P[i],a=P[e],P[i]=a,Pinv[a]=i,P[e]=j,Pinv[j]=e,a=x[i],x[i]=x[e],x[e]=a),a=Li[i],e=Ui[i],d=x[i],Lj[a]=P[i],Lv[a]=1,++a,j=xj.length-1;-1!==j;--j)c=x[k=xj[j]],xj[j]=0,x[k]=0,k<=i?(Uj[e]=k,Uv[e]=c,++e):(Lj[a]=P[k],Lv[a]=c/d,++a);Li[i+1]=a,Ui[i+1]=e}for(j=Lj.length-1;-1!==j;--j)Lj[j]=Pinv[Lj[j]];return{L:L,U:U,P:P,Pinv:Pinv}},numeric.ccsDFS0=function(n){this.k=Array(n),this.k1=Array(n),this.j=Array(n)},numeric.ccsDFS0.prototype.dfs=function(J,Ai,Aj,x,xj,Pinv,P){var foo,km,k11,m=0,n=xj.length,k=this.k,k1=this.k1,j=this.j;if(0===x[J])for(x[J]=1,j[0]=J,k[0]=km=Ai[Pinv[J]],k1[0]=k11=Ai[Pinv[J]+1];;){if(isNaN(km))throw new Error("Ow!");if(km>=k11){if(xj[n]=Pinv[j[m]],0===m)return;++n,km=k[--m],k11=k1[m]}else 0===x[foo=Aj[km]]?(x[foo]=1,k[m]=km,j[++m]=foo,km=Ai[foo=Pinv[foo]],k1[m]=k11=Ai[foo+1]):++km}},numeric.ccsLPSolve0=function(A,B,y,xj,I,Pinv,P,dfs){var i,i0,i1,j,j0,j1,k,l,a,Ai=A[0],Aj=A[1],Av=A[2],Bi=(Ai.length,B[0]),Bj=B[1],Bv=B[2];for(i0=Bi[I],i1=Bi[I+1],xj.length=0,i=i0;i<i1;++i)dfs.dfs(Bj[i],Ai,Aj,y,xj,Pinv,P);for(i=xj.length-1;-1!==i;--i)y[P[j=xj[i]]]=0;for(i=i0;i!==i1;++i)y[j=Bj[i]]=Bv[i];for(i=xj.length-1;-1!==i;--i){for(l=P[j=xj[i]],j0=Ai[j],j1=Ai[j+1],k=j0;k<j1;++k)if(Aj[k]===l){y[l]/=Av[k];break}for(a=y[l],k=j0;k<j1;++k)y[Aj[k]]-=a*Av[k];y[l]=a}},numeric.ccsLUP0=function(A,threshold){var i,j,k,a,e,c,d,m=A[0].length-1,L=[numeric.rep([m+1],0),[],[]],U=[numeric.rep([m+1],0),[],[]],Li=L[0],Lj=L[1],Lv=L[2],Ui=U[0],Uj=U[1],Uv=U[2],y=numeric.rep([m],0),xj=numeric.rep([m],0),sol=numeric.ccsLPSolve0,abs=(Math.max,Math.abs),P=numeric.linspace(0,m-1),Pinv=numeric.linspace(0,m-1),dfs=new numeric.ccsDFS0(m);for(void 0===threshold&&(threshold=1),i=0;i<m;++i){for(sol(L,A,y,xj,i,Pinv,P,dfs),a=-1,e=-1,j=xj.length-1;-1!==j;--j)(k=xj[j])<=i||(c=abs(y[P[k]]))>a&&(e=k,a=c);for(abs(y[P[i]])<threshold*a&&(j=P[i],a=P[e],P[i]=a,Pinv[a]=i,P[e]=j,Pinv[j]=e),a=Li[i],e=Ui[i],d=y[P[i]],Lj[a]=P[i],Lv[a]=1,++a,j=xj.length-1;-1!==j;--j)c=y[P[k=xj[j]]],xj[j]=0,y[P[k]]=0,k<=i?(Uj[e]=k,Uv[e]=c,++e):(Lj[a]=P[k],Lv[a]=c/d,++a);Li[i+1]=a,Ui[i+1]=e}for(j=Lj.length-1;-1!==j;--j)Lj[j]=Pinv[Lj[j]];return{L:L,U:U,P:P,Pinv:Pinv}},numeric.ccsLUP=numeric.ccsLUP0,numeric.ccsDim=function(A){return[numeric.sup(A[1])+1,A[0].length-1]},numeric.ccsGetBlock=function(A,i,j){var s=numeric.ccsDim(A),m=s[0],n=s[1];void 0===i?i=numeric.linspace(0,m-1):"number"==typeof i&&(i=[i]),void 0===j?j=numeric.linspace(0,n-1):"number"==typeof j&&(j=[j]);var p,q,r,jq,P=i.length,Q=j.length,Bi=numeric.rep([n],0),Bj=[],Bv=[],B=[Bi,Bj,Bv],Ai=A[0],Aj=A[1],Av=A[2],x=numeric.rep([m],0),count=0,flags=numeric.rep([m],0);for(q=0;q<Q;++q){var q0=Ai[jq=j[q]],q1=Ai[jq+1];for(p=q0;p<q1;++p)flags[r=Aj[p]]=1,x[r]=Av[p];for(p=0;p<P;++p)flags[i[p]]&&(Bj[count]=p,Bv[count]=x[i[p]],++count);for(p=q0;p<q1;++p)flags[r=Aj[p]]=0;Bi[q+1]=count}return B},numeric.ccsDot=function(A,B){var i,j,k,j0,j1,i0,i1,l,p,a,b,Ai=A[0],Aj=A[1],Av=A[2],Bi=B[0],Bj=B[1],Bv=B[2],sA=numeric.ccsDim(A),sB=numeric.ccsDim(B),m=sA[0],o=(sA[1],sB[1]),x=numeric.rep([m],0),flags=numeric.rep([m],0),xj=Array(m),Ci=numeric.rep([o],0),Cj=[],Cv=[],C=[Ci,Cj,Cv];for(k=0;k!==o;++k){for(j0=Bi[k],j1=Bi[k+1],p=0,j=j0;j<j1;++j)for(a=Bj[j],b=Bv[j],i0=Ai[a],i1=Ai[a+1],i=i0;i<i1;++i)0===flags[l=Aj[i]]&&(xj[p]=l,flags[l]=1,p+=1),x[l]=x[l]+Av[i]*b;for(j1=(j0=Ci[k])+p,Ci[k+1]=j1,j=p-1;-1!==j;--j)b=j0+j,i=xj[j],Cj[b]=i,Cv[b]=x[i],flags[i]=0,x[i]=0;Ci[k+1]=Ci[k]+p}return C},numeric.ccsLUPSolve=function(LUP,B){var L=LUP.L,U=LUP.U,Bi=(LUP.P,B[0]),flag=!1;"object"!=typeof Bi&&(Bi=(B=[[0,B.length],numeric.linspace(0,B.length-1),B])[0],flag=!0);var i,j,j0,j1,k,J,Bj=B[1],Bv=B[2],n=L[0].length-1,m=Bi.length-1,x=numeric.rep([n],0),xj=Array(n),b=numeric.rep([n],0),bj=Array(n),Xi=numeric.rep([m+1],0),Xj=[],Xv=[],sol=numeric.ccsTSolve,N=0;for(i=0;i<m;++i){for(k=0,j0=Bi[i],j1=Bi[i+1],j=j0;j<j1;++j)J=LUP.Pinv[Bj[j]],bj[k]=J,b[J]=Bv[j],++k;for(bj.length=k,sol(L,b,x,bj,xj),j=bj.length-1;-1!==j;--j)b[bj[j]]=0;if(sol(U,x,b,xj,bj),flag)return b;for(j=xj.length-1;-1!==j;--j)x[xj[j]]=0;for(j=bj.length-1;-1!==j;--j)J=bj[j],Xj[N]=J,Xv[N]=b[J],b[J]=0,++N;Xi[i+1]=N}return[Xi,Xj,Xv]},numeric.ccsbinop=function(body,setup){return void 0===setup&&(setup=""),Function("X","Y","var Xi = X[0], Xj = X[1], Xv = X[2];\nvar Yi = Y[0], Yj = Y[1], Yv = Y[2];\nvar n = Xi.length-1,m = Math.max(numeric.sup(Xj),numeric.sup(Yj))+1;\nvar Zi = numeric.rep([n+1],0), Zj = [], Zv = [];\nvar x = numeric.rep([m],0),y = numeric.rep([m],0);\nvar xk,yk,zk;\nvar i,j,j0,j1,k,p=0;\n"+setup+"for(i=0;i<n;++i) {\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Xj[j];\n    x[k] = 1;\n    Zj[p] = k;\n    ++p;\n  }\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Yj[j];\n    y[k] = Yv[j];\n    if(x[k] === 0) {\n      Zj[p] = k;\n      ++p;\n    }\n  }\n  Zi[i+1] = p;\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = Xv[j];\n  j0 = Zi[i]; j1 = Zi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Zj[j];\n    xk = x[k];\n    yk = y[k];\n"+body+"\n    Zv[j] = zk;\n  }\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = 0;\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) y[Yj[j]] = 0;\n}\nreturn [Zi,Zj,Zv];")},function(){var k,A,B,C;for(k in numeric.ops2)A=isFinite(eval("1"+numeric.ops2[k]+"0"))?"[Y[0],Y[1],numeric."+k+"(X,Y[2])]":"NaN",B=isFinite(eval("0"+numeric.ops2[k]+"1"))?"[X[0],X[1],numeric."+k+"(X[2],Y)]":"NaN",C=isFinite(eval("1"+numeric.ops2[k]+"0"))&&isFinite(eval("0"+numeric.ops2[k]+"1"))?"numeric.ccs"+k+"MM(X,Y)":"NaN",numeric["ccs"+k+"MM"]=numeric.ccsbinop("zk = xk "+numeric.ops2[k]+"yk;"),numeric["ccs"+k]=Function("X","Y",'if(typeof X === "number") return '+A+';\nif(typeof Y === "number") return '+B+";\nreturn "+C+";\n")}(),numeric.ccsScatter=function(A){var i,Ai=A[0],Aj=A[1],Av=A[2],n=numeric.sup(Aj)+1,m=Ai.length,Ri=numeric.rep([n],0),Rj=Array(m),Rv=Array(m),counts=numeric.rep([n],0);for(i=0;i<m;++i)counts[Aj[i]]++;for(i=0;i<n;++i)Ri[i+1]=Ri[i]+counts[i];var k,Aii,ptr=Ri.slice(0);for(i=0;i<m;++i)Rj[k=ptr[Aii=Aj[i]]]=Ai[i],Rv[k]=Av[i],ptr[Aii]=ptr[Aii]+1;return[Ri,Rj,Rv]},numeric.ccsGather=function(A){var i,j,j0,j1,p,Ai=A[0],Aj=A[1],Av=A[2],n=Ai.length-1,m=Aj.length,Ri=Array(m),Rj=Array(m),Rv=Array(m);for(p=0,i=0;i<n;++i)for(j0=Ai[i],j1=Ai[i+1],j=j0;j!==j1;++j)Rj[p]=i,Ri[p]=Aj[j],Rv[p]=Av[j],++p;return[Ri,Rj,Rv]},numeric.sdim=function dim(A,ret,k){if(void 0===ret&&(ret=[]),"object"!=typeof A)return ret;var i;for(i in void 0===k&&(k=0),k in ret||(ret[k]=0),A.length>ret[k]&&(ret[k]=A.length),A)A.hasOwnProperty(i)&&dim(A[i],ret,k+1);return ret},numeric.sclone=function clone(A,k,n){void 0===k&&(k=0),void 0===n&&(n=numeric.sdim(A).length);var i,ret=Array(A.length);if(k===n-1){for(i in A)A.hasOwnProperty(i)&&(ret[i]=A[i]);return ret}for(i in A)A.hasOwnProperty(i)&&(ret[i]=clone(A[i],k+1,n));return ret},numeric.sdiag=function(d){var i,i1,n=d.length,ret=Array(n);for(i=n-1;i>=1;i-=2)i1=i-1,ret[i]=[],ret[i][i]=d[i],ret[i1]=[],ret[i1][i1]=d[i1];return 0===i&&(ret[0]=[],ret[0][0]=d[i]),ret},numeric.sidentity=function(n){return numeric.sdiag(numeric.rep([n],1))},numeric.stranspose=function(A){var i,j,Ai,ret=[];A.length;for(i in A)if(A.hasOwnProperty(i))for(j in Ai=A[i])Ai.hasOwnProperty(j)&&("object"!=typeof ret[j]&&(ret[j]=[]),ret[j][i]=Ai[j]);return ret},numeric.sLUP=function(A,tol){throw new Error("The function numeric.sLUP had a bug in it and has been removed. Please use the new numeric.ccsLUP function instead.")},numeric.sdotMM=function(A,B){var Ai,BTk,i,j,k,accum,reti,p=A.length,BT=(B.length,numeric.stranspose(B)),r=BT.length,ret=Array(p);for(i=p-1;i>=0;i--){for(reti=[],Ai=A[i],k=r-1;k>=0;k--){for(j in accum=0,BTk=BT[k],Ai)Ai.hasOwnProperty(j)&&j in BTk&&(accum+=Ai[j]*BTk[j]);accum&&(reti[k]=accum)}ret[i]=reti}return ret},numeric.sdotMV=function(A,x){var Ai,i,j,accum,p=A.length,ret=Array(p);for(i=p-1;i>=0;i--){for(j in accum=0,Ai=A[i])Ai.hasOwnProperty(j)&&x[j]&&(accum+=Ai[j]*x[j]);accum&&(ret[i]=accum)}return ret},numeric.sdotVM=function(x,A){var i,j,Ai,alpha,ret=[];for(i in x)if(x.hasOwnProperty(i))for(j in Ai=A[i],alpha=x[i],Ai)Ai.hasOwnProperty(j)&&(ret[j]||(ret[j]=0),ret[j]+=alpha*Ai[j]);return ret},numeric.sdotVV=function(x,y){var i,ret=0;for(i in x)x[i]&&y[i]&&(ret+=x[i]*y[i]);return ret},numeric.sdot=function(A,B){var m=numeric.sdim(A).length,n=numeric.sdim(B).length;switch(1e3*m+n){case 0:return A*B;case 1001:return numeric.sdotVV(A,B);case 2001:return numeric.sdotMV(A,B);case 1002:return numeric.sdotVM(A,B);case 2002:return numeric.sdotMM(A,B);default:throw new Error("numeric.sdot not implemented for tensors of order "+m+" and "+n)}},numeric.sscatter=function(V){var Vij,i,j,Aj,n=V[0].length,m=V.length,A=[];for(i=n-1;i>=0;--i)if(V[m-1][i]){for(Aj=A,j=0;j<m-2;j++)Aj[Vij=V[j][i]]||(Aj[Vij]=[]),Aj=Aj[Vij];Aj[V[j][i]]=V[j+1][i]}return A},numeric.sgather=function gather(A,ret,k){var n,i,Ai;for(i in void 0===ret&&(ret=[]),void 0===k&&(k=[]),n=k.length,A)if(A.hasOwnProperty(i))if(k[n]=parseInt(i),"number"==typeof(Ai=A[i])){if(Ai){if(0===ret.length)for(i=n+1;i>=0;--i)ret[i]=[];for(i=n;i>=0;--i)ret[i].push(k[i]);ret[n+1].push(Ai)}}else gather(Ai,ret,k);return k.length>n&&k.pop(),ret},numeric.cLU=function(A){var i,j,k,a,b,c,I=A[0],J=A[1],V=A[2],p=I.length,m=0;for(i=0;i<p;i++)I[i]>m&&(m=I[i]);m++;var alpha,L=Array(m),U=Array(m),left=numeric.rep([m],1/0),right=numeric.rep([m],-1/0);for(k=0;k<p;k++)i=I[k],(j=J[k])<left[i]&&(left[i]=j),j>right[i]&&(right[i]=j);for(i=0;i<m-1;i++)right[i]>right[i+1]&&(right[i+1]=right[i]);for(i=m-1;i>=1;i--)left[i]<left[i-1]&&(left[i-1]=left[i]);for(i=0;i<m;i++)U[i]=numeric.rep([right[i]-left[i]+1],0),L[i]=numeric.rep([i-left[i]],0),i-left[i]+1,right[i]-i+1;for(k=0;k<p;k++)U[i=I[k]][J[k]-left[i]]=V[k];for(i=0;i<m-1;i++)for(a=i-left[i],Ui=U[i],j=i+1;left[j]<=i&&j<m;j++)if(b=i-left[j],c=right[i]-i,alpha=(Uj=U[j])[b]/Ui[a]){for(k=1;k<=c;k++)Uj[k+b]-=alpha*Ui[k+a];L[j][i-left[j]]=alpha}var q,foo,Ui=[],Uj=[],Uv=[],Li=[],Lj=[],Lv=[];for(p=0,q=0,i=0;i<m;i++){for(a=left[i],b=right[i],foo=U[i],j=i;j<=b;j++)foo[j-a]&&(Ui[p]=i,Uj[p]=j,Uv[p]=foo[j-a],p++);for(foo=L[i],j=a;j<i;j++)foo[j-a]&&(Li[q]=i,Lj[q]=j,Lv[q]=foo[j-a],q++);Li[q]=i,Lj[q]=i,Lv[q]=1,q++}return{U:[Ui,Uj,Uv],L:[Li,Lj,Lv]}},numeric.cLUsolve=function(lu,b){var i,k,L=lu.L,U=lu.U,ret=numeric.clone(b),Li=L[0],Lj=L[1],Lv=L[2],Ui=U[0],Uj=U[1],Uv=U[2],p=Ui.length,m=(Li.length,ret.length);for(k=0,i=0;i<m;i++){for(;Lj[k]<i;)ret[i]-=Lv[k]*ret[Lj[k]],k++;k++}for(k=p-1,i=m-1;i>=0;i--){for(;Uj[k]>i;)ret[i]-=Uv[k]*ret[Uj[k]],k--;ret[i]/=Uv[k],k--}return ret},numeric.cgrid=function(n,shape){"number"==typeof n&&(n=[n,n]);var i,j,count,ret=numeric.rep(n,-1);if("function"!=typeof shape)switch(shape){case"L":shape=function(i,j){return i>=n[0]/2||j<n[1]/2};break;default:shape=function(i,j){return!0}}for(count=0,i=1;i<n[0]-1;i++)for(j=1;j<n[1]-1;j++)shape(i,j)&&(ret[i][j]=count,count++);return ret},numeric.cdelsq=function(g){var i,j,k,p,q,dir=[[-1,0],[0,-1],[0,1],[1,0]],s=numeric.dim(g),m=s[0],n=s[1],Li=[],Lj=[],Lv=[];for(i=1;i<m-1;i++)for(j=1;j<n-1;j++)if(!(g[i][j]<0)){for(k=0;k<4;k++)p=i+dir[k][0],q=j+dir[k][1],g[p][q]<0||(Li.push(g[i][j]),Lj.push(g[p][q]),Lv.push(-1));Li.push(g[i][j]),Lj.push(g[i][j]),Lv.push(4)}return[Li,Lj,Lv]},numeric.cdotMV=function(A,x){var ret,k,N,Ai=A[0],Aj=A[1],Av=A[2],p=Ai.length;for(N=0,k=0;k<p;k++)Ai[k]>N&&(N=Ai[k]);for(N++,ret=numeric.rep([N],0),k=0;k<p;k++)ret[Ai[k]]+=Av[k]*x[Aj[k]];return ret},numeric.Spline=function(x,yl,yr,kl,kr){this.x=x,this.yl=yl,this.yr=yr,this.kl=kl,this.kr=kr},numeric.Spline.prototype._at=function(x1,p){var a,b,t,x=this.x,yl=this.yl,yr=this.yr,kl=this.kl,kr=this.kr,add=numeric.add,sub=numeric.sub,mul=numeric.mul;a=sub(mul(kl[p],x[p+1]-x[p]),sub(yr[p+1],yl[p])),b=add(mul(kr[p+1],x[p]-x[p+1]),sub(yr[p+1],yl[p]));var s=(t=(x1-x[p])/(x[p+1]-x[p]))*(1-t);return add(add(add(mul(1-t,yl[p]),mul(t,yr[p+1])),mul(a,s*(1-t))),mul(b,s*t))},numeric.Spline.prototype.at=function(x0){if("number"==typeof x0){var p,q,mid,x=this.x,n=x.length,floor=Math.floor;for(p=0,q=n-1;q-p>1;)x[mid=floor((p+q)/2)]<=x0?p=mid:q=mid;return this._at(x0,p)}n=x0.length;var i,ret=Array(n);for(i=n-1;-1!==i;--i)ret[i]=this.at(x0[i]);return ret},numeric.Spline.prototype.diff=function(){var i,dx,dy,x=this.x,yl=this.yl,yr=this.yr,kl=this.kl,kr=this.kr,n=yl.length,zl=kl,zr=kr,pl=Array(n),pr=Array(n),add=numeric.add,mul=numeric.mul,div=numeric.div,sub=numeric.sub;for(i=n-1;-1!==i;--i)dx=x[i+1]-x[i],dy=sub(yr[i+1],yl[i]),pl[i]=div(add(mul(dy,6),mul(kl[i],-4*dx),mul(kr[i+1],-2*dx)),dx*dx),pr[i+1]=div(add(mul(dy,-6),mul(kl[i],2*dx),mul(kr[i+1],4*dx)),dx*dx);return new numeric.Spline(x,zl,zr,pl,pr)},numeric.Spline.prototype.roots=function(){function sqr(x){return x*x}var ret=[],x=this.x,yl=this.yl,yr=this.yr,kl=this.kl,kr=this.kr;"number"==typeof yl[0]&&(yl=[yl],yr=[yr],kl=[kl],kr=[kr]);var i,j,k,ai,bi,ci,di,ri,k0,k1,y0,y1,A,B,D,dx,stops,z0,z1,zm,t0,t1,tm,m=yl.length,n=x.length-1,sqrt=(ret=Array(m),Math.sqrt);for(i=0;i!==m;++i){for(ai=yl[i],bi=yr[i],ci=kl[i],di=kr[i],ri=[],j=0;j!==n;j++){for(j>0&&bi[j]*ai[j]<0&&ri.push(x[j]),dx=x[j+1]-x[j],x[j],y0=ai[j],y1=bi[j+1],k0=ci[j]/dx,A=(k1=di[j+1]/dx)+3*y0+2*k0-3*y1,B=3*(k1+k0+2*(y0-y1)),(D=sqr(k0-k1+3*(y0-y1))+12*k1*y0)<=0?stops=(z0=A/B)>x[j]&&z0<x[j+1]?[x[j],z0,x[j+1]]:[x[j],x[j+1]]:(z0=(A-sqrt(D))/B,z1=(A+sqrt(D))/B,stops=[x[j]],z0>x[j]&&z0<x[j+1]&&stops.push(z0),z1>x[j]&&z1<x[j+1]&&stops.push(z1),stops.push(x[j+1])),t0=stops[0],z0=this._at(t0,j),k=0;k<stops.length-1;k++)if(t1=stops[k+1],z1=this._at(t1,j),0!==z0)if(0===z1||z0*z1>0)t0=t1,z0=z1;else{for(var side=0;!((tm=(z0*t1-z1*t0)/(z0-z1))<=t0||tm>=t1);)if((zm=this._at(tm,j))*z1>0)t1=tm,z1=zm,-1===side&&(z0*=.5),side=-1;else{if(!(zm*z0>0))break;t0=tm,z0=zm,1===side&&(z1*=.5),side=1}ri.push(tm),t0=stops[k+1],z0=this._at(t0,j)}else ri.push(t0),t0=t1,z0=z1;0===z1&&ri.push(t1)}ret[i]=ri}return"number"==typeof this.yl[0]?ret[0]:ret},numeric.spline=function(x,y,k1,kn){var i,n=x.length,b=[],dx=[],dy=[],sub=numeric.sub,mul=numeric.mul,add=numeric.add;for(i=n-2;i>=0;i--)dx[i]=x[i+1]-x[i],dy[i]=sub(y[i+1],y[i]);"string"!=typeof k1&&"string"!=typeof kn||(k1=kn="periodic");var T=[[],[],[]];switch(typeof k1){case"undefined":b[0]=mul(3/(dx[0]*dx[0]),dy[0]),T[0].push(0,0),T[1].push(0,1),T[2].push(2/dx[0],1/dx[0]);break;case"string":b[0]=add(mul(3/(dx[n-2]*dx[n-2]),dy[n-2]),mul(3/(dx[0]*dx[0]),dy[0])),T[0].push(0,0,0),T[1].push(n-2,0,1),T[2].push(1/dx[n-2],2/dx[n-2]+2/dx[0],1/dx[0]);break;default:b[0]=k1,T[0].push(0),T[1].push(0),T[2].push(1)}for(i=1;i<n-1;i++)b[i]=add(mul(3/(dx[i-1]*dx[i-1]),dy[i-1]),mul(3/(dx[i]*dx[i]),dy[i])),T[0].push(i,i,i),T[1].push(i-1,i,i+1),T[2].push(1/dx[i-1],2/dx[i-1]+2/dx[i],1/dx[i]);switch(typeof kn){case"undefined":b[n-1]=mul(3/(dx[n-2]*dx[n-2]),dy[n-2]),T[0].push(n-1,n-1),T[1].push(n-2,n-1),T[2].push(1/dx[n-2],2/dx[n-2]);break;case"string":T[1][T[1].length-1]=0;break;default:b[n-1]=kn,T[0].push(n-1),T[1].push(n-1),T[2].push(1)}b="number"!=typeof b[0]?numeric.transpose(b):[b];var k=Array(b.length);if("string"==typeof k1)for(i=k.length-1;-1!==i;--i)k[i]=numeric.ccsLUPSolve(numeric.ccsLUP(numeric.ccsScatter(T)),b[i]),k[i][n-1]=k[i][0];else for(i=k.length-1;-1!==i;--i)k[i]=numeric.cLUsolve(numeric.cLU(T),b[i]);return k="number"==typeof y[0]?k[0]:numeric.transpose(k),new numeric.Spline(x,y,y,k,k)},numeric.fftpow2=function fftpow2(x,y){var n=x.length;if(1!==n){var i,j,cos=Math.cos,sin=Math.sin,xe=Array(n/2),ye=Array(n/2),xo=Array(n/2),yo=Array(n/2);for(j=n/2,i=n-1;-1!==i;--i)xo[--j]=x[i],yo[j]=y[i],--i,xe[j]=x[i],ye[j]=y[i];fftpow2(xe,ye),fftpow2(xo,yo),j=n/2;var t,ci,si,k=-6.283185307179586/n;for(i=n-1;-1!==i;--i)-1===--j&&(j=n/2-1),ci=cos(t=k*i),si=sin(t),x[i]=xe[j]+ci*xo[j]-si*yo[j],y[i]=ye[j]+ci*yo[j]+si*xo[j]}},numeric._ifftpow2=function _ifftpow2(x,y){var n=x.length;if(1!==n){var i,j,cos=Math.cos,sin=Math.sin,xe=Array(n/2),ye=Array(n/2),xo=Array(n/2),yo=Array(n/2);for(j=n/2,i=n-1;-1!==i;--i)xo[--j]=x[i],yo[j]=y[i],--i,xe[j]=x[i],ye[j]=y[i];_ifftpow2(xe,ye),_ifftpow2(xo,yo),j=n/2;var t,ci,si,k=6.283185307179586/n;for(i=n-1;-1!==i;--i)-1===--j&&(j=n/2-1),ci=cos(t=k*i),si=sin(t),x[i]=xe[j]+ci*xo[j]-si*yo[j],y[i]=ye[j]+ci*yo[j]+si*xo[j]}},numeric.ifftpow2=function(x,y){numeric._ifftpow2(x,y),numeric.diveq(x,x.length),numeric.diveq(y,y.length)},numeric.convpow2=function(ax,ay,bx,by){var i,axi,bxi,ayi,byi;for(numeric.fftpow2(ax,ay),numeric.fftpow2(bx,by),i=ax.length-1;-1!==i;--i)axi=ax[i],ayi=ay[i],bxi=bx[i],byi=by[i],ax[i]=axi*bxi-ayi*byi,ay[i]=axi*byi+ayi*bxi;numeric.ifftpow2(ax,ay)},numeric.T.prototype.fft=function(){var k,t,x=this.x,y=this.y,n=x.length,log=Math.log,log2=log(2),p=Math.ceil(log(2*n-1)/log2),m=Math.pow(2,p),cx=numeric.rep([m],0),cy=numeric.rep([m],0),cos=Math.cos,sin=Math.sin,c=-3.141592653589793/n,a=numeric.rep([m],0),b=numeric.rep([m],0);Math.floor(n/2);for(k=0;k<n;k++)a[k]=x[k];if(void 0!==y)for(k=0;k<n;k++)b[k]=y[k];for(cx[0]=1,k=1;k<=m/2;k++)t=c*k*k,cx[k]=cos(t),cy[k]=sin(t),cx[m-k]=cos(t),cy[m-k]=sin(t);var X=new numeric.T(a,b),Y=new numeric.T(cx,cy);return X=X.mul(Y),numeric.convpow2(X.x,X.y,numeric.clone(Y.x),numeric.neg(Y.y)),(X=X.mul(Y)).x.length=n,X.y.length=n,X},numeric.T.prototype.ifft=function(){var k,t,x=this.x,y=this.y,n=x.length,log=Math.log,log2=log(2),p=Math.ceil(log(2*n-1)/log2),m=Math.pow(2,p),cx=numeric.rep([m],0),cy=numeric.rep([m],0),cos=Math.cos,sin=Math.sin,c=3.141592653589793/n,a=numeric.rep([m],0),b=numeric.rep([m],0);Math.floor(n/2);for(k=0;k<n;k++)a[k]=x[k];if(void 0!==y)for(k=0;k<n;k++)b[k]=y[k];for(cx[0]=1,k=1;k<=m/2;k++)t=c*k*k,cx[k]=cos(t),cy[k]=sin(t),cx[m-k]=cos(t),cy[m-k]=sin(t);var X=new numeric.T(a,b),Y=new numeric.T(cx,cy);return X=X.mul(Y),numeric.convpow2(X.x,X.y,numeric.clone(Y.x),numeric.neg(Y.y)),(X=X.mul(Y)).x.length=n,X.y.length=n,X.div(n)},numeric.gradient=function(f,x){var n=x.length,f0=f(x);if(isNaN(f0))throw new Error("gradient: f(x) is a NaN!");var i,f1,f2,t0,t1,t2,d1,d2,N,max=Math.max,x0=numeric.clone(x),J=Array(n),abs=(numeric.div,numeric.sub,max=Math.max,Math.abs),min=Math.min,it=0;for(i=0;i<n;i++)for(var h=max(1e-6*f0,1e-8);;){if(++it>20)throw new Error("Numerical gradient fails");if(x0[i]=x[i]+h,f1=f(x0),x0[i]=x[i]-h,f2=f(x0),x0[i]=x[i],isNaN(f1)||isNaN(f2))h/=16;else{if(J[i]=(f1-f2)/(2*h),t0=x[i]-h,t1=x[i],t2=x[i]+h,d1=(f1-f0)/h,d2=(f0-f2)/h,N=max(abs(J[i]),abs(f0),abs(f1),abs(f2),abs(t0),abs(t1),abs(t2),1e-8),!(min(max(abs(d1-J[i]),abs(d2-J[i]),abs(d1-d2))/N,h/N)>.001))break;h/=16}}return J},numeric.uncmin=function(f,x0,tol,gradient,maxit,callback,options){var grad=numeric.gradient;void 0===options&&(options={}),void 0===tol&&(tol=1e-8),void 0===gradient&&(gradient=function(x){return grad(f,x)}),void 0===maxit&&(maxit=1e3);var f1,df0,n=(x0=numeric.clone(x0)).length,f0=f(x0);if(isNaN(f0))throw new Error("uncmin: f(x0) is a NaN!");var max=Math.max,norm2=numeric.norm2;tol=max(tol,numeric.epsilon);var step,g0,g1,s,x1,y,Hy,ys,t,nstep,H1=options.Hinv||numeric.identity(n),dot=numeric.dot,sub=(numeric.inv,numeric.sub),add=numeric.add,ten=numeric.tensor,div=numeric.div,mul=numeric.mul,all=numeric.all,isfinite=numeric.isFinite,neg=numeric.neg,it=0,msg="";for(g0=gradient(x0);it<maxit;){if("function"==typeof callback&&callback(it,x0,f0,g0,H1)){msg="Callback returned true";break}if(!all(isfinite(g0))){msg="Gradient has Infinity or NaN";break}if(!all(isfinite(step=neg(dot(H1,g0))))){msg="Search direction has Infinity or NaN";break}if((nstep=norm2(step))<tol){msg="Newton step smaller than tol";break}for(t=1,df0=dot(g0,step),x1=x0;it<maxit&&!(t*nstep<tol)&&(x1=add(x0,s=mul(step,t)),(f1=f(x1))-f0>=.1*t*df0||isNaN(f1));)t*=.5,++it;if(t*nstep<tol){msg="Line search step size smaller than tol";break}if(it===maxit){msg="maxit reached during line search";break}H1=sub(add(H1,mul(((ys=dot(y=sub(g1=gradient(x1),g0),s))+dot(y,Hy=dot(H1,y)))/(ys*ys),ten(s,s))),div(add(ten(Hy,s),ten(s,Hy)),ys)),x0=x1,f0=f1,g0=g1,++it}return{solution:x0,f:f0,gradient:g0,invHessian:H1,iterations:it,message:msg}},numeric.Dopri=function(x,y,f,ymid,iterations,msg,events){this.x=x,this.y=y,this.f=f,this.ymid=ymid,this.iterations=iterations,this.events=events,this.message=msg},numeric.Dopri.prototype._at=function(xi,j){function sqr(x){return x*x}var x0,x1,xh,y0,y1,yh,p,q,w,xs=this.x,ys=this.y,k1=this.f,ymid=this.ymid,add=(xs.length,Math.floor,numeric.add),mul=numeric.mul,sub=numeric.sub;return x0=xs[j],x1=xs[j+1],y0=ys[j],y1=ys[j+1],xh=x0+.5*(x1-x0),yh=ymid[j],p=sub(k1[j],mul(y0,1/(x0-xh)+2/(x0-x1))),q=sub(k1[j+1],mul(y1,1/(x1-xh)+2/(x1-x0))),add(add(add(add(mul(y0,(w=[sqr(xi-x1)*(xi-xh)/sqr(x0-x1)/(x0-xh),sqr(xi-x0)*sqr(xi-x1)/sqr(x0-xh)/sqr(x1-xh),sqr(xi-x0)*(xi-xh)/sqr(x1-x0)/(x1-xh),(xi-x0)*sqr(xi-x1)*(xi-xh)/sqr(x0-x1)/(x0-xh),(xi-x1)*sqr(xi-x0)*(xi-xh)/sqr(x0-x1)/(x1-xh)])[0]),mul(yh,w[1])),mul(y1,w[2])),mul(p,w[3])),mul(q,w[4]))},numeric.Dopri.prototype.at=function(x){var i,j,k,floor=Math.floor;if("number"!=typeof x){var n=x.length,ret=Array(n);for(i=n-1;-1!==i;--i)ret[i]=this.at(x[i]);return ret}var x0=this.x;for(i=0,j=x0.length-1;j-i>1;)x0[k=floor(.5*(i+j))]<=x?i=k:j=k;return this._at(x,i)},numeric.dopri=function(x0,x1,y0,f,tol,maxit,event){void 0===tol&&(tol=1e-6),void 0===maxit&&(maxit=1e3);var k2,k3,k4,k5,k6,k7,er,j,y1,erinf,e0,e1,ev,xs=[x0],ys=[y0],k1=[f(x0,y0)],ymid=[],A3=[.075,.225],A4=[44/45,-56/15,32/9],A5=[19372/6561,-25360/2187,64448/6561,-212/729],A6=[9017/3168,-355/33,46732/5247,49/176,-5103/18656],b=[35/384,0,500/1113,125/192,-2187/6784,11/84],bm=[.10013431883002395,0,.3918321794184259,-.02982460176594817,.05893268337240795,-.04497888809104361,.023904308236133973],c=[.2,.3,.8,8/9,1,1],e=[-71/57600,0,71/16695,-71/1920,17253/339200,-22/525,.025],i=0,h=(x1-x0)/10,it=0,add=numeric.add,mul=numeric.mul,min=(Math.max,Math.min),abs=Math.abs,norminf=numeric.norminf,pow=Math.pow,any=numeric.any,lt=numeric.lt,and=numeric.and,ret=(numeric.sub,new numeric.Dopri(xs,ys,k1,ymid,-1,""));for("function"==typeof event&&(e0=event(x0,y0));x0<x1&&it<maxit;)if(++it,x0+h>x1&&(h=x1-x0),k2=f(x0+c[0]*h,add(y0,mul(.2*h,k1[i]))),k3=f(x0+c[1]*h,add(add(y0,mul(A3[0]*h,k1[i])),mul(A3[1]*h,k2))),k4=f(x0+c[2]*h,add(add(add(y0,mul(A4[0]*h,k1[i])),mul(A4[1]*h,k2)),mul(A4[2]*h,k3))),k5=f(x0+c[3]*h,add(add(add(add(y0,mul(A5[0]*h,k1[i])),mul(A5[1]*h,k2)),mul(A5[2]*h,k3)),mul(A5[3]*h,k4))),k6=f(x0+c[4]*h,add(add(add(add(add(y0,mul(A6[0]*h,k1[i])),mul(A6[1]*h,k2)),mul(A6[2]*h,k3)),mul(A6[3]*h,k4)),mul(A6[4]*h,k5))),k7=f(x0+h,y1=add(add(add(add(add(y0,mul(k1[i],h*b[0])),mul(k3,h*b[2])),mul(k4,h*b[3])),mul(k5,h*b[4])),mul(k6,h*b[5]))),(erinf="number"==typeof(er=add(add(add(add(add(mul(k1[i],h*e[0]),mul(k3,h*e[2])),mul(k4,h*e[3])),mul(k5,h*e[4])),mul(k6,h*e[5])),mul(k7,h*e[6])))?abs(er):norminf(er))>tol){if(x0+(h=.2*h*pow(tol/erinf,.25))===x0){ret.msg="Step size became too small";break}}else{if(ymid[i]=add(add(add(add(add(add(y0,mul(k1[i],h*bm[0])),mul(k3,h*bm[2])),mul(k4,h*bm[3])),mul(k5,h*bm[4])),mul(k6,h*bm[5])),mul(k7,h*bm[6])),xs[++i]=x0+h,ys[i]=y1,k1[i]=k7,"function"==typeof event){var yi,xi,xl=x0,xr=x0+.5*h;if(e1=event(xr,ymid[i-1]),any(ev=and(lt(e0,0),lt(0,e1)))||(xl=xr,e0=e1,e1=event(xr=x0+h,y1),ev=and(lt(e0,0),lt(0,e1))),any(ev)){for(var en,ei,side=0,sl=1,sr=1;;){if("number"==typeof e0)xi=(sr*e1*xl-sl*e0*xr)/(sr*e1-sl*e0);else for(xi=xr,j=e0.length-1;-1!==j;--j)e0[j]<0&&e1[j]>0&&(xi=min(xi,(sr*e1[j]*xl-sl*e0[j]*xr)/(sr*e1[j]-sl*e0[j])));if(xi<=xl||xi>=xr)break;ei=event(xi,yi=ret._at(xi,i-1)),any(en=and(lt(e0,0),lt(0,ei)))?(xr=xi,e1=ei,ev=en,sr=1,-1===side?sl*=.5:sl=1,side=-1):(xl=xi,e0=ei,sl=1,1===side?sr*=.5:sr=1,side=1)}return y1=ret._at(.5*(x0+xi),i-1),ret.f[i]=f(xi,yi),ret.x[i]=xi,ret.y[i]=yi,ret.ymid[i-1]=y1,ret.events=ev,ret.iterations=it,ret}}x0+=h,y0=y1,e0=e1,h=min(.8*h*pow(tol/erinf,.25),4*h)}return ret.iterations=it,ret},numeric.LU=function(A,fast){fast=fast||!1;var i,j,k,absAjk,Akk,Ak,Pk,Ai,max,abs=Math.abs,n=A.length,n1=n-1,P=new Array(n);for(fast||(A=numeric.clone(A)),k=0;k<n;++k){for(Pk=k,max=abs((Ak=A[k])[k]),j=k+1;j<n;++j)max<(absAjk=abs(A[j][k]))&&(max=absAjk,Pk=j);for(P[k]=Pk,Pk!=k&&(A[k]=A[Pk],A[Pk]=Ak,Ak=A[k]),Akk=Ak[k],i=k+1;i<n;++i)A[i][k]/=Akk;for(i=k+1;i<n;++i){for(Ai=A[i],j=k+1;j<n1;++j)Ai[j]-=Ai[k]*Ak[j],Ai[++j]-=Ai[k]*Ak[j];j===n1&&(Ai[j]-=Ai[k]*Ak[j])}}return{LU:A,P:P}},numeric.LUsolve=function(LUP,b){var i,j,Pi,LUi,tmp,LU=LUP.LU,n=LU.length,x=numeric.clone(b),P=LUP.P;for(i=n-1;-1!==i;--i)x[i]=b[i];for(i=0;i<n;++i)for(Pi=P[i],P[i]!==i&&(tmp=x[i],x[i]=x[Pi],x[Pi]=tmp),LUi=LU[i],j=0;j<i;++j)x[i]-=x[j]*LUi[j];for(i=n-1;i>=0;--i){for(LUi=LU[i],j=i+1;j<n;++j)x[i]-=x[j]*LUi[j];x[i]/=LUi[i]}return x},numeric.solve=function(A,b,fast){return numeric.LUsolve(numeric.LU(A,fast),b)},numeric.echelonize=function(A){var i,j,k,l,Ai,Ii,Z,a,s=numeric.dim(A),m=s[0],n=s[1],I=numeric.identity(m),P=Array(m),abs=Math.abs,diveq=numeric.diveq;for(A=numeric.clone(A),i=0;i<m;++i){for(k=0,Ai=A[i],Ii=I[i],j=1;j<n;++j)abs(Ai[k])<abs(Ai[j])&&(k=j);for(P[i]=k,diveq(Ii,Ai[k]),diveq(Ai,Ai[k]),j=0;j<m;++j)if(j!==i){for(a=(Z=A[j])[k],l=n-1;-1!==l;--l)Z[l]-=Ai[l]*a;for(Z=I[j],l=m-1;-1!==l;--l)Z[l]-=Ii[l]*a}}return{I:I,A:A,P:P}},numeric.__solveLP=function(c,A,b,tol,maxit,x,flag){var y,H,count,g,sum=numeric.sum,mul=(numeric.log,numeric.mul),sub=numeric.sub,dot=numeric.dot,div=numeric.div,add=numeric.add,m=c.length,n=b.length,unbounded=!1,alpha=1,transpose=(numeric.transpose(A),numeric.svd,numeric.transpose),sqrt=(numeric.leq,Math.sqrt),abs=Math.abs,min=(numeric.muleq,numeric.norminf,numeric.any,Math.min),all=numeric.all,gt=numeric.gt,p=Array(m),A0=Array(n),solve=(numeric.rep([n],1),numeric.solve),z=sub(b,dot(A,x)),dotcc=dot(c,c);for(count=0;count<maxit;++count){var i,d;for(i=n-1;-1!==i;--i)A0[i]=div(A[i],z[i]);var A1=transpose(A0);for(i=m-1;-1!==i;--i)p[i]=sum(A1[i]);alpha=.25*abs(dotcc/dot(c,p));var a1=100*sqrt(dotcc/dot(p,p));for((!isFinite(alpha)||alpha>a1)&&(alpha=a1),g=add(c,mul(alpha,p)),H=dot(A1,A0),i=m-1;-1!==i;--i)H[i][i]+=1;var t0=div(z,dot(A,d=solve(H,div(g,alpha),!0))),t=1;for(i=n-1;-1!==i;--i)t0[i]<0&&(t=min(t,-.999*t0[i]));if(!all(gt(z=sub(b,dot(A,y=sub(x,mul(d,t)))),0)))return{solution:x,message:"",iterations:count};if(x=y,alpha<tol)return{solution:y,message:"",iterations:count};if(flag){var s=dot(c,g),Ag=dot(A,g);for(unbounded=!0,i=n-1;-1!==i;--i)if(s*Ag[i]<0){unbounded=!1;break}}else unbounded=!(x[m-1]>=0);if(unbounded)return{solution:y,message:"Unbounded",iterations:count}}return{solution:x,message:"maximum iteration count exceeded",iterations:count}},numeric._solveLP=function(c,A,b,tol,maxit){var m=c.length,n=b.length,sub=(numeric.sum,numeric.log,numeric.mul,numeric.sub),dot=numeric.dot,c0=(numeric.div,numeric.add,numeric.rep([m],0).concat([1])),J=numeric.rep([n,1],-1),A0=numeric.blockMatrix([[A,J]]),b0=b,y=numeric.rep([m],0).concat(Math.max(0,numeric.sup(numeric.neg(b)))+1),x0=numeric.__solveLP(c0,A0,b0,tol,maxit,y,!1),x=numeric.clone(x0.solution);if(x.length=m,numeric.inf(sub(b,dot(A,x)))<0)return{solution:NaN,message:"Infeasible",iterations:x0.iterations};var ret=numeric.__solveLP(c,A,b,tol,maxit-x0.iterations,x,!0);return ret.iterations+=x0.iterations,ret},numeric.solveLP=function(c,A,b,Aeq,beq,tol,maxit){if(void 0===maxit&&(maxit=1e3),void 0===tol&&(tol=numeric.epsilon),void 0===Aeq)return numeric._solveLP(c,A,b,tol,maxit);var i,m=Aeq.length,n=Aeq[0].length,o=A.length,B=numeric.echelonize(Aeq),flags=numeric.rep([n],0),P=B.P,Q=[];for(i=P.length-1;-1!==i;--i)flags[P[i]]=1;for(i=n-1;-1!==i;--i)0===flags[i]&&Q.push(i);var g=numeric.getRange,I=numeric.linspace(0,m-1),J=numeric.linspace(0,o-1),Aeq2=g(Aeq,I,Q),A1=g(A,J,P),A2=g(A,J,Q),dot=numeric.dot,sub=numeric.sub,A3=dot(A1,B.I),A4=sub(A2,dot(A3,Aeq2)),b4=sub(b,dot(A3,beq)),c1=Array(P.length),c2=Array(Q.length);for(i=P.length-1;-1!==i;--i)c1[i]=c[P[i]];for(i=Q.length-1;-1!==i;--i)c2[i]=c[Q[i]];var c4=sub(c2,dot(c1,dot(B.I,Aeq2))),S=numeric._solveLP(c4,A4,b4,tol,maxit),x2=S.solution;if(x2!=x2)return S;var x1=dot(B.I,sub(beq,dot(Aeq2,x2))),x=Array(c.length);for(i=P.length-1;-1!==i;--i)x[P[i]]=x1[i];for(i=Q.length-1;-1!==i;--i)x[Q[i]]=x2[i];return{solution:x,message:S.message,iterations:S.iterations}},numeric.MPStoLP=function(MPS){MPS instanceof String&&MPS.split("\n");var i,j,z,name,state=0,states=["Initial state","NAME","ROWS","COLUMNS","RHS","BOUNDS","ENDATA"],n=MPS.length,N=0,rows={},sign=[],rl=0,vars={},nv=0,c=[],A=[],b=[];function err(e){throw new Error("MPStoLP: "+e+"\nLine "+i+": "+MPS[i]+"\nCurrent state: "+states[state]+"\n")}for(i=0;i<n;++i){var w0=(z=MPS[i]).match(/\S*/g),w=[];for(j=0;j<w0.length;++j)""!==w0[j]&&w.push(w0[j]);if(0!==w.length){for(j=0;j<states.length&&z.substr(0,states[j].length)!==states[j];++j);if(j<states.length){if(state=j,1===j&&(name=w[1]),6===j)return{name:name,c:c,A:numeric.transpose(A),b:b,rows:rows,vars:vars}}else switch(state){case 0:case 1:err("Unexpected line");case 2:switch(w[0]){case"N":0===N?N=w[1]:err("Two or more N rows");break;case"L":rows[w[1]]=rl,sign[rl]=1,b[rl]=0,++rl;break;case"G":rows[w[1]]=rl,sign[rl]=-1,b[rl]=0,++rl;break;case"E":rows[w[1]]=rl,sign[rl]=0,b[rl]=0,++rl;break;default:err("Parse error "+numeric.prettyPrint(w))}break;case 3:vars.hasOwnProperty(w[0])||(vars[w[0]]=nv,c[nv]=0,A[nv]=numeric.rep([rl],0),++nv);var p=vars[w[0]];for(j=1;j<w.length;j+=2)if(w[j]!==N){var q=rows[w[j]];A[p][q]=(sign[q]<0?-1:1)*parseFloat(w[j+1])}else c[p]=parseFloat(w[j+1]);break;case 4:for(j=1;j<w.length;j+=2)b[rows[w[j]]]=(sign[rows[w[j]]]<0?-1:1)*parseFloat(w[j+1]);break;case 5:break;case 6:err("Internal error")}}}err("Reached end of file without ENDATA")},numeric.seedrandom={pow:Math.pow,random:Math.random},function(pool,math,width,chunks,significance,overflow,startdenom){function mixkey(seed,key,smear,j){for(seed+="",smear=0,j=0;j<seed.length;j++)key[lowbits(j)]=lowbits((smear^=19*key[lowbits(j)])+seed.charCodeAt(j));for(j in seed="",key)seed+=String.fromCharCode(key[j]);return seed}function lowbits(n){return n&width-1}math.seedrandom=function(seed,use_entropy){var arc4,key=[];return seed=mixkey(function flatten(obj,depth,result,prop,typ){result=[];typ=typeof obj;if(depth&&"object"==typ)for(prop in obj)if(prop.indexOf("S")<5)try{result.push(flatten(obj[prop],depth-1))}catch(e){}return result.length?result:obj+("string"!=typ?"\0":"")}(use_entropy?[seed,pool]:arguments.length?seed:[(new Date).getTime(),pool,window],3),key),mixkey((arc4=new function(key){var t,u,me=this,keylen=key.length,i=0,j=me.i=me.j=me.m=0;me.S=[],me.c=[],keylen||(key=[keylen++]);for(;i<width;)me.S[i]=i++;for(i=0;i<width;i++)t=me.S[i],j=lowbits(j+t+key[i%keylen]),u=me.S[j],me.S[i]=u,me.S[j]=t;me.g=function(count){var s=me.S,i=lowbits(me.i+1),t=s[i],j=lowbits(me.j+t),u=s[j];s[i]=u,s[j]=t;for(var r=s[lowbits(t+u)];--count;)i=lowbits(i+1),t=s[i],j=lowbits(j+t),u=s[j],s[i]=u,s[j]=t,r=r*width+s[lowbits(t+u)];return me.i=i,me.j=j,r},me.g(width)}(key)).S,pool),math.random=function(){for(var n=arc4.g(6),d=startdenom,x=0;n<significance;)n=(n+x)*width,d*=width,x=arc4.g(1);for(;n>=overflow;)n/=2,d/=2,x>>>=1;return(n+x)/d},seed},startdenom=math.pow(width,6),significance=math.pow(2,significance),overflow=2*significance,mixkey(math.random(),pool)}([],numeric.seedrandom,256,0,52),function(exports){function base0to1(A){if("object"!=typeof A)return A;var i,ret=[],n=A.length;for(i=0;i<n;i++)ret[i+1]=base0to1(A[i]);return ret}function base1to0(A){if("object"!=typeof A)return A;var i,ret=[],n=A.length;for(i=1;i<n;i++)ret[i-1]=base1to0(A[i]);return ret}function qpgen2(dmat,dvec,fddmat,n,sol,crval,amat,bvec,fdamat,q,meq,iact,nact,iter,work,ierr){var i,j,l,l1,info,it1,iwzv,iwrv,iwrm,iwsv,iwuv,nvl,r,iwnbv,temp,sum,t1,tt,gc,gs,nu,t1inf,t2min,vsmall,tmpa,tmpb,go;r=Math.min(n,q),l=2*n+r*(r+5)/2+2*q+1,vsmall=1e-60;do{tmpa=1+.1*(vsmall+=vsmall),tmpb=1+.2*vsmall}while(tmpa<=1||tmpb<=1);for(i=1;i<=n;i+=1)work[i]=dvec[i];for(i=n+1;i<=l;i+=1)work[i]=0;for(i=1;i<=q;i+=1)iact[i]=0;if(info=[],0===ierr[1]){if(function(a,lda,n,info){var i,j,jm1,k,t,s;for(j=1;j<=n;j+=1){if(info[1]=j,s=0,(jm1=j-1)<1){if((s=a[j][j]-s)<=0)break;a[j][j]=Math.sqrt(s)}else{for(k=1;k<=jm1;k+=1){for(t=a[k][j],i=1;i<k;i+=1)t-=a[i][j]*a[i][k];t/=a[k][k],a[k][j]=t,s+=t*t}if((s=a[j][j]-s)<=0)break;a[j][j]=Math.sqrt(s)}info[1]=0}}(dmat,0,n,info),0!==info[1])return void(ierr[1]=2);!function(a,lda,n,b){var i,k,kb,t;for(k=1;k<=n;k+=1){for(t=0,i=1;i<k;i+=1)t+=a[i][k]*b[i];b[k]=(b[k]-t)/a[k][k]}for(kb=1;kb<=n;kb+=1)for(b[k=n+1-kb]=b[k]/a[k][k],t=-b[k],i=1;i<k;i+=1)b[i]=b[i]+t*a[i][k]}(dmat,0,n,dvec),function(a,lda,n){var i,j,k,kp1,t;for(k=1;k<=n;k+=1){for(a[k][k]=1/a[k][k],t=-a[k][k],i=1;i<k;i+=1)a[i][k]=t*a[i][k];if(n<(kp1=k+1))break;for(j=kp1;j<=n;j+=1)for(t=a[k][j],a[k][j]=0,i=1;i<=k;i+=1)a[i][j]=a[i][j]+t*a[i][k]}}(dmat,0,n)}else{for(j=1;j<=n;j+=1)for(sol[j]=0,i=1;i<=j;i+=1)sol[j]=sol[j]+dmat[i][j]*dvec[i];for(j=1;j<=n;j+=1)for(dvec[j]=0,i=j;i<=n;i+=1)dvec[j]=dvec[j]+dmat[j][i]*sol[i]}for(crval[1]=0,j=1;j<=n;j+=1)for(sol[j]=dvec[j],crval[1]=crval[1]+work[j]*sol[j],work[j]=0,i=j+1;i<=n;i+=1)dmat[i][j]=0;for(crval[1]=-crval[1]/2,ierr[1]=0,iwnbv=(iwsv=(iwrm=(iwuv=(iwrv=(iwzv=n)+n)+r)+r+1)+r*(r+1)/2)+q,i=1;i<=q;i+=1){for(sum=0,j=1;j<=n;j+=1)sum+=amat[j][i]*amat[j][i];work[iwnbv+i]=Math.sqrt(sum)}function fn_goto_50(){for(iter[1]=iter[1]+1,l=iwsv,i=1;i<=q;i+=1){for(l+=1,sum=-bvec[i],j=1;j<=n;j+=1)sum+=amat[j][i]*sol[j];if(Math.abs(sum)<vsmall&&(sum=0),i>meq)work[l]=sum;else if(work[l]=-Math.abs(sum),sum>0){for(j=1;j<=n;j+=1)amat[j][i]=-amat[j][i];bvec[i]=-bvec[i]}}for(i=1;i<=nact;i+=1)work[iwsv+iact[i]]=0;for(nvl=0,temp=0,i=1;i<=q;i+=1)work[iwsv+i]<temp*work[iwnbv+i]&&(nvl=i,temp=work[iwsv+i]/work[iwnbv+i]);return 0===nvl?999:0}function fn_goto_55(){for(i=1;i<=n;i+=1){for(sum=0,j=1;j<=n;j+=1)sum+=dmat[j][i]*amat[j][nvl];work[i]=sum}for(l1=iwzv,i=1;i<=n;i+=1)work[l1+i]=0;for(j=nact+1;j<=n;j+=1)for(i=1;i<=n;i+=1)work[l1+i]=work[l1+i]+dmat[i][j]*work[j];for(t1inf=!0,i=nact;i>=1;i-=1){for(sum=work[i],l1=(l=iwrm+i*(i+3)/2)-i,j=i+1;j<=nact;j+=1)sum-=work[l]*work[iwrv+j],l+=j;if(sum/=work[l1],work[iwrv+i]=sum,iact[i]<meq)break;if(sum<0)break;t1inf=!1,it1=i}if(!t1inf)for(t1=work[iwuv+it1]/work[iwrv+it1],i=1;i<=nact&&!(iact[i]<meq)&&!(work[iwrv+i]<0);i+=1)(temp=work[iwuv+i]/work[iwrv+i])<t1&&(t1=temp,it1=i);for(sum=0,i=iwzv+1;i<=iwzv+n;i+=1)sum+=work[i]*work[i];if(Math.abs(sum)<=vsmall){if(t1inf)return ierr[1]=1,999;for(i=1;i<=nact;i+=1)work[iwuv+i]=work[iwuv+i]-t1*work[iwrv+i];return work[iwuv+nact+1]=work[iwuv+nact+1]+t1,700}for(sum=0,i=1;i<=n;i+=1)sum+=work[iwzv+i]*amat[i][nvl];for(tt=-work[iwsv+nvl]/sum,t2min=!0,t1inf||t1<tt&&(tt=t1,t2min=!1),i=1;i<=n;i+=1)sol[i]=sol[i]+tt*work[iwzv+i],Math.abs(sol[i])<vsmall&&(sol[i]=0);for(crval[1]=crval[1]+tt*sum*(tt/2+work[iwuv+nact+1]),i=1;i<=nact;i+=1)work[iwuv+i]=work[iwuv+i]-tt*work[iwrv+i];if(work[iwuv+nact+1]=work[iwuv+nact+1]+tt,!t2min){for(sum=-bvec[nvl],j=1;j<=n;j+=1)sum+=sol[j]*amat[j][nvl];if(nvl>meq)work[iwsv+nvl]=sum;else if(work[iwsv+nvl]=-Math.abs(sum),sum>0){for(j=1;j<=n;j+=1)amat[j][nvl]=-amat[j][nvl];bvec[nvl]=-bvec[nvl]}return 700}for(iact[nact+=1]=nvl,l=iwrm+(nact-1)*nact/2+1,i=1;i<=nact-1;i+=1)work[l]=work[i],l+=1;if(nact===n)work[l]=work[n];else{for(i=n;i>=nact+1&&0!==work[i]&&(gc=Math.max(Math.abs(work[i-1]),Math.abs(work[i])),gs=Math.min(Math.abs(work[i-1]),Math.abs(work[i])),temp=work[i-1]>=0?Math.abs(gc*Math.sqrt(1+gs*gs/(gc*gc))):-Math.abs(gc*Math.sqrt(1+gs*gs/(gc*gc))),gc=work[i-1]/temp,gs=work[i]/temp,1!==gc);i-=1)if(0===gc)for(work[i-1]=gs*temp,j=1;j<=n;j+=1)temp=dmat[j][i-1],dmat[j][i-1]=dmat[j][i],dmat[j][i]=temp;else for(work[i-1]=temp,nu=gs/(1+gc),j=1;j<=n;j+=1)temp=gc*dmat[j][i-1]+gs*dmat[j][i],dmat[j][i]=nu*(dmat[j][i-1]+temp)-dmat[j][i],dmat[j][i-1]=temp;work[l]=work[nact]}return 0}function fn_goto_797(){if(0===work[l1=(l=iwrm+it1*(it1+1)/2+1)+it1])return 798;if(gc=Math.max(Math.abs(work[l1-1]),Math.abs(work[l1])),gs=Math.min(Math.abs(work[l1-1]),Math.abs(work[l1])),temp=work[l1-1]>=0?Math.abs(gc*Math.sqrt(1+gs*gs/(gc*gc))):-Math.abs(gc*Math.sqrt(1+gs*gs/(gc*gc))),gc=work[l1-1]/temp,gs=work[l1]/temp,1===gc)return 798;if(0===gc){for(i=it1+1;i<=nact;i+=1)temp=work[l1-1],work[l1-1]=work[l1],work[l1]=temp,l1+=i;for(i=1;i<=n;i+=1)temp=dmat[i][it1],dmat[i][it1]=dmat[i][it1+1],dmat[i][it1+1]=temp}else{for(nu=gs/(1+gc),i=it1+1;i<=nact;i+=1)temp=gc*work[l1-1]+gs*work[l1],work[l1]=nu*(work[l1-1]+temp)-work[l1],work[l1-1]=temp,l1+=i;for(i=1;i<=n;i+=1)temp=gc*dmat[i][it1]+gs*dmat[i][it1+1],dmat[i][it1+1]=nu*(dmat[i][it1]+temp)-dmat[i][it1+1],dmat[i][it1]=temp}return 0}function fn_goto_798(){for(l1=l-it1,i=1;i<=it1;i+=1)work[l1]=work[l],l+=1,l1+=1;return work[iwuv+it1]=work[iwuv+it1+1],iact[it1]=iact[it1+1],(it1+=1)<nact?797:0}function fn_goto_799(){return work[iwuv+nact]=work[iwuv+nact+1],work[iwuv+nact+1]=0,iact[nact]=0,nact-=1,iter[2]=iter[2]+1,0}for(nact=0,iter[1]=0,iter[2]=0,go=0;;){if(999===(go=fn_goto_50()))return;for(;0!==(go=fn_goto_55());){if(999===go)return;if(700===go)if(it1===nact)fn_goto_799();else{for(;fn_goto_797(),797===(go=fn_goto_798()););fn_goto_799()}}}}numeric.solveQP=function(Dmat,dvec,Amat,bvec,meq,factorized){Dmat=base0to1(Dmat),dvec=base0to1(dvec),Amat=base0to1(Amat);var i,n,q,r,message,crval=[],iact=[],sol=[],work=[],iter=[];if(meq=meq||0,factorized=factorized?base0to1(factorized):[void 0,0],bvec=bvec?base0to1(bvec):[],n=Dmat.length-1,q=Amat[1].length-1,!bvec)for(i=1;i<=q;i+=1)bvec[i]=0;for(i=1;i<=q;i+=1)iact[i]=0;for(r=Math.min(n,q),i=1;i<=n;i+=1)sol[i]=0;for(crval[1]=0,i=1;i<=2*n+r*(r+5)/2+2*q+1;i+=1)work[i]=0;for(i=1;i<=2;i+=1)iter[i]=0;return qpgen2(Dmat,dvec,0,n,sol,crval,Amat,bvec,0,q,meq,iact,0,iter,work,factorized),message="",1===factorized[1]&&(message="constraints are inconsistent, no solution!"),2===factorized[1]&&(message="matrix D in quadratic function is not positive definite!"),{solution:base1to0(sol),value:base1to0(crval),unconstrained_solution:base1to0(dvec),iterations:base1to0(iter),iact:base1to0(iact),message:message}}}(),numeric.svd=function(A){var temp,prec=numeric.epsilon,tolerance=1e-64/prec,c=0,i=0,j=0,k=0,l=0,u=numeric.clone(A),m=u.length,n=u[0].length;if(m<n)throw"Need more rows than columns";var e=new Array(n),q=new Array(n);for(i=0;i<n;i++)e[i]=q[i]=0;var v=numeric.rep([n,n],0);function pythag(a,b){return(a=Math.abs(a))>(b=Math.abs(b))?a*Math.sqrt(1+b*b/a/a):0==b?a:b*Math.sqrt(1+a*a/b/b)}var f=0,g=0,h=0,x=0,y=0,z=0,s=0;for(i=0;i<n;i++){for(e[i]=g,s=0,l=i+1,j=i;j<m;j++)s+=u[j][i]*u[j][i];if(s<=tolerance)g=0;else for(f=u[i][i],g=Math.sqrt(s),f>=0&&(g=-g),h=f*g-s,u[i][i]=f-g,j=l;j<n;j++){for(s=0,k=i;k<m;k++)s+=u[k][i]*u[k][j];for(f=s/h,k=i;k<m;k++)u[k][j]+=f*u[k][i]}for(q[i]=g,s=0,j=l;j<n;j++)s+=u[i][j]*u[i][j];if(s<=tolerance)g=0;else{for(f=u[i][i+1],g=Math.sqrt(s),f>=0&&(g=-g),h=f*g-s,u[i][i+1]=f-g,j=l;j<n;j++)e[j]=u[i][j]/h;for(j=l;j<m;j++){for(s=0,k=l;k<n;k++)s+=u[j][k]*u[i][k];for(k=l;k<n;k++)u[j][k]+=s*e[k]}}(y=Math.abs(q[i])+Math.abs(e[i]))>x&&(x=y)}for(i=n-1;-1!=i;i+=-1){if(0!=g){for(h=g*u[i][i+1],j=l;j<n;j++)v[j][i]=u[i][j]/h;for(j=l;j<n;j++){for(s=0,k=l;k<n;k++)s+=u[i][k]*v[k][j];for(k=l;k<n;k++)v[k][j]+=s*v[k][i]}}for(j=l;j<n;j++)v[i][j]=0,v[j][i]=0;v[i][i]=1,g=e[i],l=i}for(i=n-1;-1!=i;i+=-1){for(l=i+1,g=q[i],j=l;j<n;j++)u[i][j]=0;if(0!=g){for(h=u[i][i]*g,j=l;j<n;j++){for(s=0,k=l;k<m;k++)s+=u[k][i]*u[k][j];for(f=s/h,k=i;k<m;k++)u[k][j]+=f*u[k][i]}for(j=i;j<m;j++)u[j][i]=u[j][i]/g}else for(j=i;j<m;j++)u[j][i]=0;u[i][i]+=1}for(prec*=x,k=n-1;-1!=k;k+=-1)for(var iteration=0;iteration<50;iteration++){var test_convergence=!1;for(l=k;-1!=l;l+=-1){if(Math.abs(e[l])<=prec){test_convergence=!0;break}if(Math.abs(q[l-1])<=prec)break}if(!test_convergence){c=0,s=1;var l1=l-1;for(i=l;i<k+1&&(f=s*e[i],e[i]=c*e[i],!(Math.abs(f)<=prec));i++)for(h=pythag(f,g=q[i]),q[i]=h,c=g/h,s=-f/h,j=0;j<m;j++)y=u[j][l1],z=u[j][i],u[j][l1]=y*c+z*s,u[j][i]=-y*s+z*c}if(z=q[k],l==k){if(z<0)for(q[k]=-z,j=0;j<n;j++)v[j][k]=-v[j][k];break}if(iteration>=49)throw"Error: no convergence.";for(x=q[l],g=pythag(f=(((y=q[k-1])-z)*(y+z)+((g=e[k-1])-(h=e[k]))*(g+h))/(2*h*y),1),f=f<0?((x-z)*(x+z)+h*(y/(f-g)-h))/x:((x-z)*(x+z)+h*(y/(f+g)-h))/x,c=1,s=1,i=l+1;i<k+1;i++){for(g=e[i],y=q[i],h=s*g,g*=c,z=pythag(f,h),e[i-1]=z,f=x*(c=f/z)+g*(s=h/z),g=-x*s+g*c,h=y*s,y*=c,j=0;j<n;j++)x=v[j][i-1],z=v[j][i],v[j][i-1]=x*c+z*s,v[j][i]=-x*s+z*c;for(z=pythag(f,h),q[i-1]=z,f=(c=f/z)*g+(s=h/z)*y,x=-s*g+c*y,j=0;j<m;j++)y=u[j][i-1],z=u[j][i],u[j][i-1]=y*c+z*s,u[j][i]=-y*s+z*c}e[l]=0,e[k]=f,q[k]=x}for(i=0;i<q.length;i++)q[i]<prec&&(q[i]=0);for(i=0;i<n;i++)for(j=i-1;j>=0;j--)if(q[j]<q[i]){for(c=q[j],q[j]=q[i],q[i]=c,k=0;k<u.length;k++)temp=u[k][i],u[k][i]=u[k][j],u[k][j]=temp;for(k=0;k<v.length;k++)temp=v[k][i],v[k][i]=v[k][j],v[k][j]=temp;i=j}return{U:u,S:q,V:v}}}).call(this,__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/buildin/global.js?8fce"))},"./node_modules/once/once.js":function(module,exports,__webpack_require__){var wrappy=__webpack_require__("./node_modules/wrappy/wrappy.js");function once(fn){var f=function(){return f.called?f.value:(f.called=!0,f.value=fn.apply(this,arguments))};return f.called=!1,f}function onceStrict(fn){var f=function(){if(f.called)throw new Error(f.onceError);return f.called=!0,f.value=fn.apply(this,arguments)},name=fn.name||"Function wrapped with `once`";return f.onceError=name+" shouldn't be called more than once",f.called=!1,f}module.exports=wrappy(once),module.exports.strict=wrappy(onceStrict),once.proto=once(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return once(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return onceStrict(this)},configurable:!0})})},"./node_modules/pako/index.js":function(module,exports,__webpack_require__){"use strict";var pako={};(0,__webpack_require__("./node_modules/pako/lib/utils/common.js").assign)(pako,__webpack_require__("./node_modules/pako/lib/deflate.js"),__webpack_require__("./node_modules/pako/lib/inflate.js"),__webpack_require__("./node_modules/pako/lib/zlib/constants.js")),module.exports=pako},"./node_modules/pako/lib/deflate.js":function(module,exports,__webpack_require__){"use strict";var zlib_deflate=__webpack_require__("./node_modules/pako/lib/zlib/deflate.js"),utils=__webpack_require__("./node_modules/pako/lib/utils/common.js"),strings=__webpack_require__("./node_modules/pako/lib/utils/strings.js"),msg=__webpack_require__("./node_modules/pako/lib/zlib/messages.js"),ZStream=__webpack_require__("./node_modules/pako/lib/zlib/zstream.js"),toString=Object.prototype.toString,Z_OK=0,Z_DEFAULT_COMPRESSION=-1,Z_DEFAULT_STRATEGY=0,Z_DEFLATED=8;function Deflate(options){if(!(this instanceof Deflate))return new Deflate(options);this.options=utils.assign({level:Z_DEFAULT_COMPRESSION,method:Z_DEFLATED,chunkSize:16384,windowBits:15,memLevel:8,strategy:Z_DEFAULT_STRATEGY,to:""},options||{});var opt=this.options;opt.raw&&opt.windowBits>0?opt.windowBits=-opt.windowBits:opt.gzip&&opt.windowBits>0&&opt.windowBits<16&&(opt.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ZStream,this.strm.avail_out=0;var status=zlib_deflate.deflateInit2(this.strm,opt.level,opt.method,opt.windowBits,opt.memLevel,opt.strategy);if(status!==Z_OK)throw new Error(msg[status]);if(opt.header&&zlib_deflate.deflateSetHeader(this.strm,opt.header),opt.dictionary){var dict;if(dict="string"==typeof opt.dictionary?strings.string2buf(opt.dictionary):"[object ArrayBuffer]"===toString.call(opt.dictionary)?new Uint8Array(opt.dictionary):opt.dictionary,(status=zlib_deflate.deflateSetDictionary(this.strm,dict))!==Z_OK)throw new Error(msg[status]);this._dict_set=!0}}function deflate(input,options){var deflator=new Deflate(options);if(deflator.push(input,!0),deflator.err)throw deflator.msg||msg[deflator.err];return deflator.result}Deflate.prototype.push=function(data,mode){var status,_mode,strm=this.strm,chunkSize=this.options.chunkSize;if(this.ended)return!1;_mode=mode===~~mode?mode:!0===mode?4:0,"string"==typeof data?strm.input=strings.string2buf(data):"[object ArrayBuffer]"===toString.call(data)?strm.input=new Uint8Array(data):strm.input=data,strm.next_in=0,strm.avail_in=strm.input.length;do{if(0===strm.avail_out&&(strm.output=new utils.Buf8(chunkSize),strm.next_out=0,strm.avail_out=chunkSize),1!==(status=zlib_deflate.deflate(strm,_mode))&&status!==Z_OK)return this.onEnd(status),this.ended=!0,!1;0!==strm.avail_out&&(0!==strm.avail_in||4!==_mode&&2!==_mode)||("string"===this.options.to?this.onData(strings.buf2binstring(utils.shrinkBuf(strm.output,strm.next_out))):this.onData(utils.shrinkBuf(strm.output,strm.next_out)))}while((strm.avail_in>0||0===strm.avail_out)&&1!==status);return 4===_mode?(status=zlib_deflate.deflateEnd(this.strm),this.onEnd(status),this.ended=!0,status===Z_OK):2!==_mode||(this.onEnd(Z_OK),strm.avail_out=0,!0)},Deflate.prototype.onData=function(chunk){this.chunks.push(chunk)},Deflate.prototype.onEnd=function(status){status===Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=utils.flattenChunks(this.chunks)),this.chunks=[],this.err=status,this.msg=this.strm.msg},exports.Deflate=Deflate,exports.deflate=deflate,exports.deflateRaw=function(input,options){return(options=options||{}).raw=!0,deflate(input,options)},exports.gzip=function(input,options){return(options=options||{}).gzip=!0,deflate(input,options)}},"./node_modules/pako/lib/inflate.js":function(module,exports,__webpack_require__){"use strict";var zlib_inflate=__webpack_require__("./node_modules/pako/lib/zlib/inflate.js"),utils=__webpack_require__("./node_modules/pako/lib/utils/common.js"),strings=__webpack_require__("./node_modules/pako/lib/utils/strings.js"),c=__webpack_require__("./node_modules/pako/lib/zlib/constants.js"),msg=__webpack_require__("./node_modules/pako/lib/zlib/messages.js"),ZStream=__webpack_require__("./node_modules/pako/lib/zlib/zstream.js"),GZheader=__webpack_require__("./node_modules/pako/lib/zlib/gzheader.js"),toString=Object.prototype.toString;function Inflate(options){if(!(this instanceof Inflate))return new Inflate(options);this.options=utils.assign({chunkSize:16384,windowBits:0,to:""},options||{});var opt=this.options;opt.raw&&opt.windowBits>=0&&opt.windowBits<16&&(opt.windowBits=-opt.windowBits,0===opt.windowBits&&(opt.windowBits=-15)),!(opt.windowBits>=0&&opt.windowBits<16)||options&&options.windowBits||(opt.windowBits+=32),opt.windowBits>15&&opt.windowBits<48&&0==(15&opt.windowBits)&&(opt.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ZStream,this.strm.avail_out=0;var status=zlib_inflate.inflateInit2(this.strm,opt.windowBits);if(status!==c.Z_OK)throw new Error(msg[status]);this.header=new GZheader,zlib_inflate.inflateGetHeader(this.strm,this.header)}function inflate(input,options){var inflator=new Inflate(options);if(inflator.push(input,!0),inflator.err)throw inflator.msg||msg[inflator.err];return inflator.result}Inflate.prototype.push=function(data,mode){var status,_mode,next_out_utf8,tail,utf8str,dict,strm=this.strm,chunkSize=this.options.chunkSize,dictionary=this.options.dictionary,allowBufError=!1;if(this.ended)return!1;_mode=mode===~~mode?mode:!0===mode?c.Z_FINISH:c.Z_NO_FLUSH,"string"==typeof data?strm.input=strings.binstring2buf(data):"[object ArrayBuffer]"===toString.call(data)?strm.input=new Uint8Array(data):strm.input=data,strm.next_in=0,strm.avail_in=strm.input.length;do{if(0===strm.avail_out&&(strm.output=new utils.Buf8(chunkSize),strm.next_out=0,strm.avail_out=chunkSize),(status=zlib_inflate.inflate(strm,c.Z_NO_FLUSH))===c.Z_NEED_DICT&&dictionary&&(dict="string"==typeof dictionary?strings.string2buf(dictionary):"[object ArrayBuffer]"===toString.call(dictionary)?new Uint8Array(dictionary):dictionary,status=zlib_inflate.inflateSetDictionary(this.strm,dict)),status===c.Z_BUF_ERROR&&!0===allowBufError&&(status=c.Z_OK,allowBufError=!1),status!==c.Z_STREAM_END&&status!==c.Z_OK)return this.onEnd(status),this.ended=!0,!1;strm.next_out&&(0!==strm.avail_out&&status!==c.Z_STREAM_END&&(0!==strm.avail_in||_mode!==c.Z_FINISH&&_mode!==c.Z_SYNC_FLUSH)||("string"===this.options.to?(next_out_utf8=strings.utf8border(strm.output,strm.next_out),tail=strm.next_out-next_out_utf8,utf8str=strings.buf2string(strm.output,next_out_utf8),strm.next_out=tail,strm.avail_out=chunkSize-tail,tail&&utils.arraySet(strm.output,strm.output,next_out_utf8,tail,0),this.onData(utf8str)):this.onData(utils.shrinkBuf(strm.output,strm.next_out)))),0===strm.avail_in&&0===strm.avail_out&&(allowBufError=!0)}while((strm.avail_in>0||0===strm.avail_out)&&status!==c.Z_STREAM_END);return status===c.Z_STREAM_END&&(_mode=c.Z_FINISH),_mode===c.Z_FINISH?(status=zlib_inflate.inflateEnd(this.strm),this.onEnd(status),this.ended=!0,status===c.Z_OK):_mode!==c.Z_SYNC_FLUSH||(this.onEnd(c.Z_OK),strm.avail_out=0,!0)},Inflate.prototype.onData=function(chunk){this.chunks.push(chunk)},Inflate.prototype.onEnd=function(status){status===c.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=utils.flattenChunks(this.chunks)),this.chunks=[],this.err=status,this.msg=this.strm.msg},exports.Inflate=Inflate,exports.inflate=inflate,exports.inflateRaw=function(input,options){return(options=options||{}).raw=!0,inflate(input,options)},exports.ungzip=inflate},"./node_modules/pako/lib/utils/common.js":function(module,exports,__webpack_require__){"use strict";var TYPED_OK="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function _has(obj,key){return Object.prototype.hasOwnProperty.call(obj,key)}exports.assign=function(obj){for(var sources=Array.prototype.slice.call(arguments,1);sources.length;){var source=sources.shift();if(source){if("object"!=typeof source)throw new TypeError(source+"must be non-object");for(var p in source)_has(source,p)&&(obj[p]=source[p])}}return obj},exports.shrinkBuf=function(buf,size){return buf.length===size?buf:buf.subarray?buf.subarray(0,size):(buf.length=size,buf)};var fnTyped={arraySet:function(dest,src,src_offs,len,dest_offs){if(src.subarray&&dest.subarray)dest.set(src.subarray(src_offs,src_offs+len),dest_offs);else for(var i=0;i<len;i++)dest[dest_offs+i]=src[src_offs+i]},flattenChunks:function(chunks){var i,l,len,pos,chunk,result;for(len=0,i=0,l=chunks.length;i<l;i++)len+=chunks[i].length;for(result=new Uint8Array(len),pos=0,i=0,l=chunks.length;i<l;i++)chunk=chunks[i],result.set(chunk,pos),pos+=chunk.length;return result}},fnUntyped={arraySet:function(dest,src,src_offs,len,dest_offs){for(var i=0;i<len;i++)dest[dest_offs+i]=src[src_offs+i]},flattenChunks:function(chunks){return[].concat.apply([],chunks)}};exports.setTyped=function(on){on?(exports.Buf8=Uint8Array,exports.Buf16=Uint16Array,exports.Buf32=Int32Array,exports.assign(exports,fnTyped)):(exports.Buf8=Array,exports.Buf16=Array,exports.Buf32=Array,exports.assign(exports,fnUntyped))},exports.setTyped(TYPED_OK)},"./node_modules/pako/lib/utils/strings.js":function(module,exports,__webpack_require__){"use strict";var utils=__webpack_require__("./node_modules/pako/lib/utils/common.js"),STR_APPLY_OK=!0,STR_APPLY_UIA_OK=!0;try{String.fromCharCode.apply(null,[0])}catch(__){STR_APPLY_OK=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(__){STR_APPLY_UIA_OK=!1}for(var _utf8len=new utils.Buf8(256),q=0;q<256;q++)_utf8len[q]=q>=252?6:q>=248?5:q>=240?4:q>=224?3:q>=192?2:1;function buf2binstring(buf,len){if(len<65534&&(buf.subarray&&STR_APPLY_UIA_OK||!buf.subarray&&STR_APPLY_OK))return String.fromCharCode.apply(null,utils.shrinkBuf(buf,len));for(var result="",i=0;i<len;i++)result+=String.fromCharCode(buf[i]);return result}_utf8len[254]=_utf8len[254]=1,exports.string2buf=function(str){var buf,c,c2,m_pos,i,str_len=str.length,buf_len=0;for(m_pos=0;m_pos<str_len;m_pos++)55296==(64512&(c=str.charCodeAt(m_pos)))&&m_pos+1<str_len&&56320==(64512&(c2=str.charCodeAt(m_pos+1)))&&(c=65536+(c-55296<<10)+(c2-56320),m_pos++),buf_len+=c<128?1:c<2048?2:c<65536?3:4;for(buf=new utils.Buf8(buf_len),i=0,m_pos=0;i<buf_len;m_pos++)55296==(64512&(c=str.charCodeAt(m_pos)))&&m_pos+1<str_len&&56320==(64512&(c2=str.charCodeAt(m_pos+1)))&&(c=65536+(c-55296<<10)+(c2-56320),m_pos++),c<128?buf[i++]=c:c<2048?(buf[i++]=192|c>>>6,buf[i++]=128|63&c):c<65536?(buf[i++]=224|c>>>12,buf[i++]=128|c>>>6&63,buf[i++]=128|63&c):(buf[i++]=240|c>>>18,buf[i++]=128|c>>>12&63,buf[i++]=128|c>>>6&63,buf[i++]=128|63&c);return buf},exports.buf2binstring=function(buf){return buf2binstring(buf,buf.length)},exports.binstring2buf=function(str){for(var buf=new utils.Buf8(str.length),i=0,len=buf.length;i<len;i++)buf[i]=str.charCodeAt(i);return buf},exports.buf2string=function(buf,max){var i,out,c,c_len,len=max||buf.length,utf16buf=new Array(2*len);for(out=0,i=0;i<len;)if((c=buf[i++])<128)utf16buf[out++]=c;else if((c_len=_utf8len[c])>4)utf16buf[out++]=65533,i+=c_len-1;else{for(c&=2===c_len?31:3===c_len?15:7;c_len>1&&i<len;)c=c<<6|63&buf[i++],c_len--;c_len>1?utf16buf[out++]=65533:c<65536?utf16buf[out++]=c:(c-=65536,utf16buf[out++]=55296|c>>10&1023,utf16buf[out++]=56320|1023&c)}return buf2binstring(utf16buf,out)},exports.utf8border=function(buf,max){var pos;for((max=max||buf.length)>buf.length&&(max=buf.length),pos=max-1;pos>=0&&128==(192&buf[pos]);)pos--;return pos<0?max:0===pos?max:pos+_utf8len[buf[pos]]>max?pos:max}},"./node_modules/pako/lib/zlib/adler32.js":function(module,exports,__webpack_require__){"use strict";module.exports=function(adler,buf,len,pos){for(var s1=65535&adler|0,s2=adler>>>16&65535|0,n=0;0!==len;){len-=n=len>2e3?2e3:len;do{s2=s2+(s1=s1+buf[pos++]|0)|0}while(--n);s1%=65521,s2%=65521}return s1|s2<<16|0}},"./node_modules/pako/lib/zlib/constants.js":function(module,exports,__webpack_require__){"use strict";module.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},"./node_modules/pako/lib/zlib/crc32.js":function(module,exports,__webpack_require__){"use strict";var crcTable=function(){for(var c,table=[],n=0;n<256;n++){c=n;for(var k=0;k<8;k++)c=1&c?3988292384^c>>>1:c>>>1;table[n]=c}return table}();module.exports=function(crc,buf,len,pos){var t=crcTable,end=pos+len;crc^=-1;for(var i=pos;i<end;i++)crc=crc>>>8^t[255&(crc^buf[i])];return-1^crc}},"./node_modules/pako/lib/zlib/deflate.js":function(module,exports,__webpack_require__){"use strict";var configuration_table,utils=__webpack_require__("./node_modules/pako/lib/utils/common.js"),trees=__webpack_require__("./node_modules/pako/lib/zlib/trees.js"),adler32=__webpack_require__("./node_modules/pako/lib/zlib/adler32.js"),crc32=__webpack_require__("./node_modules/pako/lib/zlib/crc32.js"),msg=__webpack_require__("./node_modules/pako/lib/zlib/messages.js"),Z_NO_FLUSH=0,Z_PARTIAL_FLUSH=1,Z_FULL_FLUSH=3,Z_FINISH=4,Z_BLOCK=5,Z_OK=0,Z_STREAM_END=1,Z_STREAM_ERROR=-2,Z_DATA_ERROR=-3,Z_BUF_ERROR=-5,Z_DEFAULT_COMPRESSION=-1,Z_FILTERED=1,Z_HUFFMAN_ONLY=2,Z_RLE=3,Z_FIXED=4,Z_DEFAULT_STRATEGY=0,Z_UNKNOWN=2,Z_DEFLATED=8,MAX_MEM_LEVEL=9,MAX_WBITS=15,DEF_MEM_LEVEL=8,L_CODES=286,D_CODES=30,BL_CODES=19,HEAP_SIZE=2*L_CODES+1,MAX_BITS=15,MIN_MATCH=3,MAX_MATCH=258,MIN_LOOKAHEAD=MAX_MATCH+MIN_MATCH+1,PRESET_DICT=32,INIT_STATE=42,EXTRA_STATE=69,NAME_STATE=73,COMMENT_STATE=91,HCRC_STATE=103,BUSY_STATE=113,FINISH_STATE=666,BS_NEED_MORE=1,BS_BLOCK_DONE=2,BS_FINISH_STARTED=3,BS_FINISH_DONE=4,OS_CODE=3;function err(strm,errorCode){return strm.msg=msg[errorCode],errorCode}function rank(f){return(f<<1)-(f>4?9:0)}function zero(buf){for(var len=buf.length;--len>=0;)buf[len]=0}function flush_pending(strm){var s=strm.state,len=s.pending;len>strm.avail_out&&(len=strm.avail_out),0!==len&&(utils.arraySet(strm.output,s.pending_buf,s.pending_out,len,strm.next_out),strm.next_out+=len,s.pending_out+=len,strm.total_out+=len,strm.avail_out-=len,s.pending-=len,0===s.pending&&(s.pending_out=0))}function flush_block_only(s,last){trees._tr_flush_block(s,s.block_start>=0?s.block_start:-1,s.strstart-s.block_start,last),s.block_start=s.strstart,flush_pending(s.strm)}function put_byte(s,b){s.pending_buf[s.pending++]=b}function putShortMSB(s,b){s.pending_buf[s.pending++]=b>>>8&255,s.pending_buf[s.pending++]=255&b}function longest_match(s,cur_match){var match,len,chain_length=s.max_chain_length,scan=s.strstart,best_len=s.prev_length,nice_match=s.nice_match,limit=s.strstart>s.w_size-MIN_LOOKAHEAD?s.strstart-(s.w_size-MIN_LOOKAHEAD):0,_win=s.window,wmask=s.w_mask,prev=s.prev,strend=s.strstart+MAX_MATCH,scan_end1=_win[scan+best_len-1],scan_end=_win[scan+best_len];s.prev_length>=s.good_match&&(chain_length>>=2),nice_match>s.lookahead&&(nice_match=s.lookahead);do{if(_win[(match=cur_match)+best_len]===scan_end&&_win[match+best_len-1]===scan_end1&&_win[match]===_win[scan]&&_win[++match]===_win[scan+1]){scan+=2,match++;do{}while(_win[++scan]===_win[++match]&&_win[++scan]===_win[++match]&&_win[++scan]===_win[++match]&&_win[++scan]===_win[++match]&&_win[++scan]===_win[++match]&&_win[++scan]===_win[++match]&&_win[++scan]===_win[++match]&&_win[++scan]===_win[++match]&&scan<strend);if(len=MAX_MATCH-(strend-scan),scan=strend-MAX_MATCH,len>best_len){if(s.match_start=cur_match,best_len=len,len>=nice_match)break;scan_end1=_win[scan+best_len-1],scan_end=_win[scan+best_len]}}}while((cur_match=prev[cur_match&wmask])>limit&&0!=--chain_length);return best_len<=s.lookahead?best_len:s.lookahead}function fill_window(s){var p,n,m,more,str,strm,buf,start,size,len,_w_size=s.w_size;do{if(more=s.window_size-s.lookahead-s.strstart,s.strstart>=_w_size+(_w_size-MIN_LOOKAHEAD)){utils.arraySet(s.window,s.window,_w_size,_w_size,0),s.match_start-=_w_size,s.strstart-=_w_size,s.block_start-=_w_size,p=n=s.hash_size;do{m=s.head[--p],s.head[p]=m>=_w_size?m-_w_size:0}while(--n);p=n=_w_size;do{m=s.prev[--p],s.prev[p]=m>=_w_size?m-_w_size:0}while(--n);more+=_w_size}if(0===s.strm.avail_in)break;if(strm=s.strm,buf=s.window,start=s.strstart+s.lookahead,size=more,len=void 0,(len=strm.avail_in)>size&&(len=size),n=0===len?0:(strm.avail_in-=len,utils.arraySet(buf,strm.input,strm.next_in,len,start),1===strm.state.wrap?strm.adler=adler32(strm.adler,buf,len,start):2===strm.state.wrap&&(strm.adler=crc32(strm.adler,buf,len,start)),strm.next_in+=len,strm.total_in+=len,len),s.lookahead+=n,s.lookahead+s.insert>=MIN_MATCH)for(str=s.strstart-s.insert,s.ins_h=s.window[str],s.ins_h=(s.ins_h<<s.hash_shift^s.window[str+1])&s.hash_mask;s.insert&&(s.ins_h=(s.ins_h<<s.hash_shift^s.window[str+MIN_MATCH-1])&s.hash_mask,s.prev[str&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=str,str++,s.insert--,!(s.lookahead+s.insert<MIN_MATCH)););}while(s.lookahead<MIN_LOOKAHEAD&&0!==s.strm.avail_in)}function deflate_fast(s,flush){for(var hash_head,bflush;;){if(s.lookahead<MIN_LOOKAHEAD){if(fill_window(s),s.lookahead<MIN_LOOKAHEAD&&flush===Z_NO_FLUSH)return BS_NEED_MORE;if(0===s.lookahead)break}if(hash_head=0,s.lookahead>=MIN_MATCH&&(s.ins_h=(s.ins_h<<s.hash_shift^s.window[s.strstart+MIN_MATCH-1])&s.hash_mask,hash_head=s.prev[s.strstart&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=s.strstart),0!==hash_head&&s.strstart-hash_head<=s.w_size-MIN_LOOKAHEAD&&(s.match_length=longest_match(s,hash_head)),s.match_length>=MIN_MATCH)if(bflush=trees._tr_tally(s,s.strstart-s.match_start,s.match_length-MIN_MATCH),s.lookahead-=s.match_length,s.match_length<=s.max_lazy_match&&s.lookahead>=MIN_MATCH){s.match_length--;do{s.strstart++,s.ins_h=(s.ins_h<<s.hash_shift^s.window[s.strstart+MIN_MATCH-1])&s.hash_mask,hash_head=s.prev[s.strstart&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=s.strstart}while(0!=--s.match_length);s.strstart++}else s.strstart+=s.match_length,s.match_length=0,s.ins_h=s.window[s.strstart],s.ins_h=(s.ins_h<<s.hash_shift^s.window[s.strstart+1])&s.hash_mask;else bflush=trees._tr_tally(s,0,s.window[s.strstart]),s.lookahead--,s.strstart++;if(bflush&&(flush_block_only(s,!1),0===s.strm.avail_out))return BS_NEED_MORE}return s.insert=s.strstart<MIN_MATCH-1?s.strstart:MIN_MATCH-1,flush===Z_FINISH?(flush_block_only(s,!0),0===s.strm.avail_out?BS_FINISH_STARTED:BS_FINISH_DONE):s.last_lit&&(flush_block_only(s,!1),0===s.strm.avail_out)?BS_NEED_MORE:BS_BLOCK_DONE}function deflate_slow(s,flush){for(var hash_head,bflush,max_insert;;){if(s.lookahead<MIN_LOOKAHEAD){if(fill_window(s),s.lookahead<MIN_LOOKAHEAD&&flush===Z_NO_FLUSH)return BS_NEED_MORE;if(0===s.lookahead)break}if(hash_head=0,s.lookahead>=MIN_MATCH&&(s.ins_h=(s.ins_h<<s.hash_shift^s.window[s.strstart+MIN_MATCH-1])&s.hash_mask,hash_head=s.prev[s.strstart&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=s.strstart),s.prev_length=s.match_length,s.prev_match=s.match_start,s.match_length=MIN_MATCH-1,0!==hash_head&&s.prev_length<s.max_lazy_match&&s.strstart-hash_head<=s.w_size-MIN_LOOKAHEAD&&(s.match_length=longest_match(s,hash_head),s.match_length<=5&&(s.strategy===Z_FILTERED||s.match_length===MIN_MATCH&&s.strstart-s.match_start>4096)&&(s.match_length=MIN_MATCH-1)),s.prev_length>=MIN_MATCH&&s.match_length<=s.prev_length){max_insert=s.strstart+s.lookahead-MIN_MATCH,bflush=trees._tr_tally(s,s.strstart-1-s.prev_match,s.prev_length-MIN_MATCH),s.lookahead-=s.prev_length-1,s.prev_length-=2;do{++s.strstart<=max_insert&&(s.ins_h=(s.ins_h<<s.hash_shift^s.window[s.strstart+MIN_MATCH-1])&s.hash_mask,hash_head=s.prev[s.strstart&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=s.strstart)}while(0!=--s.prev_length);if(s.match_available=0,s.match_length=MIN_MATCH-1,s.strstart++,bflush&&(flush_block_only(s,!1),0===s.strm.avail_out))return BS_NEED_MORE}else if(s.match_available){if((bflush=trees._tr_tally(s,0,s.window[s.strstart-1]))&&flush_block_only(s,!1),s.strstart++,s.lookahead--,0===s.strm.avail_out)return BS_NEED_MORE}else s.match_available=1,s.strstart++,s.lookahead--}return s.match_available&&(bflush=trees._tr_tally(s,0,s.window[s.strstart-1]),s.match_available=0),s.insert=s.strstart<MIN_MATCH-1?s.strstart:MIN_MATCH-1,flush===Z_FINISH?(flush_block_only(s,!0),0===s.strm.avail_out?BS_FINISH_STARTED:BS_FINISH_DONE):s.last_lit&&(flush_block_only(s,!1),0===s.strm.avail_out)?BS_NEED_MORE:BS_BLOCK_DONE}function Config(good_length,max_lazy,nice_length,max_chain,func){this.good_length=good_length,this.max_lazy=max_lazy,this.nice_length=nice_length,this.max_chain=max_chain,this.func=func}function deflateResetKeep(strm){var s;return strm&&strm.state?(strm.total_in=strm.total_out=0,strm.data_type=Z_UNKNOWN,(s=strm.state).pending=0,s.pending_out=0,s.wrap<0&&(s.wrap=-s.wrap),s.status=s.wrap?INIT_STATE:BUSY_STATE,strm.adler=2===s.wrap?0:1,s.last_flush=Z_NO_FLUSH,trees._tr_init(s),Z_OK):err(strm,Z_STREAM_ERROR)}function deflateReset(strm){var s,ret=deflateResetKeep(strm);return ret===Z_OK&&((s=strm.state).window_size=2*s.w_size,zero(s.head),s.max_lazy_match=configuration_table[s.level].max_lazy,s.good_match=configuration_table[s.level].good_length,s.nice_match=configuration_table[s.level].nice_length,s.max_chain_length=configuration_table[s.level].max_chain,s.strstart=0,s.block_start=0,s.lookahead=0,s.insert=0,s.match_length=s.prev_length=MIN_MATCH-1,s.match_available=0,s.ins_h=0),ret}function deflateInit2(strm,level,method,windowBits,memLevel,strategy){if(!strm)return Z_STREAM_ERROR;var wrap=1;if(level===Z_DEFAULT_COMPRESSION&&(level=6),windowBits<0?(wrap=0,windowBits=-windowBits):windowBits>15&&(wrap=2,windowBits-=16),memLevel<1||memLevel>MAX_MEM_LEVEL||method!==Z_DEFLATED||windowBits<8||windowBits>15||level<0||level>9||strategy<0||strategy>Z_FIXED)return err(strm,Z_STREAM_ERROR);8===windowBits&&(windowBits=9);var s=new function(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Z_DEFLATED,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new utils.Buf16(2*HEAP_SIZE),this.dyn_dtree=new utils.Buf16(2*(2*D_CODES+1)),this.bl_tree=new utils.Buf16(2*(2*BL_CODES+1)),zero(this.dyn_ltree),zero(this.dyn_dtree),zero(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new utils.Buf16(MAX_BITS+1),this.heap=new utils.Buf16(2*L_CODES+1),zero(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new utils.Buf16(2*L_CODES+1),zero(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0};return strm.state=s,s.strm=strm,s.wrap=wrap,s.gzhead=null,s.w_bits=windowBits,s.w_size=1<<s.w_bits,s.w_mask=s.w_size-1,s.hash_bits=memLevel+7,s.hash_size=1<<s.hash_bits,s.hash_mask=s.hash_size-1,s.hash_shift=~~((s.hash_bits+MIN_MATCH-1)/MIN_MATCH),s.window=new utils.Buf8(2*s.w_size),s.head=new utils.Buf16(s.hash_size),s.prev=new utils.Buf16(s.w_size),s.lit_bufsize=1<<memLevel+6,s.pending_buf_size=4*s.lit_bufsize,s.pending_buf=new utils.Buf8(s.pending_buf_size),s.d_buf=1*s.lit_bufsize,s.l_buf=3*s.lit_bufsize,s.level=level,s.strategy=strategy,s.method=method,deflateReset(strm)}configuration_table=[new Config(0,0,0,0,function(s,flush){var max_block_size=65535;for(max_block_size>s.pending_buf_size-5&&(max_block_size=s.pending_buf_size-5);;){if(s.lookahead<=1){if(fill_window(s),0===s.lookahead&&flush===Z_NO_FLUSH)return BS_NEED_MORE;if(0===s.lookahead)break}s.strstart+=s.lookahead,s.lookahead=0;var max_start=s.block_start+max_block_size;if((0===s.strstart||s.strstart>=max_start)&&(s.lookahead=s.strstart-max_start,s.strstart=max_start,flush_block_only(s,!1),0===s.strm.avail_out))return BS_NEED_MORE;if(s.strstart-s.block_start>=s.w_size-MIN_LOOKAHEAD&&(flush_block_only(s,!1),0===s.strm.avail_out))return BS_NEED_MORE}return s.insert=0,flush===Z_FINISH?(flush_block_only(s,!0),0===s.strm.avail_out?BS_FINISH_STARTED:BS_FINISH_DONE):(s.strstart>s.block_start&&(flush_block_only(s,!1),s.strm.avail_out),BS_NEED_MORE)}),new Config(4,4,8,4,deflate_fast),new Config(4,5,16,8,deflate_fast),new Config(4,6,32,32,deflate_fast),new Config(4,4,16,16,deflate_slow),new Config(8,16,32,32,deflate_slow),new Config(8,16,128,128,deflate_slow),new Config(8,32,128,256,deflate_slow),new Config(32,128,258,1024,deflate_slow),new Config(32,258,258,4096,deflate_slow)],exports.deflateInit=function(strm,level){return deflateInit2(strm,level,Z_DEFLATED,MAX_WBITS,DEF_MEM_LEVEL,Z_DEFAULT_STRATEGY)},exports.deflateInit2=deflateInit2,exports.deflateReset=deflateReset,exports.deflateResetKeep=deflateResetKeep,exports.deflateSetHeader=function(strm,head){return strm&&strm.state?2!==strm.state.wrap?Z_STREAM_ERROR:(strm.state.gzhead=head,Z_OK):Z_STREAM_ERROR},exports.deflate=function(strm,flush){var old_flush,s,beg,val;if(!strm||!strm.state||flush>Z_BLOCK||flush<0)return strm?err(strm,Z_STREAM_ERROR):Z_STREAM_ERROR;if(s=strm.state,!strm.output||!strm.input&&0!==strm.avail_in||s.status===FINISH_STATE&&flush!==Z_FINISH)return err(strm,0===strm.avail_out?Z_BUF_ERROR:Z_STREAM_ERROR);if(s.strm=strm,old_flush=s.last_flush,s.last_flush=flush,s.status===INIT_STATE)if(2===s.wrap)strm.adler=0,put_byte(s,31),put_byte(s,139),put_byte(s,8),s.gzhead?(put_byte(s,(s.gzhead.text?1:0)+(s.gzhead.hcrc?2:0)+(s.gzhead.extra?4:0)+(s.gzhead.name?8:0)+(s.gzhead.comment?16:0)),put_byte(s,255&s.gzhead.time),put_byte(s,s.gzhead.time>>8&255),put_byte(s,s.gzhead.time>>16&255),put_byte(s,s.gzhead.time>>24&255),put_byte(s,9===s.level?2:s.strategy>=Z_HUFFMAN_ONLY||s.level<2?4:0),put_byte(s,255&s.gzhead.os),s.gzhead.extra&&s.gzhead.extra.length&&(put_byte(s,255&s.gzhead.extra.length),put_byte(s,s.gzhead.extra.length>>8&255)),s.gzhead.hcrc&&(strm.adler=crc32(strm.adler,s.pending_buf,s.pending,0)),s.gzindex=0,s.status=EXTRA_STATE):(put_byte(s,0),put_byte(s,0),put_byte(s,0),put_byte(s,0),put_byte(s,0),put_byte(s,9===s.level?2:s.strategy>=Z_HUFFMAN_ONLY||s.level<2?4:0),put_byte(s,OS_CODE),s.status=BUSY_STATE);else{var header=Z_DEFLATED+(s.w_bits-8<<4)<<8;header|=(s.strategy>=Z_HUFFMAN_ONLY||s.level<2?0:s.level<6?1:6===s.level?2:3)<<6,0!==s.strstart&&(header|=PRESET_DICT),header+=31-header%31,s.status=BUSY_STATE,putShortMSB(s,header),0!==s.strstart&&(putShortMSB(s,strm.adler>>>16),putShortMSB(s,65535&strm.adler)),strm.adler=1}if(s.status===EXTRA_STATE)if(s.gzhead.extra){for(beg=s.pending;s.gzindex<(65535&s.gzhead.extra.length)&&(s.pending!==s.pending_buf_size||(s.gzhead.hcrc&&s.pending>beg&&(strm.adler=crc32(strm.adler,s.pending_buf,s.pending-beg,beg)),flush_pending(strm),beg=s.pending,s.pending!==s.pending_buf_size));)put_byte(s,255&s.gzhead.extra[s.gzindex]),s.gzindex++;s.gzhead.hcrc&&s.pending>beg&&(strm.adler=crc32(strm.adler,s.pending_buf,s.pending-beg,beg)),s.gzindex===s.gzhead.extra.length&&(s.gzindex=0,s.status=NAME_STATE)}else s.status=NAME_STATE;if(s.status===NAME_STATE)if(s.gzhead.name){beg=s.pending;do{if(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>beg&&(strm.adler=crc32(strm.adler,s.pending_buf,s.pending-beg,beg)),flush_pending(strm),beg=s.pending,s.pending===s.pending_buf_size)){val=1;break}val=s.gzindex<s.gzhead.name.length?255&s.gzhead.name.charCodeAt(s.gzindex++):0,put_byte(s,val)}while(0!==val);s.gzhead.hcrc&&s.pending>beg&&(strm.adler=crc32(strm.adler,s.pending_buf,s.pending-beg,beg)),0===val&&(s.gzindex=0,s.status=COMMENT_STATE)}else s.status=COMMENT_STATE;if(s.status===COMMENT_STATE)if(s.gzhead.comment){beg=s.pending;do{if(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>beg&&(strm.adler=crc32(strm.adler,s.pending_buf,s.pending-beg,beg)),flush_pending(strm),beg=s.pending,s.pending===s.pending_buf_size)){val=1;break}val=s.gzindex<s.gzhead.comment.length?255&s.gzhead.comment.charCodeAt(s.gzindex++):0,put_byte(s,val)}while(0!==val);s.gzhead.hcrc&&s.pending>beg&&(strm.adler=crc32(strm.adler,s.pending_buf,s.pending-beg,beg)),0===val&&(s.status=HCRC_STATE)}else s.status=HCRC_STATE;if(s.status===HCRC_STATE&&(s.gzhead.hcrc?(s.pending+2>s.pending_buf_size&&flush_pending(strm),s.pending+2<=s.pending_buf_size&&(put_byte(s,255&strm.adler),put_byte(s,strm.adler>>8&255),strm.adler=0,s.status=BUSY_STATE)):s.status=BUSY_STATE),0!==s.pending){if(flush_pending(strm),0===strm.avail_out)return s.last_flush=-1,Z_OK}else if(0===strm.avail_in&&rank(flush)<=rank(old_flush)&&flush!==Z_FINISH)return err(strm,Z_BUF_ERROR);if(s.status===FINISH_STATE&&0!==strm.avail_in)return err(strm,Z_BUF_ERROR);if(0!==strm.avail_in||0!==s.lookahead||flush!==Z_NO_FLUSH&&s.status!==FINISH_STATE){var bstate=s.strategy===Z_HUFFMAN_ONLY?function(s,flush){for(var bflush;;){if(0===s.lookahead&&(fill_window(s),0===s.lookahead)){if(flush===Z_NO_FLUSH)return BS_NEED_MORE;break}if(s.match_length=0,bflush=trees._tr_tally(s,0,s.window[s.strstart]),s.lookahead--,s.strstart++,bflush&&(flush_block_only(s,!1),0===s.strm.avail_out))return BS_NEED_MORE}return s.insert=0,flush===Z_FINISH?(flush_block_only(s,!0),0===s.strm.avail_out?BS_FINISH_STARTED:BS_FINISH_DONE):s.last_lit&&(flush_block_only(s,!1),0===s.strm.avail_out)?BS_NEED_MORE:BS_BLOCK_DONE}(s,flush):s.strategy===Z_RLE?function(s,flush){for(var bflush,prev,scan,strend,_win=s.window;;){if(s.lookahead<=MAX_MATCH){if(fill_window(s),s.lookahead<=MAX_MATCH&&flush===Z_NO_FLUSH)return BS_NEED_MORE;if(0===s.lookahead)break}if(s.match_length=0,s.lookahead>=MIN_MATCH&&s.strstart>0&&(prev=_win[scan=s.strstart-1])===_win[++scan]&&prev===_win[++scan]&&prev===_win[++scan]){strend=s.strstart+MAX_MATCH;do{}while(prev===_win[++scan]&&prev===_win[++scan]&&prev===_win[++scan]&&prev===_win[++scan]&&prev===_win[++scan]&&prev===_win[++scan]&&prev===_win[++scan]&&prev===_win[++scan]&&scan<strend);s.match_length=MAX_MATCH-(strend-scan),s.match_length>s.lookahead&&(s.match_length=s.lookahead)}if(s.match_length>=MIN_MATCH?(bflush=trees._tr_tally(s,1,s.match_length-MIN_MATCH),s.lookahead-=s.match_length,s.strstart+=s.match_length,s.match_length=0):(bflush=trees._tr_tally(s,0,s.window[s.strstart]),s.lookahead--,s.strstart++),bflush&&(flush_block_only(s,!1),0===s.strm.avail_out))return BS_NEED_MORE}return s.insert=0,flush===Z_FINISH?(flush_block_only(s,!0),0===s.strm.avail_out?BS_FINISH_STARTED:BS_FINISH_DONE):s.last_lit&&(flush_block_only(s,!1),0===s.strm.avail_out)?BS_NEED_MORE:BS_BLOCK_DONE}(s,flush):configuration_table[s.level].func(s,flush);if(bstate!==BS_FINISH_STARTED&&bstate!==BS_FINISH_DONE||(s.status=FINISH_STATE),bstate===BS_NEED_MORE||bstate===BS_FINISH_STARTED)return 0===strm.avail_out&&(s.last_flush=-1),Z_OK;if(bstate===BS_BLOCK_DONE&&(flush===Z_PARTIAL_FLUSH?trees._tr_align(s):flush!==Z_BLOCK&&(trees._tr_stored_block(s,0,0,!1),flush===Z_FULL_FLUSH&&(zero(s.head),0===s.lookahead&&(s.strstart=0,s.block_start=0,s.insert=0))),flush_pending(strm),0===strm.avail_out))return s.last_flush=-1,Z_OK}return flush!==Z_FINISH?Z_OK:s.wrap<=0?Z_STREAM_END:(2===s.wrap?(put_byte(s,255&strm.adler),put_byte(s,strm.adler>>8&255),put_byte(s,strm.adler>>16&255),put_byte(s,strm.adler>>24&255),put_byte(s,255&strm.total_in),put_byte(s,strm.total_in>>8&255),put_byte(s,strm.total_in>>16&255),put_byte(s,strm.total_in>>24&255)):(putShortMSB(s,strm.adler>>>16),putShortMSB(s,65535&strm.adler)),flush_pending(strm),s.wrap>0&&(s.wrap=-s.wrap),0!==s.pending?Z_OK:Z_STREAM_END)},exports.deflateEnd=function(strm){var status;return strm&&strm.state?(status=strm.state.status)!==INIT_STATE&&status!==EXTRA_STATE&&status!==NAME_STATE&&status!==COMMENT_STATE&&status!==HCRC_STATE&&status!==BUSY_STATE&&status!==FINISH_STATE?err(strm,Z_STREAM_ERROR):(strm.state=null,status===BUSY_STATE?err(strm,Z_DATA_ERROR):Z_OK):Z_STREAM_ERROR},exports.deflateSetDictionary=function(strm,dictionary){var s,str,n,wrap,avail,next,input,tmpDict,dictLength=dictionary.length;if(!strm||!strm.state)return Z_STREAM_ERROR;if(2===(wrap=(s=strm.state).wrap)||1===wrap&&s.status!==INIT_STATE||s.lookahead)return Z_STREAM_ERROR;for(1===wrap&&(strm.adler=adler32(strm.adler,dictionary,dictLength,0)),s.wrap=0,dictLength>=s.w_size&&(0===wrap&&(zero(s.head),s.strstart=0,s.block_start=0,s.insert=0),tmpDict=new utils.Buf8(s.w_size),utils.arraySet(tmpDict,dictionary,dictLength-s.w_size,s.w_size,0),dictionary=tmpDict,dictLength=s.w_size),avail=strm.avail_in,next=strm.next_in,input=strm.input,strm.avail_in=dictLength,strm.next_in=0,strm.input=dictionary,fill_window(s);s.lookahead>=MIN_MATCH;){str=s.strstart,n=s.lookahead-(MIN_MATCH-1);do{s.ins_h=(s.ins_h<<s.hash_shift^s.window[str+MIN_MATCH-1])&s.hash_mask,s.prev[str&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=str,str++}while(--n);s.strstart=str,s.lookahead=MIN_MATCH-1,fill_window(s)}return s.strstart+=s.lookahead,s.block_start=s.strstart,s.insert=s.lookahead,s.lookahead=0,s.match_length=s.prev_length=MIN_MATCH-1,s.match_available=0,strm.next_in=next,strm.input=input,strm.avail_in=avail,s.wrap=wrap,Z_OK},exports.deflateInfo="pako deflate (from Nodeca project)"},"./node_modules/pako/lib/zlib/gzheader.js":function(module,exports,__webpack_require__){"use strict";module.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},"./node_modules/pako/lib/zlib/inffast.js":function(module,exports,__webpack_require__){"use strict";module.exports=function(strm,start){var state,_in,last,_out,beg,end,dmax,wsize,whave,wnext,s_window,hold,bits,lcode,dcode,lmask,dmask,here,op,len,dist,from,from_source,input,output;state=strm.state,_in=strm.next_in,input=strm.input,last=_in+(strm.avail_in-5),_out=strm.next_out,output=strm.output,beg=_out-(start-strm.avail_out),end=_out+(strm.avail_out-257),dmax=state.dmax,wsize=state.wsize,whave=state.whave,wnext=state.wnext,s_window=state.window,hold=state.hold,bits=state.bits,lcode=state.lencode,dcode=state.distcode,lmask=(1<<state.lenbits)-1,dmask=(1<<state.distbits)-1;top:do{bits<15&&(hold+=input[_in++]<<bits,bits+=8,hold+=input[_in++]<<bits,bits+=8),here=lcode[hold&lmask];dolen:for(;;){if(hold>>>=op=here>>>24,bits-=op,0===(op=here>>>16&255))output[_out++]=65535&here;else{if(!(16&op)){if(0==(64&op)){here=lcode[(65535&here)+(hold&(1<<op)-1)];continue dolen}if(32&op){state.mode=12;break top}strm.msg="invalid literal/length code",state.mode=30;break top}len=65535&here,(op&=15)&&(bits<op&&(hold+=input[_in++]<<bits,bits+=8),len+=hold&(1<<op)-1,hold>>>=op,bits-=op),bits<15&&(hold+=input[_in++]<<bits,bits+=8,hold+=input[_in++]<<bits,bits+=8),here=dcode[hold&dmask];dodist:for(;;){if(hold>>>=op=here>>>24,bits-=op,!(16&(op=here>>>16&255))){if(0==(64&op)){here=dcode[(65535&here)+(hold&(1<<op)-1)];continue dodist}strm.msg="invalid distance code",state.mode=30;break top}if(dist=65535&here,bits<(op&=15)&&(hold+=input[_in++]<<bits,(bits+=8)<op&&(hold+=input[_in++]<<bits,bits+=8)),(dist+=hold&(1<<op)-1)>dmax){strm.msg="invalid distance too far back",state.mode=30;break top}if(hold>>>=op,bits-=op,dist>(op=_out-beg)){if((op=dist-op)>whave&&state.sane){strm.msg="invalid distance too far back",state.mode=30;break top}if(from=0,from_source=s_window,0===wnext){if(from+=wsize-op,op<len){len-=op;do{output[_out++]=s_window[from++]}while(--op);from=_out-dist,from_source=output}}else if(wnext<op){if(from+=wsize+wnext-op,(op-=wnext)<len){len-=op;do{output[_out++]=s_window[from++]}while(--op);if(from=0,wnext<len){len-=op=wnext;do{output[_out++]=s_window[from++]}while(--op);from=_out-dist,from_source=output}}}else if(from+=wnext-op,op<len){len-=op;do{output[_out++]=s_window[from++]}while(--op);from=_out-dist,from_source=output}for(;len>2;)output[_out++]=from_source[from++],output[_out++]=from_source[from++],output[_out++]=from_source[from++],len-=3;len&&(output[_out++]=from_source[from++],len>1&&(output[_out++]=from_source[from++]))}else{from=_out-dist;do{output[_out++]=output[from++],output[_out++]=output[from++],output[_out++]=output[from++],len-=3}while(len>2);len&&(output[_out++]=output[from++],len>1&&(output[_out++]=output[from++]))}break}}break}}while(_in<last&&_out<end);_in-=len=bits>>3,hold&=(1<<(bits-=len<<3))-1,strm.next_in=_in,strm.next_out=_out,strm.avail_in=_in<last?last-_in+5:5-(_in-last),strm.avail_out=_out<end?end-_out+257:257-(_out-end),state.hold=hold,state.bits=bits}},"./node_modules/pako/lib/zlib/inflate.js":function(module,exports,__webpack_require__){"use strict";var utils=__webpack_require__("./node_modules/pako/lib/utils/common.js"),adler32=__webpack_require__("./node_modules/pako/lib/zlib/adler32.js"),crc32=__webpack_require__("./node_modules/pako/lib/zlib/crc32.js"),inflate_fast=__webpack_require__("./node_modules/pako/lib/zlib/inffast.js"),inflate_table=__webpack_require__("./node_modules/pako/lib/zlib/inftrees.js"),CODES=0,LENS=1,DISTS=2,Z_FINISH=4,Z_BLOCK=5,Z_TREES=6,Z_OK=0,Z_STREAM_END=1,Z_NEED_DICT=2,Z_STREAM_ERROR=-2,Z_DATA_ERROR=-3,Z_MEM_ERROR=-4,Z_BUF_ERROR=-5,Z_DEFLATED=8,HEAD=1,FLAGS=2,TIME=3,OS=4,EXLEN=5,EXTRA=6,NAME=7,COMMENT=8,HCRC=9,DICTID=10,DICT=11,TYPE=12,TYPEDO=13,STORED=14,COPY_=15,COPY=16,TABLE=17,LENLENS=18,CODELENS=19,LEN_=20,LEN=21,LENEXT=22,DIST=23,DISTEXT=24,MATCH=25,LIT=26,CHECK=27,LENGTH=28,DONE=29,BAD=30,MEM=31,SYNC=32,ENOUGH_LENS=852,ENOUGH_DISTS=592,DEF_WBITS=15;function zswap32(q){return(q>>>24&255)+(q>>>8&65280)+((65280&q)<<8)+((255&q)<<24)}function inflateResetKeep(strm){var state;return strm&&strm.state?(state=strm.state,strm.total_in=strm.total_out=state.total=0,strm.msg="",state.wrap&&(strm.adler=1&state.wrap),state.mode=HEAD,state.last=0,state.havedict=0,state.dmax=32768,state.head=null,state.hold=0,state.bits=0,state.lencode=state.lendyn=new utils.Buf32(ENOUGH_LENS),state.distcode=state.distdyn=new utils.Buf32(ENOUGH_DISTS),state.sane=1,state.back=-1,Z_OK):Z_STREAM_ERROR}function inflateReset(strm){var state;return strm&&strm.state?((state=strm.state).wsize=0,state.whave=0,state.wnext=0,inflateResetKeep(strm)):Z_STREAM_ERROR}function inflateReset2(strm,windowBits){var wrap,state;return strm&&strm.state?(state=strm.state,windowBits<0?(wrap=0,windowBits=-windowBits):(wrap=1+(windowBits>>4),windowBits<48&&(windowBits&=15)),windowBits&&(windowBits<8||windowBits>15)?Z_STREAM_ERROR:(null!==state.window&&state.wbits!==windowBits&&(state.window=null),state.wrap=wrap,state.wbits=windowBits,inflateReset(strm))):Z_STREAM_ERROR}function inflateInit2(strm,windowBits){var ret,state;return strm?(state=new function(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new utils.Buf16(320),this.work=new utils.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0},strm.state=state,state.window=null,(ret=inflateReset2(strm,windowBits))!==Z_OK&&(strm.state=null),ret):Z_STREAM_ERROR}var lenfix,distfix,virgin=!0;function fixedtables(state){if(virgin){var sym;for(lenfix=new utils.Buf32(512),distfix=new utils.Buf32(32),sym=0;sym<144;)state.lens[sym++]=8;for(;sym<256;)state.lens[sym++]=9;for(;sym<280;)state.lens[sym++]=7;for(;sym<288;)state.lens[sym++]=8;for(inflate_table(LENS,state.lens,0,288,lenfix,0,state.work,{bits:9}),sym=0;sym<32;)state.lens[sym++]=5;inflate_table(DISTS,state.lens,0,32,distfix,0,state.work,{bits:5}),virgin=!1}state.lencode=lenfix,state.lenbits=9,state.distcode=distfix,state.distbits=5}function updatewindow(strm,src,end,copy){var dist,state=strm.state;return null===state.window&&(state.wsize=1<<state.wbits,state.wnext=0,state.whave=0,state.window=new utils.Buf8(state.wsize)),copy>=state.wsize?(utils.arraySet(state.window,src,end-state.wsize,state.wsize,0),state.wnext=0,state.whave=state.wsize):((dist=state.wsize-state.wnext)>copy&&(dist=copy),utils.arraySet(state.window,src,end-copy,dist,state.wnext),(copy-=dist)?(utils.arraySet(state.window,src,end-copy,copy,0),state.wnext=copy,state.whave=state.wsize):(state.wnext+=dist,state.wnext===state.wsize&&(state.wnext=0),state.whave<state.wsize&&(state.whave+=dist))),0}exports.inflateReset=inflateReset,exports.inflateReset2=inflateReset2,exports.inflateResetKeep=inflateResetKeep,exports.inflateInit=function(strm){return inflateInit2(strm,DEF_WBITS)},exports.inflateInit2=inflateInit2,exports.inflate=function(strm,flush){var state,input,output,next,put,have,left,hold,bits,_in,_out,copy,from,from_source,here_bits,here_op,here_val,last_bits,last_op,last_val,len,ret,opts,n,here=0,hbuf=new utils.Buf8(4),order=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!strm||!strm.state||!strm.output||!strm.input&&0!==strm.avail_in)return Z_STREAM_ERROR;(state=strm.state).mode===TYPE&&(state.mode=TYPEDO),put=strm.next_out,output=strm.output,left=strm.avail_out,next=strm.next_in,input=strm.input,have=strm.avail_in,hold=state.hold,bits=state.bits,_in=have,_out=left,ret=Z_OK;inf_leave:for(;;)switch(state.mode){case HEAD:if(0===state.wrap){state.mode=TYPEDO;break}for(;bits<16;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(2&state.wrap&&35615===hold){state.check=0,hbuf[0]=255&hold,hbuf[1]=hold>>>8&255,state.check=crc32(state.check,hbuf,2,0),hold=0,bits=0,state.mode=FLAGS;break}if(state.flags=0,state.head&&(state.head.done=!1),!(1&state.wrap)||(((255&hold)<<8)+(hold>>8))%31){strm.msg="incorrect header check",state.mode=BAD;break}if((15&hold)!==Z_DEFLATED){strm.msg="unknown compression method",state.mode=BAD;break}if(bits-=4,len=8+(15&(hold>>>=4)),0===state.wbits)state.wbits=len;else if(len>state.wbits){strm.msg="invalid window size",state.mode=BAD;break}state.dmax=1<<len,strm.adler=state.check=1,state.mode=512&hold?DICTID:TYPE,hold=0,bits=0;break;case FLAGS:for(;bits<16;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(state.flags=hold,(255&state.flags)!==Z_DEFLATED){strm.msg="unknown compression method",state.mode=BAD;break}if(57344&state.flags){strm.msg="unknown header flags set",state.mode=BAD;break}state.head&&(state.head.text=hold>>8&1),512&state.flags&&(hbuf[0]=255&hold,hbuf[1]=hold>>>8&255,state.check=crc32(state.check,hbuf,2,0)),hold=0,bits=0,state.mode=TIME;case TIME:for(;bits<32;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}state.head&&(state.head.time=hold),512&state.flags&&(hbuf[0]=255&hold,hbuf[1]=hold>>>8&255,hbuf[2]=hold>>>16&255,hbuf[3]=hold>>>24&255,state.check=crc32(state.check,hbuf,4,0)),hold=0,bits=0,state.mode=OS;case OS:for(;bits<16;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}state.head&&(state.head.xflags=255&hold,state.head.os=hold>>8),512&state.flags&&(hbuf[0]=255&hold,hbuf[1]=hold>>>8&255,state.check=crc32(state.check,hbuf,2,0)),hold=0,bits=0,state.mode=EXLEN;case EXLEN:if(1024&state.flags){for(;bits<16;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}state.length=hold,state.head&&(state.head.extra_len=hold),512&state.flags&&(hbuf[0]=255&hold,hbuf[1]=hold>>>8&255,state.check=crc32(state.check,hbuf,2,0)),hold=0,bits=0}else state.head&&(state.head.extra=null);state.mode=EXTRA;case EXTRA:if(1024&state.flags&&((copy=state.length)>have&&(copy=have),copy&&(state.head&&(len=state.head.extra_len-state.length,state.head.extra||(state.head.extra=new Array(state.head.extra_len)),utils.arraySet(state.head.extra,input,next,copy,len)),512&state.flags&&(state.check=crc32(state.check,input,copy,next)),have-=copy,next+=copy,state.length-=copy),state.length))break inf_leave;state.length=0,state.mode=NAME;case NAME:if(2048&state.flags){if(0===have)break inf_leave;copy=0;do{len=input[next+copy++],state.head&&len&&state.length<65536&&(state.head.name+=String.fromCharCode(len))}while(len&&copy<have);if(512&state.flags&&(state.check=crc32(state.check,input,copy,next)),have-=copy,next+=copy,len)break inf_leave}else state.head&&(state.head.name=null);state.length=0,state.mode=COMMENT;case COMMENT:if(4096&state.flags){if(0===have)break inf_leave;copy=0;do{len=input[next+copy++],state.head&&len&&state.length<65536&&(state.head.comment+=String.fromCharCode(len))}while(len&&copy<have);if(512&state.flags&&(state.check=crc32(state.check,input,copy,next)),have-=copy,next+=copy,len)break inf_leave}else state.head&&(state.head.comment=null);state.mode=HCRC;case HCRC:if(512&state.flags){for(;bits<16;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(hold!==(65535&state.check)){strm.msg="header crc mismatch",state.mode=BAD;break}hold=0,bits=0}state.head&&(state.head.hcrc=state.flags>>9&1,state.head.done=!0),strm.adler=state.check=0,state.mode=TYPE;break;case DICTID:for(;bits<32;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}strm.adler=state.check=zswap32(hold),hold=0,bits=0,state.mode=DICT;case DICT:if(0===state.havedict)return strm.next_out=put,strm.avail_out=left,strm.next_in=next,strm.avail_in=have,state.hold=hold,state.bits=bits,Z_NEED_DICT;strm.adler=state.check=1,state.mode=TYPE;case TYPE:if(flush===Z_BLOCK||flush===Z_TREES)break inf_leave;case TYPEDO:if(state.last){hold>>>=7&bits,bits-=7&bits,state.mode=CHECK;break}for(;bits<3;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}switch(state.last=1&hold,bits-=1,3&(hold>>>=1)){case 0:state.mode=STORED;break;case 1:if(fixedtables(state),state.mode=LEN_,flush===Z_TREES){hold>>>=2,bits-=2;break inf_leave}break;case 2:state.mode=TABLE;break;case 3:strm.msg="invalid block type",state.mode=BAD}hold>>>=2,bits-=2;break;case STORED:for(hold>>>=7&bits,bits-=7&bits;bits<32;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if((65535&hold)!=(hold>>>16^65535)){strm.msg="invalid stored block lengths",state.mode=BAD;break}if(state.length=65535&hold,hold=0,bits=0,state.mode=COPY_,flush===Z_TREES)break inf_leave;case COPY_:state.mode=COPY;case COPY:if(copy=state.length){if(copy>have&&(copy=have),copy>left&&(copy=left),0===copy)break inf_leave;utils.arraySet(output,input,next,copy,put),have-=copy,next+=copy,left-=copy,put+=copy,state.length-=copy;break}state.mode=TYPE;break;case TABLE:for(;bits<14;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(state.nlen=257+(31&hold),hold>>>=5,bits-=5,state.ndist=1+(31&hold),hold>>>=5,bits-=5,state.ncode=4+(15&hold),hold>>>=4,bits-=4,state.nlen>286||state.ndist>30){strm.msg="too many length or distance symbols",state.mode=BAD;break}state.have=0,state.mode=LENLENS;case LENLENS:for(;state.have<state.ncode;){for(;bits<3;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}state.lens[order[state.have++]]=7&hold,hold>>>=3,bits-=3}for(;state.have<19;)state.lens[order[state.have++]]=0;if(state.lencode=state.lendyn,state.lenbits=7,opts={bits:state.lenbits},ret=inflate_table(CODES,state.lens,0,19,state.lencode,0,state.work,opts),state.lenbits=opts.bits,ret){strm.msg="invalid code lengths set",state.mode=BAD;break}state.have=0,state.mode=CODELENS;case CODELENS:for(;state.have<state.nlen+state.ndist;){for(;here_op=(here=state.lencode[hold&(1<<state.lenbits)-1])>>>16&255,here_val=65535&here,!((here_bits=here>>>24)<=bits);){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(here_val<16)hold>>>=here_bits,bits-=here_bits,state.lens[state.have++]=here_val;else{if(16===here_val){for(n=here_bits+2;bits<n;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(hold>>>=here_bits,bits-=here_bits,0===state.have){strm.msg="invalid bit length repeat",state.mode=BAD;break}len=state.lens[state.have-1],copy=3+(3&hold),hold>>>=2,bits-=2}else if(17===here_val){for(n=here_bits+3;bits<n;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}bits-=here_bits,len=0,copy=3+(7&(hold>>>=here_bits)),hold>>>=3,bits-=3}else{for(n=here_bits+7;bits<n;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}bits-=here_bits,len=0,copy=11+(127&(hold>>>=here_bits)),hold>>>=7,bits-=7}if(state.have+copy>state.nlen+state.ndist){strm.msg="invalid bit length repeat",state.mode=BAD;break}for(;copy--;)state.lens[state.have++]=len}}if(state.mode===BAD)break;if(0===state.lens[256]){strm.msg="invalid code -- missing end-of-block",state.mode=BAD;break}if(state.lenbits=9,opts={bits:state.lenbits},ret=inflate_table(LENS,state.lens,0,state.nlen,state.lencode,0,state.work,opts),state.lenbits=opts.bits,ret){strm.msg="invalid literal/lengths set",state.mode=BAD;break}if(state.distbits=6,state.distcode=state.distdyn,opts={bits:state.distbits},ret=inflate_table(DISTS,state.lens,state.nlen,state.ndist,state.distcode,0,state.work,opts),state.distbits=opts.bits,ret){strm.msg="invalid distances set",state.mode=BAD;break}if(state.mode=LEN_,flush===Z_TREES)break inf_leave;case LEN_:state.mode=LEN;case LEN:if(have>=6&&left>=258){strm.next_out=put,strm.avail_out=left,strm.next_in=next,strm.avail_in=have,state.hold=hold,state.bits=bits,inflate_fast(strm,_out),put=strm.next_out,output=strm.output,left=strm.avail_out,next=strm.next_in,input=strm.input,have=strm.avail_in,hold=state.hold,bits=state.bits,state.mode===TYPE&&(state.back=-1);break}for(state.back=0;here_op=(here=state.lencode[hold&(1<<state.lenbits)-1])>>>16&255,here_val=65535&here,!((here_bits=here>>>24)<=bits);){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(here_op&&0==(240&here_op)){for(last_bits=here_bits,last_op=here_op,last_val=here_val;here_op=(here=state.lencode[last_val+((hold&(1<<last_bits+last_op)-1)>>last_bits)])>>>16&255,here_val=65535&here,!(last_bits+(here_bits=here>>>24)<=bits);){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}hold>>>=last_bits,bits-=last_bits,state.back+=last_bits}if(hold>>>=here_bits,bits-=here_bits,state.back+=here_bits,state.length=here_val,0===here_op){state.mode=LIT;break}if(32&here_op){state.back=-1,state.mode=TYPE;break}if(64&here_op){strm.msg="invalid literal/length code",state.mode=BAD;break}state.extra=15&here_op,state.mode=LENEXT;case LENEXT:if(state.extra){for(n=state.extra;bits<n;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}state.length+=hold&(1<<state.extra)-1,hold>>>=state.extra,bits-=state.extra,state.back+=state.extra}state.was=state.length,state.mode=DIST;case DIST:for(;here_op=(here=state.distcode[hold&(1<<state.distbits)-1])>>>16&255,here_val=65535&here,!((here_bits=here>>>24)<=bits);){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(0==(240&here_op)){for(last_bits=here_bits,last_op=here_op,last_val=here_val;here_op=(here=state.distcode[last_val+((hold&(1<<last_bits+last_op)-1)>>last_bits)])>>>16&255,here_val=65535&here,!(last_bits+(here_bits=here>>>24)<=bits);){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}hold>>>=last_bits,bits-=last_bits,state.back+=last_bits}if(hold>>>=here_bits,bits-=here_bits,state.back+=here_bits,64&here_op){strm.msg="invalid distance code",state.mode=BAD;break}state.offset=here_val,state.extra=15&here_op,state.mode=DISTEXT;case DISTEXT:if(state.extra){for(n=state.extra;bits<n;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}state.offset+=hold&(1<<state.extra)-1,hold>>>=state.extra,bits-=state.extra,state.back+=state.extra}if(state.offset>state.dmax){strm.msg="invalid distance too far back",state.mode=BAD;break}state.mode=MATCH;case MATCH:if(0===left)break inf_leave;if(copy=_out-left,state.offset>copy){if((copy=state.offset-copy)>state.whave&&state.sane){strm.msg="invalid distance too far back",state.mode=BAD;break}copy>state.wnext?(copy-=state.wnext,from=state.wsize-copy):from=state.wnext-copy,copy>state.length&&(copy=state.length),from_source=state.window}else from_source=output,from=put-state.offset,copy=state.length;copy>left&&(copy=left),left-=copy,state.length-=copy;do{output[put++]=from_source[from++]}while(--copy);0===state.length&&(state.mode=LEN);break;case LIT:if(0===left)break inf_leave;output[put++]=state.length,left--,state.mode=LEN;break;case CHECK:if(state.wrap){for(;bits<32;){if(0===have)break inf_leave;have--,hold|=input[next++]<<bits,bits+=8}if(_out-=left,strm.total_out+=_out,state.total+=_out,_out&&(strm.adler=state.check=state.flags?crc32(state.check,output,_out,put-_out):adler32(state.check,output,_out,put-_out)),_out=left,(state.flags?hold:zswap32(hold))!==state.check){strm.msg="incorrect data check",state.mode=BAD;break}hold=0,bits=0}state.mode=LENGTH;case LENGTH:if(state.wrap&&state.flags){for(;bits<32;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(hold!==(4294967295&state.total)){strm.msg="incorrect length check",state.mode=BAD;break}hold=0,bits=0}state.mode=DONE;case DONE:ret=Z_STREAM_END;break inf_leave;case BAD:ret=Z_DATA_ERROR;break inf_leave;case MEM:return Z_MEM_ERROR;case SYNC:default:return Z_STREAM_ERROR}return strm.next_out=put,strm.avail_out=left,strm.next_in=next,strm.avail_in=have,state.hold=hold,state.bits=bits,(state.wsize||_out!==strm.avail_out&&state.mode<BAD&&(state.mode<CHECK||flush!==Z_FINISH))&&updatewindow(strm,strm.output,strm.next_out,_out-strm.avail_out)?(state.mode=MEM,Z_MEM_ERROR):(_in-=strm.avail_in,_out-=strm.avail_out,strm.total_in+=_in,strm.total_out+=_out,state.total+=_out,state.wrap&&_out&&(strm.adler=state.check=state.flags?crc32(state.check,output,_out,strm.next_out-_out):adler32(state.check,output,_out,strm.next_out-_out)),strm.data_type=state.bits+(state.last?64:0)+(state.mode===TYPE?128:0)+(state.mode===LEN_||state.mode===COPY_?256:0),(0===_in&&0===_out||flush===Z_FINISH)&&ret===Z_OK&&(ret=Z_BUF_ERROR),ret)},exports.inflateEnd=function(strm){if(!strm||!strm.state)return Z_STREAM_ERROR;var state=strm.state;return state.window&&(state.window=null),strm.state=null,Z_OK},exports.inflateGetHeader=function(strm,head){var state;return strm&&strm.state?0==(2&(state=strm.state).wrap)?Z_STREAM_ERROR:(state.head=head,head.done=!1,Z_OK):Z_STREAM_ERROR},exports.inflateSetDictionary=function(strm,dictionary){var state,dictLength=dictionary.length;return strm&&strm.state?0!==(state=strm.state).wrap&&state.mode!==DICT?Z_STREAM_ERROR:state.mode===DICT&&adler32(1,dictionary,dictLength,0)!==state.check?Z_DATA_ERROR:updatewindow(strm,dictionary,dictLength,dictLength)?(state.mode=MEM,Z_MEM_ERROR):(state.havedict=1,Z_OK):Z_STREAM_ERROR},exports.inflateInfo="pako inflate (from Nodeca project)"},"./node_modules/pako/lib/zlib/inftrees.js":function(module,exports,__webpack_require__){"use strict";var utils=__webpack_require__("./node_modules/pako/lib/utils/common.js"),lbase=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],lext=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],dbase=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],dext=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];module.exports=function(type,lens,lens_index,codes,table,table_index,work,opts){var incr,fill,low,mask,next,end,here_bits,here_op,here_val,bits=opts.bits,len=0,sym=0,min=0,max=0,root=0,curr=0,drop=0,left=0,used=0,huff=0,base=null,base_index=0,count=new utils.Buf16(16),offs=new utils.Buf16(16),extra=null,extra_index=0;for(len=0;len<=15;len++)count[len]=0;for(sym=0;sym<codes;sym++)count[lens[lens_index+sym]]++;for(root=bits,max=15;max>=1&&0===count[max];max--);if(root>max&&(root=max),0===max)return table[table_index++]=20971520,table[table_index++]=20971520,opts.bits=1,0;for(min=1;min<max&&0===count[min];min++);for(root<min&&(root=min),left=1,len=1;len<=15;len++)if(left<<=1,(left-=count[len])<0)return-1;if(left>0&&(0===type||1!==max))return-1;for(offs[1]=0,len=1;len<15;len++)offs[len+1]=offs[len]+count[len];for(sym=0;sym<codes;sym++)0!==lens[lens_index+sym]&&(work[offs[lens[lens_index+sym]]++]=sym);if(0===type?(base=extra=work,end=19):1===type?(base=lbase,base_index-=257,extra=lext,extra_index-=257,end=256):(base=dbase,extra=dext,end=-1),huff=0,sym=0,len=min,next=table_index,curr=root,drop=0,low=-1,mask=(used=1<<root)-1,1===type&&used>852||2===type&&used>592)return 1;for(;;){here_bits=len-drop,work[sym]<end?(here_op=0,here_val=work[sym]):work[sym]>end?(here_op=extra[extra_index+work[sym]],here_val=base[base_index+work[sym]]):(here_op=96,here_val=0),incr=1<<len-drop,min=fill=1<<curr;do{table[next+(huff>>drop)+(fill-=incr)]=here_bits<<24|here_op<<16|here_val|0}while(0!==fill);for(incr=1<<len-1;huff&incr;)incr>>=1;if(0!==incr?(huff&=incr-1,huff+=incr):huff=0,sym++,0==--count[len]){if(len===max)break;len=lens[lens_index+work[sym]]}if(len>root&&(huff&mask)!==low){for(0===drop&&(drop=root),next+=min,left=1<<(curr=len-drop);curr+drop<max&&!((left-=count[curr+drop])<=0);)curr++,left<<=1;if(used+=1<<curr,1===type&&used>852||2===type&&used>592)return 1;table[low=huff&mask]=root<<24|curr<<16|next-table_index|0}}return 0!==huff&&(table[next+huff]=len-drop<<24|64<<16|0),opts.bits=root,0}},"./node_modules/pako/lib/zlib/messages.js":function(module,exports,__webpack_require__){"use strict";module.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},"./node_modules/pako/lib/zlib/trees.js":function(module,exports,__webpack_require__){"use strict";var utils=__webpack_require__("./node_modules/pako/lib/utils/common.js"),Z_FIXED=4,Z_BINARY=0,Z_TEXT=1,Z_UNKNOWN=2;function zero(buf){for(var len=buf.length;--len>=0;)buf[len]=0}var STORED_BLOCK=0,STATIC_TREES=1,DYN_TREES=2,LENGTH_CODES=29,LITERALS=256,L_CODES=LITERALS+1+LENGTH_CODES,D_CODES=30,BL_CODES=19,HEAP_SIZE=2*L_CODES+1,MAX_BITS=15,Buf_size=16,MAX_BL_BITS=7,END_BLOCK=256,REP_3_6=16,REPZ_3_10=17,REPZ_11_138=18,extra_lbits=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],extra_dbits=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],extra_blbits=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],bl_order=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],static_ltree=new Array(2*(L_CODES+2));zero(static_ltree);var static_dtree=new Array(2*D_CODES);zero(static_dtree);var _dist_code=new Array(512);zero(_dist_code);var _length_code=new Array(256);zero(_length_code);var base_length=new Array(LENGTH_CODES);zero(base_length);var static_l_desc,static_d_desc,static_bl_desc,base_dist=new Array(D_CODES);function StaticTreeDesc(static_tree,extra_bits,extra_base,elems,max_length){this.static_tree=static_tree,this.extra_bits=extra_bits,this.extra_base=extra_base,this.elems=elems,this.max_length=max_length,this.has_stree=static_tree&&static_tree.length}function TreeDesc(dyn_tree,stat_desc){this.dyn_tree=dyn_tree,this.max_code=0,this.stat_desc=stat_desc}function d_code(dist){return dist<256?_dist_code[dist]:_dist_code[256+(dist>>>7)]}function put_short(s,w){s.pending_buf[s.pending++]=255&w,s.pending_buf[s.pending++]=w>>>8&255}function send_bits(s,value,length){s.bi_valid>Buf_size-length?(s.bi_buf|=value<<s.bi_valid&65535,put_short(s,s.bi_buf),s.bi_buf=value>>Buf_size-s.bi_valid,s.bi_valid+=length-Buf_size):(s.bi_buf|=value<<s.bi_valid&65535,s.bi_valid+=length)}function send_code(s,c,tree){send_bits(s,tree[2*c],tree[2*c+1])}function bi_reverse(code,len){var res=0;do{res|=1&code,code>>>=1,res<<=1}while(--len>0);return res>>>1}function gen_codes(tree,max_code,bl_count){var bits,n,next_code=new Array(MAX_BITS+1),code=0;for(bits=1;bits<=MAX_BITS;bits++)next_code[bits]=code=code+bl_count[bits-1]<<1;for(n=0;n<=max_code;n++){var len=tree[2*n+1];0!==len&&(tree[2*n]=bi_reverse(next_code[len]++,len))}}function init_block(s){var n;for(n=0;n<L_CODES;n++)s.dyn_ltree[2*n]=0;for(n=0;n<D_CODES;n++)s.dyn_dtree[2*n]=0;for(n=0;n<BL_CODES;n++)s.bl_tree[2*n]=0;s.dyn_ltree[2*END_BLOCK]=1,s.opt_len=s.static_len=0,s.last_lit=s.matches=0}function bi_windup(s){s.bi_valid>8?put_short(s,s.bi_buf):s.bi_valid>0&&(s.pending_buf[s.pending++]=s.bi_buf),s.bi_buf=0,s.bi_valid=0}function smaller(tree,n,m,depth){var _n2=2*n,_m2=2*m;return tree[_n2]<tree[_m2]||tree[_n2]===tree[_m2]&&depth[n]<=depth[m]}function pqdownheap(s,tree,k){for(var v=s.heap[k],j=k<<1;j<=s.heap_len&&(j<s.heap_len&&smaller(tree,s.heap[j+1],s.heap[j],s.depth)&&j++,!smaller(tree,v,s.heap[j],s.depth));)s.heap[k]=s.heap[j],k=j,j<<=1;s.heap[k]=v}function compress_block(s,ltree,dtree){var dist,lc,code,extra,lx=0;if(0!==s.last_lit)do{dist=s.pending_buf[s.d_buf+2*lx]<<8|s.pending_buf[s.d_buf+2*lx+1],lc=s.pending_buf[s.l_buf+lx],lx++,0===dist?send_code(s,lc,ltree):(send_code(s,(code=_length_code[lc])+LITERALS+1,ltree),0!==(extra=extra_lbits[code])&&send_bits(s,lc-=base_length[code],extra),send_code(s,code=d_code(--dist),dtree),0!==(extra=extra_dbits[code])&&send_bits(s,dist-=base_dist[code],extra))}while(lx<s.last_lit);send_code(s,END_BLOCK,ltree)}function build_tree(s,desc){var n,m,node,tree=desc.dyn_tree,stree=desc.stat_desc.static_tree,has_stree=desc.stat_desc.has_stree,elems=desc.stat_desc.elems,max_code=-1;for(s.heap_len=0,s.heap_max=HEAP_SIZE,n=0;n<elems;n++)0!==tree[2*n]?(s.heap[++s.heap_len]=max_code=n,s.depth[n]=0):tree[2*n+1]=0;for(;s.heap_len<2;)tree[2*(node=s.heap[++s.heap_len]=max_code<2?++max_code:0)]=1,s.depth[node]=0,s.opt_len--,has_stree&&(s.static_len-=stree[2*node+1]);for(desc.max_code=max_code,n=s.heap_len>>1;n>=1;n--)pqdownheap(s,tree,n);node=elems;do{n=s.heap[1],s.heap[1]=s.heap[s.heap_len--],pqdownheap(s,tree,1),m=s.heap[1],s.heap[--s.heap_max]=n,s.heap[--s.heap_max]=m,tree[2*node]=tree[2*n]+tree[2*m],s.depth[node]=(s.depth[n]>=s.depth[m]?s.depth[n]:s.depth[m])+1,tree[2*n+1]=tree[2*m+1]=node,s.heap[1]=node++,pqdownheap(s,tree,1)}while(s.heap_len>=2);s.heap[--s.heap_max]=s.heap[1],function(s,desc){var h,n,m,bits,xbits,f,tree=desc.dyn_tree,max_code=desc.max_code,stree=desc.stat_desc.static_tree,has_stree=desc.stat_desc.has_stree,extra=desc.stat_desc.extra_bits,base=desc.stat_desc.extra_base,max_length=desc.stat_desc.max_length,overflow=0;for(bits=0;bits<=MAX_BITS;bits++)s.bl_count[bits]=0;for(tree[2*s.heap[s.heap_max]+1]=0,h=s.heap_max+1;h<HEAP_SIZE;h++)(bits=tree[2*tree[2*(n=s.heap[h])+1]+1]+1)>max_length&&(bits=max_length,overflow++),tree[2*n+1]=bits,n>max_code||(s.bl_count[bits]++,xbits=0,n>=base&&(xbits=extra[n-base]),f=tree[2*n],s.opt_len+=f*(bits+xbits),has_stree&&(s.static_len+=f*(stree[2*n+1]+xbits)));if(0!==overflow){do{for(bits=max_length-1;0===s.bl_count[bits];)bits--;s.bl_count[bits]--,s.bl_count[bits+1]+=2,s.bl_count[max_length]--,overflow-=2}while(overflow>0);for(bits=max_length;0!==bits;bits--)for(n=s.bl_count[bits];0!==n;)(m=s.heap[--h])>max_code||(tree[2*m+1]!==bits&&(s.opt_len+=(bits-tree[2*m+1])*tree[2*m],tree[2*m+1]=bits),n--)}}(s,desc),gen_codes(tree,max_code,s.bl_count)}function scan_tree(s,tree,max_code){var n,curlen,prevlen=-1,nextlen=tree[1],count=0,max_count=7,min_count=4;for(0===nextlen&&(max_count=138,min_count=3),tree[2*(max_code+1)+1]=65535,n=0;n<=max_code;n++)curlen=nextlen,nextlen=tree[2*(n+1)+1],++count<max_count&&curlen===nextlen||(count<min_count?s.bl_tree[2*curlen]+=count:0!==curlen?(curlen!==prevlen&&s.bl_tree[2*curlen]++,s.bl_tree[2*REP_3_6]++):count<=10?s.bl_tree[2*REPZ_3_10]++:s.bl_tree[2*REPZ_11_138]++,count=0,prevlen=curlen,0===nextlen?(max_count=138,min_count=3):curlen===nextlen?(max_count=6,min_count=3):(max_count=7,min_count=4))}function send_tree(s,tree,max_code){var n,curlen,prevlen=-1,nextlen=tree[1],count=0,max_count=7,min_count=4;for(0===nextlen&&(max_count=138,min_count=3),n=0;n<=max_code;n++)if(curlen=nextlen,nextlen=tree[2*(n+1)+1],!(++count<max_count&&curlen===nextlen)){if(count<min_count)do{send_code(s,curlen,s.bl_tree)}while(0!=--count);else 0!==curlen?(curlen!==prevlen&&(send_code(s,curlen,s.bl_tree),count--),send_code(s,REP_3_6,s.bl_tree),send_bits(s,count-3,2)):count<=10?(send_code(s,REPZ_3_10,s.bl_tree),send_bits(s,count-3,3)):(send_code(s,REPZ_11_138,s.bl_tree),send_bits(s,count-11,7));count=0,prevlen=curlen,0===nextlen?(max_count=138,min_count=3):curlen===nextlen?(max_count=6,min_count=3):(max_count=7,min_count=4)}}zero(base_dist);var static_init_done=!1;function _tr_stored_block(s,buf,stored_len,last){send_bits(s,(STORED_BLOCK<<1)+(last?1:0),3),function(s,buf,len,header){bi_windup(s),header&&(put_short(s,len),put_short(s,~len)),utils.arraySet(s.pending_buf,s.window,buf,len,s.pending),s.pending+=len}(s,buf,stored_len,!0)}exports._tr_init=function(s){static_init_done||(function(){var n,bits,length,code,dist,bl_count=new Array(MAX_BITS+1);for(length=0,code=0;code<LENGTH_CODES-1;code++)for(base_length[code]=length,n=0;n<1<<extra_lbits[code];n++)_length_code[length++]=code;for(_length_code[length-1]=code,dist=0,code=0;code<16;code++)for(base_dist[code]=dist,n=0;n<1<<extra_dbits[code];n++)_dist_code[dist++]=code;for(dist>>=7;code<D_CODES;code++)for(base_dist[code]=dist<<7,n=0;n<1<<extra_dbits[code]-7;n++)_dist_code[256+dist++]=code;for(bits=0;bits<=MAX_BITS;bits++)bl_count[bits]=0;for(n=0;n<=143;)static_ltree[2*n+1]=8,n++,bl_count[8]++;for(;n<=255;)static_ltree[2*n+1]=9,n++,bl_count[9]++;for(;n<=279;)static_ltree[2*n+1]=7,n++,bl_count[7]++;for(;n<=287;)static_ltree[2*n+1]=8,n++,bl_count[8]++;for(gen_codes(static_ltree,L_CODES+1,bl_count),n=0;n<D_CODES;n++)static_dtree[2*n+1]=5,static_dtree[2*n]=bi_reverse(n,5);static_l_desc=new StaticTreeDesc(static_ltree,extra_lbits,LITERALS+1,L_CODES,MAX_BITS),static_d_desc=new StaticTreeDesc(static_dtree,extra_dbits,0,D_CODES,MAX_BITS),static_bl_desc=new StaticTreeDesc(new Array(0),extra_blbits,0,BL_CODES,MAX_BL_BITS)}(),static_init_done=!0),s.l_desc=new TreeDesc(s.dyn_ltree,static_l_desc),s.d_desc=new TreeDesc(s.dyn_dtree,static_d_desc),s.bl_desc=new TreeDesc(s.bl_tree,static_bl_desc),s.bi_buf=0,s.bi_valid=0,init_block(s)},exports._tr_stored_block=_tr_stored_block,exports._tr_flush_block=function(s,buf,stored_len,last){var opt_lenb,static_lenb,max_blindex=0;s.level>0?(s.strm.data_type===Z_UNKNOWN&&(s.strm.data_type=function(s){var n,black_mask=4093624447;for(n=0;n<=31;n++,black_mask>>>=1)if(1&black_mask&&0!==s.dyn_ltree[2*n])return Z_BINARY;if(0!==s.dyn_ltree[18]||0!==s.dyn_ltree[20]||0!==s.dyn_ltree[26])return Z_TEXT;for(n=32;n<LITERALS;n++)if(0!==s.dyn_ltree[2*n])return Z_TEXT;return Z_BINARY}(s)),build_tree(s,s.l_desc),build_tree(s,s.d_desc),max_blindex=function(s){var max_blindex;for(scan_tree(s,s.dyn_ltree,s.l_desc.max_code),scan_tree(s,s.dyn_dtree,s.d_desc.max_code),build_tree(s,s.bl_desc),max_blindex=BL_CODES-1;max_blindex>=3&&0===s.bl_tree[2*bl_order[max_blindex]+1];max_blindex--);return s.opt_len+=3*(max_blindex+1)+5+5+4,max_blindex}(s),opt_lenb=s.opt_len+3+7>>>3,(static_lenb=s.static_len+3+7>>>3)<=opt_lenb&&(opt_lenb=static_lenb)):opt_lenb=static_lenb=stored_len+5,stored_len+4<=opt_lenb&&-1!==buf?_tr_stored_block(s,buf,stored_len,last):s.strategy===Z_FIXED||static_lenb===opt_lenb?(send_bits(s,(STATIC_TREES<<1)+(last?1:0),3),compress_block(s,static_ltree,static_dtree)):(send_bits(s,(DYN_TREES<<1)+(last?1:0),3),function(s,lcodes,dcodes,blcodes){var rank;for(send_bits(s,lcodes-257,5),send_bits(s,dcodes-1,5),send_bits(s,blcodes-4,4),rank=0;rank<blcodes;rank++)send_bits(s,s.bl_tree[2*bl_order[rank]+1],3);send_tree(s,s.dyn_ltree,lcodes-1),send_tree(s,s.dyn_dtree,dcodes-1)}(s,s.l_desc.max_code+1,s.d_desc.max_code+1,max_blindex+1),compress_block(s,s.dyn_ltree,s.dyn_dtree)),init_block(s),last&&bi_windup(s)},exports._tr_tally=function(s,dist,lc){return s.pending_buf[s.d_buf+2*s.last_lit]=dist>>>8&255,s.pending_buf[s.d_buf+2*s.last_lit+1]=255&dist,s.pending_buf[s.l_buf+s.last_lit]=255&lc,s.last_lit++,0===dist?s.dyn_ltree[2*lc]++:(s.matches++,dist--,s.dyn_ltree[2*(_length_code[lc]+LITERALS+1)]++,s.dyn_dtree[2*d_code(dist)]++),s.last_lit===s.lit_bufsize-1},exports._tr_align=function(s){send_bits(s,STATIC_TREES<<1,3),send_code(s,END_BLOCK,static_ltree),function(s){16===s.bi_valid?(put_short(s,s.bi_buf),s.bi_buf=0,s.bi_valid=0):s.bi_valid>=8&&(s.pending_buf[s.pending++]=255&s.bi_buf,s.bi_buf>>=8,s.bi_valid-=8)}(s)}},"./node_modules/pako/lib/zlib/zstream.js":function(module,exports,__webpack_require__){"use strict";module.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},"./node_modules/path-is-absolute/index.js":function(module,exports,__webpack_require__){"use strict";(function(process){function posix(path){return"/"===path.charAt(0)}function win32(path){var result=/^([a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/]+[^\\\/]+)?([\\\/])?([\s\S]*?)$/.exec(path),device=result[1]||"",isUnc=Boolean(device&&":"!==device.charAt(1));return Boolean(result[2]||isUnc)}module.exports="win32"===process.platform?win32:posix,module.exports.posix=posix,module.exports.win32=win32}).call(this,__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/node_modules/process/browser.js?55cf"))},"./node_modules/platform/platform.js":function(module,exports,__webpack_require__){(function(module,global){var __WEBPACK_AMD_DEFINE_RESULT__;(function(){"use strict";var objectTypes={function:!0,object:!0},root=objectTypes[typeof window]&&window||this,freeExports=objectTypes[typeof exports]&&exports,freeModule=objectTypes[typeof module]&&module&&!module.nodeType&&module,freeGlobal=freeExports&&freeModule&&"object"==typeof global&&global;!freeGlobal||freeGlobal.global!==freeGlobal&&freeGlobal.window!==freeGlobal&&freeGlobal.self!==freeGlobal||(root=freeGlobal);var maxSafeInteger=Math.pow(2,53)-1,reOpera=/\bOpera/,objectProto=Object.prototype,hasOwnProperty=objectProto.hasOwnProperty,toString=objectProto.toString;function capitalize(string){return(string=String(string)).charAt(0).toUpperCase()+string.slice(1)}function format(string){return string=trim(string),/^(?:webOS|i(?:OS|P))/.test(string)?string:capitalize(string)}function forOwn(object,callback){for(var key in object)hasOwnProperty.call(object,key)&&callback(object[key],key,object)}function getClassOf(value){return null==value?capitalize(value):toString.call(value).slice(8,-1)}function qualify(string){return String(string).replace(/([ -])(?!$)/g,"$1?")}function reduce(array,callback){var accumulator=null;return function(object,callback){var index=-1,length=object?object.length:0;if("number"==typeof length&&length>-1&&length<=maxSafeInteger)for(;++index<length;)callback(object[index],index,object);else forOwn(object,callback)}(array,function(value,index){accumulator=callback(accumulator,value,index,array)}),accumulator}function trim(string){return String(string).replace(/^ +| +$/g,"")}var platform=function parse(ua){var context=root,isCustomContext=ua&&"object"==typeof ua&&"String"!=getClassOf(ua);isCustomContext&&(context=ua,ua=null);var nav=context.navigator||{},userAgent=nav.userAgent||"";ua||(ua=userAgent);var data,isSpecialCasedOS,object,property,type,likeChrome=isCustomContext?!!nav.likeChrome:/\bChrome\b/.test(ua)&&!/internal|\n/i.test(toString.toString()),airRuntimeClass=isCustomContext?"Object":"ScriptBridgingProxyObject",enviroClass=isCustomContext?"Object":"Environment",javaClass=isCustomContext&&context.java?"JavaPackage":getClassOf(context.java),phantomClass=isCustomContext?"Object":"RuntimeObject",java=/\bJava/.test(javaClass)&&context.java,rhino=java&&getClassOf(context.environment)==enviroClass,alpha=java?"a":"",beta=java?"b":"",doc=context.document||{},opera=context.operamini||context.opera,operaClass=reOpera.test(operaClass=isCustomContext&&opera?opera["[[Class]]"]:getClassOf(opera))?operaClass:opera=null,arch=ua,description=[],prerelease=null,useFeatures=ua==userAgent,version=useFeatures&&opera&&"function"==typeof opera.version&&opera.version(),layout=reduce([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"],function(result,guess){return result||RegExp("\\b"+(guess.pattern||qualify(guess))+"\\b","i").exec(ua)&&(guess.label||guess)}),name=function(guesses){return reduce(guesses,function(result,guess){return result||RegExp("\\b"+(guess.pattern||qualify(guess))+"\\b","i").exec(ua)&&(guess.label||guess)})}(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"Edge"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Waterfox","WebPositive","Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chrome",{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),product=getProduct([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),manufacturer=function(guesses){return reduce(guesses,function(result,value,key){return result||(value[product]||value[/^[a-z]+(?: +[a-z]+\b)*/i.exec(product)]||RegExp("\\b"+qualify(key)+"(?:\\b|\\w*\\d)","i").exec(ua))&&key})}({Apple:{iPad:1,iPhone:1,iPod:1},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1}}),os=function(guesses){return reduce(guesses,function(result,guess){var pattern=guess.pattern||qualify(guess);return!result&&(result=RegExp("\\b"+pattern+"(?:/[\\d.]+|[ \\w.]*)","i").exec(ua))&&(result=function(os,pattern,label){var data={"10.0":"10",6.4:"10 Technical Preview",6.3:"8.1",6.2:"8",6.1:"Server 2008 R2 / 7","6.0":"Server 2008 / Vista",5.2:"Server 2003 / XP 64-bit",5.1:"XP",5.01:"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return pattern&&label&&/^Win/i.test(os)&&!/^Windows Phone /i.test(os)&&(data=data[/[\d.]+$/.exec(os)])&&(os="Windows "+data),os=String(os),pattern&&label&&(os=os.replace(RegExp(pattern,"i"),label)),os=format(os.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])}(result,pattern,guess.label||guess)),result})}(["Windows Phone","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian","Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "]);function getProduct(guesses){return reduce(guesses,function(result,guess){var pattern=guess.pattern||qualify(guess);return!result&&(result=RegExp("\\b"+pattern+" *\\d+[.\\w_]*","i").exec(ua)||RegExp("\\b"+pattern+" *\\w+-[\\w]*","i").exec(ua)||RegExp("\\b"+pattern+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(ua))&&((result=String(guess.label&&!RegExp(pattern,"i").test(guess.label)?guess.label:result).split("/"))[1]&&!/[\d.]+/.test(result[0])&&(result[0]+=" "+result[1]),guess=guess.label||guess,result=format(result[0].replace(RegExp(pattern,"i"),guess).replace(RegExp("; *(?:"+guess+"[_-])?","i")," ").replace(RegExp("("+guess+")[-_.]?(\\w)","i"),"$1 $2"))),result})}if(layout&&(layout=[layout]),manufacturer&&!product&&(product=getProduct([manufacturer])),(data=/\bGoogle TV\b/.exec(product))&&(product=data[0]),/\bSimulator\b/i.test(ua)&&(product=(product?product+" ":"")+"Simulator"),"Opera Mini"==name&&/\bOPiOS\b/.test(ua)&&description.push("running in Turbo/Uncompressed mode"),"IE"==name&&/\blike iPhone OS\b/.test(ua)?(manufacturer=(data=parse(ua.replace(/like iPhone OS/,""))).manufacturer,product=data.product):/^iP/.test(product)?(name||(name="Safari"),os="iOS"+((data=/ OS ([\d_]+)/i.exec(ua))?" "+data[1].replace(/_/g,"."):"")):"Konqueror"!=name||/buntu/i.test(os)?manufacturer&&"Google"!=manufacturer&&(/Chrome/.test(name)&&!/\bMobile Safari\b/i.test(ua)||/\bVita\b/.test(product))||/\bAndroid\b/.test(os)&&/^Chrome/.test(name)&&/\bVersion\//i.test(ua)?(name="Android Browser",os=/\bAndroid\b/.test(os)?os:"Android"):"Silk"==name?(/\bMobi/i.test(ua)||(os="Android",description.unshift("desktop mode")),/Accelerated *= *true/i.test(ua)&&description.unshift("accelerated")):"PaleMoon"==name&&(data=/\bFirefox\/([\d.]+)\b/.exec(ua))?description.push("identifying as Firefox "+data[1]):"Firefox"==name&&(data=/\b(Mobile|Tablet|TV)\b/i.exec(ua))?(os||(os="Firefox OS"),product||(product=data[1])):!name||(data=!/\bMinefield\b/i.test(ua)&&/\b(?:Firefox|Safari)\b/.exec(name))?(name&&!product&&/[\/,]|^[^(]+?\)/.test(ua.slice(ua.indexOf(data+"/")+8))&&(name=null),(data=product||manufacturer||os)&&(product||manufacturer||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(os))&&(name=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(os)?os:data)+" Browser")):"Electron"==name&&(data=(/\bChrome\/([\d.]+)\b/.exec(ua)||0)[1])&&description.push("Chromium "+data):os="Kubuntu",version||(version=reduce(["(?:Cloud9|CriOS|CrMo|Edge|FxiOS|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$))","Version",qualify(name),"(?:Firefox|Minefield|NetFront)"],function(result,pattern){return result||(RegExp(pattern+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(ua)||0)[1]||null})),(data=("iCab"==layout&&parseFloat(version)>3?"WebKit":/\bOpera\b/.test(name)&&(/\bOPR\b/.test(ua)?"Blink":"Presto"))||/\b(?:Midori|Nook|Safari)\b/i.test(ua)&&!/^(?:Trident|EdgeHTML)$/.test(layout)&&"WebKit"||!layout&&/\bMSIE\b/i.test(ua)&&("Mac OS"==os?"Tasman":"Trident")||"WebKit"==layout&&/\bPlayStation\b(?! Vita\b)/i.test(name)&&"NetFront")&&(layout=[data]),"IE"==name&&(data=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(ua)||0)[1])?(name+=" Mobile",os="Windows Phone "+(/\+$/.test(data)?data:data+".x"),description.unshift("desktop mode")):/\bWPDesktop\b/i.test(ua)?(name="IE Mobile",os="Windows Phone 8.x",description.unshift("desktop mode"),version||(version=(/\brv:([\d.]+)/.exec(ua)||0)[1])):"IE"!=name&&"Trident"==layout&&(data=/\brv:([\d.]+)/.exec(ua))&&(name&&description.push("identifying as "+name+(version?" "+version:"")),name="IE",version=data[1]),useFeatures){if(property="global",type=null!=(object=context)?typeof object[property]:"number",/^(?:boolean|number|string|undefined)$/.test(type)||"object"==type&&!object[property])getClassOf(data=context.runtime)==airRuntimeClass?(name="Adobe AIR",os=data.flash.system.Capabilities.os):getClassOf(data=context.phantom)==phantomClass?(name="PhantomJS",version=(data=data.version||null)&&data.major+"."+data.minor+"."+data.patch):"number"==typeof doc.documentMode&&(data=/\bTrident\/(\d+)/i.exec(ua))?(version=[version,doc.documentMode],(data=+data[1]+4)!=version[1]&&(description.push("IE "+version[1]+" mode"),layout&&(layout[1]=""),version[1]=data),version="IE"==name?String(version[1].toFixed(1)):version[0]):"number"==typeof doc.documentMode&&/^(?:Chrome|Firefox)\b/.test(name)&&(description.push("masking as "+name+" "+version),name="IE",version="11.0",layout=["Trident"],os="Windows");else if(java&&(arch=(data=java.lang.System).getProperty("os.arch"),os=os||data.getProperty("os.name")+" "+data.getProperty("os.version")),rhino){try{version=context.require("ringo/engine").version.join("."),name="RingoJS"}catch(e){(data=context.system)&&data.global.system==context.system&&(name="Narwhal",os||(os=data[0].os||null))}name||(name="Rhino")}else"object"==typeof context.process&&!context.process.browser&&(data=context.process)&&("object"==typeof data.versions&&("string"==typeof data.versions.electron?(description.push("Node "+data.versions.node),name="Electron",version=data.versions.electron):"string"==typeof data.versions.nw&&(description.push("Chromium "+version,"Node "+data.versions.node),name="NW.js",version=data.versions.nw)),name||(name="Node.js",arch=data.arch,os=data.platform,version=(version=/[\d.]+/.exec(data.version))?version[0]:null));os=os&&format(os)}if(version&&(data=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(version)||/(?:alpha|beta)(?: ?\d)?/i.exec(ua+";"+(useFeatures&&nav.appMinorVersion))||/\bMinefield\b/i.test(ua)&&"a")&&(prerelease=/b/i.test(data)?"beta":"alpha",version=version.replace(RegExp(data+"\\+?$"),"")+("beta"==prerelease?beta:alpha)+(/\d+\+?/.exec(data)||"")),"Fennec"==name||"Firefox"==name&&/\b(?:Android|Firefox OS)\b/.test(os))name="Firefox Mobile";else if("Maxthon"==name&&version)version=version.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(product))"Xbox 360"==product&&(os=null),"Xbox 360"==product&&/\bIEMobile\b/.test(ua)&&description.unshift("mobile mode");else if(!/^(?:Chrome|IE|Opera)$/.test(name)&&(!name||product||/Browser|Mobi/.test(name))||"Windows CE"!=os&&!/Mobi/i.test(ua))if("IE"==name&&useFeatures)try{null===context.external&&description.unshift("platform preview")}catch(e){description.unshift("embedded")}else(/\bBlackBerry\b/.test(product)||/\bBB10\b/.test(ua))&&(data=(RegExp(product.replace(/ +/g," *")+"/([.\\d]+)","i").exec(ua)||0)[1]||version)?(os=((data=[data,/BB10/.test(ua)])[1]?(product=null,manufacturer="BlackBerry"):"Device Software")+" "+data[0],version=null):this!=forOwn&&"Wii"!=product&&(useFeatures&&opera||/Opera/.test(name)&&/\b(?:MSIE|Firefox)\b/i.test(ua)||"Firefox"==name&&/\bOS X (?:\d+\.){2,}/.test(os)||"IE"==name&&(os&&!/^Win/.test(os)&&version>5.5||/\bWindows XP\b/.test(os)&&version>8||8==version&&!/\bTrident\b/.test(ua)))&&!reOpera.test(data=parse.call(forOwn,ua.replace(reOpera,"")+";"))&&data.name&&(data="ing as "+data.name+((data=data.version)?" "+data:""),reOpera.test(name)?(/\bIE\b/.test(data)&&"Mac OS"==os&&(os=null),data="identify"+data):(data="mask"+data,name=operaClass?format(operaClass.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(data)&&(os=null),useFeatures||(version=null)),layout=["Presto"],description.push(data));else name+=" Mobile";(data=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(ua)||0)[1])&&(data=[parseFloat(data.replace(/\.(\d)$/,".0$1")),data],"Safari"==name&&"+"==data[1].slice(-1)?(name="WebKit Nightly",prerelease="alpha",version=data[1].slice(0,-1)):version!=data[1]&&version!=(data[2]=(/\bSafari\/([\d.]+\+?)/i.exec(ua)||0)[1])||(version=null),data[1]=(/\bChrome\/([\d.]+)/i.exec(ua)||0)[1],537.36==data[0]&&537.36==data[2]&&parseFloat(data[1])>=28&&"WebKit"==layout&&(layout=["Blink"]),useFeatures&&(likeChrome||data[1])?(layout&&(layout[1]="like Chrome"),data=data[1]||((data=data[0])<530?1:data<532?2:data<532.05?3:data<533?4:data<534.03?5:data<534.07?6:data<534.1?7:data<534.13?8:data<534.16?9:data<534.24?10:data<534.3?11:data<535.01?12:data<535.02?"13+":data<535.07?15:data<535.11?16:data<535.19?17:data<536.05?18:data<536.1?19:data<537.01?20:data<537.11?"21+":data<537.13?23:data<537.18?24:data<537.24?25:data<537.36?26:"Blink"!=layout?"27":"28")):(layout&&(layout[1]="like Safari"),data=(data=data[0])<400?1:data<500?2:data<526?3:data<533?4:data<534?"4+":data<535?5:data<537?6:data<538?7:data<601?8:"8"),layout&&(layout[1]+=" "+(data+="number"==typeof data?".x":/[.+]/.test(data)?"":"+")),"Safari"==name&&(!version||parseInt(version)>45)&&(version=data)),"Opera"==name&&(data=/\bzbov|zvav$/.exec(os))?(name+=" ",description.unshift("desktop mode"),"zvav"==data?(name+="Mini",version=null):name+="Mobile",os=os.replace(RegExp(" *"+data+"$"),"")):"Safari"==name&&/\bChrome\b/.exec(layout&&layout[1])&&(description.unshift("desktop mode"),name="Chrome Mobile",version=null,/\bOS X\b/.test(os)?(manufacturer="Apple",os="iOS 4.3+"):os=null),version&&0==version.indexOf(data=/[\d.]+$/.exec(os))&&ua.indexOf("/"+data+"-")>-1&&(os=trim(os.replace(data,""))),layout&&!/\b(?:Avant|Nook)\b/.test(name)&&(/Browser|Lunascape|Maxthon/.test(name)||"Safari"!=name&&/^iOS/.test(os)&&/\bSafari\b/.test(layout[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|Web)/.test(name)&&layout[1])&&(data=layout[layout.length-1])&&description.push(data),description.length&&(description=["("+description.join("; ")+")"]),manufacturer&&product&&product.indexOf(manufacturer)<0&&description.push("on "+manufacturer),product&&description.push((/^on /.test(description[description.length-1])?"":"on ")+product),os&&(data=/ ([\d.+]+)$/.exec(os),isSpecialCasedOS=data&&"/"==os.charAt(os.length-data[0].length-1),os={architecture:32,family:data&&!isSpecialCasedOS?os.replace(data[0],""):os,version:data?data[1]:null,toString:function(){var version=this.version;return this.family+(version&&!isSpecialCasedOS?" "+version:"")+(64==this.architecture?" 64-bit":"")}}),(data=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(arch))&&!/\bi686\b/i.test(arch)?(os&&(os.architecture=64,os.family=os.family.replace(RegExp(" *"+data),"")),name&&(/\bWOW64\b/i.test(ua)||useFeatures&&/\w(?:86|32)$/.test(nav.cpuClass||nav.platform)&&!/\bWin64; x64\b/i.test(ua))&&description.unshift("32-bit")):os&&/^OS X/.test(os.family)&&"Chrome"==name&&parseFloat(version)>=39&&(os.architecture=64),ua||(ua=null);var platform={};return platform.description=ua,platform.layout=layout&&layout[0],platform.manufacturer=manufacturer,platform.name=name,platform.prerelease=prerelease,platform.product=product,platform.ua=ua,platform.version=name&&version,platform.os=os||{architecture:null,family:null,version:null,toString:function(){return"null"}},platform.parse=parse,platform.toString=function(){return this.description||""},platform.version&&description.unshift(version),platform.name&&description.unshift(name),os&&name&&(os!=String(os).split(" ")[0]||os!=name.split(" ")[0]&&!product)&&description.push(product?"("+os+")":"on "+os),description.length&&(platform.description=description.join(" ")),platform}();root.platform=platform,void 0===(__WEBPACK_AMD_DEFINE_RESULT__=function(){return platform}.call(exports,__webpack_require__,exports,module))||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)}).call(this)}).call(this,__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/buildin/module.js")(module),__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/buildin/global.js?8fce"))},"./node_modules/png.js/PNG.js":function(module,exports,__webpack_require__){"use strict";var PNG=function(){this.width=0,this.height=0,this.bitDepth=0,this.colorType=0,this.compressionMethod=0,this.filterMethod=0,this.interlaceMethod=0,this.colors=0,this.alpha=!1,this.pixelBits=0,this.palette=null,this.pixels=null};PNG.prototype.getWidth=function(){return this.width},PNG.prototype.setWidth=function(width){this.width=width},PNG.prototype.getHeight=function(){return this.height},PNG.prototype.setHeight=function(height){this.height=height},PNG.prototype.getBitDepth=function(){return this.bitDepth},PNG.prototype.setBitDepth=function(bitDepth){if(-1===[2,4,8,16].indexOf(bitDepth))throw new Error("invalid bith depth "+bitDepth);this.bitDepth=bitDepth},PNG.prototype.getColorType=function(){return this.colorType},PNG.prototype.setColorType=function(colorType){var colors=0,alpha=!1;switch(colorType){case 0:colors=1;break;case 2:colors=3;break;case 3:colors=1;break;case 4:colors=2,alpha=!0;break;case 6:colors=4,alpha=!0;break;default:throw new Error("invalid color type")}this.colors=colors,this.alpha=alpha,this.colorType=colorType},PNG.prototype.getCompressionMethod=function(){return this.compressionMethod},PNG.prototype.setCompressionMethod=function(compressionMethod){if(0!==compressionMethod)throw new Error("invalid compression method "+compressionMethod);this.compressionMethod=compressionMethod},PNG.prototype.getFilterMethod=function(){return this.filterMethod},PNG.prototype.setFilterMethod=function(filterMethod){if(0!==filterMethod)throw new Error("invalid filter method "+filterMethod);this.filterMethod=filterMethod},PNG.prototype.getInterlaceMethod=function(){return this.interlaceMethod},PNG.prototype.setInterlaceMethod=function(interlaceMethod){if(0!==interlaceMethod&&1!==interlaceMethod)throw new Error("invalid interlace method "+interlaceMethod);this.interlaceMethod=interlaceMethod},PNG.prototype.setPalette=function(palette){if(palette.length%3!=0)throw new Error("incorrect PLTE chunk length");if(palette.length>3*Math.pow(2,this.bitDepth))throw new Error("palette has more colors than 2^bitdepth");this.palette=palette},PNG.prototype.getPalette=function(){return this.palette},PNG.prototype.getPixel=function(x,y){if(!this.pixels)throw new Error("pixel data is empty");if(x>=this.width||y>=this.height)throw new Error("x,y position out of bound");var i=this.colors*this.bitDepth/8*(y*this.width+x),pixels=this.pixels;switch(this.colorType){case 0:return[pixels[i],pixels[i],pixels[i],255];case 2:return[pixels[i],pixels[i+1],pixels[i+2],255];case 3:return[this.palette[3*pixels[i]+0],this.palette[3*pixels[i]+1],this.palette[3*pixels[i]+2],255];case 4:return[pixels[i],pixels[i],pixels[i],pixels[i+1]];case 6:return[pixels[i],pixels[i+1],pixels[i+2],pixels[i+3]]}},module.exports=PNG},"./node_modules/png.js/PNGReader.js":function(module,exports,__webpack_require__){"use strict";(function(Buffer){var zlib=__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/node_modules/browserify-zlib/lib/index.js"),PNG=__webpack_require__("./node_modules/png.js/PNG.js"),slice=Array.prototype.slice,toString=Object.prototype.toString;function readUInt32(buffer,offset){return(buffer[offset]<<24)+(buffer[offset+1]<<16)+(buffer[offset+2]<<8)+(buffer[offset+3]<<0)}function readUInt8(buffer,offset){return buffer[offset]<<0}var PNGReader=function(bytes){if("string"==typeof bytes){var bts=bytes;bytes=new Array(bts.length);for(var i=0,l=bts.length;i<l;i++)bytes[i]=bts[i].charCodeAt(0)}else{"ArrayBuffer"==toString.call(bytes).slice(8,-1)&&(bytes=new Uint8Array(bytes))}this.i=0,this.bytes=bytes,this.png=new PNG,this.dataChunks=[]};PNGReader.prototype.readBytes=function(length){var end=this.i+length;if(end>this.bytes.length)throw new Error("Unexpectedly reached end of file");var bytes=slice.call(this.bytes,this.i,end);return this.i=end,bytes},PNGReader.prototype.decodeHeader=function(){if(0!==this.i)throw new Error("file pointer should be at 0 to read the header");var header=this.readBytes(8);if(!function(a,b){if(a.length!=b.length)return!1;for(var l=a.length;l--;)if(a[l]!=b[l])return!1;return!0}(header,[137,80,78,71,13,10,26,10]))throw new Error("invalid PNGReader file (bad signature)");this.header=header},PNGReader.prototype.decodeChunk=function(){var length=readUInt32(this.readBytes(4),0);if(length<0)throw new Error("Bad chunk length "+(4294967295&length));var type=function(buffer){for(var str="",i=0;i<buffer.length;i++)str+=String.fromCharCode(buffer[i]);return str}(this.readBytes(4)),chunk=this.readBytes(length);this.readBytes(4);switch(type){case"IHDR":this.decodeIHDR(chunk);break;case"PLTE":this.decodePLTE(chunk);break;case"IDAT":this.decodeIDAT(chunk);break;case"IEND":this.decodeIEND(chunk)}return type},PNGReader.prototype.decodeIHDR=function(chunk){var png=this.png;png.setWidth(readUInt32(chunk,0)),png.setHeight(readUInt32(chunk,4)),png.setBitDepth(readUInt8(chunk,8)),png.setColorType(readUInt8(chunk,9)),png.setCompressionMethod(readUInt8(chunk,10)),png.setFilterMethod(readUInt8(chunk,11)),png.setInterlaceMethod(readUInt8(chunk,12))},PNGReader.prototype.decodePLTE=function(chunk){this.png.setPalette(chunk)},PNGReader.prototype.decodeIDAT=function(chunk){this.dataChunks.push(chunk)},PNGReader.prototype.decodeIEND=function(){},PNGReader.prototype.decodePixels=function(callback){var i,j,k,l,png=this.png,reader=this,length=0;for(l=this.dataChunks.length;l--;)length+=this.dataChunks[l].length;var data=new Buffer(length);for(i=0,k=0,l=this.dataChunks.length;i<l;i++){var chunk=this.dataChunks[i];for(j=0;j<chunk.length;j++)data[k++]=chunk[j]}!function(data,callback){zlib.inflate(new Buffer(data),callback)}(data,function(err,data){if(err)return callback(err);try{0===png.getInterlaceMethod()?reader.interlaceNone(data):reader.interlaceAdam7(data)}catch(e){return callback(e)}callback()})},PNGReader.prototype.interlaceNone=function(data){for(var scanline,png=this.png,bpp=Math.max(1,png.colors*png.bitDepth/8),cpr=bpp*png.width,pixels=new Buffer(bpp*png.width*png.height),offset=0,i=0;i<data.length;i+=cpr+1){switch(scanline=slice.call(data,i+1,i+cpr+1),readUInt8(data,i)){case 0:this.unFilterNone(scanline,pixels,bpp,offset,cpr);break;case 1:this.unFilterSub(scanline,pixels,bpp,offset,cpr);break;case 2:this.unFilterUp(scanline,pixels,bpp,offset,cpr);break;case 3:this.unFilterAverage(scanline,pixels,bpp,offset,cpr);break;case 4:this.unFilterPaeth(scanline,pixels,bpp,offset,cpr);break;default:throw new Error("unkown filtered scanline")}offset+=cpr}png.pixels=pixels},PNGReader.prototype.interlaceAdam7=function(data){throw new Error("Adam7 interlacing is not implemented yet")},PNGReader.prototype.unFilterNone=function(scanline,pixels,bpp,of,length){for(var i=0,to=length;i<to;i++)pixels[of+i]=scanline[i]},PNGReader.prototype.unFilterSub=function(scanline,pixels,bpp,of,length){for(var i=0;i<bpp;i++)pixels[of+i]=scanline[i];for(;i<length;i++)pixels[of+i]=scanline[i]+pixels[of+i-bpp]&255},PNGReader.prototype.unFilterUp=function(scanline,pixels,bpp,of,length){var byte,prev,i=0;if(of-length<0)for(;i<length;i++)pixels[of+i]=scanline[i];else for(;i<length;i++)byte=scanline[i],prev=pixels[of+i-length],pixels[of+i]=byte+prev&255},PNGReader.prototype.unFilterAverage=function(scanline,pixels,bpp,of,length){var byte,prev,prior,i=0;if(of-length<0){for(;i<bpp;i++)pixels[of+i]=scanline[i];for(;i<length;i++)pixels[of+i]=scanline[i]+(pixels[of+i-bpp]>>1)&255}else{for(;i<bpp;i++)pixels[of+i]=scanline[i]+(pixels[of-length+i]>>1)&255;for(;i<length;i++)byte=scanline[i],prev=pixels[of+i-bpp],prior=pixels[of+i-length],pixels[of+i]=byte+(prev+prior>>1)&255}},PNGReader.prototype.unFilterPaeth=function(scanline,pixels,bpp,of,length){var raw,a,b,c,p,pa,pb,pc,pr,i=0;if(of-length<0){for(;i<bpp;i++)pixels[of+i]=scanline[i];for(;i<length;i++)pixels[of+i]=scanline[i]+pixels[of+i-bpp]&255}else{for(;i<bpp;i++)pixels[of+i]=scanline[i]+pixels[of+i-length]&255;for(;i<length;i++)raw=scanline[i],p=(a=pixels[of+i-bpp])+(b=pixels[of+i-length])-(c=pixels[of+i-length-bpp]),pa=Math.abs(p-a),pb=Math.abs(p-b),pc=Math.abs(p-c),pr=pa<=pb&&pa<=pc?a:pb<=pc?b:c,pixels[of+i]=raw+pr&255}},PNGReader.prototype.parse=function(options,callback){"function"==typeof options&&(callback=options),"object"!=typeof options&&(options={});try{for(this.decodeHeader();this.i<this.bytes.length;){var type=this.decodeChunk();if("IHDR"==type&&!1===options.data||"IEND"==type)break}var png=this.png;this.decodePixels(function(err){callback(err,png)})}catch(e){callback(e)}},module.exports=PNGReader}).call(this,__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/node_modules/buffer/index.js?c412").Buffer)},"./node_modules/process-nextick-args/index.js":function(module,exports,__webpack_require__){"use strict";(function(process){!process.version||0===process.version.indexOf("v0.")||0===process.version.indexOf("v1.")&&0!==process.version.indexOf("v1.8.")?module.exports={nextTick:function(fn,arg1,arg2,arg3){if("function"!=typeof fn)throw new TypeError('"callback" argument must be a function');var args,i,len=arguments.length;switch(len){case 0:case 1:return process.nextTick(fn);case 2:return process.nextTick(function(){fn.call(null,arg1)});case 3:return process.nextTick(function(){fn.call(null,arg1,arg2)});case 4:return process.nextTick(function(){fn.call(null,arg1,arg2,arg3)});default:for(args=new Array(len-1),i=0;i<args.length;)args[i++]=arguments[i];return process.nextTick(function(){fn.apply(null,args)})}}}:module.exports=process}).call(this,__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/node_modules/process/browser.js?55cf"))},"./node_modules/readable-stream/duplex-browser.js":function(module,exports,__webpack_require__){module.exports=__webpack_require__("./node_modules/readable-stream/lib/_stream_duplex.js")},"./node_modules/readable-stream/lib/_stream_duplex.js":function(module,exports,__webpack_require__){"use strict";var pna=__webpack_require__("./node_modules/process-nextick-args/index.js"),objectKeys=Object.keys||function(obj){var keys=[];for(var key in obj)keys.push(key);return keys};module.exports=Duplex;var util=__webpack_require__("./node_modules/core-util-is/lib/util.js");util.inherits=__webpack_require__("./node_modules/inherits/inherits_browser.js");var Readable=__webpack_require__("./node_modules/readable-stream/lib/_stream_readable.js"),Writable=__webpack_require__("./node_modules/readable-stream/lib/_stream_writable.js");util.inherits(Duplex,Readable);for(var keys=objectKeys(Writable.prototype),v=0;v<keys.length;v++){var method=keys[v];Duplex.prototype[method]||(Duplex.prototype[method]=Writable.prototype[method])}function Duplex(options){if(!(this instanceof Duplex))return new Duplex(options);Readable.call(this,options),Writable.call(this,options),options&&!1===options.readable&&(this.readable=!1),options&&!1===options.writable&&(this.writable=!1),this.allowHalfOpen=!0,options&&!1===options.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",onend)}function onend(){this.allowHalfOpen||this._writableState.ended||pna.nextTick(onEndNT,this)}function onEndNT(self){self.end()}Object.defineProperty(Duplex.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(Duplex.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(value){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=value,this._writableState.destroyed=value)}}),Duplex.prototype._destroy=function(err,cb){this.push(null),this.end(),pna.nextTick(cb,err)}},"./node_modules/readable-stream/lib/_stream_passthrough.js":function(module,exports,__webpack_require__){"use strict";module.exports=PassThrough;var Transform=__webpack_require__("./node_modules/readable-stream/lib/_stream_transform.js"),util=__webpack_require__("./node_modules/core-util-is/lib/util.js");function PassThrough(options){if(!(this instanceof PassThrough))return new PassThrough(options);Transform.call(this,options)}util.inherits=__webpack_require__("./node_modules/inherits/inherits_browser.js"),util.inherits(PassThrough,Transform),PassThrough.prototype._transform=function(chunk,encoding,cb){cb(null,chunk)}},"./node_modules/readable-stream/lib/_stream_readable.js":function(module,exports,__webpack_require__){"use strict";(function(global,process){var pna=__webpack_require__("./node_modules/process-nextick-args/index.js");module.exports=Readable;var Duplex,isArray=__webpack_require__("./node_modules/isarray/index.js");Readable.ReadableState=ReadableState;__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/node_modules/events/events.js").EventEmitter;var EElistenerCount=function(emitter,type){return emitter.listeners(type).length},Stream=__webpack_require__("./node_modules/readable-stream/lib/internal/streams/stream-browser.js"),Buffer=__webpack_require__("./node_modules/safe-buffer/index.js").Buffer,OurUint8Array=global.Uint8Array||function(){};var util=__webpack_require__("./node_modules/core-util-is/lib/util.js");util.inherits=__webpack_require__("./node_modules/inherits/inherits_browser.js");var debugUtil=__webpack_require__(0),debug=void 0;debug=debugUtil&&debugUtil.debuglog?debugUtil.debuglog("stream"):function(){};var StringDecoder,BufferList=__webpack_require__("./node_modules/readable-stream/lib/internal/streams/BufferList.js"),destroyImpl=__webpack_require__("./node_modules/readable-stream/lib/internal/streams/destroy.js");util.inherits(Readable,Stream);var kProxyEvents=["error","close","destroy","pause","resume"];function ReadableState(options,stream){Duplex=Duplex||__webpack_require__("./node_modules/readable-stream/lib/_stream_duplex.js"),options=options||{};var isDuplex=stream instanceof Duplex;this.objectMode=!!options.objectMode,isDuplex&&(this.objectMode=this.objectMode||!!options.readableObjectMode);var hwm=options.highWaterMark,readableHwm=options.readableHighWaterMark,defaultHwm=this.objectMode?16:16384;this.highWaterMark=hwm||0===hwm?hwm:isDuplex&&(readableHwm||0===readableHwm)?readableHwm:defaultHwm,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new BufferList,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=options.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,options.encoding&&(StringDecoder||(StringDecoder=__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/node_modules/string_decoder/lib/string_decoder.js").StringDecoder),this.decoder=new StringDecoder(options.encoding),this.encoding=options.encoding)}function Readable(options){if(Duplex=Duplex||__webpack_require__("./node_modules/readable-stream/lib/_stream_duplex.js"),!(this instanceof Readable))return new Readable(options);this._readableState=new ReadableState(options,this),this.readable=!0,options&&("function"==typeof options.read&&(this._read=options.read),"function"==typeof options.destroy&&(this._destroy=options.destroy)),Stream.call(this)}function readableAddChunk(stream,chunk,encoding,addToFront,skipChunkCheck){var er,state=stream._readableState;null===chunk?(state.reading=!1,function(stream,state){if(state.ended)return;if(state.decoder){var chunk=state.decoder.end();chunk&&chunk.length&&(state.buffer.push(chunk),state.length+=state.objectMode?1:chunk.length)}state.ended=!0,emitReadable(stream)}(stream,state)):(skipChunkCheck||(er=function(state,chunk){var er;obj=chunk,Buffer.isBuffer(obj)||obj instanceof OurUint8Array||"string"==typeof chunk||void 0===chunk||state.objectMode||(er=new TypeError("Invalid non-string/buffer chunk"));var obj;return er}(state,chunk)),er?stream.emit("error",er):state.objectMode||chunk&&chunk.length>0?("string"==typeof chunk||state.objectMode||Object.getPrototypeOf(chunk)===Buffer.prototype||(chunk=function(chunk){return Buffer.from(chunk)}(chunk)),addToFront?state.endEmitted?stream.emit("error",new Error("stream.unshift() after end event")):addChunk(stream,state,chunk,!0):state.ended?stream.emit("error",new Error("stream.push() after EOF")):(state.reading=!1,state.decoder&&!encoding?(chunk=state.decoder.write(chunk),state.objectMode||0!==chunk.length?addChunk(stream,state,chunk,!1):maybeReadMore(stream,state)):addChunk(stream,state,chunk,!1))):addToFront||(state.reading=!1));return function(state){return!state.ended&&(state.needReadable||state.length<state.highWaterMark||0===state.length)}(state)}function addChunk(stream,state,chunk,addToFront){state.flowing&&0===state.length&&!state.sync?(stream.emit("data",chunk),stream.read(0)):(state.length+=state.objectMode?1:chunk.length,addToFront?state.buffer.unshift(chunk):state.buffer.push(chunk),state.needReadable&&emitReadable(stream)),maybeReadMore(stream,state)}Object.defineProperty(Readable.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(value){this._readableState&&(this._readableState.destroyed=value)}}),Readable.prototype.destroy=destroyImpl.destroy,Readable.prototype._undestroy=destroyImpl.undestroy,Readable.prototype._destroy=function(err,cb){this.push(null),cb(err)},Readable.prototype.push=function(chunk,encoding){var skipChunkCheck,state=this._readableState;return state.objectMode?skipChunkCheck=!0:"string"==typeof chunk&&((encoding=encoding||state.defaultEncoding)!==state.encoding&&(chunk=Buffer.from(chunk,encoding),encoding=""),skipChunkCheck=!0),readableAddChunk(this,chunk,encoding,!1,skipChunkCheck)},Readable.prototype.unshift=function(chunk){return readableAddChunk(this,chunk,null,!0,!1)},Readable.prototype.isPaused=function(){return!1===this._readableState.flowing},Readable.prototype.setEncoding=function(enc){return StringDecoder||(StringDecoder=__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/node_modules/string_decoder/lib/string_decoder.js").StringDecoder),this._readableState.decoder=new StringDecoder(enc),this._readableState.encoding=enc,this};var MAX_HWM=8388608;function howMuchToRead(n,state){return n<=0||0===state.length&&state.ended?0:state.objectMode?1:n!=n?state.flowing&&state.length?state.buffer.head.data.length:state.length:(n>state.highWaterMark&&(state.highWaterMark=function(n){return n>=MAX_HWM?n=MAX_HWM:(n--,n|=n>>>1,n|=n>>>2,n|=n>>>4,n|=n>>>8,n|=n>>>16,n++),n}(n)),n<=state.length?n:state.ended?state.length:(state.needReadable=!0,0))}function emitReadable(stream){var state=stream._readableState;state.needReadable=!1,state.emittedReadable||(debug("emitReadable",state.flowing),state.emittedReadable=!0,state.sync?pna.nextTick(emitReadable_,stream):emitReadable_(stream))}function emitReadable_(stream){debug("emit readable"),stream.emit("readable"),flow(stream)}function maybeReadMore(stream,state){state.readingMore||(state.readingMore=!0,pna.nextTick(maybeReadMore_,stream,state))}function maybeReadMore_(stream,state){for(var len=state.length;!state.reading&&!state.flowing&&!state.ended&&state.length<state.highWaterMark&&(debug("maybeReadMore read 0"),stream.read(0),len!==state.length);)len=state.length;state.readingMore=!1}function nReadingNextTick(self){debug("readable nexttick read 0"),self.read(0)}function resume_(stream,state){state.reading||(debug("resume read 0"),stream.read(0)),state.resumeScheduled=!1,state.awaitDrain=0,stream.emit("resume"),flow(stream),state.flowing&&!state.reading&&stream.read(0)}function flow(stream){var state=stream._readableState;for(debug("flow",state.flowing);state.flowing&&null!==stream.read(););}function fromList(n,state){return 0===state.length?null:(state.objectMode?ret=state.buffer.shift():!n||n>=state.length?(ret=state.decoder?state.buffer.join(""):1===state.buffer.length?state.buffer.head.data:state.buffer.concat(state.length),state.buffer.clear()):ret=function(n,list,hasStrings){var ret;n<list.head.data.length?(ret=list.head.data.slice(0,n),list.head.data=list.head.data.slice(n)):ret=n===list.head.data.length?list.shift():hasStrings?function(n,list){var p=list.head,c=1,ret=p.data;n-=ret.length;for(;p=p.next;){var str=p.data,nb=n>str.length?str.length:n;if(nb===str.length?ret+=str:ret+=str.slice(0,n),0===(n-=nb)){nb===str.length?(++c,p.next?list.head=p.next:list.head=list.tail=null):(list.head=p,p.data=str.slice(nb));break}++c}return list.length-=c,ret}(n,list):function(n,list){var ret=Buffer.allocUnsafe(n),p=list.head,c=1;p.data.copy(ret),n-=p.data.length;for(;p=p.next;){var buf=p.data,nb=n>buf.length?buf.length:n;if(buf.copy(ret,ret.length-n,0,nb),0===(n-=nb)){nb===buf.length?(++c,p.next?list.head=p.next:list.head=list.tail=null):(list.head=p,p.data=buf.slice(nb));break}++c}return list.length-=c,ret}(n,list);return ret}(n,state.buffer,state.decoder),ret);var ret}function endReadable(stream){var state=stream._readableState;if(state.length>0)throw new Error('"endReadable()" called on non-empty stream');state.endEmitted||(state.ended=!0,pna.nextTick(endReadableNT,state,stream))}function endReadableNT(state,stream){state.endEmitted||0!==state.length||(state.endEmitted=!0,stream.readable=!1,stream.emit("end"))}function indexOf(xs,x){for(var i=0,l=xs.length;i<l;i++)if(xs[i]===x)return i;return-1}Readable.prototype.read=function(n){debug("read",n),n=parseInt(n,10);var state=this._readableState,nOrig=n;if(0!==n&&(state.emittedReadable=!1),0===n&&state.needReadable&&(state.length>=state.highWaterMark||state.ended))return debug("read: emitReadable",state.length,state.ended),0===state.length&&state.ended?endReadable(this):emitReadable(this),null;if(0===(n=howMuchToRead(n,state))&&state.ended)return 0===state.length&&endReadable(this),null;var ret,doRead=state.needReadable;return debug("need readable",doRead),(0===state.length||state.length-n<state.highWaterMark)&&debug("length less than watermark",doRead=!0),state.ended||state.reading?debug("reading or ended",doRead=!1):doRead&&(debug("do read"),state.reading=!0,state.sync=!0,0===state.length&&(state.needReadable=!0),this._read(state.highWaterMark),state.sync=!1,state.reading||(n=howMuchToRead(nOrig,state))),null===(ret=n>0?fromList(n,state):null)?(state.needReadable=!0,n=0):state.length-=n,0===state.length&&(state.ended||(state.needReadable=!0),nOrig!==n&&state.ended&&endReadable(this)),null!==ret&&this.emit("data",ret),ret},Readable.prototype._read=function(n){this.emit("error",new Error("_read() is not implemented"))},Readable.prototype.pipe=function(dest,pipeOpts){var src=this,state=this._readableState;switch(state.pipesCount){case 0:state.pipes=dest;break;case 1:state.pipes=[state.pipes,dest];break;default:state.pipes.push(dest)}state.pipesCount+=1,debug("pipe count=%d opts=%j",state.pipesCount,pipeOpts);var endFn=(!pipeOpts||!1!==pipeOpts.end)&&dest!==process.stdout&&dest!==process.stderr?onend:unpipe;function onunpipe(readable,unpipeInfo){debug("onunpipe"),readable===src&&unpipeInfo&&!1===unpipeInfo.hasUnpiped&&(unpipeInfo.hasUnpiped=!0,debug("cleanup"),dest.removeListener("close",onclose),dest.removeListener("finish",onfinish),dest.removeListener("drain",ondrain),dest.removeListener("error",onerror),dest.removeListener("unpipe",onunpipe),src.removeListener("end",onend),src.removeListener("end",unpipe),src.removeListener("data",ondata),cleanedUp=!0,!state.awaitDrain||dest._writableState&&!dest._writableState.needDrain||ondrain())}function onend(){debug("onend"),dest.end()}state.endEmitted?pna.nextTick(endFn):src.once("end",endFn),dest.on("unpipe",onunpipe);var ondrain=function(src){return function(){var state=src._readableState;debug("pipeOnDrain",state.awaitDrain),state.awaitDrain&&state.awaitDrain--,0===state.awaitDrain&&EElistenerCount(src,"data")&&(state.flowing=!0,flow(src))}}(src);dest.on("drain",ondrain);var cleanedUp=!1;var increasedAwaitDrain=!1;function ondata(chunk){debug("ondata"),increasedAwaitDrain=!1,!1!==dest.write(chunk)||increasedAwaitDrain||((1===state.pipesCount&&state.pipes===dest||state.pipesCount>1&&-1!==indexOf(state.pipes,dest))&&!cleanedUp&&(debug("false write response, pause",src._readableState.awaitDrain),src._readableState.awaitDrain++,increasedAwaitDrain=!0),src.pause())}function onerror(er){debug("onerror",er),unpipe(),dest.removeListener("error",onerror),0===EElistenerCount(dest,"error")&&dest.emit("error",er)}function onclose(){dest.removeListener("finish",onfinish),unpipe()}function onfinish(){debug("onfinish"),dest.removeListener("close",onclose),unpipe()}function unpipe(){debug("unpipe"),src.unpipe(dest)}return src.on("data",ondata),function(emitter,event,fn){if("function"==typeof emitter.prependListener)return emitter.prependListener(event,fn);emitter._events&&emitter._events[event]?isArray(emitter._events[event])?emitter._events[event].unshift(fn):emitter._events[event]=[fn,emitter._events[event]]:emitter.on(event,fn)}(dest,"error",onerror),dest.once("close",onclose),dest.once("finish",onfinish),dest.emit("pipe",src),state.flowing||(debug("pipe resume"),src.resume()),dest},Readable.prototype.unpipe=function(dest){var state=this._readableState,unpipeInfo={hasUnpiped:!1};if(0===state.pipesCount)return this;if(1===state.pipesCount)return dest&&dest!==state.pipes?this:(dest||(dest=state.pipes),state.pipes=null,state.pipesCount=0,state.flowing=!1,dest&&dest.emit("unpipe",this,unpipeInfo),this);if(!dest){var dests=state.pipes,len=state.pipesCount;state.pipes=null,state.pipesCount=0,state.flowing=!1;for(var i=0;i<len;i++)dests[i].emit("unpipe",this,unpipeInfo);return this}var index=indexOf(state.pipes,dest);return-1===index?this:(state.pipes.splice(index,1),state.pipesCount-=1,1===state.pipesCount&&(state.pipes=state.pipes[0]),dest.emit("unpipe",this,unpipeInfo),this)},Readable.prototype.on=function(ev,fn){var res=Stream.prototype.on.call(this,ev,fn);if("data"===ev)!1!==this._readableState.flowing&&this.resume();else if("readable"===ev){var state=this._readableState;state.endEmitted||state.readableListening||(state.readableListening=state.needReadable=!0,state.emittedReadable=!1,state.reading?state.length&&emitReadable(this):pna.nextTick(nReadingNextTick,this))}return res},Readable.prototype.addListener=Readable.prototype.on,Readable.prototype.resume=function(){var state=this._readableState;return state.flowing||(debug("resume"),state.flowing=!0,function(stream,state){state.resumeScheduled||(state.resumeScheduled=!0,pna.nextTick(resume_,stream,state))}(this,state)),this},Readable.prototype.pause=function(){return debug("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(debug("pause"),this._readableState.flowing=!1,this.emit("pause")),this},Readable.prototype.wrap=function(stream){var _this=this,state=this._readableState,paused=!1;for(var i in stream.on("end",function(){if(debug("wrapped end"),state.decoder&&!state.ended){var chunk=state.decoder.end();chunk&&chunk.length&&_this.push(chunk)}_this.push(null)}),stream.on("data",function(chunk){(debug("wrapped data"),state.decoder&&(chunk=state.decoder.write(chunk)),!state.objectMode||null!==chunk&&void 0!==chunk)&&((state.objectMode||chunk&&chunk.length)&&(_this.push(chunk)||(paused=!0,stream.pause())))}),stream)void 0===this[i]&&"function"==typeof stream[i]&&(this[i]=function(method){return function(){return stream[method].apply(stream,arguments)}}(i));for(var n=0;n<kProxyEvents.length;n++)stream.on(kProxyEvents[n],this.emit.bind(this,kProxyEvents[n]));return this._read=function(n){debug("wrapped _read",n),paused&&(paused=!1,stream.resume())},this},Object.defineProperty(Readable.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Readable._fromList=fromList}).call(this,__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/buildin/global.js?8fce"),__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/node_modules/process/browser.js?55cf"))},"./node_modules/readable-stream/lib/_stream_transform.js":function(module,exports,__webpack_require__){"use strict";module.exports=Transform;var Duplex=__webpack_require__("./node_modules/readable-stream/lib/_stream_duplex.js"),util=__webpack_require__("./node_modules/core-util-is/lib/util.js");function Transform(options){if(!(this instanceof Transform))return new Transform(options);Duplex.call(this,options),this._transformState={afterTransform:function(er,data){var ts=this._transformState;ts.transforming=!1;var cb=ts.writecb;if(!cb)return this.emit("error",new Error("write callback called multiple times"));ts.writechunk=null,ts.writecb=null,null!=data&&this.push(data),cb(er);var rs=this._readableState;rs.reading=!1,(rs.needReadable||rs.length<rs.highWaterMark)&&this._read(rs.highWaterMark)}.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,options&&("function"==typeof options.transform&&(this._transform=options.transform),"function"==typeof options.flush&&(this._flush=options.flush)),this.on("prefinish",prefinish)}function prefinish(){var _this=this;"function"==typeof this._flush?this._flush(function(er,data){done(_this,er,data)}):done(this,null,null)}function done(stream,er,data){if(er)return stream.emit("error",er);if(null!=data&&stream.push(data),stream._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(stream._transformState.transforming)throw new Error("Calling transform done when still transforming");return stream.push(null)}util.inherits=__webpack_require__("./node_modules/inherits/inherits_browser.js"),util.inherits(Transform,Duplex),Transform.prototype.push=function(chunk,encoding){return this._transformState.needTransform=!1,Duplex.prototype.push.call(this,chunk,encoding)},Transform.prototype._transform=function(chunk,encoding,cb){throw new Error("_transform() is not implemented")},Transform.prototype._write=function(chunk,encoding,cb){var ts=this._transformState;if(ts.writecb=cb,ts.writechunk=chunk,ts.writeencoding=encoding,!ts.transforming){var rs=this._readableState;(ts.needTransform||rs.needReadable||rs.length<rs.highWaterMark)&&this._read(rs.highWaterMark)}},Transform.prototype._read=function(n){var ts=this._transformState;null!==ts.writechunk&&ts.writecb&&!ts.transforming?(ts.transforming=!0,this._transform(ts.writechunk,ts.writeencoding,ts.afterTransform)):ts.needTransform=!0},Transform.prototype._destroy=function(err,cb){var _this2=this;Duplex.prototype._destroy.call(this,err,function(err2){cb(err2),_this2.emit("close")})}},"./node_modules/readable-stream/lib/_stream_writable.js":function(module,exports,__webpack_require__){"use strict";(function(process,setImmediate,global){var pna=__webpack_require__("./node_modules/process-nextick-args/index.js");function CorkedRequest(state){var _this=this;this.next=null,this.entry=null,this.finish=function(){!function(corkReq,state,err){var entry=corkReq.entry;corkReq.entry=null;for(;entry;){var cb=entry.callback;state.pendingcb--,cb(err),entry=entry.next}state.corkedRequestsFree?state.corkedRequestsFree.next=corkReq:state.corkedRequestsFree=corkReq}(_this,state)}}module.exports=Writable;var Duplex,asyncWrite=!process.browser&&["v0.10","v0.9."].indexOf(process.version.slice(0,5))>-1?setImmediate:pna.nextTick;Writable.WritableState=WritableState;var util=__webpack_require__("./node_modules/core-util-is/lib/util.js");util.inherits=__webpack_require__("./node_modules/inherits/inherits_browser.js");var internalUtil={deprecate:__webpack_require__("./node_modules/util-deprecate/browser.js")},Stream=__webpack_require__("./node_modules/readable-stream/lib/internal/streams/stream-browser.js"),Buffer=__webpack_require__("./node_modules/safe-buffer/index.js").Buffer,OurUint8Array=global.Uint8Array||function(){};var realHasInstance,destroyImpl=__webpack_require__("./node_modules/readable-stream/lib/internal/streams/destroy.js");function nop(){}function WritableState(options,stream){Duplex=Duplex||__webpack_require__("./node_modules/readable-stream/lib/_stream_duplex.js"),options=options||{};var isDuplex=stream instanceof Duplex;this.objectMode=!!options.objectMode,isDuplex&&(this.objectMode=this.objectMode||!!options.writableObjectMode);var hwm=options.highWaterMark,writableHwm=options.writableHighWaterMark,defaultHwm=this.objectMode?16:16384;this.highWaterMark=hwm||0===hwm?hwm:isDuplex&&(writableHwm||0===writableHwm)?writableHwm:defaultHwm,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var noDecode=!1===options.decodeStrings;this.decodeStrings=!noDecode,this.defaultEncoding=options.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(er){!function(stream,er){var state=stream._writableState,sync=state.sync,cb=state.writecb;if(function(state){state.writing=!1,state.writecb=null,state.length-=state.writelen,state.writelen=0}(state),er)!function(stream,state,sync,er,cb){--state.pendingcb,sync?(pna.nextTick(cb,er),pna.nextTick(finishMaybe,stream,state),stream._writableState.errorEmitted=!0,stream.emit("error",er)):(cb(er),stream._writableState.errorEmitted=!0,stream.emit("error",er),finishMaybe(stream,state))}(stream,state,sync,er,cb);else{var finished=needFinish(state);finished||state.corked||state.bufferProcessing||!state.bufferedRequest||clearBuffer(stream,state),sync?asyncWrite(afterWrite,stream,state,finished,cb):afterWrite(stream,state,finished,cb)}}(stream,er)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new CorkedRequest(this)}function Writable(options){if(Duplex=Duplex||__webpack_require__("./node_modules/readable-stream/lib/_stream_duplex.js"),!(realHasInstance.call(Writable,this)||this instanceof Duplex))return new Writable(options);this._writableState=new WritableState(options,this),this.writable=!0,options&&("function"==typeof options.write&&(this._write=options.write),"function"==typeof options.writev&&(this._writev=options.writev),"function"==typeof options.destroy&&(this._destroy=options.destroy),"function"==typeof options.final&&(this._final=options.final)),Stream.call(this)}function doWrite(stream,state,writev,len,chunk,encoding,cb){state.writelen=len,state.writecb=cb,state.writing=!0,state.sync=!0,writev?stream._writev(chunk,state.onwrite):stream._write(chunk,encoding,state.onwrite),state.sync=!1}function afterWrite(stream,state,finished,cb){finished||function(stream,state){0===state.length&&state.needDrain&&(state.needDrain=!1,stream.emit("drain"))}(stream,state),state.pendingcb--,cb(),finishMaybe(stream,state)}function clearBuffer(stream,state){state.bufferProcessing=!0;var entry=state.bufferedRequest;if(stream._writev&&entry&&entry.next){var l=state.bufferedRequestCount,buffer=new Array(l),holder=state.corkedRequestsFree;holder.entry=entry;for(var count=0,allBuffers=!0;entry;)buffer[count]=entry,entry.isBuf||(allBuffers=!1),entry=entry.next,count+=1;buffer.allBuffers=allBuffers,doWrite(stream,state,!0,state.length,buffer,"",holder.finish),state.pendingcb++,state.lastBufferedRequest=null,holder.next?(state.corkedRequestsFree=holder.next,holder.next=null):state.corkedRequestsFree=new CorkedRequest(state),state.bufferedRequestCount=0}else{for(;entry;){var chunk=entry.chunk,encoding=entry.encoding,cb=entry.callback;if(doWrite(stream,state,!1,state.objectMode?1:chunk.length,chunk,encoding,cb),entry=entry.next,state.bufferedRequestCount--,state.writing)break}null===entry&&(state.lastBufferedRequest=null)}state.bufferedRequest=entry,state.bufferProcessing=!1}function needFinish(state){return state.ending&&0===state.length&&null===state.bufferedRequest&&!state.finished&&!state.writing}function callFinal(stream,state){stream._final(function(err){state.pendingcb--,err&&stream.emit("error",err),state.prefinished=!0,stream.emit("prefinish"),finishMaybe(stream,state)})}function finishMaybe(stream,state){var need=needFinish(state);return need&&(!function(stream,state){state.prefinished||state.finalCalled||("function"==typeof stream._final?(state.pendingcb++,state.finalCalled=!0,pna.nextTick(callFinal,stream,state)):(state.prefinished=!0,stream.emit("prefinish")))}(stream,state),0===state.pendingcb&&(state.finished=!0,stream.emit("finish"))),need}util.inherits(Writable,Stream),WritableState.prototype.getBuffer=function(){for(var current=this.bufferedRequest,out=[];current;)out.push(current),current=current.next;return out},function(){try{Object.defineProperty(WritableState.prototype,"buffer",{get:internalUtil.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(_){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(realHasInstance=Function.prototype[Symbol.hasInstance],Object.defineProperty(Writable,Symbol.hasInstance,{value:function(object){return!!realHasInstance.call(this,object)||this===Writable&&(object&&object._writableState instanceof WritableState)}})):realHasInstance=function(object){return object instanceof this},Writable.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},Writable.prototype.write=function(chunk,encoding,cb){var obj,state=this._writableState,ret=!1,isBuf=!state.objectMode&&(obj=chunk,Buffer.isBuffer(obj)||obj instanceof OurUint8Array);return isBuf&&!Buffer.isBuffer(chunk)&&(chunk=function(chunk){return Buffer.from(chunk)}(chunk)),"function"==typeof encoding&&(cb=encoding,encoding=null),isBuf?encoding="buffer":encoding||(encoding=state.defaultEncoding),"function"!=typeof cb&&(cb=nop),state.ended?function(stream,cb){var er=new Error("write after end");stream.emit("error",er),pna.nextTick(cb,er)}(this,cb):(isBuf||function(stream,state,chunk,cb){var valid=!0,er=!1;return null===chunk?er=new TypeError("May not write null values to stream"):"string"==typeof chunk||void 0===chunk||state.objectMode||(er=new TypeError("Invalid non-string/buffer chunk")),er&&(stream.emit("error",er),pna.nextTick(cb,er),valid=!1),valid}(this,state,chunk,cb))&&(state.pendingcb++,ret=function(stream,state,isBuf,chunk,encoding,cb){if(!isBuf){var newChunk=function(state,chunk,encoding){state.objectMode||!1===state.decodeStrings||"string"!=typeof chunk||(chunk=Buffer.from(chunk,encoding));return chunk}(state,chunk,encoding);chunk!==newChunk&&(isBuf=!0,encoding="buffer",chunk=newChunk)}var len=state.objectMode?1:chunk.length;state.length+=len;var ret=state.length<state.highWaterMark;ret||(state.needDrain=!0);if(state.writing||state.corked){var last=state.lastBufferedRequest;state.lastBufferedRequest={chunk:chunk,encoding:encoding,isBuf:isBuf,callback:cb,next:null},last?last.next=state.lastBufferedRequest:state.bufferedRequest=state.lastBufferedRequest,state.bufferedRequestCount+=1}else doWrite(stream,state,!1,len,chunk,encoding,cb);return ret}(this,state,isBuf,chunk,encoding,cb)),ret},Writable.prototype.cork=function(){this._writableState.corked++},Writable.prototype.uncork=function(){var state=this._writableState;state.corked&&(state.corked--,state.writing||state.corked||state.finished||state.bufferProcessing||!state.bufferedRequest||clearBuffer(this,state))},Writable.prototype.setDefaultEncoding=function(encoding){if("string"==typeof encoding&&(encoding=encoding.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((encoding+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+encoding);return this._writableState.defaultEncoding=encoding,this},Object.defineProperty(Writable.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Writable.prototype._write=function(chunk,encoding,cb){cb(new Error("_write() is not implemented"))},Writable.prototype._writev=null,Writable.prototype.end=function(chunk,encoding,cb){var state=this._writableState;"function"==typeof chunk?(cb=chunk,chunk=null,encoding=null):"function"==typeof encoding&&(cb=encoding,encoding=null),null!==chunk&&void 0!==chunk&&this.write(chunk,encoding),state.corked&&(state.corked=1,this.uncork()),state.ending||state.finished||function(stream,state,cb){state.ending=!0,finishMaybe(stream,state),cb&&(state.finished?pna.nextTick(cb):stream.once("finish",cb));state.ended=!0,stream.writable=!1}(this,state,cb)},Object.defineProperty(Writable.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(value){this._writableState&&(this._writableState.destroyed=value)}}),Writable.prototype.destroy=destroyImpl.destroy,Writable.prototype._undestroy=destroyImpl.undestroy,Writable.prototype._destroy=function(err,cb){this.end(),cb(err)}}).call(this,__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/node_modules/process/browser.js?55cf"),__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/node_modules/timers-browserify/main.js").setImmediate,__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/buildin/global.js?8fce"))},"./node_modules/readable-stream/lib/internal/streams/BufferList.js":function(module,exports,__webpack_require__){"use strict";var Buffer=__webpack_require__("./node_modules/safe-buffer/index.js").Buffer,util=__webpack_require__(1);module.exports=function(){function BufferList(){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,BufferList),this.head=null,this.tail=null,this.length=0}return BufferList.prototype.push=function(v){var entry={data:v,next:null};this.length>0?this.tail.next=entry:this.head=entry,this.tail=entry,++this.length},BufferList.prototype.unshift=function(v){var entry={data:v,next:this.head};0===this.length&&(this.tail=entry),this.head=entry,++this.length},BufferList.prototype.shift=function(){if(0!==this.length){var ret=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,ret}},BufferList.prototype.clear=function(){this.head=this.tail=null,this.length=0},BufferList.prototype.join=function(s){if(0===this.length)return"";for(var p=this.head,ret=""+p.data;p=p.next;)ret+=s+p.data;return ret},BufferList.prototype.concat=function(n){if(0===this.length)return Buffer.alloc(0);if(1===this.length)return this.head.data;for(var src,target,offset,ret=Buffer.allocUnsafe(n>>>0),p=this.head,i=0;p;)src=p.data,target=ret,offset=i,src.copy(target,offset),i+=p.data.length,p=p.next;return ret},BufferList}(),util&&util.inspect&&util.inspect.custom&&(module.exports.prototype[util.inspect.custom]=function(){var obj=util.inspect({length:this.length});return this.constructor.name+" "+obj})},"./node_modules/readable-stream/lib/internal/streams/destroy.js":function(module,exports,__webpack_require__){"use strict";var pna=__webpack_require__("./node_modules/process-nextick-args/index.js");function emitErrorNT(self,err){self.emit("error",err)}module.exports={destroy:function(err,cb){var _this=this,readableDestroyed=this._readableState&&this._readableState.destroyed,writableDestroyed=this._writableState&&this._writableState.destroyed;return readableDestroyed||writableDestroyed?(cb?cb(err):!err||this._writableState&&this._writableState.errorEmitted||pna.nextTick(emitErrorNT,this,err),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(err||null,function(err){!cb&&err?(pna.nextTick(emitErrorNT,_this,err),_this._writableState&&(_this._writableState.errorEmitted=!0)):cb&&cb(err)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},"./node_modules/readable-stream/lib/internal/streams/stream-browser.js":function(module,exports,__webpack_require__){module.exports=__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/node_modules/events/events.js").EventEmitter},"./node_modules/readable-stream/passthrough.js":function(module,exports,__webpack_require__){module.exports=__webpack_require__("./node_modules/readable-stream/readable-browser.js").PassThrough},"./node_modules/readable-stream/readable-browser.js":function(module,exports,__webpack_require__){(exports=module.exports=__webpack_require__("./node_modules/readable-stream/lib/_stream_readable.js")).Stream=exports,exports.Readable=exports,exports.Writable=__webpack_require__("./node_modules/readable-stream/lib/_stream_writable.js"),exports.Duplex=__webpack_require__("./node_modules/readable-stream/lib/_stream_duplex.js"),exports.Transform=__webpack_require__("./node_modules/readable-stream/lib/_stream_transform.js"),exports.PassThrough=__webpack_require__("./node_modules/readable-stream/lib/_stream_passthrough.js")},"./node_modules/readable-stream/transform.js":function(module,exports,__webpack_require__){module.exports=__webpack_require__("./node_modules/readable-stream/readable-browser.js").Transform},"./node_modules/readable-stream/writable-browser.js":function(module,exports,__webpack_require__){module.exports=__webpack_require__("./node_modules/readable-stream/lib/_stream_writable.js")},"./node_modules/rimraf/rimraf.js":function(module,exports,__webpack_require__){(function(process){module.exports=rimraf,rimraf.sync=rimrafSync;var assert=__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/node_modules/assert/assert.js"),path=__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/node_modules/path-browserify/index.js"),fs=__webpack_require__("./lib/js/fs.js"),glob=__webpack_require__("./node_modules/glob/glob.js"),_0666=parseInt("666",8),defaultGlobOpts={nosort:!0,silent:!0},timeout=0,isWindows="win32"===process.platform;function defaults(options){["unlink","chmod","stat","lstat","rmdir","readdir"].forEach(function(m){options[m]=options[m]||fs[m],options[m+="Sync"]=options[m]||fs[m]}),options.maxBusyTries=options.maxBusyTries||3,options.emfileWait=options.emfileWait||1e3,!1===options.glob&&(options.disableGlob=!0),options.disableGlob=options.disableGlob||!1,options.glob=options.glob||defaultGlobOpts}function rimraf(p,options,cb){"function"==typeof options&&(cb=options,options={}),assert(p,"rimraf: missing path"),assert.equal(typeof p,"string","rimraf: path should be a string"),assert.equal(typeof cb,"function","rimraf: callback function required"),assert(options,"rimraf: invalid options argument provided"),assert.equal(typeof options,"object","rimraf: options should be object"),defaults(options);var busyTries=0,errState=null,n=0;if(options.disableGlob||!glob.hasMagic(p))return afterGlob(null,[p]);function afterGlob(er,results){return er?cb(er):0===(n=results.length)?cb():void results.forEach(function(p){rimraf_(p,options,function CB(er){if(er){if(("EBUSY"===er.code||"ENOTEMPTY"===er.code||"EPERM"===er.code)&&busyTries<options.maxBusyTries)return busyTries++,setTimeout(function(){rimraf_(p,options,CB)},100*busyTries);if("EMFILE"===er.code&&timeout<options.emfileWait)return setTimeout(function(){rimraf_(p,options,CB)},timeout++);"ENOENT"===er.code&&(er=null)}timeout=0,function(er){errState=errState||er,0==--n&&cb(errState)}(er)})})}options.lstat(p,function(er,stat){if(!er)return afterGlob(null,[p]);glob(p,options.glob,afterGlob)})}function rimraf_(p,options,cb){assert(p),assert(options),assert("function"==typeof cb),options.lstat(p,function(er,st){return er&&"ENOENT"===er.code?cb(null):(er&&"EPERM"===er.code&&isWindows&&fixWinEPERM(p,options,er,cb),st&&st.isDirectory()?rmdir(p,options,er,cb):void options.unlink(p,function(er){if(er){if("ENOENT"===er.code)return cb(null);if("EPERM"===er.code)return isWindows?fixWinEPERM(p,options,er,cb):rmdir(p,options,er,cb);if("EISDIR"===er.code)return rmdir(p,options,er,cb)}return cb(er)}))})}function fixWinEPERM(p,options,er,cb){assert(p),assert(options),assert("function"==typeof cb),er&&assert(er instanceof Error),options.chmod(p,_0666,function(er2){er2?cb("ENOENT"===er2.code?null:er):options.stat(p,function(er3,stats){er3?cb("ENOENT"===er3.code?null:er):stats.isDirectory()?rmdir(p,options,er,cb):options.unlink(p,cb)})})}function fixWinEPERMSync(p,options,er){assert(p),assert(options),er&&assert(er instanceof Error);try{options.chmodSync(p,_0666)}catch(er2){if("ENOENT"===er2.code)return;throw er}try{var stats=options.statSync(p)}catch(er3){if("ENOENT"===er3.code)return;throw er}stats.isDirectory()?rmdirSync(p,options,er):options.unlinkSync(p)}function rmdir(p,options,originalEr,cb){assert(p),assert(options),originalEr&&assert(originalEr instanceof Error),assert("function"==typeof cb),options.rmdir(p,function(er){!er||"ENOTEMPTY"!==er.code&&"EEXIST"!==er.code&&"EPERM"!==er.code?er&&"ENOTDIR"===er.code?cb(originalEr):cb(er):function(p,options,cb){assert(p),assert(options),assert("function"==typeof cb),options.readdir(p,function(er,files){if(er)return cb(er);var errState,n=files.length;if(0===n)return options.rmdir(p,cb);files.forEach(function(f){rimraf(path.join(p,f),options,function(er){if(!errState)return er?cb(errState=er):void(0==--n&&options.rmdir(p,cb))})})})}(p,options,cb)})}function rimrafSync(p,options){var results;if(defaults(options=options||{}),assert(p,"rimraf: missing path"),assert.equal(typeof p,"string","rimraf: path should be a string"),assert(options,"rimraf: missing options"),assert.equal(typeof options,"object","rimraf: options should be object"),options.disableGlob||!glob.hasMagic(p))results=[p];else try{options.lstatSync(p),results=[p]}catch(er){results=glob.sync(p,options.glob)}if(results.length)for(var i=0;i<results.length;i++){p=results[i];try{var st=options.lstatSync(p)}catch(er){if("ENOENT"===er.code)return;"EPERM"===er.code&&isWindows&&fixWinEPERMSync(p,options,er)}try{st&&st.isDirectory()?rmdirSync(p,options,null):options.unlinkSync(p)}catch(er){if("ENOENT"===er.code)return;if("EPERM"===er.code)return isWindows?fixWinEPERMSync(p,options,er):rmdirSync(p,options,er);if("EISDIR"!==er.code)throw er;rmdirSync(p,options,er)}}}function rmdirSync(p,options,originalEr){assert(p),assert(options),originalEr&&assert(originalEr instanceof Error);try{options.rmdirSync(p)}catch(er){if("ENOENT"===er.code)return;if("ENOTDIR"===er.code)throw originalEr;"ENOTEMPTY"!==er.code&&"EEXIST"!==er.code&&"EPERM"!==er.code||function(p,options){assert(p),assert(options),options.readdirSync(p).forEach(function(f){rimrafSync(path.join(p,f),options)});var retries=isWindows?100:1,i=0;for(;;){var threw=!0;try{var ret=options.rmdirSync(p,options);return threw=!1,ret}finally{if(++i<retries&&threw)continue}}}(p,options)}}}).call(this,__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/node_modules/process/browser.js?55cf"))},"./node_modules/safe-buffer/index.js":function(module,exports,__webpack_require__){var buffer=__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/node_modules/buffer/index.js?5702"),Buffer=buffer.Buffer;function copyProps(src,dst){for(var key in src)dst[key]=src[key]}function SafeBuffer(arg,encodingOrOffset,length){return Buffer(arg,encodingOrOffset,length)}Buffer.from&&Buffer.alloc&&Buffer.allocUnsafe&&Buffer.allocUnsafeSlow?module.exports=buffer:(copyProps(buffer,exports),exports.Buffer=SafeBuffer),copyProps(Buffer,SafeBuffer),SafeBuffer.from=function(arg,encodingOrOffset,length){if("number"==typeof arg)throw new TypeError("Argument must not be a number");return Buffer(arg,encodingOrOffset,length)},SafeBuffer.alloc=function(size,fill,encoding){if("number"!=typeof size)throw new TypeError("Argument must be a number");var buf=Buffer(size);return void 0!==fill?"string"==typeof encoding?buf.fill(fill,encoding):buf.fill(fill):buf.fill(0),buf},SafeBuffer.allocUnsafe=function(size){if("number"!=typeof size)throw new TypeError("Argument must be a number");return Buffer(size)},SafeBuffer.allocUnsafeSlow=function(size){if("number"!=typeof size)throw new TypeError("Argument must be a number");return buffer.SlowBuffer(size)}},"./node_modules/setimmediate/setImmediate.js":function(module,exports,__webpack_require__){(function(global,process){!function(global,undefined){"use strict";if(!global.setImmediate){var registerImmediate,html,channel,messagePrefix,onGlobalMessage,nextHandle=1,tasksByHandle={},currentlyRunningATask=!1,doc=global.document,attachTo=Object.getPrototypeOf&&Object.getPrototypeOf(global);attachTo=attachTo&&attachTo.setTimeout?attachTo:global,"[object process]"==={}.toString.call(global.process)?registerImmediate=function(handle){process.nextTick(function(){runIfPresent(handle)})}:!function(){if(global.postMessage&&!global.importScripts){var postMessageIsAsynchronous=!0,oldOnMessage=global.onmessage;return global.onmessage=function(){postMessageIsAsynchronous=!1},global.postMessage("","*"),global.onmessage=oldOnMessage,postMessageIsAsynchronous}}()?global.MessageChannel?((channel=new MessageChannel).port1.onmessage=function(event){runIfPresent(event.data)},registerImmediate=function(handle){channel.port2.postMessage(handle)}):doc&&"onreadystatechange"in doc.createElement("script")?(html=doc.documentElement,registerImmediate=function(handle){var script=doc.createElement("script");script.onreadystatechange=function(){runIfPresent(handle),script.onreadystatechange=null,html.removeChild(script),script=null},html.appendChild(script)}):registerImmediate=function(handle){setTimeout(runIfPresent,0,handle)}:(messagePrefix="setImmediate$"+Math.random()+"$",onGlobalMessage=function(event){event.source===global&&"string"==typeof event.data&&0===event.data.indexOf(messagePrefix)&&runIfPresent(+event.data.slice(messagePrefix.length))},global.addEventListener?global.addEventListener("message",onGlobalMessage,!1):global.attachEvent("onmessage",onGlobalMessage),registerImmediate=function(handle){global.postMessage(messagePrefix+handle,"*")}),attachTo.setImmediate=function(callback){"function"!=typeof callback&&(callback=new Function(""+callback));for(var args=new Array(arguments.length-1),i=0;i<args.length;i++)args[i]=arguments[i+1];var task={callback:callback,args:args};return tasksByHandle[nextHandle]=task,registerImmediate(nextHandle),nextHandle++},attachTo.clearImmediate=clearImmediate}function clearImmediate(handle){delete tasksByHandle[handle]}function runIfPresent(handle){if(currentlyRunningATask)setTimeout(runIfPresent,0,handle);else{var task=tasksByHandle[handle];if(task){currentlyRunningATask=!0;try{!function(task){var callback=task.callback,args=task.args;switch(args.length){case 0:callback();break;case 1:callback(args[0]);break;case 2:callback(args[0],args[1]);break;case 3:callback(args[0],args[1],args[2]);break;default:callback.apply(undefined,args)}}(task)}finally{clearImmediate(handle),currentlyRunningATask=!1}}}}}("undefined"==typeof self?void 0===global?this:global:self)}).call(this,__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/buildin/global.js?8fce"),__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/node_modules/process/browser.js?55cf"))},"./node_modules/utf8/utf8.js":function(module,exports,__webpack_require__){(function(module,global){var __WEBPACK_AMD_DEFINE_RESULT__;!function(root){var freeExports="object"==typeof exports&&exports,freeGlobal=("object"==typeof module&&module&&module.exports,"object"==typeof global&&global);freeGlobal.global!==freeGlobal&&freeGlobal.window;var byteArray,byteCount,byteIndex,stringFromCharCode=String.fromCharCode;function ucs2decode(string){for(var value,extra,output=[],counter=0,length=string.length;counter<length;)(value=string.charCodeAt(counter++))>=55296&&value<=56319&&counter<length?56320==(64512&(extra=string.charCodeAt(counter++)))?output.push(((1023&value)<<10)+(1023&extra)+65536):(output.push(value),counter--):output.push(value);return output}function checkScalarValue(codePoint){if(codePoint>=55296&&codePoint<=57343)throw Error("Lone surrogate U+"+codePoint.toString(16).toUpperCase()+" is not a scalar value")}function createByte(codePoint,shift){return stringFromCharCode(codePoint>>shift&63|128)}function encodeCodePoint(codePoint){if(0==(4294967168&codePoint))return stringFromCharCode(codePoint);var symbol="";return 0==(4294965248&codePoint)?symbol=stringFromCharCode(codePoint>>6&31|192):0==(4294901760&codePoint)?(checkScalarValue(codePoint),symbol=stringFromCharCode(codePoint>>12&15|224),symbol+=createByte(codePoint,6)):0==(4292870144&codePoint)&&(symbol=stringFromCharCode(codePoint>>18&7|240),symbol+=createByte(codePoint,12),symbol+=createByte(codePoint,6)),symbol+=stringFromCharCode(63&codePoint|128)}function readContinuationByte(){if(byteIndex>=byteCount)throw Error("Invalid byte index");var continuationByte=255&byteArray[byteIndex];if(byteIndex++,128==(192&continuationByte))return 63&continuationByte;throw Error("Invalid continuation byte")}function decodeSymbol(){var byte1,codePoint;if(byteIndex>byteCount)throw Error("Invalid byte index");if(byteIndex==byteCount)return!1;if(byte1=255&byteArray[byteIndex],byteIndex++,0==(128&byte1))return byte1;if(192==(224&byte1)){if((codePoint=(31&byte1)<<6|readContinuationByte())>=128)return codePoint;throw Error("Invalid continuation byte")}if(224==(240&byte1)){if((codePoint=(15&byte1)<<12|readContinuationByte()<<6|readContinuationByte())>=2048)return checkScalarValue(codePoint),codePoint;throw Error("Invalid continuation byte")}if(240==(248&byte1)&&(codePoint=(7&byte1)<<18|readContinuationByte()<<12|readContinuationByte()<<6|readContinuationByte())>=65536&&codePoint<=1114111)return codePoint;throw Error("Invalid UTF-8 detected")}var utf8={version:"2.1.2",encode:function(string){for(var codePoints=ucs2decode(string),length=codePoints.length,index=-1,byteString="";++index<length;)byteString+=encodeCodePoint(codePoints[index]);return byteString},decode:function(byteString){byteArray=ucs2decode(byteString),byteCount=byteArray.length,byteIndex=0;for(var tmp,codePoints=[];!1!==(tmp=decodeSymbol());)codePoints.push(tmp);return function(array){for(var value,length=array.length,index=-1,output="";++index<length;)(value=array[index])>65535&&(output+=stringFromCharCode((value-=65536)>>>10&1023|55296),value=56320|1023&value),output+=stringFromCharCode(value);return output}(codePoints)}};void 0===(__WEBPACK_AMD_DEFINE_RESULT__=function(){return utf8}.call(exports,__webpack_require__,exports,module))||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)}()}).call(this,__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/buildin/module.js")(module),__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/buildin/global.js?8fce"))},"./node_modules/util-deprecate/browser.js":function(module,exports,__webpack_require__){(function(global){function config(name){try{if(!global.localStorage)return!1}catch(_){return!1}var val=global.localStorage[name];return null!=val&&"true"===String(val).toLowerCase()}module.exports=function(fn,msg){if(config("noDeprecation"))return fn;var warned=!1;return function(){if(!warned){if(config("throwDeprecation"))throw new Error(msg);config("traceDeprecation")?console.trace(msg):console.warn(msg),warned=!0}return fn.apply(this,arguments)}}}).call(this,__webpack_require__("../../AppData/Roaming/npm/node_modules/webpack/buildin/global.js?8fce"))},"./node_modules/wrappy/wrappy.js":function(module,exports){module.exports=function wrappy(fn,cb){if(fn&&cb)return wrappy(fn)(cb);if("function"!=typeof fn)throw new TypeError("need wrapper function");Object.keys(fn).forEach(function(k){wrapper[k]=fn[k]});return wrapper;function wrapper(){for(var args=new Array(arguments.length),i=0;i<args.length;i++)args[i]=arguments[i];var ret=fn.apply(this,args),cb=args[args.length-1];return"function"==typeof ret&&ret!==cb&&Object.keys(cb).forEach(function(k){ret[k]=cb[k]}),ret}}},"./test/module_tests.json":function(module){module.exports={testlist:[{command:"smoothImage --sigma 2.0 --radiusfactor 2.0 --debug true --inmm true --input testdata/MNI_2mm_resliced.nii.gz ",test:"--test_target testdata/newtests/goldsmooth2sigma.nii.gz",result:!0,dopython:!0},{command:"smoothImage --sigma 2.0 --radiusfactor 2.0 --debug false --inmm false --input testdata/MNI_2mm_resliced.nii.gz",test:"--test_target testdata/newtests/goldsmooth2sigma.nii.gz",result:!1,dopython:!0},{command:"smoothImage --sigma 2.0 --paramfile testdata/smoothParam.json --input testdata/MNI_2mm_resliced.nii.gz",test:"--test_target testdata/newtests/goldsmooth2sigma.nii.gz",result:!0,dopython:!1},{command:"computeCorrelation -i testdata/ButterWorthOutput.csv --zscore false",test:"--test_target testdata/newtests/goldcorrelation.matr --test_type matrix --test_comparison ssd --test_threshold 0.01",result:!0,dopython:!0},{command:"regressOut -i testdata/newtests/drift_input.csv -r testdata/newtests/drift.csv",test:"--test_target testdata/simpleregress.csv --test_type matrix --test_comparison ssd --test_threshold 0.1",result:!0,dopython:!0},{command:"regressOut -i testdata/newtests/driftw_input.csv -r testdata/newtests/drift2.csv -w testdata/newtests/drift_weights.matr",test:"--test_target testdata/newtests/weighted_drift_gold.csv --test_type matrix --test_comparison ssd --test_threshold 0.01",result:!0,dopython:!0},{command:"regressOut -i testdata/newtests/driftw_input.csv -r testdata/newtests/drift2.csv",test:"--test_target testdata/newtests/weighted_drift_gold.csv --test_type matrix --test_comparison ssd --test_threshold 0.01",result:!1,dopython:!0},{command:"regressGlobal -i testdata/newtests/global_inp.matr --debug true ",test:"--test_target testdata/newtests/global_out.matr --test_type matrix --test_comparison ssd --test_threshold 0.001",result:!0,dopython:!0},{command:"butterworthFilter -i testdata/newtests/but_low_inp.matr  --type  low --tr 1.0 --low 0.15",test:"--test_target testdata/newtests/but_low_out.matr --test_type matrix --test_comparison ssd --test_threshold 0.01",result:!0,dopython:!0},{command:"butterworthFilter -i testdata/newtests/but_low_inp.matr  --type  high --tr 1.0 --high 0.03 --debug true",test:"--test_target testdata/newtests/but_high_out.matr --test_type matrix --test_comparison ssd --test_threshold 0.01",result:!0,dopython:!0},{command:"butterworthFilter -i testdata/newtests/but_low_inp.matr  --type  band --tr 1.0 --high 0.03 --low 0.15",test:"--test_target testdata/newtests/but_band_out.matr --test_type matrix --test_comparison ssd --test_threshold 0.4 --debug true",result:!0,dopython:!0},{command:"computeROI -i testdata/simple4dtest.nii.gz -r testdata/simpleroi.nii.gz --debug true",test:"--test_target testdata/newtests/simpleroi_result.matr --test_type matrix --test_comparison ssd --test_threshold 0.01",result:!0,dopython:!0},{command:"thresholdImage -i testdata/MNI_6mm.nii.gz --low 128.0 --high 1000 --debug 1",test:"--test_target testdata/newtests/MNI_thr.nii.gz ",result:!0,dopython:!0},{command:"prepareRegistration -i testdata/MNI_6mm.nii.gz  --sigma 2.0 --numbins 32 --debug 1",test:"--test_target testdata/newtests/MNI_6mm_prepare.nii.gz",result:!0,dopython:!0},{command:"extractFrame -i testdata/simple4dtest.nii.gz --frame 3 --debug true",test:"--test_target testdata/simple4dtest_frame3.nii.gz",result:!0,dopython:!0},{command:"extractFrame -i testdata/simple4dtest.nii.gz --frame 5 --debug true",test:"--test_target testdata/simple4dtest_frame3.nii.gz",result:!1,dopython:!0},{command:"extractFrame -i testdata/simple4dtest.nii.gz --frame 3 --usewasm false --debug true",test:"--test_target testdata/simple4dtest_frame3.nii.gz",result:!0,dopython:!0},{command:"extractSlice -i testdata/ras_avg152T1_LR_nifti.nii.gz --plane 2 --slice 18 --frame 0 --component 0 --debug true",test:"--test_target testdata/ras152_slicek18.nii.gz",result:!0,dopython:!0},{command:"extractSlice -i testdata/ras_avg152T1_LR_nifti.nii.gz --plane 1 --slice 54 --frame 0 --component 0 --debug true",test:"--test_target testdata/ras152_slicej54.nii.gz",result:!0,dopython:!0},{command:"extractSlice -i testdata/ras_avg152T1_LR_nifti.nii.gz --plane 0 --slice 56",test:"--test_target testdata/ras152_slicei56.nii.gz",result:!0,dopython:!0},{command:"normalizeImage -i testdata/avg152T1_LR_nifti.nii.gz --perlow 0.1 --perhigh 0.75 --maxval 255 --debug true",test:"--test_target testdata/avg152T1_LR_nifti_normalized.nii.gz",result:!0,dopython:!0},{command:"resliceImage -i testdata/avg152T1_LR_nifti.nii.gz -r testdata/avg152T1_LR_nifti_resampled.nii.gz -x testdata/newtests/reslice_transform.matr --interpolation 1 --debug true --backgroundvalue 0.0",test:"--test_target testdata/avg152T1_LR_nifti_resampled_resliced.nii.gz --test_threshold 0.999 --test_type image --test_comparison cc",result:!0,dopython:!0},{command:"resliceImage -i testdata/avg152T1_LR_nifti.nii.gz -r testdata/avg152T1_LR_nifti_resampled.nii.gz -x testdata/newtests/reslice_transform.matr --interpolation 0 --debug false --backgroundvalue 0.0",test:"--test_target testdata/avg152T1_LR_nifti_resampled_resliced_NN.nii.gz --test_threshold 0.999 --test_type image --test_comparison cc",result:!0,dopython:!0},{command:"resliceImage -i testdata/avg152T1_LR_nifti.nii.gz -r testdata/avg152T1_LR_nifti_resampled.nii.gz -x testdata/newtests/reslice_transform.matr --interpolation 3 --debug false --backgroundvalue 0.0 --forcefloat true",test:"--test_target testdata/avg152T1_LR_nifti_resampled_resliced_Cubic.nii.gz --test_threshold 0.999 --test_type image --test_comparison cc",result:!0,dopython:!0},{command:"resampleImage -i testdata/avg152T1_LR_nifti.nii.gz --interpolation 1 --debug false --backgroundvalue 0.0 --xsp 2.5 --ysp 4.5 --zsp 6.5",test:"--test_target testdata/avg152T1_LR_nifti_resampled.nii.gz --test_threshold 0.999 --test_type image --test_comparison cc",result:!0,dopython:!0},{command:"computeGLM -i testdata/glm/Test_allruns.nii.gz --regressor testdata/glm/Test_bis_glm.matr --debug true --numtasks 3",test:"--test_target testdata/glm/test_beta.nii.gz",result:!0,dopython:!0},{command:"segmentImage -i testdata/MNI_2mm_orig.nii.gz --numclasses 3 --maxsigmaratio 0.2 --smoothness 0.0 --robust false --debug true --smoothhisto false",test:"--test_target testdata/histo_MNI_2mm_orig.nii.gz --test_comparison cc --test_threshold 0.99",result:!0,dopython:!0},{command:"segmentImage -i testdata/MNI_2mm_orig.nii.gz --numclasses 3 --maxsigmaratio 0.2 --smoothness 100.0 --robust false --debug true --smoothhisto false --mrfiterations 8 --noisesigma2 1000.0 --internaliterations 12",test:"--test_target testdata/mrf_MNI_2mm_orig.nii.gz --test_comparison cc --test_threshold 0.98",result:!0,dopython:!0},{command:"sliceBiasCorrect -i testdata/MNI_T1_1mm_resampled_biasz.nii.gz --axis z --threshold 0.0002 --returnbiasfield false --debug true",test:"--test_target testdata/MNI_T1_1mm_resampled_biasz_corrected.nii.gz --test_comparison cc --test_threshold 0.95",result:!0,dopython:!0},{command:"sliceBiasCorrect -i testdata/MNI_T1_1mm_resampled_triplebias.nii.gz --axis triple --threshold 0.0002 --returnbiasfield false --debug true",test:"--test_target testdata/MNI_T1_1mm_resampled.nii.gz --test_comparison cc --test_threshold 0.85",result:!0,dopython:!0},{command:"clusterThreshold -i testdata/glm/Test_deconvolve_stats_beta.nii.gz --threshold 1.0 --size 10 --debug 1 --outclustno false",test:"--test_target testdata/glm/cluster_thr.nii.gz",result:!0,dopython:!0},{command:"clusterThreshold -i testdata/glm/Test_deconvolve_stats_beta.nii.gz --threshold 1.0 --size 10 --debug 1 --outclustno true",test:"--test_target testdata/glm/clusterno.nii.gz",result:!0,dopython:!0},{command:"displacementField -i testdata/MNI_6mm.nii.gz -x testdata/MNI_2mm_scaled.grd --debug true",test:"--test_target testdata/MNI_6mm_scaleddispfield.nii.gz",result:!0,dopython:!0},{command:"displacementField  -i testdata/MNI_6mm.nii.gz -x testdata/resample.matr -y testdata/resample.matr  --debug true",test:"--test_target testdata/combo_disp.nii.gz",result:!0,dopython:!1},{command:"displacementField  -i testdata/MNI_6mm.nii.gz -x testdata/resample.matr -y testdata/complex.grd --debug true",test:"--test_target testdata/combo_disp2.nii.gz --test_threshold 0.1",result:!0,dopython:!1},{command:"displacementField  -i testdata/MNI_6mm.nii.gz -x testdata/resample.matr -y testdata/complex.grd -z testdata/2dreslice.matr --debug true",test:"--test_target testdata/combo_disp3.nii.gz --test_threshold 0.1",result:!0,dopython:!1},{command:"approximateField -i testdata/MNI_6mm_scaleddispfield.nii.gz --spacing 30.0 --debug false --stepsize 0.25",test:"--test_target testdata/newtests/fitgrid.grd --test_type gridtransform",result:!0,dopython:!0},{command:"linearRegistration -t testdata/MNI_2mm_orig.nii.gz -r testdata/newtests/reg_input.nii.gz --intscale 2 --numbins  64 --levels  3 --imagesmoothing 1.0 --optimization ConjugateGradient --stepsize 0.25 --metric NMI --steps 1 --iterations 20 --mode Affine --resolution 1.1 --debug true",test:"--test_target testdata/newtests/linear.matr --test_type matrixtransform ",result:!0,dopython:!0},{command:"linearRegistration -t testdata/MNI_2mm_orig.nii.gz -r testdata/newtests/reg_input.nii.gz --intscale 2 --numbins  64 --levels  3 --imagesmoothing 1.0 --optimization ConjugateGradient --stepsize 0.25 --metric NMI --steps 1 --iterations 20 --mode Affine --resolution 1.1 --debug true",test:"--test_target testdata/newtests/reg_input.nii.gz --test_type registration --test_comparison cc --test_threshold 0.99",result:!0,dopython:!0},{command:"nonlinearRegistration -r testdata/MNI_2mm_orig.nii.gz -t testdata/MNI_2mm_scaled.nii.gz --intscale 1 --numbins  64 --levels  2  --optimization ConjugateGradient --stepsize 1.0 --metric NMI --steps 1 --iterations 5 --cps  40.0 --linearmode None --resolution 2.0 --lambda  0.1",test:"--test_target testdata/MNI_2mm_orig.nii.gz --test_type registration --test_comparison cc --test_threshold 0.95",result:!0,dopython:!0},{command:"nonlinearRegistration -r testdata/MNI_2mm_orig.nii.gz -t testdata/MNI_2mm_scaled.nii.gz --intscale 1 --numbins  64 --levels  2  --optimization ConjugateGradient --stepsize 1.0 --metric NMI --steps 1 --iterations 5 --cps  30.0 --linearmode None --resolution 2.0 --lambda  0.2 --append 0",test:"--test_target testdata/MNI_2mm_orig.nii.gz --test_type registration --test_comparison cc --test_threshold 0.92",result:!0,dopython:!0},{command:"nonlinearRegistration -r testdata/MNI_2mm_orig.nii.gz -t testdata/MNI_2mm_scaled.nii.gz --intscale 1 --numbins  64 --levels  1 --optimization ConjugateGradient --stepsize 1.0 --metric NMI --steps 1 --iterations 2 --cps  40.0 --resolution  3.0 --linearmode None --lambda  0.1 --linearmode None --debug false",test:"--test_target testdata/MNI_2mm_orig.nii.gz --test_type registration --test_comparison cc --test_threshold 0.95",result:!1,dopython:!0},{command:"resliceImage -i testdata/ras152_slicek18.nii.gz -r testdata/ras152_slicek18.nii.gz -x testdata/2dreslice.matr  --interpolation 0  --debug true --forcefloat true --debug true",test:"--test_target testdata/ras152_slicek18_ras152_slicek18_resl_NN.nii.gz  --test_comparison cc --test_threshold 0.99",result:!0,dopython:!0},{command:"resliceImage -i testdata/ras152_slicek18.nii.gz -r testdata/ras152_slicek18.nii.gz -x testdata/2dreslice.matr  --interpolation 1  --debug true --forcefloat true --debug true",test:"--test_target testdata/ras152_slicek18_ras152_slicek18_resl_LN.nii.gz  --test_comparison cc --test_threshold 0.99",result:!0,dopython:!0},{command:"resliceImage -i testdata/ras152_slicek18.nii.gz -r testdata/ras152_slicek18.nii.gz -x testdata/2dreslice.matr  --interpolation 3  --debug true --forcefloat true --debug true",test:"--test_target testdata/ras152_slicek18_ras152_slicek18_resl_CC.nii.gz  --test_comparison cc --test_threshold 0.99",result:!0,dopython:!0},{command:"motionCorrection  -t testdata/test_motion_correction.nii.gz  -r testdata/test_motion_correction.nii.gz --doreslice true",test:"--test_target testdata/motioncorrection_result.nii.gz --test_type registration",result:!0,dopython:!1},{command:"motionCorrection  -t testdata/test_motion_correction.nii.gz  -r testdata/test_motion_correction.nii.gz --doreslice true",test:"--test_target testdata/test_motion_correction.nii.gz --test_type registration",result:!1,dopython:!1},{command:"flipImage --flipi 1 --debug true -i testdata/MNI_6mm.nii.gz",test:"--test_target testdata/MNI_6mm_flipx.nii.gz",result:!0,dopython:!0},{command:"flipImage --flipj 1 --debug false -i testdata/MNI_6mm.nii.gz",test:"--test_target testdata/MNI_6mm_flipy.nii.gz",result:!0,dopython:!0},{command:"flipImage --flipk 1 --debug false -i testdata/MNI_6mm.nii.gz",test:"--test_target testdata/MNI_6mm_flipz.nii.gz",result:!0,dopython:!0},{command:"flipImage --flipi 1 --flipk 1 --debug true -i testdata/MNI_6mm.nii.gz",test:"--test_target testdata/MNI_6mm_flipxz.nii.gz",result:!0,dopython:!0},{command:"cropImage --i0 -5 --i1 15 --di 2 --j0 4 --j1 24 --dj 3 --k0 2 --k1 11 --dk 4 --t0 9 --t1 179 --dt 10 --input testdata/glm/Test_allruns.nii.gz --debug true",test:"--test_target testdata/glm/Test_allruns_crop.nii.gz",result:!0,dopython:!0},{command:"blankImage --i0 10 --i1 73  --j0 20 --j1 67 --k0 12 --k1 44 --input testdata/newtests/reg_input.nii.gz --debug true",test:"--test_target testdata/newtests/reg_input_blank.nii.gz",result:!0,dopython:!0},{command:"binaryThresholdImage --low 250 --high 256 --debug true --input testdata/morphology/morphology_base.nii.gz",test:"--test_target testdata/morphology/mask_250.nii.gz",result:!0,dopython:!1},{command:"binaryThresholdImage --low 128 --high 256 --debug true --input testdata/morphology/morphology_base.nii.gz",test:"--test_target testdata/morphology/mask_128.nii.gz",result:!0,dopython:!1},{command:"binaryThresholdImage --low 384.5 --high 386 --debug true -i testdata/reorient/avg152T1_LR_PSR_ss.nii.gz",test:"--test_target testdata/reorient/avg152T1_LR_PSR_ss_binary.nii.gz",result:!0,dopython:!1},{command:"morphologyFilter --radius 1 --mode median --debug true --input testdata/morphology/mask_128.nii.gz",test:"--test_target testdata/morphology/median_mask_128.nii.gz --test_comparison cc --test_threshold 0.98",result:!0,dopython:!1},{command:"morphologyFilter --radius 1 --mode connect --seedi 25 --seedj 54 --seedk 47 --debug true --input testdata/morphology/mask_250.nii.gz",test:"--test_target testdata/morphology/connect_25_54_47.nii.gz",result:!0,dopython:!1},{command:"morphologyFilter --radius 1 --mode erode --debug true --input testdata/morphology/connect_25_54_47.nii.gz",test:"--test_target testdata/morphology/erode_connect.nii.gz",result:!0,dopython:!1},{command:"morphologyFilter --radius 1 --mode dilate --debug true --input testdata/morphology/erode_connect.nii.gz",test:"--test_target testdata/morphology/dilate_erode_connect.nii.gz",result:!0,dopython:!1},{command:"combineImages --mode add  --debug true --input testdata/combine/tt_1.nii.gz --second testdata/combine/tt_2.nii.gz",test:"--test_target testdata/combine/tt_add.nii.gz",result:!0,dopython:!1},{command:"combineImages --mode subtract  --debug true --input testdata/combine/tt_1.nii.gz --second testdata/combine/tt_2.nii.gz",test:"--test_target testdata/combine/tt_subtract.nii.gz",result:!0,dopython:!1},{command:"combineImages --mode multiply  --debug true --input testdata/combine/tt_1.nii.gz --second testdata/combine/tt_2.nii.gz",test:"--test_target testdata/combine/tt_multiply.nii.gz",result:!0,dopython:!1},{command:"combineImages --mode divide  --debug true --input testdata/combine/tt_1.nii.gz --second testdata/combine/tt_2.nii.gz",test:"--test_target testdata/combine/tt_divide.nii.gz",result:!0,dopython:!1},{command:"combineImages --mode add --weight1 2.0 --weight2 3.0  --debug true --input testdata/combine/tt_1.nii.gz --second testdata/combine/tt_2.nii.gz",test:"--test_target testdata/combine/tt_add23.nii.gz",result:!0,dopython:!1},{command:"combineImages --mode divide --weight1 4.0 --weight2 2.0  --debug true --input testdata/combine/tt_1.nii.gz --second testdata/combine/tt_2.nii.gz",test:"--test_target testdata/combine/tt_divide42.nii.gz",result:!0,dopython:!1},{command:"process4DImage --operation mean  --debug true --input testdata/combine/4d_inp.nii.gz",test:"--test_target testdata/combine/4d_mean.nii.gz",result:!0,dopython:!1},{command:"process4DImage --operation meansigma  --debug true --input testdata/combine/4d_inp.nii.gz",test:"--test_target testdata/combine/4d_meansigma.nii.gz",result:!0,dopython:!1},{command:"process4DImage --operation rms  --debug true --input testdata/combine/4d_inp.nii.gz",test:"--test_target testdata/combine/4d_rms.nii.gz",result:!0,dopython:!1},{command:"process4DImage --operation max  --debug true --input testdata/combine/4d_inp.nii.gz",test:"--test_target testdata/combine/4d_max.nii.gz",result:!0,dopython:!1},{command:"process4DImage --operation min  --debug true --input testdata/combine/4d_inp.nii.gz",test:"--test_target testdata/combine/4d_min.nii.gz",result:!0,dopython:!1},{command:"projectImage --paramfile testdata/project/projectImage_2018_03_30.param --input testdata/project/project_base.nii.gz",test:"--test_target testdata/project/project_2mm.nii.gz",result:!0,dopython:!1},{command:"backProjectImage --paramfile testdata/project/backProjectImage_2018_03_30.param --input testdata/project/project_2mm.nii.gz --target testdata/project/backproject_threed.nii.gz",test:"--test_target testdata/project/backproject.nii.gz",result:!0,dopython:!1},{command:"maskImage --threshold 0.5 --debug true -i testdata/morphology/morphology_base.nii.gz -m testdata/morphology/mask_128.nii.gz",test:"--test_target testdata/morphology/morphology_base__mask_128__msk.nii.gz",result:!0,dopython:!1},{command:"manualRegistration --paramfile testdata/morphology/manualRegistration_2018_03_30.param -r testdata/morphology/morphology_base_float.nii.gz -t testdata/morphology/morphology_base_float.nii.gz",test:"--test_target testdata/morphology/manualreg.nii.gz --test_type registration --test_comparison cc --test_threshold 0.999",result:!0,dopython:!1},{command:"resliceImage -i testdata/MNI_6mm.nii.gz --r testdata/MNI_6mm.nii.gz -x testdata/resample.matr -y testdata/2dreslice.matr --interpolation 1 --debug true --backgroundvalue 0.0",test:"--test_target testdata/dualreslice.nii.gz --test_threshold 0.999 --test_type image --test_comparison cc",result:!0,dopython:!1},{command:"motionReslice -r testdata/MNI_2mm_orig.nii.gz -i testdata/test_motion_correction.nii.gz -x testdata/2dreslice.matr --res 1.0 -m testdata/motionparams.json --debug true",test:"--test_target testdata/atlasmotion.nii.gz --test_threshold 0.999 --test_type image --test_comparison cc",result:!0,dopython:!1},{command:"regularizeObjectmap --smoothness 16 --convergence 0.2 --iterations 8 --internaliterations 4 --debug true -i testdata/thr_obj.nii.gz",test:"--test_target testdata/thr_regobj.nii.gz --test_threshold 30.0 --test_comparison ssd",result:!0,dopython:!0},{command:"regularizeObjectmap --smoothness 16 --convergence 0.2 --iterations 8 --internaliterations 4 --debug true -i testdata/thr_obj.nii.gz",test:"--test_target testdata/thr_obj.nii.gz --test_threshold 30.0 --test_comparison ssd",result:!1,dopython:!0},{command:"defaceImage --levels 3 --iterations 5 --resolution 2.0 --imagesmoothing 1.0 --debug true -i testdata/deface/sag_2mm.nii.gz",test:"--test_target testdata/deface/sag_2mm_defaced.nii.gz --test_threshold 0.9999 --test_comparison cc",result:!0,dopython:!1,webworker:!1},{command:"reorientImage --orient RAS --debug true -i testdata/reorient/avg152T1_LR_PSR.nii.gz",test:"--test_target testdata/reorient/avg152T1_LR_RAS.nii.gz",result:!0,dopython:!1},{command:"reorientImage --orient RAS --debug true -i testdata/reorient/avg152T1_LR_LIP.nii.gz",test:"--test_target testdata/reorient/avg152T1_LR_RAS.nii.gz",result:!0,dopython:!1},{command:"reorientImage --orient RAS --debug true -i testdata/reorient/avg152T1_LR_LPS.nii.gz",test:"--test_target testdata/reorient/avg152T1_LR_RAS.nii.gz",result:!0,dopython:!1},{command:"reorientImage --orient LPS --debug true -i testdata/reorient/avg152T1_LR_PSR.nii.gz",test:"--test_target testdata/reorient/avg152T1_LR_LPS.nii.gz",result:!0,dopython:!1},{command:"reorientImage --orient LPS --debug true -i testdata/reorient/avg152T1_LR_LIP.nii.gz",test:"--test_target testdata/reorient/avg152T1_LR_LPS.nii.gz",result:!0,dopython:!1},{command:"reorientImage --orient LPS --debug true -i testdata/reorient/avg152T1_LR_RAS.nii.gz",test:"--test_target testdata/reorient/avg152T1_LR_LPS.nii.gz",result:!0,dopython:!1},{command:"reorientImage --orient LAS --debug true -i testdata/reorient/avg152T1_LR_RAS.nii.gz",test:"--test_target testdata/reorient/avg152T1_LR_LPS.nii.gz",result:!1,dopython:!1},{command:"shiftScaleImage --shift 2.0 --scale 1.5 --outtype Float --debug true -i testdata/reorient/avg152T1_LR_PSR.nii.gz",test:"--test_target testdata/reorient/avg152T1_LR_PSR_ss.nii.gz",result:!0,dopython:!1},{command:"tfrecon -i testdata/tfjs64/sample1.nii.gz --modelname testdata/tfjs64 --padding 8 --batchsize 1",test:"--test_target testdata/tfjs64/sampleout.nii.gz --test_type tfjs --test_comparison ssd --test_threshold 0.5",result:!0,dopython:!1,webworker:!1}]}},"./test/webtestdata/displaytests.json":function(module){module.exports={overlay:[{base:"viewer.biswebstate",state:"test1.state",comparison:"disptest1.png",viewer:1,result:!0},{base:"viewer.biswebstate",state:"test1.state",comparison:"test2.png",viewer:1,result:!1},{base:"viewer.biswebstate",state:"test2.state",comparison:"test2.png",viewer:1,result:!0},{base:"overlay.biswebstate",state:"test3.state",comparison:"test3.png",viewer:1,result:!0},{base:"overlay.biswebstate",state:"test4.state",comparison:"test4.png",viewer:1,result:!0},{base:"overlay.biswebstate",state:"test5.state",comparison:"test5.png",viewer:2,result:!0},{base:"overlay2.biswebstate",state:"test6.state",comparison:"test6.png",viewer:1,result:!0},{base:"overlay2.biswebstate",state:"test7.state",comparison:"test7.png",viewer:2,result:!0},{base:"overlay2.biswebstate",state:"test8.state",comparison:"test8.png",viewer:2,result:!0},{base:"4d.biswebstate",state:"test9.state",comparison:"test9.png",viewer:2,result:!0},{base:"4d.biswebstate",state:"test10.state",comparison:"test10.png",viewer:2,result:!0}],connviewer:[{base:"connstate.biswebstate",state:"",comparison:"otest1.png",result:!0},{base:"connstate.biswebstate",state:"otest2.state",comparison:"otest2.png",result:!0},{base:"connstate.biswebstate",state:"otest3.state",comparison:"otest3.png",result:!0},{base:"connstate.biswebstate",state:"otest4.state",comparison:"otest4.png",result:!0},{base:"connstate.biswebstate",state:"otest5.state",comparison:"otest5.png",result:!0},{base:"connstate.biswebstate",state:"otest2.state",comparison:"otest5.png",result:!1}]}},"./web/aws/awsparameters.js":function(module,exports,__webpack_require__){"use strict";let IdentityPoolId,BucketName,ClientId="5edh465pitl9rb04qbi37csv8e",UserPoolId="us-east-1_BAOsizFzq",AppWebDomain="bisweb-test.auth.us-east-1.amazoncognito.com";__webpack_require__("./node_modules/localforage/dist/localforage.js").createInstance({name:"bis_webfileutil",storeName:"AWSBuckets"}).getItem("currentAWS",(err,value)=>{if(err)console.log("An error occured while fetching from the AWS bucket",err);else try{let parsedItem=JSON.parse(value);parsedItem&&(IdentityPoolId=parsedItem.identityPoolId,BucketName=parsedItem.bucketName)}catch(e){}});let apath="http://localhost:8080/build/web/";if(void 0===window.BIS){let scope=window.document.URL.split("?")[0];apath=scope=scope.split("#")[0];let index=(scope=scope.split("/").pop()).indexOf(".html");scope=scope.substr(0,index),apath=apath.substr(0,apath.length-scope.length-5)}let awsparams={TokenScopesArray:["email","openid"],RedirectUriSignIn:apath+"biswebaws.html",RedirectUriSignOut:apath+"biswebaws.html",IdentityProvider:"COGNITO"};module.exports={authParams:awsparams,RegionName:"us-east-1",BucketName:()=>BucketName,IdentityPoolId:()=>IdentityPoolId,ClientId:()=>ClientId,AppWebDomain:()=>AppWebDomain,UserPoolId:()=>UserPoolId,updateBucketInfo:newBucketInfo=>{BucketName=newBucketInfo.bucketName,IdentityPoolId=newBucketInfo.identityPoolId,UserPoolId=newBucketInfo.userPoolId,ClientId=newBucketInfo.appClientId,AppWebDomain=newBucketInfo.appWebDomain},getCurrentCognitoParams:()=>{let currentParams=awsparams;return currentParams.ClientId=ClientId,currentParams.UserPoolId=UserPoolId,currentParams.AppWebDomain=AppWebDomain,currentParams}}},"./web/images/tools.json":function(module){module.exports={tools:{viewer:{title:"Orthogonal Viewer Tool",url:"viewer",description:"The orthogonal viewer + image processing tool.",picture:"images/viewer.png",width:"800",height:"600"},connviewer:{title:"Connectivity Viewer",url:"connviewer",description:"The fMRI connectivity display tool.",picture:"images/connviewer.png",width:"1024",height:"800"},mni2tal:{title:"MNI2TAL",url:"mni2tal",description:"The MNI 2 Talairach Converter program.",picture:"images/mni2tal.png",width:"450",height:"500"},editor:{title:"Image Editor",url:"editor",description:"The orthogonal viewer and editor.",picture:"images/editor.png",width:"800",height:"600"},overlayviewer:{title:"Overlay Viewer",url:"overlayviewer",description:"The orthogonal and mosaic functional overlay viewer.",picture:"images/overlayviewer.png",width:"800",height:"600"},dualviewer:{title:"Dual Viewer Tool",url:"dualviewer",description:"A dual registration viewer with linked cursors.",picture:"images/dualviewer.png",width:"1024",height:"800"},paravision:{title:"Paravision Import Viewer",url:"paravision",description:"The paravision import tool.",picture:"images/paravision.png",electrononly:!0,width:"1024",height:"800"},spectviewer:{title:"Diff Spect Application",url:"spectviewer",description:"The diff-spect tool",picture:"",electrononly:!1,hide:!0,width:"800",height:"600"}},version:"1.1.0a1"}},0:function(module,exports){},1:function(module,exports){},jquery:function(module,exports){module.exports=__WEBPACK_EXTERNAL_MODULE_jquery__},request:function(module,exports){module.exports=__WEBPACK_EXTERNAL_MODULE_request__},three:function(module,exports){module.exports=__WEBPACK_EXTERNAL_MODULE_three__}}).default});